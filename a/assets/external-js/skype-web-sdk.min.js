/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
/*! elementQuery | Author: Tyson Matanich (http://matanich.com), 2013 | License: MIT */
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
 * @version   2.3.0
 */
/*!
 * Knockout JavaScript library v3.4.0
 * (c) Steven Sanderson - http://knockoutjs.com/
 * License: MIT (http://www.opensource.org/licenses/mit-license.php)
 */
/**
 * @license
 * lodash 3.6.0 (Custom Build) <https://lodash.com/>
 * Build: `lodash compat -o ./lodash.js`
 * Copyright 2012-2015 The Dojo Foundation <http://dojofoundation.org/>
 * Based on Underscore.js 1.8.2 <http://underscorejs.org/LICENSE>
 * Copyright 2009-2015 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 * Available under MIT license <https://lodash.com/license>
 *
 * Copyright (c) 2011 Laura Doktorova
 *
 * Software includes portions from jQote2 Copyright (c) 2010 aefxx,
 * http://aefxx.com/ licensed under the MIT license.
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * ""Software""), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED ""AS IS"", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE."
 */
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
/*!
 * Reqwest! A general purpose XHR connection manager
 * license MIT (c) Dustin Diaz 2013
 * https://github.com/ded/reqwest
 ** version 1.0.2
 */
/*!
 * Sizzle CSS Selector Engine v@VERSION
 * http://sizzlejs.com/
 *
 * Copyright 2013 jQuery Foundation, Inc. and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: @DATE
 */
(function(){
	/**
	* @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
	* Available via the MIT or new BSD license.
	* see: http://github.com/jrburke/almond for details
	*/
	var requirejs,require,define,_stringify=window.ItilUtil&&window.ItilUtil.jsonStringifyWrapper||JSON.stringify;(function(e){var t,n,i,r,o={},a={},s={},c={},l=Object.prototype.hasOwnProperty,u=[].slice,d=/\.js$/
	function p(e,t){return l.call(e,t)}function f(e,t){var n,i,r,o,a,c,l,u,p,f,m,h=t&&t.split("/"),v=s.map,g=v&&v["*"]||{}
	if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),a=(e=e.split("/")).length-1,s.nodeIdCompat&&d.test(e[a])&&(e[a]=e[a].replace(d,"")),e=h.concat(e),p=0;p<e.length;p+=1)if("."===(m=e[p]))e.splice(p,1),p-=1
	else if(".."===m){if(1===p&&(".."===e[2]||".."===e[0]))break
	p>0&&(e.splice(p-1,2),p-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2))
	if((h||g)&&v){for(p=(n=e.split("/")).length;p>0;p-=1){if(i=n.slice(0,p).join("/"),h)for(f=h.length;f>0;f-=1)if((r=v[h.slice(0,f).join("/")])&&(r=r[i])){o=r,c=p
	break}if(o)break
	!l&&g&&g[i]&&(l=g[i],u=p)}!o&&l&&(o=l,c=u),o&&(n.splice(0,c,o),e=n.join("/"))}return e}function m(t,i){return function(){return n.apply(e,u.call(arguments,0).concat([t,i]))}}function h(e){return function(t){o[e]=t}}function v(n){if(p(a,n)){var i=a[n]
	delete a[n],c[n]=!0,t.apply(e,i)}if(!p(o,n)&&!p(c,n))throw new Error("No "+n)
	return o[n]}function g(e){var t,n=e?e.indexOf("!"):-1
	return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function y(e){return function(){return s&&s.config&&s.config[e]||{}}}i=function(e,t){var n,i=g(e),r=i[0]
	return e=i[1],r&&(n=v(r=f(r,t))),r?e=n&&n.normalize?n.normalize(e,function(e){return function(t){return f(t,e)}}(t)):f(e,t):(r=(i=g(e=f(e,t)))[0],e=i[1],r&&(n=v(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},r={require:function(e){return m(e)},exports:function(e){var t=o[e]
	return void 0!==t?t:o[e]={}},module:function(e){return{id:e,uri:"",exports:o[e],config:y(e)}}},t=function(t,n,s,l){var u,d,f,g,y,b,_=[],E=typeof s
	if(l=l||t,"undefined"===E||"function"===E){for(n=!n.length&&s.length?["require","exports","module"]:n,y=0;y<n.length;y+=1)if("require"===(d=(g=i(n[y],l)).f))_[y]=r.require(t)
	else if("exports"===d)_[y]=r.exports(t),b=!0
	else if("module"===d)u=_[y]=r.module(t)
	else if(p(o,d)||p(a,d)||p(c,d))_[y]=v(d)
	else{if(!g.p)throw new Error(t+" missing "+d)
	g.p.load(g.n,m(l,!0),h(d),{}),_[y]=o[d]}f=s?s.apply(o[t],_):void 0,t&&(u&&u.exports!==e&&u.exports!==o[t]?o[t]=u.exports:f===e&&b||(o[t]=f))}else t&&(o[t]=s)},requirejs=require=n=function(o,a,c,l,u){if("string"==typeof o)return r[o]?r[o](a):v(i(o,a).f)
	if(!o.splice){if((s=o).deps&&n(s.deps,s.callback),!a)return
	a.splice?(o=a,a=c,c=null):o=e}return a=a||function(){},"function"==typeof c&&(c=l,l=u),l?t(e,o,a,c):setTimeout((function(){t(e,o,a,c)}),4),n},n.config=function(e){return n(e)},requirejs._defined=o,(define=function(e,t,n){t.splice||(n=t,t=[]),p(o,e)||p(a,e)||(a[e]=[e,t,n])}).amd={jQuery:!0}})(),define("amd",(function(){})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-polyfill-initializer/lib/string",["require","exports"],e)}((function(e,t){t.localeCompare=function(e){return this<e?-1:this>e?1:0},t.includes=function(e,t){return"number"!=typeof t&&(t=0),!(t+e.length>this.length)&&-1!==this.indexOf(e,t)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-polyfill-initializer/lib/function",["require","exports"],e)}((function(e,t){t.polyfillFunctionName=function(){Object.defineProperty(Function.prototype,"name",{get:function(){try{var e=this.toString().match(/\s*function\s+([_\$\w\d]*)\.*/)
	return e&&e.length>1?e[1]:""}catch(t){return""}}})}})),
	/*!
	* @overview es6-promise - a tiny implementation of Promises/A+.
	* @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	* @license   Licensed under MIT license
	*            See https://raw.githubusercontent.com/jakearchibald/es6-promise/master/LICENSE
	* @version   2.3.0
	*/
	function(){function e(e){return"function"==typeof e}var t,n,i=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,o=function(e,t){b[r]=e,b[r+1]=t,2===(r+=2)&&(n?n(_):p())}
	var a="undefined"!=typeof window?window:void 0,s=a||{},c=s.MutationObserver||s.WebKitMutationObserver,l="undefined"!=typeof process&&"[object process]"==={}.toString.call(process),u="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel
	function d(){return function(){setTimeout(_,1)}}var p,f,m,h,v,g,y,b=new Array(1e3)
	function _(){for(var e=0;e<r;e+=2){(0,b[e])(b[e+1]),b[e]=void 0,b[e+1]=void 0}r=0}function E(){}l?(g=process.nextTick,y=process.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/),Array.isArray(y)&&"0"===y[1]&&"10"===y[2]&&(g=setImmediate),p=function(){g(_)}):c?(m=0,h=new c(_),v=document.createTextNode(""),h.observe(v,{characterData:!0}),p=function(){v.data=m=++m%2}):u?((f=new MessageChannel).port1.onmessage=_,p=function(){f.port2.postMessage(0)}):p=void 0===a&&"function"==typeof require?function(){try{var e=require("vertx")
	return t=e.runOnLoop||e.runOnContext,function(){t(_)}}catch(n){return d()}}():d()
	var w=void 0,S=1,x=2,C=new P
	function T(t,n){if(n.constructor===t.constructor)(function(e,t){t._state===S?M(e,t._result):t._state===x?O(e,t._result):k(t,void 0,(function(t){I(e,t)}),(function(t){O(e,t)}))})(t,n)
	else{var i=function(e){try{return e.then}catch(t){return C.error=t,C}}(n)
	i===C?O(t,C.error):void 0===i?M(t,n):e(i)?function(e,t,n){o((function(e){var i=!1,r=function(e,t,n,i){try{e.call(t,n,i)}catch(r){return r}}(n,t,(function(n){i||(i=!0,t!==n?I(e,n):M(e,n))}),(function(t){i||(i=!0,O(e,t))}),e._label)
	!i&&r&&(i=!0,O(e,r))}),e)}(t,n,i):M(t,n)}}function I(e,t){var n
	e===t?O(e,new TypeError("You cannot resolve a promise with itself")):"function"==typeof(n=t)||"object"==typeof n&&null!==n?T(e,t):M(e,t)}function A(e){e._onerror&&e._onerror(e._result),N(e)}function M(e,t){e._state===w&&(e._result=t,e._state=S,0!==e._subscribers.length&&o(N,e))}function O(e,t){e._state===w&&(e._state=x,e._result=t,o(A,e))}function k(e,t,n,i){var r=e._subscribers,a=r.length
	e._onerror=null,r[a]=t,r[a+S]=n,r[a+x]=i,0===a&&e._state&&o(N,e)}function N(e){var t=e._subscribers,n=e._state
	if(0!==t.length){for(var i,r,o=e._result,a=0;a<t.length;a+=3)i=t[a],r=t[a+n],i?L(n,i,r,o):r(o)
	e._subscribers.length=0}}function P(){this.error=null}var R=new P
	function L(t,n,i,r){var o,a,s,c,l=e(i)
	if(l){if(o=function(e,t){try{return e(t)}catch(n){return R.error=n,R}}(i,r),o===R?(c=!0,a=o.error,o=null):s=!0,n===o)return void O(n,new TypeError("A promises callback cannot return that same promise."))}else o=r,s=!0
	n._state!==w||(l&&s?I(n,o):c?O(n,a):t===S?M(n,o):t===x&&O(n,o))}function D(e,t){var n=this
	n._instanceConstructor=e,n.promise=new e(E),n._validateInput(t)?(n._input=t,n.length=t.length,n._remaining=t.length,n._init(),0===n.length?M(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&M(n.promise,n._result))):O(n.promise,n._validationError())}D.prototype._validateInput=function(e){return i(e)},D.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},D.prototype._init=function(){this._result=new Array(this.length)}
	var U=D
	D.prototype._enumerate=function(){for(var e=this,t=e.length,n=e.promise,i=e._input,r=0;n._state===w&&r<t;r++)e._eachEntry(i[r],r)},D.prototype._eachEntry=function(e,t){var n,i=this,r=i._instanceConstructor
	"object"==typeof(n=e)&&null!==n?e.constructor===r&&e._state!==w?(e._onerror=null,i._settledAt(e._state,t,e._result)):i._willSettleAt(r.resolve(e),t):(i._remaining--,i._result[t]=e)},D.prototype._settledAt=function(e,t,n){var i=this,r=i.promise
	r._state===w&&(i._remaining--,e===x?O(r,n):i._result[t]=n),0===i._remaining&&M(r,i._result)},D.prototype._willSettleAt=function(e,t){var n=this
	k(e,void 0,(function(e){n._settledAt(S,t,e)}),(function(e){n._settledAt(x,t,e)}))}
	var F=function(e){return new U(this,e).promise}
	var B=function(e){var t=new this(E)
	if(!i(e))return O(t,new TypeError("You must pass an array to race.")),t
	var n=e.length
	function r(e){I(t,e)}function o(e){O(t,e)}for(var a=0;t._state===w&&a<n;a++)k(this.resolve(e[a]),void 0,r,o)
	return t}
	var V=function(e){if(e&&"object"==typeof e&&e.constructor===this)return e
	var t=new this(E)
	return I(t,e),t}
	var G=function(e){var t=new this(E)
	return O(t,e),t},H=0
	var q=W
	function W(t){this._id=H++,this._state=void 0,this._result=void 0,this._subscribers=[],E!==t&&(e(t)||function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof W||function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}(),function(e,t){try{t((function(t){I(e,t)}),(function(t){O(e,t)}))}catch(n){O(e,n)}}(this,t))}W.all=F,W.race=B,W.resolve=V,W.reject=G,W._setScheduler=function(e){n=e},W._setAsap=function(e){o=e},W._asap=o,W.prototype={constructor:W,then:function(e,t){var n=this,i=n._state
	if(i===S&&!e||i===x&&!t)return this
	var r=new this.constructor(E),a=n._result
	if(i){var s=arguments[i-1]
	o((function(){L(i,r,s,a)}))}else k(n,r,e,t)
	return r},catch:function(e){return this.then(null,e)}}
	var j=function(){var e
	if("undefined"!=typeof global)e=global
	else if("undefined"!=typeof self)e=self
	else try{e=Function("return this")()}catch(n){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise
	t&&"[object Promise]"===Object.prototype.toString.call(t.resolve())&&!t.cast||(e.Promise=q)},z={Promise:q,polyfill:j}
	"function"==typeof define&&define.amd?define("es6-promise/dist/es6-promise",[],(function(){return z})):"undefined"!=typeof module&&module.exports?module.exports=z:void 0!==this&&(this.ES6Promise=z),j()}.call(this),define("es6-promise",["es6-promise/dist/es6-promise"],(function(e){return e})),function(e){var t=e.HTMLCanvasElement&&e.HTMLCanvasElement.prototype,n=e.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),i=n&&e.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(e){return!1}}(),r=e.BlobBuilder||e.WebKitBlobBuilder||e.MozBlobBuilder||e.MSBlobBuilder,o=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,a=(n||r)&&e.atob&&e.ArrayBuffer&&e.Uint8Array&&function(e){var t,a,s,c,l,u,d,p,f
	if(!(t=e.match(o)))throw new Error("invalid data URI")
	for(a=t[2]?t[1]:"text/plain"+(t[3]||";charset=US-ASCII"),s=!!t[4],c=e.slice(t[0].length),l=s?atob(c):decodeURIComponent(c),u=new ArrayBuffer(l.length),d=new Uint8Array(u),p=0;p<l.length;p+=1)d[p]=l.charCodeAt(p)
	return n?new Blob([i?d:u],{type:a}):((f=new r).append(u),f.getBlob(a))}
	e.HTMLCanvasElement&&!t.toBlob&&(t.mozGetAsFile?t.toBlob=function(e,n,i){i&&t.toDataURL&&a?e(a(this.toDataURL(n,i))):e(this.mozGetAsFile("blob",n))}:t.toDataURL&&a&&(t.toBlob=function(e,t,n){e(a(this.toDataURL(t,n)))})),"function"==typeof define&&define.amd?define("blueimp-canvas-to-blob/js/canvas-to-blob",[],(function(){return a})):"object"==typeof module&&module.exports?module.exports=a:e.dataURLtoBlob=a}(window),define("blueimp-canvas-to-blob",["blueimp-canvas-to-blob/js/canvas-to-blob"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-polyfill-initializer/lib/polyfillInitializer",["require","exports","./string","./function","es6-promise","blueimp-canvas-to-blob"],e)}((function(e,t){var n=e("./string"),i=e("./function"),r=e("es6-promise")
	e("blueimp-canvas-to-blob"),r.polyfill(),void 0===String.prototype.localeCompare&&(String.prototype.localeCompare=n.localeCompare),void 0===Function.prototype.name&&i.polyfillFunctionName(),void 0===String.prototype.includes&&(String.prototype.includes=n.includes)})),define("swx-polyfill-initializer",["swx-polyfill-initializer/lib/polyfillInitializer"],(function(e){return e})),function(){var e,t,n,i=32,r=128,o=256,a="Expected a function",s="__lodash_placeholder__",c="[object Arguments]",l="[object Array]",u="[object Boolean]",d="[object Date]",p="[object Error]",f="[object Function]",m="[object Map]",h="[object Number]",v="[object Object]",g="[object RegExp]",y="[object Set]",b="[object String]",_="[object WeakMap]",E="[object ArrayBuffer]",w="[object Float32Array]",S="[object Float64Array]",x="[object Int8Array]",C="[object Int16Array]",T="[object Int32Array]",I="[object Uint8Array]",A="[object Uint8ClampedArray]",M="[object Uint16Array]",O="[object Uint32Array]",k=/\b__p \+= '';/g,N=/\b(__p \+=) '' \+/g,P=/(__e\(.*?\)|\b__t\)) \+\n'';/g,R=/&(?:amp|lt|gt|quot|#39|#96);/g,L=/[&<>"'`]/g,D=RegExp(R.source),U=RegExp(L.source),F=/<%-([\s\S]+?)%>/g,B=/<%([\s\S]+?)%>/g,V=/<%=([\s\S]+?)%>/g,G=/[\u0300-\u036f\ufe20-\ufe23]/g,H=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,q=/\w*$/,W=/^0[xX]/,j=/^\[object .+?Constructor\]$/,z=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,K=/($^)/,Y=/[.*+?^${}()|[\]\/\\]/g,Q=RegExp(Y.source),X=/['\n\r\u2028\u2029\\]/g,$=(t="[A-Z\\xc0-\\xd6\\xd8-\\xde]",n="[a-z\\xdf-\\xf6\\xf8-\\xff]+",RegExp(t+"+(?="+t+n+")|"+t+"?"+n+"|"+t+"+|[0-9]+","g")),J=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","document","isFinite","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","window"],Z=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],ee=-1,te={}
	te[w]=te[S]=te[x]=te[C]=te[T]=te[I]=te[A]=te[M]=te[O]=!0,te[c]=te[l]=te[E]=te[u]=te[d]=te[p]=te[f]=te[m]=te[h]=te[v]=te[g]=te[y]=te[b]=te[_]=!1
	var ne={}
	ne[c]=ne[l]=ne[E]=ne[u]=ne[d]=ne[w]=ne[S]=ne[x]=ne[C]=ne[T]=ne[h]=ne[v]=ne[g]=ne[b]=ne[I]=ne[A]=ne[M]=ne[O]=!0,ne[p]=ne[f]=ne[m]=ne[y]=ne[_]=!1
	var ie={leading:!1,maxWait:0,trailing:!1},re={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},oe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},ae={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},se={function:!0,object:!0},ce={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},le=se[typeof exports]&&exports&&!exports.nodeType&&exports,ue=se[typeof module]&&module&&!module.nodeType&&module,de=le&&ue&&"object"==typeof global&&global,pe=se[typeof self]&&self&&self.Object&&self,fe=se[typeof window]&&window&&window.Object&&window,me=ue&&ue.exports===le&&le,he=de||fe!==(this&&this.window)&&fe||pe||this
	function ve(e,t){if(e!==t){var n=e==e,i=t==t
	if(e>t||!n||void 0===e&&i)return 1
	if(e<t||!i||void 0===t&&n)return-1}return 0}function ge(e,t,n){for(var i=e.length,r=n?i:-1;n?r--:++r<i;)if(t(e[r],r,e))return r
	return-1}function ye(e,t,n){if(t!=t)return Ae(e,n)
	for(var i=n-1,r=e.length;++i<r;)if(e[i]===t)return i
	return-1}function be(e){return"function"==typeof e||!1}function _e(e){return"string"==typeof e?e:null==e?"":e+""}function Ee(e){return e.charCodeAt(0)}function we(e,t){for(var n=-1,i=e.length;++n<i&&t.indexOf(e.charAt(n))>-1;);return n}function Se(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}function xe(e,t){return ve(e.criteria,t.criteria)||e.index-t.index}function Ce(e){return re[e]}function Te(e){return oe[e]}function Ie(e){return"\\"+ce[e]}function Ae(e,t,n){for(var i=e.length,r=t+(n?0:-1);n?r--:++r<i;){var o=e[r]
	if(o!=o)return r}return-1}var Me=function(){try{Object({toString:0}+"")}catch(e){return function(){return!1}}return function(e){return"function"!=typeof e.toString&&"string"==typeof(e+"")}}()
	function Oe(e){return!!e&&"object"==typeof e}function ke(e){return e<=160&&e>=9&&e<=13||32==e||160==e||5760==e||6158==e||e>=8192&&(e<=8202||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function Ne(e,t){for(var n=-1,i=e.length,r=-1,o=[];++n<i;)e[n]===t&&(e[n]=s,o[++r]=n)
	return o}function Pe(e){for(var t=-1,n=e.length;++t<n&&ke(e.charCodeAt(t)););return t}function Re(e){for(var t=e.length;t--&&ke(e.charCodeAt(t)););return t}function Le(e){return ae[e]}var De=function t(n){var m=(n=n?De.defaults(he.Object(),n,De.pick(he,J)):he).Array,y=n.Date,_=n.Error,re=n.Function,oe=n.Math,ae=n.Number,se=n.Object,ce=n.RegExp,le=n.String,ue=n.TypeError,de=m.prototype,pe=_.prototype,fe=se.prototype,me=le.prototype,ke=(ke=n.window)&&ke.document,Ue=re.prototype.toString,Fe=mn("length"),Be=fe.hasOwnProperty,Ve=0,Ge=fe.toString,He=n._,qe=ce("^"+to(Ge).replace(/toString|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),We=kr(We=n.ArrayBuffer)&&We,je=kr(je=We&&new We(0).slice)&&je,ze=oe.ceil,Ke=n.clearTimeout,Ye=oe.floor,Qe=kr(Qe=se.getPrototypeOf)&&Qe,Xe=de.push,$e=fe.propertyIsEnumerable,Je=kr(Je=n.Set)&&Je,Ze=n.setTimeout,et=de.splice,tt=kr(tt=n.Uint8Array)&&tt,nt=kr(nt=n.WeakMap)&&nt,it=function(){try{var e=kr(e=n.Float64Array)&&e,t=new e(new We(10),0,1)&&e}catch(i){}return t}(),rt=kr(rt=m.isArray)&&rt,ot=kr(ot=se.create)&&ot,at=n.isFinite,st=kr(st=se.keys)&&st,ct=oe.max,lt=oe.min,ut=kr(ut=y.now)&&ut,dt=kr(dt=ae.isFinite)&&dt,pt=n.parseInt,ft=oe.random,mt=ae.NEGATIVE_INFINITY,ht=ae.POSITIVE_INFINITY,vt=oe.pow(2,32)-1,gt=vt-1,yt=vt>>>1,bt=it?it.BYTES_PER_ELEMENT:0,_t=oe.pow(2,53)-1,Et=nt&&new nt,wt={},St={}
	St[w]=n.Float32Array,St[S]=n.Float64Array,St[x]=n.Int8Array,St[C]=n.Int16Array,St[T]=n.Int32Array,St[I]=n.Uint8Array,St[A]=n.Uint8ClampedArray,St[M]=n.Uint16Array,St[O]=n.Uint32Array
	var xt={}
	function Ct(e){if(Oe(e)&&!Cr(e)&&!(e instanceof Mt)){if(e instanceof It)return e
	if(Be.call(e,"__chain__")&&Be.call(e,"__wrapped__"))return Ei(e)}return new It(e)}function Tt(){}function It(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}xt[l]=xt[d]=xt[h]={constructor:!0,toLocaleString:!0,toString:!0,valueOf:!0},xt[u]=xt[b]={constructor:!0,toString:!0,valueOf:!0},xt[p]=xt[f]=xt[g]={constructor:!0,toString:!0},xt[v]={constructor:!0},Rt(Z,(function(e){for(var t in xt)if(Be.call(xt,t)){var n=xt[t]
	n[e]=Be.call(n,e)}}))
	var At=Ct.support={}
	function Mt(e){this.__wrapped__=e,this.__actions__=null,this.__dir__=1,this.__dropCount__=0,this.__filtered__=!1,this.__iteratees__=null,this.__takeCount__=ht,this.__views__=null}function Ot(){this.__data__={}}function kt(e){var t=e?e.length:0
	for(this.data={hash:ot(null),set:new Je};t--;)this.push(e[t])}function Nt(e,t){var n=e.data
	return("string"==typeof t||Or(t)?n.set.has(t):n.hash[t])?0:-1}function Pt(e,t){var n=-1,i=e.length
	for(t||(t=m(i));++n<i;)t[n]=e[n]
	return t}function Rt(e,t){for(var n=-1,i=e.length;++n<i&&!1!==t(e[n],n,e););return e}function Lt(e,t){for(var n=-1,i=e.length;++n<i;)if(!t(e[n],n,e))return!1
	return!0}function Dt(e,t){for(var n=-1,i=e.length,r=-1,o=[];++n<i;){var a=e[n]
	t(a,n,e)&&(o[++r]=a)}return o}function Ut(e,t){for(var n=-1,i=e.length,r=m(i);++n<i;)r[n]=t(e[n],n,e)
	return r}function Ft(e){for(var t=-1,n=e.length,i=mt;++t<n;){var r=e[t]
	r>i&&(i=r)}return i}function Bt(e,t){for(var n=-1,i=e.length;++n<i;)if(t(e[n],n,e))return!0
	return!1}function Vt(e,t){return void 0===e?t:e}function Gt(e,t,n,i){return void 0!==e&&Be.call(i,n)?e:t}function Ht(e,t,n){var i=Kr(t)
	if(!n)return Wt(t,e,i)
	for(var r=-1,o=i.length;++r<o;){var a=i[r],s=e[a],c=n(s,t[a],a,e,t);((c==c?c!==s:s==s)||void 0===s&&!(a in e))&&(e[a]=c)}return e}function qt(t,n){for(var i=-1,r=t.length,o=ui(r),a=n.length,s=m(a);++i<a;){var c=n[i]
	o?(c=parseFloat(c),s[i]=si(c,r)?t[c]:e):s[i]=t[c]}return s}function Wt(e,t,n){n||(n=t,t={})
	for(var i=-1,r=n.length;++i<r;){var o=n[i]
	t[o]=e[o]}return t}function jt(e,t,n){var i=typeof e
	return"function"==i?void 0===t?e:In(e,t,n):null==e?ho:"object"==i?pn(e):void 0===t?mn(e+""):fn(e+"",t)}function zt(e,t,n,i,r,o,a){var s
	if(n&&(s=r?n(e,i,r):n(e)),void 0!==s)return s
	if(!Or(e))return e
	var l=Cr(e)
	if(l){if(s=function(e){var t=e.length,n=new e.constructor(t)
	t&&"string"==typeof e[0]&&Be.call(e,"index")&&(n.index=e.index,n.input=e.input)
	return n}(e),!t)return Pt(e,s)}else{var p=Ge.call(e),m=p==f
	if(p!=v&&p!=c&&(!m||r))return ne[p]?function(e,t,n){var i=e.constructor
	switch(t){case E:return An(e)
	case u:case d:return new i(+e)
	case w:case S:case x:case C:case T:case I:case A:case M:case O:i instanceof i&&(i=St[t])
	var r=e.buffer
	return new i(n?An(r):r,e.byteOffset,e.length)
	case h:case b:return new i(e)
	case g:var o=new i(e.source,q.exec(e))
	o.lastIndex=e.lastIndex}return o}(e,p,t):r?e:{}
	if(Me(e))return r?e:{}
	if(s=function(e){var t=e.constructor
	"function"==typeof t&&t instanceof t||(t=se)
	return new t}(m?{}:e),!t)return Wt(e,s,Kr(e))}o||(o=[]),a||(a=[])
	for(var y=o.length;y--;)if(o[y]==e)return a[y]
	return o.push(e),a.push(s),(l?Rt:an)(e,(function(i,r){s[r]=zt(i,t,n,r,e,o,a)})),s}(function(e){var t=function(){this.x=1},n={0:1,length:1},i=[]
	for(var r in t.prototype={valueOf:1,y:1},new t)i.push(r)
	At.argsTag=Ge.call(arguments)==c,At.enumErrorProps=$e.call(pe,"message")||$e.call(pe,"name"),At.enumPrototypes=$e.call(t,"prototype"),At.funcDecomp=/\bthis\b/.test((function(){return this})),At.funcNames="string"==typeof re.name,At.nodeTag=Ge.call(ke)!=v,At.nonEnumStrings=!$e.call("x",0),At.nonEnumShadows=!/valueOf/.test(i),At.ownLast="x"!=i[0],At.spliceObjects=(et.call(n,0,1),!n[0]),At.unindexedChars="x"[0]+se("x")[0]!="xx"
	try{At.dom=11===ke.createDocumentFragment().nodeType}catch(o){At.dom=!1}try{At.nonEnumArgs=!$e.call(arguments,1)}catch(o){At.nonEnumArgs=!0}})(0,0),Ct.templateSettings={escape:F,evaluate:B,interpolate:V,variable:"",imports:{_:Ct}}
	var Kt=function(){function e(){}return function(t){if(Or(t)){e.prototype=t
	var i=new e
	e.prototype=null}return i||n.Object()}}()
	function Yt(t,n,i){if("function"!=typeof t)throw new ue(a)
	return Ze((function(){t.apply(e,i)}),n)}function Qt(e,t){var n=e?e.length:0,i=[]
	if(!n)return i
	var r=-1,o=ai(),a=o==ye,s=a&&t.length>=200?Ln(t):null,c=t.length
	s&&(o=Nt,a=!1,t=s)
	e:for(;++r<n;){var l=e[r]
	if(a&&l==l){for(var u=c;u--;)if(t[u]===l)continue e
	i.push(l)}else o(t,l,0)<0&&i.push(l)}return i}var Xt=Pn(an),$t=Pn(sn,!0)
	function Jt(e,t){var n=!0
	return Xt(e,(function(e,i,r){return n=!!t(e,i,r)})),n}function Zt(e,t){var n=[]
	return Xt(e,(function(e,i,r){t(e,i,r)&&n.push(e)})),n}function en(e,t,n,i){var r
	return n(e,(function(e,n,o){if(t(e,n,o))return r=i?n:e,!1})),r}function tn(e,t,n){for(var i=-1,r=e.length,o=-1,a=[];++i<r;){var s=e[i]
	if(Oe(s)&&ui(s.length)&&(Cr(s)||xr(s))){t&&(s=tn(s,t,n))
	var c=-1,l=s.length
	for(a.length+=l;++c<l;)a[++o]=s[c]}else n||(a[++o]=s)}return a}var nn=Rn(),rn=Rn(!0)
	function on(e,t){return nn(e,t,Yr)}function an(e,t){return nn(e,t,Kr)}function sn(e,t){return rn(e,t,Kr)}function cn(e,t){for(var n=-1,i=t.length,r=-1,o=[];++n<i;){var a=t[n]
	Mr(e[a])&&(o[++r]=a)}return o}function ln(e,t,n,i,r,o){if(e===t)return 0!==e||1/e==1/t
	var a=typeof e,s=typeof t
	return"function"!=a&&"object"!=a&&"function"!=s&&"object"!=s||null==e||null==t?e!=e&&t!=t:function(e,t,n,i,r,o,a){var s=Cr(e),m=Cr(t),y=l,_=l
	s||((y=Ge.call(e))==c?y=v:y!=v&&(s=Dr(e)))
	m||((_=Ge.call(t))==c?_=v:_!=v&&(m=Dr(t)))
	var E=(y==v||r&&y==f)&&!Me(e),w=(_==v||r&&_==f)&&!Me(t),S=y==_
	if(S&&!s&&!E)return function(e,t,n){switch(n){case u:case d:return+e==+t
	case p:return e.name==t.name&&e.message==t.message
	case h:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t
	case g:case b:return e==t+""}return!1}(e,t,y)
	if(r){if(!(S||E&&w))return!1}else{var x=E&&Be.call(e,"__wrapped__"),C=w&&Be.call(t,"__wrapped__")
	if(x||C)return n(x?e.value():e,C?t.value():t,i,r,o,a)
	if(!S)return!1}o||(o=[]),a||(a=[])
	var T=o.length
	for(;T--;)if(o[T]==e)return a[T]==t
	o.push(e),a.push(t)
	var I=(s?ti:ni)(e,t,n,i,r,o,a)
	return o.pop(),a.pop(),I}(e,t,ln,n,i,r,o)}function un(t,n,i,r,o){for(var a=-1,s=n.length,c=!o;++a<s;)if(c&&r[a]?i[a]!==t[n[a]]:!(n[a]in t))return!1
	for(a=-1;++a<s;){var l=n[a],u=t[l],d=i[a]
	if(c&&r[a])var p=void 0!==u||l in t
	else void 0===(p=o?o(u,d,l):e)&&(p=ln(d,u,o,!0))
	if(!p)return!1}return!0}function dn(e,t){var n=[]
	return Xt(e,(function(e,i,r){n.push(t(e,i,r))})),n}function pn(e){var t=Kr(e),n=t.length
	if(!n)return mo(!0)
	if(1==n){var i=t[0],r=e[i]
	if(di(r))return function(e){return null!=e&&e[i]===r&&(void 0!==r||i in _i(e))}}for(var o=m(n),a=m(n);n--;)r=e[t[n]],o[n]=r,a[n]=di(r)
	return function(e){return null!=e&&un(_i(e),t,o,a)}}function fn(e,t){return di(t)?function(n){return null!=n&&n[e]===t&&(void 0!==t||e in _i(n))}:function(n){return null!=n&&ln(t,n[e],null,!0)}}function mn(t){return function(n){return null==n?e:n[t]}}function hn(e,t){return e+Ye(ft()*(t-e+1))}var vn=Et?function(e,t){return Et.set(e,t),e}:ho
	function gn(e,t,n){var i=-1,r=e.length;(t=null==t?0:+t||0)<0&&(t=-t>r?0:r+t),(n=void 0===n||n>r?r:+n||0)<0&&(n+=r),r=t>n?0:n-t>>>0,t>>>=0
	for(var o=m(r);++i<r;)o[i]=e[i+t]
	return o}function yn(e,t){var n
	return Xt(e,(function(e,i,r){return!(n=t(e,i,r))})),!!n}function bn(e,t){var n=e.length
	for(e.sort(t);n--;)e[n]=e[n].value
	return e}function _n(t,n,i){var r=-1,o=t.length,a=ui(o)?m(o):[]
	return Xt(t,(function(t){for(var i=n.length,o=m(i);i--;)o[i]=null==t?e:t[n[i]]
	a[++r]={criteria:o,index:r,value:t}})),bn(a,(function(e,t){return function(e,t,n){for(var i=-1,r=e.criteria,o=t.criteria,a=r.length,s=n.length;++i<a;){var c=ve(r[i],o[i])
	if(c)return i>=s?c:c*(n[i]?1:-1)}return e.index-t.index}(e,t,i)}))}function En(e,t){var n=-1,i=ai(),r=e.length,o=i==ye,a=o&&r>=200,s=a?Ln():null,c=[]
	s?(i=Nt,o=!1):(a=!1,s=t?[]:c)
	e:for(;++n<r;){var l=e[n],u=t?t(l,n,e):l
	if(o&&l==l){for(var d=s.length;d--;)if(s[d]===u)continue e
	t&&s.push(u),c.push(l)}else i(s,u,0)<0&&((t||a)&&s.push(u),c.push(l))}return c}function wn(e,t){for(var n=-1,i=t.length,r=m(i);++n<i;)r[n]=e[t[n]]
	return r}function Sn(e,t,n,i){for(var r=e.length,o=i?r:-1;(i?o--:++o<r)&&t(e[o],o,e););return n?gn(e,i?0:o,i?o+1:r):gn(e,i?o+1:0,i?r:o)}function xn(e,t){var n=e
	n instanceof Mt&&(n=n.value())
	for(var i=-1,r=t.length;++i<r;){var o=[n],a=t[i]
	Xe.apply(o,a.args),n=a.func.apply(a.thisArg,o)}return n}function Cn(e,t,n){var i=0,r=e?e.length:i
	if("number"==typeof t&&t==t&&r<=yt){for(;i<r;){var o=i+r>>>1,a=e[o];(n?a<=t:a<t)?i=o+1:r=o}return r}return Tn(e,t,ho,n)}function Tn(e,t,n,i){t=n(t)
	for(var r=0,o=e?e.length:0,a=t!=t,s=void 0===t;r<o;){var c=Ye((r+o)/2),l=n(e[c]),u=l==l
	if(a)var d=u||i
	else d=s?u&&(i||void 0!==l):i?l<=t:l<t
	d?r=c+1:o=c}return lt(o,gt)}function In(e,t,n){if("function"!=typeof e)return ho
	if(void 0===t)return e
	switch(n){case 1:return function(n){return e.call(t,n)}
	case 3:return function(n,i,r){return e.call(t,n,i,r)}
	case 4:return function(n,i,r,o){return e.call(t,n,i,r,o)}
	case 5:return function(n,i,r,o,a){return e.call(t,n,i,r,o,a)}}return function(){return e.apply(t,arguments)}}function An(e){return je.call(e,0)}function Mn(e,t,n){for(var i=n.length,r=-1,o=ct(e.length-i,0),a=-1,s=t.length,c=m(o+s);++a<s;)c[a]=t[a]
	for(;++r<i;)c[n[r]]=e[r]
	for(;o--;)c[a++]=e[r++]
	return c}function On(e,t,n){for(var i=-1,r=n.length,o=-1,a=ct(e.length-r,0),s=-1,c=t.length,l=m(a+c);++o<a;)l[o]=e[o]
	for(var u=o;++s<c;)l[u+s]=t[s]
	for(;++i<r;)l[u+n[i]]=e[o++]
	return l}function kn(e,t){return function(n,i,r){var o=t?t():{}
	if(i=ii(i,r,3),Cr(n))for(var a=-1,s=n.length;++a<s;){var c=n[a]
	e(o,c,i(c,a,n),n)}else Xt(n,(function(t,n,r){e(o,t,i(t,n,r),r)}))
	return o}}function Nn(e){return function(){var t=arguments,n=t.length,i=t[0]
	if(n<2||null==i)return i
	var r=t[n-2],o=t[n-1],a=t[3]
	n>3&&"function"==typeof r?(r=In(r,o,5),n-=2):n-=(r=n>2&&"function"==typeof o?o:null)?1:0,a&&ci(t[1],t[2],a)&&(r=3==n?null:r,n=2)
	for(var s=0;++s<n;){var c=t[s]
	c&&e(i,c,r)}return i}}function Pn(e,t){return function(n,i){var r=n?n.length:0
	if(!ui(r))return e(n,i)
	for(var o=t?r:-1,a=_i(n);(t?o--:++o<r)&&!1!==i(a[o],o,a););return n}}function Rn(e){return function(t,n,i){for(var r=_i(t),o=i(t),a=o.length,s=e?a:-1;e?s--:++s<a;){var c=o[s]
	if(!1===n(r[c],c,r))break}return t}}je||(An=We&&tt?function(e){var t=e.byteLength,n=it?Ye(t/bt):0,i=n*bt,r=new We(t)
	if(n){var o=new it(r,0,n)
	o.set(new it(e,0,n))}return t!=i&&(o=new tt(r,i)).set(new tt(e,i)),r}:mo(null))
	var Ln=ot&&Je?function(e){return new kt(e)}:mo(null)
	function Dn(e){return function(t){for(var n=-1,i=uo(eo(t)),r=i.length,o="";++n<r;)o=e(o,i[n],n)
	return o}}function Un(e){return function(){var t=Kt(e.prototype),n=e.apply(t,arguments)
	return Or(n)?n:t}}function Fn(e){return function t(n,i,r){r&&ci(n,i,r)&&(i=null)
	var o=ei(n,e,null,null,null,null,null,i)
	return o.placeholder=t.placeholder,o}}function Bn(e,t){return function(n,i,r){r&&ci(n,i,r)&&(i=null)
	var o=ii(),a=null==i
	if(o===jt&&a||(a=!1,i=o(i,r,3)),a){var s=Cr(n)
	if(s||!Lr(n))return e(s?n:bi(n))
	i=Ee}return function(e,t,n){var i=n?ht:mt,r=i,o=r
	return Xt(e,(function(e,a,s){var c=t(e,a,s);((n?c<r:c>r)||c===i&&c===o)&&(r=c,o=e)})),o}(n,i,t)}}function Vn(t,n){return function(i,r,o){if(r=ii(r,o,3),Cr(i)){var a=ge(i,r,n)
	return a>-1?i[a]:e}return en(i,r,t)}}function Gn(e){return function(t,n,i){return t&&t.length?ge(t,n=ii(n,i,3),e):-1}}function Hn(e){return function(t,n,i){return en(t,n=ii(n,i,3),e,!0)}}function qn(e){return function(){var t=arguments.length
	if(!t)return function(){return arguments[0]}
	for(var n,i=e?t:-1,r=0,o=m(t);e?i--:++i<t;){var s=o[r++]=arguments[i]
	if("function"!=typeof s)throw new ue(a)
	var c=n?"":oi(s)
	n="wrapper"==c?new It([]):n}for(i=n?-1:t;++i<t;){s=o[i]
	var l="wrapper"==(c=oi(s))?ri(s):null
	n=l&&li(l[0])?n[oi(l[0])].apply(n,l[3]):1==s.length&&li(s)?n[c]():n.thru(s)}return function(){var e=arguments
	if(n&&1==e.length&&Cr(e[0]))return n.plant(e[0]).value()
	for(var i=0,r=o[i].apply(this,e);++i<t;)r=o[i].call(this,r)
	return r}}}function Wn(e,t){return function(n,i,r){return"function"==typeof i&&void 0===r&&Cr(n)?e(n,i):t(n,In(i,r,3))}}function jn(e){return function(t,n,i){return"function"==typeof n&&void 0===i||(n=In(n,i,3)),e(t,n,Yr)}}function zn(e){return function(t,n,i){return"function"==typeof n&&void 0===i||(n=In(n,i,3)),e(t,n)}}function Kn(e){return function(t,n,i){return(t=_e(t))&&(e?t:"")+$n(t,n,i)+(e?"":t)}}function Yn(e){var t=Sr((function(n,i){var r=Ne(i,t.placeholder)
	return ei(n,e,null,i,r)}))
	return t}function Qn(e,t){return function(n,i,r,o){var a=arguments.length<3
	return"function"==typeof i&&void 0===o&&Cr(n)?e(n,i,r,a):function(e,t,n,i,r){return r(e,(function(e,r,o){n=i?(i=!1,e):t(n,e,r,o)})),n}(n,ii(i,o,4),r,a,t)}}function Xn(t,n,o,a,s,c,l,u,d,p){var f=n&r,h=1&n,v=2&n,g=8&n,y=4&n,b=16&n,_=!v&&Un(t),E=t
	return function r(){for(var w=arguments.length,S=w,x=m(w);S--;)x[S]=arguments[S]
	if(a&&(x=Mn(x,a,s)),c&&(x=On(x,c,l)),g||b){var C=r.placeholder,T=Ne(x,C)
	if((w-=T.length)<p){var I=u?Pt(u):null,A=ct(p-w,0)
	n|=g?i:64,n&=~(g?64:i),y||(n&=-4)
	var M=[t,n,o,g?x:null,g?T:null,g?null:x,g?null:T,I,d,A],O=Xn.apply(e,M)
	return li(t)&&vi(O,M),O.placeholder=C,O}}var k=h?o:this
	return v&&(t=k[E]),u&&(x=function(t,n){var i=t.length,r=lt(n.length,i),o=Pt(t)
	for(;r--;){var a=n[r]
	t[r]=si(a,i)?o[a]:e}return t}(x,u)),f&&d<x.length&&(x.length=d),(this&&this!==he&&this instanceof r?_||Un(t):t).apply(k,x)}}function $n(e,t,n){var i=e.length
	if(i>=(t=+t)||!at(t))return""
	var r=t-i
	return ao(n=null==n?" ":n+"",ze(r/n.length)).slice(0,r)}function Jn(e,t,n,i){var r=1&t,o=Un(e)
	return function t(){for(var a=-1,s=arguments.length,c=-1,l=i.length,u=m(s+l);++c<l;)u[c]=i[c]
	for(;s--;)u[c++]=arguments[++a]
	return(this&&this!==he&&this instanceof t?o:e).apply(r?n:this,u)}}function Zn(e){return function(t,n,i,r){var o=ii(i)
	return o===jt&&null==i?Cn(t,n,e):Tn(t,n,o(i,r,1),e)}}function ei(t,n,c,l,u,d,p,f){var m=2&n
	if(!m&&"function"!=typeof t)throw new ue(a)
	var h=l?l.length:0
	if(h||(n&=-97,l=u=null),h-=u?u.length:0,64&n){var v=l,g=u
	l=u=null}var y=m?null:ri(t),b=[t,n,c,l,u,v,g,d,p,f]
	if(y&&(function(e,t){var n=e[1],i=t[1],a=n|i,c=a<r,l=i==r&&8==n||i==r&&n==o&&e[7].length<=t[8]||384==i&&8==n
	if(!c&&!l)return e
	1&i&&(e[2]=t[2],a|=1&n?0:4)
	var u=t[3]
	if(u){var d=e[3]
	e[3]=d?Mn(d,u,t[4]):Pt(u),e[4]=d?Ne(e[3],s):Pt(t[4])}(u=t[5])&&(d=e[5],e[5]=d?On(d,u,t[6]):Pt(u),e[6]=d?Ne(e[5],s):Pt(t[6]));(u=t[7])&&(e[7]=Pt(u))
	i&r&&(e[8]=null==e[8]?t[8]:lt(e[8],t[8]))
	null==e[9]&&(e[9]=t[9])
	e[0]=t[0],e[1]=a}(b,y),n=b[1],f=b[9]),b[9]=null==f?m?0:t.length:ct(f-h,0)||0,1==n)var _=function(e,t){var n=Un(e)
	return function i(){return(this&&this!==he&&this instanceof i?n:e).apply(t,arguments)}}(b[0],b[2])
	else _=n!=i&&33!=n||b[4].length?Xn.apply(e,b):Jn.apply(e,b)
	return(y?vn:vi)(_,b)}function ti(t,n,i,r,o,a,s){var c=-1,l=t.length,u=n.length,d=!0
	if(l!=u&&!(o&&u>l))return!1
	for(;d&&++c<l;){var p=t[c],f=n[c]
	if(d=e,r&&(d=o?r(f,p,c):r(p,f,c)),void 0===d)if(o)for(var m=u;m--&&(f=n[m],!(d=p&&p===f||i(p,f,r,o,a,s))););else d=p&&p===f||i(p,f,r,o,a,s)}return!!d}function ni(t,n,i,r,o,a,s){var c=Kr(t),l=c.length
	if(l!=Kr(n).length&&!o)return!1
	for(var u=o,d=-1;++d<l;){var p=c[d],f=o?p in n:Be.call(n,p)
	if(f){var m=t[p],h=n[p]
	f=e,r&&(f=o?r(h,m,p):r(m,h,p)),void 0===f&&(f=m&&m===h||i(m,h,r,o,a,s))}if(!f)return!1
	u||(u="constructor"==p)}if(!u){var v=t.constructor,g=n.constructor
	if(v!=g&&"constructor"in t&&"constructor"in n&&!("function"==typeof v&&v instanceof v&&"function"==typeof g&&g instanceof g))return!1}return!0}function ii(e,t,n){var i=Ct.callback||fo
	return i=i===fo?jt:i,n?i(e,t,n):i}var ri=Et?function(e){return Et.get(e)}:yo,oi=At.funcNames?"constant"==mo.name?mn("name"):function(e){for(var t=e.name,n=wt[t],i=n?n.length:0;i--;){var r=n[i],o=r.func
	if(null==o||o==e)return r.name}return t}:mo("")
	function ai(e,t,n){var i=Ct.indexOf||Ai
	return i=i===Ai?ye:i,e?i(e,t,n):i}function si(e,t){return t=null==t?_t:t,(e=+e)>-1&&e%1==0&&e<t}function ci(e,t,n){if(!Or(n))return!1
	var i=typeof t
	if("number"==i)var r=n.length,o=ui(r)&&si(t,r)
	else o="string"==i&&t in n
	if(o){var a=n[t]
	return e==e?e===a:a!=a}return!1}function li(e){var t=oi(e)
	return!!t&&e===Ct[t]&&t in Mt.prototype}function ui(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=_t}function di(e){return e==e&&(0===e?1/e>0:!Or(e))}function pi(e,t){e=_i(e)
	for(var n=-1,i=t.length,r={};++n<i;){var o=t[n]
	o in e&&(r[o]=e[o])}return r}function fi(e,t){var n={}
	return on(e,(function(e,i,r){t(e,i,r)&&(n[i]=e)})),n}var mi,hi,vi=(mi=0,hi=0,function(e,t){var n=sr(),i=16-(n-hi)
	if(hi=n,i>0){if(++mi>=150)return e}else mi=0
	return vn(e,t)})
	function gi(e){var t,n,i=Ct.support
	return!(!Oe(e)||Ge.call(e)!=v||Me(e)||!Be.call(e,"constructor")&&!("function"!=typeof(t=e.constructor)||t instanceof t)||!i.argsTag&&xr(e))&&(i.ownLast?(on(e,(function(e,t,i){return n=Be.call(i,t),!1})),!1!==n):(on(e,(function(e,t){n=t})),void 0===n||Be.call(e,n)))}function yi(e){for(var t=Yr(e),n=t.length,i=n&&e.length,r=Ct.support,o=i&&ui(i)&&(Cr(e)||r.nonEnumStrings&&Lr(e)||r.nonEnumArgs&&xr(e)),a=-1,s=[];++a<n;){var c=t[a];(o&&si(c,i)||Be.call(e,c))&&s.push(c)}return s}function bi(e){return null==e?[]:ui(e.length)?Ct.support.unindexedChars&&Lr(e)?e.split(""):Or(e)?e:se(e):Jr(e)}function _i(e){if(Ct.support.unindexedChars&&Lr(e)){for(var t=-1,n=e.length,i=se(e);++t<n;)i[t]=e.charAt(t)
	return i}return Or(e)?e:se(e)}function Ei(e){return e instanceof Mt?e.clone():new It(e.__wrapped__,e.__chain__,Pt(e.__actions__))}var wi=Sr((function(e,t){return Cr(e)||xr(e)?Qt(e,tn(t,!1,!0)):[]}))
	function Si(e,t,n){return(e?e.length:0)?((n?ci(e,t,n):null==t)&&(t=1),gn(e,t<0?0:t)):[]}function xi(e,t,n){var i=e?e.length:0
	return i?((n?ci(e,t,n):null==t)&&(t=1),gn(e,0,(t=i-(+t||0))<0?0:t)):[]}var Ci=Gn(),Ti=Gn(!0)
	function Ii(t){return t?t[0]:e}function Ai(e,t,n){var i=e?e.length:0
	if(!i)return-1
	if("number"==typeof n)n=n<0?ct(i+n,0):n
	else if(n){var r=Cn(e,t),o=e[r]
	return(t==t?t===o:o!=o)?r:-1}return ye(e,t,n||0)}function Mi(t){var n=t?t.length:0
	return n?t[n-1]:e}var Oi=Sr((function(e,t){e||(e=[])
	var n=(t=tn(t)).length,i=qt(e,t)
	for(t.sort(ve);n--;){var r=parseFloat(t[n])
	if(r!=o&&si(r)){var o=r
	et.call(e,r,1)}}return i}))
	function ki(e){return Si(e,1)}var Ni=Zn(),Pi=Zn(!0),Ri=Sr((function(e){return En(tn(e,!1,!0))}))
	function Li(e,t,n,i){if(!(e?e.length:0))return[]
	null!=t&&"boolean"!=typeof t&&(n=ci(e,t,i=n)?null:t,t=!1)
	var r=ii()
	return r===jt&&null==n||(n=r(n,i,3)),t&&ai()==ye?function(e,t){for(var n,i=-1,r=e.length,o=-1,a=[];++i<r;){var s=e[i],c=t?t(s,i,e):s
	i&&n===c||(n=c,a[++o]=s)}return a}(e,n):En(e,n)}function Di(e){for(var t=-1,n=(e&&e.length&&Ft(Ut(e,Fe)))>>>0,i=m(n);++t<n;)i[t]=Ut(e,mn(t))
	return i}var Ui=Sr((function(e,t){return Cr(e)||xr(e)?Qt(e,t):[]})),Fi=Sr(Di)
	function Bi(e,t){var n=-1,i=e?e.length:0,r={}
	for(!i||t||Cr(e[0])||(t=[]);++n<i;){var o=e[n]
	t?r[o]=t[n]:o&&(r[o[0]]=o[1])}return r}function Vi(e){var t=Ct(e)
	return t.__chain__=!0,t}function Gi(e,t,n){return t.call(n,e)}var Hi=Sr((function(e,t){return ui(e?e.length:0)&&(e=bi(e)),qt(e,tn(t))})),qi=kn((function(e,t,n){Be.call(e,n)?++e[n]:e[n]=1}))
	function Wi(e,t,n){var i=Cr(e)?Lt:Jt
	return n&&ci(e,t,n)&&(t=null),"function"==typeof t&&void 0===n||(t=ii(t,n,3)),i(e,t)}function ji(e,t,n){return(Cr(e)?Dt:Zt)(e,t=ii(t,n,3))}var zi=Vn(Xt),Ki=Vn($t,!0),Yi=Wn(Rt,Xt),Qi=Wn((function(e,t){for(var n=e.length;n--&&!1!==t(e[n],n,e););return e}),$t),Xi=kn((function(e,t,n){Be.call(e,n)?e[n].push(t):e[n]=[t]}))
	function $i(e,t,n,i){var r=e?e.length:0
	return ui(r)||(r=(e=Jr(e)).length),!!r&&(n="number"!=typeof n||i&&ci(t,n,i)?0:n<0?ct(r+n,0):n||0,"string"==typeof e||!Cr(e)&&Lr(e)?n<r&&e.indexOf(t,n)>-1:ai(e,t,n)>-1)}var Ji=kn((function(e,t,n){e[n]=t})),Zi=Sr((function(t,n,i){var r=-1,o="function"==typeof n,a=t?t.length:0,s=ui(a)?m(a):[]
	return Xt(t,(function(t){var a=o?n:null!=t&&t[n]
	s[++r]=a?a.apply(t,i):e})),s}))
	function er(e,t,n){return(Cr(e)?Ut:dn)(e,t=ii(t,n,3))}var tr=kn((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),nr=Qn((function(e,t,n,i){var r=-1,o=e.length
	for(i&&o&&(n=e[++r]);++r<o;)n=t(n,e[r],r,e)
	return n}),Xt),ir=Qn((function(e,t,n,i){var r=e.length
	for(i&&r&&(n=e[--r]);r--;)n=t(n,e[r],r,e)
	return n}),$t)
	function rr(t,n,i){if(i?ci(t,n,i):null==n){var r=(t=bi(t)).length
	return r>0?t[hn(0,r-1)]:e}var o=or(t)
	return o.length=lt(n<0?0:+n||0,o.length),o}function or(e){for(var t=-1,n=(e=bi(e)).length,i=m(n);++t<n;){var r=hn(0,t)
	t!=r&&(i[t]=i[r]),i[r]=e[t]}return i}function ar(e,t,n){var i=Cr(e)?Bt:yn
	return n&&ci(e,t,n)&&(t=null),"function"==typeof t&&void 0===n||(t=ii(t,n,3)),i(e,t)}var sr=ut||function(){return(new y).getTime()}
	function cr(e,t){var n
	if("function"!=typeof t){if("function"!=typeof e)throw new ue(a)
	var i=e
	e=t,t=i}return function(){return--e>0?n=t.apply(this,arguments):t=null,n}}var lr=Sr((function(e,t,n){var r=1
	if(n.length){var o=Ne(n,lr.placeholder)
	r|=i}return ei(e,r,t,n,o)})),ur=Sr((function(e,t){for(var n=-1,i=(t=t.length?tn(t):zr(e)).length;++n<i;){var r=t[n]
	e[r]=ei(e[r],1,e)}return e})),dr=Sr((function(e,t,n){var r=3
	if(n.length){var o=Ne(n,dr.placeholder)
	r|=i}return ei(t,r,e,n,o)})),pr=Fn(8),fr=Fn(16)
	function mr(t,n,i){var r,o,s,c,l,u,d,p=0,f=!1,m=!0
	if("function"!=typeof t)throw new ue(a)
	if(n=n<0?0:+n||0,!0===i){var h=!0
	m=!1}else Or(i)&&(h=i.leading,f="maxWait"in i&&ct(+i.maxWait||0,n),m="trailing"in i?i.trailing:m)
	function v(){var i=n-(sr()-c)
	if(i<=0||i>n){o&&Ke(o)
	var a=d
	o=u=d=e,a&&(p=sr(),s=t.apply(l,r),u||o||(r=l=null))}else u=Ze(v,i)}function g(){u&&Ke(u),o=u=d=e,(m||f!==n)&&(p=sr(),s=t.apply(l,r),u||o||(r=l=null))}function y(){if(r=arguments,c=sr(),l=this,d=m&&(u||!h),!1===f)var e=h&&!u
	else{o||h||(p=c)
	var i=f-(c-p),a=i<=0||i>f
	a?(o&&(o=Ke(o)),p=c,s=t.apply(l,r)):o||(o=Ze(g,i))}return a&&u?u=Ke(u):u||n===f||(u=Ze(v,n)),e&&(a=!0,s=t.apply(l,r)),!a||u||o||(r=l=null),s}return y.cancel=function(){u&&Ke(u),o&&Ke(o),o=u=d=e},y}var hr=Sr((function(e,t){return Yt(e,1,t)})),vr=Sr((function(e,t,n){return Yt(e,t,n)})),gr=qn(),yr=qn(!0)
	function br(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new ue(a)
	var n=function(){var i=arguments,r=n.cache,o=t?t.apply(this,i):i[0]
	if(r.has(o))return r.get(o)
	var a=e.apply(this,i)
	return r.set(o,a),a}
	return n.cache=new br.Cache,n}var _r=Yn(i),Er=Yn(64),wr=Sr((function(e,t){return ei(e,o,null,null,null,tn(t))}))
	function Sr(e,t){if("function"!=typeof e)throw new ue(a)
	return t=ct(void 0===t?e.length-1:+t||0,0),function(){for(var n=arguments,i=-1,r=ct(n.length-t,0),o=m(r);++i<r;)o[i]=n[t+i]
	switch(t){case 0:return e.call(this,o)
	case 1:return e.call(this,n[0],o)
	case 2:return e.call(this,n[0],n[1],o)}var a=m(t+1)
	for(i=-1;++i<t;)a[i]=n[i]
	return a[t]=o,e.apply(this,a)}}function xr(t){return ui(Oe(t)?t.length:e)&&Ge.call(t)==c}At.argsTag||(xr=function(t){return ui(Oe(t)?t.length:e)&&Be.call(t,"callee")&&!$e.call(t,"callee")})
	var Cr=rt||function(e){return Oe(e)&&ui(e.length)&&Ge.call(e)==l}
	function Tr(e){return!!e&&1===e.nodeType&&Oe(e)&&(Ct.support.nodeTag?Ge.call(e).indexOf("Element")>-1:Me(e))}function Ir(e){return Oe(e)&&"string"==typeof e.message&&Ge.call(e)==p}At.dom||(Tr=function(e){return!!e&&1===e.nodeType&&Oe(e)&&!Pr(e)})
	var Ar=dt||function(e){return"number"==typeof e&&at(e)},Mr=be(/x/)||tt&&!be(tt)?function(e){return Ge.call(e)==f}:be
	function Or(e){var t=typeof e
	return"function"==t||!!e&&"object"==t}function kr(e){return null!=e&&(Ge.call(e)==f?qe.test(Ue.call(e)):Oe(e)&&(Me(e)?qe:j).test(e))}function Nr(e){return"number"==typeof e||Oe(e)&&Ge.call(e)==h}var Pr=Qe?function(e){if(!e||Ge.call(e)!=v||!Ct.support.argsTag&&xr(e))return!1
	var t=e.valueOf,n=kr(t)&&(n=Qe(t))&&Qe(n)
	return n?e==n||Qe(e)==n:gi(e)}:gi
	function Rr(e){return Or(e)&&Ge.call(e)==g}function Lr(e){return"string"==typeof e||Oe(e)&&Ge.call(e)==b}function Dr(e){return Oe(e)&&ui(e.length)&&!!te[Ge.call(e)]}function Ur(e){return Wt(e,Yr(e))}var Fr=Nn(Ht),Br=Sr((function(t){var n=t[0]
	return null==n?n:(t.push(Vt),Fr.apply(e,t))})),Vr=Hn(an),Gr=Hn(sn),Hr=jn(nn),qr=jn(rn),Wr=zn(an),jr=zn(sn)
	function zr(e){return cn(e,Yr(e))}var Kr=st?function(e){if(e)var t=e.constructor,n=e.length
	return"function"==typeof t&&t.prototype===e||("function"==typeof e?Ct.support.enumPrototypes:n&&ui(n))?yi(e):Or(e)?st(e):[]}:yi
	function Yr(e){if(null==e)return[]
	Or(e)||(e=se(e))
	var t=e.length,n=Ct.support
	t=t&&ui(t)&&(Cr(e)||n.nonEnumStrings&&Lr(e)||n.nonEnumArgs&&xr(e))&&t||0
	for(var i=e.constructor,r=-1,o=Mr(i)&&i.prototype||fe,a=o===e,s=m(t),c=t>0,l=n.enumErrorProps&&(e===pe||e instanceof _),u=n.enumPrototypes&&Mr(e);++r<t;)s[r]=r+""
	for(var d in e)u&&"prototype"==d||l&&("message"==d||"name"==d)||c&&si(d,t)||"constructor"==d&&(a||!Be.call(e,d))||s.push(d)
	if(n.nonEnumShadows&&e!==fe){var f=e===me?b:e===pe?p:Ge.call(e),h=xt[f]||xt[v]
	for(f==v&&(o=fe),t=Z.length;t--;){var g=h[d=Z[t]]
	a&&g||!(g?Be.call(e,d):e[d]!==o[d])||s.push(d)}}return s}var Qr=Nn((function t(n,i,r,o,a){if(!Or(n))return n
	var s=ui(i.length)&&(Cr(i)||Dr(i))
	return(s?Rt:an)(i,(function(i,c,l){if(Oe(i))return o||(o=[]),a||(a=[]),function(t,n,i,r,o,a,s){var c=a.length,l=n[i]
	for(;c--;)if(a[c]==l)return void(t[i]=s[c])
	var u=t[i],d=o?o(u,l,i,t,n):e,p=void 0===d
	p&&(d=l,ui(l.length)&&(Cr(l)||Dr(l))?d=Cr(u)?u:u&&u.length?Pt(u):[]:Pr(l)||xr(l)?d=xr(u)?Ur(u):Pr(u)?u:{}:p=!1)
	a.push(l),s.push(d),p?t[i]=r(d,l,o,a,s):(d==d?d!==u:u==u)&&(t[i]=d)}(n,l,c,t,r,o,a)
	var u=n[c],d=r?r(u,i,c,n,l):e,p=void 0===d
	p&&(d=i),!s&&void 0===d||!p&&(d==d?d===u:u!=u)||(n[c]=d)})),n})),Xr=Sr((function(e,t){if(null==e)return{}
	if("function"!=typeof t[0]){t=Ut(tn(t),le)
	return pi(e,Qt(Yr(e),t))}var n=In(t[0],t[1],3)
	return fi(e,(function(e,t,i){return!n(e,t,i)}))})),$r=Sr((function(e,t){return null==e?{}:"function"==typeof t[0]?fi(e,In(t[0],t[1],3)):pi(e,tn(t))}))
	function Jr(e){return wn(e,Kr(e))}var Zr=Dn((function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)}))
	function eo(e){return(e=_e(e))&&e.replace(z,Ce).replace(G,"")}function to(e){return(e=_e(e))&&Q.test(e)?e.replace(Y,"\\$&"):e}var no=Dn((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),io=Kn(),ro=Kn(!0)
	function oo(e,t,n){return n&&ci(e,t,n)&&(t=0),pt(e,t)}function ao(e,t){var n=""
	if(e=_e(e),(t=+t)<1||!e||!at(t))return n
	do{t%2&&(n+=e),t=Ye(t/2),e+=e}while(t)
	return n}8!=pt(" \t\v\f \ufeff\n\r\u2028\u2029 ᠎             　08")&&(oo=function(e,t,n){return(n?ci(e,t,n):null==t)?t=0:t&&(t=+t),e=lo(e),pt(e,t||(W.test(e)?16:10))})
	var so=Dn((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),co=Dn((function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))}))
	function lo(e,t,n){var i=e
	return(e=_e(e))?(n?ci(i,t,n):null==t)?e.slice(Pe(e),Re(e)+1):(t+="",e.slice(we(e,t),Se(e,t)+1)):e}function uo(e,t,n){return n&&ci(e,t,n)&&(t=null),(e=_e(e)).match(t||$)||[]}var po=Sr((function(t,n){try{return t.apply(e,n)}catch(i){return Ir(i)?i:new _(i)}}))
	function fo(e,t,n){return n&&ci(e,t,n)&&(t=null),Oe(e)?vo(e):jt(e,t)}function mo(e){return function(){return e}}function ho(e){return e}function vo(e){return pn(zt(e,!0))}function go(e,t,n){if(null==n){var i=Or(t),r=i&&Kr(t),o=r&&r.length&&cn(t,r);(o?o.length:i)||(o=!1,n=t,t=e,e=this)}o||(o=cn(t,Kr(t)))
	var a=!0,s=-1,c=Mr(e),l=o.length
	!1===n?a=!1:Or(n)&&"chain"in n&&(a=n.chain)
	for(;++s<l;){var u=o[s],d=t[u]
	e[u]=d,c&&(e.prototype[u]=function(t){return function(){var n=this.__chain__
	if(a||n){var i=e(this.__wrapped__)
	return(i.__actions__=Pt(this.__actions__)).push({func:t,args:arguments,thisArg:e}),i.__chain__=n,i}var r=[this.value()]
	return Xe.apply(r,arguments),t.apply(e,r)}}(d))}return e}function yo(){}var bo,_o=Bn(Ft),Eo=Bn((function(e){for(var t=-1,n=e.length,i=ht;++t<n;){var r=e[t]
	r<i&&(i=r)}return i}),!0)
	return Ct.prototype=Tt.prototype,It.prototype=Kt(Tt.prototype),It.prototype.constructor=It,Mt.prototype=Kt(Tt.prototype),Mt.prototype.constructor=Mt,Ot.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},Ot.prototype.get=function(t){return"__proto__"==t?e:this.__data__[t]},Ot.prototype.has=function(e){return"__proto__"!=e&&Be.call(this.__data__,e)},Ot.prototype.set=function(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this},kt.prototype.push=function(e){var t=this.data
	"string"==typeof e||Or(e)?t.set.add(e):t.hash[e]=!0},br.Cache=Ot,Ct.after=function(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new ue(a)
	var n=e
	e=t,t=n}return e=at(e=+e)?e:0,function(){if(--e<1)return t.apply(this,arguments)}},Ct.ary=function(e,t,n){return n&&ci(e,t,n)&&(t=null),t=e&&null==t?e.length:ct(+t||0,0),ei(e,r,null,null,null,null,t)},Ct.assign=Fr,Ct.at=Hi,Ct.before=cr,Ct.bind=lr,Ct.bindAll=ur,Ct.bindKey=dr,Ct.callback=fo,Ct.chain=Vi,Ct.chunk=function(e,t,n){t=(n?ci(e,t,n):null==t)?1:ct(+t||1,1)
	for(var i=0,r=e?e.length:0,o=-1,a=m(ze(r/t));i<r;)a[++o]=gn(e,i,i+=t)
	return a},Ct.compact=function(e){for(var t=-1,n=e?e.length:0,i=-1,r=[];++t<n;){var o=e[t]
	o&&(r[++i]=o)}return r},Ct.constant=mo,Ct.countBy=qi,Ct.create=function(e,t,n){var i=Kt(e)
	return n&&ci(e,t,n)&&(t=null),t?Wt(t,i,Kr(t)):i},Ct.curry=pr,Ct.curryRight=fr,Ct.debounce=mr,Ct.defaults=Br,Ct.defer=hr,Ct.delay=vr,Ct.difference=wi,Ct.drop=Si,Ct.dropRight=xi,Ct.dropRightWhile=function(e,t,n){return e&&e.length?Sn(e,ii(t,n,3),!0,!0):[]},Ct.dropWhile=function(e,t,n){return e&&e.length?Sn(e,ii(t,n,3),!0):[]},Ct.fill=function(e,t,n,i){var r=e?e.length:0
	return r?(n&&"number"!=typeof n&&ci(e,t,n)&&(n=0,i=r),function(e,t,n,i){var r=e.length
	for((n=null==n?0:+n||0)<0&&(n=-n>r?0:r+n),(i=void 0===i||i>r?r:+i||0)<0&&(i+=r),r=n>i?0:i>>>0,n>>>=0;n<r;)e[n++]=t
	return e}(e,t,n,i)):[]},Ct.filter=ji,Ct.flatten=function(e,t,n){var i=e?e.length:0
	return n&&ci(e,t,n)&&(t=!1),i?tn(e,t):[]},Ct.flattenDeep=function(e){return(e?e.length:0)?tn(e,!0):[]},Ct.flow=gr,Ct.flowRight=yr,Ct.forEach=Yi,Ct.forEachRight=Qi,Ct.forIn=Hr,Ct.forInRight=qr,Ct.forOwn=Wr,Ct.forOwnRight=jr,Ct.functions=zr,Ct.groupBy=Xi,Ct.indexBy=Ji,Ct.initial=function(e){return xi(e,1)},Ct.intersection=function(){for(var e=[],t=-1,n=arguments.length,i=[],r=ai(),o=r==ye;++t<n;){var a=arguments[t];(Cr(a)||xr(a))&&(e.push(a),i.push(o&&a.length>=120?Ln(t&&a):null))}n=e.length
	var s=e[0],c=-1,l=s?s.length:0,u=[],d=i[0]
	e:for(;++c<l;)if(a=s[c],(d?Nt(d,a):r(u,a,0))<0){for(t=n;--t;){var p=i[t]
	if((p?Nt(p,a):r(e[t],a,0))<0)continue e}d&&d.push(a),u.push(a)}return u},Ct.invert=function(e,t,n){n&&ci(e,t,n)&&(t=null)
	for(var i=-1,r=Kr(e),o=r.length,a={};++i<o;){var s=r[i],c=e[s]
	t?Be.call(a,c)?a[c].push(s):a[c]=[s]:a[c]=s}return a},Ct.invoke=Zi,Ct.keys=Kr,Ct.keysIn=Yr,Ct.map=er,Ct.mapValues=function(e,t,n){var i={}
	return t=ii(t,n,3),an(e,(function(e,n,r){i[n]=t(e,n,r)})),i},Ct.matches=vo,Ct.matchesProperty=function(e,t){return fn(e+"",zt(t,!0))},Ct.memoize=br,Ct.merge=Qr,Ct.mixin=go,Ct.negate=function(e){if("function"!=typeof e)throw new ue(a)
	return function(){return!e.apply(this,arguments)}},Ct.omit=Xr,Ct.once=function(e){return cr(e,2)},Ct.pairs=function(e){for(var t=-1,n=Kr(e),i=n.length,r=m(i);++t<i;){var o=n[t]
	r[t]=[o,e[o]]}return r},Ct.partial=_r,Ct.partialRight=Er,Ct.partition=tr,Ct.pick=$r,Ct.pluck=function(e,t){return er(e,mn(t))},Ct.property=function(e){return mn(e+"")},Ct.propertyOf=function(t){return function(n){return null==t?e:t[n]}},Ct.pull=function(){var e=arguments,t=e[0]
	if(!t||!t.length)return t
	for(var n=0,i=ai(),r=e.length;++n<r;)for(var o=0,a=e[n];(o=i(t,a,o))>-1;)et.call(t,o,1)
	return t},Ct.pullAt=Oi,Ct.range=function(e,t,n){n&&ci(e,t,n)&&(t=n=null),e=+e||0,null==t?(t=e,e=0):t=+t||0
	for(var i=-1,r=ct(ze((t-e)/((n=null==n?1:+n||0)||1)),0),o=m(r);++i<r;)o[i]=e,e+=n
	return o},Ct.rearg=wr,Ct.reject=function(e,t,n){var i=Cr(e)?Dt:Zt
	return t=ii(t,n,3),i(e,(function(e,n,i){return!t(e,n,i)}))},Ct.remove=function(e,t,n){var i=-1,r=e?e.length:0,o=[]
	for(t=ii(t,n,3);++i<r;){var a=e[i]
	t(a,i,e)&&(o.push(a),et.call(e,i--,1),r--)}return o},Ct.rest=ki,Ct.restParam=Sr,Ct.shuffle=or,Ct.slice=function(e,t,n){var i=e?e.length:0
	return i?(n&&"number"!=typeof n&&ci(e,t,n)&&(t=0,n=i),gn(e,t,n)):[]},Ct.sortBy=function(e,t,n){if(null==e)return[]
	var i=-1,r=e.length,o=ui(r)?m(r):[]
	return n&&ci(e,t,n)&&(t=null),t=ii(t,n,3),Xt(e,(function(e,n,r){o[++i]={criteria:t(e,n,r),index:i,value:e}})),bn(o,xe)},Ct.sortByAll=function(){var e=arguments,t=e[0],n=e[3],i=0,r=e.length-1
	if(null==t)return[]
	for(var o=m(r);i<r;)o[i]=e[++i]
	return n&&ci(e[1],e[2],n)&&(o=e[1]),_n(t,tn(o),[])},Ct.sortByOrder=function(e,t,n,i){return null==e?[]:(i&&ci(t,n,i)&&(n=null),Cr(t)||(t=null==t?[]:[t]),Cr(n)||(n=null==n?[]:[n]),_n(e,t,n))},Ct.spread=function(e){if("function"!=typeof e)throw new ue(a)
	return function(t){return e.apply(this,t)}},Ct.take=function(e,t,n){return(e?e.length:0)?((n?ci(e,t,n):null==t)&&(t=1),gn(e,0,t<0?0:t)):[]},Ct.takeRight=function(e,t,n){var i=e?e.length:0
	return i?((n?ci(e,t,n):null==t)&&(t=1),gn(e,(t=i-(+t||0))<0?0:t)):[]},Ct.takeRightWhile=function(e,t,n){return e&&e.length?Sn(e,ii(t,n,3),!1,!0):[]},Ct.takeWhile=function(e,t,n){return e&&e.length?Sn(e,ii(t,n,3)):[]},Ct.tap=function(e,t,n){return t.call(n,e),e},Ct.throttle=function(e,t,n){var i=!0,r=!0
	if("function"!=typeof e)throw new ue(a)
	return!1===n?i=!1:Or(n)&&(i="leading"in n?!!n.leading:i,r="trailing"in n?!!n.trailing:r),ie.leading=i,ie.maxWait=+t,ie.trailing=r,mr(e,t,ie)},Ct.thru=Gi,Ct.times=function(e,t,n){if((e=+e)<1||!at(e))return[]
	var i=-1,r=m(lt(e,vt))
	for(t=In(t,n,1);++i<e;)i<vt?r[i]=t(i):t(i)
	return r},Ct.toArray=function(e){var t=e?e.length:0
	return ui(t)?t?Ct.support.unindexedChars&&Lr(e)?e.split(""):Pt(e):[]:Jr(e)},Ct.toPlainObject=Ur,Ct.transform=function(e,t,n,i){var r=Cr(e)||Dr(e)
	if(t=ii(t,i,4),null==n)if(r||Or(e)){var o=e.constructor
	n=r?Cr(e)?new o:[]:Kt(Mr(o)&&o.prototype)}else n={}
	return(r?Rt:an)(e,(function(e,i,r){return t(n,e,i,r)})),n},Ct.union=Ri,Ct.uniq=Li,Ct.unzip=Di,Ct.values=Jr,Ct.valuesIn=function(e){return wn(e,Yr(e))},Ct.where=function(e,t){return ji(e,pn(t))},Ct.without=Ui,Ct.wrap=function(e,t){return ei(t=null==t?ho:t,i,null,[e],[])},Ct.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e]
	if(Cr(n)||xr(n))var i=i?Qt(i,n).concat(Qt(n,i)):n}return i?En(i):[]},Ct.zip=Fi,Ct.zipObject=Bi,Ct.backflow=yr,Ct.collect=er,Ct.compose=yr,Ct.each=Yi,Ct.eachRight=Qi,Ct.extend=Fr,Ct.iteratee=fo,Ct.methods=zr,Ct.object=Bi,Ct.select=ji,Ct.tail=ki,Ct.unique=Li,go(Ct,Ct),Ct.add=function(e,t){return e+t},Ct.attempt=po,Ct.camelCase=Zr,Ct.capitalize=function(e){return(e=_e(e))&&e.charAt(0).toUpperCase()+e.slice(1)},Ct.clone=function(e,t,n,i){return t&&"boolean"!=typeof t&&ci(e,t,n)?t=!1:"function"==typeof t&&(i=n,n=t,t=!1),zt(e,t,n="function"==typeof n&&In(n,i,1))},Ct.cloneDeep=function(e,t,n){return zt(e,!0,t="function"==typeof t&&In(t,n,1))},Ct.deburr=eo,Ct.endsWith=function(e,t,n){t+=""
	var i=(e=_e(e)).length
	return n=void 0===n?i:lt(n<0?0:+n||0,i),(n-=t.length)>=0&&e.indexOf(t,n)==n},Ct.escape=function(e){return(e=_e(e))&&U.test(e)?e.replace(L,Te):e},Ct.escapeRegExp=to,Ct.every=Wi,Ct.find=zi,Ct.findIndex=Ci,Ct.findKey=Vr,Ct.findLast=Ki,Ct.findLastIndex=Ti,Ct.findLastKey=Gr,Ct.findWhere=function(e,t){return zi(e,pn(t))},Ct.first=Ii,Ct.has=function(e,t){return!!e&&Be.call(e,t)},Ct.identity=ho,Ct.includes=$i,Ct.indexOf=Ai,Ct.inRange=function(e,t,n){return t=+t||0,void 0===n?(n=t,t=0):n=+n||0,e>=t&&e<n},Ct.isArguments=xr,Ct.isArray=Cr,Ct.isBoolean=function(e){return!0===e||!1===e||Oe(e)&&Ge.call(e)==u},Ct.isDate=function(e){return Oe(e)&&Ge.call(e)==d},Ct.isElement=Tr,Ct.isEmpty=function(e){if(null==e)return!0
	var t=e.length
	return ui(t)&&(Cr(e)||Lr(e)||xr(e)||Oe(e)&&Mr(e.splice))?!t:!Kr(e).length},Ct.isEqual=function(t,n,i,r){if(!(i="function"==typeof i&&In(i,r,3))&&di(t)&&di(n))return t===n
	var o=i?i(t,n):e
	return void 0===o?ln(t,n,i):!!o},Ct.isError=Ir,Ct.isFinite=Ar,Ct.isFunction=Mr,Ct.isMatch=function(e,t,n,i){var r=Kr(t),o=r.length
	if(!o)return!0
	if(null==e)return!1
	if(!(n="function"==typeof n&&In(n,i,3))&&1==o){var a=r[0],s=t[a]
	if(di(s))return s===e[a]&&(void 0!==s||a in _i(e))}for(var c=m(o),l=m(o);o--;)s=c[o]=t[r[o]],l[o]=di(s)
	return un(_i(e),r,c,l,n)},Ct.isNaN=function(e){return Nr(e)&&e!=+e},Ct.isNative=kr,Ct.isNull=function(e){return null===e},Ct.isNumber=Nr,Ct.isObject=Or,Ct.isPlainObject=Pr,Ct.isRegExp=Rr,Ct.isString=Lr,Ct.isTypedArray=Dr,Ct.isUndefined=function(e){return void 0===e},Ct.kebabCase=no,Ct.last=Mi,Ct.lastIndexOf=function(e,t,n){var i=e?e.length:0
	if(!i)return-1
	var r=i
	if("number"==typeof n)r=(n<0?ct(i+n,0):lt(n||0,i-1))+1
	else if(n){var o=e[r=Cn(e,t,!0)-1]
	return(t==t?t===o:o!=o)?r:-1}if(t!=t)return Ae(e,r,!0)
	for(;r--;)if(e[r]===t)return r
	return-1},Ct.max=_o,Ct.min=Eo,Ct.noConflict=function(){return n._=He,this},Ct.noop=yo,Ct.now=sr,Ct.pad=function(e,t,n){t=+t
	var i=(e=_e(e)).length
	if(i>=t||!at(t))return e
	var r=(t-i)/2,o=Ye(r)
	return(n=$n("",ze(r),n)).slice(0,o)+e+n},Ct.padLeft=io,Ct.padRight=ro,Ct.parseInt=oo,Ct.random=function(e,t,n){n&&ci(e,t,n)&&(t=n=null)
	var i=null==e,r=null==t
	if(null==n&&(r&&"boolean"==typeof e?(n=e,e=1):"boolean"==typeof t&&(n=t,r=!0)),i&&r&&(t=1,r=!1),e=+e||0,r?(t=e,e=0):t=+t||0,n||e%1||t%1){var o=ft()
	return lt(e+o*(t-e+parseFloat("1e-"+((o+"").length-1))),t)}return hn(e,t)},Ct.reduce=nr,Ct.reduceRight=ir,Ct.repeat=ao,Ct.result=function(t,n,i){var r=null==t?e:t[n]
	return void 0===r&&(r=i),Mr(r)?r.call(t):r},Ct.runInContext=t,Ct.size=function(e){var t=e?e.length:0
	return ui(t)?t:Kr(e).length},Ct.snakeCase=so,Ct.some=ar,Ct.sortedIndex=Ni,Ct.sortedLastIndex=Pi,Ct.startCase=co,Ct.startsWith=function(e,t,n){return e=_e(e),n=null==n?0:lt(n<0?0:+n||0,e.length),e.lastIndexOf(t,n)==n},Ct.sum=function(e,t,n){n&&ci(e,t,n)&&(t=null)
	var i=ii(),r=null==t
	return i===jt&&r||(r=!1,t=i(t,n,3)),r?function(e){for(var t=e.length,n=0;t--;)n+=+e[t]||0
	return n}(Cr(e)?e:bi(e)):function(e,t){var n=0
	return Xt(e,(function(e,i,r){n+=+t(e,i,r)||0})),n}(e,t)},Ct.template=function(t,n,i){var r=Ct.templateSettings
	i&&ci(t,n,i)&&(n=i=null),t=_e(t),n=Ht(Ht({},i||n),r,Gt)
	var o,a,s=Ht(Ht({},n.imports),r.imports,Gt),c=Kr(s),l=wn(s,c),u=0,d=n.interpolate||K,p="__p += '",f=ce((n.escape||K).source+"|"+d.source+"|"+(d===V?H:K).source+"|"+(n.evaluate||K).source+"|$","g"),m="//# sourceURL="+("sourceURL"in n?n.sourceURL:"lodash.templateSources["+ ++ee+"]")+"\n"
	t.replace(f,(function(e,n,i,r,s,c){return i||(i=r),p+=t.slice(u,c).replace(X,Ie),n&&(o=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),i&&(p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=c+e.length,e})),p+="';\n"
	var h=n.variable
	h||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(k,""):p).replace(N,"$1").replace(P,"$1;"),p="function("+(h||"obj")+") {\n"+(h?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(o?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}"
	var v=po((function(){return re(c,m+"return "+p).apply(e,l)}))
	if(v.source=p,Ir(v))throw v
	return v},Ct.trim=lo,Ct.trimLeft=function(e,t,n){var i=e
	return(e=_e(e))?(n?ci(i,t,n):null==t)?e.slice(Pe(e)):e.slice(we(e,t+"")):e},Ct.trimRight=function(e,t,n){var i=e
	return(e=_e(e))?(n?ci(i,t,n):null==t)?e.slice(0,Re(e)+1):e.slice(0,Se(e,t+"")+1):e},Ct.trunc=function(e,t,n){n&&ci(e,t,n)&&(t=null)
	var i=30,r="..."
	if(null!=t)if(Or(t)){var o="separator"in t?t.separator:o
	i="length"in t?+t.length||0:i,r="omission"in t?_e(t.omission):r}else i=+t||0
	if(i>=(e=_e(e)).length)return e
	var a=i-r.length
	if(a<1)return r
	var s=e.slice(0,a)
	if(null==o)return s+r
	if(Rr(o)){if(e.slice(a).search(o)){var c,l,u=e.slice(0,a)
	for(o.global||(o=ce(o.source,(q.exec(o)||"")+"g")),o.lastIndex=0;c=o.exec(u);)l=c.index
	s=s.slice(0,null==l?a:l)}}else if(e.indexOf(o,a)!=a){var d=s.lastIndexOf(o)
	d>-1&&(s=s.slice(0,d))}return s+r},Ct.unescape=function(e){return(e=_e(e))&&D.test(e)?e.replace(R,Le):e},Ct.uniqueId=function(e){var t=++Ve
	return _e(e)+t},Ct.words=uo,Ct.all=Wi,Ct.any=ar,Ct.contains=$i,Ct.detect=zi,Ct.foldl=nr,Ct.foldr=ir,Ct.head=Ii,Ct.include=$i,Ct.inject=nr,go(Ct,(bo={},an(Ct,(function(e,t){Ct.prototype[t]||(bo[t]=e)})),bo),!1),Ct.sample=rr,Ct.prototype.sample=function(e){return this.__chain__||null!=e?this.thru((function(t){return rr(t,e)})):rr(this.value())},Ct.VERSION="3.6.0",Rt(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){Ct[e].placeholder=Ct})),Rt(["dropWhile","filter","map","takeWhile"],(function(e,t){var n=2!=t,i=0==t
	Mt.prototype[e]=function(e,r){var o=this.__filtered__,a=o&&i?new Mt(this):this.clone()
	return(a.__iteratees__||(a.__iteratees__=[])).push({done:!1,count:0,index:0,iteratee:ii(e,r,1),limit:-1,type:t}),a.__filtered__=o||n,a}})),Rt(["drop","take"],(function(e,t){var n=e+"While"
	Mt.prototype[e]=function(n){var i=this.__filtered__,r=i&&!t?this.dropWhile():this.clone();(n=null==n?1:ct(Ye(n)||0,0),i)?t?r.__takeCount__=lt(r.__takeCount__,n):Mi(r.__iteratees__).limit=n:(r.__views__||(r.__views__=[])).push({size:n,type:e+(r.__dir__<0?"Right":"")})
	return r},Mt.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()},Mt.prototype[e+"RightWhile"]=function(e,t){return this.reverse()[n](e,t).reverse()}})),Rt(["first","last"],(function(e,t){var n="take"+(t?"Right":"")
	Mt.prototype[e]=function(){return this[n](1).value()[0]}})),Rt(["initial","rest"],(function(e,t){var n="drop"+(t?"":"Right")
	Mt.prototype[e]=function(){return this[n](1)}})),Rt(["pluck","where"],(function(e,t){var n=t?"filter":"map",i=t?pn:mn
	Mt.prototype[e]=function(e){return this[n](i(e))}})),Mt.prototype.compact=function(){return this.filter(ho)},Mt.prototype.reject=function(e,t){return e=ii(e,t,1),this.filter((function(t){return!e(t)}))},Mt.prototype.slice=function(e,t){var n=(e=null==e?0:+e||0)<0?this.takeRight(-e):this.drop(e)
	return void 0!==t&&(n=(t=+t||0)<0?n.dropRight(-t):n.take(t-e)),n},Mt.prototype.toArray=function(){return this.drop(0)},an(Mt.prototype,(function(e,t){var n=Ct[t]
	if(n){var i=/^(?:filter|map|reject)|While$/.test(t),r=/^(?:first|last)$/.test(t)
	Ct.prototype[t]=function(){var t=arguments,o=this.__chain__,a=this.__wrapped__,s=!!this.__actions__.length,c=a instanceof Mt,l=t[0],u=c||Cr(a)
	u&&i&&"function"==typeof l&&1!=l.length&&(c=u=!1)
	var d=c&&!s
	if(r&&!o)return d?e.call(a):n.call(Ct,this.value())
	var p=function(e){var i=[e]
	return Xe.apply(i,t),n.apply(Ct,i)}
	if(u){var f=d?a:new Mt(this),m=e.apply(f,t)
	if(!r&&(s||m.__actions__))(m.__actions__||(m.__actions__=[])).push({func:Gi,args:[p],thisArg:Ct})
	return new It(m,o)}return this.thru(p)}}})),Rt(["concat","join","pop","push","replace","shift","sort","splice","split","unshift"],(function(e){var t=(/^(?:replace|split)$/.test(e)?me:de)[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",i=!At.spliceObjects&&/^(?:pop|shift|splice)$/.test(e),r=/^(?:join|pop|replace|shift)$/.test(e),o=i?function(){var e=t.apply(this,arguments)
	return 0===this.length&&delete this[0],e}:t
	Ct.prototype[e]=function(){var e=arguments
	return r&&!this.__chain__?o.apply(this.value(),e):this[n]((function(t){return o.apply(t,e)}))}})),an(Mt.prototype,(function(e,t){var n=Ct[t]
	if(n){var i=n.name;(wt[i]||(wt[i]=[])).push({name:t,func:n})}})),wt[Xn(null,2).name]=[{name:"wrapper",func:null}],Mt.prototype.clone=function(){var e=this.__actions__,t=this.__iteratees__,n=this.__views__,i=new Mt(this.__wrapped__)
	return i.__actions__=e?Pt(e):null,i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=t?Pt(t):null,i.__takeCount__=this.__takeCount__,i.__views__=n?Pt(n):null,i},Mt.prototype.reverse=function(){if(this.__filtered__){var e=new Mt(this)
	e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1
	return e},Mt.prototype.value=function(){var e=this.__wrapped__.value()
	if(!Cr(e))return xn(e,this.__actions__)
	var t=this.__dir__,n=t<0,i=function(e,t,n){var i=-1,r=n?n.length:0
	for(;++i<r;){var o=n[i],a=o.size
	switch(o.type){case"drop":e+=a
	break
	case"dropRight":t-=a
	break
	case"take":t=lt(t,e+a)
	break
	case"takeRight":e=ct(e,t-a)}}return{start:e,end:t}}(0,e.length,this.__views__),r=i.start,o=i.end,a=o-r,s=n?o:r-1,c=lt(a,this.__takeCount__),l=this.__iteratees__,u=l?l.length:0,d=0,p=[]
	e:for(;a--&&d<c;){for(var f=-1,m=e[s+=t];++f<u;){var h=l[f],v=h.iteratee,g=h.type
	if(0==g){if(h.done&&(n?s>h.index:s<h.index)&&(h.count=0,h.done=!1),h.index=s,!h.done){var y=h.limit
	if(!(h.done=y>-1?h.count++>=y:!v(m)))continue e}}else{var b=v(m)
	if(2==g)m=b
	else if(!b){if(1==g)continue e
	break e}}}p[d++]=m}return p},Ct.prototype.chain=function(){return Vi(this)},Ct.prototype.commit=function(){return new It(this.value(),this.__chain__)},Ct.prototype.plant=function(e){for(var t,n=this;n instanceof Tt;){var i=Ei(n)
	t?r.__wrapped__=i:t=i
	var r=i
	n=n.__wrapped__}return r.__wrapped__=e,t},Ct.prototype.reverse=function(){var e=this.__wrapped__
	return e instanceof Mt?(this.__actions__.length&&(e=new Mt(this)),new It(e.reverse(),this.__chain__)):this.thru((function(e){return e.reverse()}))},Ct.prototype.toString=function(){return this.value()+""},Ct.prototype.run=Ct.prototype.toJSON=Ct.prototype.valueOf=Ct.prototype.value=function(){return xn(this.__wrapped__,this.__actions__)},Ct.prototype.collect=Ct.prototype.map,Ct.prototype.head=Ct.prototype.first,Ct.prototype.select=Ct.prototype.filter,Ct.prototype.tail=Ct.prototype.rest,Ct}()
	"function"==typeof define&&"object"==typeof define.amd&&define.amd?(he._=De,define("lodash-compat/index",[],(function(){return De}))):le&&ue?me?(ue.exports=De)._=De:le._=De:he._=De}.call(this),define("lodash-compat",["lodash-compat/index"],(function(e){return e})),function(e){void 0===e&&(e={}),void 0===e.performance&&(e.performance={}),e._perfRefForUserTimingPolyfill=e.performance,e.performance.userTimingJsNow=!1,e.performance.userTimingJsNowPrefixed=!1,e.performance.userTimingJsUserTiming=!1,e.performance.userTimingJsUserTimingPrefixed=!1,e.performance.userTimingJsPerformanceTimeline=!1,e.performance.userTimingJsPerformanceTimelinePrefixed=!1
	var t,n,i=[],r=[],o=null
	if("function"!=typeof e.performance.now){for(e.performance.userTimingJsNow=!0,r=["webkitNow","msNow","mozNow"],t=0;t<r.length;t++)if("function"==typeof e.performance[r[t]]){e.performance.now=e.performance[r[t]],e.performance.userTimingJsNowPrefixed=!0
	break}var a=+new Date
	e.performance.timing&&e.performance.timing.navigationStart&&(a=e.performance.timing.navigationStart),"function"!=typeof e.performance.now&&(Date.now?e.performance.now=function(){return Date.now()-a}:e.performance.now=function(){return+new Date-a})}var s=function(){},c=function(){},l=[],u=!1,d=!1
	if("function"!=typeof e.performance.getEntries||"function"!=typeof e.performance.mark){for("function"==typeof e.performance.getEntries&&"function"!=typeof e.performance.mark&&(d=!0),e.performance.userTimingJsPerformanceTimeline=!0,i=["webkit","moz"],r=["getEntries","getEntriesByName","getEntriesByType"],t=0;t<r.length;t++)for(n=0;n<i.length;n++)o=i[n]+r[t].substr(0,1).toUpperCase()+r[t].substr(1),"function"==typeof e.performance[o]&&(e.performance[r[t]]=e.performance[o],e.performance.userTimingJsPerformanceTimelinePrefixed=!0)
	s=function(e){l.push(e),"measure"===e.entryType&&(u=!0)}
	var p=function(){u&&(l.sort((function(e,t){return e.startTime-t.startTime})),u=!1)}
	if(c=function(e,n){for(t=0;t<l.length;)l[t].entryType===e&&(void 0===n||l[t].name===n)?l.splice(t,1):t++},"function"!=typeof e.performance.getEntries||d){var f=e.performance.getEntries
	e.performance.getEntries=function(){p()
	var t=l.slice(0)
	return d&&f&&(Array.prototype.push.apply(t,f.call(e.performance)),t.sort((function(e,t){return e.startTime-t.startTime}))),t}}if("function"!=typeof e.performance.getEntriesByType||d){var m=e.performance.getEntriesByType
	e.performance.getEntriesByType=function(n){if(void 0===n||"mark"!==n&&"measure"!==n)return d&&m?m.call(e.performance,n):[]
	"measure"===n&&p()
	var i=[]
	for(t=0;t<l.length;t++)l[t].entryType===n&&i.push(l[t])
	return i}}if("function"!=typeof e.performance.getEntriesByName||d){var h=e.performance.getEntriesByName
	e.performance.getEntriesByName=function(n,i){if(i&&"mark"!==i&&"measure"!==i)return d&&h?h.call(e.performance,n,i):[]
	void 0!==i&&"measure"===i&&p()
	var r=[]
	for(t=0;t<l.length;t++)void 0!==i&&l[t].entryType!==i||l[t].name===n&&r.push(l[t])
	return d&&h&&(Array.prototype.push.apply(r,h.call(e.performance,n,i)),r.sort((function(e,t){return e.startTime-t.startTime}))),r}}}if("function"!=typeof e.performance.mark){for(e.performance.userTimingJsUserTiming=!0,i=["webkit","moz","ms"],r=["mark","measure","clearMarks","clearMeasures"],t=0;t<r.length;t++)for(n=0;n<i.length;n++)o=i[n]+r[t].substr(0,1).toUpperCase()+r[t].substr(1),"function"==typeof e.performance[o]&&(e.performance[r[t]]=e.performance[o],e.performance.userTimingJsUserTimingPrefixed=!0)
	var v={}
	"function"!=typeof e.performance.mark&&(e.performance.mark=function(t){var n=e.performance.now()
	if(void 0===t)throw new SyntaxError("Mark name must be specified")
	if(e.performance.timing&&t in e.performance.timing)throw new SyntaxError("Mark name is not allowed")
	v[t]||(v[t]=[]),v[t].push(n),s({entryType:"mark",name:t,startTime:n,duration:0})}),"function"!=typeof e.performance.clearMarks&&(e.performance.clearMarks=function(e){e?v[e]=[]:v={},c("mark",e)}),"function"!=typeof e.performance.measure&&(e.performance.measure=function(t,n,i){var r=e.performance.now()
	if(void 0===t)throw new SyntaxError("Measure must be specified")
	if(n){var o=0
	if(e.performance.timing&&n in e.performance.timing){if("navigationStart"!==n&&0===e.performance.timing[n])throw new Error(n+" has a timing of 0")
	o=e.performance.timing[n]-e.performance.timing.navigationStart}else{if(!(n in v))throw new Error(n+" mark not found")
	o=v[n][v[n].length-1]}var a=r
	if(i)if(a=0,e.performance.timing&&i in e.performance.timing){if("navigationStart"!==i&&0===e.performance.timing[i])throw new Error(i+" has a timing of 0")
	a=e.performance.timing[i]-e.performance.timing.navigationStart}else{if(!(i in v))throw new Error(i+" mark not found")
	a=v[i][v[i].length-1]}s({entryType:"measure",name:t,startTime:o,duration:a-o})}else s({entryType:"measure",name:t,startTime:0,duration:r})}),"function"!=typeof e.performance.clearMeasures&&(e.performance.clearMeasures=function(e){c("measure",e)})}void 0!==define&&define.amd?define("usertiming/src/usertiming",[],(function(){return e.performance})):"undefined"!=typeof module&&void 0!==module.exports&&(module.exports=e.performance)}("undefined"!=typeof window?window:void 0),define("usertiming",["usertiming/src/usertiming"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("global-portable/lib/global",["require","exports"],e)}((function(e,t){var n="undefined",i=typeof window!==n?window:typeof global!==n?global:Object.create(null)
	t.__esModule=!0,t.default=i})),define("global-portable",["global-portable/lib/global"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-browser-globals/lib/globals",["require","exports","global-portable"],e)}((function(e,t){var n=e("global-portable"),i=n.default.window,r=n.default.document
	t.getWindow=function(){return i},t.getDocument=function(){return r}})),define("swx-browser-globals",["swx-browser-globals/lib/globals"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/stringUtils",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat"),i={"ª":"a","º":"o","À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","Ç":"C","È":"E","É":"E","Ê":"E","Ë":"E","Ì":"I","Í":"I","Î":"I","Ï":"I","Ñ":"N","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ù":"U","Ú":"U","Û":"U","Ü":"U","Ý":"Y","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","ç":"c","è":"e","é":"e","ê":"e","ë":"e","ì":"i","í":"i","î":"i","ï":"i","ñ":"n","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ù":"u","ú":"u","û":"u","ü":"u","ý":"y","ÿ":"y","Ā":"A","ā":"a","Ă":"A","ă":"a","Ą":"A","ą":"a","Ć":"C","ć":"c","Ĉ":"C","ĉ":"c","Ċ":"C","ċ":"c","Č":"C","č":"c","Ď":"D","ď":"d","Ē":"E","ē":"e","Ĕ":"E","ĕ":"e","Ė":"E","ė":"e","Ę":"E","ę":"e","Ě":"E","ě":"e","Ĝ":"G","ĝ":"g","Ğ":"G","ğ":"g","Ġ":"G","ġ":"g","Ģ":"G","ģ":"g","Ĥ":"H","ĥ":"h","Ĩ":"I","ĩ":"i","Ī":"I","ī":"i","Ĭ":"I","ĭ":"i","Į":"I","į":"i","İ":"I","Ĳ":"IJ","ĳ":"ij","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","Ĺ":"L","ĺ":"l","Ļ":"L","ļ":"l","Ľ":"L","ľ":"l","Ŀ":"L·","ŀ":"l·","Ń":"N","ń":"n","Ņ":"N","ņ":"n","Ň":"N","ň":"n","ŉ":"ʼn","Ō":"O","ō":"o","Ŏ":"O","ŏ":"o","Ő":"O","ő":"o","Ŕ":"R","ŕ":"r","Ŗ":"R","ŗ":"r","Ř":"R","ř":"r","Ś":"S","ś":"s","Ŝ":"S","ŝ":"s","Ş":"S","ş":"s","Š":"S","š":"s","Ţ":"T","ţ":"t","Ť":"T","ť":"t","Ũ":"U","ũ":"u","Ū":"U","ū":"u","Ŭ":"U","ŭ":"u","Ů":"U","ů":"u","Ű":"U","ű":"u","Ų":"U","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","ź":"z","Ż":"Z","ż":"z","Ž":"Z","ž":"z","ſ":"s","Ơ":"O","ơ":"o","Ư":"U","ư":"u","Ǆ":"DZ","ǅ":"Dz","ǆ":"dz","Ǉ":"LJ","ǈ":"Lj","ǉ":"lj","Ǌ":"NJ","ǋ":"Nj","ǌ":"nj","Ǎ":"A","ǎ":"a","Ǐ":"I","ǐ":"i","Ǒ":"O","ǒ":"o","Ǔ":"U","ǔ":"u","Ǖ":"U","ǖ":"u","Ǘ":"U","ǘ":"u","Ǚ":"U","ǚ":"u","Ǜ":"U","ǜ":"u","Ǟ":"A","ǟ":"a","Ǡ":"A","ǡ":"a","Ǧ":"G","ǧ":"g","Ǩ":"K","ǩ":"k","Ǫ":"O","ǫ":"o","Ǭ":"O","ǭ":"o","ǰ":"j","Ǳ":"DZ","ǲ":"Dz","ǳ":"dz","Ǵ":"G","ǵ":"g","Ǹ":"N","ǹ":"n","Ǻ":"A","ǻ":"a","Ȁ":"A","ȁ":"a","Ȃ":"A","ȃ":"a","Ȅ":"E","ȅ":"e","Ȇ":"E","ȇ":"e","Ȉ":"I","ȉ":"i","Ȋ":"I","ȋ":"i","Ȍ":"O","ȍ":"o","Ȏ":"O","ȏ":"o","Ȑ":"R","ȑ":"r","Ȓ":"R","ȓ":"r","Ȕ":"U","ȕ":"u","Ȗ":"U","ȗ":"u","Ș":"S","ș":"s","Ț":"T","ț":"t","Ȟ":"H","ȟ":"h","Ȧ":"A","ȧ":"a","Ȩ":"E","ȩ":"e","Ȫ":"O","ȫ":"o","Ȭ":"O","ȭ":"o","Ȯ":"O","ȯ":"o","Ȱ":"O","ȱ":"o","Ȳ":"Y","ȳ":"y","ʰ":"h","ʲ":"j","ʳ":"r","ʷ":"w","ʸ":"y","ˡ":"l","ˢ":"s","ˣ":"x"}
	function r(e){var t,r=parseInt("0xD800"),o=parseInt("0xDBFF"),a=0,s="",c=""
	if(!e)return e
	for(;a<e.length;)s+=e.charAt(a),((t=e.charCodeAt(a))<r||t>o)&&(c+=n.has(i,s)?i[s]:s,s=""),a++
	return c}function o(e){return n.isString(e)&&e.length>0}t.anyWordStartsWith=function(e,t){if(!e)return!1
	var i=new RegExp("\\b"+n.escapeRegExp(t),"i")
	return-1!==r(e).search(i)},t.clean=function(e){return e.replace(/[\W]+|[\s]+/gi," ").trim()},t.removeNonWordCharacters=function(e){return e.replace(/[.,\/#!£$%\^&\*;:{}=\-+`~()]+/gi," ").replace(/\s+/g," ").trim()},t.normalize=r,t.inject=function(e,t,n,i){return void 0===i&&(i=n),console.assert(i>=n,"End position "+i+" is lower than start position "+n),e.substr(0,n)+t+e.substr(i,e.length)},t.isEmpty=function(e){return""===e},t.isNotEmpty=o,t.isCarriageReturn=function(e){return"\r"===e},t.isNewLine=function(e){return"\n"===e},t.isWhiteSpace=function(e){return" "===e},t.wordAt=function(e,t){var n=this.wordBoundariesAt(e,t)
	return-1===n.start?"":e.substring(n.start,n.end)},t.wordBoundariesAt=function(e,t){if(t>e.length)return{start:-1,end:-1}
	if(t===e.length){if(-1!==e.search(/\s$/))return{start:-1,end:-1}
	t--}var n=e.substring(0,t).search(/\S+$/),i=e.substring(t).search(/\s/)
	return-1===n&&(n=t),-1===i?i=e.length:i+=t,{start:n,end:i}},t.forceLTREmbedding=function(e){return"‪"+e+"‬"},t.tryParseInt=function(e,t){var n=t
	return o(e)&&!isNaN(e)&&(n=parseInt(e,10)),n}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/array",["require","exports","./stringUtils"],e)}((function(e,t){var n=e("./stringUtils")
	function i(e,t){var i=n.normalize(e.toLowerCase().trim()),r=n.normalize(t.toLowerCase().trim())
	return i<r?-1:i>r?1:0}t.sortByProperty=function(e,t){function n(e,t){return e[t]}return e.sort((function(e,r){return i(n(e,t),n(r,t))}))},t.sortByObservableProperty=function(e,t){function n(e,t){return e[t]()}return e.sort((function(e,r){return i(n(e,t),n(r,t))}))},t.insertAt=function(e,t,n){e.splice(t,0,n)},t.swapItems=function(e,t,n){var i=e[t]
	e[t]=e[n],e[n]=i},t.removeFrom=function(e,t){return e.splice(t,1)[0]}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/async",["require","exports","swx-browser-globals"],e)}((function(e,t){var n=e("swx-browser-globals")
	t.execute=function(e,t,i){var r=t?e.bind(t):e
	return i?Promise.resolve().then(r):n.getWindow().setTimeout(r,0)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/builderMixin",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	function i(){return i.prototype}return i.prototype={build:function(){var e=Object.create(this.prototype)
	return this.apply(e,arguments)||e}},n.assign(i,i.prototype),i}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},Skype,clienttelemetry_build,Microsoft,Microsoft,Microsoft,Microsoft,Microsoft,Microsoft,sct,microsoft,microsoft,microsoft;(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/cancelation",["require","exports","lodash-compat"],e)})((function(e,t){var n=e("lodash-compat"),i=function(){function e(){}return e.prototype.getToken=function(){var e,t=this
	return this.token=this.token||(e=new Promise((function(e,n){t.rejectTokenFn=n})),Object.defineProperty(e,"isCanceled",{get:function(){return t.isCanceled}}),e.throwIfCanceled=function(){if(t.isCanceled)throw new r},t.isCanceled=!1,e),this.token},e.prototype.cancel=function(e){if(e=e||new r,this.token||this.getToken(),this.isCanceled)throw new Error("The token is already canceled")
	this.isCanceled=!0,this.rejectTokenFn(e)},e}()
	t.CancelationTokenFactory=i
	var r=function(e){function t(){return e.call(this,"Operation canceled")||this}return __extends(t,e),t}(Error)
	function o(e,t){return Promise.race([Promise.resolve(e),t])}t.OperationCanceledError=r,t.makeCancelablePromise=o,t.makeCancelable=function(e,t){if(!t||!e||!n.isObject(e))return Promise.resolve(e)
	var i=e
	if(n.isFunction(i.makeCancelable))return i.makeCancelable(t)
	var r=e
	return n.isFunction(r.then)?o(r,t):void 0},t.adaptAbortable=function(e){if(!e||!n.isObject(e)||!n.isFunction(e.abort))return e
	var t=e
	return t.makeCancelable=function(e){var t,n=this
	return e.catch((function(e){t=e,n.abort()})),Promise.resolve(this).catch((function(n){if(e.isCanceled)throw t.innerException=n,t
	throw n}))},t},t.cancelableOperation=function(){return new i}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/guid",["require","exports"],e)}((function(e,t){function n(e){var t,n=e.toString(16),i=4-n.length
	for(t=0;t<i;t+=1)n="0"+n
	return n}function i(){var e,t,i=new Array(8)
	for(t=0;t<i.length;t+=2)e=Math.floor(4294967296*Math.random()),i[t]=n(65535&e),i[t+1]=n(e>>>16),t+1===3&&(i[t+1]="4"+i[t+1].substring(1))
	return i}t.create=function(){var e=i()
	return e[0]+e[1]+"-"+e[2]+"-"+e[3]+"-"+e[4]+"-"+e[5]+e[6]+e[7]},t.createRaw=function(){var e=i()
	return e[0]+e[1]+e[2]+e[3]+e[4]+e[5]+e[6]+e[7]}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/http",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat"),i=/^([\w\-]+)(:{1}[ \t]*)(.*)$/i
	function r(e){var t=e.request.getAllResponseHeaders(),r=t&&t.split(/\n+/g),o={}
	return r&&r.length&&n.forEach(r,(function(e){e=e&&e.trim()
	var t=i.exec(e)
	if(t&&4===t.length){var n=t[1],r=t[3]
	o[n]=r}})),o}t.getAllResponseHeaders=r,t.getResponseHeader=function(e,t){var n=r(e)
	return n&&n[t]||null}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/loader",["require","exports","swx-browser-globals"],e)}((function(e,t){var n=e("swx-browser-globals")
	function i(e,t){e.getElementsByTagName("head")[0].appendChild(t)}t.loadStyle=function(e){var t=n.getDocument(),r=t.createElement("link")
	return r.href=e,r.type="text/css",r.rel="stylesheet",i(t,r),r},t.loadScript=function(e,t,r){var o=n.getDocument(),a=o.createElement("script")
	return a.src=e,a.type="text/javascript",a.async=!0,t&&(a.onload=t),r&&(a.onerror=r),i(o,a),a}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/regex",["require","exports"],e)}((function(e,t){t.escapeSpecialChars=function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},t.multilineRegExp=function(e,t){return new RegExp(e.join(""),t)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/sessionStorage",["require","exports","swx-browser-globals"],e)}((function(e,t){var n=e("swx-browser-globals")
	t._backingStore={},t.set=function(e,i){var r=n.getWindow()
	try{r.sessionStorage.setItem(e,i),delete t._backingStore[e]}catch(o){t._backingStore[e]=i,console.warn("[Report Only]:",o)}},t.get=function(e){var i=n.getWindow()
	try{var r=i.sessionStorage.getItem(e)
	return!r&&e in t._backingStore?t._backingStore[e]:(t._backingStore[e]=r,r)}catch(o){console.warn("[Report Only]:",o)}},t.remove=function(e){var i=n.getWindow()
	try{delete t._backingStore[e],i.sessionStorage.removeItem(e)}catch(r){console.warn("[Report Only]:",r)}},t.clear=function(){var e=n.getWindow()
	try{t._backingStore={},e.sessionStorage.clear()}catch(i){console.warn("[Report Only]:",i)}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/settablePromise",["require","exports"],e)}((function(e,t){t.build=function(){var e,t,n=new Promise((function(n,i){e=n,t=i}))
	return n.resolve=e,n.reject=t,n}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/stopwatch",["require","exports"],e)}((function(e,t){var n=function(){function e(){this.msElapsed=0,this.isPaused=!1,this.startTime=(new Date).getTime()}return e.prototype.pause=function(){this.isPaused||(this.msElapsed+=(new Date).getTime()-this.startTime,this.isPaused=!0)},e.prototype.resume=function(){this.isPaused&&(this.isPaused=!1,this.startTime=(new Date).getTime())},e.prototype.duration=function(){return this.isPaused?this.msElapsed:this.msElapsed+(new Date).getTime()-this.startTime},e.prototype.durationInMinutes=function(){var e=this.duration()/6e4
	return Math.ceil(e)},e.prototype.durationInSeconds=function(){var e=this.duration()/1e3
	return Math.ceil(e)},e}()
	t.Stopwatch=n,t.build=function(){return new n}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/url",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	function i(e,t,n){return e.length?e.push("&"):e=["?"],null==t?e.push(encodeURIComponent(n)):e=e.concat([encodeURIComponent(n),"=",encodeURIComponent(t)]),e}t.buildUrl=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r]
	var o=[e].concat(t),a=n.takeWhile(o,n.isString)
	if(o.splice(0,a.length),0===a.length||o.length>1)throw new RangeError("Query arguments object should be the last parameter")
	var s=n.head(o),c=n.reduce(a,(function(e,t,i){var r=n.last(e)
	return!r||n.endsWith(r,"/")||n.startsWith(t,"/")||e.push("/"),e.push(t),e}),[])
	return(c=c.concat(n.flatten(n.reduce(s,i,[])))).join("")},t.removeQueryParameter=function(e,t){if(e.indexOf("?")>-1&&e.indexOf(t)>-1&&""!==t){var n=e.split("?"),i=new RegExp("[&]?"+t+"=[^&]+")
	n[1]=n[1].replace(i,"").replace(/^&/,""),e=""!==n[1]?n.join("?"):n[0]}return e},t.appendQueryParameter=function(e,t,n){var i="&"
	return-1===e.indexOf("?")&&(i="?"),e=e+i+t,n&&n.length&&(e+="="+n),e},t.getQueryParameterValueByName=function(e,t){var n
	if(e.indexOf("?")>-1){var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e)
	i&&i.length>=2&&(n=i[2])}return n}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/version",["require","exports"],e)}((function(e,t){var n=function(){function e(e){this.unknownVersionString="U",this.isVersionValid=!0,this.versionString=e,this.parseComponents()}return e.prototype.getMajor=function(){return this.components[0]},e.prototype.getMinor=function(){return this.components[1]},e.prototype.getAllComponents=function(){return this.components},e.prototype.getOriginalString=function(){return this.versionString},e.prototype.isValid=function(){return this.isVersionValid},e.prototype.compareTo=function(e){var t=0,n=0,i=e.getAllComponents()
	if(!this.isValid()||!e.isValid())throw new Error("Invalid version cannot be compared")
	for(var r=0;r<i.length;++r){if(t=parseInt(this.components[r],10),n=parseInt(i[r],10),isNaN(t)||t<n)return-1
	if(t>n)return 1}return 0},e.prototype.parseComponents=function(){if(!this.versionString)return this.components=[this.unknownVersionString,this.unknownVersionString],void(this.isVersionValid=!1)
	var e=this.getDelimiter()
	e?(this.components=this.versionString.split(e),this.validateComponents()):(this.components=[this.versionString,this.unknownVersionString],this.isVersionValid=!1)},e.prototype.validateComponents=function(){for(var e=0;e<this.components.length;++e)if(!this.components[e]||isNaN(parseInt(this.components[e],10))){this.components.push(this.unknownVersionString),this.isVersionValid=!1
	break}},e.prototype.getDelimiter=function(){return this.versionString.indexOf(".")>-1?".":this.versionString.indexOf("_")>-1?"_":null},e}()
	t.Version=n
	var i=function(e){return new n(e)}
	t.__esModule=!0,t.default={parse:i},t.parse=i})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/file",["require","exports"],e)}((function(e,t){t.isImage=function(e){return["image/png","image/x-png","image/jpeg"].some((function(t){return e.type===t}))}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-common/lib/index",["require","exports","./array","./async","./builderMixin","./cancelation","./guid","./http","./loader","./regex","./sessionStorage","./settablePromise","./stopwatch","./stringUtils","./url","./version","./file"],e)}((function(e,t){var n=e("./array")
	t.array=n
	var i=e("./async")
	t.async=i
	var r=e("./builderMixin")
	t.builderMixin=r
	var o=e("./cancelation")
	t.cancelation=o
	var a=e("./guid")
	t.guid=a
	var s=e("./http")
	t.http=s
	var c=e("./loader")
	t.loader=c
	var l=e("./regex")
	t.regex=l
	var u=e("./sessionStorage")
	t.sessionStorage=u
	var d=e("./settablePromise")
	t.settablePromise=d
	var p=e("./stopwatch")
	t.stopwatch=p
	var f=e("./stringUtils")
	t.stringUtils=f
	var m=e("./url")
	t.url=m
	var h=e("./version")
	t.version=h
	var v=e("./file")
	t.file=v})),define("swx-utils-common",["swx-utils-common/lib/index"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-browser-detect/lib/detect",["require","exports","swx-browser-globals","swx-utils-common"],e)}((function(e,t){var n=e("swx-browser-globals"),i=e("swx-utils-common"),r={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",YANDEX:"YaBrowser",UNKNOWN:"Unknown"},o={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},a={DESKTOP:1,MOBILE:2,TABLET:8},s={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},c="U",l="([\\d,.]+)",u="([\\d,_,.]+)"
	function d(){return n.getWindow().navigator.userAgent}function p(e){return d().indexOf(e)>-1}function f(){return p("Trident")}function m(){return p(r.EDGE)}function h(){return p("OPR/")?r.UNKNOWN:p(r.PHANTOMJS)?r.PHANTOMJS:m()?r.EDGE:p(r.ELECTRON)?r.ELECTRON:p(r.CHROME)?r.CHROME:p(r.FIREFOX)?r.FIREFOX:p(r.SAFARI)?r.SAFARI:p(r.SKYPE_SHELL)?r.SKYPE_SHELL:f()?r.MSIE:r.UNKNOWN}function v(){return f()?function(){var e,t=d(),n=t.match(new RegExp(r.MSIE+" "+l))
	if(n)return n[1]
	if(e=t.match(new RegExp("rv:"+l)))return e[1]
	return}():function(e){var t
	e===r.SAFARI&&(e="Version")
	if(t=d().match(new RegExp(e+"/"+l)))return t[1]
	return c}(h())}function g(){return d().match(/windows\sphone\s\d+\.\d+/i)?o.WINDOWS_PHONE:d().match(/ arm;/i)?o.WINDOWS_RT:d().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?o.IOS:d().match(/android/i)?o.ANDROID:d().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?o.LINUX:d().match(/(macintosh|mac os x)/i)?o.MACOSX:d().match(/(windows|win32)/i)?o.WINDOWS:o.UNKNOWN}function y(e){return g()===o.WINDOWS?function(e){var t=d().match(new RegExp("Windows NT "+l))
	if(t){if(e)return t[1]
	if(s[t[1]])return s[t[1]]}return c}(e):g()===o.MACOSX?function(e){var t=d().match(new RegExp(o.MACOSX+" "+u))
	if(t){var n=i.version.parse(t[1].replace(/_/g,"."))
	return e?n.getAllComponents().join("."):n.getMajor()}return c}(e):c}function b(){return n.getWindow().hasOwnProperty("external")&&n.getWindow().external.hasOwnProperty("msIsSiteMode")}function _(){return((e=n.getWindow()).navigator.getUserMedia||e.navigator.mozGetUserMedia||e.navigator.webkitGetUserMedia)&&(void 0!==e.RTCPeerConnection||void 0!==e.RTCIceGatherer||void 0!==e.mozRTCPeerConnection||void 0!==e.webkitRTCPeerConnection)
	var e}var E=function(){var e={},t=n.getWindow().location
	if(!t.search)return e
	var i=t.search.substring(1).split("&")
	if(!i)return e
	for(var r=0;r<i.length;r++){var o=i[r].split("=")
	o[1]&&(e[o[0]]=o[1]||!0)}return e}
	function w(){var e=i.version.parse(v()).getMajor()
	return isNaN(e)?e:parseInt(e,10)}t.__esModule=!0,t.default={getBrowserInfo:function(){return{browserName:h(),browserVersion:v(),browserMajorVersion:w(),isPinnedSite:h()===r.MSIE&&b()?n.getWindow().external.msIsSiteMode():"n/a",isIeEngine:f(),isEdge:m(),isFirefox:p(r.FIREFOX),isChrome:p(r.CHROME),isShellApp:h()===r.SKYPE_SHELL,isElectron:h()===r.ELECTRON,isYandex:p(r.YANDEX),isChromeOnLinux:g()===o.LINUX&&(h()===r.CHROME||h()===r.ELECTRON),isInBrowserPluginSupported:!1,isPluginlessCallingSupported:_(),isBrowserDefaultToBlockPlugin:(e=h(),e===r.FIREFOX||e===r.CHROME),getUrlParams:E,getUserAgent:d}
	var e},getScreenInfo:function(){var e=n.getWindow()
	return{width:n.getWindow().screen&&n.getWindow().screen.width||0,height:n.getWindow().screen&&n.getWindow().screen.height||0,pixelRatio:n.getWindow().devicePixelRatio||0,colorDepth:n.getWindow().screen&&n.getWindow().screen.colorDepth||0,isTouchEnabled:Object.prototype.hasOwnProperty.call(e,"ontouchstart")||n.getWindow().navigator.MaxTouchPoints>0||n.getWindow().navigator.msMaxTouchPoints>0}},getSystemInfo:function(){return{deviceType:d().match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?a.MOBILE:d().match(/tablet|ipad/i)?a.TABLET:a.DESKTOP,osName:g(),osVersion:y(!1),osRawVersion:y(!0),is64bit:p("WOW64")||p("Win64"),platform:n.getWindow().navigator.platform}},supportsCssProperty:function(e){return e in n.getWindow().document.documentElement.style},supportsPinnedSites:b,BROWSERS:r,OPERATING_SYSTEMS:o,DEVICE_TYPES:a,CSS_PROPERTIES:{OBJECT_FIT:"objectFit"}}})),define("swx-browser-detect",["swx-browser-detect/lib/detect"],(function(e){return e})),define("browser/window",[],(function(){return window})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-enums/lib/enums",["require","exports"],e)}((function(e,t){(function(e){e[e.ParticipantJoined="ParticipantJoined"]="ParticipantJoined",e[e.ParticipantLeft="ParticipantLeft"]="ParticipantLeft",e[e.ParticipantJoinFailed="ParticipantJoinFailed"]="ParticipantJoinFailed",e[e.ParticipantRoleUpdate="ParticipantRoleUpdate"]="ParticipantRoleUpdate",e[e.ParticipantTopicUpdate="ParticipantTopicUpdate"]="ParticipantTopicUpdate",e[e.ParticipantPictureUpdate="ParticipantPictureUpdate"]="ParticipantPictureUpdate",e[e.ParticipantHistoryDisclosed="ParticipantHistoryDisclosed"]="ParticipantHistoryDisclosed",e[e.ParticipantJoiningEnabled="ParticipantJoiningEnabled"]="ParticipantJoiningEnabled",e[e.ParticipantLegacyMemberAdded="ParticipantLegacyMemberAdded"]="ParticipantLegacyMemberAdded",e[e.ParticipantLegacyMemberUpgraded="ParticipantLegacyMemberUpgraded"]="ParticipantLegacyMemberUpgraded",e[e.CallStarted="CallStarted"]="CallStarted",e[e.CallEnded="CallEnded"]="CallEnded",e[e.CallMissed="CallMissed"]="CallMissed",e[e.NgcUpgradeMessage="NgcUpgradeMessage"]="NgcUpgradeMessage",e[e.PluginFreeFallbackScreenSharing="PluginFreeFallbackScreenSharing"]="PluginFreeFallbackScreenSharing",e[e.PluginFreeFallbackMicrophoneAccess="PluginFreeFallbackMicrophoneAccess"]="PluginFreeFallbackMicrophoneAccess",e[e.PluginFreeNoVideoCapability="PluginFreeNoVideoCapability"]="PluginFreeNoVideoCapability",e[e.PluginFreeVideoCompatibility="PluginFreeVideoCompatibility"]="PluginFreeVideoCompatibility",e[e.PstnInsufficientFunds="InsufficientFunds"]="PstnInsufficientFunds",e[e.PstnInvalidNumber="InvalidNumber"]="PstnInvalidNumber",e[e.PstnForbiddenNumber="ForbiddenNumber"]="PstnForbiddenNumber",e[e.TextMessage="TextMessage"]="TextMessage",e[e.AudioMessage="AudioMessage"]="AudioMessage",e[e.VideoMessage="VideoMessage"]="VideoMessage",e[e.PictureMessage="PictureMessage"]="PictureMessage",e[e.ContactRequestIncoming="ContactRequestIncoming"]="ContactRequestIncoming",e[e.ContactRequestIncomingInviteFree="ContactRequestIncomingInviteFree"]="ContactRequestIncomingInviteFree",e[e.ContactRequestOutgoing="ContactRequestOutgoing"]="ContactRequestOutgoing",e[e.ContactRequestOutgoingResend="ContactRequestOutgoingResend"]="ContactRequestOutgoingResend",e[e.ContactRequestOutgoingAgent="ContactRequestOutgoingAgent"]="ContactRequestOutgoingAgent"
	e[e.ContactRequestOutgoingPSTN="ContactRequestOutgoingPSTN"]="ContactRequestOutgoingPSTN",e[e.ContactRequestIsNowContact="ContactRequestIsNowContact"]="ContactRequestIsNowContact",e[e.SuggestedContact="SuggestedContact"]="SuggestedContact",e[e.UnblockContact="UnblockContact"]="UnblockContact",e[e.MojiMessage="MojiMessage"]="MojiMessage",e[e.FileTransfer="FileTransfer"]="FileTransfer",e[e.ContactInfoMessage="ContactInfoMessage"]="ContactInfoMessage",e[e.CreditTransaction="CreditTransaction"]="CreditTransaction",e[e.PollMessage="PollMessage"]="PollMessage",e[e.SystemMessage="SystemMessage"]="SystemMessage",e[e.CustomMessage="CustomMessage"]="CustomMessage",e[e.Transcript="Transcript"]="Transcript",e[e.Na="n/a"]="Na"})(t.activityType||(t.activityType={})),function(e){e[e.Pending="Pending"]="Pending",e[e.Succeeded="Succeeded"]="Succeeded",e[e.Failed="Failed"]="Failed"}(t.activityStatus||(t.activityStatus={})),function(e){e[e.Pending="Pending"]="Pending",e[e.Succeeded="Succeeded"]="Succeeded",e[e.Failed="Failed"]="Failed"}(t.transactionStatus||(t.transactionStatus={})),function(e){e[e.Incoming="Incoming"]="Incoming",e[e.Outgoing="Outgoing"]="Outgoing"}(t.direction||(t.direction={})),function(e){e[e.Text="Text"]="Text",e[e.Html="Html"]="Html"}(t.messageFormat||(t.messageFormat={})),function(e){e[e.Text="Text"]="Text",e[e.Html="Html"]="Html"}(t.messageType||(t.messageType={})),function(e){e[e.Disconnected="Disconnected"]="Disconnected",e[e.Notified="Notified"]="Notified",e[e.Connecting="Connecting"]="Connecting",e[e.Ringing="Ringing"]="Ringing",e[e.EarlyMedia="EarlyMedia"]="EarlyMedia",e[e.Connected="Connected"]="Connected",e[e.Disconnecting="Disconnecting"]="Disconnecting"}(t.callConnectionState||(t.callConnectionState={})),function(e){e[e.Terminated="Terminated"]="Terminated",e[e.FullSession="FullSession"]="FullSession",e[e.Busy="Busy"]="Busy",e[e.Refused="Refused"]="Refused",e[e.Missed="Missed"]="Missed",e[e.Dropped="Dropped"]="Dropped",e[e.InvalidNumber="InvalidNumber"]="InvalidNumber",e[e.ForbiddenNumber="ForbiddenNumber"]="ForbiddenNumber",e[e.EmergencyCallDenied="EmergencyCallDenied"]="EmergencyCallDenied",e[e.VoiceMailFailed="VoiceMailFailed"]="VoiceMailFailed",e[e.TransferFailed="TransferFailed"]="TransferFailed",e[e.InsufficientFunds="InsufficientFunds"]="InsufficientFunds",e[e.Failed="Failed"]="Failed",e[e.MissingSpeaker="MissingSpeaker"]="MissingSpeaker",e[e.MissingMicrophone="MissingMicrophone"]="MissingMicrophone",e[e.CallEscalated="CallEscalated"]="CallEscalated",e[e.OutOfBrowserCall="OutOfBrowserCall"]="OutOfBrowserCall",e[e.NoP2PFallback="NoP2PFallback"]="NoP2PFallback",e[e.AutoCallFailed="AutoCallFailed"]="AutoCallFailed",e[e.AutoCallTimeout="AutoCallTimeout"]="AutoCallTimeout",e[e.CallConnectTimeout="CallConnectTimeout"]="CallConnectTimeout",e[e.NotificationTimeout="NotificationTimeout"]="NotificationTimeout",e[e.Canceled="Canceled"]="Canceled",e[e.Unknown="Unknown"]="Unknown"}(t.callDisconnectionReason||(t.callDisconnectionReason={})),function(e){e[e.Skype="Skype"]="Skype"}(t.ecsClientNames||(t.ecsClientNames={})),function(e){e[e.Camera="Camera"]="Camera",e[e.Microphone="Microphone"]="Microphone",e[e.Speaker="Speaker"]="Speaker"}(t.deviceType||(t.deviceType={})),function(e){e[e.Root="Root"]="Root",e[e.Custom="Custom"]="Custom",e[e.Others="Others"]="Others",e[e.Favorites="Favorites"]="Favorites",e[e.Distribution="Distribution"]="Distribution",e[e.PrivacyRelationship="PrivacyRelationship"]="PrivacyRelationship"}(t.groupType||(t.groupType={})),function(e){e[e.None="None"]="None",e[e.Blocked="Blocked"]="Blocked",e[e.Colleagues="Colleagues"]="Colleagues",e[e.Workgroup="Workgroup"]="Workgroup",e[e.External="External"]="External",e[e.FriendsAndFamily="FriendsAndFamily"]="FriendsAndFamily"}(t.groupPrivacyRelationshipLevel||(t.groupPrivacyRelationshipLevel={})),function(e){e[e.Started="Started"]="Started",e[e.Active="Active"]="Active",e[e.Inactive="Inactive"]="Inactive",e[e.Stopped="Stopped"]="Stopped"}(t.mediaStreamState||(t.mediaStreamState={})),function(e){e[e.Unknown="Unknown"]="Unknown",e[e.Video="Video"]="Video",e[e.Video_WMV="Video_WMV"]="Video_WMV",e[e.Video_MOV="Video_MOV"]="Video_MOV",e[e.Video_MP4="Video_MP4"]="Video_MP4",e[e.Picture="Picture"]="Picture"}(t.mediaType||(t.mediaType={})),function(e){e[e.Unknown="Unknown"]="Unknown",e[e.Pending="Pending"]="Pending",e[e.Completed="Completed"]="Completed",e[e.Failed="Failed"]="Failed"}(t.mediaStatus||(t.mediaStatus={})),function(e){e[e.Attendee="Attendee"]="Attendee",e[e.Leader="Leader"]="Leader"}(t.participantRole||(t.participantRole={})),function(e){e[e.Disconnected="Disconnected"]="Disconnected",e[e.Connecting="Connecting"]="Connecting",e[e.InLobby="InLobby"]="InLobby",e[e.Connected="Connected"]="Connected",e[e.Disconnecting="Disconnecting"]="Disconnecting"}(t.participantState||(t.participantState={})),function(e){e[e.Online="Online"]="Online",e[e.Offline="Offline"]="Offline",e[e.Hidden="Hidden"]="Hidden",e[e.Busy="Busy"]="Busy",e[e.Idle="Idle"]="Idle",e[e.BeRightBack="BeRightBack"]="BeRightBack",e[e.Away="Away"]="Away",e[e.DoNotDisturb="DoNotDisturb"]="DoNotDisturb",e[e.Unknown="Unknown"]="Unknown",e[e.OnThePhone="OnThePhone"]="OnThePhone",e[e.OutForLunch="OutForLunch"]="OutForLunch"}(t.onlineStatus||(t.onlineStatus={})),function(e){e[e.Home="Home"]="Home",e[e.Work="Work"]="Work",e[e.Cell="Cell"]="Cell",e[e.Other="Other"]="Other"}(t.phoneType||(t.phoneType={})),function(e){e[e.autoBuddy="autoBuddy"]="autoBuddy",e[e.linkedMSA="linkedMSA"]="linkedMSA"}(t.selfSettings||(t.selfSettings={})),function(e){e[e.Personal="Personal"]="Personal",e[e.Work="Work"]="Work",e[e.Other="Other"]="Other"}(t.emailType||(t.emailType={})),function(e){e[e.Home="Home"]="Home",e[e.Work="Work"]="Work",e[e.Other="Other"]="Other",e[e.Unknown="Unknown"]="Unknown"}(t.locationType||(t.locationType={})),function(e){e[e.Personal="Personal"]="Personal",e[e.OutOfOffice="OutOfOffice"]="OutOfOffice"}(t.noteType||(t.noteType={})),function(e){e[e.Desktop="Desktop"]="Desktop",e[e.Mobile="Mobile"]="Mobile",e[e.Web="Web"]="Web",e[e.Unknown="Unknown"]="Unknown"}(t.endpointType||(t.endpointType={})),function(e){e[e.RequestFailed="RequestFailed"]="RequestFailed"}(t.reasonCode||(t.reasonCode={})),function(e){e[e.Desktop="Desktop"]="Desktop",e[e.Application="Application"]="Application",e[e.Window="Window"]="Window"}(t.sharedResourceType||(t.sharedResourceType={})),function(e){e[e.Agent="Agent"]="Agent",e[e.AddressBook="AddressBook"]="AddressBook",e[e.SkypeDirectory="SkypeDirectory"]="SkypeDirectory",e[e.Groups="Groups"]="Groups",e[e.All="All"]="All"}(t.searchScope||(t.searchScope={})),function(e){e[e.SignedOut="SignedOut"]="SignedOut",e[e.SigningIn="SigningIn"]="SigningIn",e[e.SignedIn="SignedIn"]="SignedIn",e[e.SigningOut="SigningOut"]="SigningOut"}(t.loginState||(t.loginState={})),function(e){e[e.NotReady="NotReady"]="NotReady",e[e.Authenticated="Authenticated"]="Authenticated",e[e.Error="Error"]="Error"}(t.translatorServiceState||(t.translatorServiceState={})),function(e){e[e.Password="Password"]="Password",e[e.Token="Token"]="Token",e[e.Passive="Passive"]="Passive",e[e.ImplicitOAuth="ImplicitOAuth"]="ImplicitOAuth",e[e.Guest="Guest"]="Guest",e[e.Integrated="Integrated"]="Integrated",e[e.OutOfBrowser="OutOfBrowser"]="OutOfBrowser"}(t.authType||(t.authType={}));(function(e){e[e.PluginNotInstalled="PluginNotInstalled"]="PluginNotInstalled",e[e.PluginOutOfDate="PluginOutOfDate"]="PluginOutOfDate",e[e.BrowserNotSupported="BrowserNotSupported"]="BrowserNotSupported",e[e.PluginBlocked="PluginBlocked"]="PluginBlocked",e[e.PluginAlreadyRunning="PluginAlreadyRunning"]="PluginAlreadyRunning",e[e.OSNotSupported="OSNotSupported"]="OSNotSupported",e[e.FeatureDisabled="FeatureDisabled"]="FeatureDisabled",e[e.TooManyParticipants="TooManyParticipants"]="TooManyParticipants",e[e.NotInConversation="NotInConversation"]="NotInConversation",e[e.CameraUnavailable="CameraUnavailable"]="CameraUnavailable",e[e.TrouterNotInitialized="TrouterNotInitialized"]="TrouterNotInitialized"})(t.callingNotSupportedReasons||(t.callingNotSupportedReasons={})),function(e){e[e.Uploading="Uploading"]="Uploading",e[e.FileMissing="FileMissing"]="FileMissing",e[e.Failed="Failed"]="Failed",e[e.FailedMalwareScan="FailedMalwareScan"]="FailedMalwareScan",e[e.Cancelled="Cancelled"]="Cancelled",e[e.Sent="Sent"]="Sent"}(t.fileUploadState||(t.fileUploadState={})),function(e){e[e.Premium="Premium"]="Premium",e[e.Skypein="Skypein"]="Skypein",e[e.Calling="Calling"]="Calling",e[e.CallingLegacy="CallingLegacy"]="CallingLegacy",e[e.StickerPack="StickerPack"]="StickerPack"}(t.marketplaceSkuType||(t.marketplaceSkuType={})),function(e){e[e.None="None"]="None",e[e.P2P="P2P"]="P2P",e[e.NGC="NGC"]="NGC"}(t.callTechnology||(t.callTechnology={})),function(e){e[e.Unknown="Unknown"]="Unknown",e[e.PluginBasedP2P="PluginBasedP2P"]="PluginBasedP2P",e[e.PluginBasedNGC="PluginBasedNGC"]="PluginBasedNGC",e[e.Pluginless="Pluginless"]="Pluginless"}(t.mediaConnectionType||(t.mediaConnectionType={})),function(e){e[e.Plan="plan"]="Plan",e[e.Package="package"]="Package"}(t.subscriptionType||(t.subscriptionType={})),function(e){e[e.Unknown="Unknown"]="Unknown",e[e.Unset="Unset"]="Unset",e[e.Defined="Defined"]="Defined",e[e.Saving="Saving"]="Saving"}(t.preferenceValueState||(t.preferenceValueState={})),function(e){e[e.URL_PREVIEWS=11]="URL_PREVIEWS",e[e.YOUTUBE_PLAYER=12]="YOUTUBE_PLAYER",e[e.MENTIONS=13]="MENTIONS",e[e.FILE_PASTE=14]="FILE_PASTE",e[e.ALLOW_VIDEO_CALLS_FROM_CONTACTS_ONLY=15]="ALLOW_VIDEO_CALLS_FROM_CONTACTS_ONLY",e[e.DONT_ALLOW_VIDEO_CALLS=16]="DONT_ALLOW_VIDEO_CALLS",e[e.TYPING_INDICATOR=20]="TYPING_INDICATOR",e[e.NOTIFICATIONS=21]="NOTIFICATIONS",e[e.NOTIFICATIONS_SOUND=22]="NOTIFICATIONS_SOUND",e[e.SHOW_EMOTICON_SUGGESTIONS_SETTINGS=23]="SHOW_EMOTICON_SUGGESTIONS_SETTINGS",e[e.SHOW_EMOTICONS=24]="SHOW_EMOTICONS",e[e.SHOW_ANIMATED_EMOTICONS=25]="SHOW_ANIMATED_EMOTICONS",e[e.SHOW_LARGE_EMOTICONS=26]="SHOW_LARGE_EMOTICONS",e[e.DARK_THEME=28]="DARK_THEME",e[e.VIDEO_AUTOPLAY=29]="VIDEO_AUTOPLAY",e[e.CHAT_NOTIFICATIONS_SOUND=31]="CHAT_NOTIFICATIONS_SOUND",e[e.CALL_NOTIFICATIONS=32]="CALL_NOTIFICATIONS",e[e.CALL_NOTIFICATIONS_SOUND=33]="CALL_NOTIFICATIONS_SOUND"}(t.skypeFlagsApiMappings||(t.skypeFlagsApiMappings={})),function(e){e[e.Boolean="Boolean"]="Boolean",e[e.Number="Number"]="Number",e[e.String="String"]="String",e[e.CallPolicy="CallPolicy"]="CallPolicy",e[e.VideoPolicy="VideoPolicy"]="VideoPolicy",e[e.AutoBuddy="AutoBuddy"]="AutoBuddy",e[e.AutoBuddyDiscovery="AutoBuddyDiscovery"]="AutoBuddyDiscovery",e[e.AutoBuddyDiscoveryEmail="AutoBuddyDiscoveryEmail"]="AutoBuddyDiscoveryEmail",e[e.AutoBuddyDiscoveryPhone="AutoBuddyDiscoveryPhone"]="AutoBuddyDiscoveryPhone",e[e.Notifications="Notifications"]="Notifications",e[e.RingingDeferrer="RingingDeferrer"]="RingingDeferrer"}(t.preferenceType||(t.preferenceType={})),function(e){e[e.Anyone=0]="Anyone",e[e.ContactsOnly=1]="ContactsOnly",e[e.NoOne=2]="NoOne"}(t.privacyPolicyValues||(t.privacyPolicyValues={})),function(e){e[e.Top="Top"]="Top",e[e.Bottom="Bottom"]="Bottom"}(t.contextMenuPosition||(t.contextMenuPosition={})),function(e){e[e.Unset=0]="Unset",e[e.Defer4Hours=4]="Defer4Hours",e[e.Defer8Hours=8]="Defer8Hours",e[e.Defer24Hours=24]="Defer24Hours"}(t.ringingDeferrerOptions||(t.ringingDeferrerOptions={})),function(e){e[e.Sending="Sending"]="Sending",e[e.Sent="Sent"]="Sent",e[e.Delivered="Delivered"]="Delivered",e[e.Error="Error"]="Error",e[e.Unknown="Unknown"]="Unknown"}(t.smsStatus||(t.smsStatus={})),function(e){e[e.ActiveSpeaker="ActiveSpeaker"]="ActiveSpeaker",e[e.MultiView="MultiView"]="MultiView",e[e.Both="Both"]="Both"}(t.videoMode||(t.videoMode={}))})),define("swx-enums",["swx-enums/lib/enums"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/calling",["require","exports","swx-enums"],e)}((function(e,t){var n=e("swx-enums")
	t.__esModule=!0,t.default={DOM_ELEMENT:{ID:{CHAT_COMPONENT:"chatComponent",CONTENT_WRAPPER:"contentWrapper",CALL_SCREEN:"callScreen",CALL_SCREEN_RESIZE:"callScreenResize",LOCAL_VIDEO_CONTAINER:"local-video-ui"}},SELECTORS:{CONTAINER:".av .middle",MAIN:".av .main",VIDEO:".video",TOP:".top",BOTTOM:".bottom",STAGE:".stage",ROSTER:"swx-call-roster"},CLASSES:{VIDEO_ON:"videoOn",LOCAL_PIP_IN_ROSTER:"localPipInRoster",PLUGINLESS:"pluginless",ASPECT_RATIO_1BY1:"ratio1by1",ASPECT_RATIO_4BY3:"ratio4by3",ASPECT_RATIO_16BY9:"ratio16by9",SCREEN_SHARING:"screenSharing",SMALL_PREVIEW:"smallPreview"},CONTROLS:{CALL_SCREEN:"av",END_CALL_CONTROL:"endCallControl",MUTE_CONTROL:"muteControl"},EVENTS:{START_CALL:"calling.startCall",RINGING_IN:"calling.ringingIn",ANSWER:"calling.answer",REJECT:"calling.reject",INCOMING_CALL_TOAST_TIMEOUT:"calling.incomingCallToastTimeout",INCOMING_INIT_ERROR:"IncomingInitialisationError",INCOMING_INIT_SUCCESS:"IncomingInitialisationSuccess",STOP_RINGING:"calling.stopRinging",FULLSCREEN_CHANGED:"calling.fullscreenChanged",CALL_SCREEN_CLOSE:"calling.callScreenClose",CALL_SCREEN_HEIGHT_CHANGED:"calling.callScreenChanged",START_RINGING:"calling.startRinging",CALLSESSION_STARTING:"calling.callsession.starting",CALLSESSION_ENDED:"calling.callsession.ended",PARICIPANT_VOICE_STATUS:"calling.participantVoiceStatus",PARICIPANT_JOINED:"calling.participantJoined",CALL_STATUS_CHANGED:"calling.callStatusChanged",ERROR_INCOMING_CALL:"calling.error.incomingCall",ERROR_OUTGOING_CALL:"calling.error.outgoingCall",CQF_SCREEN_CLOSE:"calling.cqfScreenClose",CQF_CANCEL:"calling.cqfCancel",UNANSWERED_CALL_CLOSE:"unansweredCall:close",UNANSWERED_CALL_SEND_MESSAGE:"unansweredCall:sendMessage"},TELEMETRY_EVENTS:{PLUGIN_INSTALL_STARTED:"PluginInstallStarted",PLUGIN_INSTALL_ENDED:"PluginInstallEnded"},PLUGIN_INSTALL_EXIT_METHOD:{CLOSE:"close",PLUGIN_DETECTED:"pluginDetected",CALL_STARTED:"callStarted"},NA:"n/a",CALLING_SETUP_STEPS:{OVERLAY_PLUGIN_CALLBACK:"overlayPluginCallback",CLOSE_CALLING_SETUP:"closeCallingSetup",OVERLAY_PLUGIN_STEPS:"overlayPluginSteps",OVERLAY_EXTENSION_INSTALLED:"overlayExtensionInstalled",OVERLAY_EXTENSION_INSTALL:"overlayExtensionInstall",OVERLAY_EXTENSION_INSTALL_FAILED:"overlayExtensionInstallFailed",OVERLAY_EXTENSION_START:"overlayExtensionStart",OVERLAY_PLUGIN_START:"overlayPluginStart",OVERLAY_PLUGIN_UNBLOCK:"overlayPluginUnblock",OVERLAY_PLUGIN_FIREFOX_UNABLE_TO_CALL:"overlayPluginFirefoxUnableToCall"},SOUND_LEVEL_EVENT_MODE:{None:"None",Boolean:"Boolean",Full:"Full"},SOUND_LEVEL_DEFAULT_THRESHOLD:4,PLUGIN_MAX_SOUND_LEVEL:10,PARTICIPANT_REMOVE_FROM_CALLSCREEN_TIMEOUT:1e4,CALL_STATES:{CONNECTING:"connecting",CALLING:"calling",EARLY_MEDIA:"earlyMedia",CONNECTED:"connected",ENDING:"ending",ENDED:"ended"},NOTIFICATION_ACTIONS:{AUDIO:"audio",VIDEO:"video",REJECT:"reject",INSTALL_PLUGIN:"installPlugin"},PLUGIN_EVENT_RESULTS:{LOAD_SUCCESSFUL:"LoadSuccessful",LOGIN_SUCCESS:"LoggedIn",VIDEO_STATUS:{AVAILABLE:"Available",NOT_AVAILABLE:"NotAvailable"}},PLUGIN_COMPONENT:{MANAGER_ID:"__pluginFx",CORE_ID:"SkypeCore",VIDEO_ID:"VideoUI"},PLUGIN_VIDEO_MODES:{STRETCH:1,CROP:2,FIT:3},PLUGIN_MEDIA_TYPES:{VIDEO:"Video",SCREEN_SHARING:"ScreenSharing"},SHELL_APP_PRELOAD_ENABLED_VERSION:"7.4",SHELL_APP_METHODS:{GET_VERSION:"getVersion",SHOW_WINDOW:"showWindow",HIDE_WINDOW:"hideWindow",CLOSE_WINDOW:"closeWindow"},SHELL_APP_EVENTS:{WINDOW_CLOSING:"windowClosing"},ERRORS:{CALL_ABORTED:"callAborted"},ERROR_CODES:{TPC_INIT:1,REGISTRAR_INIT:2,UNSUPPORTED_BROWSER:3,UNSUPPORTED_OS:4},FEATURE_FLAGS:{RESIZE_CALL_AND_CHAT:"resizeCallAndChat",CALLING:"calling",GVC:"GVC"},CQF:{THANKS_TIMEOUT:3e3,STEPS:{INTRO:"intro",QUESTIONNAIRE:"questionnaire",THANKS:"thanks"}},DEVICE_TYPE:{CAMERA:"camera",MICROPHONE:"microphone",SPEAKER:"speaker"},UNANSWERED_CALL_REASONS:{BUSY:"BUSY",MISSED:"NO_ANSWER",UNAVAILABLE:"UNAVAILABLE"},UNANSWERED_CALL_ACTIONS:{CANCEL:"CANCEL",CHAT:"CHAT",RETRY:"RETRY",MESSAGE_CALLEE:"MESSAGE_CALLEE",OTHER_DISMISS:"OTHER_DISMISS"},UNANSWERED_CALL_RETRY_ACTIONS:{SKYPE:"SKYPE",PSTN:"PSTN",DIAL_PAD:"DIAL_PAD"},DEVICE_SELECTION_REASON:{USER:"UserAction",CACHE:"RestoredFromCache"},PARTICIPANT_MENU:{ANIMATION_ELEMENT_SELECTOR:".participantMenuPill",ANIMATION_NAME:"av-participant-menu-move-up",ANIMATION_OFFSET:70,DEFAULT_OFFSET:4},CALL_SCREEN_DIALOG:{ALLOWED_FOCUS_SELECTORS:[".Me",".toasts",".footer",".notifications","swx-sidebar",".conversationHistory",".swx-chat-input"],NAME:{ADD_PARTICIPANTS:"addParticipants",TRANSFER_CALL:"transferCall",AV_SETTINGS:"avSettings",SCREEN_SHARING_PREVIEW:"screenSharingPreview",PSTN_WARNING:"pstnWarning"}},PLUGINLESS_PSTN:{END_REASONS:{SUBCODE_RANGE:{MIN:2e5,MAX:299999},REASON_MAP:{403:{6423:n.callDisconnectionReason.InsufficientFunds,8403:n.callDisconnectionReason.ForbiddenNumber,9402:n.callDisconnectionReason.InsufficientFunds,10403:n.callDisconnectionReason.ForbiddenNumber},404:{10404:n.callDisconnectionReason.InvalidNumber},480:{6422:n.callDisconnectionReason.InsufficientFunds,6432:n.callDisconnectionReason.InvalidNumber}}}}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/pluginConst",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={PERSISTENT_REQUIRED_VERSION:"7.2",NATIVE_ARGUMENTS_REQUIRED_VERSION:"7.6",LOGIN_STATUS:{LOGGED_OUT:"LoggedOut",LOGGED_IN:"LoggedIn",LOGGING_IN:"LoggingIn",LOGGING_OUT:"LoggingOut",INVALID_CREDENTIALS:"InvalidCredentials",IMPRINT_FAILURE:"ImprintFailure",LOGIN_FAILURE:"LoginFailure",LOGIN_SUCCESS:"LoginSuccess",UNKNOWN:"Unknown"},LOGIN_FAILURE_STOP_GAP:5,LOAD_RESULT:{LOAD_SUCCESSFUL:"LoadSuccessful",NO_INSTANCE_MANAGER:"NoInstanceManager",COMPONENT_NOT_FOUND:"ComponentNotFound",COMPONENT_LOAD_FAILED:"ComponentLoadFailed",COMPONENT_INIT_FAILED:"ComponentInitFailed",COMPONENT_LOAD_CANCELLED:"ComponentLoadCancelled"},VOICE_STATUS:{NOT_AVAILABLE:"NotAvailable",AVAILABLE:"Available",RINGING:"Ringing",JOINING:"Joining",LISTENING:"Listening",SPEAKING:"Speaking",ONHOLD:"OnHold",LEAVING:"Leaving",UNKNOWN:"Unknown"},VIDEO_STATUS:{NOT_AVAILABLE:"NotAvailable",AVAILABLE:"Available",STARTING:"Starting",RENDERING:"Rendering",STOPPING:"Stopping",SWITCHING_DEVICE:"SwitchingDevice",UNKNOWN:"Unknown"},VIDEO_MODE:{STRETCH:"Stretch",CROP:"Crop",FIT:"Fit"},PROGID_VERSION:"SkypePlugin.VersionQuery",MIME_TYPE:"application/x-skype-nativeplugin7.0",OBJECT_CLASS_ID:"CLSID:20BEBD18-11D0-4470-AAE1-F34B9E8D9761",PLUGIN_ERRORS:{REASON_CANNOT_CAPTURE:"CannotCapture",REASON_ALREADY_EXISTS:"AlreadyExists",NOT_INSTALLED:"pluginNotInstalled",INIT_TIMEOUT:"pluginInitializationTimeout",MANAGER_LOAD_ERROR:"pluginManagerLoadError",MANAGER_LOAD_TIMEOUT:"pluginManagerLoadTimeout",LOGIN_ABORTED:"pluginLoginAborted"},MAX_RESPONSE_LOG_LENGTH:500}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/people",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={SELF:"self",ECHO_CONTACT_ID:"echo123",searchLimit:20,contactTypes:{USER:"8",AGENT:"28",PSTN:"4"},contactList:{className:{LOCAL:"people",DIRECTORY:"directory"}},contactPicker:{states:{STATE_DEFAULT:"default",STATE_SEARCH:"search"}},authorizationStates:{UNKNOWN:"UNKNOWN",UNAUTHORIZED:"UNAUTHORIZED",PENDING_OUTGOING:"PENDING_OUTGOING",PENDING_INCOMING:"PENDING_INCOMING",AUTHORIZED:"AUTHORIZED",SUGGESTED:"SUGGESTED"},showStrategies:{ALL:"ALL",AVAILABLE_ONLY:"AVAILABLE_ONLY",AGENTS_ONLY:"AGENTS_ONLY"},contactPageTabIds:{AVAILABLE_TAB:"availableTab",ALL_CONTACTS_TAB:"allContactsTab",AGENTS_TAB:"agentsTab"},scopes:{FULL:"full",DELTA:"delta"}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/outOfBrowser",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={SHELL_APP_ID:"com.skype.shellapp",SHELL_APP_MIME_TYPE:"application/x-skype-shellapp",ESCALATION_TOPIC_SUBSCRIPTION_DELAY:3e3,commandTypes:{REQUEST:"REQUEST",RESPONSE:"RESPONSE"},commands:{SHELL_APP_READY_FOR_BOOTSTRAP:"SHELL_APP_READY_FOR_BOOTSTRAP",BOOTSTRAP:"BOOTSTRAP",INIT:"INIT",SHELL_APP_INITIALISED:"SHELL_APP_INITIALISED",SHOW:"SHOW",HIDE:"HIDE",JOIN_CALL:"JOIN_CALL",START:"START",ACCEPT:"ACCEPT",UPDATE_INCOMING_PAYLOAD:"UPDATE_INCOMING_PAYLOAD",REJECT:"REJECT",STOP:"STOP",MUTE:"MUTE",UNMUTE:"UNMUTE",CALL_INFO:"CALL_INFO",CONTACTS_DATA_REQUEST:"CONTACTS_DATA_REQUEST",CONTACTS_DATA_RESPONSE:"CONTACTS_DATA_RESPONSE",TOPIC_UPDATE:"TOPIC_UPDATE",SYNC_PARTICIPANTS:"SYNC_PARTICIPANTS",CHANGE_STATE:"CHANGE_STATE",UPDATE_PARTICIPANT_STATE:"UPDATE_PARTICIPANT_STATE",PARTICIPANT_AUTHORIZE:"PARTICIPANT_AUTHORIZE",PSTN_EVENT:"PSTN_EVENT",SHELL_APP_LOG:"SHELL_APP_LOG",PLUGIN_ERROR:"PLUGIN_ERROR",ESCALATE_CONVERSATION:"ESCALATE_CONVERSATION",SETTINGS_UPDATE:"SETTINGS_UPDATE"},shellAppIndexPagePath:"/shellApp/index.html",shellAppPreloadEnabledVersion:"7.4",shellAppMethods:{PostMessage:"postMessage",GetVersion:"getVersion",ShowWindow:"showWindow",HideWindow:"hideWindow",CloseWindow:"closeWindow"},shellAppEvents:{MessageReceived:"message",WindowShown:"windowShown",WindowHidden:"windowHidden",WindowClosing:"windowClosing"},shellAppMetaSelector:"meta[name=swx-chrome-extension]"}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/keys",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMBER_0:48,NUMBER_9:57,NUMPAD_0:96,NUMPAD_9:105,A:65,G:71,H:72,J:74,K:75,L:76,Z:90,F6:117,F10:121}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/common",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={storageKeys:{ENDPOINT_ID:"endpointId",PRESENCE_DATA:"presenceData",RESURECTION_KEY:"isResurected",RECENT_COUNTRY:"swx|recentCountry",AAD_TOKEN_EXPIRED:"aadTokenExpired",CHAT_NOTIFICATIONS_SETTINGS_KEY:"chatNotificationsMuted",NOTIFICATIONS_SOUND_SETTINGS_KEY:"notificationsSoundMuted",CHAT_NOTIFICATIONS_SOUND_SETTINGS_KEY:"chatNotificationsSoundMuted",CALL_NOTIFICATIONS_SETTINGS_KEY:"callNotificationsMuted",RINGING_DEFERRER_SETTINGS_KEY:"ringingDeferrerSetting"},browserProperties:{DEFAULT:{HIDDEN:"hidden",VISIBILITY_CHANGE:"visibilitychange"},MS:{HIDDEN:"msHidden",VISIBILITY_CHANGE:"msvisibilitychange"},MOZ:{HIDDEN:"mozHidden",VISIBILITY_CHANGE:"mozvisibilitychange"},WEBKIT:{HIDDEN:"webkitHidden",VISIBILITY_CHANGE:"webkitvisibilitychange"}},permission:{DEFAULT:"default",GRANTED:"granted",DENIED:"denied"},events:{actions:{subscriptionCreation:"subscriptioncreation",getUserPresence:"getuserpresence",setUserPresence:"setuserpresence",getSelfProperties:"getselfproperties",messageSubmitted:"messagesubmitted",messageQuoted:"messageQuoted",callMade:"action:callMade"},auth:{SIGNIN_FAILED:"signInFailed",SIGN_OUT:"signOut"},callScreen:{CONTROLS_VISIBLE:"controlsVisible",VIDEO_STATE_CHANGED:"videoStateChanged",VIDEO_CONTAINER_SIZE_CHANGED:"videoContainerSizeChanged",SIDEBAR_TOGGLED:"sidebarToggled",VIDEO_ZOOMED_IN:"videoZoomedIn",TOGGLE_FULLSCREEN:"toggleFullscreen",TOGGLE_NARROW_MENU:"toggleNarrowMenu",BUTTON_FOCUSED:"buttonFocused",FOCUS_CALL_SCREEN:"focusCallScreen",BUTTONS_WIDTH_CHANGED:"buttonsWidthChanged",ROSTER_WIDTH_CHANGED:"rosterWidthChanged",TOGGLE_MODAL_DIALOG:"toggleCallScreenModal",MORE_ACTION_MENU_VISIBLE:"moreActionsMenuVisible",MORE_ACTION_MENU_HIDDEN:"moreActionsMenuHidden",DIALPAD_VISIBLE:"dialpadVisible",DIALPAD_HIDDEN:"dialpadHidden",STAGE_LAYOUT_CHANGED:"stageLayoutChanged",PARTICIPANT_MENU_VISIBILITY_CHANGED:"participantMenuVisibilityChanged",PARTICIPANT_MENU_FOCUSED:"participantMenuFocused",TOGGLE_GRID_VIEW:"toggleGridView",PINNED_PARTICIPANT_CHANGED:"pinParticipant",PARTICIPANT_ITEM_CONTEXT_MENU:"participantItemContextMenu",SHOW_CHAT:"showChat",HIDE_CHAT:"hideChat"},contacts:{CONTACTS_LOADED:"contactsLoaded",CONTACT_REQUEST_SENT:"contactRequestSent",CONTACT_REQUEST_ACCEPTED:"contactRequestAccepted",CONTACT_REQUEST_DECLINED:"contactRequestDeclined"},message:{RENDERED:"message:rendered",QUOTE:"message:quote",EDIT:"message:edit",COPY:"message:copy",AFTER_EXPANDED:"message:afterExpanded",BEFORE_EXPANDED:"message:beforeExpanded",REMOVED:"message:removed",SENT:"message:sent",ADD_CONTACT:"message:addContact"},resourceTypes:{userPresence:"userpresence"},navigation:{OPEN_CONVERSATION:"navigate:conversation",NAVIGATE:"navigate:navigate",NAVIGATE_TO_PREVIOUS_PAGE:"navigate:previousPage",NAVIGATE_TO_SEARCH_INPUT:"navigate:searchInput",COMPONENT_RENDERED:"component:rendered",FRAGMENT_SHOW:"fragment:show",FRAGMENT_HIDE:"fragment:hide",FRAGMENT_BEFORE_SHOW:"fragment:beforeShow",FRAGMENT_BEFORE_HIDE:"fragment:beforeHide",FRAGMENT_LOADED:"fragment:loaded",FRAGMENT_REMOVE:"fragment:remove",FRAGMENT_REMOVE_ALL_HIDDEN:"fragment:removeAllHidden",LEAVE_EDIT_MODE:"leave:edit:mode",NOTIFICATIONS_CENTER:"navigate:notificationsCenter"},search:{QUERY_CHANGED:"query:changed",QUERY_EXECUTED:"query:finished",QUERY_RESET:"query:reset",RESET:"search:reset",DIRECTORY_SEARCH_RESULTS:"search:directory:results",DIRECTORY_SEARCH_RESULTS_RENDERED:"search:directory:results:rendered",DIRECTORY_SEARCH_ACTIVATED:"search:directory:activated",DIRECTORY_SEARCH_DEACTIVATED:"search:directory:deactivated",ACTIVATE_DIRECTORY_SEARCH:"search:directory:activate",GROUPS_SEARCH_RESULTS:"search:groups:results",LOCAL_SEARCH_RESULTS:"search:local:results",LOCAL_SEARCH_RESULTS_RENDERED:"search:local:results:rendered",INPUT_FOCUS:"searchInput:focus",INPUT_BLUR:"searchInput:blur",SESSION_SUCCESS:"search:sessionSuccess"},roster:{ROSTER_QUERY_CHANGED:"roster:participants:search",ROSTER_QUERY_EXECUTED:"roster:participants:searchFinished",ROSTER_SELECTION_REMOVED:"roster:selection:removed",PICKER_CONTACT_SELECTED:"people:picker:selected",PICKER_CONTACT_DESELECTED:"people:picker:deselected",EDIT_ROSTER_MODE:"roster:editRosterMode"},conversation:{JOINING_ENABLED:"conversation:joining:enabled",OPEN_PROFILE:"conversation:open:profile",CLOSE_PROFILE:"conversation:close:profile",COPY_LINK:"conversation:copy:link",EMAIL_LINK:"conversation:mail:link",SHARED:"conversation:shared",MARK_AS_READ:"conversation:mark:read",VIEWPORT_CHANGED:"conversation:viewport:changed",MESSAGES_LOADED:"conversation:messages:loaded",OVERLAY_CLOSED:"conversation:overlay:closed"},expressionPicker:{ITEM_PREVIEW_REQUEST:"pes:picker:previewRequest",ITEM_SELECT_REQUEST:"pes:picker:selectRequest",ITEM_SEND_REQUEST:"pes:picker:sendRequest",ITEM_CANCEL_REQUEST:"pes:picker:cancelRequest",TAB_SELECT_REQUEST:"pes:tabs:selectRequest",CLOSE_REQUEST:"pes:picker:close",OPEN_REQUEST:"pes:picker:open",MRUITEM_ADD_REQUEST:"pes:mruitem:addRequest",MRUITEM_ADD_EMOTICON_REQUEST:"pes:mruitem:addEmoticonRequest"},suggestionList:{SHOWN:"suggestionList:shown",HIDDEN:"suggestionList:hidden",ITEM_SELECTED:"suggestionList:itemSelected"},textarea:{MESSAGE_SENT:"textarea:messageSent",SUBMIT_AND_FOCUS:"textarea:submitAndFocus",CHANGED:"textarea:changed",KEY_DOWN:"textarea:keyDown",KEY_PRESS:"textarea:keyPress",INPUT:"textarea:input",HAS_INPUT:"textarea:hasInput",INITIALIZATION_COMPLETE:"textarea:initializationComplete",SET_ATTRIBUTION:"textarea:setAttribution",UPDATE_SMS_DESTINATION:"textarea:updateSmsDestination",UPDATE_SMS_FRAGMENTS:"textarea:updateSmsFragments",UPDATE_TEXTAREA_ENABLE:"textarea:enable"},chatInput:{INITIALIZATION_COMPLETE:"chatInput:initializationComplete"},emoticonPicker:{EMOTICON_SELECTED:"emoticon:selected",CLOSE:"emoticon:close"},errors:{SERVICE_FAILURE:"serviceFailure"},system:{EXPERIENCE_INITIALIZED:"experienceInitialized",EXPERIENCE_READY:"experienceReady",BUTTON_CLICK:"buttonClick",FORCE_RESYNC:"webapi:forceResync",ONLINE_STATE_CHANGED:"webapi:onlineStateChanged",DATE_CHANGED:"dateChanged"},trouter:{CONTACTLIST_CHANGE:6,OFFLINE_AUTHREQUEST:14,INCOMING_SKYPE_NGC_CALL:107,INCOMING_SKYPE_P2P_CALL:108,INCOMING_SKYPE_NGC_GVC_CALL:109,INCOMING_LYNC_NGC_CALL:105,INCOMING_STOP_RINGER:104,INCOMING_SKYPE_NGC_STOP_RINGER:110,INCOMING_SKYPE_NGC_PSTN_CALL:111,USER_SERVICES_CHANGE:601,INCOMING_CONTACT_INVITE:801,OUTGOING_CONTACT_INVITE_ACCEPTED:802,CONTACT_INVITES_LIST_CHANGE:803,USER_PROFILE_CHANGE:20,USER_AVATAR_CHANGE:21},newConversation:{CONFIRMED:"newConversation:confirmed",CANCELLED:"newConversation:cancelled"},narrowMode:{SIDEBAR_STATE_CHANGED:"narrowMode:sidebarStateChanged",SHOW_SIDEBAR:"narrowMode:showSidebar",HIDE_SIDEBAR:"narrowMode:hideSidebar",SIDEBAR_TRANSITION_ENDED:"narrowMode:sidebarTransitionEnded"},interaction:{SCROLL_START:"interaction:scrollStart"},browser:{CLICK:"click",RESIZE:"resize",SCROLL:"scroll",FOCUS:"focus",BLUR:"blur",KEYDOWN:"keydown",KEYUP:"keyup",KEYPRESS:"keypress",MOUSEMOVE:"mousemove",MOUSEDOWN:"mousedown",BEFOREUNLOAD:"beforeunload",VISIBILITYCHANGE:"visibilitychange",TRANSITIONEND:"transitionend",MESSAGE:"message",CONTEXTMENU:"contextmenu",NARRATOR_ANNOUNCE:"announce"},personalExpression:{CONFIG_INITIALIZED:"pes:configInitialized",CONFIG_PROCESSED:"pes:configProcessed",CDN_TOKEN_UPDATED:"pes:cdnTokenUpdated",store:{LOAD_PACKS:"pesStore:loadPacks",PACK_PURCHASED:"pesStore:packPurchased"}},mediaPicker:{CLOSE_PICKER:"mediaPicker:closePicker",FILE_PICKER_SELECTED:"mediaPicker:filePickerSelected",SEND_CONTACTS_SELECTED:"mediaPicker:sendContactsSelected",POLL_BUTTON_SELECTED:"mediaPicker:pollButtonSelected"},shareControl:{SHARE_CONTROL_SHOW:"shareControl:show",SHARE_CONTROL_HIDE:"shareControl:hide"},skypeOut:{DIAL_BUTTON_CLICKED:"skypeOut:dialButtonClicked",INPUT_CHANGED:"skypeOut:inputChanged",INPUT_TYPE_TOUCH:"touch",INPUT_TYPE_MOUSE:"mouse",INPUT_TYPE_KEYBOARD:"keyboard"},selectBox:{TOGGLE:"selectBox:toggle"},userListPopup:{POPUP_TOGGLE:"userListPopup:toggle"},videoPlayer:{FULLSCREEN_ON:"videoPlayer:fullscreenOn",FULLSCREEN_OFF:"videoPlayer:fullscreenOff"},me:{PRESENCE_POPUP_SHOW:"presencePopup:show",MOOD_MESSAGE_EDIT:"moodMessage:edit"},flags:{SET_FLAG:"setFlag"},contextMenu:{MENU_SHOWN:"contextMenu:shown",MENU_HIDDEN:"contextMenu:hidden"}},styleMode:{breakpoint:{NARROW:420,MEDIUM:600,WIDE:800},NARROW:"style:narrow",MEDIUM:"style:medium",WIDE:"style:wide"},deviceSelection:{DEFAULT_ID:"default",DEFAULT_NAME:"default"},notifications:{ERROR:"shellError",SUCCESS:"shellSuccess",WARNING:"shellWarning",INCOMING_CALL:"incomingCall",INCOMING_CALL_WITH_NO_PLUGIN:"incomingCallWithNoPlugin",INCOMING_CALL_BROWSER_NOT_SUPPORTED:"incomingCallBrowserNotSupported",INCOMING_CALL_OS_NOT_SUPPORTED:"incomingCallOsrNotSupported",DEVICE_MISSING_CAMERA:"cameraMissing",DEVICE_MISSING_MICROPHONE:"microphoneMissing",DEVICE_MISSING_SPEAKER:"speakerMissing",UNREAD_MESSAGE:"UnreadMessage",CONTACT_REQUEST:"ContactRequest",SIGN_IN_REQUEST:"SignInRequest",CHAT:"Chat",AUDIO:"Audio",AUDIO_CALL:"AudioCall",AUDIO_WITHOUT_VIDEO:"AudioWithoutVideo",EDUCATION:"Education",AVATAR_NOT_SUPPORTED_IMAGE_TYPE:"AvatarNotSupportedImageType",AVATAR_TOO_LARGE:"AvatarTooLarge",AVATAR_UPLOAD_ERROR:"AvatarUploadError"},serviceLocator:{FEATURE_FLAGS:"featureFlagApi",CONTROLS_BUILDER:"controlsBuilder",NAVIGATION_CONTEXT:"navigation",PUBSUB:"pubSub",SETTINGS:"settings",LOCAL_STORAGE:"localStorage",TELEMETRY_MANAGER:"telemetryManager",MODEL_UI_OBSERVER:"webClientModelObserver",SPLASH_SCREEN:"spashScreen",SUBSCRIPTION_PROVIDER:"subscriptionProvider",ACTION_TELEMETRY:"actionTelemetry",PES_MRU_SERVICE:"pesMRUService",PES_BING_SEARCH_SERVICE:"pesBingSearchService",PES_GIPHY_SEARCH_SERVICE:"pesGiphySearchService",URL_PREVIEW_SERVICE:"urlPreviewService",PES_CONFIG_SERVICE:"pesConfigService",PES_STORE_SERVICE:"pesStoreService",PROGRESSIVE_TIMEOUT:"progressiveTimeout"},msnpErrors:{nonExistingConverstion:730,redirectionOverride:752,missingEndpoint:729,invalidSyncState:230},callingErrors:{AUTO_CALL_FAILED:"AUTO_CALL_FAILED"},httpStatusCodes:{OK:200,created:201,badRequest:400,unauthorized:401,notFound:404,forbidden:403,preconditionFailed:412,unprocessableEntity:422,internalServerError:500},onlineStates:{ONLINE:"state:online",OFFLINE:"state:offline"},translatorServiceState:{NotReady:"NotReady",Authenticated:"Authenticated",Error:"Error"},isTyping:{THROTTLE:5e3,EXPIRY:7e3,DETAILED_PARTICIPANTS_MAX_COUNT:2,MESSAGE_TYPE:{SET_TYPING:"Control/Typing",CLEAR_TYPING:"Control/ClearTyping"}},activityItemGroups:{PARTICIPANT:"participant",TEXT:"text",CALL:"live-session",NGC_UPGRADE:"ngc-upgrade",PLUGIN_FREE:"plugin-free",MEDIA:"media",CONTACT_REQUEST:"contact-request",MOJI:"moji",CONTACT_INFO:"contact-info",TRANSACTION:"transaction",POLL:"poll",PSTN:"pstn",CUSTOM:"custom",TRANSCRIPT:"transcript",SYSTEM:"system"},customActivityItemTemplates:{SPACES_WELCOME_MESSAGE:"spacesWelcomeMessage"},featureFlags:{AGENTS_ENABLED:"agentsEnabled",AGENTS_DISCOVERABLE:"agentsDiscoverable",SHOW_AGENT_ID_ON_PROFILE:"showAgentIdOnProfile",SHOW_AGENT_RATING_ON_PROFILE:"showAgentRatingOnProfile",SHOW_AGENT_EXTRA_INFO_ON_PROFILE:"showAgentExtraInfoOnProfile",URL_OVERRIDE_ENABLED:"urlOverrideEnabled",CONTACTLIST_CHANGE_NOTIFICATION:"contactListChangeNotification",SHOW_SPLASH_SCREEN:"showSplashScreen",SHOW_EDU_CAROUSEL:"showEducationalCarousel",BLOCK_CONTACT:"blockContact",DEACTIVATE_CACHE:"deactivateCache",HAS_TIMELINE_BADGE:"hasTimelineBadge",HAS_BETA_LABEL:"hasBetaLabel",HAS_FEEDBACK_LINK:"hasFeedbackLink",HAS_FEEDBACK_LINK_ON_ERROR:"hasFeedbackLinkOnError",SKYPE_DIRECTORY_SEARCH:"skypeDirectorySearch",MUTE_NOTIFICATIONS:"muteNotifications",BROWSER_NATIVE_NOTIFICATIONS_ENABLED:"browserNativeNotificationsEnabled",USE_DARK_THEME_FOR_BROWSER_NOTIFICATIONS_OPT_IN_FLOW:"useDarkThemeForBrowserNotificationsOptInFlow",BROWSER_NOTIFICATIONS_EDUCATIONAL_TOAST_ENABLED:"browserNotificationEducationalToastEnabled",LAST_SEEN:"lastSeen",MOBILE_INDICATOR:"mobileIndicator",NEW_CONVERSATION_V2:"newConversationV2",SPACES:"spaces",SHOW_SPACES_WELCOME_MESSAGE:"showSpacesWelcomeMessage",SHOW_CONTACTS_PAGE_HINT:"showContactsPageHint",SHOW_CONTACTS_PAGE_INFORMATIONAL_MESSAGE:"showContactsPageInformationalMessage",SHOW_FIRST_RUN_LANDING_EXPERIENCE:"showFirstRunLandingExperience",INCOMING_SCREEN_SHARING:"incomingScreenSharing",OUTGOING_SCREEN_SHARING:"outgoingScreenSharing",OUTGOING_SCREEN_SHARING_PREVIEW:"outgoingScreenSharingPreview",TRANSFER_CALL:"transferCall",INCOMING_WIKI_MARKUP:"incomingWikiMarkup",MESSAGE_ENFORCE_TEXT_FORMAT:"messageEnforceTextFormat",PHOTO_SHARING_ENABLED:"photoSharingEnabled",SPACE_TOPIC_EDITOR:"spaceTopicEditor",HEADER_CONTROLS_DISABLED:"headerControlsDisabled",HIDE_SIDEBAR_ON_START:"hideSidebarOnStart",SINGLE_CONVERSATION_MODE:"singleConversationMode",DISABLE_POLLING_ON_KAHUNA:"disablePollingOnKahuna",ENABLE_RAW_EMOTICONS_RENDERING:"enableRawEmoticonsRendering",UNREAD_MESSAGE_REMINDER_TOAST:"unreadMessageReminderToast",PROFILE_UPDATE_NOTIFICATIONS_ENABLED:"profileUpdateNotificationsEnabled",TIMEZONE_IN_CHATSERVICE_REQUEST:"timezoneInChatServiceRequest",CONTENT_SEARCH:"contentSearch",SWIFT_CARD_COMMAND:"swiftCardCommand",SWIFT_CARD_RENDERING:"swiftCardRendering",SWIFT_CARD_RENDERING_MEDIA_CARDS:"swiftCardRenderingMediaCards",BOT_MESSAGES_MODE_V2_ENABLED:"botMessagesModeV2enabled",SUGGESTED_ACTIONS_ENABLED:"suggestedActionsEnabled",UNREAD_MSG_LOGGING:"enableUnreadMessagesLogging",SEND_SKYPE_INITIATING_USERNAME:"sendSkypeInitiatingUsername",SHOW_MESSAGE_DELIVERY_INDICATOR_SW4B:"showMessageDeliveryIndicator",SHOW_MESSAGE_DELIVERY_STATUS:"showMessageDeliveryStatus",SHOW_TIMESTAMPS_IN_NARROW_MODE:"showTimestampsInNarrowMode",HIDE_EMOTICON_PICKER_BUTTON:"hideEmoticonPickerButton",IS_TYPING_INDICATOR:"isTypingIndicator",SERVICE_FAILURE_REPORTING:"serviceFailureReporting",CALLING:"calling",CALLING_FULL_SCREEN_ENABLED:"callingFullScreen",INCLUDE_SELF_IN_PARTICIPANTS_COUNT:"includeSelfInParticipantsCount",HIDE_USER_ROLE:"hideUserRole",SHOW_ALTERNATE_SHARE_DIALOG_EXPERIENCE:"showAlternateShareDialogExperience",IS_FLIK_MESSAGE_ENABLED:"isFlikMessageEnabled",PES_CDN_AUTH_ENABLED:"pesCDNAuthEnabled",PINNING_TO_DOGFOOD_CLOUD:"pinningToDogfoodCloud",NOTIFICATIONS_CENTER:"notificationsCenter",POLLS_ENABLED:"pollsEnabled",SUPPORT_MESSAGE_PROPERTIES:"supportMessageProperties",ENABLE_PING_ECS_CONFIG:"enablePingEcsConfig",ENABLE_ENDPOINT_ECS_CONFIG:"enableEndpointEcsConfig",SUPPORT_STANDBY_MODE:"supportStandbyMode",MENTIONS_ENABLED:"mentionsEnabled",MENTIONS_PEOPLE_ENABLED:"mentionsPeopleEnabled",CODE_SNIPPET_ENABLED:"codeSnippetEnabled",SKYPE_URI_NAVIGATION_ENABLED:"skypeUriNavigationEnabled",ALTERNATIVE_SIDEBAR_LAYOUT_ENABLED:"alternativeSidebarLayout",CONTEXT_MENU_QUOTE_MESSAGES_ENABLED:"contextMenuQuoteMessagesEnabled",CONTEXT_MENU_COPY_MESSAGES_ENABLED:"contextMenuCopyMessagesEnabled",CONTEXT_MENU_SAVE_VIDEO_MESSAGES_ENABLED:"contextMenuSaveVideoMessagesEnabled",CONTEXT_MENU_MARK_AS_READ_ENABLED:"contextMenuMarkAsReadEnabled",MARK_READ_MESSAGES_V2_ENABLED:"markReadMessagesV2Enabled",SKIP_CHAT_CAPABILITY_CHECK:"skipChatCapabilityCheck",URL_PREVIEWS:"urlPreviews",SILENT_LINKING:"silentLinking",REMOVE_CONVERSATION_HISTORY:"removeConversationHistory",AVATAR_SERVICE_SUPPORTS_SIZE_PARAMETER:"avatarServiceSupportsSizeParameter",COPY_SELECTION_AS_QUOTE_KEYBOARD:"copySelectionAsQuoteKeyboard",FULL_SCREEN_MODE_FROM_SIDEPANE:"fullScreenModeFromSidepane",GDPR_WEB_API:"GDPRwebApi",PES_CDN_AUTH_URL_FALLBACK_ENABLED:"pesCDNAuthUrlFallbackEnabled",PES_FETCH_SMALL_ASSETS_ON_DEMAND:"pesFetchSmallAssetsOnDemand",PES_FETCH_MEDIUM_ASSETS_ON_DEMAND:"pesFetchMediumAssetsOnDemand",PES_FETCH_LARGE_ASSETS_ON_DEMAND:"pesFetchLargeAssetsOnDemand",PES_FETCH_MOJI_ASSETS_ON_DEMAND:"pesFetchMojiAssetsOnDemand",PES_USE_EXTRA_LARGE_EMOTICONS:"pesUseExtraLargeEmoticons",PES_BING_IMAGE_SEARCH_ENABLED:"pesBingImageSearchEnabled",PES_GIPHY_IMAGE_SEARCH_ENABLED:"pesGiphyImageSearchEnabled",PES_LOCAL_SEARCH_ENABLED:"pesLocalSearchEnabled",EMOTICON_SUGGESTION_ENABLED:"emoticonSuggestionEnabled",EMOTICON_IMPLICIT_SUGGESTION_DISABLED:"emoticonImplicitSuggestionDisabled",SUGGEST_HIDDEN_EMOTICONS:"suggestHiddenEmoticons",PES_STORE_ENABLED:"pesStoreEnabled",EMOTICON_SETTINGS_ENABLED:"emoticonSettingsEnabled",YOUTUBE_PLAYER_ENABLED:"youtubePlayer",FILE_DRAG_DROP_ENABLED:"fileDragDropEnabled",FILE_PASTE_ENABLED:"filePasteEnabled",TYPING_INDICATOR_ENABLED:"showWhenIamTyping",FILE_TRANSFER_ENABLED:"fileTransferEnabled",CONTEXT_MENU_LIKE_MESSAGES_ENABLED:"contextMenuLikeMessagesEnabled",SHOW_DEFAULT_AVATAR_IN_NOTIFICATIONS:"showDefaultAvatarInNotifications",MEDIA_BAR_ENABLED:"mediaBarEnabled",MEDIA_BAR_V2_ENABLED:"mediaBarV2Enabled",PSTN_ENABLED:"PSTN",CQF_ENABLED:"CQF",UNANSWERED_CALL_UI:"unansweredCallUIEnabled",CONSOLE_LOGGING:"consoleLogging",ISSUE_REPORTING:"issueReporting",CALL_INFO_COMMAND:"callInfoCommand",ERROR_LOG_REPORTING:"errorLogReporting",AGGRESSIVE_IMPLICT_MENTIONS_MATCHING:"aggressiveImplicitMentionsMatching",ENABLE_AGGRESSIVE_MENTIONS_TOAST:"enableAggressiveMentionsToast",SEND_CONTACT_CARD_ENABLED:"sendContactCardEnabled",NOTIFY_HOST_EVEN_WHEN_ME_NOTAVAILABLE:"notifyHostEvenWhenMeNotAvailable",HEARTS_ENABLED:"heartsEnabled",HEARTS_NOTIFICATION_ENABLED:"heartsNotificationEnabled",SHOW_CHAT_INTRO_TEXT:"showChatIntroText",TRANSLATOR_SENDING_ENABLED:"translatorSendingEnabled",REACTIONS_SUPPORT_ENABLED:"reactionsSupportEnabled",HIGH_PRIORITY_SCRIPT_ENABLED:"addHighPriorityScript",CONTACT_CARD_RENDERING_ENABLED:"contactCardRenderingEnabled",NEW_URLP_DOMAIN_ENABLED:"newUrlPreviewDomainEnabled",IS_CLOUD_VIDEO_MESSAGE_ENABLED:"isCloudVideoMessageEnabled",IS_CLOUD_AUDIO_MESSAGE_ENABLED:"isCloudAudioMessageEnabled",CREDIT_GIFTING:"creditGifting",MUTE_SPECIFIC_CONVERSATIONS_ENABLED:"muteSpecificConversationsEnabled",AUTO_CALLING:"autoCalling",GVC_ESCALATION:"GVCEscalation",GVC_LOCAL_ESCALATION:"GVCLocalEscalation",GVC_JOINING:"GVCJoining",GVC_OUTGOING:"GVCOutgoing",HOSTLESS_GROUP_CALLING_PLUGINLESS:"hostlessGroupCallingPluginless",PERSISTENT_PLUGIN:"persistentPlugin",PERSISTENT_SHELL_APP:"persistentShellApp",PLUGINLESS_CALLING_CHROME:"pluginlessCallingChrome",PLUGINLESS_CALLING_CHROME_NO_EXTENSION:"pluginlessCallingChromeNoExtension",PLUGINLESS_CALLING_CHROME_LINUX:"pluginlessCallingChromeLinux",PLUGINLESS_CALLING_EDGE:"pluginlessCallingEdge",PLUGINLESS_CALLING_FIREFOX:"pluginlessCallingFirefox",PLUGINLESS_CALLING_ELECTRON:"pluginlessCallingElectron",PLUGINLESS_VIDEO_CALLING_CHROME_LINUX:"pluginlessVideoCallingChromeLinux",PLUGINLESS_VIDEO_CALLING_FIREFOX:"pluginlessVideoCallingFirefox",PLUGINLESS_GROUP_VIDEO_CALLING_CHROME_LINUX:"pluginlessGroupVideoCallingChromeLinux",PLUGINLESS_PSTN_CALLING:"pluginlessPSTNCalling",PLUGINLESS_INCOMING_SCREEN_SHARING_EDGE:"pluginlessIncomingScreenSharingEdge",PLUGINLESS_REMOTE_ESCALATION:"pluginlessRemoteEscalation",PLUGINLESS_LOCAL_ESCALATION:"pluginlessLocalEscalation",DEVICE_DISABLED_DIALOG_ENABLED:"deviceDisabledDialogEnabled",CAN_NOTIFY_WITHOUT_VIDEO:"canNotifyWithoutVideo",PRELOAD_PLUGIN:"preloadPlugin",PRELOAD_SHELL_APP:"preloadShellApp",NG_CALLING:"NGCalling",FAIL_INITIALIZATION_FOR_IE_AND_EDGE:"failInitializationOnIE",SHELL_APP_LOGS:"shellAppLogs",BROKER_ENABLED_OUTGOING:"brokerEnabledOutgoing",BROKER_ENABLED_INCOMING:"brokerEnabledIncoming",BROKER_REQUEST_BATCHING:"brokerRequestBatching",BROKER_EXCLUSIVELY:"brokerExclusively",SYNC_TROUTER_RESPONSE:"supportsSynchronousTrouterResponse",SUPPORT_PAYLOAD_COMPRESSION:"supportsCompressedServicePayload",HANDLE_OFFER_FROM_NOTIFICATION:"handleMediaOfferFromPushNotification",SEND_PROGRESS_FROM_CC:"sendProgressFromCC",HANDLE_UNMUTE_MUTE_FROM_RESPONSE:"handleUnmuteMuteFromResponse",INVITE_FREE:"inviteFree",INVITE_FREE_IMPLICIT_INCOMING_CONTACT_REQUEST:"inviteFreeImplicitIncomingContactRequest",SHORT_CIRCUIT:"shortCircuit",USER_SETTINGS_ENABLED:"userSettingsEnabled",ALTERNATIVE_SETTINGS_POSITION:"alternativeSettingsPositionEnabled",SHOW_UNLISTED_SETTINGS:"showUnlistedSettings",ABOUT_PAGE_ENABLED:"aboutPageEnabled",LOCATION_MESSAGE_SUPPORT:"locationMessageSupport",READ_RECEIPT_ENABLED:"readReceiptEnabled",URL_PREVIEW_LOAD_YOUTUBE_PLAYER:"urlPreviewLoadYoutubePlayer",SEARCH_EDUCATION_BUBBLE:"searchEducationBubble",CHAT_EDUCATION_BUBBLE:"chatEducationBubble",CALL_EDUCATION_BUBBLE:"callEducationBubble",SCHEDULE_CALL_EDUCATION_BUBBLE_1:"scheduleCallEducationBubble1",SCHEDULE_CALL_EDUCATION_BUBBLE_2:"scheduleCallEducationBubble2",WELCOME_DIALOG:"welcomeDialog",NOTIFICATIONS_SETTINGS_ENABLED:"notificationsSettingsEnabled",NOTIFICATIONS_SOUNDS_SETTING_ENABLED:"notificationsSoundsSettingsEnabled",CHAT_NOTIFICATIONS_SETTINGS_ENABLED:"chatNotificationsSettingsEnabled",CHAT_NOTIFICATIONS_SOUND_SETTINGS_ENABLED:"chatNotificationsSoundSettingsEnabled",CALL_NOTIFICATIONS_SETTINGS_ENABLED:"callNotificationsSettingsEnabled",CALL_NOTIFICATIONS_SOUND_SETTINGS_ENABLED:"callNotificationsSoundSettingsEnabled",UNREAD_MESSAGE_TOAST_NOTIFICATIONS:"unreadMessageToastNotifications",INCOMING_CALL_TOAST_NOTIFICATIONS:"incomingCallToastNotifications",CONTACT_REQUEST_TOAST_NOTIFICATIONS:"contactRequestToastNotifications",CHAT_REQUEST_TOAST_NOTIFICATIONS:"chatRequestToastNotifications",UNREAD_MESSAGE_TOAST_FOR_ACTIVE_ENDPOINT:"unreadMessageToastForActiveEndpoint",CHAT_MESSAGE_TYPE_NOTIFICATION_ENABLED:"chatMessageTypeNotificationEnabled",TELEMETRY_UIACTIONPERF_ENABLED:"uiActionPerfTelemetryEnabled",TELEMETRY_RUNTIME_ERRORS_ENABLED:"runtimeErrorsTelemetryEnabled",TELEMETRY_CAPTURE_SOURCE_ENABLED:"captureSourceInAllTelemetryEnabled",DO_NOT_SEND_CONTACTS_TO_CHAT_SERVICE:"doNotSendContactsToChatService",SCHEDULE_CALL_FROM_CONVERSATION:"scheduleCallFromConversation",USE_LEGACY_SCHEDULER_URI_FORMAT:"useLegacySchedulerUriFormat",DIRECTORY_SEARCH_SKYPE_AND_LYNC:"directorySearchSkypeAndLync",USE_GRAPH_SEARCH_ANNOTATIONS:"useGraphSearchAnnotations",GRAPH_SEARCH_MIRRORING_ENABLED:"graphSearchMirroringEnabled",GIPHY:"giphy",ME_COMMAND_ENABLED:"meCommandEnabled",SKYPE_CALL_POLICY_SUPPORT:"skypeCallPolicySupport",SKYPE_VIDEO_CALLING_POLICY_SUPPORT:"skypeVideoCallingPolicySupport",SHORT_CIRCUIT_SUPPORT:"shortCircuit",FETCH_CONTACTS_BY_PAGE:"fetchContactsByPageEnabled",CONTACT_PAGE_FILTER_TABS:"contactPageFilterTabs",USE_AZURE_BASED_SILENT_LOGIN:"useAzureBasedSilentLogin",KEY_ENCRYPTION_SERVICE_V2_ENABLED:"keyEncryptionServiceV2Enabled",NAVIGATION_MENU_ICONS_ENABLED:"navigationMenuIconsEnabled",CANVAS_EMOTICONS_ENABLED:"canvasEmoticonsEnabled",MOOD_MESSAGE_EDIT_ENABLED:"moodMessageEditEnabled",FAVORITES_CONVERSATION_ENABLED:"favoritesConversationsEnabled",FAVORITE_CONTACTS_ENABLED:"favoriteContactsEnabled",SYNC_THREAD_BEFORE_JOIN_CONVERSATION_FLOW_ENABLED:"syncThreadBeforeJoinConversationEnabled",AUDIO_VIDEO_SETTINGS_SUPPORT:"audioVideoSettingsSupport",SPLASH_SCREEN_WHITE_THEME:"useWhiteThemeForSplashScreen",SHOW_SIGN_IN_BUTTON_ON_TIMEOUT:"showSignInButtonOnTimeout",SHOW_SIGN_IN_BUTTON_ON_SIGNOUT:"showSignInButtonOnSignout",IDLE_USERS_ANALYTICS:"idleUsersAnalytics",USERS_ANALYTICS:"usersAnalytics",ENHANCED_NOTIFICATION:"enhancedNotification",REOPEN_SIDEBAR:"sidebarReopenEnabled",USE_AVATAR_CACHE:"useAvatarCache",USE_AVATAR_INITIALS:"useAvatarInitials",SHOW_ONE_ACCOUNT_LINK:"showOneAccountLink",INIT_PREFERENCES_AFTER_SIGNIN:"initPreferencesAfterSignin",RINGING_DEFERRING:"ringingDeferring",SHOW_EMOTICON_SUGGESTIONS_SETTINGS:"showEmoticonSuggestionsSetting",FORMAT_QUOTES_ENABLED:"formatQuotesEnabled",DARK_THEME_ENABLED:"darkThemeEnabled",VIDEO_AUTOPLAY_SETTINGS_ENABLED:"videoAutoPlaybackSettingsEnabled",ASK_TO_UNBLOCK_PLUGIN:"askToUnblockPlugin",SMS_SUPPORT_ENABLED:"smsSupportEnabled",UNREAD_CONVERSATION_DEBUGGER:"unreadConversationDebugger",GROUP_AVATAR_UPDATE_ENABLED:"groupAvatarUpdateEnabled",HIDE_SYSTEM_MESSAGES:"hideSystemMessages",LOW_FOCUS_IMPORTANCE_CONTACT_REQUEST:"lowFocusImportanceContactRequest",ENABLE_BUSINESS_CONTACT_MANAGEMENT:"enableBusinessContactManagement",USE_BUSINESS_WORDING:"useBusinessWording",SEARCH_EDUCATION_BUBBLE_BUSINESS:"searchEducationBubbleBusiness",CHAT_EDUCATION_BUBBLE_BUSINESS:"chatEducationBubbleBusiness",NOTIFICATIONS_TOGGLE_ENABLED:"notificationsToggleEnabled",DISABLE_CONCURRENT_ACTIVE_CALLS:"disableConcurrentActiveCalls",DISABLE_CONTACT_CARD_MENU:"disableContactCardMenu",DISABLE_KES:"disableKes",DISABLE_LEAVE_CONVERSATION:"disableLeaveConversation",DISABLE_OPEN_CONVERSATION_WITH_AUTHOR:"disableOpenConversationWithAuthor",DISABLE_PERSISTENT_CONTACT_PRESENCE_SUBSCRIPTION:"disablePersistentContactPresenceSubscription",OPTIMIZE_SPACE_FOR_CC:"optimizeSpaceForCC",DISABLE_REMOVE_CONVERSATION_CONFIRMATION:"disableRemoveConversationConfirmation",DISABLE_CALLSCREEN_CHAT_OPTION:"disableCallScreenChatOption",HAS_FEEDBACK_ICON:"hasFeedbackIcon",SHOW_PICKER_SPINNER:"showPickerSpinner",SHOW_SEARCH_QUERY_MORE_RESULTS_AVAILABLE:"showSearchQueryMoreResultsAvailable",CALLSCREEN_MINMAX:"callscreenMinMax"},autoCallingMode:{call:"Call",join:"Join",golive:"GoLive"},autoCallingThreadId:"autoCallingThreadId",capabilities:{chat:"im.receive",audio:"audio.receive",video:"video.receive",screenSharing:"screen_share",groupAdd:"group.add",_gvc:"gvc",_groupChat:"group_chat",_fileSend:"file.send",_contactSend:"contact.send",_videoMessageSend:"videomessage.send",_audioMessageSend:"audiomessage.send",_mediaMessageSend:"meidamessage.send",_annotationSend:"annotation.send",_photoSend:"photo.send",_mojiSend:"moji.send",_locationSend:"location.send"},modalityType:{CHAT:"Chat",AUDIO:"Audio",VIDEO:"Video",SCREENSHARING:"ScreenSharing",DATACOLLABORATION:"DataCollaboration"},apiUIEvents:{SWX_TIMELINE_LOADED:"swx:timeline:loaded",SWX_CHAT_LOADED:"swx:chat:loaded",SWX_CONTENT_LOADED:"swx:content:loaded",SWX_SPLASHSCREEN_LOADED:"swx:splashscreen:loaded",SWX_CALLSCREEN_MAXIMIZE:"swx:callscreen:maximize",SWX_ON_SIGN_OUT:"swx:on:sign:out",SWX_SINGLE_CONVERSATION:"swx:single:conversation"},chat:{messageType:{OUTGOING:"Outgoing",INCOMING:"Incoming",AUDIO:"Audio",VIDEO:"Video"},BOT_MESSAGING_MODE:{UNDEFINED:"Undefined",ALL:"All",AT:"At"/*!< Participant in thread only gets messages which mention him/her.*/}},telemetry:{APP_SOURCE_NAME:"SWX",uiActions:{TYPE:"ui_action"},runtimeErrors:{TYPE:"runtime_error"},calling:{MASTER_EVENT:"calling",DEVICES:"devices",INTERNAL_PLUGIN_TELEMETRY:"internal_plugin_telemetry",CALL_INFO:"CallInfo",START_CALL:"StartCall",END_CALL:"EndCall",RINGING_CALL:"RingingCall",CONNECTED_CALL:"ConnectedCall",UNKNOWN_CONTACT_TYPE:"unknown",PARTICIPANTS_COUNT_PREFIX:"participantsCount_",direction:{OUTGOING:"Outgoing call",INCOMING:"Incoming call"},callType:{S2S:"S2S",SkypeOut:"SkypeOut",SkypeIn:"SkypeIn"},AVAILABLE:"Available",UNAVAILABLE:"Unavailable",NA:"N/A"},callQualityFeedback:{MASTER_EVENT:"call_quality_feedback",NA:"N/A",PROBLEM_TOKEN_PREFIX:"checks=",reason:{CANCEL:"cancel",RANDOM:"random"}},unansweredCallUI:{MASTER_EVENT:"log_call_unanswered"},autoCalling:{MASTER_EVENT:"autoCalling",SERVICE_FAILURE:"serviceFailure",AUTO_CALL_ENDED:"autoCallEnded",AUTO_CALL_PAYLOAD_INVALID:"autoCallPayloadInvalid",AUTO_CALL_HANDLING_ERROR:"autoCallHandlingError",HOST_JOINED:"hostJoined",PARTICIPANT_JOINED:"participantJoined",ATTEMPT_TO_JOIN:"attemptToJoin"},meArea:{CREDIT_DISPLAY:"credit_display"},chat:{UI_SEND_MESSAGE:"ui_sendMessage",UI_EDIT_MESSAGE:"ui_editMessage",MESSAGE_NOTIFICATION:"message_notification",FILE_TRANSFER:"file_transfer",SYSTEM_COMMAND:"system_command",VIDEO_MESSAGE:{TYPE:"video_message",action:{FIRST_PLAY:"firstPlay",PLAY:"play",FULLSCREEN:"fullscreen",SEEK:"seeking",REPLAY:"replay"},eventName:{LOADED:"loaded"}},AUDIO_MESSAGE:{TYPE:"audio_message",action:{VM_CHAT_PLAYBACK:"vm_chat_playback",VM_CHAT_REPLAY:"vm_chat_playback_replay"}},SMS_ADD_CREDIT:"sms_add_credit"},navigation:{ONE_TO_ONE_CHAT_SKYPE_URI:"skypeUriOneToOneChat",GROUP_CHAT_SKYPE_URI:"skypeUriGroupChat",ONE_TO_ONE_CALL_SKYPE_URI:"skypeUriOneToOneCall",GROUP_CALL_SKYPE_URI:"skypeUriGroupCall"},contacts:{type:{CONTACTS:"Contacts",CONTACT_REQUESTS:"ContactRequests"},name:{GET_CONTACT_LIST:"GetContactList",GET_CONTACT_LIST_DELTA:"GetContactListDelta",CONTACT_REQUEST_READ:"ContactRequestRead",CONTACT_REQUEST_ACCEPTED:"AcceptContact",CONTACT_REQUEST_DECLINED:"DeclineContact",CONTACT_BLOCKED:"ContactBlocked",CONTACT_UNBLOCKED:"ContactUnblocked",CONTACT_DELETED:"ContactDeleted",GET_PROFILES:"GetProfiles",ADD_CONTACT:"AddContact",CONTACTS_PAGE_PERFORMANCE:"ContactsPagePerformance",DISCOVER_AGENTS_PAGE_PERFORMANCE:"DiscoverAgentsPagePerformance",PROFILE_OPENED:"contact_profile_opened"},source:{INITIALIZED:"initilized",UPDATED:"updated"},shortCircuit:{START:"log_sc_start",FINISHED:"log_sc_finished",VISIBLE:"log_sc_visible",ADDRESS_BOOK_ADDED:"log_sc_address_book_added"},searchForFriends:{event:{SHOW:"searchForFriends_page_visible",CLICK:"searchForFriends_search_clicked",KEYDOWN:"searchForFriends_search_key_pressed"}}},contactsV2:{contactManagement:{TYPE:"contacts_contact",names:{ADD_CONTACT:"add_contact",UPDATE_CONTACT:"update_contact",REMOVE_CONTACT:"remove_contact",QUERY_CONTACT:"query_contact"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",ELAPSED:"elapsed",SOURCE:"action_source",CONTACT_TYPE:"contact_type"}},contactAction:{TYPE:"contacts_contact_action",names:{BLOCK_CONTACT:"block_contact",UNBLOCK_CONTACT:"unblock_contact",ADD_TO_FAVORITES:"add_contact_to_favorites",REMOVE_FROM_FAVORITES:"remove_contact_from_favorites"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",ELAPSED:"elapsed",SOURCE:"action_source",CONTACT_TYPE:"contact_type",REASON:"reason",REPORT_ABUSE:"report_abuse"}},contactList:{TYPE:"contacts_contact_list",names:{QUERY_CONTACT_LIST:"query_contact_list"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",ELAPSED:"elapsed",SOURCE:"action_source",SERVICE_ELAPSED:"service_elapsed",FULL_FETCH:"full_fetch",INITIAL_LOAD:"initial_load",NUM_CONTACTS:"number_of_contacts",NUM_AGENTS:"number_of_agents",NUM_SUGGESTED:"number_of_suggested",NUM_PENDING:"number_of_pending",NUM_BLOCKED:"number_of_blocked",NUM_FAVOURITES:"number_of_favorites"}},invitation:{TYPE:"contacts_invitation",names:{SEND_CONTACT_REQUEST:"send_contact_request",ACCEPT_CONTACT_REQUEST:"accept_contact_request",DECLINE_CONTACT_REQUEST:"decline_contact_request",QUERY_INVITATION_LIST:"query_invitation_list"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",SERVICE_ELAPSED:"service_elapsed",ELAPSED:"elapsed",SOURCE:"action_source",RESEND:"resend",INVITATION_COUNT:"invitationCount"}},contactSearch:{TYPE:"contacts_search",names:{SEARCH_ADDRESSBOOK:"search_addressBook",SEARCH_DIRECTORY:"search_directory",SEARCH_GROUPS:"search_groups"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",ELAPSED:"elapsed",SOURCE:"action_source",QUERY_ID:"query_id",RESULT_COUNT:"result_count",CLICK_POSITION:"click_position"}},searchSession:{TYPE:"contacts_search_session",names:{SEARCH_SESSION:"search_session"},fields:{NAME:"name",SUCCESS:"success",BEGIN_TIMESTAMP:"begin_timestamp",ELAPSED:"elapsed",SOURCE:"action_source",SESSION_ID:"session_id",SUCCESS_CRITERIA:"success_criteria",QUERY_COUNT:"query_count"},enums:{success_criteria:{IM_SENT:"IMsent",CALL_MADE:"callMade",CONTACT_ADDED:"contactAdded"}}}},agents:{type:{AGENTS:"Agents"},name:{DISCOVER_AGENTS_PAGE_PERFORMANCE:"DiscoverAgentsPagePerformance"}},autoBuddy:{SUCCESS:"AutoBuddySuccess"},pes:{eventName:{MOJI_SENT:"moji_sent",MOJI_PLAYED:"moji_played",EMO_SENT:"emo_sent",IMAGE_SENT:"image_sent",PICKER_OPENED:"expression_picker_opened"},section:{FEATURED:"FEATURED",REGULAR:"REGULAR"},source:{TYPED:"TYPED",ROSTER:"ROSTER",RECENTS:"RECENTS"},UNKNOWN:"N/A"},presence:{TYPE:"Presence",name:{SET_ME_PRESENCE:"SetMePresence",GET_CONTACTS_PRESENCE:"GetContactsPresence"}},search:{TYPE:"Search"},promiseInvalidStateException:{TYPE:"PromiseInvalidStateException",feature:{GROUP_SEARCH:"GroupSearch",CONTACT_PICKER:"ContactPicker",PEOPLE_SEARCH:"PeopleSearch"}},NOT_AVAILABLE:"n/a",conversationJoined:{TYPE:"weblauncher_join",result:{SIGNED_IN:"signed_in",SIGNED_OUT:"signed_out",SUCCESS:"success",INCONCLUSIVE:"inconclusive"},milestoneType:{CLIENT_INIT:"client_init",ERROR:"error",END:"end"}},guestActionsInHeader:{TYPE:"chat_guest_headerActions",cta:{PROFILE_TOGGLED:"profileToggled",COPY_LINK:"copyLink",EMAIL_LINK:"emailLink"},telemetryItem:{AVATAR:"telemetryItemAvatar",TOPIC:"telemetryItemTopic",CHEVRON_DOWN:"telemetryItemChevronDown",CHEVRON_UP:"telemetryItemChevronUp"},parent:{GROUP_PROFILE_VIEW_MODEL:"GroupProfileViewModel",HEADER_VIEW_MODEL:"HeaderViewModel"}},removeConversationHistory:{TYPE:"swx_conversation_removeHistory",cta:{TIMELINE_MENU:"timeline",PROFILE:"profile"},action:{CANCELED:"canceled",CONFIRMED:"confirmed"}},leaveConversation:{TYPE:"swx_conversation_leave",cta:{TIMELINE_MENU:"timeline",PROFILE:"profile"},action:{CANCELED:"canceled",CONFIRMED:"confirmed"}},sendSms:{TYPE:"swx_send_sms",status:{FAILED:"failed",NOT_ENOUGH_CREDIT:"notEnoughCredit",SUCCESSFUL:"successful"}},markAllConversationsAsRead:{TYPE:"swx_mark_all_conversations_read"},markConversationAsRead:{TYPE:"swx_conversation_mark_read"},browserToast:{EVENTS:{SHOWN:"kpi_toast_shown",CLICKED:"kpi_toast_clicked"},toastType:{INDIVIDUAL:"Individual",BIRTHDAY:"Birthday",SUMMARY:"Summary"},unreadState:{NONE:"none",PASSIVE:"PassiveOnly",ACTIVE:"ActiveOnly",BOTH:"Both"},displayType:{REMINDER:"reminder",NORMAL:"normal",SUMMARY:"summary"},ignore:{TIMEOUT:864e5,TIMEOUT_KEY:"IgnoreSessionToastMs"}},sendContacts:{TYPE:"message_contactInfo_send",cta:{MEDIABAR:"mediabar"},action:{CANCELED:"canceled",CONFIRMED:"confirmed"}},urlPreviewShown:{TYPE:"message_urlpreview_show"},urlPreviewClicked:{TYPE:"message_urlpreview_action"},contactInfo:{TYPE:"message_contactinfo_receive",action:{SHOW:"showed",CLICK:"clicked"}},menuItemClicked:{TYPE:"menu_item_clicked"},messageSent:{TYPE:"kpi_message_sent"},conversationOrigin:{GUEST_HOST:"guestHost",NORMAL:"normal"},mediaBarEvent:{TYPE:"media_bar_event"},timelineLoadEvent:{TYPE:"chat_timeline_load"},conversationHistoryLoadEvent:{TYPE:"chat_conversation_historyLoad"},splashScreenEvent:{TYPE:"experience_load_times"},splashScreenSignInEvent:{TYPE:"splash_screen_sign_in",STATE:{APP_READY:"appReady",SIGN_IN_FAILED:"signInFailed",REAUTH_NEEDED:"reauthNeeded",SIGNING_OUT:"signingOut",SIGNED_OUT:"signedOut"}},eduCarouselEvents:{telemetry:{START:"educational_carousel_start",FINISH:"educational_carousel_finish"},action:{HIDE:"educational_carousel_hide"}},notificationActionsEvent:{TYPE:"notificationActions",action:{accept:"accept",decline:"decline",open:"open"}},skypeTokenEvent:{TYPE:"skype_token_fetched"},swiftCard:{swiftCardActionEventName:"kpi_swift_cards_button_pressed",swiftCardInvalidEventName:"kpi_swift_cards_invalid_card",swiftCardUnsupportedEventName:"kpi_swift_cards_unsupported_card",invalidCardReasons:{MissingActionType:"Missing action type",MissinActionTitle:"Missing action title",MissinActionValue:"Missing action value",CardMissingContent:"Missing content in card",InvalidButton:"Content buttons are not valid",MainSectionNotValid:"Invalid main section in Content",SignInMissingButtons:"SignIn missing buttons",SignInMissingText:"SignIn missing text",ReceiptMissingTotal:"Receipt missing total",ReceiptInvalidButton:"Receipt invalid buttons",MediaCardMissingSrc:"Media card has no SD/HD source",SwiftMissingType:"Swift missing type",SwiftMissingCards:"Swift missing cards"},unsupportedCardReasons:{CardUnsupportedType:"Card has unsupported type",ContentUnsupportedButton:"Content contains unsupported button",ReceiptUnsupportedButton:"Receipt contains unsupported button",SwiftUnknownType:"Swift has unknown type"}},translator:{eventType:{OUTGOING:"translator_message_outgoing",INCOMING:"translator_message_incoming",SETTINGS_SHOW:"translator_settings_show",SETTINGS_HIDE:"translator_settings_hide",SETTINGS_BUTTON_ENABLED:"translator_settings_button_enabled",ME_LANGUAGE_CHANGED:"translator_me_language_changed",PARTICIPANT_LANGUAGE_CHANGED:"translator_participant_language_changed"},action:{CLICK_SEE_ORIGINAL:"click_see_original",CLICK_SEE_TRANSLATION:"click_see_translation",TRANSLATE:"translate",RETRANSLATE:"re-translate",SHOW:"show"},initiator:{ESCAPE_KEY:"escape_key",CLICK_GLOBE_BUTTON:"click_globe_button"}},performanceMarks:{EXPERIENCE:{INIT_START:"swx_timeline_initStart",INIT_END_OK:"swx_timeline_initEnd_ok",INIT_END_404:"swx_timeline_initEnd_404",INIT_END_ERROR:"swx_timeline_initEnd_err",TTL_START:"swx_experience_ttl_start",CONTENT_INIT:"swx_content_initStart"},TIMELINE:{RENDER_END:"swx_timeline_renderEnd",SYNC_START:"swx_timeline_syncStart",SYNC_END_OK:"swx_timeline_syncEnd_ok",SYNC_END_404:"swx_timeline_syncEnd_404",SYNC_END_ERROR:"swx_timeline_syncEnd_err"},CONVERSATION:{TTP:"swx_conversation_ttp"},NEW_CONVERSATION:{FLOW_START:"swx_newConversation_flowStart",CREATION_START:"swx_newConversation_creationStart",CREATION_END_OK:"swx_newConversation_creationEnd_ok",CREATION_END_404:"swx_newConversation_creationEnd_404",CREATION_END_ERROR:"swx_newConversation_creationEnd_err",RENDER_END:"swx_newConversation_renderEnd"},CONVERSATION_UPDATE:{UPDATE_START:"swx_conversationupdate_start",UPDATE_END:"swx_conversationupdate_end",SYNC_END:"swx_conversationupdate_syncEnd"},IM_SEND:{POST_START:"swx_imSend_postStart",POST_END_OK:"swx_imSend_postEnd_ok",POST_END_404:"swx_imSend_postEnd_404",POST_END_ERROR:"swx_imSend_postEnd_err"},CONTACTS:{LIST_LOAD:"swx_contact_list_load",REMOVE_CONTACT:"swx_contact_remove_contact",SEND_REQUEST:"swx_contact_send_request",ACCEPT_REQUEST:"swx_contact_accept_request",DECLINE_REQUEST:"swx_contact_decline_request",QUERY_INVITATION_LIST:"swx_contact_query_invitation_list",ADD_CONTACT:"swx_contact_add_contact",BLOCK_CONTACT:"swx_contact_block_contact",UNBLOCK_CONTACT:"swx_contact_unblock_contact",ADD_TO_FAVORITES:"swx_contact_add_contact_to_favorites",REMOVE_FROM_FAVORITES:"swx_contact_remove_contact_from_favorites",SESSION_SEARCH:"swx_contact_session_search",SEARCH_CONTACT:"swx_contact_search",PAGE:{OPENED:"swx_contacts_page_opened",INITIALIZED:"swx_contacts_page_initialized",RENDERED:"swx_contacts_page_rendered"}},DISCOVER_AGENTS:{LIST_LOAD:{START:"swx_discover_agents_list_load",END:"swx_discover_agents_list_end"},PAGE:{OPENED:"swx_discover_agents_page_opened",INITIALIZED:"swx_discover_agents_page_initialized",RENDERED:"swx_discover_agents_page_rendered"}},SEARCH:{LOCAL:{START:"swx_search_local_start",END:"swx_search_local_end",RESULTS_RENDERED:"swx_search_local_results_rendered"},GLOBAL:{START:"swx_search_global_start",END:"swx_search_global_end",RESULTS_RENDERED:"swx_search_global_results_rendered"}},SKYPEOUT:{PAGE:{OPENED:"swx_skypeout_page_opened"}},USER_SETTINGS:{PAGE:{OPENED:"swx_settings_page_opened"}}},measurements:{EXPERIENCE:{TTL:"swx_experience_ttl",TTL404:"swx_experience_ttl",SPLASH_TIME:"swx_experience_splash_screen_time"},TIMELINE:{TTL:"swx_timeline_ttl",TTL404:"swx_timeline_ttl",TTR:"swx_timeline_ttr"},NEW_CONVERSATION:{TTC:"swx_newConversation_ttc",TTS:"swx_newConversation_tts",TTR:"swx_newConversation_ttr"},CONVERSATION_UPDATE:{TTC:"swx_conversationupdate_ttc",TTS:"swx_conversationupdate_tts"},IM_SEND:{TTS:"swx_imsend_tts",TTS404:"swx_imsend_tts_404",TTR:"swx_imsend_ttr"},CONTACTS:{LIST_LOAD:{TTC:"swx_contacts_list_load_ttc"},PAGE:{TTC:"swx_contacts_page_ttc",TTR:"swx_contacts_page_ttr"}},DISCOVER_AGENTS:{LIST_LOAD:{TTC:"swx_discover_agents_list_load_ttc"},PAGE:{TTC:"swx_discover_agents_page_ttc",TTR:"swx_discover_agents_page_ttr"}},SEARCH:{LOCAL:{TTR:"swx_search_local_ttr"},GLOBAL:{TTR:"swx_search_global_ttr"}}},stages:{NEW_CONVERSATION:{STARTED:1,CREATED:2,REDIRECTED:3,ABANDONED:4},CONVERSATION_UPDATE:{COMPLETED:1,CANCELLED:2,ABANDONED:3}},conversationType:{UNKNOWN:-1,DIALOG:0,GROUP:1},persona:{NEWBEE:1,RETURNING:2,CLASSIC_IM:3,POWER_IM:4},historyLoadOrigin:{TIMELINE_INIT:1,NOTIFICATION_CONV:2,NOTIFICATION_AGGR:3,CONTACT_SEARCH:4,GROUP_SEARCH:5,DIRECTORY_SEARCH:6,NEW_CHAT_OPEN_EXISTING:7,PAGING:8,CALLING:9,AUTHOR_SWITCH:10,ROSTER:11,CONVERSATION_TO_THREAD:12,NEW_CHAT_CREATION:13,TIMELINE_CLICK:14,CONTACT_REQUEST_DECLINED:15,NEW_CHAT_DUMMY:16,NEW_CHAT_API_START_CONVERSATION:17,CONTACTS_PAGE:18,SKYPEOUT_PAGE:19,NEW_CONVERSATION_API:20,CONVERSATION_HEADER_BUTTON:21,CREATE_CONVERSATION_FOR_SCHEDULED_CALL:22,DISCOVER_AGENTS_PAGE:23,SKYPEOUT_PAGE_API:24,UNANSWERED_CALL_UI:25,MENTION_ME:99,SKYPE_URI:100},timelineLoadOrigin:{LOAD:1,RELOAD:2,RESSURECT:3},messageTypes:{MEDIA_VIDEO:1,MEDIA_PICTURE:2,MEDIA_LOCATION:4,CALLING_OTHER:8,FILES_MASK:4080,FILES_PICTURE:16,FILES_VIDEO:32,FILES_OFFICE:64,FILES_ARCHIVE:128,FILES_BINARY:256,FILES_PDF:512,FILES_OTHER:1024,FILES_AUDIO:2048,RICHTEXT_MASK:61440,RICHTEXT_FORMAT:4096,RICHTEXT_EMOTICONS:8192,RICHTEXT_ME:16384,RICHTEXT_OTHER:32768,CONTACT_OTHER:65536,TEXT_MASK:15728640,TEXT_ME:1048576,TEXT_OTHER:2097152,OTHER_TYPES:16777216},subCategories:{LOCAL_CONTACT_SEARCH:"LocalContactSearch",GLOBAL_CONTACT_SEARCH:"GlobalContactSearch",LOAD_CONTACTS:"LoadContacts"},poll:{eventName:{DESIGNER_OPENED:"poll_ui_designer_opened",STICKY_MESSAGE_CLICKED:"poll_ui_sticky_message_clicked",AVATAR_ELIPSIS_CLICKED:"poll_ui_avatar_elipsis_clicked",ERROR:"poll_error",ANSWER_LENGTH:"poll_ui_answer_length",ACTIVITY:"poll_activity"},activityType:{SEND:"send",VOTE:"vote",QUOTE:"quote",EDIT:"edit",REMOVE:"remove",CLOSE:"close"},errorType:{PARSING:"parsing",SEND:"send",OTHER:"other"},property:{CONVERSATION_ID:"conversation_id",MESSAGE_ID:"message_id",ACTIVITY_TYPE:"activity_type",ERROR_TYPE:"error_type",XMM_TYPE:"xmm_type",QUESTION_LENGTH:"question_length",ANSWER_LENGTH:"answer_length",ANSWERS_COUNT:"answers_count",MULTI_VOTE:"multi_vote",IS_NEW_VOTE:"is_new_vote",TOTAL_VOTES:"total_votes",TIME_SINCE_CREATION:"time_since_creation"}},userSettings:{eventName:{PREFERENCE_FETCHED:"user_settings_preference_fetched",PREFERENCE_CHANGED:"user_settings_preference_changed",PANEL_SHOWN:"user_settings_panel_shown",PAGE_DISMISSED:"user_settings_page_dismissed"},outcomeNames:{SUCCESS:"success",FAILURE:"failure"},property:{ITEM_NAME:"name",ITEM_VALUE:"value",OPERATION_OUTCOME:"outcome",OPERATION_DURATION:"duration"},UNKNOWN:"N/A"},inappActivity:{KPI_INAPP_ACTIVITY_START:"kpi_inapp_activity_start",KPI_INAPP_ACTIVITY_END:"kpi_inapp_activity_end"},pstn:{eventName:{PSTN_BUTTON_CLICKED:"kpi_pstn_button_clicked",PSTN_CALL_INITIATED:"kpi_pstn_call_initiated",ADD_CREDIT:"kpi_pstn_add_credit",ADD_SUBSCRIPTION:"kpi_pstn_add_subscription",CREDIT_BALANCE_UPDATE_CALL_END:"kpi_pstn_credit_balance_latency_call_end"},entryPoint:{CONTACT_LIST:"Contact List",SKYPE_OUT_PAGE:"Skype Out Page",CONVERSATION:"Conversation",RECENTS:"Recents",SEARCH:"Search Results",NO_CREDIT_CALL_START:"No Credit Call Start",NO_CREDIT_CALL_END:"No Credit Call End",NO_SUBSCRIPTION_CALL_START:"No Subscription Call Start",NO_SUBSCRIPTION_CALL_END:"No Subscription Call End"},cssClasses:{ADD_CREDIT:"js-addCredit",ADD_SUBSCRIPTION:"js-addSubscription"}},endpoints:{TYPE:"endpoints"},reopenSidebar:{REOPENED:"sidebar_reopened",CLOSE_TIMEOUT:"sidebar_close_timeout"},idleUsersAnalytics:{localKeys:{signInData:"swx|signInData",sidebarActivity:"swx|sidebarActivity"},TYPE:"idleUsersAnalytics"},usersAnalytics:{TYPE:"usersAnalytics"},themeEvent:{TYPE:"current_theme",theme:{DEFAULT:"default",DARK:"dark"}},teamsMigration:{EVENT_NAME:"teamsMigration",eventType:{ALERT_DISPLAYED:"alertDisplayed",ALERT_CLOSED:"alertClosed",ALERT_ACTION_INVOKED:"alertActionInvoked",MIGRATION_UI_SHOWN:"migrationUIShown",MIGRATION_UI_ACTION_INVOKED:"migrationUIActionInvoked"},eventAction:{CLOSE_ALERT:"close",CLICK_CTA:"cta"}},teamsAsDefaultClient:{EVENT_NAME:"teamsAsDefaultClient",eventType:{ALERT_DISPLAYED:"alertDisplayed",ALERT_CLOSED:"alertClosed",ALERT_ACTION_INVOKED:"alertActionInvoked"},eventAction:{CLOSE_ALERT:"close",CLICK_CTA:"cta"}}},globalizationFormatKeys:{time:{CALL_DURATION:"duration",SHORT:"short"},date:{DAY_MONTH:"dayMonth",DAY_MONTH_YEAR:"dayMonthYear",DAY_ABBREVIATION:"dayAbbr",DAY_NAME:"dayName",DATE_ABBREVIATION:"dateAbbr",SHORT_DATE_ABBREVIATION:"shortDateAbbr"}},api:{renderConversation:{errorMessages:{CONTAINER_UNDEFINED:"Container is undefined",CONTAINER_NOT_ELEMENT_NOT_SELECTOR:"Container is not a DOM element or CSS selector",PARTICIPANTS_WRONG_FORMAT:"Participants are expected to be an array",CONVERSATION_ID_WRONG_FORMAT:"Conversation ID is expected to be a string",PARTICIPANTS_AND_CONVERSATION_ID_UNDEFINED:"Participants or Conversation ID can't be undefined"}},conversation:{errorMessages:{NO_PARTICIPANTS:"Cannot start, at least one participant is required",SEARCH_FAILED:"Search for Person failed",URI_NOT_VALID:"Uri not a string",SUCCESS_CALLBACK_ERROR:"Unexpected error in success callback"}},modality:{errorMessages:{INVALID_MODALITIES:"Invalid modalities format provided",MODALITY_TYPE_NOT_SUPPORTED:"Modality type not supported",MODALITY_START_FAILED:"Modality cannot be started",ERROR_CALLBACK_ERROR:"Unexpected error in error callback"}},auth:{errorTypes:{TOO_MANY_CONNECTIONS_ERROR:"TooManyConnectionsError",NOT_LINKED:"AccountNotLinkedError",AGE_RESTRICTION_ERROR:"underage",OAUTH_FAILED_ERROR:"OAuthFailed",LOGIN_REQUIRED_ERROR:"login_required",SIGN_IN_CANCELED_ERROR:"Canceled",SIGNED_OUT_ERROR:"SignedOut",REAUTH_NEEDED:"ReauthenticationNeeded",TIMEOUT:"timeout"},errorMessages:{AUTH_DISABLED:"authentication disabled",ALREADY_SIGNED_IN:"user already signed in",ALREADY_SIGNED_OUT:"user already signed out",NOT_LINKED:"not-linked"},accountLinking:{WELCOME_FLOW:"welcome",RELINK_FLOW:"relink",INLINE_NEW_USER_FLOW:"inlineNewUser"},authProviderType:{SKYPE_TOKEN:"skypeToken",IMPLICIT_AUTH:"implicitOAuth",PASSWORD:"password",ANONYMOUS:"anonymous"},DEFAULT_SIGNIN_TIMEOUT:65e3}},silentLogin:{errorMessages:{NOT_LINKED:"not_linked",TIMED_OUT:"timed_out",INVALID_GRANT:"invalid_grant"}},conversation:{TOPIC_DELIMITER:", ",NUMBER_OF_PARTICIPANT_NAMES_IN_TOPIC:4},uiMode:{NARROW:"narrow"},cache:{VERSION:"1.9",PREFIX_KEYWORD:"swx",INTERNAL_KEYS:{VERSION:"version",ENCRYPTION_KEY:"encryptionKey",KEYS_MAP:"keysMap"},DEFAULT_BUFFER_TIMEOUT:300},experience:{RENDERER_CLASS:"swx"},disposableGroups:{PUB_SUB:"PUB_SUB",GENERIC_DISPOSABLE:"GENERIC_DISPOSABLE",INTERVAL:"INTERVAL",TIMEOUT:"TIMEOUT",DOM_EVENT:"DOM_EVENT"},urlValidator:{ALLOW_EMPTY:{}},i18n:{EMBEDDED_LOCALE:"en-us"},mentions:{class:"mention(?: me)?",meIdentifier:/class\s?=\s?["']mention me["']/},fileTransfer:{MAX_RESOLUTION:16e3,MAX_FILE_SIZE:314572800,SUPPORTED_PICTURE_TYPES:"image/x-png, image/png, image/jpeg",MAX_PHOTO_SIZE:20971520,FILE_DOWNLOAD_WARNING_FLAG_API_ID:19},messageDestination:{SKYPE_NETWORK:"destination:skype",SMS_NETWORK:"destination:sms"},annotationType:{EMOTIONS:"emotions"},emotionTypes:{HEART:"heart"},sidebar:{position:{LEFT:"left",RIGHT:"right"},cssClasses:{SLIDE_LEFT_TO_RIGHT:"slideLeftToRight",SLIDE_RIGHT_TO_LEFT:"slideRightToLeft"}},textarea:{MAX_LENGTH:2e3},urlPreviewType:{WWW:"urlp-www",YT:"utlp-yt",GIF:"urlp-gif"},userSettings:{categories:{IM_SETTINGS:"im_settings",IM_APPEARANCE:"im_appearance",PRIVACY:"privacy",UNLISTED:"unlisted",CONTACTS:"contacts",AUDIO_VIDEO:"audio_video",NOTIFICATIONS:"notifications",PERSONALIZATION:"personalization"},preferences:{URL_PREVIEWS:"urlPreviews",YOUTUBE_PLAYER:"youTubePlayer",MENTIONS:"mentions",FILE_PASTE:"filePaste",TYPING_INDICATOR:"typingIndicator",SKYPE_CALL_POLICY_SUPPORT:"skypeCallPolicySupport",SKYPE_VIDEO_CALLING_POLICY_SUPPORT:"skypeVideoCallingPolicySupport",READ_RECEIPT:"readReceipt",AUTO_BUDDY:"autoBuddy",AUTO_BUDDY_DISCOVERY:"autoBuddyDiscovery",DYNAMIC_DISCOVERY:"dynamicDiscovery",NOTIFICATIONS:"notifications",NOTIFICATIONS_SOUND:"notificationsSound",CHAT_NOTIFICATIONS_SOUND:"chatNotificationsSound",CALL_NOTIFICATIONS:"callNotifications",CALL_NOTIFICATIONS_SOUND:"callNotificationsSound",DEFER_RINGING_SOUND:"deferRingingSound",EMOTICON_SUGGESTIONS:"emoticonSuggestions",SHOW_EMOTICONS:"showEmoticons",SHOW_ANIMATED_EMOTICONS:"showAnimatedEmoticons",SHOW_LARGE_EMOTICONS:"showLargeEmoticons",DARK_THEME:"darkTheme",VIDEO_AUTOPLAY:"videoAutoPlayback"}},proofTypes:{EMAIL:"email",PHONE:"phone"},shortCircuit:{scenarios:{ADD_VERIFIED_PHONE:"settingspnv",MANAGE_ADDRESSBOOKS:"settingsaddressbooks"}},window:{BLANK_NAME:"_blank"},educationBubbles:{ORIENTATION:{TOP:"TOP",BOTTOM:"BOTTOM",LEFT:"LEFT",RIGHT:"RIGHT"},SIZE:{LARGE:"LARGE"}},classes:{WHITE_THEME:"themeWhiteCompliant",BLUE_THEME:"themeBlue",WHITE_COLOR:"white"},modalDialog:{ALLOW_BROWSER_NOTIFICATIONS_CONTAINER_ID:"overlayAllowBrowserNotifications"},rtlLanguages:["ar-sa","fa-ir","he-il","ku-arab-iq","ur-pk"],teamsMigration:{SHOW_NOTIFICATION:"showNotification",REDIRECT_CLIENT:"redirectClient",UPDATE_CLIENT:"updateClient",TEAMS_ALERT_ACTION_CLASS:".TeamsAlert-action",TEAMS_ALERT_HIDE_NOTIFICATION_CLASS:".TeamsAlert-hide",LOCAL_STORAGE_KEY:"teamsMigrationExpiration",EXPIRATION_MULTIPLIER_NEVER:31536e8,EXPIRATION_MULTIPLIER_24H:864e5},teamsAsDefaultClient:{NONE:0,CHAT:1,CALLING:2,CHAT_AND_CALLING:3}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-constants/lib/index",["require","exports","./calling","./pluginConst","./people","./outOfBrowser","./keys","./common"],e)}((function(e,t){var n=e("./calling")
	t.CALLING=n.default
	var i=e("./pluginConst")
	t.PLUGIN_CONST=i.default
	var r=e("./people")
	t.PEOPLE=r.default
	var o=e("./outOfBrowser")
	t.OUT_OF_BROWSER=o.default
	var a=e("./keys")
	t.KEYS=a.default
	var s=e("./common")
	t.COMMON=s.default})),define("swx-constants",["swx-constants/lib/index"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-cafe-application-instance/lib/instance",["require","exports"],e)}((function(e,t){var n
	t.set=function(e){n=e},t.get=function(){if(!n)throw new Error("Instance does not exist yet!")
	return n}})),define("swx-cafe-application-instance",["swx-cafe-application-instance/lib/instance"],(function(e){return e})),function e(t){var n=this&&this.__assign||Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])
	return e},i=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i
	if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i)
	else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(a=(o<3?r(a):o>3?r(t,n,a):r(t,n))||a)
	return o>3&&a&&Object.defineProperty(t,n,a),a},r=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function a(e){try{c(i.next(e))}catch(t){o(t)}}function s(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){e.done?r(e.value):new n((function(t){t(e.value)})).then(a,s)}c((i=i.apply(e,t)).next())}))},o=this&&this.__generator||function(e,t){var n,i,r,o={label:0,sent:function(){if(1&r[0])throw r[1]
	return r[1]},trys:[],ops:[]}
	return{next:a(0),throw:a(1),return:a(2)}
	function a(a){return function(s){return function(a){if(n)throw new TypeError("Generator is already executing.")
	for(;o;)try{if(n=1,i&&(r=i[2&a[0]?"return":a[0]?"throw":"next"])&&!(r=r.call(i,a[1])).done)return r
	switch(i=0,r&&(a=[0,r.value]),a[0]){case 0:case 1:r=a
	break
	case 4:return o.label++,{value:a[1],done:!1}
	case 5:o.label++,i=a[1],a=[0]
	continue
	case 7:a=o.ops.pop(),o.trys.pop()
	continue
	default:if(!(r=o.trys,(r=r.length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){o=0
	continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){o.label=a[1]
	break}if(6===a[0]&&o.label<r[1]){o.label=r[1],r=a
	break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(a)
	break}r[2]&&o.ops.pop(),o.trys.pop()
	continue}a=t.call(e,o)}catch(s){a=[6,s],i=0}finally{n=r=0}if(5&a[0])throw a[1]
	return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}},a=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){(function(e){(function(e){function t(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	console.log.apply(console,["[TTT]"].concat(e))}e.log=t,function(e){e.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	console.warn.apply(console,["[TTT]"].concat(e))}}(t=e.log||(e.log={}))})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))})(t||(t={})),function(e){e.$window=window}(t||(t={})),function(e){(function(t){(function(t){function n(t){return t+":"+e.$window.Math.random().toString(16).slice(2)}t.sId=n("id"),t.sModel=n("model"),t.sWrapper=n("wrapper"),t.assert=function(e){},t.extend=function(e,t){for(var n in t)e[n]=t[n]
	return e},t.stack=function(){var e=Error().stack
	return e&&e.toString().split("\n").join("\n")},Error.stackTraceLimit=1/0,t.clone=function(e){return e&&JSON.parse(_stringify(e))}})(t.TTT||(t.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.pack=function(t){var n=[void 0,null,"",!0,!1,[],{}].map((function(e){return _stringify(e)})),i=[],r=t.map((function(t){var r=t[0],o=t.slice(1)
	return i.push(e.RecordType[r]),o.map((function(e){if("number"==typeof e&&(0|e)==e&&e>=0)return e
	if(null===e)return-1
	if(void 0===e)return-2
	for(var t=_stringify(e),i=0;i<n.length;i++)if(n[i]==t)return-(i+1)
	return n.push(t),-n.length}))}))
	return[n,i,r]},e.unpack=function(t){for(var n=t[0],i=t[1],r=t[2],o=new Array(i.length),a=0;a<i.length;a++){var s=e.RecordType[i[a]],c=r[a].map((function(e){return e>=0?e:-1!=e?JSON.parse(n[-e-1]):void 0}))
	o[a]=[s].concat(c)}return o}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t;(function(e){e.Sync="sync",e.SetProp="set-prop",e.FireEvent="on-message",e.FireTimer="fire-timer",e.SetTimer="set-timer",e.ClearTimer="clear-timer",e.GetDate="date",e.CreateElemenet="create-element",e.AppendChild="append-child",e.RemoveChild="remove-child",e.PostMessage="post-message",e.AddEventListener="add-listener",e.Fetch=".get()",e.Set="set(...)",e.Then=".then()",e.Catch=".catch()",e.Finally=".finally()",e.Cancel=".cancel(...)",e.Subscribe=".subscribe()",e.Dispose=".dispose()",e.Invoke=".call(...)",e.AddItem=".add(...)",e.RemoveItem=".remove(...)",e.LoadFrame="on-load",e.CreateRoot="new Application(...)",e.XhrSend="xhr-send",e.XhrRecv="xhr-recv",e.XhrStop="xhr-stop",e.SSGetItem="ss-get-item",e.SSSetItem="ss-set-item"
	e.SSRemoveItem="ss-remove-item",e.LSGetItem="ls-get-item",e.LSSetItem="ls-set-item",e.LSRemoveItem="ls-remove-item"})(t=e.RecordType||(e.RecordType={}))
	var n=1
	for(var i in t)t[t[n]=t[i]]=n++})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(t){(function(n){n.version="1.0.0"
	var i=function(){this.version=n.version,this.sdk_ver="",this.debug=!1,this.packed=!1,this.randseed=0,this.timestamp=0,this.records=[]
	try{this.debug=!!JSON.parse(e.$window.localStorage.getItem("lwsdk.ttt.debug"))}catch(_){this.debug=!1}}
	n.TraceData=i
	var r=function(){function r(e){void 0===e&&(e=new i),this.data=e,this.index=0,this.turn=0,this.recording=!0,n.assert(e.version==n.version),this.recording=0==this.size,e.packed&&(e.records=n.unpack(e.records),e.packed=!1)}return Object.defineProperty(r.prototype,"size",{get:function(){return this.data.records.length},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"debug",{get:function(){return this.data.debug},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"current",{get:function(){var e=this.data.records[this.index]
	return this.debug?e&&e[1]:e},enumerable:!0,configurable:!0}),r.prototype.write=function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i]
	if(this.debug){var r=this.turn+"/"+this.size,o=n.stack().split("\n").slice(1).map((function(e){return e.replace(/^\s*(at )?/,"").replace(/\(https?:\/\/.+\/(.+\.js:\d+:\d+)\)/,"($1)")}))
	this.data.records.push([r,[e].concat(t),o])}else this.data.records.push([e].concat(t))
	return this.index++,this.current},r.prototype.read=function(e){var t=this.current
	return e&&t[0]!=e&&(n.log(e+" expected at "+this.index),n.assert(!1)),this.index++,t.slice(1)},r.prototype.toJSON=function(i){var r=n.clone(this.data)
	if(r.sdk_ver=t.version,this.debug||(r.records=n.pack(r.records),r.packed=!0),!i)return r
	n.log("Compressing logs asynchronously with "+i+"...")
	var o=e.$window,a=o.Date.now(),s=o.Math.random().toString(16).slice(2),c=o.document,l=c.createElement("iframe")
	l.id="tzip-"+s,l.src=i,l.style.display="none",c.body.appendChild(l),l.onload=function(){var e=r.records.map((function(e){return _stringify(e)})),t=e.reduce((function(e,t){return e+t.length}),0)/Math.pow(2,20)
	n.log("Sending "+t.toFixed(2)+" MB logs to the compressor...")
	var i={id:s,type:"compress",data:e}
	l.contentWindow.postMessage(i,"*")}
	var u=[]
	return o.addEventListener("message",(function e(t){var i=t.data
	if(i&&i.id==s){o.removeEventListener("message",e),c.body.removeChild(l)
	var d=i.data.length/Math.pow(2,20),p=(o.Date.now()-a)/1e3
	n.log("Received "+d.toFixed(2)+" MB compressed logs in "+p.toFixed(1)+"s"),r.records=i.data
	var f=[]
	for(var m in f.push("ttt_trace = {\n"),r)f.push(m),f.push(": "),"records"==m?(f.push("(function () {"),f.push(i.data),f.push("})()")):f.push(_stringify(r[m])),f.push(",\n")
	f.pop(),f.push("\n}")
	for(var h=f.join(""),v=0,g=u;v<g.length;v++){(0,g[v])(h)}}})),{then:function(e){u.push(e)}}},r}()
	n.Trace=r})(t.TTT||(t.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(e,t,n){Object.defineProperty(e,t,{value:n,enumerable:!1})}function i(t){return function(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i]
	return e.Utils[t].apply(this,n)}}var r=i("isProperty"),o=i("isCollection"),a=i("isFunction"),s=i("isArray"),c=i("Model"),l=i("ConstProperty"),u=i("isPromise"),d=i("isModel"),p=i("map"),f=i("foreach")
	t.Wrapper=function(e,i,m){var h=[],v={},g=1
	function y(e,t){e?i.setTimeout(t,0):t()}function b(i,s){function c(r,o,a){if(r(i)){var c=g++
	e.debug&&(c=""+a+c+"="+s,t.log("wrap",c))
	var l=o(i,c,s)
	return t.assert(l),n(l,t.sModel,i),n(i,t.sWrapper,l),n(l,t.sId,c),h[c]=l,l}}t.assert(!i||!i[t.sModel])
	var l=i&&i[t.sWrapper]
	return l&&l[t.sModel]!==i&&(l=null),l||c(r,C,"p")||c(o,T,"c")||c(a,I,"f")||c(u,A,"t")||c(d,x,"m")}function _(e){return e&&e[t.sId]}function E(e){return _(e)||t.clone(e)}function w(e){return h[e]||e}function S(e){return e&&e[t.sModel]||e}function x(n,i,r){var o=c()
	if(f(n,(function(e,t){var n=b(e,r+"."+t)
	n&&(o[t]=n)})),o.keywords&&o.getMore){var a=o.keywords,s="id"
	Object.defineProperty(a,s,{get:function(){return S(a)[s]},set:function(n){e.recording&&e.write(t.RecordType.SetProp,_(a),s,n),S(a)[s]=n}})}return n.changed&&n.changed((function(){f(o,(function(e,t){n[t]||delete o[t]})),f(n,(function(e,t){if(!o[t]){var n=b(e,r+"."+t)
	n&&(o[t]=n)}}))})),o}function C(n,i,o){var a,s=!0,c=!1,l=n.constructor({get:function(){return e.recording&&e.write(t.RecordType.Fetch,i),n.get().then((function(e){return b(e,o+".get()")||e}))},set:function(r,a){return e.recording&&e.write(t.RecordType.Set,i,r,a,c),n.set(r,a).then((function(e){return b(e,o+".set()")||e}))},subscribed:function(){e.recording&&e.write(t.RecordType.Subscribe,i),a=n.subscribe(),v[i]=a},unsubscribed:function(){e.recording&&e.write(t.RecordType.Dispose,i),a.dispose()}})
	f(n,(function(e,t){!r(e)||l[t]||/^_/.test(t)||(l[t]=b(e,o+"."+t))})),n.changed((function(t,n){y(!s&&e.recording,(function(){l._set(t,n)}))})),s=!1
	var u=l.get
	l.get=function(){return b(u.call(l),o+".get()")}
	var d=l.set
	return l.set=function(e,t){c=!0
	var n=d.call(l,e,t)
	return c=!1,b(n,o+".set()")},l.set.enabled=d.enabled,l}function T(n,i,r){var o,a=!0,s=n.constructor({get:function(){return e.recording&&e.write(t.RecordType.Fetch,i),n.get().then((function(e){return e.map((function(e){return b(e,r+".get()")||e}))}))},subscribed:function(){e.recording&&e.write(t.RecordType.Subscribe,i),o=n.subscribe(),v[i]=o},unsubscribed:function(){e.recording&&e.write(t.RecordType.Dispose,i),o.dispose()}})
	n.added((function(t,n,i){var o=b(t,r+"["+i+"]")||t
	y(!a&&e.recording,(function(){s.add(o,n,i)}))})),n.removed((function(t,n){y(e.recording,(function(){s.remove(n)}))})),a=!1
	var c=s.asWritable({add:function(r){return e.recording&&e.write(t.RecordType.AddItem,i,_(r)||r),n.add(S(r))},remove:function(r){return e.recording&&e.write(t.RecordType.RemoveItem,i,_(r)||r),n.remove(S(r))}}),l=c.get
	return c.get=function(e){return b(l.call(c,e),r+".get()")},c}function I(n,i,r){return t.extend((function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a]
	var c=p(o,E)
	t.nopii&&/\.chatService\.(sendMessage|shouldNotify)$/.test(r)&&"string"==typeof c[0]&&(c[0]="#<message-text>")
	var l=e.recording&&e.write(t.RecordType.Invoke,i,c),d=n.apply(null,o.map(S))
	u(d)&&(d=d.then((function(e){return s(e)?e.map((function(e,t){return b(e,r+"()["+t+"]")||e})):b(e,r+"()")||e})))
	var f=b(d,r+"()")||d
	return l&&l.push(_(f)),f}),{enabled:b(n.enabled||l(!0),r+".enabled"),bind:null})}function A(n,i,r){return{then:function(o,a,s){var c=e.recording&&e.write(t.RecordType.Then,i)
	return b(n.then((function(t){try{return e.debug&&c&&c.push(e.size),o(t)}finally{e.debug&&c&&c.push(e.size)}}),a,s),r+".then()")},catch:function(o){return e.recording&&e.write(t.RecordType.Catch,i),b(n.catch(o),r+".catch()")},finally:function(o){return e.recording&&e.write(t.RecordType.Finally,i),b(n.finally(o),r+".finally()")},cancel:function(r){e.recording&&e.write(t.RecordType.Cancel,i,t.clone(r)),n.cancel(r)}}}return m.push((function(e,n,i){if(e==t.RecordType.AddItem){var r=h[n]
	return t.assert(r),r.add(h[i]||i),!0}})),m.push((function(e,n,i){if(e==t.RecordType.RemoveItem){var r=h[n]
	return t.assert(r),r.remove(h[i]||i),!0}})),m.push((function(e,n,i,r){if(e==t.RecordType.Invoke){var o=h[n]
	t.assert(o)
	var a=o.apply(null,i.map(w))
	return t.assert(!r||r==_(a)),!0}})),m.push((function(e,n){if(e==t.RecordType.Then){var i=h[n]
	return t.assert(i),i.then(),!0}})),m.push((function(e,n){if(e==t.RecordType.Catch){var i=h[n]
	return t.assert(i),i.catch(),!0}})),m.push((function(e,n){if(e==t.RecordType.Finally){var i=h[n]
	return t.assert(i),i.finally(),!0}})),m.push((function(e,n,i){if(e==t.RecordType.Cancel){var r=h[n]
	return t.assert(r),r.cancel(i),!0}})),m.push((function(e,n){if(e==t.RecordType.Fetch){var i=h[n]
	return t.assert(i),i.get(),!0}})),m.push((function(e,n,i,r,o){if(e==t.RecordType.Set){var a=h[n]
	return t.assert(a),o?a.set(i,r):a(i,r),!0}})),m.push((function(e,n){if(e==t.RecordType.Subscribe){var i=h[n]
	return t.assert(i),i.subscribe(),!0}})),m.push((function(e,n){if(e==t.RecordType.Dispose){var i=h[n]
	return t.assert(i),v[n].dispose(),!0}})),m.push((function(e,n,i,r){if(e==t.RecordType.SetProp){var o=h[n]
	return t.assert(o),o[i]=r,!0}})),{wrap:b}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createWindowProxy=function(t,i,r){return n({Date:e.createDateProxy(t,i),Math:e.createMathProxy(t,i)},e.createTimerProxy(t,i,r),e.createMessageProxy(t,i,r),{document:e.createDocumentProxy(t,i,r),sessionStorage:e.createStorageProxy(t,i,i.sessionStorage,e.RecordType.SSGetItem,e.RecordType.SSSetItem,e.RecordType.SSRemoveItem),localStorage:e.createStorageProxy(t,i,i.localStorage,e.RecordType.LSGetItem,e.RecordType.LSSetItem,e.RecordType.RemoveItem),XMLHttpRequest:e.createXhrProxy(t,i,r),WeakMap:i.WeakMap,navigator:i.navigator,location:i.location})}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createStorageProxy=function(t,n,i,r,o,a){return{setItem:function(n,r){if(t.recording)i.setItem(n,r),t.write(o,n)
	else{var a=t.read(o)[0]
	e.assert(a==n)}},getItem:function(n){if(t.recording){var o=i.getItem(n)
	return t.write(r,n,o),o}var a=t.read(r),s=a[0]
	o=a[1]
	return e.assert(s==n),o},removeItem:function(n){if(t.recording)i.removeItem(n),t.write(a,n)
	else{var r=t.read(a)[0]
	e.assert(r==n)}}}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createDateProxy=function(t,n){var i=n.Date
	t.recording&&(t.data.timestamp=i.now())
	var r=t.data.timestamp
	return e.extend((function n(o){if(e.assert(this instanceof n),e.assert(arguments.length<2),e.assert(/number|undefined|string/.test(typeof o)),o)return new i(o)
	if(t.recording){var a=new i
	return t.write(e.RecordType.GetDate,+a-r),r=+a,a}var s=t.read(e.RecordType.GetDate)[0]
	return new i(r+=s)}),{now:function(){return+new this}})}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createMathProxy=function(e,t){var n=t.Math
	e.recording&&(e.data.randseed=1073741824*n.random()|0)
	var i,r,o,a=(i=e.data.randseed,r=1664525,o=1013904223,{next:function(){return i=r*i+o|0},random:function(){var e=this.next()/2147483648
	return e<0?-e:e}})
	return{log:function(e){return n.log(e)},pow:function(e,t){return n.pow(e,t)},max:function(e,t){return n.max(e,t)},min:function(e,t){return n.min(e,t)},floor:function(e){return n.floor(e)},round:function(e){return n.round(e)},random:function(){return a.random()}}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createXhrProxy=function(t,n,i){var r=n.XMLHttpRequest,o={},a=1,s=function(){function n(){this.headers={},this.id=a++,t.recording&&(this.xhr=new r),o[this.id]=this}return n.prototype.open=function(e,n,i){if(void 0===i&&(i=!0),t.recording){if(this.type=e,this.url=n,!i)throw Error("XHR requests must be async")
	this.xhr.open(e,n,i)}},n.prototype.abort=function(){if(t.recording)t.write(e.RecordType.XhrStop,this.id),this.xhr.abort()
	else{var n=t.read(e.RecordType.XhrStop)[0]
	e.assert(n==this.id)}},n.prototype.setRequestHeader=function(e,n){t.recording&&(this.headers[e]=n,this.xhr.setRequestHeader(e,n))},n.prototype.getAllResponseHeaders=function(){return this.responseHeaders},n.prototype.send=function(n){var i=this
	if(t.recording){var r=this.xhr
	r.onreadystatechange=function(){4==r.readyState&&(i.readyState=r.readyState,i.status=r.status,i.statusText=r.statusText,i.responseHeaders=r.getAllResponseHeaders(),i.responseText=r.responseText,t.turn++,t.write(e.RecordType.XhrRecv,i.id,{status:i.status,statusText:i.statusText,headers:i.responseHeaders.split("\r\n"),data:i.responseText}),i.xhr=null,i.onreadystatechange())},t.write(e.RecordType.XhrSend,this.id,{type:this.type,url:this.url,headers:this.headers,data:n}),this.xhr.send(n)}else{var o=t.read(e.RecordType.XhrSend)[0]
	e.assert(o==this.id)}},n.prototype.recv=function(e){var t=e.status,n=e.statusText,i=e.headers,r=e.data
	this.readyState=4,this.status=t,this.statusText=n,this.responseHeaders=i.join("\r\n"),this.responseText=r,this.onreadystatechange()},n}()
	return i.push((function(t,n,i){if(t==e.RecordType.XhrRecv)return o[n].recv(i),!0})),s}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createDocumentProxy=function(t,n,i){var r=n.document,o=n.setTimeout,a={},s=1
	return i.push((function(t,n){if(t==e.RecordType.LoadFrame)return a[n].onload(),!0})),{createElement:function(n){if(e.assert("iframe"==n),t.recording)return(i=r.createElement(n))[e.sId]=s++,t.write(e.RecordType.CreateElemenet,i[e.sId]),i
	var i,o=t.read(e.RecordType.CreateElemenet)[0]
	return(i={style:{},contentWindow:{postMessage:function(){}}})[e.sId]=o,e.assert(!a[o]),a[o]=i,i},body:{appendChild:function(n){if(t.recording){e.assert(n[e.sId]),t.write(e.RecordType.AppendChild,n[e.sId])
	var i=n.onload
	n.onload=function(){o((function(){t.turn++,t.write(e.RecordType.LoadFrame,n[e.sId]),i.call(n)}),0)},r.body.appendChild(n)}else{var a=t.read(e.RecordType.AppendChild)[0]
	e.assert(a==n[e.sId])}},removeChild:function(n){if(t.recording)t.write(e.RecordType.RemoveChild,n[e.sId]),r.body.removeChild(n)
	else{var i=t.read(e.RecordType.RemoveChild)[0]
	e.assert(i==n[e.sId])}}},cookie:""}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.createTimerProxy=function(t,n,i){var r=n.setTimeout,o=n.setInterval,a=n.clearTimeout,s=n.clearInterval,c=[]
	return i.push((function(t,n){if(t==e.RecordType.FireTimer)return c[n].call(),!0})),{setTimeout:function(n,i){if(t.recording){var o=r((function(){t.turn++,t.write(e.RecordType.FireTimer,o),n()}),i)
	return t.write(e.RecordType.SetTimer,o,i,0),o}var a=t.read(e.RecordType.SetTimer),s=a[0],l=a[1],u=a[2]
	return e.assert(l==i),e.assert(!u),e.assert(!c[s]),c[s]=n,s},clearTimeout:function(n){if(n)if(t.recording)t.write(e.RecordType.ClearTimer,n),a(n)
	else{var i=t.read(e.RecordType.ClearTimer)[0]
	e.assert(i==n),c[n]?c[n]=null:e.log.warn("Timer "+n+" has been cleared again.")}},setInterval:function(n,i){if(t.recording){var r=o((function(){t.turn++,t.write(e.RecordType.FireTimer,r),n()}),i)
	return t.write(e.RecordType.SetTimer,r,i,1),r}var a=t.read(e.RecordType.SetTimer),s=a[0],l=a[1],u=a[2]
	return e.assert(l==i),e.assert(u),e.assert(!c[s]),c[s]=n,s},clearInterval:function(n){if(n)if(t.recording)t.write(e.RecordType.ClearTimer,n),s(n)
	else{var i=t.read(e.RecordType.ClearTimer)[0]
	e.assert(i==n),c[n]?c[n]=null:e.log.warn("Timer "+n+" has been cleared again.")}}}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(t){return"#<text:"+t.length+":"+e.Utils.hash(t)+">"}t.createMessageProxy=function(e,i,r){var o={},a=1
	return r.push((function(e,n,i){if(e==t.RecordType.FireEvent)return o[n].call(null,{data:i}),!0})),{addEventListener:function(r,s){if(t.assert("message"==r),e.recording){var c=a++
	e.write(t.RecordType.AddEventListener,c),i.addEventListener("message",(function(i){try{e.turn++
	var r=i.data
	t.nopii&&"string"==typeof r&&(r=(r=(r=r.replace(/(\\"(?:html|plain)Message\\":{\\"href\\":\\"data:text\/(?:html|plain);charset=utf-8,)(.*?)(\\"}})/gm,(function(e,t,i,r){return t+n(i)+r}))).replace(/(\\"previewMessage\\":\\")(.*?)(\\")/gm,(function(e,t,i,r){return t+n(i)+r}))).replace(/\b(cwt=)([\w-]+)\b/gm,(function(e,t,i){return t+n(i)})),e.write(t.RecordType.FireEvent,c,r)),s(i)}catch(o){}}))}else{var l=e.read(t.RecordType.AddEventListener)[0]
	t.assert(l==a),t.assert(!o[a]),o[a]=s,a++}},attachEvent:function(e,t){this.addEventListener("on"+e,t)},postMessage:function(n,r){t.assert("*"==r),e.recording?(i.postMessage(n,r),e.write(t.RecordType.PostMessage,n)):e.read(t.RecordType.PostMessage)}}}})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(t){(function(n){(function(i){i.Recorder=function(r,o){var a=!o,s=new Array,c=new i.Trace(o),l=i.Wrapper(c,r,s)
	function u(){return t.$window.Math.random().toString(16).slice(2,8)}function d(n){var i={}
	i[n+".src"]=new Blob(["var Skype; !"+e+"(Skype = window.Skype || {});"],{type:"application/javascript"})
	var r=c.toJSON()
	return i[n+".json"]=new Blob(["ttt_trace = ",_stringify(r,null,"\t")],{type:"application/json"}),i[n+".html"]=new Blob(["<!doctype html>","<html>","<head>","<title>"+(new t.$window.Date).toJSON().slice(0,-8)+"</title>",'<script type="text/javascript" src="'+n+'.json"><\/script>','<script type="text/javascript" src= "'+n+'.src"><\/script>',"</head>",'<body><button onclick="this.disabled = true; Skype.ttt.play();">Replay</button></body>',"</html>"],{type:"text/html"}),i}function p(e,t){var n=document.createElement("a")
	n.href=URL.createObjectURL(t),n.download=e,n.click()}return o&&i.log("Invoke ttt.play() to replay the recorded trace."),{window:i.createWindowProxy(c,r,s),save:function(){var e=t.$window.Date.now(),n=d(u()),r=t.$window.Date.now()-e
	for(var o in i.log("Files generated in "+r+" ms"),n)p(o,n[o])},send:function(e,t){void 0===e&&(e=u()),function(e,t){var n=new r.FormData,i=new r.XMLHttpRequest
	for(var o in t)n.append(o,t[o],o)
	i.open("POST",e||"/ttt"),i.send(n)}(t,d(e))},sync:function(e){if(c.debug)if(c.recording)c.write(i.RecordType.Sync,e)
	else{var t=c.read(i.RecordType.Sync)[0]
	i.assert(t==e)}},play:function(){e:for(;c.current;){var e=c.index
	this.tick=c.index
	var t=c.current,n=t[0],r=t.slice(1)
	if(c.index++,n==i.RecordType.CreateRoot)this.root(r[0])
	else{try{for(var o=0,a=s;o<a.length;o++){if(a[o].apply(void 0,[n].concat(r)))continue e}}catch(l){throw i.log.apply(void 0,[e,n].concat(r)),l}i.log("Record #"+e+" "+n+" is not an action."),i.assert(!1)}}},toJSON:function(e){return c.toJSON(e)},ctor:null,root:function(e){a&&(i.log("Recording. Invoke ttt.save() to get the recorded trace."),c.write(i.RecordType.CreateRoot,i.clone(e))),n.Utils.defer.mode="setTimeout",n.Utils.defer.duration=0
	var t=new this.ctor(e||void 0)
	return l.wrap(t,"app")}}}})(n.TTT||(n.TTT={}))})(t.Web||(t.Web={}))}(t||(t={})),function(e){function t(e){try{return e()}catch(_){}}var n=t((function(){return/\bttt$/.test(location.hash)}))||t((function(){return/\bttt$/.test(location.search)}))||t((function(){return JSON.parse(sessionStorage.getItem("lwsdk.ttt"))}))||t((function(){return JSON.parse(localStorage.getItem("lwsdk.ttt"))})),i=window.navigator&&window.navigator.userAgent
	e.ttt="undefined"!=typeof ttt_trace?e.Web.TTT.Recorder(window,ttt_trace):i&&n&&e.Web.TTT.Recorder(window),e.ttt&&e.$window.setTimeout((function(){e.$window.ttt=e.ttt}),1e3)}(t||(t={})),function(e){(function(t){t.window=e.ttt?e.ttt.window:e.$window
	try{Object.defineProperty(t,"sessionStorage",{get:function(){return t.window.sessionStorage}}),Object.defineProperty(t,"localStorage",{get:function(){return t.window.localStorage}}),Object.defineProperty(t,"XMLHttpRequest",{get:function(){return t.window.XMLHttpRequest}}),Object.defineProperty(t,"Date",{get:function(){return t.window.Date}}),Object.defineProperty(t,"Math",{get:function(){return t.window.Math}}),Object.defineProperty(t,"setTimeout",{get:function(){return t.window.setTimeout.bind(null)}}),Object.defineProperty(t,"setInterval",{get:function(){return t.window.setInterval.bind(null)}}),Object.defineProperty(t,"clearTimeout",{get:function(){return t.window.clearTimeout.bind(null)}}),Object.defineProperty(t,"clearInterval",{get:function(){return t.window.clearInterval.bind(null)}})}catch(_){}})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.nopii=!0})(e.TTT||(e.TTT={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){e.isUnitTested=!!e.isUnitTested})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.dbgBreak=!1})(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(t,n){return void 0===t&&(t=a()),void 0===n&&(n=!e.isUnitTested),n?t+"_"+a():"_s_"+t}function i(e,t,n){var i={}
	for(var r in e=e||{},t=t||{})r in e&&"append"==n||(i[r]={value:t[r],writable:!0,enumerable:!0,configurable:!0})
	return Object.create(e,i)}function r(e,t,n,i){void 0===i&&(i=!1)
	try{Object.defineProperty(e,t,{value:n,configurable:!0,enumerable:!1,writable:!i})}catch(r){e[t]=n}}function o(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	var i,r,o,a=t[t.length-1]
	for(e=e||{},a=g(a)?a:"",r=0;r<t.length;r++)if((i=t[r]||{})!==a)for(o in i)"append"==a&&o in e||(e[o]=i[o])
	return e}function a(){return e.Math.random().toString(16).slice(2)}function s(n,i){return i=o({code:n},i),o(Error(this!==e.window&&this!==t&&this&&""!=this?this:n),i)}function c(e,t){var n=e+" != "+t
	return s.call(n,"DoesNotEqual",{lhs:e,rhs:t})}function l(e,t){var n="Invalid state: "+e+" (expected "+t+")"
	return s.call(n,"InvalidState",{actual:e,expected:t})}function u(e,t){var n="the `"+e+"` property is missing"
	return s.call(n,"KeyMissing",{key:e,object:t})}function d(t,n,i){if(!t)throw!e.isUnitTested&&e.Settings.dbgBreak,s(n||"AssertionFailed",i)}function p(e,t,n){if(!e)throw s(t||"RuntimeCheckFailed",n)}function f(e,t){var n
	if(e.indexOf)return e.indexOf(t)
	for(n=0;n<e.length;n++)if(e[n]==t)return n
	return-1}function m(e){return e&&"[object Object]"==Object.prototype.toString.call(e)}function h(e){return m(e)}function v(e){return"[object Array]"==Object.prototype.toString.call(e)}function g(e){return"[object String]"==Object.prototype.toString.call(e)}function y(e){return"[object Number]"==Object.prototype.toString.call(e)}function b(e){return"[object Function]"==Object.prototype.toString.call(e)}function _(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function E(e){return g(e)&&e.length>0}function w(e){return null==e}function S(e){return y(e)&&(0|e)==e}function x(e){return e&&e.code&&e instanceof Error}function C(e,t){var n,i=t.split("|")
	for(n=0;n<i.length;n++)if(i[n]in C.types&&C.types[i[n]](e))return!0
	return!1}function T(e,t){e.splice(t,1)}function I(e,t,n){e.splice(t,0,n)}function A(e,t){var n,i
	if(v(e))for(n=0;n<e.length;++n)t(e[n],n)
	else for(i in e)d(void 0===t(e[i],i))}t.replacePrototype=!0,t.noop=function(){},t.sIsAsync=n("async"),t.isAsyncFunction=function(e){return e&&e[t.sIsAsync]},t.async=function e(n,o,a){if(b(n)){var s=n[t.sIsAsync]?n:function(){try{return t.Task.wait(n.apply(this,arguments),o)}catch(e){return(new t.Task).reject(e).promise}}
	return r(s,t.sIsAsync,!0),s}if("object"==typeof n&&"object"==typeof a){var c=i(a)
	return c.value=e(a.value,this),c}d(!1)},t.hidden=function(e,t,n){n.enumerable=!1},t.nothrow=function(e,t,n){var r=n.value
	return(n=i(n)).value=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	try{return r.apply(this,e)}catch(n){}},n},t.Symbol=n,t.inherit=i,t.setHiddenProperty=r,t.extend=o,t.random=a,t.setPrototypeOrExtend=function(e,n){t.replacePrototype?e.__proto__?e.__proto__=n:Object.setPrototypeOf?Object.setPrototypeOf(e,n):o(e,n):o(e,n)},t.Exception=s,t.EWrongType=function(e,t){var n=e+" is not a "+t
	return s.call(n,"WrongType",{value:e})},t.EWrongArgType=function(e,t,n){var i="`"+e+"` = "+t+" is not a "+n
	return s.call(i,"WrongArgType",{arg:e,value:t})},t.EDoesNotEqual=c,t.EInvalidArgument=function(e,t){var n="`"+e+"` is invalid: "+t
	return s.call(n,"InvalidArgument",{arg:e,reason:t})},t.EInvalidState=l,t.EKeyMissing=u,t.EAlreadyExists=function(e){return s("AlreadyExists",{item:e})},t.EDoesNotExist=function(e){return s("DoesNotExist",{item:e})},t.ENotSupported=function(e){return s("NotSupported",{reason:e})},t.ENotFound=function(e){return s("NotFoundError",{reason:e})},t.ECanceled=function(e){return s("Canceled",{reason:e})},t.assert=d,t.check=p,function(e){e.equals=function(e,t){if(e!=t)throw c(e,t)},e.state=function(e,t){if(v(t)){if(-1==f(t,e))throw l(e,t)}else if(e!=t)throw l(e,t)},e.belongs=function(e,t){if(!(e in t))throw u(e,t)}}(p=t.check||(t.check={})),t.indexOf=f,t.isPromise=function(e){return e instanceof t.Promise}
	t.isCollection=function(e){return e&&e.constructor===t.Collection},t.isModel=function(e){return e instanceof t.Model},t.isProperty=function(e){return e&&e.constructor===t.Property},t.isCommand=function(e){return e&&e.constructor===t.Command},t.isObject=m,t.isDictionary=h,t.isArray=v,t.isArrayOf=function(e,t){if(!v(e))return!1
	for(var n=0;n<e.length;n++)if(!t(e[n]))return!1
	return!0},t.isString=g,t.isNumber=y,t.isFunction=b,t.isBoolean=_,t.isNotEmptyString=E,t.isVoid=w,t.isPrimitive=function(e){return w(e)||_(e)||y(e)||g(e)},t.isInteger=S,t.isArrayIndex=function(e,t){return S(e)&&v(t)&&e>=0&&e<t.length},t.isInRange=function(e,t,n){return y(n)&&n>=e&&n<=t},t.isAjaxRequest=function(e){return m(e)&&E(e.type)&&E(e.url)},t.isAjaxResponse=function(e){return h(e)&&"status"in e},t.isEmptyObject=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1
	return!0},t.isException=x,t.is=C,t.isThenable=function(e){return e&&b(e.then)},function(e){e.types={String:g,NotEmptyString:E,Function:b,Dictionary:h,Object:m,Array:v,Boolean:_,Void:w,Number:y,Exception:x}}(C=t.is||(t.is={})),t.bind=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	var i=this
	return e.bind?e.bind.apply(e,[i].concat(t)):function(){return e.apply(i,t.concat([].slice.call(arguments,0)))}},t.removeAt=T,t.insertAt=I,t.foreach=A,t.map=function(e,t,n){var i,r
	if(v(e))for(i=[],r=0;r<e.length;r++)i.push(t.call(n,e[r],r,e))
	else if(h(e))for(r in i={},e)i[r]=t.call(n,e[r],r,e)
	return i}
	t.values=function(e){d(h(e))
	var t=[]
	return A(e,(function(e){t.push(e)})),t},t.contains=function(e,t){var n
	if(d(v(e)||h(e)),d(b(t)),v(e)){for(n=0;n<e.length;++n)if(t(e[n],n))return!0}else for(n in e)if(t(e[n],n))return!0
	return!1},t.deepEqual=function(t,n){var i,r=typeof t
	if(t===n)return!0
	if(r!==typeof n||"object"!==r&&"function"!==r)return!1
	if(null===t||null===n)return t===n
	if(t instanceof e.Date&&n instanceof e.Date)return+t==+n
	for(i in t)if(!(i in n)||t[i]!==n[i])return!1
	for(i in n)if(!(i in t)||t[i]!==n[i])return!1
	return!0},t.removeItem=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return T(e,n),n},t.insertItem=function(e,t,n){for(var i=0,r=e.length;i<r&&!n(t,e[i]);)i++
	return I(e,i,t),i}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=[],i='{"websdk":"'+t.random()+'"}'
	function r(){var t=n.slice(0)
	n.length=0
	for(var o=a.duration&&e.Date.now();t.length>0;){var s=t.shift(),c=s[0],l=s[1],u=s[2]
	try{c.apply(l,u)}catch(d){}if(a.duration&&e.Date.now()>o+a.duration)break}t.length>0&&(n.unshift.apply(n,t),"setTimeout"==a.mode&&e.setTimeout(r,0),"postMessage"==a.mode&&e.window.postMessage(i,"*"))}function o(e){e.data==i&&(a.mode="postMessage",r())}function a(t){for(var s=this,c=[],l=1;l<arguments.length;l++)c[l-1]=arguments[l]
	if(e.isUnitTested)t.apply(this,c)
	else if(a.duration||"setTimeout"!=a.mode){if(n.push([t,this,c]),!(n.length>1))if("setTimeout"!=a.mode)if("postMessage"!=a.mode){if(!a.mode)try{a.mode="postMessage-probing",e.window.postMessage(i,"*"),e.window.addEventListener?e.window.addEventListener("message",o):e.window.attachEvent("onmessage",o),e.setTimeout((function(){a.mode||(a.mode="setTimeout",r())}),0)}catch(u){a.mode="setTimeout",e.setTimeout(r,0)}}else e.window.postMessage(i,"*")
	else e.setTimeout(r,0)}else e.setTimeout((function(){return t.apply(s,c)}),0)}t.defer=a,function(e){e.duration=16}(a=t.defer||(t.defer={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=e.isException,n=e.ECanceled,i=e.Symbol("task"),r=e.Symbol("error"),o=e.Symbol("result")
	function a(t){if(e.isPromise(t))return t
	var n=!0!==t&&!1!==t&&null!=t&&"number"!=typeof t&&"string"!=typeof t&&t.then
	return"function"==typeof n?new c(e.bind.call(t,n)):void 0}var s=function(){function t(n,r){var o=this
	if(!(this instanceof t))return new t(n,r)
	e.isString(n)||(r=n,n=void 0)
	var a=r||{}
	this._={leafs:[],state:"pending",status:e.Property({value:n}),promise:e.inherit(c.prototype)}
	var s=this._
	a.mode&&(s.mode=a.mode),a.cancel&&(s.fnCancel=a.cancel),e.setHiddenProperty(s.promise,i,this),this.state=function(){return s.state},this.status=s.status,this.promise=s.promise,this.status.changed((function(){return o.notify()}))}return t.prototype.resolve=function(e){var t=this,n=t._
	return"pending"!=n.state?t:(n.value=e,n.state="resolved",t._complete())},t.prototype.reject=function(e){var t=this,n=t._
	return"pending"!=n.state?t:(n.value=e,n.state="rejected",t._complete())},t.prototype.from=function(e){var n=this,r=n._
	if(r.promise[t.sLocked])return r.target.from(e)
	r.source=e
	var o=r.source.then((function(e){return n.resolve(e),e}),(function(e){throw n.reject(e),e}),r.status)
	return r.fnCancel=function(e){return r.source.cancel(e)},r.source[t.sLocked]&&(r.source[i]._.target=n),o},t.prototype._complete=function(){var e=this._
	e.status(null)
	for(var t=0,n=e.leafs;t<n.length;t++){var i=n[t]
	this.exec(i)}return e.fnCancel=null,this},t.prototype.exec=function(t,n){var i=this._
	"sync"==i.mode||"sync"==n?this.exec2(t,i.state,i.value):e.defer.call(this,this.exec,t,"sync")},t.prototype.exec2=function(t,n,i){var r=this
	if("resolved"==n)try{var o=a(i)
	if(o)return void o.then((function(e){return r.exec2(t,"resolved",e)}),(function(e){return r.exec2(t,"rejected",e)}))}catch(p){n="rejected",i=p}var s,c=t.done,l=t.fail,u=t.task
	try{if("resolved"==n)s=e.isFunction(c)?c(i):i
	else{if(!e.isFunction(l))throw i
	s=l(i)}}catch(f){return void u.reject(f)}if(s===u.promise)u.reject(new TypeError)
	else try{var d=a(s)
	d?u.from(d):u.resolve(s)}catch(p){u.reject(p)}},t.prototype.notify=function(){var t=this._
	if("pending"==t.state){var n=this.status(),i=this.status.reason
	if(void 0!==n||void 0!==i)for(var r=0,o=t.leafs;r<o.length;r++){var a=o[r],s=a.task,c=a.info
	s.status(n,i),e.isFunction(c)&&c(n,i)}}},t.prototype.detach=function(n,i){var r=this._,o=n.task,a=n.fail
	if(r.leafs.length<2)r.promise.cancel(i)
	else{e.removeAt(r.leafs,e.indexOf(r.leafs,n))
	try{e.isFunction(a)?o.from(t.wait(a(i))):o.reject(i)}catch(s){o.reject(s)}}},t}()
	s.sLocked=e.Symbol("locked"),e.Task=s
	var c=function(){function a(e){if(!(this instanceof a))return new a(e)
	var t=new s
	try{e((function(e){return t.resolve(e)}),(function(e){return t.reject(e)}),t.status)}catch(n){try{t.reject(n)}catch(_){}}return t.promise}return a.prototype.cancel=function(e){var r=this[i],o=r._
	if("pending"==o.state){var a=t(e)&&"Canceled"==e.code?e:n(e)
	o.fnCancel?o.fnCancel(a):r.reject(a)}},a.prototype.then=function(e,t,n){var r=this[i],o=new s({cancel:function(e){return r.detach(a,e)}}),a={task:o,done:e,fail:t,info:n}
	return"pending"==r.state()?(r._.leafs.push(a),r.notify()):r.exec(a),o.promise},a.prototype.catch=function(t){return this.then(null,t||e.noop)},a.prototype.finally=function(e){return this.then((function(t){return a.resolve(e()).then((function(){return t}))}),(function(t){return a.resolve(e()).then((function(){throw t}))}))},Object.defineProperty(a.prototype,o,{get:function(){var e=this[i]._
	if("resolved"==e.state)return e.value},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,r,{get:function(){var e=this[i]._
	if("rejected"==e.state)return e.value},enumerable:!0,configurable:!0}),a}()
	e.Promise=c,function(t){function n(e,n){try{return a(e)||new t({mode:n}).resolve(e).promise}catch(i){return c.reject(i)}}t.waitAny=function(n){var i=n.length,r=new t({cancel:s}),o=r.promise,a=[]
	function s(e){for(var t=0,i=n;t<i.length;t++){var r=i[t]
	try{r.cancel(e)}catch(o){}}}return 1==i?o=t.wait(n[0]):0==i?r.reject(Error()):e.foreach(n,(function(t,n){t.then((function(t){i--,r&&(r.resolve(t),r=null,s(e.Exception("CompetingTaskResolved")))}),(function(e){--i||(r.reject(e),r=null)}),(function(e){r&&(a[n]=e||"#"+n,r.status(a.join(" || ")))}))})),o},t.waitAll=function(i){var r=i.length,o=new t({cancel:p}),a=o.promise
	if(0==r)o.resolve([])
	else if(1==r)a=t.wait(i[0]).then((function(e){return[e]}))
	else{var s=!0,c=i.map(n),l=i.map((function(e){return null})),u=[],d=function(){return!s&&o&&o.status(u.filter((function(e,t){return!!c[t]})).join(" && "))}
	i=i.map(n),e.foreach(i,(function(e,t){e.then((function(e){l[t]=e,c[t]=null,d(),--r||(o.resolve(l),o=null)}),(function(e){c[t]=null,r--,o&&(o.reject(e),o=null,p(e))}),(function(e){u[t]=e||"#"+t,d()}))})),s=!1,d()}function p(e){for(var t=0,n=i;t<n.length;t++){var r=n[t]
	try{r.cancel(e)}catch(o){}}}return a},t.wait=n,t.run=function(e){try{return t.wait(e(),"sync")}catch(n){return(new t).reject(n).promise}}}(s=e.Task||(e.Task={})),function(e){e.all=s.waitAll,e.race=s.waitAny,e.reject=function(e){return(new s).reject(e).promise},e.resolve=s.wait}(c=e.Promise||(e.Promise={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){"object"==typeof exports&&(exports.deferred=e.Task,exports.resolved=e.Promise.resolve,exports.rejected=e.Promise.reject)})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(n,i){var r=function(){var t=r.enabled
	if(t())return n.apply(this,arguments)
	var i=e.Exception("CommandDisabled",{reason:t.reason})
	if(e.isAsyncFunction(n))return(new e.Task).reject(i).promise
	throw i}
	return n&&n[e.sIsAsync]&&e.setHiddenProperty(r,e.sIsAsync,!0),e.extend(r,{constructor:t,enabled:i&&i.asReadOnly(),bind:function(e){return t((function(){return r.apply(e,arguments)}),r.enabled)},toString:function(){return"[Command: enabled = "+r.enabled()+"]"}})}function n(n,i){return t(e.async(n),i)}function i(n){return e.extend(n,{constructor:t,toString:function(){return"[Command: enabled = true]"},enabled:e.ConstProperty(!0)})}function r(t){return i(e.async(t||function(){return null}))}function o(n){return void 0!==n?t(e.noop,e.ConstProperty(!1,n)):(o.instance||(o.instance=t(e.noop,e.ConstProperty(!1))),o.instance)}function a(n){return void 0!==n?t(e.async(e.noop),e.ConstProperty(!1,n)):(a.instance||(a.instance=t(e.async(e.noop),e.ConstProperty(!1))),a.instance)}e.Command=t,e.AsyncCommand=n,e.EnabledCommand=i,e.EnabledAsyncCommand=r,function(e){e.async=r}(i=e.EnabledCommand||(e.EnabledCommand={})),e.DisabledCommand=o,o=e.DisabledCommand||(e.DisabledCommand={}),e.DisabledAsyncCommand=a,a=e.DisabledAsyncCommand||(e.DisabledAsyncCommand={}),function(e){e.async=n,e.enabled=i,e.disabled=o}(t=e.Command||(e.Command={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=function(){function n(e){if(void 0===e&&(e={}),!(this instanceof n))return new n(e)
	t.extend(this,e),this._listeners=[],this._modes=[],this._locked=!1,this.observer=n.Observer(this)}return n.prototype.fire=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	var n=this
	n._enqueue(n,n._fire,arguments)||(n._fire.apply(n,arguments),n._dequeue())},n.prototype._invoke=function(i,r,o){if("async"!=o||e.isUnitTested)try{i.apply(null,r)}catch(a){n.uncaught._event.fire(a),a!=n._ie&&console&&console.log&&(console.log(a&&a.stack||a),console.log(Error().stack))}else t.defer.call(this,this._invoke,i,r,"sync")},n.prototype.observed=function(){return this._listeners.length>0},n.prototype._fire=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	var n,i=this
	for(n=0;n<i._listeners.length;n++)i._invoke(i._listeners[n],arguments,i._modes[n])},n.prototype._enqueue=function(e,t,n){var i=this
	return i._locked?(i._queue=i._queue||[],i._queue.push([e,t,n])):i._locked=!0,i._queue&&i._queue.length>0},n.prototype._dequeue=function(){var e,t=this
	if(t._queue){for(;e=t._queue.shift();)e[1].apply(e[0],e[2])
	t._queue=null}t._locked=!1},n}()
	t.Event=n,function(e){var n=function(){function e(e,t){this.event=e,this.listener=t}return e.prototype.dispose=function(){this.event.off(this.listener)},e}()
	e.Subscription=n
	var i=function(){function n(n){var i=function(n,r){return i.on(n,r),t.isFunction(r)&&r(this),new e.Subscription(i,n)}
	return t.setPrototypeOrExtend(i,e.Observer.prototype),i._event=n,i}return n.prototype.toString=function(){var e=this._event._listeners.length
	return"[Event"+(e?": "+e+" listener"+(1==e?"":"s"):"")+"]"},n.prototype.on=function(e,t){var n=this._event
	n._enqueue(this,this._addListener,[e,t])||(this._addListener(e,t),n._dequeue())},n.prototype._addListener=function(e,n){var i=this._event
	t.assert(t.isFunction(e)),i.adding&&i.adding.call(i.context,e),i._listeners.push(e),i._modes.push(n),i.added&&i.added.call(i.context,e),1==i._listeners.length&&i.subscribed&&i.subscribed.call(i.context)},n.prototype.off=function(e){var t=this._event
	t._enqueue(this,this._removeListener,[e])||(this._removeListener(e),t._dequeue())},n.prototype._removeListener=function(e){var n=this._event,i=t.indexOf(n._listeners,e)
	i>=0&&(n._listeners.splice(i,1),n._modes.splice(i,1),0==n._listeners.length&&n.unsubscribed&&n.unsubscribed.call(n.context))},n}()
	function r(e){return i(e)}e.Observer=r,r.prototype=i.prototype,e.uncaught=(new e).observer}(n=t.Event||(t.Event={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=function(e){this.dispose=e}
	t.Subscription=n
	var i=function(){function i(e){this._callbacks=e,this._subscriptions=[],this._period=1/0,this._timer=null}return i.prototype.subscribe=function(e){var i=this
	void 0===e&&(e=0)
	var r=new n((function(){if(!r)throw t.Exception("AlreadyDisposed")
	t.removeItem(i._subscriptions,(function(e){return e.sub===r})),r=null,i._update()}))
	return t.insertItem(this._subscriptions,{sub:r,dt:e},(function(e,t){return e.dt<t.dt})),this._update(),r},i.prototype._update=function(){var t=this._subscriptions.length>0?this._subscriptions[0].dt:1/0,n=this._callbacks
	t!=this._period&&(this._timer&&e.clearInterval(this._timer),this._timer=null,0==t&&n.subscribed&&n.subscribed(),0==this._period&&n.unsubscribed&&n.unsubscribed(),this._period=t,this._period>0&&this._period<1/0&&n.updated&&(this._timer=e.setInterval(n.updated,1e3*this._period|0)))},i}()
	t.RefCountedSubscription=i})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=function(){function e(e){void 0===e&&(e="wm"),this._sTag=t.Symbol(e,!0)}return e.prototype.get=function(e){return e[this._sTag]},e.prototype.set=function(e,n){t.setHiddenProperty(e,this._sTag,n)},e.prototype.has=function(e){return this._sTag in e},e.prototype.delete=function(e){delete e[this._sTag]},e}()
	t.WeakMap=n,t.WeakMap=!e.isUnitTested&&e.window.WeakMap||n})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(e){return a(e)}var r
	t.Property=n
	var o=new t.WeakMap,a=function(){function i(e){var i=function(e,t){return 0==arguments.length?(r&&r.push(i),i._value):(i._write(e,t),this)},o=e&&e.get,a=e&&e.set,s=e&&e.readOnly
	return e&&void 0!==e.value&&(i._value=e.value),e&&void 0!==e.reason&&(i.reason=e.reason),e&&e.check&&(i._check=e.check),o&&(i._getter=t.async(o)),s&&(i._ro=i),a&&(i._setter=t.async(a,"sync")),e&&e.subscribed&&(i._subscribed=e.subscribed),e&&e.unsubscribed&&(i._unsubscribed=e.unsubscribed),t.setPrototypeOrExtend(i,n.prototype),t.extend(i,{get:t.isCommand(o)?t.Command(i._getAsync,o.enabled):t.EnabledCommand(i._getAsync),set:s?t.DisabledAsyncCommand():t.isCommand(a)?t.Command(i._setAsync,a.enabled):t.EnabledCommand(i._setAsync)}),Object.defineProperty(i,"changed",{get:i._getChanged}),i}return i.prototype.toString=function(){return"[Property: value = "+this._value+"]"},i.prototype.or=function(e){return u([this,e],(function(e,t){return e||t}))},i.prototype.and=function(e){return u([this,e],(function(e,t){return e&&t}))},i.prototype.map=function(e,i){var r,o=this,a=n({get:t.Command((function(){return o.get().then(e)}),o.get.enabled),subscribed:function(){return r=o.subscribe()},unsubscribed:function(){return r.dispose()}})
	return o.changed((function(t,n){a(e(t),n)})),a.fork(t.Command((function(t){return o.set(i(t)).then(e)}),i?o.set.enabled:s(!1)))},i.prototype.when=function(e,n){var i=this.changed,r={dispose:function(){return i.off(a)}},o=t.isFunction(e)?e:function(t){return t===e}
	function a(e,t,i){o(e)&&n.call(r,t,i)}return i(a),r},i.prototype.once=function(e,t){return this.when(e,(function(){this.dispose(),t.apply(null,arguments)}))},i.prototype.equals=function(e){return this.map((function(t){return t==e}))},i.prototype.equalsAny=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]
	return this.map((function(n){return t.contains(e,(function(e){return e==n}))}))},i.prototype.fork=function(e){var i,r=this,o=t.isProperty(e)?e:e.enabled||s(!0),a=o===s(!1),c=n({value:r._value,reason:r.reason,readOnly:a,set:a?null:t.isProperty(e)?t.Command((function(e,t){return r.set(e,t)}),o):t.Command((function(n,i){return t.async(e)(n,i).then((function(e){return r.set(e,i)}))}),o),get:r.get.bind(r),subscribed:function(){return i=r.subscribe()},unsubscribed:function(){return i.dispose()}})
	return(r._forks=r._forks||[]).push(c),c},i.prototype.asReadOnly=function(){var e=this
	return e._ro||(e._ro=e.fork(t.DisabledAsyncCommand())),e._ro},i.prototype.observed=function(){var e=this._changed
	return e&&e.observed()},i.prototype.subscribe=function(e){var n=this,i=new t.RefCountedSubscription({unsubscribed:n._unsubscribed,subscribed:n._subscribed,updated:function(){return n.get()}})
	return n.subscribe=function(e){return i.subscribe(e)},n.subscribe(e)},i.prototype._set=function(e,t){var n,i=this,r=i._value,o=i._forks,a=i._changed
	if(!i._same(e,t)&&(i._value=e,i.reason=t,a&&a.fire(e,t,r),o))for(n=0;n<o.length;n++)o[n]._set(e,t)
	return e},i.prototype._same=function(e,n){return t.deepEqual(e,this._value)&&t.deepEqual(n,this.reason)},i.prototype._getChanged=function(){var e=this
	return e._changed||(e._changed=new t.Event({context:e,added:e._listenerAdded})),e._changed.observer},i.prototype._listenerAdded=function(e){var t=this,n=t._changed,i=t._value,r=t.reason
	void 0!==i&&n._invoke(e,[i,r])},i.prototype._getAsync=function(){var e=this,t=e._getter,n=e._value
	return t?(e._dfdget||(e._dfdget=t.call(e,n,e.reason)),e._dfdget.then((function(t){return e._dfdget=null,e._set(t,e.reason),e._value}),(function(t){throw e._dfdget=null,t}))):n},i.prototype._setAsync=function(e,n){var i=this,r=i._check,o=i._setter
	return t.assert(arguments.length>0),this._scheck(e),i._same(e,n)?e:(r&&r(e),o?this._sinvoke(e,n):i._set(e,n))},i.prototype._write=function(e,t){var i=this,r=i._check,o=i._setter
	if(this._scheck(e),!i._same(e,t)){if(r&&r(e),!i.set.enabled())throw Error("This is a read-only property.")
	return o&&t!==n.sUpdated?this._sinvoke(e,t):i._set(e,t)}},i.prototype._scheck=function(e){if(o.get(this))try{console.warn("Property::set("+e+") is not re-entrant: simultaneous calls interfere with each other.")}catch(_){}},i.prototype._sinvoke=function(t,i){var r=this,a=this._setter(t,i).then((function(e){return r._set(e,i)}))
	if(!e.isUnitTested&&n.srcheck){var s=o.get(this)||0
	o.set(this,s+1),a.finally((function(){var e=o.get(r)
	1==e?o.delete(r):o.set(r,e-1)}))}return a},i}()
	function s(e,t){if(void 0===t){if(null===e)return n.null
	if(!0===e)return n.true
	if(!1===e)return n.false}return n({value:e,reason:t,readOnly:!0})}function c(e,t){var i=n({value:e,reason:t})
	return i.inc=function(){return i(i()+1)},i.dec=function(){return i(i()-1)},i}function l(e,t){var i=n({value:e,reason:t})
	return i.not=function(){return i.map((function(e){return!e}))},i}function u(e,i){var r,o=n({get:function(){var n=t.map(e,(function(e){return e.get()}))
	return t.Task.waitAll(n).then((function(e){return i.apply(null,e)}))},subscribed:function(){r=t.map(e,(function(e){return e.subscribe()}))},unsubscribed:function(){t.foreach(r,(function(e){return e.dispose()}))}})
	return n.observe(e,(function(){o(i.apply(null,arguments))})),o.asReadOnly()}i([t.async],a.prototype,"_getAsync",null),i([t.async.bind("sync")],a.prototype,"_setAsync",null),n.prototype=t.extend((function(){}),a.prototype,{constructor:n}),function(e){e.srcheck=!1}(n=t.Property||(t.Property={})),t.ConstProperty=s,function(e){e.sUpdated={}
	var n=e({value:!0,readOnly:!0}),i=e({value:!1,readOnly:!0})
	e.true=n,e.false=i,n.get.enabled=n,n.set.enabled=i,i.get.enabled=n,i.set.enabled=i,t.DisabledAsyncCommand.instance.enabled=i
	var r=e({value:null,readOnly:!0})
	e.null=r}(n=t.Property||(t.Property={})),function(e){e.observe=function(e,n){if(0==e.length)return function(e){var n=[]
	function i(){t.assert(!r),r=[],e()
	var o=r
	r=null
	for(var a=0,s=n;a<s.length;a++){var c=s[a]
	o.indexOf(c)<0&&c.changed.off(i)}for(var l=0,u=o;l<u.length;l++){c=u[l]
	n.indexOf(c)<0&&c.changed.on(i)}n=o}i()}(n),new t.Subscription(t.noop)
	var i=e.map((function(t){return t.changed((function(){var t=e.map((function(e){return e()}))
	n.apply(null,t)}))}))
	return new t.Subscription((function(){for(var e=0,t=i;e<t.length;e++){t[e].dispose()}}))}}(n=t.Property||(t.Property={})),t.NumProperty=c,t.BoolProperty=l,t.ComputedProperty=u,function(e){e.computed=u,e.bool=l,e.just=function(t){return e({value:t})},e.readonly=s,e.numeric=c}(n=t.Property||(t.Property={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={}));(function(e){(function(t){(function(n){function i(e){return r(e)}n.Collection=i
	var r=function(){function r(e){var t=function(e){return 0==arguments.length?t._asArray():n.isArray(e)?(t.empty(),t._addArray(e),this):t._getFromCache(e)}
	t._=n.extend({},e)
	var r=t._
	return e&&e.get&&(r.get=n.async(e.get)),r.vals=[],r.keys=[],r.idxs={},n.setPrototypeOrExtend(t,i.prototype),t._init(),t}return r.prototype.subscribe=function(e){var t=this,i=t._,r=new n.RefCountedSubscription({unsubscribed:i.unsubscribed,subscribed:i.subscribed,updated:function(){return t.get()}})
	return t.subscribe=function(e){return r.subscribe(e)},t.subscribe(e)},r.prototype.observed=function(){var e=this._,t=e.added,n=e.removed,i=e.changed
	return t&&t.observed()||n&&n.observed()||i&&i.observed()},r.prototype.add=function(e,t,i){var r=this._,o=r.vals.length
	if((t=t||(r.key?r.key(e):n.random()))in r.idxs)throw n.EAlreadyExists(t)
	return(i=n.isInteger(i)?i:o)<0&&(i=0),i>o&&(i=o),this._insert(e,t,i),r.size&&r.size.inc(),r.added&&r.added.fire(e,t,i),r.changed&&r.changed.fire(),t},r.prototype.remove=function(e){var t,i,r,o=this._
	if(n.isInteger(e)?(t=e,e=o.keys[t]):t=o.idxs[e],i=o.vals[t],t>=0&&t<o.vals.length){for(r=t+1;r<o.keys.length;r++)o.idxs[o.keys[r]]--
	n.removeAt(o.vals,t),n.removeAt(o.keys,t),delete o.idxs[e],o.size&&o.size.dec(),o.removed&&o.removed.fire(i,e,t),o.changed&&o.changed.fire()}},r.prototype.removeAll=function(e){for(var t=this._,n=t.vals.length,i=[],r=0;r<n;r++){var o=t.vals[r],a=t.keys[r]
	e(o)&&i.push(a)}for(var s=0,c=i;s<c.length;s++){var l=c[s]
	this.remove(l)}return i.length},r.prototype.get=function(e){var t,i=this,r=i._,o=r.get
	return o&&!r.dfdget&&(r.dfdget=o()),r.dfdget&&(t=r.dfdget.then((function(e){return r.dfdget=null,i._setNewItems(e)}),(function(e){throw r.dfdget=null,e}))),n.Task.wait(t).then((function(){return n.isVoid(e)?i._asArray():i._getFromCache(e)}))},r.prototype.index=function(e){return this._.idxs[e]},r.prototype.key=function(e){return this._.keys[e]},r.prototype.empty=function(){var e,t=this._
	if(t.removed)for(e=0;e<t.vals.length;e++)t.removed.fire(t.vals[e],t.keys[e])
	t.vals=[],t.keys=[],t.idxs={},t.size&&t.size(0),t.changed&&t.changed.fire()},r.prototype.asReadOnly=function(){var e=this,t=function(t){return 0==arguments.length?e._asArray():e._getFromCache(t)}
	return n.setPrototypeOrExtend(t,e),t._init(),t.add=null,t.remove=null,t.empty=null,t},r.prototype.fork=function(e){var t=this,i=function(e){return 0==arguments.length?t():t(e)}
	function r(e){return n.isCommand(e)?n.Command(n.async(e),e.enabled):n.isFunction(e)?n.EnabledCommand(n.async(e)):n.DisabledAsyncCommand(n.ENotSupported())}return n.setPrototypeOrExtend(i,t),n.extend(i,{add:r(e.add),remove:r(e.remove)}),i._init(),i},r.prototype.asWritable=function(e){return this.fork(e)},r.prototype.toString=function(){return"[Collection: "+this.size()+" items]"},r.prototype.each=function(e){for(var t=this._,n=0;n<t.vals.length;n++)e(t.vals[n],t.keys[n])
	return this},r.prototype.contains=function(e){var t=!1
	return this.each((function(n){e(n)&&(t=!0)})),t},r.prototype.observe=function(n){var i,r=this,o={},a={},s=e.$window||t.window,c=s.setTimeout,l=s.clearTimeout
	function u(e,t){o[t]=e,delete a[t],p()}function d(e,t){a[t]=e,delete o[t],p()}function p(){i||(i=c((function(){var e=o,t=a
	o={},a={},i=null,n(e,t)}),0))}return r.added(u),r.removed(d),{dispose:function(){i&&(l(i),i=null),r.added.off(u),r.removed.off(d)}}},r.prototype.map=function(e){var t,n=this,r=i({get:function(e){return n.get().then((function(){return r(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return n.added((function(t,n,i){r.add(e(t),n,i)})),n.removed((function(e,t){r.remove(t)})),r.asReadOnly()},r.prototype.filter=function(e){var t,n=this,r=i({get:function(e){return n.get().then((function(){return r(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return n.added((function(t,i,o){if(e(t)){for(var a=o+1,s=n.size();a<s&&!e(n(a));)a++
	var c=a<s?r.index(n.key(a)):r.size()
	r.add(t,i,c)}})),n.removed((function(e,t){r.remove(t)})),r.asReadOnly()},r.prototype.sort=function(e){var t,n=this,r=i({get:function(e){return n.get().then((function(){return r(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	function o(t,n){return e(t,n)||!e(n,t)}return n.added((function(e,t,i){for(var a=r.size(),s=0;s<a&&!o(e,r(s));)s++
	for(;s<a&&o(r(s),e)&&n.index(r.key(s))<i;)s++
	r.add(e,t,s)})),n.removed((function(e,t){r.remove(t)})),r.asReadOnly()},r.prototype.reduce=function(e,t){var i=this,r=n.Property(),o=this._.vals
	return n.Property.observe([],(function(){i.size()
	var n=o.reduce(e,t)
	r(n)})),r.asReadOnly()},r.prototype._init=function(){var e=this
	Object.defineProperties(e,{added:{enumerable:!0,get:e._initAddedEvent},removed:{enumerable:!0,get:e._initRemovedEvent},changed:{enumerable:!0,get:e._initChangedEvent},size:{enumerable:!0,get:e._initSizeProperty}})},r.prototype._getFromCache=function(e){var t=this._
	return n.isString(e)?t.vals[t.idxs[e]]:t.vals[e]},r.prototype._setNewItems=function(e){var t,i=this,r=i._
	if(n.isDictionary(e)){for(t in r.idxs)t in e&&r.vals[r.idxs[t]]===e[t]||i.remove(t)
	for(t in e)t in r.idxs||i.add(e[t],t)}},r.prototype._initAddedEvent=function(){var e=this,t=e._,i="added"
	return t[i]=t[i]||new n.Event({context:e,adding:e._addedListenerAdding}),t[i].observer},r.prototype._addedListenerAdding=function(e){var t=this._,i=t.added
	n.foreach(t.vals,(function(n,r){i._invoke(e,[n,t.keys[r],r])}))},r.prototype._initRemovedEvent=function(){var e=this._,t="removed"
	return e[t]=e[t]||new n.Event,e[t].observer},r.prototype._initChangedEvent=function(){var e=this,t=e._,i="changed"
	return t[i]=t[i]||new n.Event({context:e,added:e._changedListenerAdded}),t[i].observer},r.prototype._changedListenerAdded=function(e){this._.changed._invoke(e,[])},r.prototype._initSizeProperty=function(){var e=this._,t="size"
	return e[t]=e[t]||n.NumProperty(e.vals.length),e[t].asReadOnly()},r.prototype._insert=function(e,t,i){var r,o=this._,a=o.vals.length
	for(r=i;r<a;r++)o.idxs[o.keys[r]]++
	n.insertAt(o.vals,i,e),n.insertAt(o.keys,i,t),o.idxs[t]=i},r.prototype._addArray=function(e){for(var t=0;t<e.length;t++)this.add(e[t])},r.prototype._asArray=function(){return this._.vals.slice(0)},r}()
	i.prototype=n.extend((function(){}),r.prototype,{constructor:i}),function(e){e.empty=e().asReadOnly()}(i=n.Collection||(n.Collection={})),n.ConstCollection=function(e){var t=i()
	return t(e),t.asReadOnly()}})(t.Utils||(t.Utils={}))})(e.Web||(e.Web={}))})(t||(t={})),function(e){(function(e){(function(e){e.SourcedProperty=function(t){var n,i,r,o=!1,a=e.Property({value:!1}),s=[],c=e.Property({get:function(){return n&&n.get()},set:e.Command((function(t,i){if(n){var r=0==s.length?e.Promise.resolve(null,"sync"):s[s.length-1].promise
	return s.push(new e.Task),r.then((function(){return function(e,t){return n.set(e,t).then((function(){return c()}))}(t,i)})).finally((function(){s.shift().resolve()}))}}),a),subscribed:function(){o=!0,i=n&&n.subscribe()},unsubscribed:function(){o=!1,i&&(i.dispose(),i=null)}})
	return c.setSource=function(t){e.assert(e.isProperty(t)||!t),n!==t&&(a(!!(n=t)),r&&(r.dispose(),r=null),n&&(r=n.changed((function(e,t){c._set(e,t)})),void 0===n()&&c._set(n())),i&&(i.dispose(),i=null),o&&n&&(i=n.subscribe()),n||c._set(void 0))},c.setSource(t),c}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.SourcedCommand=function(){var t,n=e.SourcedProperty()
	n.setSource(e.ConstProperty(!1))
	var i=e.Command((function(){return t.apply(null,arguments)}),n)
	return i.setSource=function(i){e.assert(e.isCommand(i)||!i),t=i,n.setSource(t?t.enabled:e.ConstProperty(!1))},i}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.SourcedModel=function t(n){var i=e.Model(e.map(n,(function(n){return e.isProperty(n)?e.SourcedProperty():e.isModel(n)?t(n):e.isCommand(n)?e.SourcedCommand():e.assert(!1)})))
	return e.setHiddenProperty(i,"setSource",(function(e){for(var t in i)i[t].setSource(e&&e[t])})),i}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(e){return t.inherit(n.prototype,e)}function r(n,i){return t.isModel(n)?n.toJSON(i):t.isCollection(n)?t.map(n(),(function(e){return r(e,i)})):t.isProperty(n)?r(n(),i):t.isCommand(n)?{enabled:!!n.enabled()}:t.isFunction(n)?{enabled:!0}:n instanceof e.Date?n.toJSON():n}t.Model=n
	var o=function(){function e(){}return e.prototype.toJSON=function(e){return t.map(this,(function(t,n){if("constructor"!=n){var i=e&&e[n]
	if(!e||i)return r(t,!0===i?null:i)}}))},e.prototype.toString=function(e){return void 0===e&&(e=4),_stringify(this.toJSON(),null,e).replace(/{\s*\n\s*("\w+"):\s*(\w+)\s*\n\s*}/gm,"{ $1: $2 }")},e}()
	i([t.hidden],o.prototype,"toJSON",null),i([t.hidden],o.prototype,"toString",null),t.BaseModel=o,n.prototype=o.prototype})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=function(){function e(e){this._exec=e}return e.prototype.exec=function(e,t){void 0===t&&(t=0)
	var n=this._exec(e,t)
	return 2==arguments.length?n:n&&n[1]==e.length?n[0]:null},e.prototype.then=function(t){var n=this
	return new e((function(e,i){var r=n.exec(e,i)
	if(!r)return null
	var o=r[0],a=r[1]
	return[t(o,e,i,a),a]}))},e.prototype.text=function(){return this.then((function(e,t,n,i){return t.slice(n,i)}))},e.prototype.select=function(e){return this.then((function(t){return t[e]}))},e.prototype.merge=function(e){return void 0===e&&(e=""),this.then((function(t){return t.join(e)}))},e.prototype.join=function(e,t){return this.then((function(n){for(var i={},r=0,o=n;r<o.length;r++){var a=o[r]
	i[a[e]]=a[t]}return i}))},e}()
	function n(e){return new t((function(t,n){var i=e.exec(t.slice(n))
	if(i&&0==i.index)return[i[0],n+i[0].length]}))}function i(e,n){return new t((function(t,i){return e.exec(t,i)||[n,i]}))}function r(e,n){return new t((function(t,i){return!n.exec(t,i)&&e.exec(t,i)}))}function o(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]
	return new t((function(t,n){for(var i=[],r=0,o=e;r<o.length;r++){var a=o[r].exec(t,n)
	if(!a)return
	i.push(a[0]),n=a[1]}return[i,n]}))}function a(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]
	return new t((function(t,n){for(var i=0,r=e;i<r.length;i++){var o=r[i].exec(t,n)
	if(o)return o}}))}function s(e){return new t((function(t,n){for(var i,r=[];i=e.exec(t,n);)r.push(i[0]),n=i[1]
	return[r,n]}))}e.Pattern=t,e.txt=function(e){return new t((function(t,n){if(t.slice(n,n+e.length)==e)return[e,n+e.length]}))},e.rgx=n,e.opt=i,e.exc=r,e.seq=o,e.any=a,e.rep=s,e.sep=function(e,t){var n=o(t,e).select(1)
	return i(o(e,s(n)).then((function(e){return[e[0]].concat(e[1])})),[])},e.quoted=function(e,t){return o(e,s(a(n(/\\./).then((function(e){return e.slice(1)})),r(n(/./),t))),t).select(1).merge()}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=function(){function e(t){var n,i=this
	if(!(this instanceof e))return new e(t)
	if(!(n=e.pattern.exec((t||"")+"")))throw new SyntaxError("Invalid URI: "+t)
	function r(e){var t=function(t){return 0==arguments.length?(n[e]||"")+"":(n[e]=(t||"")+"",this)}
	return t.toString=function(){return t()},t}this.scheme=r("scheme"),this.user=r("user"),this.host=r("host"),this.port=r("port"),this.path=r("path"),this.query=r("query"),this.hash=r("hash"),this.query.get=function(t){return e.Query(i.query())[t]},this.query.set=function(t,n){var r=e.Query(i.query())
	r[t]=n,i.query(r+"")},this.origin=function(){var e=function(e,t){return t?e+t:""},t=(i.user()?i.user()+"@":"")+(i.host()||"")+e(":",i.port())
	return(i.scheme()?i.scheme()+":":"")+e("//",t)}}return e.prototype.toString=function(){var e=function(e,t){return t?e+t:""},t=(this.user()?this.user()+"@":"")+(this.host()||"")+e(":",this.port())
	return(this.scheme()?this.scheme()+":":"")+e("//",t)+this.path()+e("?",this.query())+e("#",this.hash())},e}()
	e.URI=t,function(t){function n(t){if(!(this instanceof n))return new n(t)
	var i=this
	e.isString(t)?e.foreach(t.split("&"),(function(t){var n,r,o=t.indexOf("=")
	o<0?(n=t,r=""):(n=t.slice(0,o),r=t.slice(o+1)),n&&(i[e.DataUri.decodeData(n)]=e.DataUri.decodeData(r))})):t&&e.foreach(e.clone(t),(function(e,t){i[t]=e}))}t.pattern={regexp:/^(?:([a-zA-Z][\w+-.]*):)?(?:\/\/(?:([^/@]*)@)?([^:/?#]*)(?:\:(\d*))?)?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,exec:function(e){var t=this.regexp.exec(e)
	return t&&{scheme:t[1],user:t[2],host:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}},t.Query=n,n.prototype.toString=function(){var t=[]
	return e.foreach(e.clone(this),(function(n,i){t.push(n?e.DataUri.encodeData(i)+"="+e.DataUri.encodeData(n):e.DataUri.encodeData(i))})),t.join("&")},Object.defineProperty(n.prototype,"toString",{enumerable:!1}),t.mergeQuery=function(e,n){if(!n)return e
	var i=new t(e),r=t.Query(i.query())
	for(var o in n)void 0!==n[o]&&(r[o]=n[o])
	return i.query(r+""),i+""}}(t=e.URI||(e.URI={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(e){var n=t.pattern.exec(e)
	if(!n)throw new SyntaxError("Invalid data URL: "+e)
	return n}e.DataUri=t,function(e){e.encodeData=function(e){return encodeURIComponent(e).replace(/%20/gm,"+")},e.decodeData=function(e){return decodeURIComponent(e.replace(/\+/gm," "))}}(t=e.DataUri||(e.DataUri={})),function(t){var n=e.rgx(/[^()<>@,;:\\\x22/\[\]?=\s]+/),i=e.seq(n,e.txt("/"),n).merge(),r=e.rgx(/[^\uffff]*/).then(t.decodeData),o=e.quoted(e.txt('"'),e.txt('"')),a=e.seq(e.rgx(/\s*=\s*/),e.any(o,n)).select(1),s=e.seq(e.rgx(/\s*;\s*/),n,e.opt(a,!0))
	t.pattern=e.seq(e.txt("data:"),e.opt(i),e.rep(s).join(1,2),e.rgx(/\s*,\s*/),r).then((function(e){var t=e[1],n=e[2]
	return{mime:t,attributes:n,data:e[4],base64:!!n.base64}}))}(t=e.DataUri||(e.DataUri={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(n){if(!(this instanceof t))return new t(n)
	var i=t.pattern.exec(n)
	if(!i)throw new SyntaxError("Invalid CSS style: "+n)
	e.extend(this,i)}e.Style=t,function(t){var n=e.rgx(/[\x00-\x20]+/),i=e.rgx(/[,\x00-\x20]+/),r=e.rgx(/#[\da-fA-F]+/i),o=e.rgx(/[+-]?(\d+[\.]?\d*|\.\d+)/),a=e.seq(o,e.opt(e.rgx(/%|[a-z]+/i))).text(),s=e.any(e.quoted(e.txt('"'),e.txt('"')),e.quoted(e.txt("'"),e.txt("'"))),c=e.rgx(/[a-z][a-z-]*[a-z]|[a-z]/i),l=e.any(a,s,c,r).text(),u=e.seq(c.text(),e.opt(n),e.txt(":"),e.opt(n),e.sep(l,i)),d=e.seq(e.opt(n),e.txt(";"),e.opt(n)),p=e.seq(e.sep(u,d),e.opt(d)).select(0)
	t.pattern=p.join(0,4)}(t=e.Style||(e.Style={})),e.setHiddenProperty(t.prototype,"toString",(function(){var e,t=[]
	for(e in this)t.push(e+":"+this[e].join(" "))
	return t.join(";")}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n={lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"'}
	function i(t){return t.replace(/&(#?\w+);/gm,(function(t,i){return"#"==i.charAt(0)?function(t){if(void 0===t)return""
	var n,i,r=[]
	if(!isFinite(t)||t<0||t>1114111||e.Math.floor(t)!=t)throw RangeError("Invalid code point: "+t)
	return t<=65535?r.push(t):(n=55296+((t-=65536)>>10),i=t%1024+56320,r.push(n,i)),String.fromCharCode.apply(null,r)}(+i.slice(1)):n[i]}))}function r(e){if(!(t.isString(e)||e&&e.ast))throw new Error("Invalid argument: "+e)
	if(!(this instanceof r))return new r(e)
	var n,i
	try{if(!(n=e.ast||r.pattern.exec(e)))throw void 0}catch(c){throw(i=new SyntaxError("Invalid XML: "+e)).reason=c,i}var o=n.attrs||{},a=(n.nodes||[]).map((function(e){return r({ast:t.isString(e)?{text:e}:e})})),s=function(e,t){return e+t.text()}
	this.attrs=o,this.nodes=a,this.name=function(){return n.name},this.text=function(){return n.text||a.reduce(s,"")}}t.XmlNode=r,r.prototype.toString=function(){var e="",n="",i=this,r=i.name()
	return t.foreach(i.attrs,(function(n,i){e+=" "+i,t.isVoid(n)||(e+='="'+n.replace(/\x22/gm,"&quot;")+'"')})),t.foreach(i.nodes,(function(e){n+=e})),n=n||i.text().replace(/</gm,"&lt;").replace(/>/gm,"&gt;"),r?n?"<"+r+e+">"+n+"</"+r+">":"<"+r+e+"/>":n},r.prototype.attr=function(e){return t.assert(e in this.attrs,"Attribute does not exist: "+this.name()+"."+e),this.attrs[e]},r.prototype.selectOne=function(e,n){var i=t.filter(this.nodes,t.isFunction(e)?e:function(t){var i,r
	if(n)for(i in n)if(r=i.toLowerCase(),n[r]!=t.attrs[r])return!1
	return t.name()==e.toLowerCase()})
	return t.assert(1==i.length,"Single node expected: "+e),i[0]},function(e){var n=t.rgx(/[\x00-\x20]*/),r=t.rgx(/\x22[^\x22]*\x22/).then((function(e){return e.slice(1,-1)})),o=t.rgx(/[^\s<>\x22]+/),a=t.any(r,o).then(i),s=t.rgx(/[^<]+/m).then(i),c=t.rgx(/[\w:-]+/).then((function(e){return e.toLowerCase()})),l=t.seq(c,t.opt(t.seq(n,t.txt("="),n,a).select(3))),u=t.sep(l,n).join(0,1),d=t.seq(t.txt("<"),n),p=t.seq(n,t.txt(">")),f=t.rgx(/<!--[\s\S]*?-->/m).then((function(e){return{name:"--"}})),m=t.seq(d,c,n,u,p).then((function(e){return{name:e[1],attrs:e[3]}})),h=t.seq(d,c,n,u,t.seq(n,t.txt("/>"))).then((function(e){return{name:e[1],attrs:e[3]}})),v=t.seq(t.txt("</"),n,c,p).select(2),g=new t.Pattern((function(t,n){return e.pattern.exec(t,n)})),y=t.seq(m,t.rep(t.any(g,s,f)),v).then((function(e){var t=e[0],n=e[1],i=e[2]
	if(t.name!=i)throw new SyntaxError("</"+i+"> does not match <"+t.name+">")
	return{name:i,nodes:n,attrs:t.attrs}}))
	e.pattern=t.any(y,h)}(r=t.XmlNode||(t.XmlNode={})),t.XmlDoc=function(e){return{root:r(t.trim(e.replace(/^<\?.+?\?>/,"")))}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=/^(body|b|strong|i|u|s|span|table|tr|td|th|br|div|hr|p|h\d|font|a)$/i,n=/^(style|width|height|color|face|size|href)$/i,i=/^(font(-[a-z]+)?|margin(-[a-z]+)?|line(-[a-z]+)?|color)$/i
	function r(t){var n=t.replace(/<(br|meta)\b(.*?)\/?>/gim,"<$1$2/>")
	return n=/^\s*<html\b[\s\S]*<\/html>\s*$/gim.test(n)?e.trim(n):"<html><body>"+n+"</body></html>",e.XmlNode(n).selectOne("body")}function o(e){return e&&e.replace(/</gm,"〈").replace(/>/gm,"〉")}e.convertTextToHtml=function(e){return e.replace(/[<>&;#/]/gm,(function(e){return"&#"+e.charCodeAt(0)+";"})).replace(/\r\n|\n/gm,(function(){return"<br>"}))},e.convertHtmlToText=function(e){return r(e.replace(/<br\s*\/?>/gi,"\r\n").replace(/&(nbsp|#160);/gi," ")).text()},e.sanitizeHtml=function(a){try{return a&&function r(o){var a,s,c=o.nodes
	for(function(e){var t,i=e.attrs
	for(t in i)n.test(t)||delete i[t]}(o),function(t){var n,r,o=t.attrs.style
	if(o){for(r in n=e.Style(o))i.test(r)||delete n[r]
	t.attrs.style=n+""}}(o),a=0;a<c.length;a++)(s=c[a].name())&&!t.test(s)?e.removeAt(c,a--):r(c[a])
	return o}(r(a)).nodes.join("")}catch(_){return o(a)}},e.disableHtmlInText=o})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(e){var n=t.pattern.exec(e||"")
	if(n)return n
	throw new SyntaxError("Invalid WWW-Authenticate header:\n"+e)}e.WWWAuthenticateHeader=t,function(t){var n=e.rgx(/[\s,]*/),i=e.rgx(/[^\s,=]+/),r=e.quoted(e.txt('"'),e.txt('"')),o=e.seq(i,e.rgx(/\s*=\s*/),r),a=e.sep(o,n).join(0,2),s=e.seq(i,n,a)
	t.pattern=e.sep(s,n).join(0,2)}(t=e.WWWAuthenticateHeader||(e.WWWAuthenticateHeader={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(t){var n={},i=function(e){return e.toLowerCase().replace(/\b(\w)/g,(function(e){return e.toUpperCase()}))}
	function r(t,r){e.assert(e.isNotEmptyString(t)),t=i(t),n[t]?n[t]+="\n"+r:n[t]=r}return e.isNotEmptyString(t)?function(t){e.assert(e.isString(t))
	for(var n,i,o=t.split("\r\n"),a=0;a<o.length;a++)(i=e.trim(o[a]))&&(n=i.indexOf(":"))>=0&&r(e.trim(i.substr(0,n)),e.trim(i.substr(n+1)))}(t):e.isDictionary(t)&&function(t){for(var n in e.assert(e.isDictionary(t)),t)r(n,t[n]+"")}(t),{raw:n,get:function(t){return e.assert(e.isNotEmptyString(t)),n[i(t)]},add:r,toString:function(){var e,t,i,r=""
	for(t in n)for(i=n[t].split("\n"),e=0;e<i.length;e++)i[e]&&(r+=t+": "+i[e]+"\r\n")
	return r+"\r\n"}}}(function(e){e.isSuccess=function(e){return 200<=e&&e<300}})(e.Http||(e.Http={})),e.HttpHeaders=t,function(e){e.parse=function(t){return e(t).raw}}(t=e.HttpHeaders||(e.HttpHeaders={})),e.ContentTypeHeader=function(t){var n=e.DataUri("data:"+t.replace(/\s/g,"")+",")
	return{mimeType:n.mime,attributes:n.attributes}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(e){var n
	return Object.keys?n=Object.keys(e):(n=[],t.foreach(e,(function(e,t){n.push(t)}))),n}t.getOption=function(e,t,n){return t in e?e[t]:n},t.keys=n,t.all=function(e,t){for(var n in e)if(!t(e[n],n))return!1
	return!0},t.namespace=function(n,i,r){var o,a=r||e.window,s=n.split(".")
	for(o=0;o<s.length;o++)a=a[s[o]]||(a[s[o]]={})
	for(o in i)t.assert(!(o in a),n+"."+o+" already exists"),a[o]=i[o]
	return a},t.take=function(e,t){var n={}
	return n[t]=e[t],n},t.filter=function(e,n){var i
	return t.isArray(e)?(i=[],t.foreach(e,(function(e,t){n(e,t)&&i.push(e)}))):(i={},t.foreach(e,(function(e,t){n(e,t)&&(i[t]=e)}))),i},t.size=function(e){return t.assert(t.isArray(e)||t.isDictionary(e)),t.isArray(e)?e.length:n(e).length},t.find=function(e,n){if(t.isArray(e)){for(var i=0;i<e.length;++i)if(n(e[i],i))return e[i]}else for(var i in e)if(n(e[i],i))return e[i]
	return null},t.findIndex=function(e,t){for(var n=0;n<e.length;++n)if(t(e[n],n))return n
	return-1},t.setEqual=function(e,n){function i(e,n){for(var i=0;i<e.length;i++)if(t.indexOf(n,e[i])<0)return!1
	return!0}return i(e,n)&&i(n,e)},t.removeAll=function(e,t){var n=[]
	for(var i in e)t(e[i])&&n.push(i)
	for(var r=0,o=n;r<o.length;r++){delete e[i=o[r]]}},t.pick=function(e,t){var n={}
	try{for(var i=0,r=t;i<r.length;i++){for(var o=r[i].split(".").filter((function(e){return""!=e.trim()})),a=!0,s=e,c=0,l=o;c<l.length;c++){var u=l[c]
	if(!(u in s)){a=!1
	break}s=s[u]}if(a){var d=n
	s=e
	for(var p=0;p<o.length-1;p++)d[o[p]]=d[o[p]]||{},d=d[o[p]],s=s[o[p]]
	d[o[p]]=s[o[p]]}}}catch(_){}return n},t.flatten=function(n,i,r){void 0===r&&(r=function(e){return[]})
	var o={},a=[]
	return function n(s){for(var c=0,l=Object.keys(s).concat(r(s));c<l.length;c++){var u=l[c]
	a.push(u)
	var d=s[u]
	t.isPrimitive(d)||d instanceof e.Date?o[i(a)]=d:n(d),a.pop()}}(n),o}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.SequentialStateMachine=function(t){var n,i,r=e.Property({value:t}),o=e.Property({value:t}),a={}
	function s(e){i.cancel(e),i=null}function c(e){if(!i){var t=r()+1
	e.status("advancing to state "+t),(i=a[t].call(null)).then((function(n){i=null,r.set(t),r()<o()?c(e):e.resolve(n)}),(function(t){i=null,e.reject(t)}))}}return{defineState:function(n,i){e.assert(!a[n]),e.assert(n>t),e.assert(e.isFunction(i)),a[n]=e.async(i)},reset:function(){r(t),o(t),i&&s(e.Exception("Reset")),n=null,i=null},advanceTo:e.async((function(t){if(e.check(t>=o(),"InvalidTargetState",{currentTarget:o(),requestedTarget:t}),t!=r())return t>o()&&(n=new e.Task("advancing to target state "+t,{cancel:s}),o.set(t),c(n)),n.promise})),state:r.asReadOnly(),target:o.asReadOnly()}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){function t(n){return e.async(n)().then((function(){return e.extend(t(n),((i={})[e.Task.sLocked]=!0,i))
	var i}))}e.repeat=t,e.repeatAndExit=function(n){var i=[null]
	return t(e.bind(n,(function(e){throw i[0]=e,i}))).catch((function(e){if(e===i)return i[0]
	throw e}))},e.repeatDelayed=function(n,i){e.assert(e.isNumber(i)&&i>0)
	var r=e.async(n)
	return t((function(){return r().then(e.bind(e.sleep,i))}))}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.throttle=function(n,i,r){t.assert(t.isFunction(n)),t.assert(i>0),n=t.async(n)
	var o=0,a=[],s={},c={},l=[],u={}
	function d(){for(r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:dequeue] ","sent="+o,"size="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),t.assert(o<=i);o<i&&a.length>0;)p()}function p(){var p=a.splice(0,1)[0],f=c[p],m=s[p]
	delete c[p],delete s[p],l.splice(0,1),o++,u[p]=n(f),r&&r.verbose&&(t.debug.log(e.Settings.logHttp,"[THROTTLE:send] ","request="+f.url,"sent="+o,"size="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),t.debug.logVerbose(f)&&r.monitor(u[p],e.TelemetryEvent.Endpoint,{action:"throttle_send",url:f.url,sent:o,buffer:i})),u[p].then((function(n){r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:send-success] ","request="+f.url,"sent="+o,"size="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),m.resolve(n)}),(function(n){r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:send-fail] ","request="+f.url,"sent="+o,"size="+i,"queue="+_stringify(a),"priorities="+_stringify(l),"error="+_stringify(n)),m.reject(n)}),m.status).then((function(){r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:send-then] ","request="+f.url,"sent="+o,"size="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),o--,delete u[p],d()}))}function f(n,i){var o
	if(r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:cancel] ","request="+c[n].url,"id="+n,"reason="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),u[n])r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:cancel-pending] ","request="+c[n].url,"id="+n,"reason="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),u[n].cancel(i)
	else for(r&&r.verbose&&t.debug.log(e.Settings.logHttp,"[THROTTLE:cancel-not-pending] ","request="+c[n].url,"id="+n,"reason="+i,"queue="+_stringify(a),"priorities="+_stringify(l)),s[n].reject(i),delete c[n],delete s[n],o=0;o<a.length;o++)if(a[o]==n){a.splice(o,1),l.splice(o,1)
	break}}return function(u,p){if(r&&r.verbose&&(t.debug.log(e.Settings.logHttp,"[THROTTLE:enter] ","request="+u.url,"priority="+p,"queue="+_stringify(a),"priorities="+_stringify(l)),t.debug.logVerbose(u)&&r.record(e.TelemetryEvent.Endpoint,{action:"throttle_enter",priority:p,url:u.url,sent:o,buffer:i})),p==1/0)return n(u)
	var m=t.random(),h=new t.Task("Waiting in the throttling queue.",{cancel:t.bind(f,m)})
	return s[m]=h,c[m]=u,function(n,s){r&&r.verbose&&(t.debug.log(e.Settings.logHttp,"[THROTTLE:insert] ","request="+c[n].url,"id="+n,"priority="+s,"queue="+_stringify(a),"priorities="+_stringify(l)),t.debug.logVerbose(c[n])&&r.record(e.TelemetryEvent.Endpoint,{action:"throttle_insert",priority:s,url:c[n].url,sent:o,buffer:i}))
	for(var u=l.length;u>0&&s>l[u-1];)u--
	l.splice(u,0,s),a.splice(u,0,n)}(m,p),d(),r&&r.verbose&&(t.debug.log(e.Settings.logHttp,"[THROTTLE:return] ","id="+m,"queue="+_stringify(a),"priorities="+_stringify(l)),t.debug.logVerbose(u)&&r.monitor(h.promise,e.TelemetryEvent.Endpoint,{action:"throttle_return",priority:p,url:u.url,sent:o,buffer:i})),h.promise}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.debounced=function(e){var n,i,r=t.async(e)
	return function(){return i||(n=i=r(),i.finally((function(){i=null}))),n}},t.debounce=function(t,n){var i,r
	return function(o,a,s){i!=o&&(i=o,e.clearTimeout(r),r=e.setTimeout((function(){n(o,a,s)}),t))}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.batched=function(n,i){void 0===i&&(i=1/0)
	var r,o=[]
	function a(){var e=function(e){t.assert(e>0),t.assert(o.length>0)
	var n,i=[],r=[]
	for(n=o.length-1;n>=0&&i.length<e;n--)i.push(o[n].request),r.push(o[n].task)
	return o.splice(n+1,e),{requests:i,tasks:r}}(i)
	function r(n){t.foreach(e.tasks,(function(e,t){e.cancelled||n(e,t)}))}t.Task.wait(n(e.requests)).then((function(e){r((function(n,i){var r=t.isArray(e)?e[i]:e
	t.Task.wait(r).then((function(e){return n.resolve(e)}),(function(e){return n.reject(e)}),n.status)}))}),(function(e){r((function(t){t.reject(e)}))}),(function(e){r((function(t){t.status(e)}))}))}return function(n,i){void 0===i&&(i=0)
	var s=new t.Task("Waiting in the batching queue.",{cancel:function(e){(function(e,t){var n
	for(n=0;n<o.length&&o[n].task!==e;n++);n<o.length?(o.splice(n,1),e.reject(t)):(e.cancelled=!0,e.reject(t))})(s,e)}})
	return r||(r=e.setTimeout((function(){for(r=null;o.length>0;)a()}),0)),function(e,n,i){t.assert(t.isNumber(e)),t.assert(i instanceof t.Task)
	for(var r=0;r<o.length&&e>o[r].priority;)r++
	o.splice(r,0,{priority:e,request:n,task:i})}(i,n,s),s.promise}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
	function i(e,t){return(e%t+t)%t}(function(t){t.byteArrayToString=function(t){e.assert(e.isArray(t))
	for(var n,i,r,o,a="",s=0;s<t.length;){if((n=t[s])<0||n>255)throw new Error("Unexpected utf8 byte")
	if(n<128)a+=String.fromCharCode(n),s++
	else if(192==(224&n)){if(s+1>=t.length)throw new Error("Unexpected end of array")
	if((i=t[s+1])<0||i>255||128!=(192&i))throw new Error("Unexpected utf8 byte")
	a+=String.fromCharCode((31&n)<<6|63&i),s+=2}else if(224==(240&n)){if(s+1>=t.length||s+2>=t.length)throw new Error("Unexpected end of array")
	if(i=t[s+1],r=t[s+2],i<0||i>255||128!=(192&i))throw new Error("Unexpected utf8 byte")
	if(r<0||r>255||128!=(192&r))throw new Error("Unexpected utf8 byte")
	a+=String.fromCharCode((15&n)<<12|(63&i)<<6|63&r),s+=3}else{if(240!=(248&n))throw new Error("Illegal utf8 converter input")
	if(s+1>=t.length||s+2>=t.length||s+3>=t.length)throw new Error("Unexpected end of array")
	if(i=t[s+1],r=t[s+2],o=t[s+3],i<0||i>255||128!=(192&i))throw new Error("Unexpected utf8 byte")
	if(r<0||r>255||128!=(192&r))throw new Error("Unexpected utf8 byte")
	if(o<0||o>255||128!=(192&o))throw new Error("Unexpected utf8 byte")
	var c=(7&n)<<18|(63&i)<<12|(63&r)<<6|63&o,l=55232+(c>>10),u=56320+(1023&c)
	a+=String.fromCharCode(l),a+=String.fromCharCode(u),s+=4}}return a},t.stringToByteArray=function(t){e.assert(e.isString(t))
	for(var n=[],i=0;i<t.length;){var r=t.charCodeAt(i)
	if(r<128)n.push(r),i++
	else if(r<2048)n.push(192|r>>6),n.push(128|63&r),i++
	else if(55296<=r&&r<=56319){var o=r
	if(i+1>=t.length)throw new Error("High Surrogate at the end of string")
	var a=t.charCodeAt(i+1)
	if(!(56320<=a&&a<=57343))throw new Error("High Surrogate followed by invalid low surrogate")
	var s=(o<<10)+a+-56613888
	n.push(240|s>>18),n.push(128|s>>12&63),n.push(128|s>>6&63),n.push(128|63&s),i+=2}else{if(56320<=r&&r<=57343)throw new Error("Low Surrogate not preceded by high surrogate")
	if(!(r<65536))throw new Error("Illegal utf8 converter input")
	n.push(224|r>>12),n.push(128|r>>6&63),n.push(128|63&r),i++}}return n}})(t=e.ByteArray||(e.ByteArray={})),function(r){function o(t){e.assert(e.isArray(t))
	for(var r,o,a,s,c,l,u,d="",p=0;p<t.length;)s=(r=t[p++])>>2,c=(3&r)<<4|(o=p<t.length?t[p++]:0)>>4,l=(15&o)<<2|(a=p<t.length?t[p++]:0)>>6,u=63&a,p==t.length&&(1==i(t.length,3)?(l=64,u=64):2==i(t.length,3)&&(u=64)),d+=n.charAt(s)+n.charAt(c)+n.charAt(l)+n.charAt(u)
	return d}function a(t){e.assert(e.isNotEmptyString(t))
	for(var i,r,o,a,s,c,l=[],u=0;u<t.length;)i=n.indexOf(t.charAt(u++))<<2|(a=n.indexOf(t.charAt(u++)))>>4,r=(15&a)<<4|(s=n.indexOf(t.charAt(u++)))>>2,o=(3&s)<<6|(c=n.indexOf(t.charAt(u++))),l.push(i),64!=s&&l.push(r),64!=c&&l.push(o)
	return l}r.encode=function(n){return e.isNotEmptyString(n)?o(t.stringToByteArray(n)):n},r.decode=function(n){if(e.isNotEmptyString(n)){var i=a(n)
	return t.byteArrayToString(i)}return n},r.encodeBytes=o,r.decodeBytes=a}(e.Base64||(e.Base64={}))})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=function(){function e(e){this.radix=e}return e.prototype.digits=function(e){for(var t=this.radix,n=[];e>t;){var i=e%t
	e=(e-i)/t,n.push(i)}return n.push(e),n},e.prototype.number=function(e){for(var t=0,n=e.length-1;n>=0;n--)t=t*this.radix+e[n]
	return t},e}()
	e.Radix=t})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){function n(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=16*e.Math.random()|0
	return("x"==t?n:3&n|8).toString(16)}))}var i
	t.guid=n,(i=n=t.guid||(t.guid={})).bytes=function(e){for(var t=[],n=0,i=e.split("-");n<i.length;n++)for(var r=i[n],o=0;o<r.length;o+=2)t.push(parseInt(r.slice(o,o+2),16))
	return t},i.parse=function(e){return e.map((function(e,t){var n=(256|e).toString(16).slice(1,3)
	return 4==t||6==t||8==t||10==t?"-"+n:n})).join("")}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.hash=function(e){var t=[1578336022,36261640,872437806,2915948275]
	e=function(e,t,n){return e.length>=t?e:e+new Array(t-e.length+1).join(n)}(e,e.length+16-e.length%16,"0")
	for(var n=0;n<e.length;n+=4)for(var i=0;i<4;i++){var r=(e.charCodeAt(n)<<24)+(e.charCodeAt(n+1)<<16)+(e.charCodeAt(n+2)<<8)+e.charCodeAt(n+3)
	t[i]=(t[i]<<5)+t[i]^r}var o=t.map((function(e){return(4294967296+e).toString(16).slice(-8)}))
	return[o[0],o[1].substr(0,4),o[1].substr(4,4),o[2].substr(0,4),o[2].substr(4,4)+o[3]].join("-")}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t=e.Exception,n=e.async,i=function(){function e(e){this.code=e}return e.prototype.synchronized=function(e){var i=n(e),r=this
	return function e(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o]
	return r.dfd?r.dfd.then((function(e){throw t(r.code)}),(function(t){if(t&&"Canceled"==t.code)throw t
	return r.dfd=null,e.apply(void 0,n)})):r.dfd=i.apply(void 0,n)}},e}()
	e.SyncLock=i})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.retry=function(t,n,i){var r=function(){return i().catch((function(i){if(!n(i))throw i
	var o=t(i)
	if(o>=0)return e.sleep(o).then(r)
	throw i}))}
	return r()},e.expdelay=function(e,t,n){void 0===n&&(n=1.5)
	var i=e,r=0
	return function(){if(r++<t){var e=i
	return i*=n,e}}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={}));(function(){if("undefined"!=typeof document)try{throw new Error}catch(t){if(t.stack){var e=/\w+:\/\/(.+?\/)*.+\.js/.exec(t.stack)
	return e&&e.length>0?e[0]:null}}else if("undefined"!=typeof self)return self.location.href})(),"function"==typeof importScripts&&(self,WorkerGlobalScope),function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(e){return!1}}()
	var s={},c=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="
	function t(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4!=0;)t+="="
	var n,i,r,o,a,s,c,l=[]
	for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=0;c<t.length;c+=4)n=e.indexOf(t.charAt(c))<<2|(o=e.indexOf(t.charAt(c+1)))>>4,i=(15&o)<<4|(a=e.indexOf(t.charAt(c+2)))>>2,r=(3&a)<<6|(s=e.indexOf(t.charAt(c+3))),l.push(n),64!==a&&l.push(i),64!==s&&l.push(r)
	return l}function n(e){return Object.prototype.toString.call(e).slice(8,-1)}function i(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e]}function r(e){if(!e)return[]
	if(e.pop)return e
	if("ArrayBuffer"===n(e)?e=new Uint8Array(e):e.BYTES_PER_ELEMENT>1&&(e=new Uint8Array(e.buffer)),1===e.length)return[e[0]]
	if(e.length<65536)return Array.apply(null,e)
	for(var t=new Array(e.length),i=0;i<e.length;i++)t[i]=e[i]
	return t}return{consoleLog:function(e){},toBase64:function(t,i){var o=n(t)
	if("Array"!==o&&"Uint8Array"!==o&&"ArrayBuffer"!==o)throw new Error("invalid input")
	var a,s,c,l,u,d,p,f,m="",h=r(t)
	for(i||(i=!1),f=0;f<h.length;f+=3)l=(a=h[f])>>2,u=(3&a)<<4|(s=h[f+1])>>4,d=(15&s)<<2|(c=h[f+2])>>6,p=63&c,isNaN(s)?d=p=64:isNaN(c)&&(p=64),m=m+e.charAt(l)+e.charAt(u)+e.charAt(d)+e.charAt(p)
	return i?m.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):m},fromBase64:t,checkParam:function(e,t,i){if(!e)throw new Error(i)
	if(t&&n(e)!==t)throw new Error(i)
	return!0},getObjectType:n,bytesToHexString:function(e,t){var n=""
	void 0===t&&(t=!1)
	for(var i=0;i<e.length;i++){t&&i%4==0&&0!==i&&(n+="-")
	var r=e[i].toString(16).toUpperCase()
	1===r.length&&(n+="0"),n+=r}return n},bytesToInt32:function(e,t){return e[t=t||0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},stringToBytes:function(e){for(var t=[],n=0,i=0;n<e.length;n++){var r=e.charCodeAt(n)
	r<128?t[i++]=r:r<2048?(t[i++]=r>>>6|192,t[i++]=63&r|128):r<55296||r>57343?(t[i++]=r>>>12|224,t[i++]=r>>>6&63|128,t[i++]=63&r|128):(r=1024*(r-55296)+(e.charCodeAt(++n)-56320)+65536,t[i++]=r>>>18|240,t[i++]=r>>>12&63|128,t[i++]=r>>>6&63|128,t[i++]=63&r|128)}return t},bytesToString:function(e){var t,n=""
	e=r(e)
	for(var i=0;i<e.length;){var o=e[i++]
	if((t=o<128?o:o<224?(o<<6)+e[i++]-12416:o<240?(o<<12)+(e[i++]<<6)+e[i++]-925824:(o<<18)+(e[i++]<<12)+(e[i++]<<6)+e[i++]-63447168)>65535){var a=Math.floor((t-65536)/1024)+55296,s=(t-65536)%1024+56320
	n+=String.fromCharCode(a,s)}else n+=String.fromCharCode(t)}return n},unpackData:function(e,n,i){var r,o=t(e),a=[]
	if(isNaN(n))return o
	for(r=0;r<o.length;r+=n)a.push(o.slice(r,r+n))
	if(i)for(r=0;r<a.length;r++)a[r]=(a[r][0]<<24)+(a[r][1]<<16)+(a[r][2]<<8)+a[r][3]
	return a},hexToBytesArray:function(e){e=e.replace(/\-/g,"")
	for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length)
	return t},int32ToBytes:i,int32ArrayToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(i(e[n]))
	return t},toArray:r,arraysEqual:function(e,t){var n=!0
	e.length!==t.length&&(n=!1)
	for(var i=0;i<e.length;i++)e[i]!==t[i]&&(n=!1)
	return n},clone:function(e){var t={}
	for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])
	return t},xorVectors:function(e,t){for(var n=Math.min(e.length,t.length),i=new Array(n),r=0;r<n;r+=1)i[r]=e[r]^t[r]
	return i},padEnd:function(e,t,n){for(;e.length<n;)e.push(t)
	return e},padFront:function(e,t,n){for(;e.length<n;)e.unshift(t)
	return e},getVector:function(e,t){t||(t=0)
	for(var n=new Array(e),i=0;i<e;i+=1)n[i]=t
	return n},verifyByteArray:function(e){if("Array"!==n(e))return!1
	for(var t,i=0;i<e.length;i++)if(t=e[i],isNaN(t)||t<0||t>255)return!1
	return!0}}}(),l={register:function(e,t,n){l[e]||(l[e]={})
	var i=l[e]
	i[t]||(i[t]=n)},exists:function(e,t){return!!l[e]&&!!l[e][t]}},u=function(e,t,n,i,r,o,a){var s=c,l=n.slice(),u=new Array(r),d=[],p=0
	function f(e){for(var t=Math.floor(e.length/r),n=0;n<t;n++)o(e,n,l,i,u)
	return p+=t,e.slice(t*r)}function m(){if(0!==f(function(e){var t=r-e.length%r
	t<=r/8&&(t+=r)
	var n=s.getVector(t)
	n[0]=128
	for(var i=8*(e.length+p*r),o=1;o<=8;o++)n[t-o]=i%256,i=Math.floor(i/256)
	return e.concat(n)}(d)).length)throw new Error("buffer.length !== 0")
	var e=function(){for(var e=[],t=0;t<l.length;t++)e=e.concat(s.int32ToBytes(l[t]))
	return e.length=a/8,e}()
	return d=[],l=n.slice(),p=0,e}return{name:e,computeHash:function(e){return d=f(e),m()},process:function(e){(d=d.concat(e)).length>=r&&(d=f(d))},finish:m,der:t,hashLen:a,maxMessageSize:4294967295}},d=function(){var e=c
	function t(t,n,i,r,o){var a,s,c,l,u,d=i[0],p=i[1],f=i[2],m=i[3],h=i[4],v=i[5],g=i[6],y=i[7]
	for(s=0;s<16;s++)o[s]=e.bytesToInt32(t,64*n+4*s)
	for(a=16;a<64;a++)l=o[a-15],u=o[a-2],o[a]=((u>>>17|u<<15)^(u>>>19|u<<13)^u>>>10)+o[a-7]+((l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3)+o[a-16],o[a]=4294967295&o[a]
	for(s=0;s<64;s++)m+=c=y+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+(h&v^~h&g)+r[s]+o[s],c+=((d>>>2|d<<30)^(d>>>13|d<<19)^(d>>>22|d<<10))+(d&(p^f)^p&f),y=g,g=v,v=h,h=m,m=f,f=p,p=d,d=c
	return i[0]=i[0]+d>>>0,i[1]=i[1]+p>>>0,i[2]=i[2]+f>>>0,i[3]=i[3]+m>>>0,i[4]=i[4]+h>>>0,i[5]=i[5]+v>>>0,i[6]=i[6]+g>>>0,i[7]=i[7]+y>>>0,i}var n,i,r,o,a,s=e.unpackData
	return i=s("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),r=s("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),n=s("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",4,1),o=s("MC0wDQYJYIZIAWUDBAIEBQAEHA"),a=s("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:function(){return u("SHA-224",o,i,n,64,t,224)},sha256:function(){return u("SHA-256",a,r,n,64,t,256)}}}()
	void 0!==l&&(d.instance224=d.instance224||d.sha224(),d.instance256=d.instance256||d.sha256(),d.instances={},d.getInstance224=function(e){return d.instances[e]||(d.instances[e]=d.sha224())},d.getInstance256=function(e){return d.instances[e]||(d.instances[e]=d.sha256())},d.deleteInstance=function(e){d.instances[e]=null,delete d.instances[e]},d.hash256=function(e){if("process"===e.operationSubType)return d.getInstance256(e.workerid).process(e.buffer),null
	if("finish"===e.operationSubType){var t=d.getInstance256(e.workerid).finish()
	return d.deleteInstance(e.workerid),t}if("abort"!==e.operationSubType)return d.instance256.computeHash(e.buffer)
	d.deleteInstance(e.workerid)},d.hash224=function(e){if("process"!==e.operationSubType){if("finish"===e.operationSubType)d.getInstance224(e.workerid).finish()
	if("abort"!==e.operationSubType)return d.instance224.computeHash(e.buffer)
	msrcryptoSha224.deleteInstance(e.workerid)}else d.getInstance224(e.workerid).process(e.buffer)},l.register("digest","sha-224",d.hash224),l.register("digest","sha-256",d.hash256)),s["sha-224"]=d.sha224,s["sha-256"]=d.sha256,function(e){(function(e){(function(e){e.sha256Hash=function(t){var n=e.ByteArray.stringToByteArray(t),i=l.digest["sha-256"]({buffer:n}),r=""
	return i.forEach((function(t){var n
	r+=(n=t.toString(16),e.assert(n.length<=2&&n.length>0),2==n.length?n:"0"+n)})),r}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t=function(){function t(e,t){this.path=e,this.prep=t}return t.prototype.get=function(){var t
	try{t=function(e,t){var n=e.getItem(t)
	if(null!=n)return JSON.parse(n)
	var i=[]
	for(var r in e)r.slice(0,t.length+1)==t+"."&&i.push(r)
	if(i.length){for(var o={},a=0,s=i;a<s.length;a++){r=s[a]
	for(var c=JSON.parse(e.getItem(r)),l=r.slice(t.length+1).split("."),u=o,d=0;d<l.length-1;d++){var p=l[d]
	u[p]=u[p]||{},u=u[p]}u[l[l.length-1]]=c}return o}}(e.localStorage,this.path)}catch(n){}return this.prep(t)},t}();(function(e){e.ctor=new t("lwsdk.ctor",(function(e){return e||{}})),e.logs=new t("lwsdk.logs",(function(e){return!!e})),e.cfmt=new t("lwsdk.cfmt",(function(e){return e})),e.pref=new t("lwsdk.pref",(function(e){return e})),function(e){e.ctor=new t("lwsdk.bp.ctor",(function(e){return!!e}))}(e.bp||(e.bp={}))})(e.ls||(e.ls={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},t.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},t.DEVICE_TYPES={DESKTOP:1,MOBILE:2,TABLET:8},t.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},t.CSS_PROPERTIES={OBJECT_FIT:"objectFit"},t.UNKNOWN_VERSION="U",t.CHROME_NPAPI_NOT_SUPPORTED_VERSION_MAJOR="42",t.REGEX_VERSION="([\\d,.]+)",t.REGEX_VERSION_MAC="([\\d,_,.]+)"
	var n=function(){function n(){}return n.getHostname=function(){return location.hostname},n.getUserAgent=function(){return e.window.navigator.userAgent},n.userAgentContainsString=function(e){return this.getUserAgent().indexOf(e)>-1},n.isIe=function(){return this.userAgentContainsString("Trident")},n.isEdge=function(){return this.userAgentContainsString(t.BROWSERS.EDGE)},n.isOpera=function(){return this.userAgentContainsString("OPR/")},n.getBrowserName=function(){return this.isOpera()?t.BROWSERS.UNKNOWN:this.userAgentContainsString(t.BROWSERS.PHANTOMJS)?t.BROWSERS.PHANTOMJS:this.isEdge()?t.BROWSERS.EDGE:this.userAgentContainsString(t.BROWSERS.ELECTRON)?t.BROWSERS.ELECTRON:this.userAgentContainsString(t.BROWSERS.CHROME)?t.BROWSERS.CHROME:this.userAgentContainsString(t.BROWSERS.FIREFOX)?t.BROWSERS.FIREFOX:this.userAgentContainsString(t.BROWSERS.SAFARI)?t.BROWSERS.SAFARI:this.userAgentContainsString(t.BROWSERS.SKYPE_SHELL)?t.BROWSERS.SKYPE_SHELL:this.isIe()?t.BROWSERS.MSIE:t.BROWSERS.UNKNOWN},n.getBrowserVersion=function(){return this.isIe()?function(){var e,n=this.getUserAgent(),i=n.match(new RegExp(t.BROWSERS.MSIE+" "+t.REGEX_VERSION))
	if(i)return i[1]
	if(e=n.match(new RegExp("rv:"+t.REGEX_VERSION)))return e[1]
	return}.call(this):function(e){var n
	e===t.BROWSERS.SAFARI&&(e="Version")
	if(n=this.getUserAgent().match(new RegExp(e+"/"+t.REGEX_VERSION)))return n[1]
	return t.UNKNOWN_VERSION}.call(this,this.getBrowserName())},n.deviceType=function(){return this.getUserAgent().match(/(android|ipod|windows phone|wpdesktop|windows ce|blackberry\w*|meego|webos|palm|symbian|pda|\w*?mobile\w*?|\w*?phone\w*?)/i)?t.DEVICE_TYPES.MOBILE:this.getUserAgent().match(/tablet|ipad/i)?t.DEVICE_TYPES.TABLET:t.DEVICE_TYPES.DESKTOP},n.getOsName=function(){var e=this.getUserAgent()
	return e.match(/windows\sphone\s\d+\.\d+/i)?t.OPERATING_SYSTEMS.WINDOWS_PHONE:e.match(/ arm;/i)?t.OPERATING_SYSTEMS.WINDOWS_RT:e.match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?t.OPERATING_SYSTEMS.IOS:e.match(/android/i)?t.OPERATING_SYSTEMS.ANDROID:e.match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|cros)/i)?t.OPERATING_SYSTEMS.LINUX:e.match(/(macintosh|mac os x)/i)?t.OPERATING_SYSTEMS.MACOSX:e.match(/(windows|win32)/i)?t.OPERATING_SYSTEMS.WINDOWS:t.OPERATING_SYSTEMS.UNKNOWN},n.getOsVersion=function(){return this.getOsName()===t.OPERATING_SYSTEMS.WINDOWS?function(){var e=this.getUserAgent().match(new RegExp("Windows NT "+t.REGEX_VERSION))
	if(e&&t.VERSION_MAPPINGS[e[1]])return t.VERSION_MAPPINGS[e[1]]
	return t.UNKNOWN_VERSION}.call(this):this.getOsName()===t.OPERATING_SYSTEMS.MACOSX?function(){var e=this.getUserAgent().match(new RegExp(t.OPERATING_SYSTEMS.MACOSX+" "+t.REGEX_VERSION_MAC))
	if(e)return r(e[1].replace(/_/g,".")).getMajor()
	return t.UNKNOWN_VERSION}.call(this):t.UNKNOWN_VERSION},n.mapWindowsVersion=function(e){return t.VERSION_MAPPINGS[e]?t.VERSION_MAPPINGS[e]:e},n.castSWXConstToWebSDK=function(e){switch(e){case t.BROWSERS.EDGE:return"Microsoft Edge"
	case t.BROWSERS.MSIE:return"IExplorer"
	case t.OPERATING_SYSTEMS.MACOSX:return"Mac OSX"
	case t.UNKNOWN_VERSION:return"Unknown"
	default:return e}},n}()
	t.EnvInfo=n
	var i=function(){function e(e){this.unknownVersionString="U",this.isVersionValid=!0,this.versionString=e,this.parseComponents()}return e.prototype.getMajor=function(){return this.components[0]},e.prototype.getMinor=function(){return this.components[1]},e.prototype.getAllComponents=function(){return this.components},e.prototype.getOriginalString=function(){return this.versionString},e.prototype.isValid=function(){return this.isVersionValid},e.prototype.compareTo=function(e){var t=0,n=0,i=e.getAllComponents()
	if(!this.isValid()||!e.isValid())throw new Error("Invalid version cannot be compared")
	for(var r=0;r<i.length;++r){if(t=parseInt(this.components[r],10),n=parseInt(i[r],10),!t||t<n)return-1
	if(t>n)return 1}return 0},e.prototype.parseComponents=function(){if(!this.versionString)return this.components=[this.unknownVersionString,this.unknownVersionString],void(this.isVersionValid=!1)
	var e=this.getDelimiter()
	e?(this.components=this.versionString.split(e),this.validateComponents()):(this.components=[this.versionString,this.unknownVersionString],this.isVersionValid=!1)},e.prototype.validateComponents=function(){for(var e=0;e<this.components.length;++e)if(!this.components[e]||isNaN(parseInt(this.components[e],10))){this.components.push(this.unknownVersionString),this.isVersionValid=!1
	break}},e.prototype.getDelimiter=function(){return this.versionString.indexOf(".")>-1?".":this.versionString.indexOf("_")>-1?"_":null},e}(),r=function(e){return new i(e)}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){e.version="0.4.1028 master".replace(/[{}]/g,"")
	var t=function(){function e(e){this.value=e}return e.prototype.map=function(t){return new e(t(this.value))},e}()
	e.Identity=t,function(e){e.timestamps=!0,e.saveConsole=!1,e.logSize=0}(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=t.sha256Hash
	function i(e){return Object.freeze?Object.freeze(e):e}(function(n){var i
	function r(){var e=""
	function t(t,n){void 0!==n&&(e+=t+": "+n+"\r\n")}return Object.keys(n.debugInfo).forEach((function(e){"correlation_ids"==e?Object.keys(n.debugInfo[e]).forEach((function(i){t("cid_"+i,n.debugInfo[e][i])})):t(e,n.debugInfo[e])})),e}function o(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r]
	if(!e.Settings.saveConsole)throw Error("Logging to file is disabled")
	i||(i=t.extend([],{size:0,maxSize:e.Settings.logSize||Math.pow(2,22)}))
	var o=n.map((function(e){return t.isObject(e)?_stringify(e):e+""})).join(" ")+"\r\n"
	i.push(o),i.size+=2*o.length
	for(var a=i.size,s=0;a>i.maxSize;)a-=2*i[s].length,s++
	i.size=a,i.splice(0,s)}function a(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i]
	var r=new e.Date,o=r.toTimeString()
	return o=o.slice(0,8)+":"+r.getMilliseconds()+" ",t.isString(n[0])&&(o+=n.splice(0,1)[0]),n.splice(0,0,o),n}function s(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i]
	if(!e.isUnitTested)try{if(t.isString(n[0])&&t.isString(n[1])&&-1!=n[1].indexOf("%c")&&n.splice(0,2,n[0]+n[1]),/\b(Trident)|(Edge)\b/i.test(navigator.userAgent)&&"string"==typeof(n=n.map((function(e){return t.isPrimitive(e)?e:_stringify(e)})))[0]){for(var r=n[0],o=1,a=0;a<r.length;a++)"%"==r[a]&&/^[a-z]$/i.test(r[a+1])&&("c"==r[a+1]&&(r=r.slice(0,a)+r.slice(a+2),n.splice(o,1),a--,o--),o++)
	n[0]=r}console.log.apply(console,n)}catch(s){}}n.debugInfo={},n.dumpDebugInfo=function(){console.log(r())},n.saveConsole=function(n){if(void 0===n&&(n=(new e.Date).toJSON()+".log"),!e.Settings.saveConsole)throw Error("Logging to file is disabled.")
	i.splice(0,0,r())
	var o=t.EnvInfo.getBrowserName()
	if(o==t.BROWSERS.MSIE||o==t.BROWSERS.EDGE){var a=new Blob(i,{type:"text/plain"})
	navigator.msSaveOrOpenBlob(a,n)}else if(o==t.BROWSERS.SAFARI){if(!e.window||!e.window.onclick)throw Error("Cannot save to console - browser not supported")
	a=new Blob(i,{type:"text/plain"})
	var s=URL.createObjectURL(a),c=e.window.onclick
	e.window.onclick=function(){e.window.open(s),e.window.onclick=c,URL.revokeObjectURL(s)}}else{a=new Blob(i,{type:"text/plain"})
	var l=document.createElement("a")
	l.href=URL.createObjectURL(a),l.download=n,l.click()}},n.watch=function(t,n,i){i.changed((function(i,r,c){if(void 0!==c){var l=[n+": %c "+c+" -> "+i,"color:green;font-weight:bold"]
	r&&(l.push("Reason:"),l.push(r))
	var u=a(l)
	t&&(e.Settings.timestamps?s.apply(void 0,u):s.apply(void 0,l)),e.Settings.saveConsole&&o.apply(void 0,u)}}))},n.log=function(t){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i]
	var r=a.apply(void 0,n)
	t&&(e.Settings.timestamps?s.apply(void 0,r):s.apply(void 0,n)),e.Settings.saveConsole&&o.apply(void 0,r)},n.logVerbose=function(e){return e&&"POST"==e.type&&/\/reportMyActivity$/.test(e.url)||e&&"POST"==e.type&&/\/onlineMeetingInvitations\/.*\/accept$/.test(e.url)||e&&"GET"==e.type&&/\/applications\/.*\/events\?ack=\d*\&key=/.test(e.url)}})(t.debug||(t.debug={})),function(e){e.test=function(e){return/\^sips?:/i}}(t.SipUri||(t.SipUri={})),t.cleanwsp=function(e){return e.replace(/\s*\n\s*/gm,"")},function(e){e.merge=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]
	return t.cleanwsp(e.join(""))}}(t.TSTags||(t.TSTags={})),t.sleep=function(n){t.assert(n>=0)
	var i=new t.Task(n+" sec timeout",{cancel:function(t){e.clearTimeout(r),i.reject(t)}}),r=e.setTimeout((function(){return i.resolve()}),1e3*n|0)
	return i.promise},t.trim=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/gm,"")},t.freeze=i,t.StringEnum=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	var n,r,o={}
	for(r=0;r<e.length;r++)o[n=e[r]]=n
	return i(o)},t.Enum=function(){for(var e,n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
	if(1==r.length&&t.isDictionary(r[0]))e=arguments[0]
	else for(e={},n=0;n<r.length;n++)e[r[n]]=n
	return i(e)},t.enumName=function(e,t){for(var n in e)if(e[n]==t)return n
	return""},t.clone=function(e){return e&&JSON.parse(_stringify(e))},t.singleton=function(e){t.assert(t.isFunction(e))
	var n=null
	return function(){return n||(n=e())}},t.timeStampToDate=function(t){if(!t)return t
	var n=/\d+/.exec(t)
	return new e.Date(n&&+n[0])},t.dateToTimeStamp=function(e){return e?"/Date("+ +e+")/":e},t.currentUTCms=function(){return e.Date.now()+60*(new e.Date).getTimezoneOffset()*1e3},t.getTimezoneOffsetString=function(t){var n=null==t?(new e.Date).getTimezoneOffset():t,i=n>0?"-":"",r=(n=e.Math.abs(n))/60|0
	r<10&&(i+="0"),i+=r+":"
	var o=n%60
	return o<10&&(i+="0"),i+o},t.max=function(e,t){return e>t?e:t},t.min=function(e,t){return e<t?e:t},t.sdist=function(e,n){for(var i=function(e,t){return i[e+","+t]},r=0;r<=e.length;r++)for(var o=0;o<=n.length;o++)i[r+","+o]=r&&o?t.min(i(r-1,o-1)+(e[r-1]!=n[o-1]),1+t.min(i(r-1,o),i(r,o-1))):r||o
	return i(e.length,n.length)},t.obscureAuthHeader=function(e,t){void 0===t&&(t="Authorization")
	var i=e&&e.headers&&e.headers[t]
	try{i&&(e.headers[t]=i.replace(/\b(Bearer [a-z]+=|Bearer |cwt=|psat=)([.\w-]+)/gim,(function(e,t,i){return"_"+t+("<hash:"+(r=i).length+":"+n(r).slice(0,6)+">")
	var r})))}catch(_){i&&(e.headers[t]="<hashed>")}return e},t.decorated=function(e,t){for(var n=e.length-1;n>=0;n--){var i=e[n]
	i&&(t=i(t))}return t}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(t){var r=t.Utils.guid,o=t.Utils.extend,a=t.Utils.sha256Hash,s=t.Utils.flatten,c=t.Utils.nothrow,l=t.Utils.isFunction,u=t.Utils.isPrimitive,d=t.Utils.EnvInfo,p=function(e){return"<hash:"+e.length+":"+a(e).slice(0,6)+">"},f="ttt_trace"
	function m(e){try{return l(e)?e():e}catch(t){return{}}}var h=function(){function i(e,n,i,r,o,a){void 0===n&&(n="afe05df65cc74b958837195cd87d2ff0-e0f88ee6-25f5-49b5-ae35-25c6b40faa7f-7176"),this.telemetryManager=e,this.tenantToken=n,this.disabled=i,this.ttt_events=r,this.tzip_url=o,this.verbose=a,this.defaults={hostName:d.getHostname(),sdkVersion:t.version},this.cidProps={},this.excluded={},this.collectOII=!0,this.knownSafeReasonProperties=new RegExp("\\b(reason|[\\w\\d_]*stack|[\\w_]*code|[\\w_]*subcode|[\\w_]*message|code|[\\w_]*status|[\\w_]*statusText|[\\w_]*headers_Date|[\\w_]*headers_X_Ms_Correlation_Id)\\b","i")}return i.prototype.addCorrelationIds=function(e){if(e&&e.correlationIds){var t=0
	for(var n in e.correlationIds){var r=e.correlationIds[n]
	t<10&&r&&u(r)&&(!r.length||r.length<=128)&&(t++,this.cidProps["cid_"+n]="upn"==n?[r,1==e.dogfood?i.PIIType.NotSet:i.PIIType.Identity]:r)}}},i.prototype.checkValue=function(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e},i.prototype.addDashboardProps=function(e){e.response_status=e.reason.rsp&&e.reason.rsp.status||e.reason.response&&e.reason.response.status||e.reason.reason&&e.reason.reason.response&&e.reason.reason.response.status,e.srv_err_code=e.reason.rsp&&e.reason.rsp.data&&e.reason.rsp.data.code||e.reason.reason&&e.reason.reason.code,e.srv_err_subcode=e.reason.rsp&&e.reason.rsp.data&&e.reason.rsp.data.subcode||e.reason.subcode||e.reason.reason&&e.reason.reason.subcode,e.srv_err_msg=e.reason.rsp&&e.reason.rsp.data&&e.reason.rsp.data.message||e.reason.message||e.reason.reason&&e.reason.reason.message},i.prototype.discardInvalidProperties=function(e){for(var t in e){var n=e[t]
	Array.isArray(n)?(!this.checkValue(n[0])||n[1]&&"number"!=typeof n[1])&&delete e[t]:this.checkValue(n)||delete e[t]}},i.prototype.oiiPropertyValue=function(e){return{value:e,isOII:!0}},i.prototype.removeOIIReasonProperties=function(e){for(var t in e)this.knownSafeReasonProperties.test(t)||delete e[t]
	return e},i.prototype.removeOIIProperties=function(e){if(l(e)||u(e))return e
	for(var t in e){var n=e[t]
	n&&n.isOII?this.collectOII?e[t]=n.value:delete e[t]:n&&!u(n)&&(e[t]=this.removeOIIProperties(e[t]))}return e},i.prototype.processReason=function(e,t){var n=s(e.reason,(function(e){return e.join("_").replace(/[^\w]/gm,"_")}),(function(e){return e.stack?["stack"]:[]}))
	for(var i in!this.collectOII&&t&&(n=this.removeOIIReasonProperties(n)),delete e.reason,n)e["reason_"+i]=n[i]
	return e},i.prototype.clean=function(e){if("string"==typeof e){for(var t in e=e.replace(/\b(Bearer [a-z]+=|Bearer |cwt=|psat=)([.\w-]+)/gim,(function(e,t,n){return t+p(n)})).replace(/(?:sip(?:%3A|:))?([\w.+-]+(?:@|%40)[\w.+-]+)/gim,(function(e,t){return p(t)})),this.excluded)t.trim().length>4&&(e=e.split(t.trim()).join(p(t.trim())))
	return e}if(u(e))return e
	for(var n in e)n!=f&&(e[n]=this.clean(e[n]))
	return e},i.prototype.matches=function(e,t,n){if(!n)return!1
	for(var i in n)if(/^[_|*a-z]+$/.test(i)){var r=i.replace(/\*/g,".*")
	if(new RegExp("^("+r+")$").test(e)){var o=n[i]||[]
	e:for(var a=0,s=o instanceof Array?o:[o];a<s.length;a++){var c=s[a]
	for(var l in c){var u=c[l],d=t[l]
	if("number"==typeof u||"string"==typeof u||null===u){if(u!==d)continue e}else if(u instanceof RegExp){if(!u.test(d))continue e}else{if(!(u instanceof Array))continue e
	if(u.indexOf(d)<0)continue e}}return!0}}}return!1},i.prototype.record=function(e,n){if(void 0===n&&(n={}),this.telemetryManager||(this.telemetryManager=new v),!this.matches(e,n,this.disabled)){var i
	this.matches(e,n,this.ttt_events)&&this.send_ttt(n)
	try{n=m(n),this.removeOIIProperties(n),n.reason&&!u(n.reason)&&(n.reason.monitorFailed?(n.reason=n.reason.value,u(n.reason)||(this.addDashboardProps(n),this.processReason(n,!0))):(this.addDashboardProps(n),this.processReason(n))),this.clean(n),i=JSON.parse(_stringify(n))}catch(s){try{var r=o({},this.defaults,this.cidProps,{event:e,error:s&&s.toString(),stack:s&&s.stack&&s.stack.toString()})
	this.telemetryManager.sendEvent(this.tenantToken,t.TelemetryEvent.Error,r)}catch(s){}}var a=o({},this.defaults,this.cidProps,i)
	this.removeOIIProperties(a),this.discardInvalidProperties(a),this.telemetryManager.sendEvent(this.tenantToken,e,a)}},i.prototype.send_ttt=function(i){var r=this
	e.ttt.toJSON(this.tzip_url).then((function(e){var o,a=/sdk_ver: "(.+?)"/.exec(e)[1],s=["<!doctype html>","<html>","<head>","</head>","<script>"+e+"<\/script>",'<script src= "'+("0.0.0"==a?"/jLync/target/sdk.js":"https://latest-swx.cdn.skype.com/jLync/"+a.split(" ").reverse().join("_")+"/sdk.js")+'"><\/script>','<body><button onclick="this.disabled = true; Skype.ttt.play();">Replay</button></body>',"</html>"].join("\n")
	if("string"!=typeof i)r.record(t.TelemetryEvent.TTT,n({},i,((o={})[f]=s,o)))
	else{var c=new Blob([s],{type:"text/html"}),l=document.createElement("a")
	l.href=URL.createObjectURL(c),l.download=i+".html",l.click()}}))},i.prototype.timeout=function(e,n,i){var r=this
	void 0===i&&(i={}),i.timeout=e
	var o=t.setTimeout((function(){r.record(n,i)}),e)
	return{cancel:function(){t.clearTimeout(o)}}},i.prototype.monitored=function(e,t){var n=this
	return void 0===t&&(t={}),function(i){return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
	return n.monitor(i.apply(void 0,r),e,t)}}},i.prototype.monitor=function(e,n,i,r){var a=this
	if(void 0===i&&(i={}),void 0===r&&(r={}),e){var s,c
	if(r.sendEndEventOnly){var l=t.Date.now()
	c=function(e,r){void 0===r&&(r={})
	var s=t.Date.now()
	a.record(n,o({},m(i),r,{result:e,duration:s-l}))}}else c=this.begin(n,i)
	var u=r.timeout&&t.setTimeout((function(){c("timeout",{timeout:r.timeout,timeout_status:s})}),r.timeout)
	e.then((function(e){return c("succeeded",i)}),(function(e){return c("failed",{reason:{value:e,monitorFailed:!0}})}),(function(e){s=e})).finally((function(){u&&t.clearTimeout(u)}))}return e},i.prototype.begin=function(e,n){var i=this
	void 0===n&&(n={})
	var a=r(),s=t.Date.now(),c=o({},m(n),{traceId:a,result:"started"})
	return this.record(e,c),function(n,r){void 0===r&&(r={})
	var l=t.Date.now(),u=o({},m(r),{traceId:a,result:n,duration:l-s})
	i.record(e,o({},c,u))}},i}()
	i([c],h.prototype,"record",null),i([c],h.prototype,"send_ttt",null),i([c],h.prototype,"timeout",null),i([c],h.prototype,"monitored",null),i([c],h.prototype,"monitor",null),i([c],h.prototype,"begin",null),t.TelemetryRecorder=h,function(e){(function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPv4AddressLegacy=13]="IPv4AddressLegacy"})(e.PIIType||(e.PIIType={}))}(h=t.TelemetryRecorder||(t.TelemetryRecorder={})),t.TelemetryEvent={Activity:"activity",AudioMuteUnmuteRemoteFailed:"audio_mute_unmute_remote_failed",ApplicationChanged:"app_changed",ApplicationCreate:"create_app",ApplicationDelete:"delete_app",Call:"call",Chat:"chat",ChatMessageDecodingError:"chat_message_decoding_error",Communication:"communication",ConfAck:"conf_ack",Conversation:"conversation",ConversationExtension:"conversation_extension",ContactAdd:"contact_add",ContactManager:"contact_manager",ContactRemove:"contact_remove",ContactsAutoPopulate:"contacts_autopopulate",ContactsLoad:"contacts_load",ConvLogs:"conv_logs",CorsFailed:"cors_failed",CreateApplicationCompleted:"create_application_completed",DevicesInit:"devices_init",Endpoint:"endpoint",EndpointResume:"endpoint_resume",EndpointSuspend:"endpoint_suspend",Error:"error",EventChannel:"event_channel",GraphFetchPeople:"graph_fetch_people",GraphFetchSip:"graph_fetch_sip",GraphApiFailed:"graph_api_failed",GroupAdd:"group_add",GroupCreate:"group_create",GroupRemove:"group_remove",GroupRename:"group_rename",GroupsLoad:"groups_load",Heartbeat:"heartbeat",Meeting:"meeting",MeMakeAvailable:"me_make_available",MeSet:"me_set",OAuthCwtFailed:"oauth_cwt_failed",OAuthTimeout:"oauth_timeout",PresenceSubscribe:"presence_subscribe",PluginManager:"plugin_manager",PluginComponent:"plugin_component",ReplayMessage:"replay_message",ReportActivityStopped:"report_activity_stopped",RequestFailed:"request_failed",ScheduleMeeting:"schedule_meeting",Search:"search",SigninUseSnapshot:"signin_use_snapshot",SignIn:"signin",SignOut:"signout",Transport:"transport",TTT:"ttt_logs",UcwaUninitException:"ucwa_uninit_exception",UseAuth:"use_auth",UnmappedError:"unmapped_error",XFrameTimeout:"xframe_timeout",ClientPolicyFailed:"client_policy_failed"}
	var v=function(){function e(){this.env={},this.loggers={},this.versionString="sdk_tm_v0.1",this.browserName=d.castSWXConstToWebSDK(d.getBrowserName()),this.browserVersion=d.castSWXConstToWebSDK(d.getBrowserVersion()),this.osName=d.castSWXConstToWebSDK(d.getOsName()),this.osVersion=d.castSWXConstToWebSDK(d.getOsVersion()),this.env.telemetryManager=this.versionString,this.env.browserName=this.browserName,this.env.browserVersion=this.browserVersion,this.env.osName=this.osName,this.env.osVersion=this.osVersion}return e.prototype.sendEvent=function(e,n,i){try{0==Object.keys(this.loggers).length&&t.window.microsoft.applications.telemetry.LogManager.initialize(e),this.loggers[e]||(this.loggers[e]=new t.window.microsoft.applications.telemetry.Logger(e))
	var r=new t.window.microsoft.applications.telemetry.EventProperties
	r.name=n,this.addProperties(r,this.env),this.addProperties(r,i),this.loggers[e].logEvent(r)}catch(o){}},e.prototype.addProperties=function(e,t){for(var n in t){var i=t[n]
	Array.isArray(i)?e.setProperty(n,i[0],i[1]):e.setProperty(n,i)}},e}()})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.AutoD={"O365-Public-MT":function(e){return["https://webdir.online.lync.com/autodiscover/autodiscoverservice.svc/root?originalDomain="+e,"https://lyncdiscover."+e,"https://lyncdiscoverinternal."+e]},"O365-Public-MT-Pilot":function(e){return["https://webdir.online.lync.com/autodiscover/autodiscoverservice.svc/root?originalDomain="+e,"https://webdir.tip.lync.com/autodiscover/autodiscoverservice.svc/root?originalDomain="+e,"https://lyncdiscover."+e,"https://lyncdiscoverinternal."+e]},"O365-Public-Gallatin":function(e){return["https://webdir.lync.partners.cn/autodiscover/autodiscoverservice.svc/root?originalDomain="+e,"https://lyncdiscover."+e]}}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.Http,i=e.Utils.URI,r=e.Utils.guid,o=e.Utils.cleanwsp,a=e.Utils.Exception,s=e.Utils.XmlDoc,c=e.Utils.HttpHeaders,l=e.Utils.Base64.encode,u=function(){function e(e,t){this.ticket=e,this.expires=t}return e.prototype.toString=function(){return this.ticket},e}()
	t.WebTicket=u
	var d=function(){function t(e,t,n,i){void 0===i&&(i=""),this.root=e,this.send=t,this.context=n,this.conf_uri=i}return t.prototype.getPassiveAuthUrl=function(){var e=this
	return this.getConfigXml().then((function(e){return/\bpassiveauthpage="(.+?)"/i.exec(e)[1]})).catch((function(t){return e.root+"/PassiveAuth/PassiveAuth.aspx"}))},t.prototype.getOAuthUrl=function(){return this.getConfigXml().then((function(e){return/\bauthorizationUri="(.+?)"/i.exec(e)[1]}))},t.prototype.getWsFedPassivePath=function(){var e=this
	return this.getConfigXml().then((function(e){var t=s(e).root.selectOne("wsdl:service",{name:"WebTicketService"}).selectOne("wsdl:port",{name:"WsFedPassive"}).selectOne("soap:address")
	return new i(t.attr("location")).path()})).catch((function(t){return e.svc+"/WsFed_passive"}))},t.prototype.getOAuthPath=function(){var e=this
	return this.getConfigXml().then((function(e){var t=s(e).root.selectOne("wsdl:service",{name:"WebTicketService"}).selectOne("wsdl:port",{name:"OAuth"}).selectOne("soap:address")
	return new i(t.attr("location")).path()})).catch((function(t){return e.svc+"/OAuth"}))},t.prototype.getAnonPath=function(){var e=this
	return this.getConfigXml().then((function(e){var t=s(e).root.selectOne("wsdl:service",{name:"WebTicketService"}).selectOne("wsdl:port",{name:"WebTicketServiceAnon"}).selectOne("soap:address")
	return new i(t.attr("location")).path()})).catch((function(t){return e.svc+"/Anon"}))},t.prototype.getWebTicket=function(t,i){return this.send({type:"POST",url:t,headers:{SOAPAction:"http://docs.oasis-open.org/ws-sx/ws-trust/200512/RST/Issue","Content-Type":"text/xml; charset=utf-8"},data:i||(s={scope:this.root,conf_uri:this.conf_uri,context:this.context||r()},c=s.context,l=s.scope,d=s.conf_uri,p=void 0===d?"":d,o('\n        <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">\n            <s:Body>\n                <RequestSecurityToken xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" Context="'+c+'" xmlns="http://docs.oasis-open.org/ws-sx/ws-trust/200512">\n                    <TokenType>urn:component:Microsoft.Rtc.WebAuthentication.2010:user-cwt-1</TokenType>\n                    <RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</RequestType>\n                    <AppliesTo xmlns="http://schemas.xmlsoap.org/ws/2004/09/policy">\n                        <EndpointReference xmlns="http://www.w3.org/2005/08/addressing">\n                            <Address>'+l+"</Address>\n                        </EndpointReference>\n                    </AppliesTo>\n                    "+(p?'<Claims Dialect="urn:component:Microsoft.Rtc.WebAuthentication.2010:authclaims">\n                        <ClaimType Uri="http://schemas.microsoft.com/ws/2005/05/identity/claims/conferenceuri" Optional="false" xmlns="http://schemas.xmlsoap.org/ws/2006/12/authorization">\n                            <Value>'+p+"</Value>\n                        </ClaimType>\n                    </Claims>":"")+"\n                </RequestSecurityToken>\n            </s:Body>\n        </s:Envelope>"))}).then((function(t){if(!n.isSuccess(t.status))throw a("WsFedRequestFailed",{rsp:t})
	var i=t.responseText,r=/<(?:a:)?UserToken.*?>(.+?)<\/(?:a:)?UserToken>/i.exec(i)[1],o=/<Expires.*?>(.+?)<\/Expires>/i.exec(i)
	return new u(r,o&&new e.Date(o[1]))}))
	var s,c,l,d,p},t.prototype.getAnonWebTicket=function(e,t,n){var i=this
	return this.getAnonPath().then((function(a){var s=function(e){var t=e.context,n=e.scope,i=e.conf_uri,r=e.conf_key,a=e.cwt
	return o('\n        <s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/">\n          <s:Header>\n            <Security s:mustUnderstand="1" xmlns:u="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd">\n              <UsernameToken>\n                <Username>'+l(i)+'</Username>\n                <Password Type="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText">'+l(r)+'</Password>\n              </UsernameToken>\n            </Security>\n          </s:Header>\n          <s:Body>\n            <RequestSecurityToken xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" Context="'+t+'" xmlns="http://docs.oasis-open.org/ws-sx/ws-trust/200512">\n              <TokenType>urn:component:Microsoft.Rtc.WebAuthentication.2010:user-cwt-1</TokenType>\n              <RequestType>http://schemas.xmlsoap.org/ws/2005/02/trust/Issue</RequestType>\n              <AppliesTo xmlns="http://schemas.xmlsoap.org/ws/2004/09/policy">\n                <EndpointReference xmlns="http://www.w3.org/2005/08/addressing">\n                  <Address>'+n+'</Address>\n                </EndpointReference>\n              </AppliesTo>\n              <Claims Dialect="urn:component:Microsoft.Rtc.WebAuthentication.2010:authclaims">\n                <ClaimType Uri="http://schemas.microsoft.com/ws/2005/05/identity/claims/conferenceuri" Optional="false" xmlns="http://schemas.xmlsoap.org/ws/2006/12/authorization">\n                  <Value>'+i+"</Value>\n                </ClaimType>\n              </Claims>\n              <KeyType>http://docs.oasis-open.org/ws-sx/ws-trust/200512/SymmetricKey</KeyType>\n              "+(a?'<RenewTarget>\n                <UserToken xmlns="urn:component:Microsoft.Rtc.WebAuthentication.2010">'+a+"</UserToken>\n              </RenewTarget>":"")+"\n            </RequestSecurityToken>\n          </s:Body>\n        </s:Envelope>")}({conf_uri:e,conf_key:t,scope:i.root,cwt:n,context:i.context||r()})
	return i.getWebTicket(a,s).catch((function(e){throw e&&"WsFedRequestFailed"==e.code&&(e.cwt=n),e}))}))},t.prototype.getWebTicketServicePath=function(){var e=this,t="/WebTicket/WebTicketService.svc"
	return this.send({type:"GET",url:"/Autodiscover/AutodiscoverService.svc/root/user",timeout:3}).then((function(n){var r=c(n.headers).get("X-MS-WebTicketURL")
	e.svc=new i(r).path()||t})).catch((function(n){e.svc=t}))},t.prototype.getConfigXml=function(){var e=this
	return this.mex=this.mex||this.getWebTicketServicePath().then((function(){return e.send({type:"GET",url:e.svc+"/mex",timeout:3})})).then((function(e){if(n.isSuccess(e.status))return e.responseText
	throw a("MexRequestFailed",{response:e})}))},t}()
	t.WebTicketService=d})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.Http,i=e.Utils.bind,r=e.Utils.async,o=e.Utils.check,a=e.Utils.Exception,s=e.Utils.WWWAuthenticateHeader,c=e.Utils.HttpHeaders
	function l(n,o,a){void 0===o&&(o="Authorization"),void 0===a&&(a=!1)
	var u,d,p=r(n instanceof Function?n:i(l.get,n)),f=!1
	return function n(i,r){return u&&(i.headers||(i.headers={}),i.headers[o]=u+""),r(i).then((function l(m,h){void 0===h&&(h=!1)
	var v,g=c(m.headers),y=g.get(t.sW3A),b=g.get(t.sMSD),_=b&&b.split(";")[0]
	try{v=y&&s(y)}catch(E){v=null}return 401==m.status&&v&&v.MsRtcOAuth?f?m:(function t(){return d=d||p(r,v.MsRtcOAuth).then((function(n){u=n,f=!0,a&&n.expires&&e.setTimeout((function(){u==n&&t()}),+n.expires-e.Date.now())})).finally((function(){d=null}))}(),d.then((function(){return n(i,r)})).then((function(e){return e.webTicketRenewed=!0,e}))):401==m.status||/^(28032|28072|28077)$/.test(_)?h||f?m:r({type:"GET",url:"/Autodiscover/AutodiscoverService.svc/root/oauth/user"}).then((function(e){return i.headers&&delete i.headers[o],l(e,!0)})):(f=!1,m)}))}}t.sW3A="WWW-Authenticate",t.sMSD="X-MS-Diagnostics",t.MsRtcOAuth=l,function(e){e.get=function(e,i,r){if(r.grant_type.indexOf(e.grant_type)<0)throw function(e,t){var n="grant_type="+e+" is not in the list: ["+t.grant_type+"]"
	return a.call(n,"GrantTypeNotSupported",{grant_type:e,msra:t})}(e.grant_type,r)
	return i({type:"POST",url:r.href,data:e}).then((function(e){if(!n.isSuccess(e.status))throw a("InvalidCreds",{response:e})
	var i=JSON.parse(e.responseText)
	return o.belongs("token_type",i),o.belongs("access_token",i),new t.WebTicket(i.token_type+" "+i.access_token)}))}}(l=t.MsRtcOAuth||(t.MsRtcOAuth={}))})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.extend,i=e.Utils.random,r=e.Utils.URI,o=e.Utils.WWWAuthenticateHeader,a=e.Utils.Task,s=e.Utils.Promise,c=e.Utils.Exception,l=e.Utils.HttpHeaders
	function u(e,t){var i=t&&t.error
	return i&&t.error_description&&(i+=" ("+t.error_description+")"),c.call(i,"OAuthFailed",n({url:e},t))}function d(n){var s,u,p,f=n.xframe,m=n.client_id,h=n.oauth_uri,v=n.state,g=void 0===v?i():v,y=n.context,b=n.use_cwt,_=void 0===b||b,E=n.cwt_format,w=n.redirect_uri,S=n.tm,x=n.hostProperty,C={},T="",I=1,A="string"==typeof _?_:null
	function M(e){var n=l(e.headers),i=o(n.get(t.sW3A)).Bearer
	return i&&i.authorization_uri}var O="Authorization",k="X-MS-WebTicket"
	return function n(i,o){var l=new r(i.url).host()||new r(d.baseurl(f.src())).host()
	function v(e,t){return void 0===t&&(t=!1),C[l]&&(e.headers=e.headers||{},delete e.headers[O],delete e.headers[k],e.headers[T]=C[l],e.headers["X-Ms-SDK-Host"]=x),o(e).then((function(e){return t&&(e.webTicketRenewed=t),e}))}return a.wait(s).then((function(){return v(i)})).then((function b(N){if(!d.isAuthRequired(N))return N
	if(s)return n(i,o)
	C[l]=null,u=void 0,p=void 0,T=null
	var P=d.baseurl(f.src()),R=d.getAudience(N)||P,L=new t.WebTicketService(new r(P).path("").query("").hash("")+"",v,y,A)
	return s=a.wait(h||M(N)||L.getOAuthUrl()).catch((function(){var e=i.headers||{}
	return e.Authorization="Bearer",e["X-Ms-SDK-Host"]=x,v({type:"GET",url:"/Autodiscover/AutodiscoverService.svc/root/oauth/user",headers:e}).then((function(e){return M(e)}))})).then((function(t){if(!t)throw c("NoOAuthUri",{rsp:N,src:P})
	var n=new r(t),i=r.Query(n.query())
	return i.response_type="token",i.client_id=m,i.redirect_uri=w||P,i.resource=new r(R).path("/").query("").hash("")+"",i.state=g+"."+I++,i.prompt="none",n.query(i+""),u=new e.Date,o({type:"GET:TOKEN",url:n+""}).then((function(t){return C[l]=t.responseText,T=O,_&&L.getOAuthPath().then((function(t){return p=new e.Date,L.getWebTicket(t)})).then((function(e){A&&"Bearer"!=E?(C[l]=""+e,T=k):(C[l]="Bearer "+e,T=O)})).catch((function(e){}))}))})).finally((function(){s=null})),a.wait(s).then((function(){return v(i,!0)})).then((function(t){if(d.isAuthRequired(t)){t.token_issued=u,t.cwt_issued=p
	var n=new e.Date,i=36e5
	if(u&&+n>+u+i/2||p&&+n>+p+i/2)return S&&S.record("slow_401",{rsp:t}),b(t)}return t}))}))}}t.EOAuthFailed=u,t.OAuth=d,function(n){n.getToken=function(t,n,i){return void 0===n&&(n=e.window.location),void 0===i&&(i=e.window.document),new s((function(e,o,a){var s=new r(t.query.get("redirect_uri"))
	s.host()||t.query.set("redirect_uri",new r(n.href).path(s.path()).query("").hash("")+"")
	var c=i.createElement("iframe")
	c.style.display="none",c.src=t+"",i.body.appendChild(c),c.onload=function(){try{var n=r.Query(c.contentWindow.location.hash.slice(1))
	i.body.removeChild(c),n.error?o(u(t+"",n)):e(n.token_type+" "+n.access_token)}catch(a){}},a("GET "+t)}))},n.baseurl=function(e){var t=new r(e)
	return r.Query(t.query()).redirect_uri||e},n.audfqdn=function(e){var t=new r(e),n=r.Query(t.query()).resource
	return new r(n).host()},n.isAuthRequired=function(e){if(401==e.status)return!0
	if(500==e.status||403==e.status){var n=l(e.headers),i={code:+(n.get(t.sMSD)||"").split(";")[0]}.code
	return 28032==i||28033==i||28072==i||28077==i||28055==i||!!n.get(t.sW3A)}return!1},n.getAudience=function(e){var n=l(e.headers),i=o(n.get(t.sW3A)).Bearer
	return i&&i.audience}}(d=t.OAuth||(t.OAuth={}))})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.URI,i=e.Utils.Task,r=e.Utils.Exception
	t.ADFS=function(o){var a=o||e.window.document
	return t.MsRtcOAuth((function(e,o){var s,c,l=new n(o.href).path("")+"",u=new t.WebTicketService(l,e)
	return i.wait(0).then((function(){return i.waitAll([u.getPassiveAuthUrl().then((function(e){s=e})),u.getWsFedPassivePath().then((function(e){c=e}))])})).then((function(){var e=0,n=[]
	function r(e){return n[e]=new i("waiting for the "+e+"-th onload event from iframe at "+s),n[e].promise}var o=a.createElement("iframe")
	return o.style.display="none",o.src=s,o.onload=function(){n[++e].resolve()},a.body.appendChild(o),i.waitAny([i.wait(0).then((function(){return u.getWebTicket(c)})),r(1).then((function(){return u.getWebTicket(c)})),r(2).then((function(){return u.getWebTicket(c)}))]).then((function(e){return new t.WebTicket("Bearer "+e)})).finally((function(){a.body.removeChild(o)}))})).catch((function(e){throw s?r("NotSignedIn",{aspx:s,reason:e}):e}))}))}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.Basic=function(t,n){return e.MsRtcOAuth({grant_type:"password",username:t,password:n})}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.Integrated=function(){return e.MsRtcOAuth({grant_type:"urn:microsoft.rtc:windows"})}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.AnonMeeting=function(t,n){return e.MsRtcOAuth({grant_type:"urn:microsoft.rtc:anonmeeting",ms_rtc_conferenceuri:t,password:n||t.match(/:(\w+)$/)[1]})}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.URI
	t.AnonMeetingInternal=function(i,r){var o
	return void 0===r&&(r=i.match(/:(\w+)$/)[1]),t.MsRtcOAuth((function(a,s){var c=new n(s.href).path("")+""
	return new t.WebTicketService(c,a).getAnonWebTicket(i,r,o).then((function(t){return t.expires=t.expires&&new e.Date(+t.expires-6e5),o=t}))}),"X-MS-WebTicket",!0)}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.Token=function(e,t){return function(n,i){return n.url!=t&&(n.headers.Authorization=e),i(n)}}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.URI,i=e.Utils.Http,r=e.Utils.Task,o=e.Utils.random,a=e.Utils.Exception,s=function(){function t(t,i,r,o){void 0===i&&(i=5e3),void 0===r&&(r=e.window),void 0===o&&(o=document),this.oauthCallback=t,this.timeout=i,this._window=r,this._document=o,this.oauth_callback_origin=new n(this.oauthCallback).origin(),this.iframe=o.createElement("iframe"),this.iframe.style.display="none",this.iframe.src=t,o.body.appendChild(this.iframe),r.addEventListener?r.addEventListener("message",this.processMessage.bind(this)):r.attachEvent("onmessage",this.processMessage.bind(this))}return t.prototype.processMessage=function(e){try{if(e.origin!=this.oauth_callback_origin)return
	var t=JSON.parse(e.data)
	if(t.id!=this.requestId)return
	if(i.isSuccess(t.status)){if("GETTOKEN"===t.code)this.tRequest&&this.tRequest.resolve(t.token_type+" "+t.access_token)}else this.tRequest&&this.tRequest.reject(t.error)}catch(n){}},t.prototype.post=function(e){this.requestId=o(),e.id=this.requestId,this.iframe.contentWindow.postMessage(_stringify(e),"*")},t.prototype.getToken=function(t){var n=this
	return r.wait(this.pRequest).catch().then((function(){if(n.pRequest)return n.getToken(t)
	n.tRequest=new r,n.pRequest=n.tRequest.promise
	var i=function(r){n.post({type:"GETTOKEN",uri:t+""}),n.timerId=e.setTimeout((function(){if(!r)return i(!0)
	n.tRequest&&n.tRequest.reject(a("OAuthCallbackTimeout",{reason:{uri:t}}))}),n.timeout)}
	return i(!1),n.pRequest.then((function(t){return e.clearTimeout(n.timerId),{status:200,responseText:t}})).finally((function(){n.tRequest=null,n.pRequest=null,e.clearTimeout(n.timerId)}))}))},t.prototype.reset=function(){try{this.iframe&&(this._document.body.removeChild(this.iframe),this.iframe.onload=null,this.iframe=null,e.clearTimeout(this.timerId))}catch(_){}},t}()
	t.OAuthTokenRetriever=s})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t="SkypeWebSDK";(function(n){var i=function(){function n(n,i){this.path=n,this.storage=i
	try{this.storage||(this.storage=e.sessionStorage)}catch(_){}this.key=[t].concat(this.path).join("//")}return Object.defineProperty(n.prototype,"json",{get:function(){var e=this.storage.getItem(this.key)
	return e&&JSON.parse(e)},set:function(e){this.storage.setItem(this.key,_stringify(e))},enumerable:!0,configurable:!0}),n.prototype.remove=function(){this.storage.removeItem(this.key)},n}()
	n.StorageItem=i})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.map,i=e.Utils.pick,r=e.Utils.clone,o=e.Utils.assert,a=e.Utils.extend,s=e.Utils.foreach,c=e.Utils.isArray,l=e.Utils.isEmptyObject,u=e.Utils.Event,d=e.Utils.Exception,p=e.Utils.Collection,f=e.Utils.BoolProperty
	function m(e,t){var n=e.rel+"/"+t+" link does not exist"
	return d.call(n,"LinkMissing",{resource:i(e,["rel","href"]),rel:t})}var h=function e(t){var h,v,g,y={toString:function(e){void 0===e&&(e=4)
	var t=I()
	for(var n in l(w)||(t._embedded={}),w){var i=void 0,r=void 0
	e:for(i in t._links){var o=t._links[i]
	if(c(o)){for(r=0;r<o.length;r++)if(o[r].href==n)break e}else if(o.href==n){r=0
	break}}var a=JSON.parse(w[n]+"")
	a.rel||delete a.rel,t._embedded=t._embedded||{},t._embedded[i]=t._embedded[i]||[],t._embedded[i].push(a),c(t._links[i])&&t._links[i].splice(r,1),c(t._links[i])&&t._links[i].length||delete t._links[i]}for(var s in t._embedded)1==t._embedded[s].length&&(t._embedded[s]=t._embedded[s][0])
	return _stringify(t,null,e).replace(/{\s*\n\s*("href"):\s*(".+?")\s*\n\s*}/gm,"{ $1: $2 }")}},b=f(!1),_=!1,E={},w={},S={},x=p(),C=new u({added:function(e){e()}}),T=new u({added:function(e){_&&e()}})
	function I(e){var t={rel:h,_links:{}}
	for(var n in S)t[n]=S[n]
	for(var n in E)if("self"==n||!e||e(n)){var i=E[n]
	i.length>0&&(t._links[n]=i.length>1?i:i[0])}return r(t)}function A(e,t){var n=E[e]||[]
	if(!t)return n.length>0
	for(var i=0;i<n.length;i++)if(n[i].href==t)return!0
	return!1}return arguments.length>1&&(t={rel:arguments[1],_links:{self:{href:arguments[0]}}},arguments[2]>1&&(g=arguments[2],t._links.self.revision=g)),function(){try{v=t._links.self.href}catch(d){throw m(t,"self")}for(var n in t._links){var i=t._links[n]
	c(i)||(i=[i]),E[n]=i}if(t._embedded)for(var r in t._embedded){var o=t._embedded[r]
	c(o)||(o=[o])
	for(var a=0,s=o;a<s.length;a++){var l=new e(s[a])
	l.rel=l.rel||r,"mediaRelay"==l.rel&&l.href==v&&(l.href+="/"+l.properties.host+"/"+l.properties.location),w[l.href]=l,E[r]||(E[r]=[]),A(r,l.href)||E[r].push({href:l.href})}}for(var u in t)S[u]=t[u]
	delete S.rel,delete S._links,delete S._embedded}(),h=t.rel||null,g=t._links.self.revision,a(y,{href:v,rel:h,revision:g,memberships:x,properties:S,related:E,embedded:w,remove:function(e){_||(_=!0,T.fire(e))},updateFrom:function(t){o(y.href==t.href),y.related=E=r(t.related),y.properties=S=r(t.properties),y.embedded=w=n(t.embedded,(function(t){return new e(t.getSnapshot())})),b(!1),C.fire()},relatedHref:function(e){var t=E[e]
	if(t)return t[0].href},updated:C.observer,deleted:T.observer,forEachLink:function(e){s(E,(function(t,n){s(t,(function(t){w[t.href]||e(t,n)}))})),s(w,(function(t){t.forEachLink(e)}))},getSnapshot:I,dirty:b,addLink:function(e,t){return A(e,t)||(E[e]||(E[e]=[]),E[e].push({href:t}),C.fire()),y},removeLink:function(e,t){var n=E[e]
	if(n)for(var i=0;i<n.length;i++)if(n[i].href==t){n.splice(i,1),C.fire()
	break}return y},hasLink:A,link:function(e){var t=E[e]
	if(!t||0==t.length)throw m(y,e)
	if(t.length>1)throw function(e,t){var n="one "+e.rel+"/"+t+" link expected, "+e.links(t).length+" found"
	return d.call(n,"SingleLinkExpected",{resource:i(e,["rel","href"]),rel:t})}(y,e)
	return t[0]},links:function(e){return E[e]||[]},has:function(e){return"href"==e||e in S},set:function(e,t){return S[e]=t,C.fire(),y},get:function(e,t){if(!e)return r(S)
	if("href"==e)return v
	if(e in S)return S[e]
	if(1==arguments.length)throw function(e,t){var n=e.rel+"."+t+" property does not exist"
	return d.call(n,"AttrMissing",{resource:i(e,["rel","href"]),name:t})}(y,e)
	return t}})}
	t.Resource=h})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.extend,i=e.Utils.foreach,r=e.Utils.isFunction,o=function(){function e(t){if(void 0===t&&(t={}),!(this instanceof e))return new e(t)
	n(this,t)}return e.prototype.toString=function(){var e=[]
	return i(this,(function(t,n){"resource"==n?t&&e.push('    "resource": '+t):r(t)||e.push('    "'+n+'": '+_stringify(t))})),"{\n"+e.reverse().join(",\n")+"\n}"},e}()
	t.ResourceEvent=o})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.map,i=e.Utils.clone,r=e.Utils.assert,o=e.Utils.extend,a=e.Utils.values,s=e.Utils.filter,c=e.Utils.foreach,l=e.Utils.indexOf,u=e.Utils.isArray,d=e.Utils.isString,p=e.Utils.isFunction,f=e.Utils.isNotEmptyString,m=e.Utils.Event,h=function(e){var u=void 0===e?{}:e,d=u.connection,h=u.snapshot,v={toString:S},g=new m({added:function(e){return e()}}),y={},b={}
	function _(e,n){if(void 0===n&&(n=!1),e.links||(e=new t.Resource(e)),e.rel&&e.href){var i,o,a,s,c,u=!y[e.href]
	for(o in g.fire(),u&&(e.isLink=n,y[e.href]=e,n&&e.dirty(!0),b[e.rel]||(b[e.rel]=[]),b[e.rel].push(e.href)),e.related)for(s=0;s<e.related[o].length;s++)i=(a=e.related[o][s]).href,y[i]||e.embedded[i]||_(new t.Resource(i,o,a.revision),!0)
	for(i in e.embedded)_(e.embedded[i])
	u||n||(y[e.href].updateFrom(e),y[e.href].isLink&&y[e.href].rel!=e.rel&&(c=b[y[e.href].rel],r(c),c.splice(l(c,e.href),1),0==c.length&&delete b[y[e.href].rel],b[e.rel]||(b[e.rel]=[]),b[e.rel].push(e.href),y[e.href].rel=e.rel))}}function E(e,t){r(f(e))
	var n=y[e]
	if(n){var i=b[n.rel]
	i.splice(l(i,e),1),delete y[e],n.remove(t),g.fire()}}function w(e){var t=p(e)?s(b,(function(t,n){return e(n)})):b
	return n(t,(function(t){return n(t,(function(t){var n=y[t].getSnapshot(e)
	return delete n.rel,n}))}))}function S(e){return _stringify(w(),null,e)}return d&&(d.event((function(e){var n=e.type,i=e.sender,r=e.target,o=e.in
	_(new t.Resource(i.href,i.rel),!0),e.resource?(_(e.resource),e.resource=y[e.resource.href]):(_(new t.Resource(r.href,r.rel),!0),"updated"==n&&y[r.href].dirty(!0)),o&&(_(new t.Resource(o.href,o.rel),!0),"added"==n&&(y[o.href].addLink(r.rel,r.href),y[r.href].memberships(o.href)||y[r.href].memberships.add(y[o.href],o.href)),"deleted"==n&&(y[o.href].removeLink(r.rel,r.href),y[r.href].memberships(o.href)&&y[r.href].memberships.remove(o.href))),"deleted"!=n&&"completed"!=n||o||E(r.href,e.reason)})),d.connected.when(!1,(function(){c(y,(function(e){"me"==e.rel&&E(e.href)}))}))),h&&c(h,(function(e,n){c(e,(function(e){(e=i(e)).rel=n,_(new t.Resource(e))}))})),o(v,{put:_,get:function(e){if(r(f(e)),y[e])return[y[e]]
	if(b[e]){for(var t=[],n=0,i=b[e];n<i.length;n++){var o=i[n]
	t.push(y[o])}return t}return[]},find:function(e){return a(s(y,e))},remove:E,updated:g.observer,getSnapshot:w,toString:S})}
	t.Repository=h,function(e){e.expandSnapshot=function(e){return e=i(e),c(e,(function(t,n){u(t)||(e[n]=t=[t]),c(t,(function(e,n){d(e)&&(t[n]=e={_links:{self:{href:e}}})}))})),e}}(h=t.Repository||(t.Repository={}))})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.check
	t.EventCollection=function(e){for(var i=[],r=0,o=e;r<o.length;r++)for(var a=o[r],s=0,c=a.events;s<c.length;s++){var l=c[s],u=null
	if(l._embedded)for(var d in l._embedded)n(!u,"Only one resource is expected in _embedded"),n(!u,"AlreadyExists",{item:"embedded resource",resource:l}),(u=new t.Resource(l._embedded[d])).rel=u.rel||d
	var p={resource:u,sender:{rel:a.rel,href:a.href},target:l.link}
	for(var f in l)p[f]=l[f]
	delete p._embedded,delete p.link,i.push(new t.ResourceEvent(p))}return i}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.Event,i=e.Utils.Property,r=e.Utils.Exception,o=e.Utils.BoolProperty,a=function a(s,c,l){var u,d=new n,p=new n,f=o(),m=i()
	return u={channelId:0,timeout:void 0,status:m.asReadOnly(),connect:function(n,i){var o=++u.channelId;(function n(i,h,v,g){t.logRequest("%c -> p-GET","color:red;font-weight:bold",i,"channelId="+o),l&&l.verbose&&l.record(e.TelemetryEvent.EventChannel,{action:v,instance:h,source:g,url:i,channelId:o}),s.ajax({type:"GET",url:i,instanceId:h,query:{timeout:u.timeout},channel:o,resend:u.timeout&&1.2*u.timeout,priority:1e4}).then((function(a){if(o==u.channelId){if(a.hasLink("next"))n(a.link("next").href,h)
	else if(a.hasLink("resume"))n(a.link("resume").href,h,"resume",i)
	else{if(!a.hasLink("resync"))throw r("NextEventLinkMissing",{resource:a,debug:a.debug})
	n(a.link("resync").href,h,"resync",i)}f(!0)
	try{(function(e,n){for(var i={},r=t.EventCollection(e||[]),o=0,a=r;o<a.length;o++){var s=a[o],c=s+""
	i[c]||(i[c]=!0,n&&s&&Object.defineProperty(s,"debug",{value:n}),d.fire(s))}})(a.properties.sender,a.debug)}catch(s){t.logModel("notifyListenersError:","instance="+h,"source="+g,"target="+i,"channelId="+o,"reason="+s),l&&l.verbose&&l.record(e.TelemetryEvent.EventChannel,{action:"notifyListenersError",instance:h,source:g,target:i,channelId:o,reason:s}),p.fire(s)}}})).catch((function(n){t.logModel("pGetError:","instance="+h,"source="+g,"target="+i,"channelId="+o,"selfChannelId="+u.channelId,"reason="+n),l&&l.verbose&&l.record(e.TelemetryEvent.EventChannel,{action:"pGetError",instance:h,source:g,target:i,channelId:o,selfChannelId:u.channelId,reason:n}),o==u.channelId&&(a.is409Error(n)?c(!0,n):t.Endpoint.is410Error(n)||f(!1,n))})).then(null,null,(function(e){m(e)}))})(n,i)},connected:f.asReadOnly(),error:p.observer,event:d.observer}}
	t.EventChannel=a,function(e){e.is409=function(e){return e&&409==e.status&&e.data&&"PGetReplaced"==e.data.subcode},e.is409Error=function(t){return t&&"RequestFailed"==t.code&&e.is409(t.rsp)}}(a=t.EventChannel||(t.EventChannel={}))})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.guid,i=e.Utils.assert,r=e.Utils.foreach,o=e.Utils.isVoid,a=e.Utils.isString,s=e.Utils.isDictionary,c=(e.Utils.Http,e.Utils.HttpHeaders)
	function l(e){var t=function(e){var t=c(e.headers)
	return s(e.data)&&t.add("Content-Type","application/json"),t.add("Host","Host"),t+""}(e),n=function(e){return o(e.data)||"GET"==e.type?"":a(e.data)?e.data+"":s(e.data)?_stringify(e.data):e.data+""}(e),i=function(e){var t=""
	return"GET"==e.type&&r(e.data||{},(function(e,n){t+=(t?"&":"?")+n+"="+e})),e.url+t}(e)
	return e.type+" "+i+" HTTP/1.1\r\n"+t+n}var u=function(){function e(e){this.url=e}return e.prototype.compose=function(e){var t=n(),i=function(e,t){for(var n=[],i=0,r=e;i<r.length;i++){var o=l(r[i])
	n.push("--"+t),n.push("Content-Type: application/http; msgtype=request"),n.push(""),n.push(o)}return n.join("\r\n")+"\r\n--"+t+"--\r\n"}(e,t),r=function(e){for(var t,n=0,i=e;n<i.length;n++){var r=i[n];(r.priority>t||void 0===t)&&(t=r.priority)}return t}(e)
	return{type:"POST",priority:r,url:this.url,data:i,headers:{"Content-Type":"multipart/batching;boundary="+t,Accept:"multipart/batching"}}},e.prototype.parse=function(e){var t=c(e.headers).get("Content-Type").match(/boundary="(.*?)"/i)[1],n=e.responseText.split("--"+t)
	i(n.length>2),i("--\r\n"==n[n.length-1])
	for(var r,o,a,s,l=[],u=0,d=n.slice(1,-1);u<d.length;u++){var p=d[u]
	try{var f=(o=void 0,a=void 0,s=void 0,o=(r=(r=p).substring(2,r.length-2)).indexOf("\r\n\r\n"),a=r.indexOf("\r\n",o+4),s=r.indexOf("\r\n\r\n",o+4),i(o>0&&a>0&&s>0),{outer:r.substring(0,o),status:r.substring(o+4,a),inner:r.substring(a+2,s),body:r.substring(s+4)}),m=+f.status.match(/(\d{3})/)[1]
	i(m>=0),l.push({status:m,headers:c.parse(f.inner),responseText:f.body})}catch(h){l.push({status:417,headers:{},responseText:h+""})}}return l},e}()
	t.Batch=u})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.async,i=e.Utils.random,r=e.Utils.foreach,o=e.Utils.URI,a=e.Utils.Task,s=e.Utils.Property,c=e.Utils.Exception,l=e.Utils.HttpHeaders,u=e.Auth.EOAuthFailed
	var d=function(t,d,p,f){var m,h=t||e.window,v=h.document,g={},y={},b={},E={},w={},S=s({set:function(t){if("https"!=new o(t).scheme())throw function(e){var t="Insecure resource at "+e+" cannot be loaded."
	return c.call(t,"MixedContent",{url:e})}(t)
	S._set(t)
	var i=d&&d.timeout(5e3,e.TelemetryEvent.XFrameTimeout,{url:t})
	return n(x)(t).then((function(){return i&&i.cancel(),t}))}})
	function x(t){var n="ucwa-"+i(),r=new a("iframe at "+t),o=new a("xframe at "+t)
	return m&&!y[m.id]&&M(m.id),(m=v.createElement("iframe")).style.display="none",m.title=(new e.Date).toJSON(),m.src=t,m.id=n,m.onload=function(){r&&(r.resolve(),r=null),this.contentWindow?C(this,{type:"PING",url:"/"}):o.reject()},v.body.appendChild(m),g[n]=m,y[n]=0,b[n]=r,E[n]=o,o.promise}function C(e,t,n){t.messageId=n||e.id+":"+i(),e.contentWindow.postMessage(_stringify(t),"*")}function T(e){var t=e.split(":")[0]
	delete w[e],y[t]--,t==m.id||y[t]||M(t)}function I(e){try{var t=JSON.parse(e.data),n=t.messageId,i=n.split(":")[0],r=w[n]
	if(r&&(T(n),delete t.messageId,t.headers=l.parse(t.headers||""),r.resolve(t)),E[i]){if(t.oauth2&&t.oauth2.error)E[i].reject(u(S(),t.oauth2))
	else{var o=t.headers||{}
	o.Authorization=null,o["X-Ms-SDK-Host"]=f,C(g[i],{type:"GET",url:"/ucwa/oauth",headers:o}),E[i].resolve()}E[i]=null}}catch(_){return}}function A(e){try{v.body.removeChild(e)}catch(t){}}function M(e){A(g[e]),delete g[e],delete y[e],delete b[e],delete E[e]}return h.addEventListener?h.addEventListener("message",I):h.attachEvent("onmessage",I),{src:S,send:n((function(e){var t=m
	if(!t)throw c("NoTarget")
	var n=t.id+":"+i(),r=new a({cancel:function(e){T(n),r.reject(e)}})
	return w[n]=r,y[t.id]++,e.headers||(e.headers={}),e.headers["X-Ms-SDK-Host"]||(e.headers["X-Ms-SDK-Host"]=f),b[t.id].promise.then((function(){var i=e.type+" "+e.url,o=e.headers&&e.headers["Client-Request-Id"]
	o&&(i+=" creqid:"+o),r.status(i),C(t,e,n)}),null,r.status),r.promise})),reset:function(){var e=c("Reset")
	function t(t){try{t.reject(e)}catch(n){}}r(b,t),r(E,t),r(w,t),r(g,A),m&&(m.onload=null),m=null,y={},b={},E={},w={}}}}
	t.XFrame=d})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.URI,i=e.Utils.Promise,r=e.Utils.Property,o=e.Utils.HttpHeaders,a=e.Utils.debug,s=function(){function s(e,t,n,i){this.XHR=e,this.tm=t,this.creds=n,this.hostProperty=i,this.src=r()}return s.prototype.reset=function(){},s.prototype.send=function(r){var s=this
	return new i((function(i,c,l){var u=new n(r.url)
	if(s.tm&&s.tm.verbose&&a.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"xhr_enter"),s.tm.record(e.TelemetryEvent.Endpoint,{action:"xhr_enter",host:u.host(),src:s.src()})),!u.host()){if(!s.src())throw Error("The target FQDN must be set to send relative requests.")
	var d=new n(s.src())
	u.scheme(d.scheme()).host(d.host()).port(d.port()),r.url=u+""}r.headers=r.headers||{},r.headers["X-Ms-SDK-Host"]||(r.headers["X-Ms-SDK-Host"]=s.hostProperty),r.headers.Accept||(r.headers.Accept="*/*"),r.data&&"string"!=typeof r.data&&(r.data=n.Query(r.data)+"",r.headers["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8"),"GET"==r.type&&r.data&&(r.url=/^[^#]*/.exec(r.url)[0],r.url+=(r.url.indexOf("?")<0?"?":"&")+r.data,delete r.data)
	var p=new(s.XHR||e.XMLHttpRequest)
	for(var f in s.tm&&s.tm.verbose&&a.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"xhr_open"),s.tm.record(e.TelemetryEvent.Endpoint,{action:"xhr_open"})),p.open(r.type,r.url,!0),r.headers)p.setRequestHeader(f,r.headers[f]+"")
	!1!==s.creds&&(p.withCredentials=r.creds),p.onreadystatechange=function(){s.tm&&s.tm.verbose&&a.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"xhr_readystatechange:","readyState="+p.readyState,"status="+p.status,"statusText="+p.statusText,"responseText="+p.responseText),s.tm.record(e.TelemetryEvent.Endpoint,{action:"xhr_readystatechange",readyState:p.readyState,status:p.status,type:r.type,url:r.url})),4==p.readyState&&(!p.status&&s.tm&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"xhr_cors_failed"),s.tm.record(e.TelemetryEvent.CorsFailed,{type:r.type,url:r.url,withCreds:r.creds})),i({status:1223==p.status?204:p.status,statusText:p.statusText,headers:o.parse(p.getAllResponseHeaders()),responseText:p.responseText}))}
	var m=r.headers&&r.headers["X-MS-Correlation-Id"],h=r.headers&&r.headers["Client-Request-Id"]
	l(r.type+" "+r.url+" "+m+"/"+h),s.tm&&s.tm.verbose&&a.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"xhr_send"),s.tm.record(e.TelemetryEvent.Endpoint,{action:"xhr_send"})),p.send(r.data||null)}))},s}()
	t.XHR=s})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.debug,i=e.Utils.sleep,r=e.Utils.throttle,o=e.Utils.removeAll,a=e.Utils.repeatAndExit,s=e.Utils.Exception,c=e.Utils.HttpHeaders
	function l(e,t,n,r){return function(o){var s=t()
	return a((function(t){return e(o).then((function(e){if(e.status!=n||r&&!r(e))throw t(e)
	var o=s()
	if(o>=0)return i(o)
	throw t(e)}))}))}}var u=function(a,u){var d=void 0===u?{}:u,p=d.tm,f=d.buffer,m=d.version,h=d.session,v=(d.hostProperty,d.fmax),g=d.fmin,y=void 0===g?Math.pow(2,-64):g,b=d.delay,_=void 0===b?[]:b,E=d.retry,w=d.now,S=void 0===w?function(){return e.Date.now()}:w
	return{ajax:new e.Identity((function(e){return a.send(e)})).map((function(i){return function(r){p&&p.verbose&&n.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"transport_send"),p.record(e.TelemetryEvent.Transport,{action:"send",url:r.url}))
	var o=i(r),a=r.timeout
	if(a>0){var c=e.setTimeout((function(){var i=s("RequestTimeout",{request:r})
	p&&p.verbose&&n.logVerbose(r)&&(t.logRequest("%c -> "+r.url,"color:red;font-weight:bold","transport_timeout","timeout="+a),p.record(e.TelemetryEvent.Transport,{action:"timeout",timeout:a}))
	try{o.cancel(i)}catch(i){}}),1e3*a|0)
	o.finally((function(){e.clearTimeout(c)}))}return o}})).map((function(r){if(!v)return r
	var a={},s=0
	return function c(l){var u=S(),d=(u-s)/1e3
	for(var f in p&&p.verbose&&n.logVerbose(l)&&(t.logRequest("%c -> "+l.url,"color:red;font-weight:bold","transport_fmax_enter","fmax="+v,"fmin="+y,_stringify(a)),p.record(e.TelemetryEvent.Transport,{action:"fmax_enter",fmax:v,fmin:y,url:l.url})),a)a[f]/=Math.pow(2,d)
	o(a,(function(e){return e<y})),s=u
	var m,h=l.type+" "+l.url,g=a[h]||0
	if(p&&p.verbose&&n.logVerbose(l)&&(t.logRequest("%c -> "+h,"color:red;font-weight:bold","transport_fmax_process","fmax="+v,"fmin="+y,"freq="+g,_stringify(a)),p.record(e.TelemetryEvent.Transport,{action:"fmax_process",fmax:v,url:l.url,freq:g})),g+1>v){var b=(m=g/(v-1),e.Math.log(m)/e.Math.log(2))
	return p&&p.verbose&&n.logVerbose(l)&&(t.logRequest("%c -> "+h,"color:red;font-weight:bold","transport_fmax_sleep","delay="+b),p.record(e.TelemetryEvent.Transport,{action:"fmax_sleep",fmax:v,url:l.url,delay:b})),i(b).then((function(){return c(l)}))}return a[h]=g+1,p&&p.verbose&&n.logVerbose(l)&&(t.logRequest("%c -> "+h,"color:red;font-weight:bold","transport_fmax_send","freq="+a[h]),p.record(e.TelemetryEvent.Transport,{action:"fmax_send",fmax:v,url:l.url,freq:a[h]})),r(l)}})).map((function(e){return function(t){return t.headers=t.headers||{},m&&(t.headers["X-Ms-SDK-Version"]=m),h&&(t.headers["X-Ms-SDK-Session"]=h),e(t)}})).map((function(i){if(!f)return i
	var o=r(i,f,p)
	return function(i){return p&&p.verbose&&n.logVerbose(i)&&(t.logRequest("%c -> "+i.type,"color:red;font-weight:bold",i.url,"transport_throttle("+f+")"),p.record(e.TelemetryEvent.Transport,{action:"throttle",buffer:f,priority:i.priority,url:i.url})),o(i,i.priority)}})).map((function(e){return _[0]?l(e,_[0],0):e})).map((function(e){return _[404]?l(e,_[404],404,(function(e){var t=e.headers||{}
	return!/^application\/.+/.test(t["Content-Type"])&&(t.Server||t["X-Ms-Server-Fqdn"])})):e})).map((function(e){return _[502]?l(e,_[502],502,(function(e){return!e.headers||/^application\/.*(json|xml)/.test(c(e.headers).get("Content-Type"))})):e})).map((function(e){return _[503]?l(e,_[503],503):e})).map((function(t){return E&&null===E[483]?t:l(t,(function(){var t=1,n=3,i=e.Date.now()
	return function(){if((t*=1.5)>=900&&(t=900,--n<1))throw s("Recurring483",{duration:e.Date.now()-i})
	return t}}),483)})).map((function(e){if(!E)return e
	var t=function(e){return function(){var t=0
	return function(){return e[t++]}}}
	for(var n in E)e=l(e,t(E[n]),n)
	return e})).value}}
	t.Transport=u})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={}));(function(e){(function(e){(function(t){var n=e.Utils.map,i=e.Utils.async,r=e.Utils.repeatAndExit,o=e.Utils.Task,a=e.Utils.Exception
	function s(e,t,n){var i="UCWA not found on "+e
	return a.call(i,"DiscoveryFailed",{response:t,root:e,reason:n})}t.AutoDiscovery=function(e){var a=e.domain,c=e.origins,l=e.Transport||t.Transport,u=e.XFrame||t.XFrame,d=e.xframe,p=e.hostProperty
	function f(e){var n=e.internal,i=e.xframe,o=e.origin,a=new u(void 0,void 0,void 0,p),c=new l(a,{hostProperty:p})
	return a.src(i),c.ajax({type:"GET",url:o}).then((function(e){var i
	try{i=new t.Resource(JSON.parse(e.responseText))}catch(l){throw s(o,e,l)}return r((function(e){return i.hasLink("redirect")?(a.src(i.link("xframe").href),c.ajax({type:"GET",url:i.link("redirect").href}).then((function(e){try{i=new t.Resource(JSON.parse(e.responseText))}catch(l){throw s(o,e,l)}}))):e()})).then((function(){return i.rel=i.rel||"root",i.set("internal",n),i.hasLink("xframe")?a.src(i.link("xframe").href):i.addLink("xframe",a.src()),i}))})).finally((function(){a.reset()}))}return{root:(c||((c=[]).push({internal:!0,origin:"https://lyncdiscoverinternal."+a,xframe:"https://lyncdiscoverinternal."+a+"/xframe"}),c.push({internal:!1,origin:"https://lyncdiscover."+a,xframe:"https://lyncdiscover."+a+"/xframe"}),c.push({internal:!0,origin:"http://lyncdiscoverinternal."+a,xframe:"http://lyncdiscoverinternal."+a+"/xframe"}),c.push({internal:!1,origin:"http://lyncdiscover."+a,xframe:"http://lyncdiscover."+a+"/xframe"})),o.waitAny(n(c,i(f)))).then((function(e){return d.src(e.link("xframe").href),e}))}}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))})(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.HttpHeaders
	t.parseMultipartResources=function(e){for(var i=[],r={},o=0,a=e;o<a.length;o++){var s=a[o],c=s.responseText,l=n(s.headers),u=l.get("Content-ID"),d=l.get("Content-Type")
	u?r["cid:"+u]={data:c,mime:d.replace(/\s/g,"")}:i.push(new t.Resource(JSON.parse(c)))}for(var p=0,f=i;p<f.length;p++){f[p].forEachLink((function(e){var t=r[e.href]
	t&&(e.href="data:"+t.mime+","+t.data)}))}return i}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.check,i=e.Utils.Exception,r=e.Utils.HttpHeaders,o=e.Utils.ContentTypeHeader,a=/(\r\n|\n){2}/,s=/^(\r\n|\n)/,c=/(\r\n|\n)$/,l=/--\s*$/
	t.parseMultipartRelatedResponse=function(e){try{var t=o(r(e.headers).get("Content-Type"))
	n.equals(t.mimeType,"multipart/related"),n.belongs("boundary",t.attributes)
	var u=e.responseText.split("--"+t.attributes.boundary)
	return n(l.test(u[u.length-1])),n(u.length>=3),u.slice(1,-1).map((function(e,t){var n=a.exec(e)
	if(!n)throw i("SingleHeaderExpected",{part:e,index:t})
	var r=e.substr(0,n.index),o=e.substr(n.index+n[0].length)
	return{headers:r.replace(s,""),responseText:o.replace(c,"")}}))}catch(d){throw i("InvalidMultipartRelatedResponse",{response:e,reason:d})}}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.keys,i=e.Utils.check,r=e.Utils.filter,o=e.Utils.values,a=e.Utils.isObject
	t.parseAutodiscoverResource=function(e){var s=r(e,a)
	i(1==o(s).length,"single root expected")
	var c=n(s)[0],l=s[c],u=r(l.Links,(function(e){return"Self"==e.token}))
	i(1==u.length,"single self href expected")
	for(var d=u[0].href,p=new t.Resource(d,c.toLowerCase()),f=0,m=l.Links;f<m.length;f++){var h=m[f]
	h.href!=d&&p.addLink(h.token.toLowerCase(),h.href)}return p}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.map,i=e.Utils.bind,r=e.Utils.guid,o=e.Utils.pick,a=e.Utils.async,s=e.Utils.clone,c=e.Utils.debug,l=e.Utils.sleep,u=e.Utils.assert,d=e.Utils.foreach,p=e.Utils.isObject,f=e.Utils.isString,m=e.Utils.debounced,h=e.Utils.getOption,v=e.Utils.obscureAuthHeader,g=e.Utils.URI,y=e.Utils.Http,b=e.Utils.Task,E=e.Utils.Event,w=e.Utils.Property,S=e.Utils.Exception,x=e.Utils.HttpHeaders
	function C(e,t){var n=e.type+" "+e.url+" failed: "+(t.statusText||t.status)
	return e&&(delete(e=s(e)).data,e=v(e)),S.call(n,"RequestFailed",{req:e,rsp:t})}t.ERequestFailed=C
	var T=function v(T){var I=new E,A=T.transport,M=T.batchRetryDelay||3,O=a(T.auth),k=T.restore&&m(T.restore),N=T.replace&&m(T.replace),P=h(T,"enableInternalNS",!0),R=T.tm,L=T.user,D=T.anon,U=e.Date.now()
	L&&L.isActive.changed((function(){return U=e.Date.now()}))
	var F,B,V=!1,G=w({value:!1,set:function(t,n){return t?(R&&R.record(e.TelemetryEvent.EndpointSuspend,{reason:n}),u(!F),B=new b(n+""),(F=B.promise).finally((function(){F=null,B=null})),!0):(R&&R.record(e.TelemetryEvent.EndpointResume,{reason:n}),u(F),F=null,V=!0,B.from(N()).then((function(){return V=!1,!1})))}}),H=m((function(){var n=e.Date.now()-U
	if(D||L&&L.isActive()||L&&n<L.inactivityTimeout||L&&-1==L.inactivityTimeout)return t.logModel("endpoint_restore:","anon="+!!D,"isActive="+L&&L.isActive(),"inactiveDuration="+n,"inactiveTimeout="+L&&L.inactivityTimeout),R&&R.verbose&&R.record(e.TelemetryEvent.Endpoint,{action:"restore",anon:!!D,isActive:L&&L.isActive(),inactiveDuration:n,inactivityTimeout:L&&L.inactivityTimeout}),k()
	var i=r()
	return t.logModel("endpoint_suspend:","anon="+!!D,"isActive="+L&&L.isActive(),"inactiveDuration="+n,"inactiveTimeout="+L&&L.inactivityTimeout,"suspensionId="+i),R&&R.verbose&&R.record(e.TelemetryEvent.Endpoint,{action:"suspend",anon:!!D,isActive:L&&L.isActive(),inactiveDuration:n,inactivityTimeout:L&&L.inactivityTimeout,suspensionId:i}),G(!0,S("UserInactive",{inactiveDuration:n,inactivityTimeout:L&&L.inactivityTimeout,suspensionId:i})),F.then((function(){R&&R.record(e.TelemetryEvent.Endpoint,{action:"resumed",reason:"useractive",suspensionId:i})}))}))
	function q(e){e.url=g.mergeQuery(e.url,e.query),e.headers||(e.headers={}),e.headers.Accept="application/json",e.version>1&&(e.headers["X-MS-RequiresMinResourceVersion"]=e.version),f(e.data)?e.headers["Content-Type"]=e.headers["Content-Type"]||"text/plain":p(e.data)&&("POST"!=e.type&&"PUT"!=e.type||("PUT"==e.type&&(e.headers["If-Match"]='"'+e.data.etag+'"'),e.data=_stringify(e.data),e.headers["Content-Type"]="application/json"))}function W(e){try{e.data=JSON.parse(e.responseText)}catch(_){}}function j(e,n){u(n)
	var i,r,a=x(n.headers)
	if(W(n),y.isSuccess(n.status)){if(n.responseText){try{i=n.data,r="application/vnd.microsoft.rtc.autodiscover+json; v=1"==a.get("Content-Type")?t.parseAutodiscoverResource(i):new t.Resource(i)}catch(_){i=t.parseMultipartRelatedResponse(n),r=t.parseMultipartResources(i)[0]}return Object.defineProperty(r,"debug",{value:{rsp:n&&o(n,["status","statusText","headers"])}}),r}return new t.Resource(a.get("Location"),null)}throw C(e,n)}var z=new e.Identity(a(A.ajax)).map((function(n){return function(i){R&&R.verbose&&c.logVerbose(i)&&(t.logRequest("%c -> "+i.type,"color:red;font-weight:bold",i.url,"endpoint_sendBatch"),R.record(e.TelemetryEvent.Endpoint,{action:"sendBatch"})),i.headers=i.headers||{},P&&(i.headers["X-Ms-Namespace"]="internal")
	var r=(2147483648*e.Math.random()|0)+""
	return i.headers["X-MS-Correlation-Id"]=r,i.headers["Client-Request-Id"]="WebSDK/"+r,n(i)}})).map((function(e){return function(t){return O(t,e).then((function(e){return e.webTicketRenewed&&I.fire(t,e),e}))}})).map((function(e){return function(t){return e(t).then((function(e){return W(e),e}))}})).map((function(t){return R?function(n){return t(n).then((function(t){return"POST"==n.type&&/\/applications$/.test(n.url)&&R&&R.record(e.TelemetryEvent.CreateApplicationCompleted,{status:t.status,reason:{rsp:t&&o(t,["status","statusText","headers","data.endpointId","data.id","data.type","data._links.events.href"])}}),t.status>=400&&R&&R.verbose&&R.record(e.TelemetryEvent.Endpoint,{action:"logFQDN",url:n&&n.url,status:t.status,statusText:t.statusText,responseText:t.responseText,fqdn:t.headers&&t.headers["X-Ms-Server-Fqdn"],correlationId:t.headers&&t.headers["X-Ms-Correlation-Id"]}),t}))}:t})).map((function(n){return function i(r){return R&&R.verbose&&c.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"endpoint_sendWhenResumed"),R.record(e.TelemetryEvent.Endpoint,{action:"sendWhenResumed",suspended:G(),resumed:!!F,resuming:V})),F?F.then((function(){return i(r)})):n(r).then((function(e){return v.is404(e)?V&&r.instanceId?e:(R&&R.record("apps_404",{reason:{req:r,rsp:e}}),H().then((function(t){return r.instanceId&&r.channel?e:n(r)}),(function(e){if(!v.is410Error(e))throw e
	if(G(!0,e),r.instanceId)throw e
	return i(r)}))):e}))}})).value,K=new e.Identity(z).map((function(n){return function(r){return R&&R.verbose&&c.logVerbose(r)&&(t.logRequest("%c -> "+r.type,"color:red;font-weight:bold",r.url,"endpoint_prepare"),R.record(e.TelemetryEvent.Endpoint,{action:"prepare"})),q(r),n(r).then(i(j,r))}})).map((function(t){return function(n){var i=t(n)
	if(!n.resend)return i
	var r=new b,o=!1,a=e.setTimeout((function(){o=!0,(n=s(n)).resent=1,t(n).then((function(e){return r.resolve(e)}),(function(e){return r.reject(e)}),(function(e){return r.status(e)}))}),1e3*n.resend|0)
	return i.finally((function(){return e.clearTimeout(a)})).then((function(e){return!o&&r.resolve(e)}),(function(e){return!o&&r.reject(e)}),(function(e){return!o&&r.status(e)})),r.promise}})).value
	return{suspended:G,renewed:I.observer,ajax:K,batch:function e(t,i){d(i,q)
	var r=t.compose(i)
	return z(r).then((function(o){if(429==o.status)return l(M).then((function(){return e(t,i)}))
	if(!y.isSuccess(o.status))throw C(r,o)
	return function(e,t,i){var r=e.parse(i)
	return u(t.length==r.length),n(t,a((function(e,n){return j(t[n],r[n])})))}(t,i,o)}))}}}
	t.Endpoint=T,function(e){e.is404=function(e){return e&&404==e.status&&e.data&&"ApplicationNotFound"==e.data.subcode},e.is410=function(e){return e&&410==e.status&&e.data&&"LimitExceeded"==e.data.subcode},e.is410Error=function(t){return t&&"RequestFailed"==t.code&&e.is410(t.rsp)}}(T=t.Endpoint||(t.Endpoint={}))})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.guid,i=e.Utils.async,a=e.Utils.random,s=e.Utils.batched,c=e.Utils.URI,l=e.Utils.Task,u=e.Utils.Promise,d=e.Utils.Exception,p=e.Utils.BoolProperty,f=e.Utils.ConstProperty,m=function(m){var h,v,g=m.repository,y=m.xframe,b=m.endpoint,_=m.connection,E=m.maxBatchSize||0,w=m.name,S=m.anon,x=w?void 0:m.id||n(),C=m.appType,T=m.dwiid,I="Desktop"==C?T&&m.id&&n():m.id&&n(),A=m.version,M=m.culture,O=m.supportsWebRtc,k=m.root,N=m.tm,P=!1,R=!1,L=!0,D=m.lock,U=m.imdn,F=m.ecws,B=m.cors,V=p(!1),G=null==m.soac||m.soac
	function H(e){var t=new c(e)
	return"http"==t.scheme()?t.scheme("https")+"":e}m=null
	var q=function(){if(P)throw d("AppIsDeleted")
	var n=w?g.get("anonApplications")[0]:g.get("applications")[0],i=(I||U)&&n.revision>=2?2:1
	return l.run((function(){if(S){var e=new c(y.src()),t=new c(n.href)
	return e.host()!=t.host()?y.src(t.path("/xframe")+""):void 0}})).then((function(){var t=b.ajax({type:"POST",url:n.href,version:i,creds:B&&!S,data:{AnonymousDisplayName:w,RemoteEventChannel:F||void 0,UserAgent:A,Culture:M,EndpointId:x,InstanceId:i>=2?I:void 0,webRtcCapability:O?"Supported":void 0,EnableImdn:U,type:C}})
	return N&&N.monitor(t,e.TelemetryEvent.ApplicationCreate,{anon:!!w,href:n.href,version:i},{sendEndEventOnly:!0}),t})).then((function(t){return v=t.href,!L&&G&&function(t){if(g.get("application").length>0){var n=new c(g.get("application")[0].href).path(),i=new c(t.href).path()
	if(n!=i){var r=d("HrefChanged",{old:n,new:i,rsp:t.debug&&t.debug.rsp})
	throw N&&N.record(e.TelemetryEvent.ApplicationChanged,{reason:r}),V(!0,r),r}}}(t),g.put(t),t})).catch((function(e){throw t.Endpoint.is410Error(e)&&K(),e}))}
	function W(){return _&&_.channelId++,q().then(z)}function j(){return b.ajax({type:"GET",url:g.get("application")[0].href,creds:B&&!S,instanceId:I,headers:{"X-Ms-Get-App":a(),"If-None-Match":'"'+a()+'"'}}).then((function(e){return g.put(e),v=e.href,e}))}function z(e){R=!0,e.hasLink("batch")&&!h&&(h=new t.Batch(e.link("batch").href)),e.hasLink("events")&&_&&_.connect(e.link("events").href,I)}function K(){var e=g.get("application")[0]
	e&&g.remove(e.href)
	var t=g.get("events")[0]
	t&&g.remove(t.href)}function Y(e){return b.ajax(e).then((function(e){return g.put(e),e.href&&g.get(e.href)[0]||e}))}function Q(e){return 1!=e.length&&h&&E?b.batch(h,e).then((function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t]
	l.wait(i).then(g.put)}return e})):l.wait(e.map(Y))}return b.renewed((function(){1==g.get("application").length&&j()})),{ajax:new e.Identity(i(Y)).map((function(e){var t=E?s(i(Q),E):e
	return function(n){return n.priority=n.priority||0,n.nobatch?e(n):t(n,n.priority)}})).map((function(e){var t={}
	return function(n){if("GET"!=n.type)return e(n)
	var i=_stringify(n)
	return t[i]=t[i]||e(n).finally((function(){return delete t[i]})),t[i]}})).value,id:f(x),restore:W,replace:function(){return I=n(),K(),W()},remove:function(){P=!0
	var t=b.ajax({type:"DELETE",url:v,nobatch:!0}).then((function(){}))
	return N&&N.monitor(t,e.TelemetryEvent.ApplicationDelete,{href:v},{sendEndEventOnly:!0}),t},ready:function(e){return l.wait(e).then((function(e){var t=D.synchronized(q)
	if(e)return g.put(e),function(e){return r(this,void 0,u,(function(){var t,n
	return o(this,(function(i){switch(i.label){case 0:return[4,b.ajax({type:"GET",url:e.link("user").href})]
	case 1:return t=i.sent(),(w?t.hasLink("anonApplications"):t.hasLink("applications"))?[3,7]:[4,b.ajax({type:"GET",url:e.link("user").href,headers:{Accept:"application/vnd.microsoft.rtc.autodiscover+json; v=1"}})]
	case 2:(n=i.sent()).rel=n.rel||"user",n.hasLink("xframe")&&y.src(H(n.link("xframe").href)),i.label=3
	case 3:return n.hasLink("redirect")?[4,b.ajax({type:"GET",url:H(n.link("redirect").href)})]:[3,5]
	case 4:return(n=i.sent()).rel=n.rel||"redirect",n.hasLink("xframe")&&y.src(n.link("xframe").href),[3,3]
	case 5:return[4,b.ajax({type:"GET",url:n.link("user").href})]
	case 6:t=i.sent(),i.label=7
	case 7:return t.rel=t.rel||"user",g.put(t),t.hasLink("xframe")&&y.src(t.link("xframe").href),[2,t]}}))}))}(e).then((function(){return t()}))
	var n=g.get("application")[0]
	return n?(I=n.get("instanceId",I),j()):t()})).then((function(e){L=!1,!R&&z(e)}))}(k),invalid:V.asReadOnly(),removeEventChannel:function(){if(g.get("events").length>0){var e=g.get("events")[0]
	e&&g.remove(e.href),g.get("application").length>0&&g.get("application")[0].removeLink("events",e.href)}if(g.get("reportMyActivity").length>0){var t=g.get("reportMyActivity")[0]
	t&&g.remove(t.href)}}}}
	t.Application=m})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.find,i=e.Utils.clone,r=e.Utils.random,o=e.Utils.URI,a=e.Utils.Exception,s=e.Auth.OAuth,c=e.Auth.OAuthTokenRetriever,l=function(e,t){var l=t.location,u=t.window,d=t.document,p=t.xframector,f=t.cors,m=t.tm,h=t.get_oauth_token,v=t.oauth_cb,g=t.oauth_cb_timeout,y=t.hostProperty,b={}
	b[r()]=e
	var _=v&&new c(v,g,u,d)
	return{reset:function(){_&&_.reset()},send:function(t){if("GET:TOKEN"==t.type){var c=new o(t.url)
	if(v)return _.getToken(c)
	if(h){var u=c.query.get("resource")
	return h(u).then((function(e){return{status:200,responseText:e}}),(function(e){throw m&&m.record("get_oauth_token",{result:"failed",resource:u,url:t.url,reason:e}),a("GetOAuthTokenFailed",{reason:e})}))}if(f)return s.getToken(c,l,d).then((function(e){return{status:200,responseText:e}}))
	var g=s.audfqdn(t.url),E=n(b,(function(e){return s.audfqdn(e.src())==g}))||n(b,(function(e){return new o(s.baseurl(e.src())).host()==g}))||new p(void 0,m,void 0,y)
	return E.src.set(c+"").then((function(){var e=t.headers||{}
	if(e.Authorization=null,e["X-Ms-SDK-Host"]=y,new o(s.baseurl(E.src())).host()!=g)return E.send({type:"GET",url:"/ucwa/oauth",headers:e})})).then((function(){var e=r()
	return b[e]=E,{status:200,responseText:e}}))}var w=n(b,(function(e,n){return t.headers&&t.headers.Authorization==n}))
	return w&&delete(t=i(t)).headers.Authorization,(w||e).send(t)}}}
	t.OAuthTokenIssuer=l})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.URI,i=e.Utils.Task,r=e.Utils.Http,o=e.Utils.isString,a=e.Utils.Exception,s=function(s){var c,l,u=s.ms_graph_uri,d=s.azure_graph_uri,p=s.graph_oauth_uri,f=s.get_oauth_token,m=s.client_id,h=s.redirect_uri,v=s.tm,g=s.xframector,y=s.xframe_uri_for_graph,b=s.location,_=s.document,E=s.hostProperty,w=s.oauth_uri,S=new n(p)
	S.query.set("response_type","token"),S.query.set("client_id",m),S.query.set("prompt","none")
	var x={}
	function C(r,s,l,u){if(void 0===u&&(u={}),!r)throw a("NoGraphUri")
	if(!p)throw a("NoGraphOAuthUri")
	var d=new n(r)
	for(var m in d.path(d.path()+l),u)d.query.set(m,u[m])
	function C(e){return i.run((function(){if(!c)return(c=new g(void 0,v,void 0,E)).src.set(y)})).then((function(){return c.send({type:s,headers:{Authorization:o(e)?e:void 0},url:d+""})}))}var T=new n(r).path("").query("").hash("")+""
	return C(x[T]).then((function(n){return 401==n.status?(delete x[T],function(n){return S.query.set("resource",n),S.query.set("redirect_uri",h||e.Auth.OAuth.baseurl(c.src())),f?f(n):h?e.Auth.OAuth.getToken(S,b,_):c.src.set(S+"").then((function(){var e={type:"GET",url:"/ucwa/oauth",headers:{Authorization:"Bearer","X-Ms-SDK-Host":E}}
	return w&&(e.data={ucwa_oauth_uri:w}),c.send(e)})).then((function(e){if(e&&e.oauth2)throw t.ERequestFailed({url:w},e)}))}(T).then((function(e){return x[T]=e,C(e)}))):n}))}return{getSipProxyAddress:function(){return i.run((function(){return l||C(d,"GET","/me").then((function(e){if(!r.isSuccess(e.status))throw t.ERequestFailed({url:"/me"},e)
	return l=JSON.parse(e.responseText).sipProxyAddress}))})).catch((function(t){throw v&&v.record(e.TelemetryEvent.GraphFetchSip,{result:"failed",reason:t}),t}))},getTopNContacts:function(n){return i.run((function(){return C(u,"GET","/me/people",{$top:n,$select:"displayName,scoredEmailAddresses,personType"}).then((function(e){if(!r.isSuccess(e.status))throw t.ERequestFailed({url:"/me/people"},e)
	return JSON.parse(e.responseText).value}))})).catch((function(t){throw v&&v.record(e.TelemetryEvent.GraphFetchPeople,{result:"failed",reason:t}),t}))},reset:function(){c&&c.reset()}}}
	t.Graph=s})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.logHttp=e.ls.logs.get(),t.logMode=/\blm=ut\b/.test(e.window.location&&e.window.location.hash)?"ut":null,t.logPrefix=void 0===e.ls.pref.get()||!!e.ls.pref.get()})(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.version,r=e.Utils.all,o=e.Utils.hash,a=e.Utils.async,s=e.Utils.clone,c=e.Utils.debug,l=e.Utils.assert,u=e.Utils.extend,d=e.Utils.random,p=e.Utils.batched,f=e.Utils.isObject,m=e.Utils.isString,h=e.Utils.getOption,v=e.Utils.isFunction,g=e.Utils.URI,y=e.Utils.Task,b=e.Utils.Event,E=e.Utils.Symbol,w=e.Utils.XmlDoc,S=e.Utils.Property,x=e.Utils.SyncLock,C=e.Utils.Exception,T=e.Utils.BoolProperty,I=e.Utils.SourcedProperty,A=E("GET")
	var M=function(){function i(n){void 0===n&&(n={}),this.eEvent=new b,this.eRestored=new b,this.pConnected=T(!1),this.pECStatus=S(),this.event=this.eEvent.observer,this.restored=this.eRestored.observer,this.connected=this.pConnected.asReadOnly(),this.ecstatus=this.pECStatus.asReadOnly(),this.suspended=I(),this.nReq=0,this.tInit=new y,this.pAppDeleted=T(!1),this.appDeleted=this.pAppDeleted.asReadOnly(),this.tm=n.tm,("ut"==e.Settings.logMode||n.logs)&&(this.logs=u([],{size:0,maxsize:"ut"==e.Settings.logMode?1/0:n.logs.size||Math.pow(2,20)})),e.Settings.logHttp&&t.initConsoleFormatters()}return Object.defineProperty(i.prototype,"fqdn",{get:function(){var e=this._repository.get("applications")[0].href
	return new g(e).host()},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"app",{get:function(){return this.get("application")},enumerable:!0,configurable:!0}),i.prototype.init=function(e){return e&&("pending"!=this.tInit.state()&&(this.tInit=new y),l(!this.pInit),this.connect(e)),this.tInit.promise},i.prototype.uninit=function(t){try{this.pInit&&this.pInit.cancel(t),this._xframe&&this._xframe.reset(),this.pInit=null,this.tInit=new y,this._xframe=null,this._repository=null,this._application=null,this._uninit_reason=t}catch(n){throw this.tm&&this.tm.record(e.TelemetryEvent.UcwaUninitException,{reason:n}),n}},i.prototype.removeEventChannel=function(){try{this._application.removeEventChannel()}catch(t){throw this.tm&&this.tm.record(e.TelemetryEvent.UcwaUninitException,{reason:t}),t}},i.prototype.deleteApp=function(e){var t=this
	return this._application.remove().then((function(){t.pAppDeleted(!0,e)
	try{t.ssItem.remove()}catch(n){}}))},i.prototype.deleteAppTemp=function(){return this._application.remove()},i.prototype.send=function(t,n,i){var r=this,o=m(n)?n:this.get(n).href,a=++this.nReq,c=u(s(i||{}),{type:t,url:o}),l=e.Settings.logHttp&&g.mergeQuery(o,c.query)
	if("ut"==e.Settings.logMode){if(O("req["+a+'] = ucwa.request("'+t+" "+l+'");'),c.data){var d=_stringify(c.data,null,4)
	O("assert.equal(req["+a+"].data, "+d+");")}}else{var p=[]
	p.push(l),i&&i.query&&p.push(i.query),c.data&&p.push(_stringify(c.data)),O.apply(void 0,["%c -> "+a+" "+t,"color:blue;font-weight:bold"].concat(p))}if(!this._application)throw C("AppUninitialized")
	var f=this._application.ajax(c)
	return f.then((function(n){if("ut"==e.Settings.logMode)O("//",t,l),O("req["+a+"].resolve("+(n.href?n+"":"")+");")
	else{var i=[]
	if(i.push(l),n.href){var r=JSON.parse(n+"")
	delete r.userName,delete r.password,i.push(r)}O.apply(void 0,["%c <- "+a+" "+t,"color:green;font-weight:bold"].concat(i))}}),(function(n){var i=n&&n.rsp||{}
	if("ut"==e.Settings.logMode){var s=_stringify(i,null,4)
	O("req["+a+"].reject("+s+");")}else O("%c <- "+a+" "+t,"color:red;font-weight:bold",l,i.status,i.statusText),O(n)
	r.tm&&r.tm.record(e.TelemetryEvent.RequestFailed,{req:c,type:t,url:o,reason:n})})),f},i.prototype.get=function(e,t){var n=this.find(e)
	if(!n||n.length<1){if(null===t)return null
	throw C("ResourceNotFound",{selector:e})}if(n.length>1)throw C("AmbiguousResource",{selector:e})
	return n[0]},i.prototype.find=function(e){if(!this._repository)throw C("Disconnected",{reason:this._uninit_reason})
	return v(e)?this._repository.find(e):this._repository.get(m(e)?e:e.rel)},i.prototype.exists=function(e){return this.find(e).length>0},i.prototype.getSnapshot=function(e){var t=this._repository.getSnapshot(e),n=new g(t.applications[0]._links.self.href).path("/xframe").query("").hash("").toString()
	return t.xframe=[{_links:{self:{href:n}}}],t},i.prototype.getRevisionOf=function(e){var t=this,n=e.link("self")
	return y.run((function(){return+n.revision||e[A]||(e[A]=t.send("GET",e.href))})).then((function(){return+n.revision||1}))},i.prototype.wait=function(e){var t=this,n=e.resource,i=e.target,o=e.type,a=e.status,s=e.sender
	var c=new y(i.rel+" "+o,{mode:"sync",cancel:function(e){t.event.off(l),c.reject(e)}})
	function l(e){(function(e){var t=e.resource,c=e.target,l=e.type,u=e.status,d=e.sender
	return!(l!=o||a&&a!=u||c.rel!=i.rel||i.href&&c.href!=i.href||v(n)&&!n(t)||f(n)&&!r(n,(function(e,n){return t.has(n)&&t.get(n)==e}))||v(s)&&!s(d)||s&&s.rel&&d.rel!=s.rel||s&&s.href&&d.href!=s.href)})(e)&&(t.event.off(l),c.resolve(e))}return t.event(l),c.promise},i.prototype.observe=function(e,t){var n=/^(\w+) (\w+)$/.exec(e),i=n[1],r=n[2]
	return this.event((function(e){e.type==r&&e.target.rel==i&&t(e)}))},i.prototype.connect=function(i){var r=this,s=i.events,c=i.auth,u=i.id,f=o(_stringify(i,(function(e,t){return/^(window|document|location)$/.test(e)?void 0:t}))),b=i.client_id,E=i.redirect_uri,S=i.oauth_uri,T=i.state,I=i.use_cwt,A=i.cwt_format,M=i.username,O=i.password,k=i.token,N="https://graph.microsoft.com/v1.0",P=i.azure_graph_uri||"https://graph.windows.net?api-version=1.6",R=i.graph_oauth_uri||"https://login.microsoftonline.com/common/oauth2/authorize",L=i.xframe_uri_for_graph||"https://webdir.online.lync.com/xframe",D=i.name,U=i.domain,F=i.origins,B=i.meeting,V=i.conf_key,G=i.join_url,H=i.join_url_mode,q=i.xmscwt,W=i.root,j=i.snapshot,z=new RegExp(i.ssrels||"root|xframe|applications?"),K=i.culture||"en-us",Y="SkypeWeb/"+n+(i.version?" "+i.version:""),Q=i.supportsWebRtc,X=h(i,"throttle",5),$=!!i.enableInternalNS,J=i.cors,Z=i.XFrame||(J?t.XHR:t.XFrame),ee=i.window,te=i.document,ne=i.location,ie=h(i,"batchRetryDelay",5),re=function(e,t,n){var i=h(e,t,n)
	return i<=n?i:n}(i,"maxBatchSize",20),oe=!B&&!G&&!!u&&null!==j,ae=d(),se=new x("CreateApp"),ce=i.user,le=i.retry,ue=i.ecws,de=i.appType,pe="Desktop"!=de&&i.withCreds,fe=!!D&&J&&!!W&&!!k,me=!c&&i.get_oauth_token&&v(i.get_oauth_token)&&a(i.get_oauth_token),he=i.hostProperty,ve=i.soac,ge=i.dwiid,ye=i.eopd,be=i.oauth_cb,_e=i.oauth_cb_t,Ee=i.imdn,we=i.defaultDelay
	this.ssItem=new t.StorageItem(["Snapshot",f]),this.pAppDeleted(!1)
	var Se=i.delay000||function(){return function(){return J?we:3}},xe=i.delay502||function(){var e=0
	return function(){if(30*e++>900)throw C("MaxRetryDelayReached")
	return 30}},Ce=i.delay404||function(){var e=1
	return function(){if(e>3600)throw C("MaxRetryDelayReached")
	return e*=2}},Te=i.delay503||function(){var e=1
	return function(){if(e>600)throw C("MaxRetryDelayReached")
	return e*=1.5}}
	if(J&&(void 0===I&&(I=!1),void 0===E&&(E="/"+b+"/oauth2/token")),m(F)){if(!U)throw new Error("`domain` is required when `origins` is an env name")
	F=t.AutoD[F](U),U=null}try{oe&&!j&&(j=this.ssItem.json)}catch(ke){}var Ie=function(e,t){var n=new g(S||"https://login.windows.net/common/oauth2/authorize")
	return n.query.set("response_type","token"),n.query.set("client_id",b),n.query.set("prompt","none"),n.query.set("resource",e),n.query.set("redirect_uri",t),n},Ae=function(n){var o=new Z(void 0,r.tm,pe,he),a=new t.OAuthTokenIssuer(o,{cors:J,tm:r.tm,xframector:Z,window:ee,document:te,location:ne,get_oauth_token:me,oauth_cb:be,oauth_cb_timeout:_e,hostProperty:he})
	function d(e,t){if(!J){var n=new g(e)
	n.path("/autodiscover/xframe/xframe.html").query("").hash(""),o.src(n+"")}return o.send({type:"GET",url:e,headers:{Accept:"Application/vnd.microsoft.lync.meeting+"+(t?"json":"xml")+";ver=14"}}).then((function(n){var i,r=t?JSON.parse(n.responseText):w(n.responseText).root,o=function(e){return t?r[e.replace(/-/g,"")]:r.selectOne(e).text()},a=t&&o("redirect")
	if(a)return d(a,t)
	B=o("conf-uri").trim(),V=o("conf-key").trim()
	try{i=o("ucwa-public-url").trim()}catch(_){i=o("ucwa-url"),!q&&i.indexOf("/ucwa/oauth/")<0&&(i=i.replace("/ucwa/","/ucwa/oauth/"))}j={applications:i,"ms:rtc:saas:discover":{conferenceId:B,conferenceKey:V,_links:{self:{href:e}}}}}))}return y.run((function(){if(G)return d(G,"json"==H)})).then((function(){if(j&&!(j=t.Repository.expandSnapshot(j)).xframe){var d=(j.applications||j.user)[0]._links.self.href
	j.xframe=[{_links:{self:{href:""+new g(d).path("/xframe").query("")}}}]}var f,h
	if(m(n)&&(n.indexOf("://")<0&&(n="https://"+n+"/Autodiscover/AutodiscoverService.svc/root"),n={origin:n}),n&&!n.xframe&&(n.xframe=new g(n.origin).path("/xframe").query("").hash("")+""),j)r.tm&&r.tm.record(e.TelemetryEvent.SigninUseSnapshot),o.src(j.xframe[0]._links.self.href)
	else if(W)l(W.user,"root.user URL is missing"),W.xframe=W.xframe||new g(W.user).path("/xframe").query("")+"",o.src(W.xframe),f=new t.Resource("//root","root").addLink("user",W.user).addLink("xframe",W.xframe).set("internal",!!W.internal)
	else{if(!U&&!(U=M?M.match(/@(.+?)$/)[1]:B?B.match(/@(.+?);/)[1]:null)&&!n)throw C("NoFQDN")
	f=t.AutoDiscovery({XFrame:Z,xframe:o,domain:U,hostProperty:he,origins:n&&[n]}).root}h=v(c)?c.bind(o):k?e.Auth.Token(k,fe&&W.user):O?e.Auth.Basic(M,O):B?q?e.Auth.AnonMeetingInternal(B,V):e.Auth.AnonMeeting(B,V):b?e.Auth.OAuth({xframe:o,client_id:b,oauth_uri:S,state:T,use_cwt:I,cwt_format:A,tm:r.tm,redirect_uri:be||E,hostProperty:he}):"passive"==c||I?e.Auth.ADFS():e.Auth.Integrated()
	var y=a.send.bind(a),_=new t.Transport({send:y},{fmax:!e.isUnitTested&&3,tm:r.tm,buffer:X,retry:le,version:Y,session:ae,hostProperty:he,delay:{0:Se,503:Te,502:xe,404:Ce}}),w=new t.Endpoint({tm:r.tm,batchRetryDelay:ie,transport:_,auth:h,enableInternalNS:$,user:ce,anon:!!D||!!B,replace:function(){return H.replace()},restore:function(){return H.restore().then((function(){r.eRestored.fire()}))}}),x=!1===s?null:new t.EventChannel(w,w.suspended,r.tm)
	s&&"object"==typeof s&&(x.timeout=s.timeout),i=null
	var F=new t.Repository({snapshot:j,connection:x}),H=new t.Application({tm:r.tm,maxBatchSize:re,xframe:o,endpoint:w,repository:F,connection:x,imdn:Ee,root:f,name:G?void 0:D,anon:!!D||!!B,id:u,ecws:ue,culture:K,version:Y,supportsWebRtc:Q,lock:se,appType:de,cors:J,soac:ve,dwiid:ge})
	return H.ready.then((function(){if(x&&x.event((function(t){var n=t.in,i=t.target.rel+" "+t.type+(n?" in "+n.rel:"")
	"ut"==e.Settings.logMode?(r.logEvent("// "+i),r.logEvent("ucwa.fire("+t+");")):e.Settings.customFmt?r.logEvent(JSON.parse(t+"")):r.logEvent("%c "+i,"color:magenta;font-weight:bold",JSON.parse(t+"")),r.eEvent.fire(t)})),x&&(x.connected.changed(r.pConnected),x.status.changed(r.pECStatus)),oe){var i=p((function(){try{var e=r.getSnapshot((function(e){return z.test(e)}))
	r.pAppDeleted()||(r.ssItem.json=e)}catch(ke){}}))
	F.updated(i)}var a
	if(r.suspended.setSource(w.suspended),r._xframe=o,r._repository=F,r._application=H,r._application.invalid.once(!0,(function(e){r.deleteApp(e)})),!J){var s=e.Utils.find(F.get("user"),(function(e){return e.hasLink("xframe")}))
	if(s){var c=new g(s.href).origin(),l=s.link("xframe").href
	a=Ie(c,l)+""}else if(j){l=j.xframe[0]._links.self.href,c=new g(l).origin()
	a=Ie(c,l)+""}}r.graph=new t.Graph({client_id:b,get_oauth_token:me,ms_graph_uri:n&&n.graph_uri||N,azure_graph_uri:n&&n.azure_graph_uri||P,graph_oauth_uri:n&&n.graph_oauth_uri||R,redirect_uri:E,tm:r.tm,xframector:Z,xframe_uri_for_graph:L,oauth_uri:a,location:ne,document:te,hostProperty:he})}))})).catch((function(e){throw o.reset(),a.reset(),e}))},Me=function(e){if(ye&&!j&&!W){var n
	if(m(e)&&(e={origin:e}),e&&!e.xframe&&(e.xframe=new g(e.origin).path("/xframe").query("").hash("")+""),!J&&e){var i=new g(e.origin).origin()
	n=Ie(i,e.xframe)+""}var o=new t.Graph({client_id:b,get_oauth_token:me,ms_graph_uri:e&&e.graph_uri||N,azure_graph_uri:e&&e.azure_graph_uri||P,graph_oauth_uri:e&&e.graph_oauth_uri||R,redirect_uri:E,tm:r.tm,xframector:Z,xframe_uri_for_graph:e&&e.xframe||L,oauth_uri:n,location:ne,document:te,hostProperty:he}),a=o.getSipProxyAddress()
	a.finally((function(){return o.reset()}))
	for(var s=[],c=function(e){s.push(a.then((function(t){return Ae(e+t.split("@")[1])})))},l=0,u=["https://lyncdiscover.","https://lyncdiscoverinternal."];l<u.length;l++){c(u[l])}return s}},Oe=function(e){for(var t=[],n=0,i=j||!e?[null]:e;n<i.length;n++){var r=i[n]
	t.push.apply(t,Me(r)),t.push(Ae(r))}return t}
	this.pInit=y.waitAny(Oe(F)).catch((function(e){if(j&&(t.Endpoint.is410Error(e)||F&&e&&"RequestFailed"==e.code&&e.req.headers&&e.req.headers["X-Ms-Get-App"]&&/^(404|502)$/.test(e.rsp.status)))return j=null,y.waitAny(Oe(F))
	throw e})).finally((function(){r.pInit=null})),this.pInit.then((function(e){return r.tInit.resolve(e)}),(function(e){return r.tInit.reject(e)}),this.tInit.status)},i.prototype.logEvent=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
	e.Settings.logPrefix?c.log.apply(c,[e.Settings.logHttp,"[EVENT] "].concat(t)):c.log.apply(c,[e.Settings.logHttp].concat(t))},i}()
	function O(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
	e.Settings.logPrefix?c.log.apply(c,[e.Settings.logHttp,"[REQUEST] "].concat(t)):c.log.apply(c,[e.Settings.logHttp].concat(t))}i([a],M.prototype,"init",null),i([a],M.prototype,"send",null),t.UCWA=M,t.logRequest=O,t.logModel=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n]
	e.Settings.logPrefix?c.log.apply(c,[e.Settings.logModel,"[MODEL] "].concat(t)):c.log.apply(c,[e.Settings.logModel].concat(t))}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){t.customFmt=void 0===e.ls.cfmt.get()||e.ls.cfmt.get()})(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=function(e){return e&&e.rel&&e._links},i=function(e){return e&&e.type&&e.sender&&e.target}
	function r(e){var t={}
	for(var n in e)/^(rel|_links|_embedded)$/.test(n)||(t[n]=e[n])
	var i=[]
	for(var n in t){var r=t[n]
	i.push(["span",{},n]),i.push(["span",{},": "]),null==r?i.push(["span",{style:"color:lightgray"},r]):i.push(["span",{},["object",{object:r}]]),i.push(["span",{},", "])}return i.pop(),i}var o=!1
	t.initConsoleFormatters=function(){if(!o){o=!0
	var t=e.window.devtoolsFormatters=e.window.devtoolsFormatters||[]
	t.push({header:function(t){if(e.Settings.customFmt&&n(t)){var i=r(t)
	return["div",{style:"font-style:italic"},["span",{style:"font-weight:bold"},t.rel],["span",{}," {"]].concat(i,[["span",{},"}"]])}},hasBody:function(e){return n(e)},body:function(e){return["span",{},_stringify(e,null,2)]}}),t.push({header:function(t){if(e.Settings.customFmt&&i(t)){var n=t.in,o=t.target.rel+" "+t.type+(n?" in "+n.rel:""),a=r(t.resource||{})
	return["div",{style:"font-style:italic"},["span",{style:"font-weight:bold;color:magenta"},o],["span",{}," {"]].concat(a,[["span",{},"}"]])}},hasBody:function(e){return i(e)},body:function(e){return["span",{},_stringify(e,null,2)]}})}}})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.Internal=e})(e.Stack||(e.Stack={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.logModel=!1,e.mediaAgent=null})(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.debug,i=e.Utils.extend,r=e.Utils.Exception,o=e.Utils.Symbol
	t.EInvitationFailed=function(e,t){void 0===t&&(t={})
	var n=e&&e.message
	return r.call(n,"InvitationFailed",i({reason:e},t))},function(e){(function(e){e.Disconnected="Disconnected",e.Disconnecting="Disconnecting",e.Connecting="Connecting",e.Ringing="Ringing",e.Connected="Connected",e.Notified="Notified",e.Created="Created"})(e.State||(e.State={}))}(t.Modality||(t.Modality={})),t.sHref=o("href"),t.sInternal=o("internal"),t.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i]
	n.log.apply(n,[e.Settings.logModel,"[MODEL] "].concat(t))},t.watch=function(t,i){n.watch(e.Settings.logModel,"[MODEL] "+t,i)}})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.singleton,i=e.Utils.Enum
	t.UserAgent=n((function(){var t=i("Unknown","Windows","Mac","Linux","Mobile"),n=i("Unknown","Win32","Wow64","Win64"),r=i("IE","Other"),o=r.Other,a=n.Unknown,s=t.Unknown,c=!1
	function l(){if(!c){var i=e.window.navigator.userAgent.toLowerCase(),l=e.window.navigator.platform?e.window.navigator.platform.toLowerCase():"";(i.match(/msie \d+\.\d+/)||i.match(/trident\/\d+\.\d+/)&&i.match(/\brv:\d+\.\d+/))&&(o=r.IE),i.match(/wow64/)?a=n.Wow64:l.match(/win64/)||i.match(/win64/)?a=n.Win64:l.match(/win32/)&&(a=n.Win32),i.match(/mobi/)?s=t.Mobile:i.match(/windows nt/)||a!=n.Unknown?s=t.Windows:l.match(/mac/)||i.match(/macintosh/)?s=t.Mac:(l.match(/linux/)||i.match(/linux/))&&(s=t.Linux),c=!0}}function u(){return l(),o==r.IE}return l(),{isIE:u,isSupportedIE:function(){return u()&&document.documentMode},isWindows:function(){return l(),s==t.Windows},isMac:function(){return l(),s==t.Mac},is64bit:function(){return l(),a==n.Win64},is32bit:function(){return l(),a==n.Win32||a==n.Wow64},reset:function(){o=r.Other,a=n.Unknown,s=t.Unknown,c=!1}}}))})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.assert,i=e.Utils.isVoid,r=e.Utils.Event,o=e.Utils.Property,a=e.Utils.Exception,s=e.Utils.StringEnum
	function c(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	if(0==arguments.length)throw new Error("Invalid arguments")
	return e.replace(/{(\d+)}/g,(function(e,n){return n in t?t[n]:e}))}function l(s){var u,d,p=o({value:l.State.None}),f=(s&&s.id||"_plugin")+"_"+l.nextCount(),m=s&&s.managerId?s.managerId:"_",h=new r,v=!1,g=!1
	function y(){return"_"==m}function b(){t.log("PluginObject::destroyInnerObject "+f),_(),p.set(l.State.Destroyed)}function _(){t.log("PluginObject::cleanup "+f)
	try{u&&u.parentNode.removeChild(u)}catch(e){t.log(e.message)}u=null,d=null,v=!1,g=!1}function E(e,r){t.log("PluginObject::attach "+f),n(p()==l.State.Created),n(!i(r))
	try{if(e.appendChild(u),d=u.firstChild,i(d))throw new Error("object missing")}catch(o){return _(),void p.set(l.State.AttachFailed)}g=r,y()&&(v=!0,w())}function w(){if(t.log("PluginObject::validateAndAttachEvents "+f),d&&v){try{if(!d.CheckExistence())return _(),void p.set(l.State.ExistenceCheckFailed)}catch(e){return _(),void p.set(l.State.NotInstalled,e)}if(g)try{d.OnEvent=S,d.OnPing=x}catch(e){return _(),void p.set(l.State.AttachFailed,e)}p.set(l.State.Attached)}}function S(e,t){h.fire(e,t)}function x(){try{d.PingResponse(),h.fire("__FxPing","")}catch(e){return b(),!1}return!0}return{id:function(){return f},state:p.asReadOnly(),innerObject:function(){return p()==l.State.Attached?d:null},createInnerObject:function(e){t.log("PluginObject::createInnerObject "+f),n(e),n(!i(e.hide)),n(!i(e.hookEvents)),n(p()==l.State.None,"invalid state")
	var r=function(e){var i
	if(n(e),!t.PluginManager().isPluginInstalled())throw p.set(l.State.NotInstalled),a("PluginNotInstalled")
	t.UserAgent().isIE()?(n(t.UserAgent().isWindows()),i=l.IE_HTML_TEMPLATE):(n(t.UserAgent().isWindows()||t.UserAgent().isMac()),i=l.FF_HTML_TEMPLATE)
	return c(i,e.id,t.PluginManager().installedPlugin().MIME_TYPE,e.managerId,e.logLevel,!0,!0)}({id:f,managerId:m,logLevel:t.UserAgent().isIE()?1:0})
	u=e.hide?function(e){var t=document.createElement("div")
	return t.style.position="absolute",t.style.width="1px",t.style.height="1px",t.style.left="-100px",t.style.top="0px",t.style.overflow="hidden",t.style.visibility="hidden",t.innerHTML=e,t}(r):function(e){var t=document.createElement("div")
	return t.style.width="100%",t.style.height="100%",t.innerHTML=e,t}(r),t.log("PluginObject::createInnerObject "+f+" "+u),p.set(l.State.Created),e.hide&&E(document.body,e.hookEvents)},destroyInnerObject:b,attach:E,event:h.observer,onObjectLoaded:function(){t.log("PluginObject::onObjectLoaded "+f),y()||(v=!0,e.window.setTimeout(w,0))},onObjectUnloaded:function(){t.log("PluginObject::onObjectUnloaded "+f),y()||(v=!1,b())}}}t.formatString=c,t.PluginObject=l,function(e){var t
	e.nextCount=(t=0,function(){return t++}),e.State=s("None","ConfigNotSupported","NotInstalled","CreateFailed","ExistenceCheckFailed","AttachFailed","Created","Attached","Destroyed"),e.IE_HTML_TEMPLATE='<object id="{0}" type="{1}" width="100%" height="100%"><param name="managerID" value="{2}" /><param name="componentID" value="{0}" /><param name="logLevel" value="{3}" /><param name="structuredArguments" value="{4}" /><param name="windowless" value="{5}" /></object>',e.FF_HTML_TEMPLATE='<embed id="{0}" type="{1}" width="100%" height="100%" managerID="{2}" componentID="{0}" logLevel="{3}" structuredArguments="{4}" windowless="{5}"></embed>'}(l=t.PluginObject||(t.PluginObject={}))})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.check,i=e.Utils.assert,r=e.Utils.isVoid,o=e.Utils.isNumber,a=e.Utils.isNotEmptyString,s=e.Utils.Enum,c=e.Utils.Task,l=e.Utils.Event,u=e.Utils.Property,d=e.Utils.Exception
	function p(e){var t,n="0x",i=e[0]
	for(t=7;t>=0;t--)n+=(i>>4*t&15).toString(16)
	return e.hresultstr=n,e.succeeded=e[0]>=0,e.failed=e[0]<0,e.hresult=e[0],e}function f(s){i("MediaPlatformConfig"==s.type||"AVComponent"==s.type||"VideoUI"==s.type||"TuningWizard"==s.type||"AppShareCore"==s.type||"AppShareViewerUI"==s.type)
	var m,h,v,g,y,b=u({value:f.State.Unloaded}),_=new l,E=[],w=!1
	function S(){return h&&h.id()||""}function x(){if(t.log("PluginComponent::unload "+S()),b()==f.State.Loading||b()==f.State.Loaded){b.set(f.State.Unloading)
	try{h.innerObject().UnLoad()}catch(e){A(e),b.set(f.State.Unloaded)}}}function C(e,n){var r
	switch(t.log("%c"+S()+" "+e,"color:blue",n),e){case"__FxLoadComplete":i(1==n.length),r=n[0],i(o(r)),r==t.PluginLoadResult.LoadSuccessful&&b()==f.State.Loading?(w||y.resolve(),b.set(f.State.Loaded),M(3)):(A(r),w||y.reject(r),b.set(f.State.Unloaded))
	break
	case"__FxUnLoadComplete":i(0==n.length),A(),b.set(f.State.Unloaded)
	break
	default:_.fire({type:e,args:n})}}function T(n){switch(t.log("PluginComponent::onPluginObjectState "+S()+" "+n),v&&v.record(e.TelemetryEvent.PluginComponent,{action:"onPluginObjectState",id:S(),reason:n}),n){case t.PluginObject.State.None:break
	case t.PluginObject.State.Created:s.hide||r(g)||h.attach(g,!0)
	break
	case t.PluginObject.State.Attached:e.window.setTimeout(I,0)
	break
	case t.PluginObject.State.Destroyed:b.set(f.State.Unloaded)
	break
	default:A(n),b.set(f.State.Unloaded)}}function I(){t.log("PluginComponent::loadComponent "+S()),i(b()==f.State.Loading),i(h.state()==t.PluginObject.State.Attached)
	try{h.innerObject().Load(s.type,E)}catch(e){A(e),b.set(f.State.Unloaded)}}function A(n){t.log("PluginComponent::cleanupPluginObject "+S()),v&&v.record(e.TelemetryEvent.PluginComponent,{action:"cleanupPluginObjectInComponent",id:S(),state:b(),reason:n}),h&&(h.event.off(C),h.state.changed.off(T),h.destroyInnerObject(),h=null)}function M(e){if(n(e>0&&e<=7,"Invalid level"),h)try{h.innerObject().SetLogLevel(e)}catch(i){t.log("SetLogLevel("+e+") failed: ",i)}}return m=s.pluginManager,v=s.tm,(h=t.PluginObject({id:"_"+s.type,managerId:m.id()})).event(C,"async"),h.state.changed(T),{id:S,state:b.asReadOnly(),load:function(){t.log("PluginComponent::load "+S()),i(b()==f.State.Unloaded,"invalid component state"),i(m.state()==t.PluginManager.State.Initialized),i(!y||"pending"!=y.state()),b.set(f.State.Loading),y=new c("Loading "+s.type+".",{cancel:function(e){t.log("PluginComponent::load canceled "+S()),w=!0,x(),y.reject(e)}}),E=[].slice.call(arguments,0)
	try{h.createInnerObject({hide:s.hide,hookEvents:!0})}catch(n){v&&v.record(e.TelemetryEvent.PluginComponent,{action:"loadPluginComponent",id:S(),state:b(),result:"failed",reason:n}),"pending"==y.state()&&y.reject(n)}return y.promise},unload:x,onLoaded:function(){t.log("PluginComponent::onLoaded "+S()),i(h),h.onObjectLoaded()},onUnloaded:function(){t.log("PluginComponent::onUnloaded "+S()),i(h),h.onObjectUnloaded()},event:_.observer,setContainer:function(e){n(!s.hide,"setContainer called for a hidden component"),n(b()!=f.State.Loaded,"setContainer called after component is already loaded"),g=e,b()==f.State.Loading&&h.state()==t.PluginObject.State.Created&&h.attach(g,!0)},setLogLevel:M,invoke:function(n){i(h),i(a(n)),i(b()==f.State.Loaded)
	var r,o=[].slice.call(arguments,1)
	t.log("PluginComponent::invoke %c"+n,"color:red",o,S()),v&&v.record(e.TelemetryEvent.PluginComponent,{action:n,args:o&&o.join(),id:S(),state:b(),result:"started"})
	try{r=p(h.innerObject().ProcessMethod(n,o))}catch(s){throw t.log(S()+" error executing "+n+" "+s.message),v&&v.record(e.TelemetryEvent.PluginComponent,{action:n,state:b(),result:"failed",reason:s}),d("PCInvoke",{method:n,args:o&&o.join()})}if(r&&r.failed)throw v&&v.record(e.TelemetryEvent.PluginComponent,{action:n,state:b(),result:"ret.failed",reason:r.hresultstr}),d.call(n+":"+r.hresultstr,"PCInvoke",{method:n,args:o&&o.join()})
	return v&&v.record(e.TelemetryEvent.PluginComponent,{action:n,state:b(),result:"succeeded",reason:r&&r.hresultstr}),r}}}t.PluginLoadResult=s("LoadSuccessful","NoInstanceManager","ComponentNotFound","ComponentLoadFailed","ComponentInitFailed","ComponentLoadCancelled"),t.PluginMethodResult=p,t.PluginComponent=f,function(e){e.State=s("Unloaded","Unloading","Loading","Loaded"),e.UnloadReason=s("None","CreateFailed","LoadFailed","UserInitiated","PluginInitiated","PluginClosedUnexpectedly")}(f=t.PluginComponent||(t.PluginComponent={}))})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.assert,i=e.Utils.isString,r=e.Utils.isNumber,o=e.Utils.isBoolean
	t.BigInt=function(e,t,a){var s=0,c=0,l=!1
	if(1==arguments.length)if(i(arguments[0]))d(arguments[0])
	else{if(!r(arguments[0]))throw new Error("invalid argument");(function(e){if(n(r(e)),e>2147483648||e<=-2147483648)throw new RangeError("out of range")
	s=0,l=!1,e<0&&(e=-e,l=!0)
	c=4294967295&e})(arguments[0])}else arguments.length>=2&&(n(r(arguments[0])),n(r(arguments[1])),n(!arguments[2]||o(arguments[2])),s=arguments[0],c=arguments[1],l=arguments[2]||!1)
	function u(){s=0,c=0,l=!1}function d(e){n(i(e))
	var t=e.split(",")
	if(t.length<2)throw new Error("invalid argument format")
	u(),s=parseInt(t[0]),c=parseInt(t[1]),l=function(e){var t=!1
	if(void 0===e)return!1
	switch(n(i(e)),e){case"true":t=!0
	break
	case"false":t=!1
	break
	default:throw new Error("invalid argument format")}return t}(t[2])}return{toString:function(){return s+","+c+","+l},fromString:d,empty:u}}})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.guid,i=e.Utils.async,r=e.Utils.assert,o=e.Utils.extend,a=e.Utils.isNumber,s=e.Utils.isString,c=e.Utils.isBoolean,l=e.Utils.singleton,u=e.Utils.StringEnum,d=e.Utils.Task,p=e.Utils.Property,f=e.Utils.Exception,m=e.Utils.Collection
	t.PluginManager=l((function(){var l,u,h,v,g={},y=null,b=p({value:t.PluginManager.State.Uninitialized}),_=0,E=5e3,w=0,S=6e3,x=p(),C=p({get:function(){var n,i,r=!1,o=[t.PluginManager.LYNC_PLUGINS.LATEST],a=t.PluginManager.LYNC_PLUGINS.COMPATIBLE,s=t.PluginManager.LYNC_PLUGINS.OBSOLETE
	t.UserAgent().isIE()?(i=q(o))?r=!0:(i=q(a))?(r=!0,n="CompatiblePluginInstalled"):n=(i=q(s))?"ObsoletePluginInstalled":"NoPluginInstalled":e.window.navigator.mimeTypes?W(o)?r=!0:W(a)?(r=!0,n="CompatiblePluginInstalled"):n=W(s)?"ObsoletePluginInstalled":"NoPluginInstalled":n="NoPluginInstalled"
	return j(i),z(),C(r,n),r}}),T=m({get:z}),I=p({get:function(){return A().then(j)}})
	function A(i){if(h&&h.record(e.TelemetryEvent.PluginManager,{action:"init",state:b()}),b()==t.PluginManager.State.Uninitialized){var o="__mainPluginManager_"+n().replace(/-/g,"_")
	t.log("PluginManager::init - id = "+o),l=i&&i.language||"en-us",u=i&&i.rtl||!1
	var a=i&&i.PluginObject||t.PluginObject
	h=i&&i.tm,r(!v||"pending"!=v.state()),v=new d("Loading the media plugin.",{cancel:function(e){t.log("PluginManager::init canceled "+o),F(),O(e),v.reject(e)}}),h&&h.monitor(v.promise,e.TelemetryEvent.PluginManager,{action:"initPluginMgr",state:b(),id:o}),b.set(t.PluginManager.State.Initializing),C.get().then((function(e){if(!e)throw f("PluginNotInstalled");(y=a({id:o,managerId:"_"})).event(P,"async"),y.state.changed(R),t.watch("pluginObject("+o+")::state",b),t.log("PluginManager::init - creating inner object")
	try{y.createInnerObject({hide:!0,hookEvents:!0})}catch(n){b.set(t.PluginManager.State.Uninitialized),"pending"==v.state()&&v.reject(n)}})).catch((function(e){b.set(t.PluginManager.State.Uninitialized),"pending"==v.state()&&v.reject(e)}))}else r(v)
	return v.promise}function M(){t.log("PluginManager::uninit"),r(!v||"pending"!=v.state()),v=new d("Unloading the media plugin.")
	try{for(var n in h&&h.monitor(v.promise,e.TelemetryEvent.PluginManager,{action:"uninit",state:b(),id:n}),g)g[n].unload()
	y&&(b.set(t.PluginManager.State.Uninitializing),y.innerObject().UnLoad()),O(),v.resolve()}catch(i){O(i),v.reject(i)}return F(),G(),v.promise}function O(e){C(void 0),x(void 0),T.removeAll((function(){return!0})),I(void 0),k(e),b.set(t.PluginManager.State.Uninitialized)}function k(n){t.log("PluginManager::cleanupPluginObject",n||""),y&&(h&&h.record(e.TelemetryEvent.PluginManager,{action:"cleanupPluginObject",reason:n}),y.event.off(P),y.state.changed.off(R),y.destroyInnerObject(),y=null)}function N(){return r(y),y.id()}function P(n,i){var o
	switch(n){case"__FxLoadComplete":r(1==i.length),o=i[0],r(a(o)),t.log("PluginManager::onPluginObjectEvent "+n+" "+o),F(),o==t.PluginLoadResult.LoadSuccessful&&b()==t.PluginManager.State.Initializing?(h&&h.record(e.TelemetryEvent.PluginManager,{action:"pluginObjectLoadSuccessful"}),b.set(t.PluginManager.State.Initialized),V(),j(),v.resolve()):(h&&h.record(e.TelemetryEvent.PluginManager,{action:"pluginObjectLoadError",reason:o}),k(Error(o)),b.set(t.PluginManager.State.Uninitialized),"pending"==v.state()&&v.reject(f.call("onPluginObjectEvent failed with result "+o,e.Utils.enumName(t.PluginLoadResult,o))))
	break
	case"__FxUnLoadComplete":t.log("PluginManager::onPluginObjectEvent "+n),h&&h.record(e.TelemetryEvent.PluginManager,{action:"pluginObjectUnloadComplete"}),F(),G(),O(),v.resolve()
	break
	case"__FxComponentLoadComplete":h&&h.record(e.TelemetryEvent.PluginManager,{action:"pluginObjectComponentLoadComplete",reason:i[0]}),r(1==i.length),o=i[0],r(s(o)),t.log("PluginManager::onPluginObjectEvent "+n+" "+o),g[o]&&g[o].onLoaded()
	break
	case"__FxComponentUnLoadComplete":h&&h.record(e.TelemetryEvent.PluginManager,{action:"pluginObjectComponentUnloadComplete",reason:i[0]}),r(1==i.length),o=i[0],r(s(o)),t.log("PluginManager::onPluginObjectEvent "+n+" "+o),g[o]&&g[o].onUnloaded()
	break
	case"__FxPing":V()}}function R(n){switch(t.log("PluginManager::onPluginObjectState "+n),h&&h.record(e.TelemetryEvent.PluginManager,{action:"onPluginObjectState",id:N(),state:n}),n){case t.PluginObject.State.None:case t.PluginObject.State.Created:break
	case t.PluginObject.State.Attached:e.window.setTimeout(L,0)
	break
	case t.PluginObject.State.NotInstalled:var i=f("PluginNotInstalled")
	k(i),b.set(t.PluginManager.State.Uninitialized),"pending"==v.state()&&v.reject(i)
	break
	default:F(),k(),b.set(t.PluginManager.State.Uninitialized)}}function L(){if(t.log("PluginManager::loadManager"),b()==t.PluginManager.State.Initializing&&y.state()==t.PluginObject.State.Attached)try{U(),y.innerObject().Load("__pluginFx",[l,u])}catch(e){F(),k(e),b.set(t.PluginManager.State.Uninitialized)}}function D(){var t=!1
	try{t=y.innerObject().CheckExistence()}catch(n){h&&h.record(e.TelemetryEvent.PluginManager,{action:"CheckExistence",state:b(),result:"failed",reason:n,id:N()})}return t}function U(){F(),_=e.window.setTimeout(B,E)}function F(){0!=_&&(e.window.clearTimeout(_),_=0)}function B(){D()?U():(F(),k(Error("TimedOut")),b.set(t.PluginManager.State.Uninitialized))}function V(){G(),w=e.window.setTimeout(H,S)}function G(){0!=w&&(e.window.clearTimeout(w),w=0)}function H(){t.UserAgent().isMac()?V():G(),D()||(M(),t.log("PluginManager::onPingTimeout - uninit due to missed ping"),h&&h.record(e.TelemetryEvent.PluginManager,{action:"uninitPluginMgr",reason:"pingMissed"}))}function q(e){for(var t=0,n=e;t<n.length;t++){var i=n[t]
	try{var r=new ActiveXObject(i.VERSION_QUERY)
	return x(i),r}catch(o){}}}function W(t){e.window.navigator.plugins.refresh()
	for(var n=0,i=t;n<i.length;n++){var r=i[n]
	if(r.MIME_TYPE in e.window.navigator.mimeTypes)return x(r),!0}return!1}function j(e){var t
	if(y&&y.innerObject())try{t=y.innerObject().GetVersion()}catch(n){}if(!t&&e)try{t=e.GetVersion()}catch(n){}return t&&(t=t.replace(/@/g,"."),I(t)),t}function z(){var e=t.PluginManager.LYNC_PLUGINS.LATEST
	return!e.DOWNLOAD.MSI||T.index("msi")>=0||T.add(e.DOWNLOAD.MSI,"msi"),!e.DOWNLOAD.PKG||T.index("pkg")>0||T.add(e.DOWNLOAD.PKG,"pkg"),!e.DOWNLOAD.DMG||T.index("dmg")>0||T.add(e.DOWNLOAD.DMG,"dmg"),T()}return t.watch("PluginManager::state",b),{init:i(A),uninit:i(M),createComponent:function(n){r(n),r(s(n.type)),r(c(n.hide)),r(b()==t.PluginManager.State.Initialized),t.log("PluginManager::createComponent "+n.type),h&&h.record(e.TelemetryEvent.PluginManager,{action:"createComponent",specs:_stringify(n)}),o(n,{pluginManager:t.PluginManager(),tm:h})
	var i=t.PluginComponent(n),a=i.id(),l=function(e){t.log("PluginManager::onComponentState "+e),e==t.PluginComponent.State.Unloaded?g[a]&&(g[a].state.changed.off(l),delete g[a]):t.PluginComponent.State.Loaded}
	return i.state.changed(l),g[a]=i,i},isPluginInstalled:C.asReadOnly(),installedPlugin:x,pluginDownloadLinks:T.asReadOnly(),installedVersion:I.asReadOnly(),state:b.asReadOnly(),id:N,setPingTimeout:function(e){S=e}}})),t.PluginManager.State=u("Uninitialized","Uninitializing","Initializing","Initialized"),t.PluginManager.LYNC_PLUGINS={LATEST:{MIME_TYPE:"application/x-skypeforbusiness-plugin-16.2",MIME_TYPE_VERSION:"application/x-skypeforbusiness-version-16.2",SHELLAPP_URL_SCHEME:"sfb",SHELLAPP_ID:"com.microsoft.skypeforbusiness.shellapp",VERSION_QUERY:"Microsoft.SkypeForBusinessPlugin16.2.VersionQuery",DOWNLOAD:{MSI:"to-be-filled: latest msi plugin download link in CDN",PKG:"to-be-filled: latest pkg plugin download link in CDN",DMG:"to-be-filled: latest dmg plugin download link in CDN"}},COMPATIBLE:[{MIME_TYPE:"application/x-skypeforbusiness-plugin-16.1",MIME_TYPE_VERSION:"application/x-skypeforbusiness-version-16.1",SHELLAPP_URL_SCHEME:"sfb-16.1",SHELLAPP_ID:"com.microsoft.skypeforbusiness.shellapp.16.1",VERSION_QUERY:"Microsoft.SkypeForBusinessPlugin16.1.VersionQuery"},{MIME_TYPE:"application/x-skypeforbusiness-plugin-16.0",MIME_TYPE_VERSION:"application/x-skypeforbusiness-version-16.0",SHELLAPP_URL_SCHEME:"sfb-16.0",SHELLAPP_ID:"com.microsoft.skypeforbusiness.shellapp.16.0",VERSION_QUERY:"Microsoft.SkypeForBusinessPlugin16.0.VersionQuery"}],OBSOLETE:[{MIME_TYPE:"application/x-lwa-nativeplugin15.8",MIME_TYPE_VERSION:"application/x-lwa-nativeplugin-version15.8",SHELLAPP_URL_SCHEME:"sfb-w16-v2",SHELLAPP_ID:"com.microsoft.skypeforbusiness.shellapp",VERSION_QUERY:"Microsoft.LWA64Plugin15.8.VersionQuery"}]}})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.logMedia=!1,e.dbgPlugin=!1})(e.Settings||(e.Settings={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.debug
	function i(){return!e.Settings.dbgPlugin&&t.MediaAgent.isPlatformSupported()}t.log=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i]
	n.log.apply(n,[e.Settings.logMedia,"[MEDIA] "].concat(t))},t.watch=function(t,i){n.watch(e.Settings.logMedia,"[MEDIA] "+t,i)},t.useBrowserMedia=i,t.isOrtc=function(){return i()&&"undefined"!=typeof RTCIceGatherer&&!e.Settings.mediaAgent},t.isWebRtc=function(){return i()&&"undefined"!=typeof RTCPeerConnection&&"undefined"==typeof RTCIceGatherer&&!e.Settings.mediaAgent}})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){(function(e){var t=function(t){function n(e){var t=0|+e
	return t==e?t:e}return e.ObservableResource(t,{rel:"mediaPolicies"},(function(e){e.property("bandwidthControl"),e.property("fipsCompliantMedia"),e.property("poorDeviceWarnings"),e.property("poorNetworkWarnings"),e.property("portRange"),e.property("qualityOfService"),e.property("audioVideoEncryption"),e.property("audioBitRate",n),e.property("audioBypass"),e.property("audioBypassId"),e.property("internalAudioBypassMode"),e.property("externalAudioBypassMode"),e.property("minimumAudioPort",n),e.property("maximumAudioPort",n),e.property("minimumVideoPort",n),e.property("maximumVideoPort",n),e.property("maximumVideoRateAllowed"),e.property("multiViewJoin"),e.property("totalReceivedVideoBitRateKB",n),e.property("video"),e.property("videoBitRate",n),e.property("applicationSharingBitRate",n),e.property("applicationSharingEncryption"),e.property("minimumApplicationSharingPort",n),e.property("maximumApplicationSharingPort",n),e.property("highPerformanceApplicationSharingInOnlineMeeting")}))}
	e.MediaPolicies=t})(e.Internal||(e.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.async,i=e.Utils.check,r=e.Utils.Promise,o=e.Media.PluginManager,a=function(e,a,s){var c,l,u
	function d(){return(c?c.mrasTokenExpired()?c.renewMrasToken():r.resolve():p().then((function(){return e.init()})).then((function(){return(c=t.MediaConfig({ucwa:e,mediaPlugin:v,tm:a})).init()}))).then((function(){return c}))}function p(e){return void 0===e&&(e="en-us"),i(o,"NoMedia"),u=u||o().state.changed((function(e,t,n){e==o.State.Uninitialized&&(f(),m())})),s&&s.pluginPingTimeout&&o().setPingTimeout(s.pluginPingTimeout),o().init({language:e,rtl:!1,tm:a})}function f(){c&&(c.uninit(),c=null)}function m(){l&&(l.uninit(),l=null)}function h(e){return o().createComponent(e)}var v={getMediaConfig:n(d),getAppSharing:n((function(e){return l||p(e).then(d).then((function(){return(l=t.AppSharing({mediaConfig:c,component:h({type:"AppShareCore",hide:!0})})).init()})).then((function(){return l}))})),initMedia:n(p),uninitMedia:n((function(){return f(),m(),u&&(u.dispose(),u=null),o().uninit()})),uninitAppSharing:n(m),createComponent:h}
	return v}
	t.MediaPlugin=a})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.async,i=e.Utils.assert,r=e.Utils.Task,o=e.Utils.Property,a=e.Utils.EWrongType,s=e.Utils.StringEnum,c=e.Media.log
	function l(t){var u,d=t.ucwa,p=t.mediaPlugin,f=!!d.get({rel:"root"},null)&&!!d.get({rel:"root"}).get("internal",!1),m=o({value:l.ProxyDetection.None}),h={},v=t.tm,g=0,y=s("Enforced","Supported","NotSupported")
	function b(){u&&(u.event.off(_),u=null)}function _(e){if("ProxyDetectionCompleted"==e.type){h[e.args[0]]="true"==e.args[1]?l.ProxyDetection.Succeeded:l.ProxyDetection.Failed
	var t=!0,n=l.ProxyDetection.Failed
	for(var i in h)switch(i){case l.ProxyDetection.None:case l.ProxyDetection.Started:t=!1
	break
	case l.ProxyDetection.Succeeded:n=l.ProxyDetection.Succeeded}t&&m(n)}}function E(){return r.waitAll([d.send("GET",{rel:"mediaPolicies"}).then((function(){return function(){v&&v.record(e.TelemetryEvent.Call,{action:"setMediaPolicies",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"started"})
	var t=d.get(d.app.relatedHref("communication")),n=d.get(t.link("mediaPolicies").href)
	"Enabled"==n.properties.portRange&&u.invoke("SetPortRanges",n.properties.minimumAudioPort,n.properties.maximumAudioPort,n.properties.minimumVideoPort,n.properties.maximumVideoPort,n.properties.minimumApplicationSharingPort,n.properties.maximumApplicationSharingPort)
	u.invoke("SetMediaPlatformConfig","Enabled"==n.properties.qualityOfService,f),u.invoke("SetMediaSettings",!0,!0,parseInt(n.properties.audioBitRate)||-1,parseInt(n.properties.videoBitRate)||-1,parseInt(n.properties.applicationSharingBitRate)||-1,-1,parseInt(n.properties.totalReceivedVideoBitRateKB)||-1,"Required"==n.properties.fipsCompliantMedia),u.invoke("SetStereoAudioRendering",!1),v&&v.record(e.TelemetryEvent.Call,{action:"setMediaPolicies",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"succeeded"})}()})).catch((function(t){c("MediaConfig::getMediaPolicies error: ",t),v&&v.record(e.TelemetryEvent.Call,{action:"getMediaPolicies",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"failed",reason:t})})),w()])}function w(){var t=d.send("GET",{rel:"mediaRelayAccessToken"}).then((function(){return function(){v&&v.record(e.TelemetryEvent.Call,{action:"setMras",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"started"})
	var t,n,i,r,o=d.get(d.app.relatedHref("communication")),a=d.get(o.link("mediaRelayAccessToken").href),s=a.properties.userName,p=a.properties.password,y="*"
	u.invoke("ClearIceServers")
	for(var b=0,_=a.related.mediaRelay.length;b<_;b++)if(t=d.get(a.related.mediaRelay[b].href),!(f&&"Internet"==t.properties.location||!f&&"Intranet"==t.properties.location)){if(r=t.properties.host,n=t.properties.tcpPort||-1,i=t.properties.udpPort||-1,u.invoke("AddProxyServer",r),h[r]=l.ProxyDetection.Started,m()==l.ProxyDetection.None&&m(l.ProxyDetection.Started),-1!=i)try{u.invoke("AddIceServer",1,r,i,s,y,p)}catch(w){c(w.message+" : UDP "+r+":"+i)}if(-1!=n)try{u.invoke("AddIceServer",2,r,n,s,y,p)}catch(w){c(w.message+" : TCP "+r+":"+n)}}var E=a.properties.duration||0
	E=E>2?E-2:0,g=e.Date.now()+6e4*E,v&&v.record(e.TelemetryEvent.Call,{action:"setMras",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"succeeded"})}()})).catch((function(t){c("MediaConfig::getMediaRelayAccessToken error: ",t),v&&v.record(e.TelemetryEvent.Call,{action:"getMediaRelayAccessToken",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",result:"failed",reason:t})}))
	return v&&v.monitor(t,e.TelemetryEvent.Call,{action:"renewMrasToken",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin"}),t}return t=null,{init:n((function(){return(u=p.createComponent({type:"MediaPlatformConfig",hide:!0})).event(_),u.state.changed((function(e){c("pcMediaConfig.state = "+e)})),u.load().then(E).catch((function(e){throw c("MediaConfig::init rejected"),b(),e}))})),uninit:b,isInternal:function(){return f},audioVideoSecurityLevel:function(){var e,t,n=d.get(d.app.relatedHref("communication")),i=d.get(n.link("mediaPolicies").href)
	if(i)switch(e=i.properties.audioVideoEncryption){case y.Enforced:t=3
	break
	case void 0:case y.Supported:t=2
	break
	case y.NotSupported:t=1
	break
	default:throw a(e,"EnforcementPolicy")}return t},applicationSharingSecurityLevel:function(){var e,t,n=d.get(d.app.relatedHref("communication")),i=d.get(n.link("mediaPolicies").href)
	if(i)switch(e=i.properties.applicationSharingEncryption){case y.Enforced:t=3
	break
	case void 0:case y.Supported:t=2
	break
	case y.NotSupported:t=1
	break
	default:throw a(e,"EnforcementPolicy")}return t},maxVideoChannelCount:function(){var e=u.invoke("GetMaxVideoChannelCount")
	return e[1]<6?e[1]:6},proxyDetection:m.asReadOnly(),setDefaultDevices:function(){i(u),u.invoke("SetDefaultDevices")},mrasTokenExpired:function(){return e.Date.now()>g},renewMrasToken:w}}t.MediaConfig=l,function(e){e.ProxyDetection=s("None","Started","Succeeded","Failed")}(l=t.MediaConfig||(t.MediaConfig={}))})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.assert,i=e.Utils.DataUri,r=e.Utils.async,o=e.Utils.extend,a=e.Utils.indexOf,s=e.Utils.guid,c=e.Utils.Property,l=e.Utils.check,u=e.Utils.Exception,d=e.Utils.Task,p=e.Utils.Command,f=e.Utils.Model,m=e.Media.log
	t.AppSharingModality=function(e){var h,v,g,y,b,_,E,w,S,x,C,T=f(),I=e.ucwa,A=e.invitation,M=e.rConversation,O=e.participants,k=c({value:A?t.Modality.State.Notified:t.Modality.State.Created}),N=e.threadId,P=e.mediaPlugin,R=e.sharedResources,L=e.resource,D={}
	e=null
	var U=c({value:null,get:function(){return y},set:function(e){return Y(e).then((function(){return e}))}})
	function F(e,t,n){var i=c()
	k.changed((function(e){i(a(t,e)>=0)})),T[e]=p(r(n),i)}function B(e){var t=e.target.rel+" "+e.type,n=V[t]
	n&&n(e.status,e.resource,e)}o(T,{state:k.asReadOnly(),shared:U}),A&&(T.from=A.from),k.changed((function(e,t,n){m("AppSharingModality::state: %c"+n+" -> "+e,"color:green;font-weight:bold","Reason: ",t)})),I.event(B)
	var V={"applicationSharingInvitation started":function(e,t){"Outgoing"==t.properties.direction&&t.properties.threadId==N&&(L=t,_.status('awaiting "applicationSharingNegotiation started" event from UCWA'))},"applicationSharingNegotiation started":function(e,t){var n,r
	t.relatedHref("applicationSharingInvitation")==L.href&&(n=i(t.relatedHref("mediaProvisionalAnswer")).data,r=t.get("remoteEndpoint"),v.setProvisionalAnswer(!0,!0,r,n),_.status('awaiting "applicationSharingNegotiation completed" event from UCWA'))},"applicationSharingNegotiation completed":function(e,t,n){if(n.sender.href==L.href)switch(e){case"Success":Q(t,t.get("remoteEndpoint")),_.status('awaiting "applicationSharingInvitation completed" event from UCWA')
	break
	case"Failure":_.status(n.reason&&n.reason.message)}},"applicationSharingSession added":function(e,t){L.relatedHref("conversation")==t.relatedHref("conversation")&&(w=t)},"applicationSharingInvitation completed":function(e,n){if(L&&L.href==n.href)if("Outgoing"==L.get("direction",""));else if("Incoming"==L.get("direction","")&&"Success"==e)try{X(e),b.resolve(),k(t.Modality.State.Connected)}catch(i){b.reject(i),k(t.Modality.State.Disconnected,i)}},"applicationSharingRenegotiation started":function(e,t){var n
	"Incoming"==t.properties.direction&&t.relatedHref("conversation")==L.relatedHref("conversation")&&(n=i(t.relatedHref("mediaOffer")).data,m("Incoming SDP offer:\n"+n),d.wait(null).then((function(){if("Connected"===k()&&y)return Y(null)})).then((function(){v.setOffer(!1,1,n,"")})),S=t)},"applicationSharingRenegotiation completed":function(e,t){t.relatedHref("conversation")==L.relatedHref("conversation")&&("Outgoing"==t.get("direction")&&Q(t,w.get("remoteEndpoint")),X(e))},"applicationSharing updated":function(e,n){L&&n.href==L.relatedHref("applicationSharing")&&"Disconnected"==n.get("state")&&(n.hasLink("applicationSharer")?(w=null,Y(null)):(K(),k(t.Modality.State.Disconnected)))},"conversation updated":function(e,t){!L||t.href!=L.relatedHref("conversation")||"Connected"!=t.get("state")&&"Conferenced"!=t.get("state")||a(t.get("activeModalities"),"ApplicationSharing")}}
	function G(e){m("pcAS.event %c "+e.type,"color:blue",e.args)
	var t=H[e.type]
	t&&t.apply(null,""!==e.args?e.args:null)}var H={OFFER_READY:function(e,o,a){var c,l=[]
	try{for(c=0;c<a;c++)l.push({sdp:arguments[3+2*c],id:arguments[3+2*c+1]})
	if(0==l.length)throw u("NoSdpOffers",{diagCode:o})
	w?function(e){var t=w.relatedHref("renegotiations")
	n(t,'"renegotiations" link is missing')
	var i=s()
	D[i]="",I.send("POST",t,{headers:{"Content-Type":"application/sdp"},query:{operationId:i},data:e,nobatch:!0})}(l[0].sdp):function(e){n(e.length>0)
	var o="data:application/sdp;charset=utf-8,"+i.encodeData(e[0].sdp)
	return r($).call(null).then((function(e){var n,i,r,a=s()
	return r=z()?{operationId:a,threadId:N,mediaOffer:o}:{to:"addScreenSharing"==e.rel?void 0:E,operationId:a,sessionContext:s(),threadId:N,mediaOffer:o},n=I.send("POST",e.href,{data:r}).then((function(e){L=e})),i=I.wait({type:"completed",target:{rel:"applicationSharingInvitation"},resource:function(e){return"Outgoing"==e.get("direction")&&(e.get("threadId")==N||e.get("operationId")==a)}}).then((function(e){if("Failure"==e.status)throw t.EInvitationFailed(e.reason)
	X(e.status)})),d.waitAll([n,i])}))}(l).then((function(){_.resolve(),k(t.Modality.State.Connected)}),(function(e){_.reject(e),k(t.Modality.State.Disconnected,e),K()}),_.status)}catch(p){_&&_.reject(p)}},ANSWER_READY:function(e,n){S?I.send("POST",S.link("answer").href,{headers:{"Content-Type":"application/sdp"},data:n,nobatch:!0}):(b.status("sending answer to UCWA"),A.acceptWithAnswer(n).then((function(){b.status('awaiting a "applicationSharingInvitation completed" event from UCWA')}),(function(e){k(t.Modality.State.Disconnected,e),b.reject(e)}),b.status))},StopSharing:function(){T.stop()}}
	function q(){return h?d.wait(h):P.getMediaConfig().then((function(e){return h=e}))}function W(e){function t(){return R.init().then(P.getAppSharing).then((function(e){(v=e).event(G,"async")}))}function i(){return d.wait(null).then((function(){R.windows.each((function(e){R.setShared(e.id(),!1)})),R.monitors.each((function(e){R.setShared(e.id(),!1),e.selected(!1)})),R.setShared(y.id(),!0),v.setCallConfig(),v.setMediaConfig(3,2)}))}function r(){return d.wait(null).then((function(){if(!g)return n(!g),(g=P.createComponent({type:"AppShareViewerUI",hide:!1})).setContainer(x),g.event(j,"async"),g.load()})).then((function(){g.invoke("CreateAppShareViewerUI")
	var e=g.invoke("GetViewerWindow")
	2===e.length&&e[1]&&(C=e[1]),v.setCallConfig(),v.initializeViewer(C),v.connectViewer("connectString"),v.setSmartSizingViewer(!0),v.setViewerWindowSize(x.offsetWidth,x.offsetHeight),z()?v.setMediaConfig(3,1):v.createViewerStream()}))}return 2===e?v?i():t().then(i):d.wait(null).then((function(){return v?r():t().then(r)}))}function j(e){m("pcASUI.event %c "+e.type,"color:blue",e.args),"SIZE_CHANGED"==e.type&&v&&v.setViewerWindowSize(e.args[0],e.args[1])}function z(){return M&&("Conferenced"==M.get("state","")||"Conferencing"==M.get("state",""))}function K(){I.event.off(B),v&&(v.event.off(G),y&&R.setShared(y.id(),!1),v.disposeSharer(),R.uninit()),g&&(v.disposeViewer(),g.event.off(j),g.unload()),g=null,P.uninitAppSharing().then((function(){return v=null,R.init()}))}function Y(e){return l.state(k(),t.Modality.State.Connected),y&&R.setShared(y.id(),!1),g?function(){if(z()||(v.setCallConfig(),v.setMediaConfig(3,2)),v.disposeViewer(),g.event.off(j),g.unload(),g=null,z())return P.uninitAppSharing().then((function(){v=null,R.uninit()})).then((function(){return y=e,W(2)}))
	R.setShared(e.id(),!0),y=e}():e?(R.setShared(e.id(),!0),void(y=e)):(v.disposeSharer(),P.uninitAppSharing().then((function(){v=null,R.uninit()})).then((function(){return W(1)})))}function Q(e,t){var n=e.relatedHref("mediaAnswer"),r=i(n).data
	m("Final answer from the remote party:\n"+r),v.setFinalAnswer(t,r)}function X(e){var n="Success"==e?t.MediaEnum.NegotiationStatus.NS_SUCCESS:t.MediaEnum.NegotiationStatus.NS_LOCAL_INTERNAL_ERROR
	v.completeNegotiation(n)}function $(){if(!M)return(e=I.get(I.app.relatedHref("communication")).link("startScreenSharing")).rel="startScreenSharing",e
	var e=M.link("applicationSharing")
	return I.send("GET",e.href).then((function(e){var t=e.link("addScreenSharing")
	return t.rel="addScreenSharing",t}))}return F("start",[t.Modality.State.Created],(function(e){return k(t.Modality.State.Connecting),x=(e=e||{}).container,z()||((E=E||e.to)||O.each((function(e){e.local()||(E=e.uri())})),l(E,"the remote participant URI is not specified")),y=e.window||e.monitor,q().then((function(){return P.getAppSharing().then((function(e){return(v=e).event(G,"async"),W(y?2:1),n(!_),(_=new d("awaiting an OFFER_READY event from the media plugin")).promise})).then(null,(function(e){throw L&&L.hasLink("cancel")&&("Connecting"==L.get("state","")||"Alerting"==L.get("state",""))&&I.send("POST",L.link("cancel").href,{nobatch:!0}),k(t.Modality.State.Disconnected,e),e}))}))})),F("stop",[t.Modality.State.Connected],(function(){return K(),I.send("GET",L.link("applicationSharing").href).then((function(e){return I.send("POST",e.link("stopScreenSharing").href)})).then((function(){k(t.Modality.State.Disconnected),L=null,w=null}))})),F("accept",[t.Modality.State.Notified],(function(e){return n(e&&e.container),k(t.Modality.State.Connecting),x=e.container,q().then((function(){return P.getAppSharing().then((function(e){return(v=e).event(G,"async"),W(1).then((function(){(function(e){n(e.length>=0)
	var t,i,r=[!1,e.length]
	for(t=0;t<e.length;t++)i=e[t],n("sdp"in i),n("id"in i),r.push(i.sdp),r.push(i.id)
	v.setOffer.apply(v,r)})(A.offers)}))}))})).then((function(){return n(!b),(b=new d).status("awaiting an ANSWER_READY event from the media plugin"),b.promise})).then(null,(function(e){throw k(t.Modality.State.Disconnected,e),K(),e}))})),F("decline",[t.Modality.State.Notified],(function(){return A.decline().then((function(){k(t.Modality.State.Disconnected)}))})),T}})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.async,i=e.Utils.ConstProperty,r=e.Utils.Model
	t.ShareableWindow=function(e){var t=e.mediaPlugin,o=e.resource,a=e.shared
	return o.filter=2,r({id:i(o.id),title:i(o.name),shared:a,preview:n((function(e){return t.getAppSharing().then((function(t){return t.getResourcePreview(o,e)}))}))})}})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.ConstProperty,i=e.Utils.Property,r=e.Utils.Model
	t.ShareableMonitor=function(e){var t=e.mediaPlugin,o=e.resource,a=e.shared;-1!==o.id?o.name="Monitor #"+o.id:o.name="Desktop Sharing",o.filter=1
	var s=i({value:!1,set:function(e){return t.getAppSharing().then((function(t){return e?t.drawTrackingChrome(o.id):t.removeTrackingChrome(o.id),e}))}})
	return r({id:n(o.id),title:n(o.name),shared:a,selected:s})}})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.assert,i=e.Utils.async,r=e.Utils.foreach,o=e.Utils.Property,a=e.Utils.Collection,s=e.Utils.Model,c=e.Media.UserAgent
	t.SharedResources=function(e){var l,u,d=a({get:m,subscribed:m}),p=a({get:m,subscribed:m}),f={}
	function m(){return u||(u=e.initMedia().then((function(){return e.getAppSharing()})).then((function(e){if(n(!l),(l=e).event(h,"async"),!c().isMac()){var t=[],i=[],o=l.getShareableResources()
	r(o,(function(e){1===e.type?i.push(e):3===e.type&&t.push(e)})),y(t,d),y(i,p)}v()})))}function h(n){if("ResourceUpdated"==n.type){var i,r,o=n.args.splice(7,1)[0],a=n.args[0],s={type:n.args[0],id:n.args[1],appId:n.args[2],name:n.args[3],isShared:n.args[4],flags:n.args[5],isResourceAsIsShareable:n.args[6],fIsImmersiveModeApp:n.args[7]}
	1===a?(i=g(s,p),1===o?i||(r=b(s),f[s.id]=r,p.add(t.ShareableMonitor({resource:s,mediaPlugin:e,shared:r.asReadOnly()}))):2===o&&i&&(p.remove(i),delete f[s.id]),v()):3===a&&(i=g(s,d),1===o?!i&&s.isResourceAsIsShareable&&(r=b(s),f[s.id]=r,d.add(t.ShareableWindow({resource:s,mediaPlugin:e,shared:r.asReadOnly()}))):2===o&&i&&(d.remove(i),delete f[s.id]))}}function v(){var n,i,r={type:4,id:-1,appId:-1}
	p.each((function(e,t){"Desktop Sharing"===e.title()&&(n=t)})),n&&(p.remove(n),delete f[r.id]),i=b(r),f[r.id]=i,p.add(t.ShareableMonitor({resource:r,mediaPlugin:e,shared:i.asReadOnly()}))}function g(e,t){var n
	return t.each((function(t,i){t.id()!==e.id||(n=i)})),n}function y(n,i){r(n,(function(n){var r=!1
	if(i.each((function(e){n.id===e.id()&&(r=!0)})),!r){var o=b(n)
	f[n.id]=o,1===n.type?i.add(t.ShareableMonitor({resource:n,mediaPlugin:e,shared:o.asReadOnly()})):i.add(t.ShareableWindow({resource:n,mediaPlugin:e,shared:o.asReadOnly()}))}}))}function b(t){return o({value:!1,set:function(n){return e.getAppSharing().then((function(e){var i={type:t.type,id:t.id,appId:t.appId,filter:t.filter}
	return n?e.shareResource(i):e.unshareResource(i),n}))}})}return s({init:i(m),uninit:function(){l&&l.event.off(h),l=null,u=null},windows:d.asReadOnly(),monitors:p.asReadOnly(),setShared:function(e,t){f[e]&&f[e](t)}})}})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.DataUri,i=e.Utils.async,r=e.Utils.extend,o=e.Utils.guid,a=e.Utils.map,s=e.Utils.check,c=e.Utils.HttpHeaders,l=e.Stack.parseMultipartRelatedResponse
	t.AppSharingInvitation=function(e){var t=e.ucwa,u=e.resource,d=e.createParticipant
	s.equals(u.rel,"applicationSharingInvitation")
	var p,f={acceptWithAnswer:i((function(e){var n=u.link("acceptWithAnswer").href
	return t.send("POST",n,{headers:{"Content-Type":"application/sdp"},query:{sessionContext:f.sessionContext},data:e,nobatch:!0})})),decline:i((function(){return t.send("POST",u.link("decline").href,{data:{reason:"Local"}})})),offers:function(){var e,t,i
	if(!(e=u.relatedHref("mediaOffer")))return[]
	t=n(e)
	try{return i=l({status:null,responseText:t.data,headers:{"Content-Type":"multipart/related;boundary="+t.attributes.boundary}}),a(i,(function(e){var t=c(e.headers)
	return{sdp:e.responseText,id:t.get("Content-ID")}}))}catch(r){return[{sdp:t.data,id:""}]}}(),from:(p=u.relatedHref("from"),p&&d(u.embedded[p]))}
	return r(f,u.properties),f.sessionContext=f.sessionContext||o(),f}})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={}));(function(e){(function(e){(function(t){(function(t){var n=e.Utils.async,i=e.Utils.guid,r=e.Utils.Exception,o=e.Utils.EInvalidArgument
	t.AppSharing=function(e){var a=e.mediaConfig,s=e.component,c=!1
	function l(){if(!c)throw r.call("Not Initialized","NotInitialized")}return{init:n((function(){return s.load("","",i(),!1,a.maxVideoChannelCount(),a.applicationSharingSecurityLevel()).then((function(){s.invoke("InitializeSharer"),s.setLogLevel(3),c=!0}))})),uninit:function(){s&&(s.unload(),s=null,c=!1)},setCallConfig:function(){l(),s.invoke("SetCallConfig",a.isInternal()?t.MediaEnum.PreferredMediaAddressType.Direct:t.MediaEnum.PreferredMediaAddressType.Relay)},setMediaConfig:function(e,t){l(),s.invoke("SetMediaConfig",e,t)},initializeViewer:function(e){l(),s.invoke("InitializeViewer",e)},connectViewer:function(e){l(),s.invoke("ConnectViewer",e)},createViewerStream:function(){l(),s.invoke("CreateViewerStream",3)},setViewerWindowSize:function(e,t){l(),s.invoke("SIZE_CHANGED",e,t)},setSmartSizingViewer:function(e){l(),s.invoke("SetSmartSizingViewer",e)},publishFullScreenState:function(e){l(),s.invoke("PublishFullScreenState",e)},setOffer:function(e,t){if(l(),t<1)throw o("count","No Offers Provided")
	var n=["SetOffer",e,t].concat([].slice.call(arguments,2))
	s.invoke.apply(s,n)},setFinalAnswer:function(e,t){l(),s.invoke("SetFinalAnswer",e,t)},setProvisionalAnswer:function(e,t,n,i){l(),s.invoke("SetProvisionalAnswer",e,t,n,i)},completeNegotiation:function(e){l(),s.invoke("CompleteNegotiation",e)},getShareableResources:function(){l()
	var e,t,n=[],i=0
	if(s.invoke("LockFetchResources"),e=s.invoke("GetResources"),s.invoke("UnlockFetchResources"),e){t=e[e.length-1],e=e.slice(1,-1)
	for(var r=0;r<t;r++)1!==e[i+4]&&(1===e[i]||3===e[i]&&0!==e[i+6])&&n.push({type:e[i],id:e[i+1],appId:e[i+2],name:e[i+3],isShared:e[i+4],flags:e[i+5],isResourceAsIsShareable:e[i+6],fIsImmersiveModeApp:e[i+7]}),i+=8}return n},drawTrackingChrome:function(e){l(),s.invoke("DrawMonitorTrackingChrome",e)},removeTrackingChrome:function(e){l(),s.invoke("RemoveMonitorTrackingChrome",e)},getResourcePreview:function(e,t){var n
	return l(),1===e.type||(n="data:image/png;base64,"+s.invoke("GetApplicationPreview",e.appId,e.id,t.width,t.height)[1]),n},shareResource:function(e){l(),s.invoke("SetControlAllowed",1,!0,!0),-1!==e.id?(s.invoke("SetResourceFilter",e.filter,1),s.invoke("SetResourceSharedState",e.type,e.id,e.appId,1)):s.invoke("DisableFilters"),s.invoke("CanStopSharing",!0)},unshareResource:function(e){l(),s.invoke("SetResourceSharedState",e.type,e.id,e.appId,0)},disposeSharer:function(){l(),s.invoke("DisposeSharer")},disposeViewer:function(){l(),s.invoke("DisposeViewerCore")},event:s.event}}})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))})(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.find,i=e.Utils.guid,r=e.Utils.check,o=e.Utils.async,a=e.Utils.assert,s=e.Utils.extend,c=e.Utils.random,l=e.Utils.values,u=e.Utils.filter,d=e.Utils.foreach,p=e.Utils.isEmptyObject,f=e.Utils.currentUTCms,m=e.Utils.Task,h=e.Utils.Event,v=e.Utils.Symbol,g=e.Utils.DataUri,y=e.Utils.Promise,b=e.Utils.Property,_=e.Utils.Exception,E=e.Utils.Collection,w=e.Utils.StringEnum,S=e.Utils.EDoesNotExist,x=e.Utils.EInvalidState,C=e.Utils.ENotSupported,T=e.Utils.setHiddenProperty,I=e.Media.log,A=e.Media.watch,M=e.Media.PluginManager,O=e.Media.PluginComponent
	t.sEscalation=v("escalation")
	var k=function(v){var k,N,P,R,L,D,U,F,B,V,G,H,q,W,j,z,K,Y=new h,Q=new h,X=new h,$={},J=v.mediaPlugin,Z=v.devices,ee=v.ucwa,te=v.tm,ne=v.context,ie=v.contextType,re=v.settings,oe=v.participants,ae=v.selfParticipant,se=v.conversation,ce=v.rConversation,le=v.rAVInvitation,ue={},de=v.invitation,pe=v.rInvitation,fe=v.operationId||i(),me=v.sessionContext||i(),he={},ve=v.localUri,ge=b({value:de||pe&&"onlineMeetingInvitation"==pe.rel?t.Modality.State.Notified:t.Modality.State.Disconnected}),ye=b({value:de&&!de.hasVideo()||pe&&"onlineMeetingInvitation"==pe.rel&&se.meeting.availableModalities.audio()&&!se.meeting.availableModalities.video()||et()?t.Modality.State.Notified:t.Modality.State.Disconnected}),be=b({value:et()?t.Modality.State.Notified:t.Modality.State.Disconnected}),_e={},Ee={audio:!1,video:!1},we=new t.MediaStream({mediaPlugin:J,type:t.MediaEnum.StreamType.MainRender}),Se=new t.MediaStream({mediaPlugin:J,type:t.MediaEnum.StreamType.Preview}),xe=E(),Ce=new m,Te=!1,Ie=_("skipping outgoing renegotiation because of pending incoming renegotiation"),Ae={},Me=0,Oe=v.callId||c(),ke=0,Ne=1,Pe=2,Re=3,Le=4,De=5,Ue=6,Fe=w("Inactive","ReceiveOnly","SendOnly","SendReceive","Unknown"),Be=ke,Ve=v.escalateAudioVideoUri,Ge=b({value:Ve?2:0}),He=b(),qe=ae.audio.isUnmuteRequested,We=b({value:!1})
	function je(e){k.invoke("MuteOrUnMute",t.MediaEnum.MediaDeviceType.MIC,e,!1)}a(se),Ce.resolve()
	var ze=b({value:!1,get:function(){return r.state(k.state(),O.State.Loaded),Qe()?ze():k.invoke("GetMuteStatus",t.MediaEnum.MediaDeviceType.MIC,!1)[1]},set:function(e){var n
	if(r.state(k.state(),O.State.Loaded),Qe()){var i=e?"muteAudio":"unmuteAudio",o=ee.get(ae[t.sInternal].audioLink)
	!e&&qe()?(qe(!1),je(e),n=y.resolve(e)):n=m.run((function(){return o&&o.hasLink(i)?o:ee.send("GET",ae[t.sInternal].audioLink)})).then((function(e){return ee.send("POST",e.link(i).href)})).then((function(){return!e&&qe()&&qe(!1),e}))}else je(e),n=y.resolve(e)
	return n}}),Ke=b({value:!1,get:function(){return r.state(k.state(),O.State.Loaded),Ke()},set:function(e){if(r.state(k.state(),O.State.Loaded),!Qe()&&oe.size()>0&&oe(0).audio.isOnHold()&&!Ke())return e
	var n=e?4:3,i=Ee.video&&Qe()
	return Ce.promise.then((function(){if(Te)throw Ie
	return Ce=new m,Me=Ee.video?e?4:ae[t.sInternal].videoStartedBeforeHold()?3:2:0,k.invoke("SetMediaConfig",n,Me,i?N.maxVideoChannelCount()-1:0,i?e?4:2:0,0),G=e,ae[t.sInternal].videoStartedBeforeHold(e?ae.video.channels(0).isStarted():void 0),ae[t.sInternal].audioOnHold(e),(V=new m(G?"hold":"resume")).promise.then((function(){return G}))})).then((function(){return function(e){var n=[]
	if(e){var i=function(e){var i=Ae[e],r=at(i,!0).then((function(){return i[t.sInternal].setVideoStarted(!1)}))
	n.push(r)}
	for(var r in Ae)i(r)}else{var o=function(e){var i=Ae[e],r=ot(i,!0).then((function(){return i[t.sInternal].setVideoStarted(!0)}))
	n.push(r)}
	for(var r in Ae)o(r)}return m.waitAll(n)}(e)})).then((function(){return e})).catch((function(e){throw I(e),pt("reject",e),"pending"==Ce.state()&&Ce.resolve(),e}))}})
	function Ye(){return N?m.wait(N):J.getMediaConfig().then((function(e){return N=e}))}function Qe(){var e,n=(ce=ce||((e=se&&se[t.sHref])?ee.get(e):null))&&ce.get("state","")
	return"Conferencing"==n||"Conferenced"==n}function Xe(){var e,t,n=u(l(ue),(function(e){return e.negotiated}))
	return n.length>0&&(a(1==n.length),e=(t=n[0]).resumeAudioVideoUri||t.resource.link("renegotiations").href,a(e)),e}function $e(n,i){n._isFlowing.changed((function(e,t,r){I("AudioVideoSession("+Oe+")::isFlowing changed:isPreview="+i,r+"=>"+e,t),e?ct(n,i):lt(n,i)})),n.source.sink.container.changed((function(e,t,r){I("AudioVideoSession("+Oe+")::container changed:isPreview="+i,r+"=>"+e,t),n._isFlowing()&&(r&&lt(n,i),e&&ct(n,i))})),n.source.sink.format.changed((function(r,o,a){var s=n.source.sink
	I("AudioVideoSession("+Oe+")::format changed:isPreview="+i,a+"=>"+r,o),r&&n._id()&&s._videoWindow()&&n._isFlowing()&&(k.invoke("SetVideoDisplayOptions",i?t.MediaEnum.MediaDeviceType.PREVIEW:t.MediaEnum.MediaDeviceType.RENDER,s._videoWindow(),s._format(),1),te&&te.record(e.TelemetryEvent.Call,{action:"SetVideoDisplayOptions",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),oldFormat:a,newFormat:r,reason:o,mediaDeviceType:i?"preview":"render",callId:Oe}))}))}function Je(e){a(e),delete Ae[e[t.sHref]]}function Ze(e){I("AudioVideoSession("+Oe+")::removeAllVideo",e),lt(we,!1),lt(Se,!0),we._isFlowing(!1),Se._isFlowing(!1),e!==t.sEscalation&&ae[t.sInternal].setVideoStream(null),oe.size()>0&&(oe(0)[t.sInternal].setVideoStream(null),oe(0)[t.sInternal].setVideoStarted(!1))}function et(){return de&&de.hasVideo()||pe&&"onlineMeetingInvitation"==pe.rel&&se.meeting.availableModalities.video()}function tt(){var e
	try{if(k&&(e=k.invoke("GetDiagnosticsBlob")),e&&0===e[0])return e[1]}catch(t){I("GetDiagnosticsBlob FAILURE",t)}}function nt(){return e.Media.useBrowserMedia()?void 0:Z&&Z.mediaCapabilities.installedVersion()}function it(t){if(z){I("AudioVideoSession("+Oe+")::postMediaDiagnostics",t)
	var n=tt()
	if(n){var i={data:{},nobatch:!0}
	i.headers={"X-MS-MediaDiagnostics":n},i.data.callId=Oe,t&&(t.code&&(i.data.errorCode=t.code),t.subcode&&(i.data.errorSubcode=t.subcode))
	var r=ee.send("POST",z,i)
	te&&te.monitor(r,e.TelemetryEvent.Call,{action:"postMediaDiagnostics",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:nt(),callId:Oe}),z=null}}}function rt(){if(K){var t
	try{t=k.invoke("GetQoeXml")}catch(i){I("GetQoeXml FAILURE",i)}if(t&&0===t[0]){if(t.length<3)return void I("Unexpected GetQoeXml result",t)
	var n=ee.send("POST",K,{data:{mediaEndpoint:t[1],mediaQualityOfExperience:t[2]},nobatch:!0})
	te&&te.monitor(n,e.TelemetryEvent.Call,{action:"publishCallQualityFeedback",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:nt(),callId:Oe}),K=null}}}function ot(n,i){return new y((function(e){if(be()==t.Modality.State.Connecting)var n=be.changed((function(i,r,o){i!=t.Modality.State.Connecting&&(n.dispose(),e())}))
	else e()})).then((function(){var r,o
	if(be()!=t.Modality.State.Connected)throw x(be(),t.Modality.State.Connected)
	if(Ke()&&!i)throw _("OnHold")
	if(I("AudioVideoSession("+Oe+")::showParticipantVideo",n),n[t.sInternal].isLocal())return!1===n.video.channels(0).isStarted()?Ce.promise.then((function(){if(Te)throw Ie
	return Ce=new m,Me=3,k.invoke("SetMediaConfig",3,Me,Qe()?N.maxVideoChannelCount()-1:0,Qe()?2:0,0),ut()})).catch((function(e){throw I(e),dt("reject",e),"pending"==Ce.state()&&Ce.resolve(),e})):(new m).resolve().promise
	if(Qe()){if(we._isAttached())for(var s=0,c=xe();s<c.length;s++){var l=c[s]
	if(!l._isAttached()){r=l
	break}}else r=we
	if(!r)throw I("Cannot find available stream"),S("No available stream")
	n[t.sInternal].setVideoStream(r),r._isAttached(!0),o=ct(r,!1).then((function(){try{k.invoke("Subscribe",r._id(),n[t.sInternal].videoSourceId())}catch(e){throw I("SUBSCRIBE ERROR: "+e),e}})).then((function(){var i=r.source.sink
	i._c(i.container.changed((function(e,t,n){n&&lt(r,!1),e&&ct(r,!1)}))),i._f(i.format.changed((function(n,o,a){n&&r._id()&&i._videoWindow()&&(k.invoke("SetVideoDisplayOptions",t.MediaEnum.MediaDeviceType.RENDER,i._videoWindow(),i._format(),1),te&&te.record(e.TelemetryEvent.Call,{action:"SetVideoDisplayOptions",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),oldFormat:a,newFormat:n,reason:o,mediaDeviceType:"render",callId:Oe}))}))),function(e){a(e),Ae[e[t.sHref]]=e}(n)}))}else o=(new m).reject(C("cannot start remote video in 1:1 conversation")).promise
	return o}))}function at(e,n){return I("AudioVideoSession("+Oe+")::removeParticipantVideo",e),e[t.sInternal].isLocal()?Ce.promise.then((function(){if(Te)throw Ie
	Ce=new m
	var e=oe(0).video.channels(0)
	return Me=Qe()||e.isVideoOn()?2:4,k.invoke("SetMediaConfig",3,Me,Qe()?N.maxVideoChannelCount()-1:0,Qe()?2:0,0),ut()})).catch((function(e){throw I(e),dt("reject",e),"pending"==Ce.state()&&Ce.resolve(),e})):Qe()?m.wait(null,"sync").then((function(){var i=e.video.channels(0).stream,r=i.source.sink
	if(r._c()&&r._c().dispose(),r._f()&&r._f().dispose(),n||Je(e),i._isAttached()){try{k.invoke("Unsubscribe",i._id())}catch(o){I("UNSUBSCRIBE ERROR: "+o)}lt(i,!1),i._isAttached(!1),e[t.sInternal].setVideoStream(null)}})):(new m).reject(C("cannot remove remote video in 1:1 conversation")).promise}function st(n){if(We())I("AudioVideoSession("+Oe+")::already cleaned up",n)
	else{te&&te.record(e.TelemetryEvent.Call,{action:"cleanup",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),reason:n,callId:Oe})
	var i=t.Modality.State.Disconnected
	if(I("AudioVideoSession("+Oe+")::cleanup",n),Qe()?ze._set(!1):ze.set(!1),Ke._set(!1),ae.audio.isMuted.get(),ae.audio.isOnHold.get(),ae[t.sInternal].audioOnHold(!1),ae[t.sInternal].videoStartedBeforeHold(void 0),ee.event.off(ft),k){k.event.off(Ct)
	try{Ze(n),k.invoke("Terminate"),k.unload()}catch(r){k.state()!=O.State.Unloaded&&I("AudioVideoSession("+Oe+"):: AV component cleanup failed",r)}k=null}j&&(j.dispose(),j=null),oe.each((function(e){e[t.sInternal].setVideoStream(null),n!==t.sEscalation&&(e.video.channels(0)[t.sInternal].isVideoOn(!1),e[t.sInternal].setVideoStarted(!1))})),n!==t.sEscalation&&(ae.video.channels(0)[t.sInternal].isVideoOn(!1),ae[t.sInternal].setVideoStarted(!1)),ye(i),be(i,n),H&&(H.dispose(),H=null),q&&(q.dispose(),q=null),W&&(W.dispose(),W=null),z=null,K=null,Te=!1,We(!0)}}function ct(e,n){var i=e.source.sink
	if(I("AudioVideoSession("+Oe+")::showVideo:isPreview="+n),e._id()&&i.container()){if(i._state()==O.State.Unloaded)return i._init().then((function(){k.invoke("SetVideoWindow",e._id(),n?t.MediaEnum.MediaDeviceType.PREVIEW:t.MediaEnum.MediaDeviceType.RENDER,i._videoWindow(),i._format(),1)}))
	I("AudioVideoSession("+Oe+")::showVideo:sink state:",i._state())}else I("AudioVideoSession("+Oe+")::showVideo:stream id:",e._id(),i.container())
	return y.resolve()}function lt(e,n){var i=e.source.sink
	I("AudioVideoSession("+Oe+")::removeVideo",n),e._id()&&i._videoWindow()?(k.invoke("RemoveVideoWindow",e._id(),n?t.MediaEnum.MediaDeviceType.PREVIEW:t.MediaEnum.MediaDeviceType.RENDER,i._videoWindow()),i._uninit()):I("AudioVideoSession("+Oe+")::removeVideo:stream id:",e._id(),i.container())}function ut(){return(B=new m("selfVideo")).promise}function dt(e,t){B&&"pending"==B.state()&&("resolve"==e?B.resolve():"reject"==e&&B.reject(t))}function pt(e,t){V&&"pending"==V.state()&&("resolve"==e?V.resolve(G):"reject"==e&&V.reject(t))}function ft(e){var t=e.target.rel+" "+e.type,n=mt[t]
	n&&(I("AudioVideoSession("+Oe+")::onServerEvent:",e),n(e.status,e.resource,e))}v=null,ee.event(ft),j=M().state.changed((function(e,n,i){if(e==M.State.Uninitialized&&null!=i){var r="PluginUninited"
	U&&"pending"==U.state()?U.reject(r):F&&"pending"==F.state()?F.reject(r):(st(r),ge(t.Modality.State.Disconnected))}})),A("AudioVideoSession("+Oe+")::state:",ge),A("AudioVideoSession("+Oe+")::audioState:",ye),A("AudioVideoSession("+Oe+")::videoState:",be),ge.when(t.Modality.State.Disconnected,(function(){ye(t.Modality.State.Disconnected),be(t.Modality.State.Disconnected)})),be.when(t.Modality.State.Disconnected,(function(e){I("AudioVideoSession("+Oe+")::resetVideo",e),oe.each((function(e){e[t.sInternal].setVideoStream(null)})),we._isFlowing(!1),Se._isFlowing(!1),xe.empty(),e!==t.sEscalation&&(ae[t.sInternal].setVideoStream(null),ae[t.sInternal].videoState(t.Modality.State.Disconnected))})),oe.removed((function(e){var n=e[t.sInternal].audioSourceId()
	delete _e[n],L==n&&(L=-1),Je(e)})),$e(Se,!0),Qe()||$e(we,!1),s($,{state:ge.asReadOnly(),audioState:ye.asReadOnly(),videoState:be.asReadOnly(),start:o((function(e){if(0!=e.mainVideoConfig&&Ee.video||0==e.mainVideoConfig&&3==e.audioConfig&&Ee.audio)return m.wait("already started")
	I("AudioVideoSession("+Oe+")::start",e),r.state(Ke(),!1),U=new m("starting a call")
	var n=e.audioConfig,o=e.video&&e.video.previewContainer,a=e.video&&e.video.container,s=0!=e.mainVideoConfig,c=Me
	Me=e.mainVideoConfig,R=R||e.remoteUri,e=null,r.state(ge(),[t.Modality.State.Disconnected,t.Modality.State.Notified,t.Modality.State.Connected]),(ge()==t.Modality.State.Disconnected||ge()==t.Modality.State.Notified)&&ge(t.Modality.State.Connecting),ye()!=t.Modality.State.Disconnected&&ye()!=t.Modality.State.Notified||(ye(t.Modality.State.Connecting),!Qe()&&oe.size()>0&&oe(0)[t.sInternal].audioState(t.Modality.State.Connecting)),s||be(t.Modality.State.Disconnected),(be()==t.Modality.State.Disconnected&&s||be()==t.Modality.State.Notified)&&(be(t.Modality.State.Connecting),!Qe()&&oe.size()>0&&oe(0)[t.sInternal].videoState(t.Modality.State.Connecting))
	var l=Ye().then((function(){if(!k)return(k=J.createComponent({type:"AVComponent",hide:!0})).event(Ct,"async"),k.load(ve,Qe()?i():R,se.threadId(),Qe(),Qe()?N.maxVideoChannelCount():1,N.audioVideoSecurityLevel())})).then((function(){return Ce.promise.then((function(){if(s&&"Connected"==ye()){if(Te)throw Ie
	Ce=new m}}))})).then((function(){var e=0!=Me&&Qe()
	Z&&!Z.selectedMicrophone()&&N.setDefaultDevices(),k.invoke("SetCallConfig",N.isInternal()?t.MediaEnum.PreferredMediaAddressType.Direct:t.MediaEnum.PreferredMediaAddressType.Relay),ae[t.sInternal].setVideoStream(Se),a&&we.source.sink.container(a),o&&Se.source.sink.container(o),k.invoke("SetMediaConfig",n,Me,e?N.maxVideoChannelCount()-1:0,e?2:0,0),ye()==t.Modality.State.Connecting&&!Qe()&&oe.size()>0&&oe(0)[t.sInternal].audioState(t.Modality.State.Ringing),s&&"Connected"==ye()&&ut(),U.status("waiting for an OFFER_READY event from the media plugin")}))
	return m.waitAll([l,U.promise]).catch((function(e){if(I("AudioVideoSession("+Oe+")::start failed",e),e==Ie&&s&&"Connected"==ye())throw Me=c,be(t.Modality.State.Disconnected),!Qe()&&oe.size()>0&&oe(0)[t.sInternal].videoState()==t.Modality.State.Connecting&&oe(0)[t.sInternal].videoState(t.Modality.State.Disconnected),"pending"==U.state()&&U.reject(e),e
	throw it(),le?le.hasLink("cancel")&&ee.send("POST",le.link("cancel").href,{nobatch:!0}):st(e),"pending"==U.state()&&U.reject(e),"pending"==Ce.state()&&Ce.resolve(),ge(t.Modality.State.Disconnected),ye(t.Modality.State.Disconnected),be(t.Modality.State.Disconnected),e}))})),stop:o((function(n){if(I("AudioVideoSession("+Oe+")::stop",n),ge()==t.Modality.State.Connecting){var i=U||F
	return i?(i.promise.cancel(),y.resolve()):(I("AudioVideoSession("+Oe+"):: stop cannot be called in Connecting state without a pending start or accept"),y.reject(C("stop cannot be called in Connecting state without a pending start or accept")))}var r=new m
	if("video"==n){Qe()&&oe.each((function(e){e.video.channels(0).isStarted(!1)}))
	var o=Ke()?4:3
	Me=0,k.invoke("SetMediaConfig",o,Me,Qe()?N.maxVideoChannelCount()-1:0,0,0),r.resolve()}else n===t.sEscalation||n&&"NotFound"==n.code?(st(n),r.resolve()):(rt(),r.from(ee.send("GET",ce.link("audioVideo").href).then((function(e){var t={query:{reason:"UserInitiatedAction"}},n=tt()
	return n&&s(t,{headers:{"X-MS-MediaDiagnostics":n}}),ee.send("POST",e.link("stopAudioVideo").href,t)})).catch((function(t){te&&te.record(e.TelemetryEvent.Call,{action:"stopAudioVideo",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),reason:t,callId:Oe})})).finally((function(){return st(n)}))))
	return r.promise.then((function(){}))})),cleanup:st,sendDtmf:function(e){return k.invoke("SendDTMF",t.MediaEnum.DtmfTone[e]),y.resolve(e)},changed:Y.observer,escalated:Q.observer,errorOccured:X.observer,muted:ze,onHold:Ke,selfVideoStream:Se,showParticipantVideo:ot,removeParticipantVideo:at,removeVideo:o(Ze),escalationState:Ge,preEscalationVideoConfig:He,isClean:We.asReadOnly()}),de&&s($,{from:de.from,accept:o((function(e){a(de,'This is an outgoing call, so it cannot be "accepted"'),a(!Qe(),"This is a conference"),a(1==oe.size(),"The caller is not in participants"),I("AudioVideoSession("+Oe+")::accept",e),F=new m("accepting a call")
	var n=e&&e.video,i=n&&n.container,r=n&&n.previewContainer
	Me=n?t.MediaEnum.enumcastDirection(n.direction):re&&0==re.supportsVideo?0:2,ge(t.Modality.State.Connecting),ye(t.Modality.State.Connecting),oe(0)[t.sInternal].audioState(t.Modality.State.Connecting),de.hasVideo()&&(be(t.Modality.State.Connecting),oe(0)[t.sInternal].videoState(t.Modality.State.Connecting))
	var o=Ye().then((function(){if(ge()==t.Modality.State.Disconnected)throw t.EInvitationFailed(ge.reason)
	return a(!k),(k=J.createComponent({type:"AVComponent",hide:!0})).event(Ct,"async"),k.load(ve,de.from.uri(),de.resource.get("threadId"),!1,1,N.audioVideoSecurityLevel())})).then((function(){if(ge()==t.Modality.State.Disconnected)throw t.EInvitationFailed(ge.reason)
	Z&&!Z.selectedMicrophone()&&N.setDefaultDevices(),ae[t.sInternal].setVideoStream(Se),i&&we.source.sink.container(i),r&&Se.source.sink.container(r),k.invoke("SetCallConfig",N.isInternal()?t.MediaEnum.PreferredMediaAddressType.Direct:t.MediaEnum.PreferredMediaAddressType.Relay),k.invoke("SetAcceptedMedia",3,Me),function(e){a(e.length>=0)
	var t,n,i=["SetOffer",!1,e.length]
	for(t=0;t<e.length;t++)n=e[t],a("sdp"in n),a("id"in n),i.push(n.sdp),i.push(n.id)
	k.invoke.apply(k,i)}(de.offers),F.status("awaiting an ANSWER_READY event from the media plugin")}))
	return m.waitAll([o,F.promise]).catch((function(e){throw I("AudioVideoSession("+Oe+")::accept failed",e),it(),ge(t.Modality.State.Disconnected),ye(t.Modality.State.Disconnected),be(t.Modality.State.Disconnected),st(),"pending"==F.state()&&F.reject(e),e}))}))})
	var mt={"audioVideoInvitation started":function(n,i){if("Outgoing"==i.get("direction")&&i.get("sessionContext")==me)if(ge()==t.Modality.State.Disconnected){if(i.hasLink("cancel")){var r=ee.send("POST",i.link("cancel").href,{nobatch:!0})
	te&&te.monitor(r,e.TelemetryEvent.Call,{action:"cancel",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),callId:Oe})}st()}else le=i,i.hasLink("reportMediaDiagnostics")&&(z=i.link("reportMediaDiagnostics").href),U.status('awaiting "audioVideoNegotiation started or completed" event from UCWA')},"conversation added":function(e,t){t.get("threadId")==se.threadId()&&(ce=t)},"audioVideoNegotiation started":function(t,n,i){var r,o,a
	le&&i.sender.href==le.href&&(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoNegotiationStarted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),hasAnswer:n.hasLink("mediaProvisionalAnswer"),callId:Oe}),n.hasLink("mediaProvisionalAnswer")&&(r=n.link("mediaProvisionalAnswer").href,o=n.get("remoteEndpoint"),a=g(r).data,I("Provisional answer from the remote party:\n"+a),k.invoke("SetProvisionalAnswer",!0,!0,o,a),U.status('awaiting "audioVideoNegotiation completed" event from UCWA')))},"audioVideoNegotiation completed":function(t,n,i){var r
	if(le&&i.sender.href==le.href)switch(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoNegotiationCompleted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:t,reason:i.reason,hasAnswer:n&&n.hasLink("mediaAnswer"),callId:Oe}),t){case"Success":r=n.link("audioVideoSession").href,ue[r]=ue[r]||{},ue[r].negotiated=!0,It(n.link("mediaAnswer").href,n.get("remoteEndpoint")),U.status('awaiting "audioVideoInvitation completed" event from UCWA')
	break
	case"Failure":"Ended"!=i.reason.subcode&&"ConnectedElsewhere"!=i.reason.subcode&&U&&U.status(i.reason&&i.reason.message)}},"audioVideoSession added":function(t,n){var i=n.href
	n.get("sessionContext")==me&&(ue[i]=ue[i]||{},ue[i].resource=n,n.hasLink("publishCallQualityFeedback")&&(K=n.link("publishCallQualityFeedback").href),te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoSessionAdded",type:Qe()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",callId:Oe,href:i}))},"audioVideoSession updated":function(e,t){t.get("sessionContext")==me&&t.hasLink("publishCallQualityFeedback")&&(K=t.link("publishCallQualityFeedback").href)},"audioVideoSession deleted":function(t,n,i){i.target.href in ue&&(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoSessionDeleted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:t,reason:i.reason,callId:Oe}),delete ue[i.target.href],2==Ge()&&p(ue)&&(Q.fire("failure"),Ge(0)))},"audioVideoInvitation completed":function(n,i,r){if(le&&le.href==i.href&&"Incoming"==i.get("direction"))if(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoInvitationCompleted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:n,reason:r.reason,sessionContext:i.get("sessionContext",void 0),direction:"Incoming",callId:Oe}),"Success"==n)try{s=i.get("sessionContext"),d(ue,(function(e){e.resource.get("sessionContext")==s&&(e.negotiated=!0)})),At(n,r.reason),a(!Qe())
	var o=oe(0)
	o&&(o[t.sInternal].audioState(t.Modality.State.Connected),be()==t.Modality.State.Connected&&(o[t.sInternal].setVideoStream(we),o[t.sInternal].videoState(t.Modality.State.Connected))),F.resolve(),ge(t.Modality.State.Connected)}catch(c){F.reject(c),ge(t.Modality.State.Disconnected)}else F&&F.reject(r.reason),ge(t.Modality.State.Disconnected,r.reason)
	var s},"audioVideoRenegotiation started":function(n,i){if(i.link("audioVideoSession").href in ue)if(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoRenegotiationStarted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:n,hasOffer:i.hasLink("mediaOffer"),direction:i.get("direction",void 0),callId:Oe}),"Incoming"==i.get("direction")){var r=g(i.link("mediaOffer").href).data
	!Qe()&&oe.size()>0&&(Be=function(e){return/\ba=inactive\b/gim.test(e)}(r)?Ne:Le),P=i,Te=!0,Ce.promise.then((function(){(function(e){var n,i="",r=Ke()?4:3
	n=Ke()||!/\bm=video\b/gim.test(e)?4:be()!=t.Modality.State.Connected||1!=Me&&3!=Me?re&&0==re.supportsVideo?0:2:3,I("Incoming SDP offer:\n"+e),k.invoke("SetAcceptedMedia",r,n),k.invoke("SetOffer",!1,1,e,i)})(r)})).catch((function(e){I(e),st(e),ge(t.Modality.State.Disconnected,e),Te=!1}))}else U&&"pending"==U.state()?U.status("Waiting for audioVideoRenegotiation completed event"):B&&"pending"==B.state()?B.status("Waiting for audioVideoRenegotiation completed event"):V&&"pending"==V.state()&&V.status("Waiting for audioVideoRenegotiation completed event")},"audioVideoRenegotiation completed":function(t,n,i){var r,o=n.link("audioVideoSession").href
	if(o in ue)if(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoRenegotiationCompleted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:t,reason:i.reason,hasAnswer:n.hasLink("mediaAnswer"),operationId:n.get("operationId",void 0),direction:n.get("direction",void 0),callId:Oe}),"Outgoing"==n.get("direction")){a(n.get("operationId")in he),delete he[n.get("operationId")]
	try{"Success"==t&&(ue[o].renegotiated=!0,It(n.link("mediaAnswer").href,ue[o].resource.get("remoteEndpoint"))),At(t,i.reason)}catch(s){t="Failure",r=s}"Success"==t?(dt("resolve"),pt("resolve")):(dt("reject",r||i.reason),pt("reject",r||i.reason)),U&&"pending"==U.state()&&("Success"==t?U.resolve():U.reject(r||i.reason)),Ce.resolve()}else Qe()||(Be==Pe?Be=Re:Be==De&&(Be=Ue)),At(t,i.reason),Te=!1},"audioVideo updated":function(n,i,r){var o
	le&&le.hasLink("audioVideo")&&i.href==le.link("audioVideo").href&&(te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoUpdated",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:i.get("state",void 0),status:n,reason:r.reason,callId:Oe}),"Disconnected"==i.get("state")?(it(r.reason),rt(),"Connected"==le.get("state")&&(st(),ge(t.Modality.State.Disconnected))):"Connected"==i.get("state")&&(i.hasLink("reportMediaDiagnostics")&&(z=i.link("reportMediaDiagnostics").href),Qe()&&(o=i).hasLink("publishTelemetry")&&ee.send("POST",o.link("publishTelemetry").href,{nobatch:!0,headers:{"Content-Type":"application/json"},data:'{startTime:"\\/Date('+f()+')\\/", endTime:"\\/Date('+(f()+1)+')\\/"}'}),r.reason&&"SessionSwitched"==r.reason.subcode&&i.link("audioVideoSession").href in ue&&(Q.fire("success"),Ge(0))))},"participantAudio added":yt,"participantAudio updated":yt,"participantAudio deleted":yt,"participantVideo added":bt,"participantVideo updated":bt,"participantVideo deleted":bt,"escalateAudio deleted":function(e,t,n){n.target.href==Ve&&(Ve=null)},"resumeAudio added":St,"resumeAudioVideo added":St,"resumeAudio deleted":xt,"resumeAudioVideo deleted":xt}
	function ht(e){var i=n(oe(),(function(n){return n[t.sHref]==e}))
	return i||(Qe()||1!=oe.size()?ee.send("GET",e).then((function(e){return ht(e.link("contact").href)})):oe(0))}function vt(e){var n=e[t.sInternal]
	return k&&n.isInMediaRoster[k.id()]}function gt(e,n){try{var i="add"==n?"AddParticipantInfo":"remove"==n?"RemoveParticipantInfo":"update"==n?"UpdateParticipantInfo":a(!1),r=e[t.sInternal]
	return!!k&&(k.invoke(i,r.audioSourceId(),r.videoSourceId(),-1),r.isInMediaRoster[k.id()]="remove"!=n,!0)}catch(o){return I("Media Roster ERROR: "+o),!1}}function yt(e,n,i){var r=i.in
	if(ce&&i.sender.href==ce.href&&r)if("localParticipant"==r.rel)switch(i.type){case"added":case"updated":if(Qe()&&1!=Ge()){if(ae[t.sInternal].setMediaSourceId(i),n.has("audioDirection"),n.has("audioMuted")){var o=n.get("audioMuted")
	ze.get().then((function(){o&&ze()&&qe()&&(qe(!1),je(!1)),o&&!ze()&&ze._set(o),!o&&ze()&&(qe(!0),je(!0)),ae.audio.isMuted.get()}))}for(var s=0,c=oe();s<c.length;s++){var l=c[s];-1==l[t.sInternal].audioSourceId()&&Et(l)}}Ee.audio=!0,ye(t.Modality.State.Connected)
	break
	case"deleted":Ee.audio=!1,ye(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}else"participant"==r.rel&&m.wait(ht(r.href)).then((function(e){switch(i.type){case"added":case"updated":Qe()&&(e[t.sInternal].setMediaSourceId(i),ee.send("GET",i.target.href).then((function(n){n.has("audioDirection")&&e[t.sInternal].audioOnHold(n.get("audioDirection")==Fe.Inactive),n.has("audioMuted")&&e[t.sInternal].audioMuted(n.get("audioMuted")),n.has("audioSourceId")&&e[t.sInternal].audioSourceId(+n.get("audioSourceId"))}))),e[t.sInternal].audioState(t.Modality.State.Connected)
	break
	case"deleted":e[t.sInternal].audioState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}}))}function bt(e,n,i){var r=i.in
	if(ce&&i.sender.href==ce.href&&r)if("localParticipant"==r.rel)switch(i.type){case"added":case"updated":if(Ee.video=!0,Qe()){ae[t.sInternal].setMediaSourceId(i),gt(ae,vt(ae)?"update":"add")
	for(var o=function(e){vt(e)||Et(e).then((function(n){-1!=n&&(e.video.channels(0)[t.sInternal].isVideoOn()||_t(e,"Video").then((function(t){t&&ee.send("GET",t).then((function(t){wt(e,{resource:t},!1)}))})),gt(e,"add"))}))},s=0,c=oe();s<c.length;s++)o(c[s])
	wt(ae,i,!0)}else be(t.Modality.State.Connected),ae[t.sInternal].videoState(t.Modality.State.Connected)
	break
	case"deleted":lt(Se,!0),Ee.video=!1,Qe()&&(vt(ae)&&gt(ae,"remove"),ae[t.sInternal].setMediaSourceId(i)),ae.video.channels(0)[t.sInternal].isVideoOn(!1),ae[t.sInternal].setVideoStarted(!1),be(t.Modality.State.Disconnected),ae[t.sInternal].videoState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}else"participant"==r.rel&&m.wait(ht(r.href)).then((function(e){switch(i.type){case"added":case"updated":Qe()?(e[t.sInternal].setMediaSourceId(i),gt(e,vt(e)?"update":"add"),wt(e,i).then((function(){Ke()&&!e.video.channels(0).isVideoOn()&&Je(e)}))):(e[t.sInternal].setVideoStream(we),e[t.sInternal].videoState(t.Modality.State.Connected))
	break
	case"deleted":Qe()?(vt(e)&&gt(e,"remove"),e[t.sInternal].setMediaSourceId(i),at(e)):e[t.sInternal].setVideoStream(null),e.video.channels(0)[t.sInternal].isVideoOn(!1),e[t.sInternal].setVideoStarted(!1),e[t.sInternal].videoState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}}))}function _t(n,i){var r=i.toLowerCase()+"Link"
	return n[t.sInternal][r]?y.resolve(n[t.sInternal][r]):n[t.sHref]?ee.send("GET",n[t.sHref]).then((function(e){var t="participant"+i
	if(e.hasLink(t))return e.link(t).href})):(te&&te.record(e.TelemetryEvent.Call,{action:"getAudioVideoHref",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),result:"failed",reason:"no href for participant",callId:Oe}),y.resolve())}function Et(e){return(-1!=e[t.sInternal].audioSourceId()?y.resolve():_t(e,"Audio").then((function(e){return e&&ee.send("GET",e)})).then((function(n){return n&&n.has("audioSourceId")&&e[t.sInternal].audioSourceId.set(+n.get("audioSourceId"))}))).then((function(){return e[t.sInternal].audioSourceId()}))}function wt(e,n,i){void 0===i&&(i=!1)
	var r=n.resource,o=n.target
	return m.run((function(){return r&&r.has("videoDirection")?r:o&&ee.send("GET",o.href)})).then((function(n){if(n&&n.has("videoSourceId")&&e[t.sInternal].videoSourceId(+n.get("videoSourceId")),n&&n.has("videoDirection")){var r=n.get("videoDirection")
	e.video.channels(0)[t.sInternal].isVideoOn(r===Fe.SendOnly||r===Fe.SendReceive),r!=Fe.Inactive&&r!=Fe.Unknown&&(i&&be(t.Modality.State.Connected),e[t.sInternal].videoState(t.Modality.State.Connected),e[t.sInternal].audioState(t.Modality.State.Connected))}}))}function St(e,t,n){var i,r=n.in
	r&&"audioVideoSession"==r.rel&&r.href in ue&&(i=r.href,ue[i].resumeAudioVideoUri=n.target.href,m.wait(null).then((function(){if(!ue[i].renegotiated)return ee.wait({type:"completed",target:{rel:"audioVideoRenegotiation"},resource:function(e){return"Outgoing"==e.get("direction")&&e.link("audioVideoSession").href in ue}})})).then((function(){var e,t,n
	e=Ke()?4:3,t=4==He()?2:He(),n=0!=(Me=Ee.video?Ke()?4:null!=t?t:2:0),k.invoke("SetMediaConfig",e,Me,n?N.maxVideoChannelCount()-1:0,n?2:0,0)})))}function xt(e,t,n){var i=n.in
	i&&"audioVideoSession"==i.rel&&i.href in ue&&n.target.href==ue[i.href].resumeAudioVideoUri&&delete ue[i.href].resumeAudioVideoUri}function Ct(e){var t=Tt[e.type]
	t&&(I("AudioVideoSession("+Oe+")::onPluginComponentEvent:",e),t.apply(null,e.args))}var Tt={CHANNEL_CREATED:function(e,n,i){switch(e){case 1:D={channelType:e,channelId:n}
	break
	case 2:i?(we._id(n),Se._id(n)):(xe.add(new t.MediaStream({mediaPlugin:J,type:t.MediaEnum.StreamType.Render,id:n})),a(xe.size()<N.maxVideoChannelCount()),I("Num streams created: "+xe.size()))
	break
	default:I("Created a channel of unknown type "+e)}},CHANNEL_DISCONNECTED:function(e,n,i){2!==e||we._id()!==n||Qe()||(ae.video.channels(0)[t.sInternal].isVideoOn(!1),oe(0).video.channels(0)[t.sInternal].isVideoOn(!1),be(t.Modality.State.Disconnected))},CHANNEL_DIRECTION_CHANGED:function(e,n,i){if(Be==Re?(4!=i||Qe()||oe(0)[t.sInternal].audioOnHold(!0),Be=ke):Be==Ue&&(Qe()||oe(0)[t.sInternal].audioOnHold(!1),Be=ke),2==e&&Se._id()==n){switch(i){case 1:case 3:ae[t.sInternal].setVideoStarted(!0),Se._isFlowing(!0),ae.video.channels(0)[t.sInternal].isVideoOn(!0)
	break
	case 2:case 4:ae[t.sInternal].setVideoStarted(!1),Se._isFlowing(!1),ae.video.channels(0)[t.sInternal].isVideoOn(!1)
	break
	default:ae[t.sInternal].setVideoStarted(!1),ae.video.channels(0)[t.sInternal].isVideoOn(!1)}if(!Qe())switch(a(we._id()==n),He(i),i){case 1:case 4:oe(0)[t.sInternal].setVideoStarted(!1),we._isFlowing(!1),oe(0).video.channels(0)[t.sInternal].isVideoOn(!1)
	break
	case 2:case 3:oe(0)[t.sInternal].setVideoStarted(!0),we._isFlowing(!0),oe(0).video.channels(0)[t.sInternal].isVideoOn(!0)
	break
	default:oe(0)[t.sInternal].setVideoStarted(!1),oe(0).video.channels(0)[t.sInternal].isVideoOn(!1)}}},MEDIA_CHANGED:function(n,i,r,o){var a
	2==n?(a=t.MediaEnum.enumcastStreamState(o),we._id()==i&&2==r?we._state(a):Se._id()==i&&1==r?(a===t.MediaEnum.StreamState.Inactive&&Qe()&&0===oe().map((function(e){return e.audio.state()})).filter((function(e){return e===t.Modality.State.Connected})).length&&ae.video.channels(0).isVideoOn()?Se._state(t.MediaEnum.StreamState.Active):Se._state(a),1===o?H=Z.selectedCamera.changed((function(e){try{e&&k&&k.invoke("SetCameraDevice",e.name())}catch(t){I("AudioVideoSession("+Oe+") error handling selectedCamera changed "+t)}}),"async"):4===o&&H&&(H.dispose(),H=null)):xe.each((function(e){e._id()==i&&e._state(a)}))):1==n&&D&&i==D.channelId&&2===o&&e.setTimeout((function(){2==r?W=W||Z.selectedSpeaker.changed((function(e){try{e&&k&&k.invoke("SetAudioDevice",t.MediaEnum.MediaDeviceType.SPEAKER,e.name())}catch(n){I("AudioVideoSession("+Oe+") error handling selectedSpeaker changed "+n)}}),"async"):1==r&&(q=q||Z.selectedMicrophone.changed((function(e){try{e&&k&&k.invoke("SetAudioDevice",t.MediaEnum.MediaDeviceType.MIC,e.name())}catch(n){I("AudioVideoSession("+Oe+") error handling selectedMicrophone changed "+n)}}),"async"))}),500)},DOMINANT_SPEKAER_CHANGED:function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n]
	var i,r=e[1],o=_e[L]
	o&&o[t.sInternal].isSpeaking(!1),-1!=r?((i=_e[r])||(ae[t.sInternal].audioSourceId()==r?i=ae:oe.each((function(e){e[t.sInternal].audioSourceId()==r&&(i=e)})),i&&(_e[r]=i)),i&&(i[t.sInternal].isSpeaking(!0),L=r)):L=r},OFFER_READY:function(n,r,c){for(var l=[],u=3;u<arguments.length;u++)l[u-3]=arguments[u]
	te&&te.record(e.TelemetryEvent.Call,{action:"OFFER_READY",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),hasOffer:n,diagCode:r,sdpCount:c,isRenegotiation:!!Xe(),callId:Oe})
	var d,p,f=[]
	try{for(d=0;d<c;d++)f.push({sdp:l[2*d],id:l[2*d+1]})
	if(0==f.length)throw _("NoSdpOffers",{diagCode:r})
	if(p=Xe())return Ce&&"pending"==Ce.state()||(Ce=new m),y.resolve().then((function(){if(Te)throw Ie
	return function(e,t){I("Renegotiation SDP offer:\n",e)
	var n=i()
	return he[n]="",ee.send("POST",t,{headers:{"Content-Type":"application/sdp"},query:{operationId:n},data:e,nobatch:!0})}(f[0].sdp,p)})).catch((function(e){I(e),dt("reject",e),pt("reject",e),At("Failure",e&&e.code),Ce.resolve()}))
	U.status("Waiting for audioVideoInvitation completed"),function(n){function i(e,i,r){var o,a="9BCE36B8-2C70-44CA-AAA6-D3D332ADBD3F",c={nobatch:!0}
	return Qe()?Ve?c={headers:{"Content-Type":"multipart/alternative;boundary="+a+';type="application/sdp"',"Content-Length":""+(o=t.multipartSDP(n,a)).length},query:{operationId:fe,sessionContext:me},data:o,nobatch:!0}:(c.data=t.multipartJsonAndSDP({offers:n,boundary:a,operationId:fe,sessionContext:me,threadId:se.threadId(),context:e,contextType:i}),c.headers={"Content-Type":"multipart/related;boundary="+a+';type="application/vnd.microsoft.com.ucwa+json"'}):(c.data=t.multipartJsonAndSDP({to:r?void 0:R,offers:n,boundary:a,subject:se.topic(),importance:se.priority(),operationId:fe,sessionContext:me,threadId:se.threadId(),context:e,contextType:i}),c.headers={"Content-Type":"multipart/related;boundary="+a+';type="application/vnd.microsoft.com.ucwa+json"'}),void 0!==e&&s(c.headers,{"X-MS-RequiresMinResourceVersion":2}),c}return a(n.length>0),o(Mt).call(null).then((function(n){var r,o,a=i(n.revision>=2?ne:void 0,ie,"addAudioVideo"==n.rel)
	return r=ee.send("POST",n.href,a).then((function(e){le||(le=e)})).catch((function(e){if(I("AudioVideoSession("+Oe+"):sendOffer: startAudioVideo failed",e),se.isThreadIdRejectedError(e))return se.resetThreadId(),a=i(n.revision>=2?ne:void 0,ie,"addAudioVideo"==n.rel),ee.send("POST",n.href,a)
	throw e})),o=ee.wait({type:"completed",target:{rel:"audioVideoInvitation"},resource:{direction:"Outgoing",threadId:se.threadId(),operationId:fe,sessionContext:me}}).then((function(n){if(I("AudioVideoSession("+Oe+"):sendOffer: audioVideoInvitation completed",n),te&&te.record(e.TelemetryEvent.Call,{action:"audioVideoInvitationCompleted",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),status:n.status,reason:n.reason,direction:"Outgoing",callId:Oe}),"Failure"==n.status)throw le=n.resource,At(n.status,n.reason),t.EInvitationFailed(n.reason)
	At(n.status,n.reason)})),m.waitAll([r,o])}))}(f).then((function(){U.resolve(),ge(t.Modality.State.Connected)})).catch((function(e){"pending"==U.state()&&U.reject(e),st()}))}catch(h){I(h),U&&"pending"==U.state()&&U.reject(h)}},ANSWER_READY:function(t,n){I("SDP Answer:\n"+n),te&&te.record(e.TelemetryEvent.Call,{action:"ANSWER_READY",type:Qe()?"conf":"p2p",modalities:Ee.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:ge(),isRenegotiation:!!P,callId:Oe}),P?(Qe()||(Be==Ne?Be=Pe:Be==Le&&(Be=De)),ee.send("POST",P.link("answer").href,{headers:{"Content-Type":"application/sdp"},data:n,nobatch:!0})):(F.status("sending answer to UCWA"),de.acceptWithAnswer(n,me).then((function(){F.status('awaiting an "audioVideoInvitation completed" event from UCWA')})).catch((function(e){return F.reject(e)})))},VIDEO_SIZE_CHANGED:function(e,t,n){if(we.source.sink._videoWindow()==e)we._setResolution(t,n)
	else if(Se.source.sink._videoWindow()==e)Se._setResolution(t,n)
	else for(var i=0,r=xe();i<r.length;i++){var o=r[i]
	o.source.sink._videoWindow()==e&&o._setResolution(t,n)}}}
	function It(e,t){var n=g(e).data
	I("Final answer from the remote party:\n"+n),k.invoke("SetFinalAnswer",t,n)}function At(e,n){var i
	k&&(i="Success"==e?t.MediaEnum.NegotiationStatus.NS_SUCCESS:n&&"RemoteFailure"==n.code?t.MediaEnum.NegotiationStatus.NS_REMOTE_INTERNAL_ERROR:t.MediaEnum.NegotiationStatus.NS_LOCAL_INTERNAL_ERROR,k.invoke("CompleteNegotiation",i))}function Mt(){if(!ce){var e=ee.get(ee.app.relatedHref("communication")).link("startAudioVideo")
	return e.rel="startAudioVideo",e}return Ve?ee.get(Ve):ee.send("GET",ce.link("audioVideo").href).then((function(e){var t=e.link("addAudioVideo")
	return t.rel="addAudioVideo",t}))}return T($,t.sInternal,{callId:Oe,onParticipantDeleted:function(e){var n=e.target
	if(ce&&e.sender.href==ce.href&&"participant"==n.rel&&"deleted"==e.type&&!e.in)return m.wait(ht(n.href)).then((function(n){if(Qe())return vt(n)&&gt(n,"remove"),n[t.sInternal].setMediaSourceId(e),n.video.channels(0)[t.sInternal].isVideoOn(!1),n[t.sInternal].setVideoStarted(!1),n[t.sInternal].videoState(t.Modality.State.Disconnected),at(n)
	n[t.sInternal].setVideoStream(null)}))}}),I("AudioVideoSession("+Oe+") created"),$}
	t.AudioVideoSession=k})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.map,i=e.Utils.async,r=e.Utils.check,o=e.Utils.contains,a=e.Utils.DataUri,s=e.Utils.HttpHeaders,c=e.Stack.parseMultipartRelatedResponse
	t.AudioVideoInvitation=function(e){var t=e.resource,l=e.ucwa,u=e.from
	r.equals(t.rel,"audioVideoInvitation")
	var d=function(){var e,i,r
	if(!(e=t.relatedHref("mediaOffer")))return[]
	i=a(e)
	try{return r=c({status:null,responseText:i.data,headers:{"Content-Type":"multipart/related;boundary="+i.attributes.boundary}}),n(r,(function(e){var t=s(e.headers)
	return{sdp:e.responseText,id:t.get("Content-ID")}}))}catch(o){return[{sdp:i.data,id:""}]}}()
	return{resource:t,acceptWithAnswer:i((function(e,n){var i=t.link("acceptWithAnswer").href
	return l.send("POST",i,{headers:{"Content-Type":"application/sdp"},query:{sessionContext:n},data:e,nobatch:!0})})),decline:i((function(e){return l.send("POST",t.link("decline").href,{data:{reason:e},nobatch:!0})})),offers:d,from:u,hasVideo:function(){return o(d,(function(e){return/\bm=video\b/gim.test(e.sdp)}))}}}})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){var t,n,i,r,o,a=window.setTimeout
	window.setTimeout=function(e){return e()},function(e){var t,o,a,s,c={},l={},u={},d={},p=Object.prototype.hasOwnProperty,f=[].slice,m=/\.js$/
	function h(e,t){return p.call(e,t)}function v(e,t){var n,i,r,o,a,s,c,l,d,p,f,h=t&&t.split("/"),v=u.map,g=v&&v["*"]||{}
	if(e&&"."===e.charAt(0))if(t){for(h=h.slice(0,h.length-1),a=(e=e.split("/")).length-1,u.nodeIdCompat&&m.test(e[a])&&(e[a]=e[a].replace(m,"")),e=h.concat(e),d=0;d<e.length;d+=1)if("."===(f=e[d]))e.splice(d,1),d-=1
	else if(".."===f){if(1===d&&(".."===e[2]||".."===e[0]))break
	d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2))
	if((h||g)&&v){for(d=(n=e.split("/")).length;d>0;d-=1){if(i=n.slice(0,d).join("/"),h)for(p=h.length;p>0;p-=1)if((r=v[h.slice(0,p).join("/")])&&(r=r[i])){o=r,s=d
	break}if(o)break
	!c&&g&&g[i]&&(c=g[i],l=d)}!o&&c&&(o=c,s=l),o&&(n.splice(0,s,o),e=n.join("/"))}return e}function g(t,n){return function(){return o.apply(e,f.call(arguments,0).concat([t,n]))}}function y(e){return function(t){c[e]=t}}function b(n){if(h(l,n)){var i=l[n]
	delete l[n],d[n]=!0,t.apply(e,i)}if(!h(c,n)&&!h(d,n))throw new Error("No "+n)
	return c[n]}function _(e){var t,n=e?e.indexOf("!"):-1
	return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function E(e){return function(){return u&&u.config&&u.config[e]||{}}}a=function(e,t){var n,i=_(e),r=i[0]
	return e=i[1],r&&(n=b(r=v(r,t))),r?e=n&&n.normalize?n.normalize(e,function(e){return function(t){return v(t,e)}}(t)):v(e,t):(r=(i=_(e=v(e,t)))[0],e=i[1],r&&(n=b(r))),{f:r?r+"!"+e:e,n:e,pr:r,p:n}},s={require:function(e){return g(e)},exports:function(e){var t=c[e]
	return void 0!==t?t:c[e]={}},module:function(e){return{id:e,uri:"",exports:c[e],config:E(e)}}},t=function(t,n,i,r){var o,u,p,f,m,v,_=[],E=typeof i
	if(r=r||t,"undefined"===E||"function"===E){for(n=!n.length&&i.length?["require","exports","module"]:n,m=0;m<n.length;m+=1)if("require"===(u=(f=a(n[m],r)).f))_[m]=s.require(t)
	else if("exports"===u)_[m]=s.exports(t),v=!0
	else if("module"===u)o=_[m]=s.module(t)
	else if(h(c,u)||h(l,u)||h(d,u))_[m]=b(u)
	else{if(!f.p)throw new Error(t+" missing "+u)
	f.p.load(f.n,g(r,!0),y(u),{}),_[m]=c[u]}p=i?i.apply(c[t],_):void 0,t&&(o&&o.exports!==e&&o.exports!==c[t]?c[t]=o.exports:p===e&&v||(c[t]=p))}else t&&(c[t]=i)},n=i=o=function(n,i,r,c,l){if("string"==typeof n)return s[n]?s[n](i):b(a(n,i).f)
	if(!n.splice){if((u=n).deps&&o(u.deps,u.callback),!i)return
	i.splice?(n=i,i=r,r=null):n=e}return i=i||function(){},"function"==typeof r&&(r=c,c=l),c?t(e,n,i,r):setTimeout((function(){t(e,n,i,r)}),4),o},o.config=function(e){return o(e)},n._defined=c,(r=function(e,t,n){t.splice||(n=t,t=[]),h(c,e)||h(l,e)||(l[e]=[e,t,n])}).amd={jQuery:!0}}(),r("../vendor/almond",(function(){})),o=function(e,t){t.__esModule=!0,t.default={MEDIA_STATE:{send:"sendonly",receive:"recvonly",sendReceive:"sendrecv",inactive:"inactive"},MEDIA_DEVICE:{camera:"camera",microphone:"microphone",speaker:"speaker",defaultId:"default"},MEDIA_ERROR:{constraintNotSatisfiedError:"ConstraintNotSatisfiedError",iceConnectionError:"iceConnectionError",srtpError:"srtpError",permissionDeniedError:"permissionDeniedError",internalError:"internalError",sourceUnavailableError:"SourceUnavailableError"},RENEGOTIATION_ERROR:{local:"local",glare:"glare",signaling:"signaling",media:"media",escalation:"escalation"},MSI:{unsubscribe:-1,subscribeAny:-2},MEDIA_LABEL:{audio:"main-audio",video:"main-video",screensharing:"applicationsharing-video"},MEDIA_TYPE:{audio:"audio",video:"video"},MODALITY:{audio:"audio",video:"video",screensharing:"screensharing"},ICE_TRANSPORT_POLICY:{all:"all",relay:"relay"},EXTENSION_TYPE:{dominantSpeakerHistory:"dominantSpeakerHistory"},RENDERER_TYPE:{video:"video",screensharing:"screensharing"}}},"function"==typeof r&&r.amd&&r("../components/media-agent/lib/constants",["require","exports"],o),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/utils",["require","exports"],e)}((function(e,t){function n(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}t.__esModule=!0,t.default={forOwn:n,find:function(e,t){var n
	return e.some((function(i,r){return!!t(i,r,e)&&(n=i,!0)})),n},findIndex:function(e,t){var n
	return e.some((function(i,r){return!!t(i,r,e)&&(n=r,!0)})),n},remove:function(e,t){for(var n=!1,i=e.length;i-- >0;)t(e[i],i,e)&&(e.splice(i,1),n=!0)
	return n},values:function(e){var t=[]
	for(var n in e)e.hasOwnProperty(n)&&t.push(e[n])
	return t},isEmpty:function(e){return!Object.keys(e).length},shallowClone:function(e){var t={}
	return n(e,(function(e,n){t[n]=e})),t},deepClone:function e(t){var i
	if(!t||"object"!=typeof t)return t
	if(t instanceof Date)return(i=new Date).setTime(t.getTime()),i
	if(t instanceof Array){i=[]
	for(var r=0,o=t.length;r<o;r++)i[r]=e(t[r])
	return i}if(t instanceof Object)return i={},n(t,(function(t,n){i[n]=e(t)})),i
	throw new Error("Unable to copy: "+t)},uniqueId:function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+"4"+e().substring(1)+"b"+e().substring(1)+e()+e()+e()},deepEqual:function e(t,n){var i,r=typeof t
	if(t===n)return!0
	if(r!==typeof n||"object"!==r&&"function"!==r)return!1
	if(null===t||null===n)return t===n
	if(t instanceof Date&&n instanceof Date)return+t==+n
	for(i in t)if(!(i in n)||!e(t[i],n[i]))return!1
	for(i in n)if(!(i in t)||!e(t[i],n[i]))return!1
	return!0}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/helper",["require","exports","./constants","./common/utils"],e)}((function(e,t){var n=e("./constants"),i=e("./common/utils")
	function r(e){switch(e){case n.default.MEDIA_STATE.send:return n.default.MEDIA_STATE.receive
	case n.default.MEDIA_STATE.receive:return n.default.MEDIA_STATE.send
	default:return e}}function o(e){return e===n.default.MEDIA_STATE.send||e===n.default.MEDIA_STATE.sendReceive}function a(e){return e===n.default.MEDIA_STATE.receive||e===n.default.MEDIA_STATE.sendReceive}function s(e,t){var i=o(e)&&o(t),r=a(e)&&a(t)
	return i&&r?n.default.MEDIA_STATE.sendReceive:i?n.default.MEDIA_STATE.send:r?n.default.MEDIA_STATE.receive:e===n.default.MEDIA_STATE.inactive&&t?n.default.MEDIA_STATE.inactive:void 0}t.__esModule=!0,t.default={invertDirectionality:r,invertModalities:function(e){var t={},n=r(e.audio)
	n&&(t.audio=n)
	var i=r(e.video)
	i&&(t.video=i)
	var o=r(e.screensharing)
	return o&&(t.screensharing=o),t},removeSendDirectionality:function(e){return e===n.default.MEDIA_STATE.sendReceive?n.default.MEDIA_STATE.receive:void 0},hasSendDirectionality:o,hasReceiveDirectionality:a,negotiateDirectionality:s,negotiateModalities:function(e,t){var n={},i=s(e.audio,t.audio)
	i&&(n.audio=i)
	var r=s(e.video,t.video)
	r&&(n.video=r)
	var o=s(e.screensharing,t.screensharing)
	return o&&(n.screensharing=o),n},areModalitiesEqual:function(e,t){return!(!e||!t||e.audio!==t.audio||e.video!==t.video)},isOnHold:function(e){return e.audio===n.default.MEDIA_STATE.inactive||e.video===n.default.MEDIA_STATE.inactive||e.screensharing===n.default.MEDIA_STATE.inactive},createUniformModalities:function(e){var t={}
	for(var i in n.default.MEDIA_TYPE)n.default.MEDIA_TYPE.hasOwnProperty(i)&&(t[n.default.MEDIA_TYPE[i]]=e)
	return t},areNegotiatedDirectionsFulfilled:function(e,t){function n(e,t){var n=o(e)===o(t),i=a(e)===a(t)
	return n&&i}return n(e.audio,t.audio)&&n(e.video,t.video)&&n(e.screensharing,t.screensharing)},areNegotiatedDirectionsAcceptable:function(e,t,n){function i(e,t,n){var i=o(e)&&o(t)||!o(e)&&!o(n),r=a(e)&&a(t)||!a(e)&&!a(n)
	return i&&r}return i(e.audio,t.audio,n.audio)&&i(e.video,t.video,n.video)&&i(e.screensharing,t.screensharing,n.screensharing)},isMsBrowser:function(){return"undefined"!=typeof RTCIceGatherer},defer:function(){var e,t,n=!0
	return{isPending:function(){return n},promise:new Promise((function(n,i){e=n,t=i})),resolve:function(){n&&(e.apply(null,arguments),n=!1)},reject:function(e){n&&(t.apply(null,arguments),n=!1)}}},delay:function(e){return new Promise((function(t){setTimeout(t,e)}))},timeout:function(e,t,n){var i=new Promise((function(e,i){setTimeout(i.bind(null,new Error("Promise timed out"+(n?": "+n:"")+"after "+t+"ms")),t)}))
	return Promise.race([e,i])},getSrtpInfo:function(e){var t={dtls:!1,sdes:!1}
	return t.dtls=!!e.fingerprint,e.media.forEach((function(e){t.dtls=t.dtls||!!e.fingerprint,t.sdes=t.sdes||!!e.crypto})),t},excludePassiveModalities:function(e,t,n){if(!t||i.default.isEmpty(t))return e
	var r={}
	return i.default.forOwn(e,(function(i,a){(function(e,i){if(!t[e])return!0
	if(n){if(!(o(i)||n[e]&&n[e]===i))return!1}else if(t[e]===i)return!1
	return!0})(a,i)&&(r[a]=e[a])})),r}}})),function(e){"function"==typeof r&&r.amd?r("microsoft-sdp-transform/lib/sdp-transform",[],e):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).sdpTransform=e()}((function(){return function e(t,n,r){function o(s,c){if(!n[s]){if(!t[s]){var l="function"==typeof i&&i
	if(!c&&l)return l(s,!0)
	if(a)return a(s,!0)
	var u=new Error("Cannot find module '"+s+"'")
	throw u.code="MODULE_NOT_FOUND",u}var d=n[s]={exports:{}}
	t[s][0].call(d.exports,(function(e){var n=t[s][1][e]
	return o(n||e)}),d,d.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof i&&i,s=0;s<r.length;s++)o(r[s])
	return o}({1:[function(e,t,n){var i=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbXMessage",reg:/^rtcp-fb:(\*|\d*) x-message ([\S| ]*)/,names:["payload","param"],format:function(e){return"rtcp-fb:"+("*"===e.payload?"%s":"%d")+" x-message %s"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"cryptoscale",reg:/^cryptoscale:(\d*) (client|server) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","flavor","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"cryptoscale:%d %s %s %s %s":"cryptoscale:%d %s %s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s"
	return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{push:"xCandidatesIpv6",reg:/^x-candidate-ipv6:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="x-candidate-ipv6:%s %d %s %d %s %d typ %s"
	return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/,format:"rtcp-mux"},{name:"rtcpRsize",reg:/^(rtcp-rsize)/,format:"rtcp-rsize"},{name:"xMediaBw",reg:/^x-mediabw:(\S*) send=(\d*);recv=(\d*)/,names:["label","sendBw","receiveBw"],format:"x-mediabw:%s send=%d;recv=%d"},{name:"xSsrcRange",reg:/^x-ssrc-range:(\d*)-(\d*)/,names:["ssrcMin","ssrcMax"],format:"x-ssrc-range:%d-%d"},{name:"label",reg:/^label:(\S*)/,format:"label:%s"},{name:"xSource",reg:/^x-source:(\S*)/,format:"x-source:%s"},{name:"xSourceStreamId",reg:/^x-source-streamid:(\S*)/,format:"x-source-streamid:%s"},{name:"xCaps",reg:/^x-caps:(\d*) (\S*)/,names:["payloadType","value"],format:"x-caps:%d %s"},{name:"signalingFbXMessage",reg:/^x-signaling-fb:(\*|\d*) x-message ([\S| ]*)/,names:["payload","param"],format:function(e){return"x-signaling-fb:"+("*"===e.payload?"%s":"%d")+" x-message %s"}},{push:"xMediaSettings",reg:/^x-mediasettings:([\S| ]*)/,names:["settings"],format:"x-mediasettings:%s"},{push:"invalid",names:["value"]}]}
	Object.keys(i).forEach((function(e){i[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},{}],2:[function(e,t,n){var i=function(e){return String(Number(e))===e?Number(e):e},r=function(e,t,n){var r=e.name&&e.names
	e.push&&!t[e.push]?t[e.push]=[]:r&&!t[e.name]&&(t[e.name]={})
	var o=e.push?{}:r?t[e.name]:t;(function(e,t,n,r){if(r&&!n)t[r]=i(e[1])
	else for(var o=0;o<n.length;o+=1)null!=e[o+1]&&(t[n[o]]=i(e[o+1]))})(n.match(e.reg),o,e.names,e.name),e.push&&t[e.push].push(o)},o=e("./grammar"),a=RegExp.prototype.test.bind(/^([a-z])=(.*)/)
	n.parse=function(e){var t={},n=[],i=t
	return e.split(/(\r\n|\r|\n)/).filter(a).forEach((function(e){var t=e[0],a=e.slice(2)
	"m"===t&&(n.push({rtp:[],fmtp:[]}),i=n[n.length-1])
	for(var s=0;s<(o[t]||[]).length;s+=1){var c=o[t][s]
	if(c.reg.test(a))return r(c,i,a)}})),t.media=n,t}
	var s=function(e,t){var n=t.split("=")
	return 2===n.length&&(e[n[0]]=i(n[1])),e}
	n.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(s,{})},n.parsePayloads=function(e){return e.split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(i),r=0;r<n.length;r+=3)t.push({component:n[r],ip:n[r+1],port:n[r+2]})
	return t}},{"./grammar":1}],3:[function(e,t,n){var i=e("./grammar"),r=/%[sdv%]/g,o=function(e){var t=1,n=arguments,i=n.length
	return e.replace(r,(function(e){if(t>=i)return e
	var r=n[t]
	switch(t+=1,e){case"%%":return"%"
	case"%s":return String(r)
	case"%d":return Number(r)
	case"%v":return""}}))},a=function(e,t,n){var i=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)]
	if(t.names)for(var r=0;r<t.names.length;r+=1){var a=t.names[r]
	t.name?i.push(n[t.name][a]):i.push(n[t.names[r]])}else i.push(n[t.name])
	return o.apply(null,i)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],c=["i","c","b","a"]
	t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}))
	var n=t.outerOrder||s,r=t.innerOrder||c,o=[]
	return n.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(a(t,n,e))}))}))})),e.media.forEach((function(e){o.push(a("m",i.m[0],e)),r.forEach((function(t){i[t].forEach((function(n){n.name in e&&null!=e[n.name]?o.push(a(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){o.push(a(t,n,e))}))}))}))})),o.join("\r\n")+"\r\n"}},{"./grammar":1}],"sdp-transform":[function(e,t,n){var i=e("./parser"),r=e("./writer")
	n.write=r,n.parse=i.parse,n.parseFmtpConfig=i.parseFmtpConfig,n.parsePayloads=i.parsePayloads,n.parseRemoteCandidates=i.parseRemoteCandidates},{"./parser":2,"./writer":3}]},{},[])("sdp-transform")})),r("microsoft-sdp-transform",["microsoft-sdp-transform/lib/sdp-transform"],(function(e){return e})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/sessionDescriptorUtils",["require","exports","../constants","../common/utils"],e)}((function(e,t){var n=e("../constants"),i=e("../common/utils")
	function r(e){if(e.label){if(n.default.MEDIA_LABEL.audio===e.label)return n.default.MODALITY.audio
	if(n.default.MEDIA_LABEL.video===e.label)return n.default.MODALITY.video
	if(n.default.MEDIA_LABEL.screensharing===e.label)return n.default.MODALITY.screensharing}else{if(n.default.MEDIA_TYPE.audio===e.type)return n.default.MODALITY.audio
	if(n.default.MEDIA_TYPE.video===e.type)return n.default.MODALITY.video}return null}t.__esModule=!0,t.default={forCodec:function(e,t,n){e.rtp&&e.rtp.some((function(i,r){var o=i.payload
	if(t.name.toLowerCase()!==i.codec.toLowerCase()||t.rate!==i.rate||t.encoding!==i.encoding)return!1
	var a={rtp:i}
	e.fmtp=e.fmtp||[]
	var s=e.fmtp.some((function(e){return i.payload===e.payload&&(a.fmtp=e,!0)}))
	return null===n(a)?(e.payloads=e.payloads.toString().split(" ").filter((function(e){return i.payload!==+e})).join(" "),e.fmtp=e.fmtp.filter((function(e){return i.payload!==e.payload})),e.rtp.splice(r,1)):(a.rtp.payload!==o&&(e.payloads=e.payloads.toString().split(" ").map((function(e){return+e===o?a.rtp.payload:+e})).join(" "),a.fmtp&&(a.fmtp.payload=a.rtp.payload)),!s&&a.fmtp&&e.fmtp.push(a.fmtp)),!0}))},getModality:r,getModalities:function(e){return e.media.reduce((function(e,t){if(0!==t.port){var i=r(t)
	if(!(i in e)){var o=t.direction?t.direction.toLowerCase():n.default.MEDIA_STATE.sendReceive
	e[i]=o}}return e}),{})},removeCodec:function(e,t){var n=-1
	if(e.rtp.forEach((function(e,i){t.codec.toLowerCase()===e.codec.toLowerCase()&&t.rate===e.rate&&t.encoding===e.encoding&&(n=i)})),n>=0&&e.rtp.length>1){var i=e.rtp[n].payload
	e.rtp.splice(n,1),e.payloads=e.payloads.split(" ").filter((function(e){return i!==+e})).join(" "),e.fmtp=e.fmtp.filter((function(e){return i!==e.payload}))}},getLabelForModality:function(e){return n.default.MODALITY.audio===e?n.default.MEDIA_LABEL.audio:n.default.MODALITY.video===e?n.default.MEDIA_LABEL.video:n.default.MODALITY.screensharing===e?n.default.MEDIA_LABEL.screensharing:null},getTypeFromModality:function(e){return e===n.default.MODALITY.audio?n.default.MEDIA_TYPE.audio:n.default.MEDIA_TYPE.video},getBundle:function(e){var t
	if(e.groups){var n=i.default.find(e.groups,(function(e){return"BUNDLE"===e.type}))
	if(n){var r=n.mids.split(" ")[0]
	t=i.default.find(e.media,(function(e){return r===e.mid}))}}return t||null}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/transform/candidateTransform",["require","exports","../sessionDescriptorUtils"],e)}((function(e,t){var n=e("../sessionDescriptorUtils")
	function i(){var e=[{jsep:"active",msSdp:"tcp-act"},{jsep:"passive",msSdp:"tcp-pass"},{jsep:"so",msSdp:"tcp-so"}]
	function t(t,n){delete t.generation,t.transport.match(/tcp/i)&&function(t,n){e.some((function(e){if(n){if(e.msSdp===t.transport.toLowerCase())return t.transport="tcp",t.tcptype=e.jsep,!0}else if(t.tcptype&&e.jsep===t.tcptype.toLowerCase())return t.transport=e.msSdp,delete t.tcptype,!0
	return!1}))}(t,n)}function i(e,t,n){var i=t.connection||n.connection,r=function(e,t,n){return e.port===n&&e.ip===t}
	return!!i&&(1===e.component?r(e,i.ip,t.port):!!t.rtcp&&r(e,t.rtcp.ip||i.ip,t.rtcp.port))}this.fromMsSdp=function(e){e.candidates=e.candidates||[],e.xCandidatesIpv6&&(e.xCandidatesIpv6.forEach((function(t){e.candidates.push(t)})),delete e.xCandidatesIpv6),e.candidates.forEach((function(e){t(e,!0)}))},this.toMsSdp=function(e,r){e.candidates=e.candidates||[],e.candidates.sort((function(t,n){return t.foundation!==n.foundation?t.foundation-n.foundation:t.component!==n.component?t.component-n.component:+i(n,e,r)-+i(t,e,r)})),e.candidates=e.candidates.filter((function(n,i){t(n,!1)
	var r=e.candidates[i-1]
	return!r||r.component!==n.component||r.foundation!==n.foundation})),function(e,t){if(e.port&&!e.candidates.length){var i=n.default.getBundle(t)
	i&&(e.port=i.port,e.connection=i.connection)}}(e,r)}}t.__esModule=!0,t.default={build:function(){return new i}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/webRtcConstants",["require","exports"],e)}((function(e,t){t.__esModule=!0,t.default={STREAM_ID:{audio:"mainAudio",video:"mainVideo",screensharing:"applicationsharingVideo"},STREAM_ID_DELIMITER:"-"}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/transform/streamTransform",["require","exports","../../constants","../../common/utils","../webRtcConstants"],e)}((function(e,t){var n=e("../../constants"),i=e("../../common/utils"),r=e("../webRtcConstants"),o=[{label:n.default.MEDIA_LABEL.audio,id:r.default.STREAM_ID.audio},{label:n.default.MEDIA_LABEL.video,id:r.default.STREAM_ID.video},{label:n.default.MEDIA_LABEL.screensharing,id:r.default.STREAM_ID.screensharing}].reduce((function(e,t){return e[t.label]=t.id,e}),{}),a=i.default.uniqueId()
	function s(){function e(e,t,n,i){e.ssrcs=e.ssrcs||[],e.ssrcs.push({attribute:"cname",id:t,value:n}),e.ssrcs.push({attribute:"msid",id:t,value:i})}function t(e,t,n){var i=function(e){return o[e]?o[e]+r.default.STREAM_ID_DELIMITER:""}(n)
	return i+e+" "+i+t}function n(e){return"recvonly"===e.direction}this.fromMsSdp=function(i){if(0!==i.port){if(!n(i))if(i.ssrcs)o=i.ssrcs,s=function(e,n){return t(e,n,i.label)},o.filter((function(e){return"msid"===e.attribute})).forEach((function(e){var t=e.value.split(" ")
	e.value=s(t[0],t[1]||t[0])}))
	else{var r=function(e){if(e.ssrcGroups){var t
	if(e.ssrcGroups.some((function(e){return"FID"===e.semantics&&(t=e,!0)})),t)return t.ssrcs.split(" ").map((function(e){return+e}))}return[]}(i)
	r.length>0?r.forEach((function(n){e(i,n,a,t(r[0],r[0],i.label))})):i.xSsrcRange&&e(i,i.xSsrcRange.ssrcMin,a,t(i.xSsrcRange.ssrcMin,i.xSsrcRange.ssrcMin,i.label))}var o,s
	delete i.xSsrcRange}},this.toMsSdp=function(e){var t
	0!==e.port&&(e.ssrcs&&e.ssrcs[0]?t=e.ssrcs[0].id:n(e)&&("audio"===e.type?t=4195875351:"video"===e.type&&(t=1)),void 0!==t&&(e.xSsrcRange={ssrcMin:t,ssrcMax:t}))}}t.__esModule=!0,t.default={build:function(){return new s}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/transform/rtcpTransform",["require","exports"],e)}((function(e,t){function n(){this.toMsSdp=function(e,t,n){"offer"===n.type?e.rtcp&&(e.rtcp={port:e.port}):delete e.rtcp}}t.__esModule=!0,t.default={build:function(){return new n}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/userAgentAdapter",["require","exports"],e)}((function(e,t){var n,i=void 0
	if("undefined"!=typeof window&&"undefined"!=typeof navigator){if(i=window,window.URL=window.URL||window.webkitURL||window.mozURL||window.msURL,window.MediaStream=window.MediaStream||window.webkitMediaStream||window.mozMediaStream||window.msMediaStream,window.attachMediaStream=function(e,t){void 0!==e.srcObject?e.srcObject=t:void 0!==e.src&&(e.src=window.URL.createObjectURL(t))},window.detachMediaStream=function(e){if(void 0!==e.srcObject)e.srcObject=null
	else if(void 0!==e.src&&e.src){var t=e.src
	e.src="",window.URL.revokeObjectURL(t)}},void 0!==navigator.mozGetUserMedia&&"undefined"!=typeof mozRTCPeerConnection){window.RTCPeerConnection=mozRTCPeerConnection,window.RTCSessionDescription=mozRTCSessionDescription
	n=window.RTCPeerConnection.prototype.setRemoteDescription,window.RTCPeerConnection.prototype.setRemoteDescription=function(e){if("offer"===e.type){var t=this;(t.getSenders()||[]).forEach((function(e){var n=e.track,i=function(e){return(t.getLocalStreams()||[]).find((function(t){return(("audio"===e.kind?t.getAudioTracks():t.getVideoTracks())||[]).some((function(t){return t.id===e.id}))}))}(n)
	i&&(t.removeTrack(e),t.addTrack(n,i))}))}n.apply(this,arguments)},window.RTCPeerConnection.prototype.getStats=function(){return{}},navigator.getUserMedia=function(e,t,n){return navigator.mozGetUserMedia(e,t,n)}}else void 0!==navigator.webkitGetUserMedia&&"undefined"!=typeof webkitRTCPeerConnection&&(window.RTCPeerConnection=webkitRTCPeerConnection,navigator.getUserMedia=function(e,t,n){var i=function(e){e&&e.deviceId&&e.deviceId.exact&&(e.optional||(e.optional=[]),e.optional.push({sourceId:e.deviceId.exact}),delete e.deviceId)}
	return e&&(i(e.audio),i(e.video)),navigator.webkitGetUserMedia(e,t,n)})
	if("undefined"!=typeof RTCIceGatherer){var r=function(){return Promise.resolve()}
	RTCRtpSender.prototype.getStats||(RTCRtpSender.prototype.getStats=r),RTCRtpSender.prototype.msGetStats||(RTCRtpSender.prototype.msGetStats=r),RTCRtpReceiver.prototype.getStats||(RTCRtpReceiver.prototype.getStats=r),RTCRtpReceiver.prototype.msGetStats||(RTCRtpReceiver.prototype.msGetStats=r),RTCIceTransport.prototype.getStats||(RTCIceTransport.prototype.getStats=r),RTCIceTransport.prototype.msGetStats||(RTCIceTransport.prototype.msGetStats=r),RTCRtpReceiver.prototype.getContributingSources||(RTCRtpReceiver.prototype.getContributingSources=function(){return[]}),RTCRtpReceiver.prototype.requestSendCSRC||(RTCRtpReceiver.prototype.requestSendCSRC=function(){})}}t.__esModule=!0,t.default={window:i}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/transform/msSdpTransform",["require","exports","./candidateTransform","./streamTransform","./rtcpTransform","../../helper","../../common/userAgentAdapter","../../constants"],e)}((function(e,t){var n=e("./candidateTransform"),i=e("./streamTransform"),r=e("./rtcpTransform"),o=e("../../helper"),a=e("../../common/userAgentAdapter"),s=e("../../constants"),c={audio:"main-audio",video:"main-video"},l="UDP/TLS/RTP/SAVPF",u="RTP/SAVPF",d="RTP/SAVP"
	t.__esModule=!0,t.default=function(e){this.toMsSdp=function(e,n){return e.msidSemantic={semantic:"WMS",token:"*"},e.media.forEach((function(i){var r
	if(i.protocol=d,i.label=i.label||(r=i.type,c.hasOwnProperty(r)&&c[r]||"undefined"),0===i.port){for(var o in i)i.hasOwnProperty(o)&&["type","port","protocol","payloads"].indexOf(o)<0&&delete i[o]
	i.payloads=34}m.toMsSdp(i),i.crypto&&i.crypto.forEach((function(e){e.config+="|2^31"})),0!==i.port&&e.fingerprint&&(i.fingerprint=e.fingerprint),i.fingerprint&&g(n)&&delete i.setup,f.toMsSdp(i,e),h.toMsSdp(i,e,n),i.invalid&&(t.error("Unknown SDP attributes!",i.invalid),delete i.invalid),v(i,!1),0!==i.port&&(i.type===s.default.MEDIA_TYPE.audio&&p.webrtcAudioChannelSignalingFeedback?i.signalingFbXMessage={payload:"*",param:p.webrtcAudioChannelSignalingFeedback}:i.type===s.default.MEDIA_TYPE.video&&p.webrtcVideoChannelSignalingFeedback&&(i.signalingFbXMessage={payload:"*",param:p.webrtcVideoChannelSignalingFeedback}))})),delete e.fingerprint,e},this.fromMsSdp=function(e,t){for(var n=o.default.getSrtpInfo(e),i=e.media.length-1;i>=0;--i){var r=e.media[i]
	if((r.ssrcs&&r.ssrcs[0]||r.xSsrcRange)&&(e.msidSemantic={semantic:"WMS",token:"*"}),r.protocol=l,(!n.dtls||n.sdes&&p.preferSdesSrtp)&&(r.protocol=u),0!==r.port){if(m.fromMsSdp(r),delete r.cryptoscale,r.fingerprint&&g(t)&&(r.setup="actpass"),r.crypto)for(var a=r.crypto.length-1;a>=0;--a){var s=r.crypto[a]
	s.config.match(/.*\|\d+:\d+/)?r.crypto.splice(a,1):s.config=s.config.replace(/(.*)\|2\^\d+/,"$1")}r.remoteCandidates&&(delete r.candidates,delete r.xCandidatesIpv6,delete r.remoteCandidates),f.fromMsSdp(r),r.rtcpFbXMessage&&delete r.rtcpFbXMessage,v(r,!0)}else r.direction||(r.direction="inactive")}return e}
	var t=e.logger,p=e.settings,f=(a.default.window,n.default.build()),m=i.default.build(),h=r.default.build()
	function v(e,t){var n=[{name:"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time",encoded:"http:\\\\www.webrtc.org\\experiments\\rtp-hdrext\\abs-send-time"}]
	e.ext&&e.ext.forEach((function(e){n.some((function(n){var i=t?n.encoded:n.name,r=t?n.name:n.encoded
	return i===e.uri&&(e.uri=r,!0)}))}))}function g(e){return"offer"===e.type}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/formatParameters",["require","exports","./utils"],e)}((function(e,t){var n=e("./utils")
	function i(e){var t={},i=this
	this.setIfMissing=function(e,n){i.contains(e)||(t[e]=n)},this.get=function(e){return t[e]},this.contains=function(e){return t.hasOwnProperty(e)},this.toString=function(){var e=""
	return n.default.forOwn(t,(function(t,n){e+=(e?";":"")+n,void 0!==t&&(e+="="+t)})),e},e&&e.split(";").forEach((function(e){var n=e.split("=")
	t[n[0]]=n[1]}))}t.__esModule=!0,t.default={build:function(e){return new i(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/webRtcSessionDescription",["require","exports","microsoft-sdp-transform","../constants","../helper","./transform/msSdpTransform","../common/formatParameters","./sessionDescriptorUtils"],e)}((function(e,t){var n=e("microsoft-sdp-transform"),i=e("../constants"),r=e("../helper"),o=e("./transform/msSdpTransform"),a=e("../common/formatParameters"),s=e("./sessionDescriptorUtils")
	function c(e,t,c,l){var p,f=e.settings,m=e.mediaManager,h=e.sdpTransform,v=(e.logger,n.parse(c)),g=new o.default(e)
	function y(e){e.media.forEach((function(e,t){var n=m.getMediaEntity(t)
	if(i.default.MEDIA_TYPE.video===n.getType())return s.default.forCodec(e,{name:"h264",rate:9e4},(function(e){var t=n.getVideoCapabilities()
	if(t){e.fmtp=e.fmtp||{payload:e.rtp.payload}
	var i=a.default.build(e.fmtp.config)
	i.setIfMissing("max-fs",t.getMaxFS()),i.setIfMissing("max-fps",t.getMaxFPS()),e.fmtp.config=i.toString()}})),!0}))}this.getModalities=function(){return p||s.default.getModalities(v)},this.updateModalities=function(e){p=e},this.getSrtpInfo=function(){return r.default.getSrtpInfo(v)},this.getVideoCodecs=function(){var e=[]
	return v.media.forEach((function(t){"video"===t.type&&(e=t.rtp.map((function(e){return e.codec.toLowerCase()})))})),e},this.usePrimaryAudioCodecOnly=function(e){var t=["cn","telephone-event"]
	v.media.forEach((function(n){if(i.default.MEDIA_TYPE.audio===n.type){var r=n.rtp.filter((function(n){return-1!==e.indexOf(n.codec.toLowerCase())&&-1===t.indexOf(n.codec.toLowerCase())}))
	if(0===r.length)throw new Error("there is no matching primary audio codec")
	n.rtp.filter((function(e){return e!==r[0]&&-1===t.indexOf(e.codec.toLowerCase())})).forEach((function(e){s.default.removeCodec(n,e)}))}}))},this.isCodecSwitchSupported=function(){return!v.media.some((function(e){return i.default.MEDIA_TYPE.audio===e.type&&e.xMediaSettings&&(t=e.xMediaSettings,n="codecswitchunsupported",t.some((function(e){return-1!==e.settings.indexOf(n)})))
	var t,n}))},this.toOffer=function(){return d(v,(function(e,t){u(f,t)})),m.isEmpty()&&m.fromOffer(v,p),m.syncModalities(p,!1),v=h.toOffer(v,m,p),f.disableMsSdp||g.toMsSdp(v,{type:t}),y(v),p=s.default.getModalities(v),n.write(v)},this.toAnswer=function(){return d(v,(function(e,t){u(f,t)})),m.syncModalities(p,!0),v=h.toAnswer(v,m,p),f.disableMsSdp||g.toMsSdp(v,{type:t}),y(v),p=s.default.getModalities(v),n.write(v)},this.toRemote=function(e){return p=e,m.fromRemote(v,p),v=h.toRemote(v,m,p),n.write(v)},this.getVideoRecvCapabilities=function(){var e={}
	return v.media.filter((function(e){return"video"===e.type})).some((function(t){return s.default.forCodec(t,{name:"h264",rate:9e4},(function(t){if(t.fmtp){var n=a.default.build(t.fmtp.config),i=n.get("max-fs")
	!isNaN(i)&&i&&(e.maxFS=+i)
	var r=n.get("max-fps")
	!isNaN(r)&&r&&(e.maxFPS=+r/100)}})),!0})),e},this.needToWaitIceCandidates=function(){if(e.bundled){var t=s.default.getBundle(v)
	return t&&9===t.port}return v.media.some((function(e){return 9===e.port}))},l&&!f.disableMsSdp&&g.fromMsSdp(v,{type:t}),"answer"===t&&v.groups&&(e.bundled=!0)}function l(e,t,i,r){var a=e.settings,s=new o.default(e),c=n.parse(i)
	return d(c,(function(e,t){0===t.port||r[e]||function(e){for(var t in e.port=0,e)e.hasOwnProperty(t)&&["type","port","protocol","payloads","connection","direction"].indexOf(t)<0&&(delete e[t],e.direction="inactive")}(t),t.direction="inactive",u(a,t)})),a.disableMsSdp||s.toMsSdp(c,{type:t}),n.write(c)}function u(e,t){t.candidates&&(e.iceCandidateType||e.iceCandidateTransport)&&(t.candidates=t.candidates.filter((function(t){var n=!0,i=!0
	return e.iceCandidateType&&(n=t.type.match(new RegExp(e.iceCandidateType),"i")),e.iceCandidateTransport&&(i=t.transport.match(new RegExp(e.iceCandidateTransport,"i"))),n&&i})))}function d(e,t){for(var n=0;n<e.media.length;n++)"audio"===e.media[n].type?t(i.default.MEDIA_TYPE.audio,e.media[n]):"video"===e.media[n].type&&t(i.default.MEDIA_TYPE.video,e.media[n])}t.__esModule=!0,t.default={build:function(e){return e=e||{},{createLocalOffer:function(t){return new c(e,"offer",t)},createRemoteOffer:function(t){return new c(e,"offer",t,!0)},createLocalAnswer:function(t){return new c(e,"answer",t)},createRemoteAnswer:function(t){return new c(e,"answer",t,!0)},createInactiveOfferSdp:l.bind(null,e,"offer"),createInactiveAnswerSdp:l.bind(null,e,"answer")}}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/adapter/webkitSessionDescription",["require","exports","../../common/userAgentAdapter"],e)}((function(e,t){var n=e("../../common/userAgentAdapter"),i="rollback"
	function r(){var e=[].slice.apply(arguments),t=e[0]&&o(e[0].type)
	e.splice(0,t?1:0,null)
	var r=new(Function.prototype.bind.apply(n.default.window.RTCSessionDescription,e)),a=Object.getOwnPropertyDescriptor(n.default.window.RTCSessionDescription.prototype,"type")
	return Object.defineProperty(r,"type",{get:function(){return t?i:a.get.call(r)},set:function(e){(t=o(e))||a.set.call(r,e)}}),r}function o(e){return i===e}t.__esModule=!0,t.default={build:function(){return r}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/adapter/webkitPeerConnection",["require","exports","microsoft-sdp-transform","../sessionDescriptorUtils","../../common/formatParameters","./webkitSessionDescription","../../common/userAgentAdapter","../../common/utils"],e)}((function(e,t){var n=e("microsoft-sdp-transform"),i=e("../sessionDescriptorUtils"),r=e("../../common/formatParameters"),o=e("./webkitSessionDescription"),a=e("../../common/userAgentAdapter"),s=e("../../common/utils"),c=[{name:"telephone-event",rate:8e3},{name:"cn",rate:16e3}]
	function l(e){var t,l,u,d,p,f,m,h,v,g=[]
	function y(e,t){var n
	Object.defineProperty(this,"dtmf",{get:function(){return"audio"===e.kind?n=n||l.createDTMFSender(e):null}}),this.track=e,this._stream=t}return d=o.default.build(),(t=[].slice.apply(arguments)).splice(0,1,null),p="iceTransportPolicy",f="iceTransports",t[1]&&t[1][p]&&(t[1][f]=t[1][p]),l=new(Function.prototype.bind.apply(a.default.window.webkitRTCPeerConnection,t)),[{name:"createOffer",reverseArgs:!0},"createAnswer","setRemoteDescription","setLocalDescription"].forEach((function(e){var t=e.name||e,n=l[t]
	l[t]=function(){var t=arguments
	return new Promise((function(i,r){var o=[i,r]
	t.length>0&&o.splice(e.reverseArgs?o.length:0,0,t[0]),n.apply(l,o)}))}})),function(){["createOffer","createAnswer","setLocalDescription"].forEach((function(t){var n=l[t]
	l[t]=function(){var t=arguments
	return e.gather("video").then((function(){return n.apply(n,t)}))}}))
	var t=l.setRemoteDescription
	l.setRemoteDescription=function(o){return e.gather("video").then((function(e){var a=e.codecs,s=n.parse(o.sdp)
	return s.media.forEach((function(e){if("video"===e.type&&(e.rtp.some((function(e){return a.some((function(t){return e.codec.toLowerCase()===t.mimeType}))}))?function(e){i.default.forCodec(e,{name:"h264",rate:9e4},(function(e){if(e.fmtp){var t=r.default.build(),n=r.default.build(e.fmtp.config);["level-asymmetry-allowed","packetization-mode","profile-level-id"].forEach((function(e){n.contains(e)&&t.setIfMissing(e,n.get(e))})),e.fmtp.config=t.toString()}}))}(e):e.port=0),!function(e){return"RTP/SAVPF"!==e.protocol}(e)){var t=i.default.getBundle(s)
	t?e.crypto=t.crypto:e.port||s.media.some((function(t){return!!t.port&&(e.crypto=t.crypto,!0)}))}})),o.sdp=n.write(s),t(o)}))}}(),v=l.setLocalDescription,l.setLocalDescription=function(e){var t=function(){if(!u||!l.remoteDescription)return Promise.reject(new Error("rollback requires having both remote and local descriptions set"))
	var e=new d({type:"answer",sdp:l.remoteDescription.sdp})
	return v(u).then((function(){return l.setRemoteDescription(e)}))}
	return"rollback"===e.type?"have-local-offer"===l.signalingState?t():Promise.reject(new Error("rollback is supported only from have-local-offer state")):("stable"===l.signalingState&&l.localDescription&&(u=new d({type:"offer",sdp:l.localDescription.sdp})),v(e))},h=l.createAnswer,l.createAnswer=function(){var e=arguments
	return h.apply(l,e).then((function(e){if(!l.localDescription||!l.localDescription.sdp)return e
	var t=n.parse(l.localDescription.sdp),r=[]
	if(t.media.forEach((function(e){c.forEach((function(t){i.default.forCodec(e,t,(function(e){r.push(e)}))}))})),r.length){var o=n.parse(e.sdp),a=!1
	o.media.forEach((function(e){r.forEach((function(t){i.default.forCodec(e,{name:t.rtp.codec,rate:t.rtp.rate},(function(e){e.rtp.payload!==t.rtp.payload&&(e.rtp.payload=t.rtp.payload,a=!0)}))}))})),a&&(e=new d({type:e.type,sdp:n.write(o)}))}return e}))},m=l.createOffer,l.createOffer=function(e){var t=arguments
	return e&&e.offerToReceiveVideo>1&&(e.offerToReceiveVideo=1),m.apply(l,t)},l.getSenders&&l.addTrack&&l.removeTrack||(l.getSenders=function(){return g.slice()},l.addTrack=function(e,t){if(!e||!t)throw new Error("both media track and stream need to be provided")
	l.getLocalStreams().some((function(e){return e.id===t.id}))||l.addStream(t)
	var n=s.default.find(g,(function(t){return t.track.id===e.id}))
	return n||(n=new y(e,t),g.push(n)),n},l.removeTrack=function(e){l.getLocalStreams().filter((function(t){return t.id===e._stream.id})).forEach(l.removeStream.bind(l)),s.default.remove(g,(function(t){return t===e}))}),l}t.__esModule=!0,t.default={build:function(e){return l.bind(null,e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/adapter/webkitCapabilityGatherer",["require","exports","microsoft-sdp-transform","../../common/userAgentAdapter"],e)}((function(e,t){var n=e("microsoft-sdp-transform"),i=e("../../common/userAgentAdapter")
	function r(e){var t,r=this,o=i.default.window.webkitRTCPeerConnection
	this.gather=function(e){return"video"!==e&&"audio"!==e?Promise.reject(new Error("capabilities for "+e+" are not supported")):(t.gatherTask||(t.gatherTask=new Promise((function(e,i){var r=new o(null)
	r.createOffer((function(t){var i={}
	return n.parse(t.sdp).media.forEach((function(e){i[e.type]=e.rtp.map((function(e){return{mimeType:e.codec.toLowerCase()}}))})),r.close(),e(i)}),(function(e){t.gatherTask=null,r.close(),i(e)}),{offerToReceiveVideo:1,offerToReceiveAudio:1})}))),t.gatherTask.then((function(t){return{codecs:t[e]}})))},t=e.global.webkitCapabilityGatherer=e.global.webkitCapabilityGatherer||{},r.gather("video")}t.__esModule=!0,t.default={build:function(e){return new r(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/transform/webkitSdpTransform",["require","exports","../sessionDescriptorUtils","../../constants","../../common/utils"],e)}((function(e,t){var n=e("../sessionDescriptorUtils"),i=e("../../constants"),r=e("../../common/utils")
	function o(){function e(e){return e.groups?r.default.find(e.groups,(function(e){return"BUNDLE"===e.type})):null}function t(e,t,n){return{type:e,port:0,label:t,payloads:36,protocol:n}}function o(o,a,s,c){var l=r.default.deepClone(o),u=r.default.find(l.media,(function(e){return e.type===i.default.MEDIA_TYPE.audio})),d=r.default.find(l.media,(function(e){return e.type===i.default.MEDIA_TYPE.video})),p={}
	p[i.default.MODALITY.audio]=u,p[i.default.MODALITY.video]=d,p[i.default.MODALITY.screensharing]=d
	var f={}
	f[i.default.MODALITY.audio]=a.getMediaEntitiesByModality(i.default.MODALITY.audio)[0],f[i.default.MODALITY.video]=a.getMediaEntitiesByModality(i.default.MODALITY.video)[0],f[i.default.MODALITY.screensharing]=a.getMediaEntitiesByModality(i.default.MODALITY.screensharing)[0],l.media=[],a.getMediaEntities().forEach((function(e){var o,c=s[e.getModality()]
	!e.isEnabled()||0===p[e.getModality()].port||e!==f[e.getModality()]&&c===i.default.MEDIA_STATE.send?o=t(e.getType(),n.default.getLabelForModality(e.getModality()),p[e.getModality()].protocol):(e!==f[e.getModality()]&&(c=i.default.MEDIA_STATE.receive),o=function(e,o,a,s){var c=e.getMid(),l=e.getModality(),u=r.default.deepClone(o)
	if(u.label=n.default.getLabelForModality(l),u.direction=s,u.mid=c,u.ssrcs=[],u.ssrcGroups=[],s===i.default.MEDIA_STATE.send||s===i.default.MEDIA_STATE.sendReceive){var d=r.default.find(a,(function(e){return e.modality===l})),p=[],f=[]
	if(d){var m=o.ssrcs.filter((function(e){return"msid"===e.attribute&&d.track===e.value.split(" ")[1]})).map((function(e){return e.id}))
	o.ssrcs&&(p=o.ssrcs.filter((function(e){return m.indexOf(e.id)>-1}))),o.ssrcGroups&&(f=o.ssrcGroups.filter((function(e){var t=e.ssrcs.split(" ")
	return r.default.find(t,(function(e){return m.indexOf(+e)>-1}))})))}else if(s===i.default.MEDIA_STATE.send||s===i.default.MEDIA_STATE.send)return t(o.type,n.default.getLabelForModality(l),o.protocol)
	u.ssrcs=p,u.ssrcGroups=f}return u}(e,p[e.getModality()],a.getMediaTracks(),c),e!==f[e.getModality()]&&(o.candidates=[])),0===o.port&&e.disable(),l.media.push(o)}))
	var m=e(l)
	return m&&(m.mids=l.media.map((function(e){return e.mid})).filter((function(e){return e})).join(" ")),l}this.toOffer=function(e,t,n){return o(e,t,n)},this.toAnswer=function(e,t,n){return o(e,t,n)},this.toRemote=function(o,a,s){var c=r.default.deepClone(o),l=null,u=null,d=e(c)
	if(c.media.forEach((function(e,t){a.getMediaEntity(t).isDisabled()&&(e.port=0)})),!d){var p={}
	c.media.forEach((function(e,t){var n=a.getMediaEntity(t)
	n.getType()in p?(n.disable(),e.port=0):p[n.getType()]=!0}))}c.media.forEach((function(e){var t=n.default.getModality(e)
	s[t]===i.default.MEDIA_STATE.send&&(e.direction&&e.direction.toLowerCase()===i.default.MEDIA_STATE.receive||(e.direction=i.default.MEDIA_STATE.receive))}))
	var f=r.default.find(c.media,(function(e){return e.type===i.default.MEDIA_TYPE.audio}))
	f&&(0!==f.port?((l=r.default.deepClone(f)).mid="audio",delete l.label,function(e){n.default.removeCodec(e,{codec:"g722",rate:8e3,encoding:2})}(l)):l=t(i.default.MEDIA_TYPE.audio,void 0,f.protocol))
	var m=c.media.filter((function(e){return e.type===i.default.MEDIA_TYPE.video}))
	if(m.length>0){var h=m.filter((function(e){return 0!==e.port}))
	h.length>0?((u=r.default.deepClone(h[0])).mid="video",u.direction=null,delete u.label,u.ssrcs=[],u.ssrcGroups=[],h.forEach((function(e){var t,n
	e.ssrcs&&(u.ssrcs=u.ssrcs.concat(e.ssrcs)),e.ssrcGroups&&(u.ssrcGroups=u.ssrcGroups.concat(e.ssrcGroups)),u.direction=(t=u.direction,n=e.direction||i.default.MEDIA_STATE.sendReceive,t===i.default.MEDIA_STATE.sendReceive||n===i.default.MEDIA_STATE.sendReceive?i.default.MEDIA_STATE.sendReceive:t===n?t:t&&n&&t!==n?i.default.MEDIA_STATE.sendReceive:t||n)}))):u=t(i.default.MEDIA_TYPE.video,void 0,m[0].protocol)}return c.media=[l,u].filter((function(e){return e})),a.getMediaEntities()[0].getModality()!==i.default.MODALITY.audio&&c.media.reverse(),d&&(d.mids=c.media.map((function(e){return e.mid})).filter((function(e){return e})).join(" ")),c}}t.__esModule=!0,t.default={build:function(){return o}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/adapter/webkitAdapter",["require","exports","./webkitPeerConnection","./webkitSessionDescription","./webkitCapabilityGatherer","../transform/webkitSdpTransform"],e)}((function(e,t){var n=e("./webkitPeerConnection"),i=e("./webkitSessionDescription"),r=e("./webkitCapabilityGatherer"),o=e("../transform/webkitSdpTransform")
	function a(e){var t=r.default.build(e)
	this.SdpTransform=o.default.build(),this.RTCPeerConnection=n.default.build(t),this.RTCRtpReceiver={getCapabilities:t.gather},this.RTCSessionDescription=i.default.build()}t.__esModule=!0,t.default={build:function(e){return new a(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/adapter/webrtcAdapter",["require","exports","./webkitAdapter","../../common/userAgentAdapter"],e)}((function(e,t){var n=e("./webkitAdapter"),i=e("../../common/userAgentAdapter")
	function r(){function e(){throw new Error("unsupported platform")}this.SdpTransform=e,this.RTCPeerConnection=e,this.RTCSessionDescription=e,this.RTCRtpReceiver=e}function o(e,t,n){this.SdpTransform=a,this.RTCPeerConnection=e,this.RTCSessionDescription=t,this.RTCRtpReceiver=n}function a(){function e(e){return e}this.toOffer=e,this.toAnswer=e,this.toRemote=e}t.__esModule=!0,t.default={build:function(e){return void 0!==i.default.window.webkitRTCPeerConnection?n.default.build(e):void 0!==i.default.window.mozRTCPeerConnection?new o(i.default.window.mozRTCPeerConnection,i.default.window.RTCSessionDescription,i.default.window.RTCRtpReceiver):new r}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/videoCapabilities",["require","exports"],e)}((function(e,t){var n=function(){function e(e,t){this.maxFS=e,this.maxFPS=t}return e.prototype.setMaxFS=function(e,t){return!(this.maxFS===e||(this.maxFS=e,!t))&&(t(this),!0)},e.prototype.getMaxFS=function(){return this.maxFS},e.prototype.getMaxFPS=function(){return this.maxFPS},e}()
	t.VideoCapabilities=n,t.__esModule=!0,t.default={build:function(e,t){return new n(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/mediaManager",["require","exports","./sessionDescriptorUtils","../constants","../common/utils","./videoCapabilities"],e)}((function(e,t){var n=e("./sessionDescriptorUtils"),i=e("../constants"),r=e("../common/utils"),o=e("./videoCapabilities"),a=function(){function e(e,t,n,i,r,o,a){this.modality=e,this.mid=t,this.mtype=n,this.streamId=i,this.xSourceStreamId=r,this.renderer=o,this.videoCapabilities=a}return e.create=function(t,r,a,s){var c=n.default.getTypeFromModality(a),l=null
	c===i.default.MEDIA_TYPE.video&&(l=o.default.build(t.webrtcVideoCapabilityMaxFS||1200,t.webrtcVideoCapabilityMaxFPS||3e3))
	var u=new e(a,s,c,null,null,null,l)
	return r.mediaEntityCreated(u),u},e.prototype.clone=function(){return new e(this.modality,this.mid,this.mtype,this.streamId,this.xSourceStreamId,this.renderer,this.videoCapabilities)},e.prototype.getModality=function(){return this.modality},e.prototype.getType=function(){return this.mtype},e.prototype.getMid=function(){return this.mid},e.prototype.disable=function(){this.mid=null},e.prototype.enable=function(e,t){this.modality=e,this.mid=t},e.prototype.isDisabled=function(){return!this.mid},e.prototype.isEnabled=function(){return!!this.mid},e.prototype.getVideoCapabilities=function(){return this.videoCapabilities},e.prototype.getRenderer=function(){return this.renderer},e.prototype.setRenderer=function(e){this.renderer=e},e.prototype.getStreamId=function(){return this.streamId},e.prototype.setStreamId=function(e){this.streamId=e},e.prototype.getXSourceStreamId=function(){return this.xSourceStreamId},e.prototype.setXSourceStreamId=function(e){this.xSourceStreamId=e},e}()
	t.MediaEntity=a
	var s=function(){function e(e,t){this.mediaEntities=[],this.mediaEntitiesBackup=[],this.midId=0,this.mediaTracks=[],this.logger=e.logger,this.settings=e.settings,this.numVideoChannels=e.numVideoChannels,this.listener=t}return e.prototype.generateMid=function(e){return"media_"+e},e.prototype.fromOffer=function(e,t){var n=this
	e.media.forEach((function(e){if(e.type===i.default.MEDIA_TYPE.audio)i.default.MODALITY.audio in t&&n.addMediaEntity(i.default.MODALITY.audio)
	else if(e.type===i.default.MEDIA_TYPE.video){if(i.default.MODALITY.video in t)for(var r=0;r<n.numVideoChannels;r++)n.addMediaEntity(i.default.MODALITY.video)
	i.default.MODALITY.screensharing in t&&n.addMediaEntity(i.default.MODALITY.screensharing)}}))},e.prototype.fromRemote=function(e,t){var i=this
	e.media.forEach((function(e,o){var a=n.default.getModality(e)
	if(0!==e.port&&a in t){if(i.mediaEntities[o]?i.mediaEntities[o].enable(a,e.mid||i.generateMid(o)):i.addMediaEntity(a,e.mid||i.generateMid(o)),e.ssrcs){var s=r.default.find(e.ssrcs,(function(e){return"msid"===e.attribute}))
	s?i.mediaEntities[o].setStreamId(s.value.split(" ")[0]):i.logger.warn("No ssrc msid for media of type "+e.type+" with mid "+e.mid)}i.mediaEntities[o].setXSourceStreamId(e.xSourceStreamId)}else i.mediaEntities[o]?i.mediaEntities[o].disable():i.addDisabledMediaEntity(a),i.mediaEntities[o].setStreamId(null)}))},e.prototype.isEmpty=function(){return 0===this.mediaEntities.length},e.prototype.addMediaEntity=function(e,t){this.mediaEntities.push(a.create(this.settings,this.listener,e,t||this.generateMid(this.mediaEntities.length)))},e.prototype.addDisabledMediaEntity=function(e){this.mediaEntities.push(a.create(this.settings,this.listener,e,null))},e.prototype.getMediaEntities=function(){return this.mediaEntities},e.prototype.getMediaEntity=function(e){return this.mediaEntities[e]},e.prototype.getMediaEntityByMid=function(e){return r.default.find(this.mediaEntities,(function(t){return t.getMid()===e}))},e.prototype.getMediaEntitiesByModality=function(e){return this.mediaEntities.filter((function(t){return t.getModality()===e}))},e.prototype.getMediaEntitiesByRenderer=function(e){return this.mediaEntities.filter((function(t){return t.getRenderer()===e}))},e.prototype.getMediaEntityByStreamId=function(e){return r.default.find(this.mediaEntities,(function(t){return t.getStreamId()===e}))},e.prototype.reset=function(){this.mediaEntities=[]},e.prototype.syncModalities=function(e,t){this.disableModalities(e),t||(this.enableModalities(e),this.addModalities(e))},e.prototype.enableModalities=function(e){var t=this
	this.mediaEntities.forEach((function(n,i){n.getModality()in e&&n.isDisabled()&&n.enable(n.getModality(),t.generateMid(i))}))},e.prototype.disableModalities=function(e){this.mediaEntities.forEach((function(t){t.getModality()in e||t.disable()}))},e.prototype.addModalities=function(e){var t={}
	for(var n in this.mediaEntities.map((function(e){return e.getModality()})).forEach((function(e){t[e]=!0})),e)n in t||this.addMediaEntity(n)},e.prototype.setMediaTracks=function(e){this.mediaTracks=e},e.prototype.getMediaTracks=function(){return this.mediaTracks},e.prototype.backup=function(){var e=this
	this.mediaEntitiesBackup=[],this.mediaEntities.forEach((function(t){e.mediaEntitiesBackup.push(t.clone())}))},e.prototype.commit=function(){this.mediaEntitiesBackup=[]},e.prototype.rollback=function(){this.mediaEntities=this.mediaEntitiesBackup},e}()
	t.__esModule=!0,t.default={build:function(e,t){return new s(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/statistics/webrtcStatistics",["require","exports","../../helper"],e)}((function(e,t){var n=e("../../helper")
	function i(e,t){var i,r,o,a=!1,s=t.logger.createChild("WebrtcStatistics"),c={localStreams:[],remoteStreams:[],webrtc:{CorrelationId:e,Extensions:{WebRTCStats:{},OfferedSrtp:"none",NegotiatedSrtp:"none",IceConnectionState:"none",SignalingState:"none",AudioTransportRecvBitrate:0,AudioTransportSendBitrate:0,AudioPayloadSendBitrate:0,AudioPayloadRecvBitrate:0,VideoPayloadSendBitrate:0,VideoPayloadRecvBitrate:0,TimerAudioTransportRecvBitrate:0,TimerAudioTransportSendBitrate:0,TimerAudioPayloadRecvBitrate:0,TimerAudioPayloadSendBitrate:0,TimerVideoPayloadRecvBitrate:0,TimerVideoPayloadSendBitrate:0,StartTime:(new Date).getTime(),EndTime:(new Date).getTime()}}},l=this
	this.setIceConnectionState=function(e){c.webrtc.Extensions.IceConnectionStatePrevious=c.webrtc.Extensions.IceConnectionState,c.webrtc.Extensions.IceConnectionState=e},this.setSignalingConnectionState=function(e){c.webrtc.Extensions.SignalingStatePrevious=c.webrtc.Extensions.SignalingState,c.webrtc.Extensions.SignalingState=e}
	var u=void 0
	function d(e){var t={}
	var n,i=["codecImplementationName","googFrameHeightReceived","googFrameWidthReceived","googNacksSent","googRenderDelayMs","googTargetDelayMs","googPlisSent","googFrameRateDecoded","googFrameRateOutput","googMinPlayoutDelayMs","googMaxDecodeMs","googFrameRateReceived","googCaptureStartNtpTimeMs","googFirsSent","googDecodeMs","googCodecName","googCurrentDelayMs","audioInputLevel","transportId","audioOutputLevel","id","googCodecName","googEchoCancellationEchoDelayMedian","googEchoCancellationEchoDelayStdDev","googEchoCancellationQualityMin","googEchoCancellationReturnLoss","googEchoCancellationReturnLossEnhancement","googJitterReceived","googRtt","googTypingNoiseState","mediaType","packetsLost","packetsSent","bytesReceived","bytesSent","googAccelerateRate","googCaptureStartNtpTimeMs","googCurrentDelayMs","googDecodingCNG","googDecodingCTN","googDecodingCTSG","googDecodingNormal","googDecodingPLC","googDecodingPLCCNG","googExpandRate","googJitterBufferMs","googPreemptiveExpandRate","googPreferredJitterBufferMs","googSecondaryDecodedRate","googSpeechExpandRate","packetsReceived"],r=["dtlsCipher","googComponent","id","srtpCipher","selectedCandidatePairId"],o=["bytesSent","bytesReceived","googActiveConnection","googChannelId","googLocalCandidateType","googReadable","googRemoteCandidateType","id","googRtt","googTransportType","googWritable","packetsDiscardedOnSend","packetsSent"]
	function a(e,t){var n={}
	for(var i in e)e.hasOwnProperty(i)&&-1!==t.indexOf(i)&&(n[i]=e[i])
	return n}function s(e){var n={}
	if(n=a(e,i),e.hasOwnProperty("transportId")){var s=t.googComponent[e.transportId]
	if(n.transport=a(s,r),s.hasOwnProperty("selectedCandidatePairId")){var c=t.googCandidatePair[s.selectedCandidatePairId]
	n.pair=a(c,o)}}return n}(n=e).result&&n.result().forEach((function(e){e&&(e.names().forEach((function(n){t[e.type]=t[e.type]||{},t[e.type][e.id]=t[e.type][e.id]||{},t[e.type][e.id][n]=e.stat(n)})),t[e.type][e.id].id=e.id)}))
	var c={}
	if(!t.ssrc)return{}
	for(var l in t.ssrc)if(t.ssrc[l].hasOwnProperty("transportId")){var u=t.ssrc[l]
	c[u.id.replace(/[0-9]+/,u.mediaType||"audio")]=s(u)}if(t.VideoBwe&&t.VideoBwe.bweforvideo){c.bweStat={}
	var d=a(t.VideoBwe.bweforvideo,["googActualEncBitrate","googAvailableReceiveBandwidth","googAvailableSendBandwidth","googBucketDelay","googRetransmitBitrate","googTargetEncBitrate","googTransmitBitrate"])
	for(var p in d)d.hasOwnProperty(p)&&(c.bweStat[p]=d[p])}return c}function p(e){var t=""
	return e.dtls&&(t+="dtls"),e.sdes&&(t+="sdes"),t}function f(e,t){var n=[]
	return e.forEach((function(e){var i={tracks:[]}
	n.push(i),e.getTracks().forEach((function(n){("audio"===n.kind&&t.audio||"video"===n.kind&&t.video)&&i.tracks.push({stream:e,track:n})}))})),n}this.startWaitingForStreamStart=function(e,t){o||t||(u=e),o&&!t||(o=!0,new Promise((function(e){i?i.getStats((function(t){c.webrtc.Extensions.WebRTCStats=d(t),e()}),(function(t){s.error("detectStreamStart getreport getstats failure",t),e()})):e()})).catch((function(e){s.log("detectCallStart error",e)})).then((function(){setTimeout((function(){(function(e){if(!(c.webrtc.Extensions.WebRTCStats.ssrc_audio_send&&c.webrtc.Extensions.WebRTCStats.ssrc_audio_recv&&c.webrtc.Extensions.WebRTCStats.ssrc_video_send&&c.webrtc.Extensions.WebRTCStats.ssrc_video_recv))return!1
	function t(e,t){return!e||t&&-1===t?0:(new Date).getTime()}return c.webrtc.Extensions.TimerAudioPayloadRecvBitrate=n.default.hasReceiveDirectionality(e.audio)?t(c.webrtc.Extensions.WebRTCStats.ssrc_audio_recv.bytesReceived,c.webrtc.Extensions.TimerAudioPayloadRecvBitrate):-1,c.webrtc.Extensions.TimerAudioPayloadSendBitrate=n.default.hasSendDirectionality(e.audio)?t(c.webrtc.Extensions.WebRTCStats.ssrc_audio_send.bytesSent,c.webrtc.Extensions.TimerAudioPayloadSendBitrate):-1,c.webrtc.Extensions.TimerVideoPayloadRecvBitrate=n.default.hasReceiveDirectionality(e.video)?t(c.webrtc.Extensions.WebRTCStats.ssrc_video_recv.bytesReceived,c.webrtc.Extensions.TimerVideoPayloadRecvBitrate):-1,c.webrtc.Extensions.TimerVideoPayloadSendBitrate=n.default.hasSendDirectionality(e.video)?t(c.webrtc.Extensions.WebRTCStats.ssrc_video_send.bytesSent,c.webrtc.Extensions.TimerVideoSendBitrate):-1,c.webrtc.Extensions.TimerAudioTransportRecvBitrate=n.default.hasReceiveDirectionality(e.audio)?t(c.webrtc.Extensions.WebRTCStats.ssrc_audio_recv.bytesReceived,c.webrtc.Extensions.TimerAudioTransportRecvBitrate):-1,c.webrtc.Extensions.TimerAudioTransportSendBitrate=n.default.hasSendDirectionality(e.audio)?t(c.webrtc.Extensions.WebRTCStats.ssrc_audio_send.bytesSent,c.webrtc.Extensions.TimerAudioTransportSendBitrate):-1,!!(c.webrtc.Extensions.TimerVideoPayloadRecvBitrate&&c.webrtc.Extensions.TimerVideoPayloadSendBitrate&&c.webrtc.Extensions.TimerAudioPayloadRecvBitrate&&c.webrtc.Extensions.TimerAudioPayloadSendBitrate&&c.webrtc.Extensions.TimerAudioTransportRecvBitrate&&c.webrtc.Extensions.TimerAudioTransportSendBitrate)})(e)||a?o=!1:l.startWaitingForStreamStart(u,!0)}),1e3)})).catch((function(e){s.error("startWaitingForStreamStart error",e)})))},this.setNegotiatedModalities=function(e){r=e,u=e},this.setPeerConnection=function(e){i=e},this.setReport=function(e){c=e},this.getCachedReport=function(){return c},this.setTerminated=function(){c.webrtc.Extensions.EndTime=(new Date).getTime(),a=!0},this.calculateAverages=function(){var e=c.webrtc.Extensions.EndTime
	function t(t,n){return t&&e-n&&-1!==n?Math.round(8*t/(e-n)):0}function n(e,t){return t.split(".").reduce((function(e,t){return null==e?e:e[t]}),e)}c.webrtc.Extensions.AudioPayloadRecvBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_audio_recv.bytesReceived"),c.webrtc.Extensions.TimerAudioPayloadRecvBitrate),c.webrtc.Extensions.AudioPayloadSendBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_audio_send.bytesSent"),c.webrtc.Extensions.TimerAudioPayloadSendBitrate),c.webrtc.Extensions.VideoPayloadRecvBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_video_recv.bytesReceived"),c.webrtc.Extensions.TimerVideoPayloadRecvBitrate),c.webrtc.Extensions.VideoPayloadSendBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_video_send.bytesSent"),c.webrtc.Extensions.TimerVideoPayloadSendBitrate),c.webrtc.Extensions.AudioTransportRecvBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_audio_send.pair.bytesReceived"),c.webrtc.Extensions.TimerAudioTransportRecvBitrate),c.webrtc.Extensions.AudioTransportSendBitrate=t(n(c.webrtc.Extensions.WebRTCStats,"ssrc_audio_send.pair.bytesSent"),c.webrtc.Extensions.TimerAudioTransportSendBitrate)},this.getWebrtcReport=function(e){return d(e)},this.setNegotiatedSrtpInfo=function(e){c.webrtc.Extensions.NegotiatedSrtp=p(e)},this.setOfferedSrtpInfo=function(e){c.webrtc.Extensions.OfferedSrtp=p(e)},this.getReport=function(){return new Promise((function(e){if(i){r&&(c.localStreams=f(i.getLocalStreams(),{audio:n.default.hasSendDirectionality(r.audio),video:n.default.hasSendDirectionality(r.video)}),c.remoteStreams=f(i.getRemoteStreams(),{audio:n.default.hasReceiveDirectionality(r.audio),video:n.default.hasReceiveDirectionality(r.video)}))
	try{i.getStats((function(t){c.webrtc.Extensions.WebRTCStats=d(t),l.calculateAverages(),e(c)}),(function(t){c.webrtc.Extensions.WebRTCStats={getStatsError:t},s.error("getreport getstats resolve error",t),e(c)}))}catch(t){c.webrtc.Extensions.WebRTCStats={getStatsError:t},s.error("getreport getstats catch error",t),e(c)}}else s.log("getreport else resolve"),e(c)}))}}t.__esModule=!0,t.default={build:function(e,t){return new i(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/dtmfUtils",["require","exports"],e)}((function(e,t){t.defaultSettings={toneDuration:200,toneGap:100}
	var n=function(){function e(e){this.queue=[],this.logger=e}return e.prototype.cleanup=function(){this.queue.forEach((function(e){e.reject({notSent:e.tones})})),this.queue=[]},e.prototype.waitForNotification=function(e){var t=this
	return e?(this.logger.log("sending dtmf tones: ",e),new Promise((function(n,i){t.queue.push({tones:e,resolve:n,reject:i})}))):Promise.reject(new Error("invalid input"))},e.prototype.toneSent=function(e){this.queue[0]&&(e===this.queue[0].tones[0]?(this.queue[0].tones=this.queue[0].tones.substr(1),""===this.queue[0].tones&&(this.queue[0].resolve(e),this.queue.shift())):(this.queue[0].reject(new Error("sent tone does not match: expected '"+this.queue[0].tones[0]+"' got '"+e+"'")),this.queue.shift(),this.toneSent(e)))},e}()
	t.DTMFQueue=n})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/webRtcDtmfSender",["require","exports","../common/dtmfUtils"],e)}((function(e,t){var n=e("../common/dtmfUtils"),i=function(){function e(e,t){this.webRtcSender=null,this.queue=new n.DTMFQueue(e),this.settings=t||n.defaultSettings}return e.prototype.sendDtmf=function(e,t){return e&&e.getSenders?(this.syncSender(e),this.webRtcSender?(this.webRtcSender.ontonechange=this.onToneChange.bind(this),this.webRtcSender.insertDTMF(this.webRtcSender.toneBuffer+t,this.settings.toneDuration,this.settings.toneGap),this.queue.waitForNotification(t)):Promise.reject(new Error("not available"))):Promise.reject(new Error("bad peerConnection"))},e.prototype.canSendDtmf=function(e){return!(!e||!e.getSenders)&&(this.syncSender(e),!!this.webRtcSender&&this.webRtcSender.canInsertDTMF)},e.prototype.dispose=function(){this.queue.cleanup()},e.prototype.syncSender=function(e){var t=e.getSenders().filter((function(e){return e.dtmf&&e.dtmf.canInsertDTMF}))[0]
	this.webRtcSender&&t&&t.dtmf!=this.webRtcSender&&(this.webRtcSender.ontonechange=null,this.queue.cleanup()),this.webRtcSender=t?t.dtmf:null},e.prototype.onToneChange=function(e){e.tone&&this.queue.toneSent(e.tone)},e}()
	t.WebRtcDTMFSender=i,t.__esModule=!0,t.default={build:function(e,t){return new i(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/remoteStreamManager",["require","exports","../constants","../common/utils"],e)}((function(e,t){var n=e("../constants"),i=e("../common/utils"),r=function(){function e(e){for(var t in this.listener=e,this.streams={},this.currStream={},n.default.MODALITY)this.streams[t]=[],this.currStream[t]=0}return e.prototype.addStream=function(e,t){t&&-1===this.streams[t].indexOf(e)&&(this.streams[t].push(e),this.listener.streamAdded(e,t))},e.prototype.removeStream=function(e){for(var t in this.streams)if(i.default.remove(this.streams[t],(function(t){return t===e})))return void this.listener.streamRemoved(e,t)},e.prototype.getStream=function(e){var t=this.currStream[e]++%this.streams[e].length
	return this.streams[e][t]},e}()
	t.RemoteStreamManager=r,t.__esModule=!0,t.default={build:function(e){return new r(e)}}}));(function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/device/videoRenderer",["require","exports"],e)})((function(e,t){t.__esModule=!0,t.default=function(e,t){var n=document.createElement("video"),i=0,r=0,o=null,a=function(){if(t&&t.onVideoSizeChanged){var e=n.videoWidth,o=n.videoHeight;(e<32||o<32)&&(e=o=0),i===e&&r===o||(i=e,r=o,t.onVideoSizeChanged(e,o))}},s=function(){t&&t.onError&&t.onError(n?n.error:"no video")}
	function c(){n.addEventListener("loadedmetadata",a),n.addEventListener("timeupdate",a),n.addEventListener("error",s)}function l(){n.removeEventListener("loadedmetadata",a),n.removeEventListener("timeupdate",a),n.removeEventListener("error",s),u(null)}function u(t){o!==t&&(o&&(t||e.removeChild(n),window.detachMediaStream(n)),t&&(n.hidden=0===t.getVideoTracks().length,window.attachMediaStream(n,t),o||e.appendChild(n)),o=t)}n.autoplay=!0,n.muted=!0,this.getVideoElement=function(){return n},this.dispose=function(){l(),n=null},this.reattachEventListeners=function(){l(),c()},this.attachMediaStream=u,c()}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/webRtcVideoSizeTracker",["require","exports","../common/userAgentAdapter"],e)}((function(e,t){var n=e("../common/userAgentAdapter"),i=function(e,t){var i,r=n.default.window,o={width:e.offsetWidth,height:e.offsetHeight}
	this.onSizeChange=function(n){if(!i){var a=Math.floor(Math.random()*Math.abs(t.interval.max-t.interval.min))+t.interval.min
	i=r.setInterval((function(){o.width===e.offsetWidth&&o.height===e.offsetHeight||(o.width=e.offsetWidth,o.height=e.offsetHeight,n(e.offsetWidth,e.offsetHeight))}),a)}},this.dispose=function(){i&&r.clearInterval(i)}}
	t.__esModule=!0,t.default={build:function(e,t){return new i(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/resolutionTable",["require","exports"],e)}((function(e,t){var n=function(){function e(){var e=this
	this.MACROBLOCK_SIZE=16,this.resolutions=[{width:320,height:180},{width:426,height:240},{width:640,height:360},{width:960,height:540},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this.table=this.resolutions.map((function(t){return{width:t.width,height:t.height,fs:Math.ceil(t.width/e.MACROBLOCK_SIZE)*Math.ceil(t.height/e.MACROBLOCK_SIZE)}}))}return e.prototype.getResolution=function(e){for(var t=this.table.length-1;t>=0;t--)if(this.table[t].fs<=e)return this.table[t]
	return this.table[0]},e.prototype.getMaxFS=function(e,t){for(var n=Math.max(e,t),i=Math.min(e,t),r=0;r<this.table.length;r++)if(this.table[r].width>=n&&this.table[r].height>=i)return this.table[r].fs
	return this.table.slice(-1)[0].fs},e.prototype.getResolutions=function(){return this.resolutions},e}()
	t.__esModule=!0,t.default={build:function(){return new n}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/remoteRendererManager",["require","exports","../constants","../common/utils","../device/videoRenderer","./webRtcVideoSizeTracker","./resolutionTable","../helper"],e)}((function(e,t){var n=e("../constants"),i=e("../common/utils"),r=e("../device/videoRenderer"),o=e("./webRtcVideoSizeTracker"),a=e("./resolutionTable"),s=e("../helper")
	function c(e,t){var c=e.settings,l=e.logger,u=e.streamManager,d=(e.mediaManager,a.default.build(),[]),p=function(e,a){r.default.call(this,e,a)
	var p,f,m,h,v=this,g=this.dispose,y=null
	this._updateStream=function(){if(h){var e=u.getStream(h)
	v.attachMediaStream(e),y&&(y.resolve(),y=null)}},this._rejectPendingSubscription=function(){y&&(y.reject(new Error("renderer subscription rejected")),y=null),t.rendererUnsubscribed(v)},this.subscribeVideoAsync=function(e,i){return l.info("subscribeVideoAsync","msi:",e),h=i?n.default.RENDERER_TYPE.screensharing:n.default.RENDERER_TYPE.video,new Promise((function(e){v._rejectPendingSubscription(),-1===d.indexOf(v)&&(d.push(v),t.rendererSubscribed(v)),c.webrtcVideoCapabilityCheckIntervalMin&&c.webrtcVideoCapabilityCheckIntervalMax?(p=o.default.build(v.getVideoElement(),{interval:{min:c.webrtcVideoCapabilityCheckIntervalMin,max:c.webrtcVideoCapabilityCheckIntervalMax}})).onSizeChange((function(e,n){console.log("video renderer size changed, updating capabilities"),f=e,m=n,t.rendererSizeChanged(v,e,n)})):l.info("skipping video size tracking")
	var n=u.getStream(h)
	n?(v.attachMediaStream(n),l.info("subscribeVideoAsync","subscribed","rendererType",h,"streamId:",n.id),e()):(l.warn("subscribeVideoAsync","could not get stream","rendererType",h),e((y=s.default.defer()).promise))}))},this.dispose=function(){p&&p.dispose(),this._rejectPendingSubscription(),i.default.remove(d,(function(e){return e===v})),g()},this.getModality=function(){return h},this.getWidth=function(){return f},this.getHeight=function(){return m}}
	this.unsubscribeAll=function(){d.forEach((function(e){e._rejectPendingSubscription()})),d=[]},this.stopRenderers=function(){d.forEach((function(e){e._updateStream()}))},this.stopVideoRenderers=function(e){d.filter((function(t){return t.getModality()===e})).forEach((function(e){e._updateStream()}))},this.startVideoRenderers=function(e){d.filter((function(t){return t.getModality()===e})).forEach((function(e){e._updateStream()}))},this.createRemoteRenderer=function(e,t){return new p(e,t)},this.getRenderersByModality=function(e){return d.filter((function(t){return t.getModality()===e}))||[]}}t.__esModule=!0,t.default={build:function(e,t){return new c(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/extensions/dominantSpeakerHistoryExtension",["require","exports"],e)}((function(e,t){var n=function(){function e(){this.notificationType="DominantSpeakerInfo",this.manager=null,this.callback=null}return e.prototype.initialize=function(e,t){e&&(this.manager=e,this.manager.addNotificationListener(this,this.notificationType),t&&t.callback&&(this.callback=t.callback))},e.prototype.dispose=function(){this.manager.removeNotificationListener(this,this.notificationType),this.manager=null,this.callback=null},e.prototype.onNotification=function(e){var t=e
	this.processInfo(t)},e.prototype.processInfo=function(e){this.callback&&this.callback(e.previousDominantSpeakerHistory)},e}()
	t.__esModule=!0,t.default=n})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/extensions/extensionFactory",["require","exports","./dominantSpeakerHistoryExtension","../constants"],e)}((function(e,t){var n=e("./dominantSpeakerHistoryExtension"),i=e("../constants"),r=function(){function e(){}return e.getExtension=function(e){if(e=i.default.EXTENSION_TYPE.dominantSpeakerHistory)return new n.default
	throw new Error("Extension of type "+e+" is not found")},e}()
	t.__esModule=!0,t.default=r})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/extensions/extensionsManager",["require","exports","./extensionFactory"],e)}((function(e,t){var n=e("./extensionFactory"),i=function(){function e(){this.extensions=[],this.listeners={}}return e.prototype.dispose=function(){this.extensions=null,this.listeners=null},e.prototype.addExtension=function(e,t){var i=n.default.getExtension(e)
	i.initialize(this,t),this.extensions.push(i)},e.prototype.processNotification=function(e,t){var n=this.listeners[e]
	n&&n.forEach((function(e){e.onNotification(t)}))},e.prototype.addNotificationListener=function(e,t){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)},e.prototype.removeNotificationListener=function(e,t){var n=this.listeners[t]
	if(n){var i=n.indexOf(e)
	i>=0&&n.splice(i,1),n.length||delete this.listeners[t]}},e}()
	t.__esModule=!0,t.default=i})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/activeSpeaker/activeSpeakerManager",["require","exports"],e)}((function(e,t){var n=function(){function e(e,t){this.onActiveSpeakersChanged=e,this.onDominantSpeakersChanged=t}return e.prototype.setStrategy=function(e){this.dshStrategy=e,this.dshStrategy&&this.dshStrategy.setOnDominantSpeakerChanged(this.onDominantSpeakerHistoryChanged.bind(this))},e.prototype.onContributingSourcesChanged=function(e){this.onActiveSpeakersChanged(e),this.dshStrategy&&this.dshStrategy.setSources(e)},e.prototype.onDominantSpeakerHistoryChanged=function(e){this.onDominantSpeakersChanged(e)},e.prototype.dispose=function(){this.dshStrategy&&(this.dshStrategy.dispose(),this.dshStrategy=null),this.onActiveSpeakersChanged=null,this.onDominantSpeakersChanged=null},e}()
	t.ActiveSpeakerManager=n})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/render/audioRenderer",["require","exports","../../common/userAgentAdapter","../../common/utils"],e)}((function(e,t){var n=e("../../common/userAgentAdapter"),i=e("../../common/utils"),r=function(){function e(e){this.window=n.default.window,this.logger=e.logger.createChild("audio")}return e.prototype.play=function(e){this.audio?this.window.detachMediaStream(this.audio):(this.audio=document.createElement("audio"),document.body.appendChild(this.audio),this.audio.autoplay=!0,this.audio.addEventListener("error",this.onAudioError)),this.logger.log("starting playout"),this.window.attachMediaStream(this.audio,e),this.stream=e},e.prototype.stop=function(){this.audio&&(this.logger.log("stopping playout"),this.audio.removeEventListener("error",this.onAudioError),document.body.removeChild(this.audio),this.window.detachMediaStream(this.audio),this.audio=null,this.stream=null)},e.prototype.getStream=function(){return this.stream},e.prototype.dispose=function(){this.stop()},e.prototype.onAudioError=function(e){e?this.logger.error("error event occured:",this.toString(e)):this.logger.error("error event occured","error:",this.audio?this.audio.error:"<no audio element>")},e.prototype.toString=function(e){if(e){var t={}
	return i.default.forOwn(e,(function(e,n){try{t[n]=t[n]="function"==typeof e?e():e}catch(i){t[n]="error: "+i}})),_stringify(t)}},e}()
	t.__esModule=!0,t.default=r})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/webrtc/webRtcSession",["require","exports","../constants","../helper","./webRtcSessionDescription","./adapter/webrtcAdapter","./mediaManager","./statistics/webrtcStatistics","../common/utils","./webRtcDtmfSender","./remoteStreamManager","./remoteRendererManager","./resolutionTable","../extensions/extensionsManager","../common/activeSpeaker/activeSpeakerManager","./render/audioRenderer"],e)}((function(e,t){var n=e("../constants"),i=e("../helper"),r=e("./webRtcSessionDescription"),o=e("./adapter/webrtcAdapter"),a=e("./mediaManager"),s=e("./statistics/webrtcStatistics"),c=e("../common/utils"),l=e("./webRtcDtmfSender"),u=e("./remoteStreamManager"),d=e("./remoteRendererManager"),p=e("./resolutionTable"),f=e("../extensions/extensionsManager"),m=e("../common/activeSpeaker/activeSpeakerManager"),h=e("./render/audioRenderer"),v=function(e,t,v){this.configureModalitiesAsync=function(e){var t=z.then((function(){return new Promise((function(t){if(!e||!e.audio&&!e.video&&!e.screensharing)throw new Error("Invalid parameters!"+_stringify(e))
	var n=!_||!i.default.areNegotiatedDirectionsFulfilled(e,U)
	_=e,x.log("configure modalities","audio:",e.audio,"video:",e.video,"screensharing",e.screensharing,"peerconnection:",!!O,"pc.signalingState:",O?O.signalingState:"-","needNewRenegotiation:",n),n&&ae(),t(_)}))}))
	return z=t.catch((function(e){x.warn("Error during configuring modalities: ",e)})),t},this.createOfferAsync=function(){return new Promise((function(e){x.log("create [offer] configured:",_),H=!0,oe("no configured modalities to create offer for"),L=!1,E=i.default.excludePassiveModalities(_,K,b),b=E
	var t=i.default.negotiateModalities(b,E)
	i.default.isOnHold(t)?e(se(b,!0,!0).then((function(){var e=M.createInactiveOfferSdp(O.localDescription.sdp,b)
	return x.debug("CREATE OFFER hold","sdp:",e),{blob:e,modalities:t}}))):e(se(b,!0,!0).then((function(){var e=function(e){function t(e){return!!e&&(i.default.hasReceiveDirectionality(e)||"inactive"===e)}return{offerToReceiveAudio:+t(e.audio),offerToReceiveVideo:+t(e.video)+ +t(e.screensharing)}}(b)
	return x.log("create [offer]","offered:",b,"constraints:",e),O.createOffer(e)})).then((function(e){x.debug("create [offer] offer from peer connection","sdp:",e.sdp),M.createLocalOffer(e.sdp).needToWaitIceCandidates()&&te(),B.startWaitingForStreamStart(b)
	var t=new T.RTCSessionDescription({sdp:e.sdp,type:"offer"})
	return Promise.all([O.setLocalDescription(t),P.promise])})).then((function(){var e=M.createLocalOffer(O.localDescription.sdp)
	e.updateModalities(b),I.setMediaTracks(ce())
	var n=e.toOffer()
	return x.debug("CREATE OFFER","sdp:",n),{blob:n,modalities:t}})))}))},this.processOfferAsync=function(e){return new Promise((function(t){var n=e.blob
	x.debug("process [offer]","sdp:",n),H=!1,y=M.createRemoteOffer(n),L=!1,b=i.default.invertModalities(y.getModalities())
	var r=Promise.resolve(b)
	if(i.default.hasSendDirectionality(b.video)||i.default.hasReceiveDirectionality(b.video)){var o=y.getVideoCodecs()
	r=T.RTCRtpReceiver.getCapabilities("video").then((function(e){if(!e.codecs.some((function(e){return o.some((function(t){return e.mimeType===t}))}))){x.warn("offer doesn't contain any supported video codecs")
	var t=c.default.shallowClone(b)
	return t.video=void 0,t}return b})).catch((function(e){return x.error("failed to get video capability",e),b}))}t(r.then((function(e){return x.log("process [offer]","offered:",b,"acceptable:",e),e})))}))},this.createAnswerAsync=function(e){return new Promise((function(t){if(e)t({})
	else{x.log("create [answer]","offered:",b,"configured:",_),oe("no configured modalities to create answer for"),E=i.default.excludePassiveModalities(_,K,b)
	var r=i.default.negotiateModalities(b,E)
	i.default.isOnHold(r)?t(se(r,!0,!0).then((function(){ee(r)
	var e=M.createInactiveAnswerSdp(O.localDescription.sdp,U)
	return x.debug("CREATE ANSWER hold","sdp:",e),{blob:e,modalities:U}}))):t(se(r,!0,!1).then((function(){return le(y)})).then((function(){return function(){if(y.isCodecSwitchSupported())return Promise.resolve()
	return T.RTCRtpReceiver.getCapabilities(n.default.MEDIA_TYPE.audio).then((function(e){var t=e.codecs.map((function(e){return e.mimeType}))
	y.usePrimaryAudioCodecOnly(t)})).catch((function(e){x.error("failed to set primary codec based on audio capability",e)}))}()})).then((function(){var e=y.toRemote(r)
	return x.log("create [answer] set remote description","negotiated:",r,"sdp:",e),O.setRemoteDescription(new T.RTCSessionDescription({sdp:e,type:"offer"}))})).then((function(){return se(r,!1,!0)})).then((function(){return O.createAnswer()})).then((function(e){x.debug("create [answer] answer from peer connection","sdp:",e.sdp),M.createLocalAnswer(e.sdp).needToWaitIceCandidates()&&te(),B.startWaitingForStreamStart(r)
	var t=new T.RTCSessionDescription({sdp:e.sdp,type:"answer"})
	return Promise.all([O.setLocalDescription(t),P.promise])})).then((function(){var e=M.createLocalAnswer(O.localDescription.sdp)
	e.updateModalities(r),I.setMediaTracks(ce())
	var t=e.toAnswer()
	return ee(r=e.getModalities()),x.debug("CREATE ANSWER","sdp:",t),{blob:t,modalities:U}})))}}))},this.processAnswerAsync=function(e,t){return new Promise((function(n){var r=e.blob
	if(x.debug(t?"PROCESS PRANSWER":"PROCESS ANSWER","sdp:",r),t)return x.log("process [pranswer]"),void n({})
	var o=M.createRemoteAnswer(r)
	if(ee(i.default.invertModalities(o.getModalities())),i.default.isOnHold(U))n(U)
	else{var a=o.toRemote(U)
	x.log("process [answer] set remote description","negotiated:",U,"sdp:",a),n(O.setRemoteDescription(new T.RTCSessionDescription({sdp:a,type:"answer"})).then((function(){return U})).then((function(){return le(o)})).then((function(e){e&&ae(!0)})).then((function(){return U})))}}))},this.completeNegotiationAsync=function(){return new Promise((function(e){I.commit()
	var t=i.default.excludePassiveModalities(_,K,b),n=D&&!i.default.isOnHold(U)||!i.default.areNegotiatedDirectionsAcceptable(t,E,U)||R,r=!n
	L=!0,x.log("negotiation completed","isComplete:",r,"configured:",_,"negotiating:",E,"offered:",b,"negotiated:",U),n&&ae(),e({isComplete:r,activeModalities:U,offeredModalities:b,attemptedModalities:E,configuredModalities:_,initiator:H})}))},this.rejectNegotiationAsync=function(e,t){return new Promise((function(i){I.rollback()
	var r=e===n.default.RENEGOTIATION_ERROR.local,o=Promise.resolve()
	x.warn("negotiation rejected","isComplete:",r,"error:",e,"configured:",_,"negotiating:",E,"offered:",b,"negotiated:",U),O&&("have-local-offer"===O.signalingState?(x.log("rolling back local description"),o=O.setLocalDescription(new T.RTCSessionDescription({type:"rollback"}))):x.error("cannot rollback local description in currrent state:",O.signalingState)),i(o.then((function(){return t&&(x.log("retrying failed negotiation"),ae()),{isComplete:r,activeModalities:U,offeredModalities:b,attemptedModalities:E,configuredModalities:_,initiator:H}})))}))},this.createRemoteRenderer=function(e,t){return j.createRemoteRenderer(e,t)},this.getStatsAsync=pe,this.terminate=function(){x.log("terminate"),B.setTerminated(),Q&&(Q.dispose(),Q=null)
	return pe().then((function(){G=!0,j.unsubscribeAll(),function(){x.log("reset peer connection"),j.stopRenderers(),$.dispose(),q&&(q.dispose(),q=null)
	O&&O.close()
	ue(),de(),O=null,g=null,te(),L=!0,U={}}(),ne(),w._onTerminated&&w._onTerminated(w)}))},this.sendDtmf=function(e){return q.sendDtmf(O,e)},this.canSendDtmf=function(){return q.canSendDtmf(O)},this.onNegotiationRequired=null,this.onSessionErrorOccurred=null,this.getExtensionsManager=function(){Q||(Q=new f.default).addExtension(n.default.EXTENSION_TYPE.dominantSpeakerHistory,{callback:X.onDominantSpeakerHistoryChanged.bind(X)})
	return Q},this._deviceSelectionChanged=function(){O&&(i.default.isOnHold(U)||(D=!0,ae()))},this._onTerminated=null
	var g,y,b,_,E,w=this,S=e.maContext.settings,x=e.getLogger().createChild("webrtc"),C=e.getDeviceManager(),T=o.default.build({global:e.maContext}),I=a.default.build({logger:x,settings:S,numVideoChannels:e.config&&e.config.isConference&&S.numVideoChannelsGvc?S.numVideoChannelsGvc:1},{mediaEntityCreated:function(e){var t=j.getRenderersByModality(e.getModality())[0]
	e.setRenderer(t),t&&J(t,t.getWidth(),t.getHeight())}}),A=p.default.build(),M=r.default.build({sdpTransform:new T.SdpTransform,mediaManager:I,settings:S,logger:x}),O=null,k=null,N=null,P=i.default.defer(),R=!1,L=!0,D=!1,U={},F=null,B=s.default.build(t,{logger:x}),V=Promise.resolve({}),G=!1,H=!1,q=l.default.build(x,S.dtmf),W=u.default.build({streamAdded:function(e,t){n.default.MODALITY.audio===t?$.play(e):n.default.MODALITY.video===t||n.default.MODALITY.screensharing===t?j.startVideoRenderers(t):x.warn("unsupported stream modality:",t)},streamRemoved:function(e,t){n.default.MODALITY.audio===t?$.getStream()===e&&$.stop():n.default.MODALITY.video===t||n.default.MODALITY.screensharing===t?j.stopVideoRenderers(t):x.warn("unsupported stream modality:",t)}}),j=d.default.build({settings:S,logger:x,streamManager:W,mediaManager:I,session:this},{rendererSubscribed:function(e){var t=I.getMediaEntitiesByModality(e.getModality())[0]
	t&&t.setRenderer(e)},rendererUnsubscribed:function(e){var t=I.getMediaEntitiesByRenderer(e)[0]
	t&&t.setRenderer(null)},rendererSizeChanged:J}),z=Promise.resolve(),K=e.config.passiveModalities,Y={},Q=null,X=new m.ActiveSpeakerManager(v.onContributingSourcesChanged,v.onDominantSpeakerChanged),$=new h.default({logger:x})
	function J(e,t,n){var i=A.getMaxFS(t,n),r=I.getMediaEntitiesByRenderer(e)[0]
	r&&r.getVideoCapabilities()?r.getVideoCapabilities().setMaxFS(i,(function(){ae(!0)})):x.warn("no capabilities for provided modality:",e.getModality())}function Z(e){x.error("Media error occurred","type:",e.type,"detail:",e.detail),w.onSessionErrorOccurred&&w.onSessionErrorOccurred(e)}function ee(e){U=e,B.setNegotiatedModalities(e)}function te(){x.log("reset candidate gathering"),P.promise.then((function(){}),(function(){})),P.reject(new Error("reset candidate gathering")),P=i.default.defer()}function ne(){F&&(clearTimeout(F),F=null)}function ie(e){return e.reduce((function(e,t){return t.addresses.map((function(n){function i(e,i){return{urls:t.type+":"+n+":"+e+(i?"?transport="+i:""),credential:t.password,username:t.username}}t.udpPort===t.tcpPort?e.push(i(t.udpPort)):(e.push(i(t.udpPort,"udp")),e.push(i(t.tcpPort,"tcp")))})),e}),[])}function re(){return g||(g=e.maContext.getRelayManager().queryRelaysAsync("turn",e.config.isRemoteClientLync).then((function(t){var i={};(function(e){var t
	if(y){var n=y.getSrtpInfo()
	B.setOfferedSrtpInfo(n),t=!n.dtls||n.sdes&&S.preferSdesSrtp}else t=S.preferSdesSrtp
	t&&(x.log("configuring peer connection to use sdes"),e.optional=[{DtlsSrtpKeyAgreement:!1}]),B.setNegotiatedSrtpInfo({dtls:!t,sdes:!!t})})(i),x.log("create peer connection"),O=new T.RTCPeerConnection({iceServers:ie(t),rtcpMuxPolicy:"require",iceTransportPolicy:e.config.iceTransportPolicy?e.config.iceTransportPolicy:n.default.ICE_TRANSPORT_POLICY.all},i),B.setPeerConnection(O),O.onnegotiationneeded=function(e){var t=e.target
	x.log("onnegotiationneeded","signalingState:",t.signalingState)},O.onsignalingstatechange=function(e){var t=e.target
	B.setSignalingConnectionState(t.signalingState),x.log("onsignalingstatechange","signalingState:",t.signalingState)},O.onaddstream=function(e){x.log("onaddstream","stream:",e.stream)
	var t=I.getMediaEntityByStreamId(e.stream.id)
	t?W.addStream(e.stream,t.getModality()):x.error("Can not find media entity with stream id "+e.stream.id)},O.ontrack=function(e){x.log("ontrack","track:",e.track)},O.onremovestream=function(e){x.log("onremovestream","stream:",e.stream),W.removeStream(e.stream)},O.onicecandidate=function(e){x.log("onicecandidate","candidate:",e.candidate),e.candidate||P.resolve()},O.onicegatheringstatechange=function(e){var t=e.target
	x.log("onicegatheringstatechange","iceGatheringState:",t.iceGatheringState)},O.oniceconnectionstatechange=function(e){var t=e.target
	B.setIceConnectionState(t.iceConnectionState),x.log("oniceconnectionstatechange","iceConnectionState:",t.iceConnectionState,"pc.signalingState:",t.signalingState),"failed"===t.iceConnectionState&&Z({type:n.default.MEDIA_ERROR.iceConnectionError,detail:"ice transport failed"}),"disconnected"===t.iceConnectionState?S.iceDisconnectedTimeoutMs&&(F=setTimeout((function(){x.error("ice disconnected for ",S.iceDisconnectedTimeoutMs,"ms. Raise CONSTANTS.MEDIA_ERROR.iceConnectionError"),Z({type:n.default.MEDIA_ERROR.iceConnectionError,detail:"ice transport disconnected"})}),S.iceDisconnectedTimeoutMs)):ne()}}))),g}function oe(e){if(!_)throw new Error(e)}function ae(e){L?(L=!1,R=!1,x.log("triggering renegotiation"),I.backup(),w.onNegotiationRequired&&w.onNegotiationRequired()):e&&(x.log("renegotiation postponed"),R=!0)}function se(e,t,r){var o=i.default.hasSendDirectionality(U.audio),a=i.default.hasSendDirectionality(U.video),s=i.default.hasSendDirectionality(U.screensharing),c=i.default.isOnHold(U),l=i.default.hasSendDirectionality(e.audio),u=i.default.hasSendDirectionality(e.video),d=i.default.hasSendDirectionality(e.screensharing),p=i.default.isOnHold(e)
	return re().then((function(){if(x.log("updatePeerConnectionStreamsAsync","pc state",O.signalingState,"hold","[",c,"->",p,"]","audio","[",o,"->",l,"]","video","[",a,"->",u,"]","screensharing","[",s,"->",d,"]"),(c===p||(k&&k.setHold(p),N&&N.setHold(p),!p))&&(o!==l||a!==u||s!==d||D)){r&&(D=!1)
	var e=function(){f(n.default.MODALITY.audio),f(n.default.MODALITY.video)},i=function(){f(n.default.MODALITY.screensharing)},f=function(e){e in Y&&(x.log("remove sender","track kind:",Y[e].track.kind,"track id:",Y[e].track.id),O.removeTrack(Y[e]),delete Y[e])},m=function(e,t,n){if(e){if(x.log("add media track","kind:",e.kind,"id:",e.id),Y[n])throw new Error("track already created, modality:"+n+", kind:"+e.kind+", id:"+e.id)
	Y[n]=O.addTrack(e,t)}}
	if(t&&(x.log("not using any media(track api) track, remove all senders"),function(){if(e(),i(),O.getSenders().length)throw new Error("not all tracks were removed")}(),r&&(l||u)||ue(),r&&d||de()),r){var h=[]
	if(l||u){var v=C._getMediaStream({audio:l,video:u})
	h.push(v.start().then((function(){try{m(v.getObject().getAudioTracks()[0],v.getObject(),n.default.MODALITY.audio),m(v.getObject().getVideoTracks()[0],v.getObject(),n.default.MODALITY.video),t&&ue(),v.onApplyConstraints=function(t){if(k===v){var i=k.getObject()
	x.log("remove media stream","audio tracks:",i.getAudioTracks(),"video tracks:",i.getVideoTracks()),e()}t.then((function(){k===v&&(m(v.getObject().getAudioTracks()[0],v.getObject(),n.default.MODALITY.audio),m(v.getObject().getVideoTracks()[0],v.getObject(),n.default.MODALITY.video))}))},k=v}catch(i){throw e(),ue(),v.dispose(),i}})))}if(d){var g=C._getMediaStream({video:!0})
	h.push(g.start().then((function(){try{m(g.getObject().getVideoTracks()[0],g.getObject(),n.default.MODALITY.screensharing),t&&de(),N=g}catch(e){throw i(),de(),g.dispose(),e}})))}return Promise.all(h)}}}))}function ce(){var e=[]
	return c.default.forOwn(Y,(function(t,n){e.push({track:t.track.id,modality:n})})),e}function le(e){if(S.enableLocalVideoConstraints&&k&&k.hasVideo()){var t=e.getVideoRecvCapabilities()
	if(t.maxFS&&t.maxFPS)return k.applyConstraints(t)
	x.error("remote endpoint didn't specify video receive capability")}return Promise.resolve(!1)}function ue(){k&&(k.dispose(),k=null)}function de(){N&&(N.dispose(),N=null)}function pe(){return G||(V=V.then((function(){return B.getReport()})).then((function(e){return e})).catch((function(e){return x.error("getting statistics should never fail:",e),{}}))),V}}
	t.__esModule=!0,t.default={build:function(e,t,n){return new v(e,t,n)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcTransport",["require","exports","../constants","../helper","../common/utils"],e)}((function(e,t){var n=e("../constants"),i=e("../helper"),r=e("../common/utils")
	function o(e,t,r,o,a,s,c){var l,u,d=this,p=i.default.defer()
	this.nominatedCandidatePair=null,t.log("create RTCIceGatherer","options:",_stringify(a.iceGathererOptions)),this.iceGatherer=s?s.createAssociatedGatherer():new RTCIceGatherer(a.iceGathererOptions),t.log("create RTCIceTransport"),this.iceTransport=c?c.createAssociatedTransport():new RTCIceTransport,this.getLocalCandidatesAsync=function(){return p.promise},this.start=function(e,n){if(u)throw new Error("already started!")
	u=!0,l=r.createCb(a.iceRole),t.log("RTCIceTransport setRemoteCandidates","candidates:",_stringify(e)),d.iceTransport.setRemoteCandidates(e),t.log("RTCIceTransport start","remoteIceParams:",_stringify(n),"role:",a.iceRole),d.iceTransport.start(d.iceGatherer,n,a.iceRole),t.log("RTCIceTransport start","role:",d.iceTransport.role)},this.dispose=function(){t.log("dispose"),d.iceTransport.stop(),d.iceTransport=null,d.iceGatherer=null,p.isPending()&&p.reject(new Error("operation canceled due to stop")),l&&l.dispose()},this.iceGatherer.onlocalcandidate=function(e){t.log("RTCIceGatherer.onlocalcandidate","candidate:",_stringify(e.candidate)),0===Object.keys(e.candidate).length&&p.resolve()},this.iceGatherer.onerror=function(e){t.error("RTCIceGatherer.onerror","event:",e),p.reject(new Error("IceGatherer failed!"))},this.iceTransport.onicestatechange=function(){d.iceTransport&&(t.log("RTCIceTransport.onicestatechange","state:",d.iceTransport.state),"completed"===d.iceTransport.state&&(t.log("pair:",_stringify(d.iceTransport.getNominatedCandidatePair())),d.nominatedCandidatePair=d.iceTransport.getNominatedCandidatePair(),l.iceCompleted()),"audio"===e&&"disconnected"===d.iceTransport.state&&(t.error("audio ICE transport disconnected, ending call!"),o({type:n.default.MEDIA_ERROR.iceConnectionError,detail:"ice transport disconnected"})))},this.iceTransport.oncandidatepairchange=function(e){t.log("RTCIceTransport.oncandidatepairchange","event:",e)}}function a(e,t,i){var r=this,o=!1
	this.dtlsTransport=new RTCDtlsTransport(t),this.dtlsTransport.ondtlsstatechange=function(){e.log("RTCDtlsTransport.ondtlsstatechange","state:",event.state,"role:",r.dtlsTransport?r.dtlsTransport.getLocalParameters().role:"")},this.dtlsTransport.onerror=function(t){e.error("RTCDtlsTransport.onerror","event:",t),i({type:n.default.MEDIA_ERROR.srtpError,detail:t})},this.startAsync=function(t){if(o)throw new Error("already started!")
	return o=!0,e.log("RTCDtlsTransport.start","params:",_stringify(t)),r.dtlsTransport.start(t),Promise.resolve()},this.dispose=function(){o&&r.dtlsTransport.stop(),r.dtlsTransport=null}}function s(e,t,i,r,s,c){var l,u,d,p=!1
	function f(e){var t=e
	return(s.iceCandidateType||s.iceCandidateTransport)&&(t=t.filter((function(e){var t=!0,n=!0
	return s.iceCandidateType&&(t=e.type.match(new RegExp(s.iceCandidateType),"i")),s.iceCandidateTransport&&(n=e.protocol.match(new RegExp(s.iceCandidateTransport,"i"))),t&&n}))),s.iceGathererOptions.gatherPolicy===n.default.ICE_TRANSPORT_POLICY.relay&&t.forEach((function(e){e.relatedAddress=e.ip,e.relatedPort=e.port})),t}l=new o(e,t.createChild("IceT"),i,r,s),d=new a(t.createChild("DtlsT"),l.iceTransport,r),c&&(u=new o(e,t.createChild("RtcpIceT"),i,r,s,l.iceGatherer,l.iceTransport)),Object.defineProperty(this,"iceTransport",{get:function(){return l.iceTransport}}),Object.defineProperty(this,"dtlsTransport",{get:function(){return d?d.dtlsTransport:null}}),this.getLocalParamsAsync=function(){return(u?Promise.all([l.getLocalCandidatesAsync(),u.getLocalCandidatesAsync()]):l.getLocalCandidatesAsync()).then((function(){return{iceParams:l.iceGatherer.getLocalParameters(),iceCandidates:f(l.iceGatherer.getLocalCandidates()),iceCandidatePair:l.nominatedCandidatePair,dtlsParams:d?d.dtlsTransport.getLocalParameters():null,rtcpIceParams:u?u.iceGatherer.getLocalParameters():null,rtcpIceCandidates:u?f(u.iceGatherer.getLocalCandidates()):null,rtcpIceCandidatePair:u?u.nominatedCandidatePair:null}}))},this.startAsync=function(e){if(p)throw new Error("already started!")
	var t=Promise.resolve()
	return p=!0,l.start(e.iceCandidates,e.iceParams),u&&(e.doRtcpMux?(u.dispose(),u=null):u.start(e.rtcpIceCandidates,e.rtcpIceParams)),e.enableDtls&&(t=d.startAsync(e.dtlsParams)),t},this.dispose=function(){t.log("dispose"),l.dispose(),l=null,u&&(u.dispose(),u=null),d&&(d.dispose(),d=null)}}function c(e,t){var n=[],o=!1,a=i.default.defer(),s=0
	function c(i){this.dispose=function(){r.default.remove(n,(function(e){return e===this}))},this.gotCallback=!1,this.iceCompleted=function(){this.gotCallback=!0,this.gotCallbackFromControlling="controlling"===i
	for(var r=0,c=0,l=0;l<n.length;l++)n[l].gotCallback&&r++,n[l].gotCallbackFromControlling&&c++
	c&&c===s&&!o&&(e.log("IceCompletionMonitor REINVITE"),o=!0,t.triggerIceReinvite()),r&&r===n.length&&(e.log("IceCompletionMonitor ALL COMPLETE"),a.resolve())}}this.createCb=function(e){var t=new c(e)
	return n.push(t),"controlling"===e&&(o=!1,s++),a.reject(void 0),a=i.default.defer(),t},this.waitAllCallbacksAsync=function(){return a.promise}}t.__esModule=!0,t.default=function(e,t,i,r,o,a,l){var u,d,p,f,m=[!1,!1],h=(a=a||n.default.ICE_TRANSPORT_POLICY.all,new c(e,i))
	Object.defineProperty(this,"audioTransport",{get:function(){return u||null}}),Object.defineProperty(this,"videoTransport",{get:function(){return d||null}}),Object.defineProperty(this,"screensharingTransport",{get:function(){return p||null}}),this.assureInitAsync=function(n,c){return new Promise((function(m){e.log("assureInitAsync"),m((f||(f=r.queryRelaysAsync("msturn",o)),f).then((function(r){var o={iceRole:n,iceCandidateType:t.iceCandidateType,iceCandidateTransport:t.iceCandidateTransport,iceGathererOptions:{gatherPolicy:a,iceServers:r.reduce((function(e,t){return t.addresses.map((function(n){e.push({urls:t.type+":"+n+":"+t.udpPort+"?transport=udp",credential:t.password,username:t.username}),e.push({urls:t.type+":"+n+":"+t.tcpPort+"?transport=tcp",credential:t.password,username:t.username})})),e}),[])}}
	!u&&c[0]&&(e.log("assureInitAsync AUDIO "+o.iceRole),u=new s("audio",e.createChild("AT"),h,i.raiseError,o,l)),!d&&c[1]&&(e.log("assureInitAsync VIDEO "+o.iceRole),d=new s("video",e.createChild("VT"),h,i.raiseError,o,l)),!p&&c[2]&&(e.log("assureInitAsync SCREENSHARING "+o.iceRole),p=new s("video",e.createChild("ST"),h,i.raiseError,o,l))})))}))},this.getLocalParamsAsync=function(){return e.log("getLocalParamsAsync"),new Promise((function(e){var t=Promise.resolve(),n=Promise.resolve(),i=Promise.resolve()
	u&&(t=u.getLocalParamsAsync()),d&&(n=d.getLocalParamsAsync()),p&&(i=p.getLocalParamsAsync()),e(Promise.all([t,n,i]))}))},this.waitIceCompletionIfNeededAsync=function(t){return new Promise((function(n){var i="";(t[0]&&t[0].iceCandidatePair||t[1]&&t[1].iceCandidatePair)&&(e.log("waiting ICE completed state!"),i=h.waitAllCallbacksAsync()),n(i)}))},this.configureTransportAsync=function(e,t){return new Promise((function(n){var i=Promise.resolve(),r=Promise.resolve(),o=Promise.resolve()
	t[0]&&!m[0]?i=u.startAsync(e[0]):!t[0]&&m[0]&&(u.dispose(),u=null),t[1]&&!m[1]?r=d.startAsync(e[1]):!t[1]&&m[1]&&(d.dispose(),d=null),t[2]&&!m[2]?o=p.startAsync(e[2]):!t[2]&&m[2]&&(p.dispose(),p=null),m=t,n(Promise.all([i,r,o]))}))},this.stop=function(){u&&(u.dispose(),u=null),d&&(d.dispose(),d=null),p&&(p.dispose(),p=null)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcHelper",["require","exports","../constants","../helper","../common/utils"],e)}((function(e,t){var n=e("../constants"),i=e("../helper"),r=e("../common/utils")
	function o(e,t){return e.toLowerCase()===t.toLowerCase()}function a(e){return e.enabled?e.send&&e.recv?n.default.MEDIA_STATE.sendReceive:e.send?n.default.MEDIA_STATE.send:e.recv?n.default.MEDIA_STATE.receive:n.default.MEDIA_STATE.inactive:null}function s(e){if(e===n.default.MEDIA_LABEL.audio)return n.default.MEDIA_TYPE.audio
	if(e===n.default.MEDIA_LABEL.video)return n.default.MEDIA_TYPE.video
	if(e===n.default.MEDIA_LABEL.screensharing)return n.default.MEDIA_TYPE.video
	throw new Error("unsupported label: "+e)}function c(e,t){for(var n=0;n<e.length;n++)if(e[n].descr.label===t)return e[n].descr
	return{enabled:!1,type:s(t),label:t,send:!1,recv:!1}}function l(e,t){return r.default.find(t,(function(t,n,i){if(t.preferredPayloadType===+e)return!0}))}function u(e,t){return r.default.find(t,(function(t,n,i){if(o(t.name,e))return!0}))}function d(e,t){return l(e,t).name}function p(e,t,n,i){var a=[]
	if(e&&t)return e.filter((function(e){return!o(e.name,"rtx")})).forEach((function(e){for(var s=0;s<t.length;s++){var c=t[s]
	if(o(e.name,c.name)&&o(e.kind,c.kind)&&e.numChannels===c.numChannels&&e.clockRate===c.clockRate){var l=r.default.shallowClone(i?c:e)
	l.preferredPayloadType=n?e.preferredPayloadType:c.preferredPayloadType,a.push(l)
	break}}})),e.filter((function(e){return o(e.name,"rtx")})).forEach((function(s){for(var c=0;c<t.length;c++){var p=t[c]
	if(o(s.name,p.name)&&o(s.kind,p.kind)&&s.numChannels===p.numChannels&&s.clockRate===p.clockRate&&o(d(s.parameters.apt,e),d(p.parameters.apt,t))){var f=r.default.shallowClone(i?p:s)
	f.preferredPayloadType=n?s.preferredPayloadType:p.preferredPayloadType,f.parameters.apt=u(l(s.parameters.apt,e).name,a).preferredPayloadType,a.push(f)
	break}}})),a}function f(e,t){var n=[]
	return e&&t&&e.forEach((function(e){for(var i=0;i<t.length;i++){var r=t[i]
	e.kind===r.kind&&e.uri===r.uri&&n.push(e)}})),n}function m(e,t,n,i,r,o){return a="",f=e.codecs,m=[],f.forEach((function(e){m.push(h(e.name,e.preferredPayloadType,e.clockRate,e.numChannels,e.rtcpFeedback,e.parameters,e.ptime,e.maxptime))})),s=m,d=e.headerExtensions,p=[],d.forEach((function(e){p.push(v(e.uri,e.preferredId,e.preferredEncrypt))})),c=p,l=function(e,t){var n=[]
	return n.push(b(e,0,0,t,1)),n}(t,o),u=g(n,"",i,r),{muxId:a||"",codecs:s,headerExtensions:c,encodings:l,rtcp:u,degradationPreference:"balanced"}
	var a,s,c,l,u,d,p,f,m}function h(e,t,n,i,r,o,a,s){return{name:e,payloadType:t,clockRate:n,numChannels:i,rtcpFeedback:r,parameters:o,ptime:a,maxptime:s}}function v(e,t,n){return{uri:e,id:t,encrypt:n}}function g(e,t,n,i){return{ssrc:e,cname:t,reducedSize:n,mux:i}}function y(e){return e.some((function(e){return o(e.name,"rtx")}))}function b(e,t,n,i,r,o,a,s,c,l,u,d,p,f){return{ssrc:e.min,ssrcRange:e,codecPayloadType:t,fec:n,rtx:i?{ssrc:i}:0,priority:r||1,maxBitrate:o,minQuality:a||0,framerateBias:s||.5,resolutionScale:c||1,framerateScale:l||1,active:d||!0,encodingId:p,dependencyEncodingId:f}}t.__esModule=!0,t.default={getStateFromDescr:a,getDescrFromState:function(e,t){return{enabled:!!e,type:s(t),label:t,send:i.default.hasSendDirectionality(e),recv:i.default.hasReceiveDirectionality(e)}},getCodecIndexByPayload:function(e,t){return r.default.findIndex(t,(function(t,n,i){if(t.preferredPayloadType===e)return!0}))},findDescrFromMedia:c,getModalitiesFromMedia:function(e){var t={},i=c(e,n.default.MEDIA_LABEL.audio),r=c(e,n.default.MEDIA_LABEL.video),o=c(e,n.default.MEDIA_LABEL.screensharing)
	return i.enabled&&(t.audio=a(i)),r.enabled&&(t.video=a(r)),o.enabled&&(t.screensharing=a(o)),t},findMatchingSdesParams:function(e,t){for(var n=0;n<t.length;++n)for(var i=t[n],o=0;o<e.length;++o){var a=e[o]
	if(c=a,l=void 0,u=void 0,l=(s=i).keyParams[0],u=c.keyParams[0],s.cryptoSuite===c.cryptoSuite&&l.mkiLength===u.mkiLength&&l.mkiValue===u.mkiValue)return{localSdesParams:r.default.shallowClone(a),remoteSdesParams:r.default.shallowClone(i)}}var s,c,l,u
	return null},matchRtpCaps:function(e,t,n,i){var r=null
	return e&&t&&(r={codecs:p(e.codecs,t.codecs,n,i),headerExtensions:f(e.headerExtensions,t.headerExtensions),fecMechanisms:e.fecMechanisms.filter((function(e){return-1!==t.fecMechanisms.indexOf(e)}))}),r},getSendParams:m,getRecvParams:function(e,t,n,i,r,o){return m(e,t,n,i,r,o)},getTransportIdxForLabel:function(e){if(e===n.default.MEDIA_LABEL.audio)return 0
	if(e===n.default.MEDIA_LABEL.video)return 1
	if(e===n.default.MEDIA_LABEL.screensharing)return 2
	throw new Error("unsupported label: "+e)},RTCRtpCodecParameters:h,RTCRtpHeaderExtensionParameters:v,RTCRtcpParameters:g,hasRtx:y,getRtxSsrc:function(e,t,n,i){return y(e.codecs)?i?t.rtxSsrc:n.rtxSsrc:0},RTCRtpEncodingParameters:b}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcChannelStats",["require","exports","../helper","../common/utils"],e)}((function(e,t){var n=e("../helper"),i=e("../common/utils")
	function r(e,t,r,o){var a=e.logger.createChild("ChannelStats")
	function s(){if(!t)return"CheckNotCompleted"
	var e=t.state
	return"new"===e||"checking"===e||"connected"===e?"CheckNotCompleted":"completed"===e?"CheckSucceed":"failed"===e?"CheckFailed":"disconnected"===e||"closed"===e?"MediaTimeout":"Unknown DiagnosticReason"}this.getReport=function(){var e={}
	function c(t,r,o){if(t){var s=r+"."+(o?"msGetStats":"getStats"),c=new Promise((function(e){a.log(s,"start"),e(o?t.msGetStats():t.getStats())})).then((function(t){a.log(s,"complete"),e[r]=e[r]||{},i.default.forOwn(t,(function(t){e[r][t.type||t.msType]=t}))})).catch((function(e){a.warn(s,"failed:",e)}))
	return n.default.timeout(c,5e3,s).catch((function(e){a.warn(s,"failed:",e)}))}}return e.extended={mediaDiagnostic:{reason:s()}},new Promise((function(n){Promise.all([c(t,"iceTransport",!1),c(t,"iceTransport",!0),c(r,"sender",!1),c(r,"sender",!0),c(o,"receiver",!1),c(o,"receiver",!0)]).then((function(){n(e)})).catch((function(t){a.error("getting statistics should never fail",t),n(e)}))}))}}t.__esModule=!0,t.default={build:function(e,t,n,i){return new r(e,t,n,i)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcDtmfSender",["require","exports","../common/dtmfUtils"],e)}((function(e,t){var n=e("../common/dtmfUtils"),i=function(){function e(e,t){this.queue=new n.DTMFQueue(e),this.settings=t||n.defaultSettings}return e.prototype.sendDtmf=function(e,t){return e?(this.syncSender(e),this.ortcSender.canInsertDTMF?(this.ortcSender.insertDTMF(this.ortcSender.toneBuffer+t,this.settings.toneDuration,this.settings.toneGap),this.queue.waitForNotification(t)):Promise.reject(new Error("not available"))):Promise.reject(new Error("bad sender"))},e.prototype.canSendDtmf=function(e){return!!e&&(this.syncSender(e),!!this.ortcSender&&this.ortcSender.canInsertDTMF)},e.prototype.dispose=function(){this.queue.cleanup()},e.prototype.syncSender=function(e){this.ortcSender&&this.ortcSender.sender===e||(this.ortcSender&&(this.ortcSender.ontonechange=null,this.queue.cleanup(),this.ortcSender=null),this.ortcSender=new RTCDtmfSender(e),this.ortcSender.ontonechange=this.onToneChange.bind(this))},e.prototype.onToneChange=function(e){e.tone&&this.queue.toneSent(e.tone)},e}()
	t.OrtcDTMFSender=i,t.__esModule=!0,t.default={build:function(e,t){return new i(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcMediaChannel",["require","exports","./ortcHelper","../constants","./ortcChannelStats","../common/utils","./ortcDtmfSender"],e)}((function(e,t){var n=e("./ortcHelper"),i=e("../constants"),r=e("./ortcChannelStats"),o=e("../common/utils"),a=e("./ortcDtmfSender")
	t.__esModule=!0,t.default=function(e,t,s,c,l,u,d){var p,f,m=this,h=null,v=null,g=null,y=null,b=null,_=null,E=!1,w=!1,S=1e3,x=[],C=a.default.build(e,t.dtmf)
	function T(t){var n,i,r
	if(A()?(i=y.getObject().getAudioTracks()[0],n=t.getObject().getAudioTracks()):(i=y.getObject().getVideoTracks()[0],n=t.getObject().getVideoTracks()),null!==(r=n.length?n[0]:null)){var o=i.getSettings().deviceId,a=r.getSettings().deviceId
	o!==a?(e.log("replacing media track","currDevID:",o,"newDevID:",a,"currTrackID:",i.id,"newTrackID:",r.id),h.setTrack(r),y.dispose(),y=t.clone()):e.log("NOT replacing media track","currDevID:",o,"newDevID:",a,"currTrackID:",i.id,"newTrackID:",r.id)}else e.error("media track is not available")}function I(t,n){b||(e.debug("RTCSrtpSdesTransport","local:",_stringify(n.sdesParamsList[0]),"remote:",_stringify(n.remoteSdesParams)),(b=new RTCSrtpSdesTransport(t,n.sdesParamsList[0],n.remoteSdesParams)).onerror=function(t){e.log("RTCSrtpSdesTransport.onerror","event:",t),l({type:i.default.MEDIA_ERROR.srtpError,detail:t})})}function A(){return s===i.default.MEDIA_TYPE.audio}function M(){return s===i.default.MEDIA_TYPE.video}function O(){if(w&&v){var t
	try{t=v.getContributingSources()}catch(n){return void e.error("failed to retrieve contributing sources from receiver","error:",n)}if(!t)return void e.warn("could not retrieve contributing sources from receiver")
	t=t.map((function(e){return e.csrc})),x.length===t.length&&t.every((function(e,t){return e===x[t]}))||(e.debug("contributing sources changed","sources:",t),m.onContributingSourcesChanged&&m.onContributingSourcesChanged(t)),x=t,setTimeout(O,S)}else e.debug("receiver is missing, stop polling for contributing sources")}function k(t){if(w&&v){e.log("_requestSendCsrc","csrc:",t)
	try{v.requestSendCSRC(t)}catch(n){e.error("failed to request send csrc","error:",n)}return!0}return!1}function N(t,r,o){v&&U(r.remoteSsrcRange,f)&&(e.log("SSRC changed, resetting receiver"),P()),v||(function(t,n){if(e.log("_rtpReceiver create"),n.enableDtls){if(!n.rtcpMux)throw new Error("rtcpMux=false not supported with dtls!")
	v=new RTCRtpReceiver(t.dtlsTransport,s)}else I(t.iceTransport,n),v=new RTCRtpReceiver(b,s)
	g=v.track,v.onerror=function(t){e.error("_rtpReceiver.onerror","event:",t),l({type:i.default.MEDIA_ERROR.internalError,detail:t})}}(o,r),f=r.remoteSsrcRange),w=!!t.recv
	var a,c,p=(a=r,c=n.default.getRecvParams(a.rtpCaps,a.remoteSsrcRange,u.min,a.rtcpReducedSize,a.rtcpMux,a.rtxSsrc),d&&(c.degradationPreference="maintain-resolution"),c.encodings[0].active=w,c)
	e.debug("_rtpReceiver.receive:",_stringify(p)),v.receive(p),w&&(A()?O():m.subscribedMsi!==i.default.MSI.unsubscribe&&k(m.subscribedMsi))}function P(){v&&(e.log("_rtpReceiver stop & destroy"),w=!1,g=null,v.stop(),v=null)}function R(t,r,o,a){if(h&&U(r.remoteSsrcRange,p)&&(e.log("SSRC changed, resetting sender"),L()),E=!!t.send){y?T(a):y=a.clone(),h||(function(t,n,r){var o
	if(o=A()?n.getObject().getAudioTracks()[0]:n.getObject().getVideoTracks()[0],e.log("_rtpSender create trackID:",o.id),r.enableDtls){if(!r.rtcpMux)throw new Error("rtcpMux=false not supported with dtls!")
	h=new RTCRtpSender(o.clone(),t.dtlsTransport)}else I(t.iceTransport,r),h=new RTCRtpSender(o.clone(),b)
	A()&&(n.onMute=function(e){h&&(h.track.enabled=!e)}),h.onerror=function(t){e.error("_rtpSender.onerror","event:",t),l({type:i.default.MEDIA_ERROR.internalError,detail:t})},h.onssrcconflict=function(t){e.error("_rtpSender.onssrcconflict","event:",t)}}(o,y,r),p=r.remoteSsrcRange)
	var s=(c=r,(d=n.default.getSendParams(c.rtpCaps,u,c.remoteSsrcRange.min,c.rtcpReducedSize,c.rtcpMux,c.rtxSsrc)).encodings[0].active=E,d)
	e.debug("_rtpSender.send:",_stringify(s)),h.send(s)}else L(),D()
	var c,d}function L(){C&&(C.dispose(),C=null),h&&(e.log("_rtpSender stop & destroy"),E=!1,h.stop(),h=null)}function D(){y&&(y.dispose(),y=null)}function U(e,t){return t&&e&&(e.min!==t.min||e.max!==t.max)}function F(){P(),L(),D(),b&&(b=null)}this.type=s,this.label=c,this.subscribedMsi=i.default.MSI.unsubscribe,this.onContributingSourcesChanged=null,t.disableSdes||(_=RTCSrtpSdesTransport.getLocalParameters().filter((function(e){return"SCALE_AES_CM_128_HMAC_SHA1_80"!==e.cryptoSuite}))),this.getLocalParameters=function(){var r=function(){var n,r=RTCRtpReceiver.getCapabilities(s)
	if(r.codecs)if(s===i.default.MEDIA_TYPE.audio&&t.audioCodec){var a=["cn","red"]
	o.default.remove(r.codecs,(function(e){var n=e.name.toLowerCase()
	return n!==t.audioCodec.toLowerCase()&&-1===a.indexOf(n)}))}else s===i.default.MEDIA_TYPE.video&&t.videoCodec&&o.default.remove(r.codecs,(function(e){return e.name.toLowerCase()!==t.videoCodec.toLowerCase()}))
	if(s===i.default.MEDIA_TYPE.audio)for(n=r.codecs.length-1;n>=0;n--)106===r.codecs[n].preferredPayloadType&&(r.codecs[n].preferredPayloadType=111,e.log("Opus payloadType fix, change payload type 106->111 for",r.codecs[n].name))
	return r}(),a={sdesParamsList:_,rtpCaps:r,rtxSsrc:n.default.hasRtx(r.codecs)?u.min+50:0,ssrcRange:u}
	return{sender:a,receiver:o.default.deepClone(a)}},this.configureChannel=function(t,n,i){e.log("configureChannel","type:",s,"descr:",_stringify(t.descr)),t.descr.enabled?(N(t.descr,t.receiver,n),R(t.descr,t.sender,n,i)):F()},this.updateLocalMediaStream=function(e){h&&T(e)},this.canSubscribe=function(){return w&&v&&m.subscribedMsi===i.default.MSI.unsubscribe&&M()},this.subscribe=function(e){if(m.subscribedMsi===i.default.MSI.unsubscribe&&M())return m.subscribedMsi=e,k(m.subscribedMsi)
	throw new Error("invalid call for subscribe:"+m.subscribedMsi+"type:"+s)},this.unsubscribe=function(){if(m.subscribedMsi===i.default.MSI.unsubscribe||!M())throw new Error("invalid call for unsubscribe:"+m.subscribedMsi+"type:"+s)
	m.subscribedMsi=i.default.MSI.unsubscribe,k(m.subscribedMsi)},this.getReportsAsync=function(){var t=w?v:null,n=E?h:null,i=t?t.transport.transport:n?n.transport.transport:null
	return r.default.build({logger:e},i,n,t).getReport()},this.getSendTrack=function(){return E&&h?h.track:null},this.getRecvTrack=function(){return w&&v?g:null},this.terminate=function(){F(),e.log("termiated")},this.sendDtmf=function(e){return C.sendDtmf(h,e)},this.canSendDtmf=function(){return C.canSendDtmf(h)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcNegotiation",["require","exports","./ortcHelper","../constants","../common/utils"],e)}((function(e,t){var n=e("./ortcHelper"),i=e("../constants"),r=e("../common/utils")
	t.__esModule=!0,t.default=function(e,t,o){this.processOffer=function(t){a=t,e.debug("PROCESS OFFER","params:",_stringify(a))},this.createMediaDescriptorsForAnswer=function(e){if(c&&c.media.length>a.media.length)throw new Error("Invalid remote offer - removed media lines")
	for(var t,r=[],s=!1,u=!1,d=0,p=0;p<a.media.length;p++){if(c&&c.media[p]){if(c.media[p].type!==a.media[p].type)throw new Error("Changing media type not supported")
	if(c.media[p].label&&a.media[p].label&&c.media[p].label!==a.media[p].label)throw new Error("Changing media label not supported")}a.media[p].descr.label!==i.default.MEDIA_LABEL.audio||s?a.media[p].descr.label===i.default.MEDIA_LABEL.video&&d<o?(t=l(n.default.getDescrFromState(e.video,i.default.MEDIA_LABEL.video),a.media[p].descr),d>0&&(t.send=!1),r.push(t),d++):a.media[p].descr.label!==i.default.MEDIA_LABEL.screensharing||u?r.push({enabled:!1,type:a.media[p].descr.type,label:c&&c.media[p]?c.media[p].descr.label:a.media[p].descr.label}):(t=l(n.default.getDescrFromState(e.screensharing,i.default.MEDIA_LABEL.screensharing),a.media[p].descr),r.push(t),u=!0):(t=l(n.default.getDescrFromState(e.audio,i.default.MEDIA_LABEL.audio),a.media[p].descr),r.push(t),s=!0)}return r},this.createAnswer=function(t,o,c,l){for(var m={isOffer:!1,sessionVersion:a.sessionVersion,transportParams:u(o,a),media:[]},h=!1,g=0;g<t.length;g++){var y=h&&t[g].label===i.default.MEDIA_LABEL.video
	t[g].label===i.default.MEDIA_LABEL.video&&(h=!0)
	var b={},_=r.default.shallowClone(t[g])
	if(_.enabled){var E=n.default.getTransportIdxForLabel(_.label),w=m.transportParams[E],S=d(c[g],a.media[g],!1,!1),x=d(c[g],a.media[g],!1,!0)
	S.sdesParamsList.length&&S.remoteSdesParams&&(S.sdesParamsList[0].tag=S.remoteSdesParams.tag),x.sdesParamsList.length&&x.remoteSdesParams&&(x.sdesParamsList[0].tag=x.remoteSdesParams.tag),b.receiver=S,b.sender=x,f(_,w,b.receiver)&&f(_,w,b.sender)||(_.enabled=!1,e.warn("Rejecting media since unable to match parameters"))}m.media.push(p(_,b,!1,y,a.media[g].receiver.rtcpReducedSize))}e.debug(l?"CREATE PRANSWER":"CREATE ANSWER","params:",_stringify(m)),l||(s=v(m,a,!1))
	return m},this.createMediaDescriptorsForOffer=function(e){var t,r=[],a=!1,s=!1,l=0
	if(c)for(var u=0;u<c.media.length;u++)c.media[u].descr.label!==i.default.MEDIA_LABEL.audio||a?c.media[u].descr.label===i.default.MEDIA_LABEL.video&&l<o?(t=n.default.getDescrFromState(e.video,i.default.MEDIA_LABEL.video),l>0&&(t.send=!1),r.push(t),l++):c.media[u].descr.label!==i.default.MEDIA_LABEL.screensharing||s?r.push({enabled:!1,type:c.media[u].descr.type,label:c.media[u].descr.label}):(t=n.default.getDescrFromState(e.screensharing,i.default.MEDIA_LABEL.screensharing),r.push(t),s=!0):(t=n.default.getDescrFromState(e.audio,i.default.MEDIA_LABEL.audio),r.push(t),a=!0)
	!a&&e.audio&&(t=n.default.getDescrFromState(e.audio,i.default.MEDIA_LABEL.audio),r.push(t))
	!s&&e.screensharing&&(t=n.default.getDescrFromState(e.screensharing,i.default.MEDIA_LABEL.screensharing),r.push(t))
	for(var d=l;d<o&&e.video;d++)t=n.default.getDescrFromState(e.video,i.default.MEDIA_LABEL.video),d>0&&(t.send=!1),r.push(t)
	return r},this.createOffer=function(t,n,r){for(var o={isOffer:!0,sessionVersion:c?c.sessionVersion:0,transportParams:u(n,c),media:[]},s=!1,l=0;l<t.length;l++){var d,f=!(c&&c.media[l]&&c.media[l].descr.enabled)&&t[l].enabled
	d=f?r[l]:c.media[l]
	var m=s&&t[l].label===i.default.MEDIA_LABEL.video
	t[l].label===i.default.MEDIA_LABEL.video&&(s=!0),o.media.push(p(t[l],d,f,m,!0))}return a=o,e.debug("CREATE OFFER","params:",_stringify(a)),a},this.processAnswer=function(t){e.debug("PROCESS ANSWER","params:",_stringify(t)),s=v(a,t,!0)},this.completeNegotiation=function(){return s.sessionVersion++,c=s,e.debug("NEGOTIATED","params:",_stringify(c)),c}
	var a=null,s=null,c=null
	function l(e,t){t||(t={enabled:!0,send:!0,recv:!0})
	var n=e.send&&e.enabled&&t.recv&&t.enabled,i=e.recv&&e.enabled&&t.send&&t.enabled
	return{enabled:e.enabled&&t.enabled&&(n||i||!e.send&&!e.recv||!t.send&&!t.recv),type:e.type,label:e.label,send:n,recv:i}}function u(e,n){for(var i=n?n.transportParams:[],r=0;r<e.length;r++)if(e[r]&&(e[r].doRtcpMux=!(i[r]&&!i[r].doRtcpMux)),e[r]&&i[r]){for(var o=!1,a=0;!t.disableSdes&&a<n.media.length;a++)n.media[a].receiver&&n.media[a].receiver.sdesParamsList&&n.media[a].receiver.sdesParamsList.length&&(o=!0)
	i[r].doRtcpMux&&(e[r].rtcpIceParams=null,e[r].rtcpIceCandidates=null),e[r].dtlsParams&&i[r].dtlsParams&&(e[r].dtlsParams.role="client"===i[r].dtlsParams.role?"server":"client"),!o&&i[r].dtlsParams||(e[r].dtlsParams=null)}else e[r]&&e[r].dtlsParams&&(e[r].dtlsParams.role=null)
	return e}function d(e,t,i,r){var o,a=r?e.sender:e.receiver,s=r?t.receiver:t.sender
	a.sdesParamsList&&s.sdesParamsList&&(o=n.default.findMatchingSdesParams(a.sdesParamsList,s.sdesParamsList))
	var c,l=[]
	o&&(l.push(o.localSdesParams),c=o.remoteSdesParams)
	var u=n.default.matchRtpCaps(a.rtpCaps,s.rtpCaps,i,r)
	return{ssrcRange:a.ssrcRange,remoteSsrcRange:s.ssrcRange,rtxSsrc:n.default.getRtxSsrc(u,a,s,r),sdesParamsList:l,remoteSdesParams:c,rtpCaps:u}}function p(e,t,n,i,r){if(e.enabled){var o=t
	return o.sender.rtcpReducedSize=r,o.receiver.rtcpReducedSize=r,o.descr=e,o.justAdded=n,o.bundledWithOther=i,o}return{descr:e}}function f(t,n,i){if(t.enabled){if(!(i.sdesParamsList.length&&i.remoteSdesParams||n.dtlsParams))return e.warn("no sdes nor dtls params:",i.sdesParamsList,i.remoteSdesParams,n.dtlsParams),!1
	if(!i.rtpCaps.codecs.length)return e.warn("no common codecs!",i.rtpCaps),!1}return!0}function m(e,t){for(var n=[],i=0;i<Math.max(e.length,t.length);i++){var o=null
	e[i]&&t[i]&&((o=r.default.shallowClone(t[i])).doRtcpMux=e[i].doRtcpMux&&t[i].doRtcpMux,o.enableDtls=e[i].dtlsParams&&t[i].dtlsParams),n.push(o)}return n}function h(e,t,i,r){function o(n){var i=n?e.sender:e.receiver,o=n?t.sender:t.receiver,a=d(e,t,r,n)
	return a.rtcpMux=c.doRtcpMux,a.rtcpReducedSize=i.rtcpReducedSize&&o.rtcpReducedSize,a.enableDtls=c.enableDtls,a}var a=l(e.descr,t.descr),s={descr:a}
	if(a.enabled){var c=i[n.default.getTransportIdxForLabel(a.label)]
	if(s.descr=a,s.sender=o(!0),s.receiver=o(!1),!f(a,c,s.sender)||!f(a,c,s.receiver))throw new Error("Failed to verify negotiated parameters!")}return s}function v(e,t,n){if(e.media.length!==t.media.length)throw new Error("Number of media lines doesn't match in offer & answer l:"+e.media.length+" r: "+t.media.length)
	for(var i={sessionVersion:n?e.sessionVersion:t.sessionVersion,transportParams:m(e.transportParams,t.transportParams),media:[]},r=0;r<e.media.length;r++)i.media.push(h(e.media[r],t.media[r],i.transportParams,n))
	return i}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcSdp",["require","exports","microsoft-sdp-transform","../constants","./ortcHelper","../common/utils","../common/formatParameters"],e)}((function(e,t){var n=e("microsoft-sdp-transform"),i=e("../constants"),r=e("./ortcHelper"),o=e("../common/utils"),a=e("../common/formatParameters")
	t.__esModule=!0,t.default=function(){function e(e,t){return t?e.replace(/\\/g,"/"):e.replace(/\//g,"\\")}function t(e,t){return e.toLowerCase()===t.toLowerCase()}function s(e){return-1===e.indexOf(":")}function c(e,t){var n=e.toUpperCase()
	if("TCP"===n)switch(t.toLowerCase()){case"active":return"TCP-ACT"
	case"passive":return"TCP-PASS"
	case"so":return"TCP-SO"}return n}function l(e,n,i){i.push({foundation:e.foundation,component:n,transport:c(e.protocol,e.tcpType),priority:e.priority,ip:e.ip,port:e.port,type:e.type,raddr:t(e.type,"host")?void 0:e.relatedAddress,rport:t(e.type,"host")?void 0:e.relatedPort})}function u(e,t,n,i){e&&e.forEach((function(e){s(e.ip)?l(e,t,n):l(e,t,i)}))}function d(e){if(e.iceCandidatePair)return{0:e.iceCandidatePair.local,1:e.rtcpIceCandidatePair?e.rtcpIceCandidatePair.local:null}
	var t=e.iceCandidates.slice(0).sort((function(e,t){return t.priority-e.priority}))[0],n=null
	if(e.rtcpIceCandidates)for(var i=0;i<e.rtcpIceCandidates.length;++i){var r=e.rtcpIceCandidates[i]
	if(r.foundation===t.foundation){n=r
	break}}return{0:t,1:n}}function p(n,r,a,c){var l=r.receiver,p={rtp:[],fmtp:[],rtcpFb:[],ext:[],type:r.descr.type,port:0,protocol:"RTP/SAVP",payloads:"",cryptoscale:[],crypto:[],candidates:[],xCandidatesIpv6:[]}
	if(!r.descr.enabled)return p.type===i.default.MEDIA_TYPE.video?p.payloads="34":p.payloads="9",p
	var f,m,h=d(n),v=h[0],g=h[1]
	if(p.port=v.port,c.ip!==v.ip&&(p.connection={version:s(v.ip)?4:6,ip:v.ip}),p.iceUfrag=n.iceParams.usernameFragment,p.icePwd=n.iceParams.password,p.type===i.default.MEDIA_TYPE.audio){var y=function(e){if(0===e.length)return{ptime:0,maxptime:0}
	var t=e[0].ptime,n=e[0].maxptime
	return e.forEach((function(e){n>e.maxptime&&e.maxptime>0&&(n=e.maxptime)})),{ptime:t,maxptime:n}}(l.rtpCaps.codecs)
	p.maxptime=y.maxptime,p.ptime=y.ptime}p.direction=(f=r.descr.send,m=r.descr.recv,f&&m?"sendrecv":f?"sendonly":m?"recvonly":"inactive"),p.xSsrcRange={ssrcMin:l.ssrcRange.min,ssrcMax:l.ssrcRange.max},p.ssrcGroups=function(e,t){if(e)return[{semantics:"FID",ssrcs:t+" "+e}]
	return[]}(r.sender.rtxSsrc,r.sender.ssrcRange.min),p.label=r.descr.label,r.bundledWithOther||(p.xSource=r.descr.label),l.rtcpReducedSize&&(p.rtcpRsize=!0),a&&r.justAdded?(n.doRtcpMux&&(p.rtcpMux=!0),p.rtcp={port:g&&g.port||p.port+1}):n.doRtcpMux?p.rtcpMux=!0:p.rtcp={port:g&&g.port||p.port+1}
	var b=null
	function _(e){return 0!==e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:""}if(l.rtpCaps&&l.rtpCaps.codecs&&(l.rtpCaps.codecs.forEach((function(e){p.rtp.push({payload:e.preferredPayloadType,codec:e.name,rate:e.clockRate,encoding:e.numChannels>1?e.numChannels:void 0})
	var n=""
	o.default.forOwn(e.parameters,(function(e,t){""!==n&&(n+=";"),n+="events"===t?e:t+"="+e})),""!==n&&p.fmtp.push({payload:e.preferredPayloadType,config:n}),p.payloads+=(p.payloads?" ":"")+e.preferredPayloadType
	for(var i=0;i<e.rtcpFeedback.length;i++)t(e.rtcpFeedback[i].type,"x-message")?b=e.rtcpFeedback[i].parameter:p.rtcpFb.push({payload:e.preferredPayloadType,type:e.rtcpFeedback[i].type,subtype:e.rtcpFeedback[i].parameter})})),b&&p.rtcpFb.push({payload:"*",type:"x-message",subtype:b})),l.rtpCaps&&l.rtpCaps.headerExtensions&&l.rtpCaps.headerExtensions.forEach((function(t){p.ext.push({value:t.preferredId,uri:e(t.uri,!1)})})),l.sdesParamsList)for(var E=0;E<l.sdesParamsList.length;++E){var w=l.sdesParamsList[E]
	t(w.cryptoSuite,"AES_CM_128_HMAC_SHA1_80")?p.crypto.push({id:w.tag,suite:"AES_CM_128_HMAC_SHA1_80",config:w.keyParams[0].keyMethod+":"+w.keyParams[0].keySalt+"|"+w.keyParams[0].lifetime+_(w.keyParams[0])}):t(w.cryptoSuite,"SCALE_AES_CM_128_HMAC_SHA1_80")&&p.cryptoscale.push({id:w.tag,flavor:"client",suite:"AES_CM_128_HMAC_SHA1_80",config:w.keyParams[0].keyMethod+":"+w.keyParams[0].keySalt+"|"+w.keyParams[0].lifetime+_(w.keyParams[0])})}if(!r.bundledWithOther&&(n.iceCandidatePair?(u([n.iceCandidatePair.local],1,p.candidates,p.xCandidatesIpv6),n.rtcpIceCandidatePair&&!n.doRtcpMux&&u([n.rtcpIceCandidatePair.local],2,p.candidates,p.xCandidatesIpv6),p.remoteCandidates="1 "+n.iceCandidatePair.remote.ip+" "+n.iceCandidatePair.remote.port,n.doRtcpMux?p.remoteCandidates+=" 2 "+n.iceCandidatePair.remote.ip+" "+n.iceCandidatePair.remote.port:p.remoteCandidates+=" 2 "+n.rtcpIceCandidatePair.remote.ip+" "+n.rtcpIceCandidatePair.remote.port):(u(n.iceCandidates,1,p.candidates,p.xCandidatesIpv6),(a&&r.justAdded||!n.doRtcpMux)&&u(n.rtcpIceCandidates,2,p.candidates,p.xCandidatesIpv6)),p.candidates.sort((function(e,t){return+e.foundation-+t.foundation||e.foundation===t.foundation&&e.component-t.component})),p.xCandidatesIpv6.sort((function(e,t){return+e.foundation-+t.foundation||e.foundation===t.foundation&&e.component-t.component})),n.dtlsParams))switch(p.fingerprint={type:n.dtlsParams.fingerprints[0].algorithm,hash:n.dtlsParams.fingerprints[0].value},n.dtlsParams.role){case"auto":p.setup="actpass"
	break
	case"client":p.setup="active"
	break
	case"server":p.setup="passive"}return p}function f(e){var t=e.toLowerCase()
	switch(t){case"tcp-act":case"tcp-pass":case"tcp-so":return"tcp"
	default:return t}}function m(e){var n={foundation:e.foundation,priority:e.priority,ip:e.ip,protocol:f(e.transport),port:e.port,type:e.type}
	return t(e.type,"host")||(n.tcpType=function(e){switch(e.toLowerCase()){case"tcp-act":return"active"
	case"tcp-pass":return"passive"
	case"tcp-so":return"so"
	default:return}}(e.transport),n.relatedAddress=e.raddr,n.relatedPort=e.rport),n}function h(e,t,n){e.candidates&&e.candidates.forEach((function(e){e.component===t&&n.push(m(e))})),e.xCandidatesIpv6&&e.xCandidatesIpv6.forEach((function(e){e.component===t&&n.push(m(e))}))}function v(e){var t=e.match(/(\w+):([a-zA-Z0-9+\/]+={0,2})(\|([0-9\^]+))?(\|([0-9]+):([0-9]+))?/)
	if(t){var n={keyMethod:t[1],keySalt:t[2],mkiValue:0,mkiLength:0}
	return void 0!==t[4]&&(n.lifetime=t[4]),void 0!==t[7]&&(n.mkiValue=+t[6],n.mkiLength=+t[7]),n}}function g(e,t){var n={}
	if(n.iceParams={usernameFragment:t.iceUfrag,password:t.icePwd},n.iceCandidates=[],h(t,1,n.iceCandidates),n.doRtcpMux=!!t.rtcpMux,t.rtcpMux||(n.rtcpIceParams={usernameFragment:t.iceUfrag,password:t.icePwd},n.rtcpIceCandidates=[],h(t,2,n.rtcpIceCandidates),e.icelite&&(n.rtcpIceParams.iceLite=!0)),t.remoteCandidates&&(n.iceCandidatePair={}),e.fingerprint||t.fingerprint){var i=t.fingerprint?t.fingerprint:e.fingerprint,r="auto"
	switch(t.setup?t.setup:e.setup){case"actpass":r="auto"
	break
	case"active":r="client"
	break
	case"passive":r="server"}n.dtlsParams={role:r,fingerprints:[{algorithm:i.type,value:i.hash}]}}return e.icelite&&(n.iceParams.iceLite=!0),n}function y(t){var n=[],o=[]
	return t.rtp.forEach((function(e){var r={name:e.codec,kind:t.type,clockRate:e.rate,preferredPayloadType:e.payload,numChannels:e.encoding?e.encoding:1,rtcpFeedback:[]}
	t.type===i.default.MEDIA_TYPE.audio&&(r.ptime=t.ptime,r.maxptime=t.maxptime),n.push(r)})),t.fmtp&&t.fmtp.forEach((function(e){var t=a.default.build(e.config)
	if(t.contains("apt")){var i=r.default.getCodecIndexByPayload(e.payload,n)
	n[i].parameters={apt:t.get("apt")}}})),t.ext&&t.ext.forEach((function(n){o.push({kind:t.type,uri:e(n.uri,!0),preferredId:n.value})})),{codecs:n,headerExtensions:o,fecMechanisms:[]}}function b(e){e.direction||(e.direction="sendrecv")
	var t=e.direction.toLowerCase(),n=0!==parseInt(e.port,10)
	return{enabled:n,type:e.type,label:function(){if(n&&!e.label){if(i.default.MEDIA_TYPE.audio===e.type)return i.default.MEDIA_LABEL.audio
	if(i.default.MEDIA_TYPE.video===e.type)return i.default.MEDIA_LABEL.video}return e.label}(),send:!!n&&("sendrecv"===t||"sendonly"===t),recv:!!n&&("sendrecv"===t||"recvonly"===t)}}function _(e){if(e){var t=o.default.find(e,(function(e){return"FID"===e.semantics}))
	if(t)return+t.ssrcs.split(" ")[1]}return 0}function E(e){var n=[]
	function i(e,t,i,r){n.push({tag:e,cryptoSuite:t,keyParams:i,sessionParams:r})}var r=b(e)
	if(r.enabled){e.cryptoscale&&e.cryptoscale.forEach((function(e){var n=t(e.flavor,"server")?v(e.config):void 0
	n&&i(e.id,"SCALE_"+e.suite,[n],[])})),e.crypto&&e.crypto.forEach((function(e){var t=v(e.config)
	t&&i(e.id,e.suite,[t],[])}))
	var a={rtpCaps:y(e),sdesParamsList:n,ssrcRange:{min:e.xSsrcRange?e.xSsrcRange.ssrcMin:0,max:e.xSsrcRange?e.xSsrcRange.ssrcMax:0},rtxSsrc:_(e.ssrcGroups),rtcpReducedSize:!!e.rtcpRsize}
	return{descr:b(e),receiver:a,sender:o.default.deepClone(a)}}var s={rtpCaps:null,ssrcRange:null,rtcpReducedSize:!1}
	return{descr:r,receiver:s,sender:s}}this.paramsToSdp=function(e){var t={},o=e.transportParams[0]||e.transportParams[1]||e.transportParams[2],a=function(e){for(var t=e.iceCandidates.slice(0).sort((function(e,t){return t.priority-e.priority})),n=0;n<t.length;n++)if("host"===t[n].type)return t[n].ip
	return"0.0.0.0"}(o),c=d(o)[0]
	t.version=0,t.origin={username:"-",sessionId:0,sessionVersion:e.sessionVersion,netType:"IN",ipVer:s(a)?4:6,address:a},t.bandwidth=[{type:"CT",limit:99980}],t.timing={start:0,stop:0},t.name="session",t.connection={version:s(c.ip)?4:6,ip:c.ip},t.xMediaBw={label:i.default.MEDIA_LABEL.video,sendBw:8100,receiveBw:8e3},t.media=[]
	for(var l=0;l<e.media.length;l++){var u=r.default.getTransportIdxForLabel(e.media[l].descr.label),f=e.transportParams[u]
	t.media.push(p(f,e.media[l],e.isOffer,c))}return n.write(t)},this.sdpToParams=function(e){for(var t=n.parse(e),i={sessionVersion:t.origin.sessionVersion,transportParams:[],media:[]},o=0;o<t.media.length;o++){var a=t.media[o],s=E(a)
	if(i.media.push(s),s.descr.enabled){var c=r.default.getTransportIdxForLabel(s.descr.label)
	i.transportParams[c]||(i.transportParams[c]=g(t,a))}}return i}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcSsrcGenerator",["require","exports"],e)}((function(e,t){function n(){var e=4294967040,t=Math.floor(4294967039*Math.random())+1
	function n(n){var i
	do{i=t,0===(t=(t+n+1)%e)&&(t=1)}while(i+n>e)
	return{min:i,max:i+n}}this.nextAudioStreamSsrc=function(){return n(0)},this.nextVideoStreamSsrc=function(){return n(99)}}t.__esModule=!0,t.default={build:function(){return new n}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcVideoRendererGroup",["require","exports","../device/videoRenderer","../common/utils","../constants","../helper"],e)}((function(e,t){var n=e("../device/videoRenderer"),i=e("../common/utils"),r=e("../constants"),o=e("../helper")
	function a(e){var t=e.logger.createChild("OrtcVideoRendererGroup"),a=[],s=[]
	function c(e,c){n.default.call(this,e,c)
	var l,u,d=this,p=this.dispose,f=!1,m=o.default.defer()
	function h(){l&&(l.remove(d),l=void 0),u=void 0}function v(e,t){return i.default.find(a,(function(n){return n.rendererType===e&&n.msi===t}))}this.updateRecvTrack=function(e,n){t.log("renderer.updateRecvTrack - attachMediaStream","msi:",e,"track:",n),u=e,d.attachMediaStream(n?new MediaStream([n]):null)},this.subscribeVideoAsync=function(e,n){t.info("subscribeVideoAsync","msi:",e)
	var c=n?r.default.RENDERER_TYPE.screensharing:r.default.RENDERER_TYPE.video
	return new Promise((function(t){if(void 0===e&&(e=r.default.MSI.subscribeAny),!f){var n=u!==e
	n&&h(),m.isPending()&&(m.resolve(),m=o.default.defer()),e!==r.default.MSI.unsubscribe&&n?function(e,t){if(!v(e,t)){var n,c=o.default.defer(),u=[],p=!1,f=null,h=function(){p||(u=[],c.isPending()&&c.reject(new Error("disposing renderer")),n&&n.unsubscribe(),i.default.remove(a,(function(n){return n.rendererType===e&&n.msi===t})),p=!0)},g=function(){if(c.isPending()){var o=function(e){return i.default.find(s,(function(t){return t.canSubscribe()&&t.label===function(e){switch(e){case r.default.MODALITY.video:return r.default.MEDIA_LABEL.video
	case r.default.MODALITY.screensharing:return r.default.MEDIA_LABEL.screensharing}}(e)}))}(e)
	o&&(o.subscribe(t),n=o,c.resolve())}if(n){var a=n.getRecvTrack()
	a!==f&&(f=a,u.forEach((function(e){e.updateRecvTrack(t,f)})))}}
	a.push({rendererType:e,msi:t,add:function(e,t){c.promise.then(t.resolve,t.reject),u.push(e),g()},remove:function(e){i.default.remove(u,(function(t){return t===e})),0===u.length&&h()},update:g,dispose:h})}l=v(e,t),l.add(d,m)}(c,e):m.resolve()}t(m.promise)}))},this.dispose=function(){t.debug("disposing remote renderer"),h(),m.isPending()&&m.reject(new Error("disposing renderer")),f=!0,p()}}this.create=function(e,t){return new c(e,t)},this.update=function(e){s=e,a.forEach((function(e){e.update()}))},this.terminate=function(){a.forEach((function(e){e.dispose()}))}}t.__esModule=!0,t.default={build:function(e){return new a(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/activeSpeaker/dshGeneratingStrategy",["require","exports","../utils"],e)}((function(e,t){var n=e("../utils"),i=function(e){this.id=e,this.startTimestamp=0,this.totalTime=0},r=function(){function e(e){this.sources=[],this.timeToPromote=e&&e.timeToPromote||3e3}return e.prototype.setSources=function(e){var t=(e=e||[]).map(this.getOrCreateSource.bind(this)),n=this.excludeSources(this.sources,t)
	t.forEach(this.updateSourceTimestamp.bind(this,!0)),n.forEach(this.updateSourceTimestamp.bind(this,!1)),this.ping||(this.ping=this.setupTimer())},e.prototype.setOnDominantSpeakerChanged=function(e){this.callback=e},e.prototype.dispose=function(){this.clearTimer(),this.sources=null,this.callback=null},e.prototype.excludeSources=function(e,t){return e.filter((function(e){return!t.some((function(t){return e.id===t.id}))}))},e.prototype.setupTimer=function(){var e=this
	return setTimeout((function(){var t=e.arrangeSources().map(e.toSourceId)
	t.length&&!n.default.deepEqual(e.candidates,t)&&(e.candidates=t,e.callback&&e.callback(t)),e.resetTimers(),e.ping=null}),this.timeToPromote)},e.prototype.clearTimer=function(){this.ping&&(clearTimeout(this.ping),this.ping=null)},e.prototype.resetTimers=function(){this.sources.forEach((function(e){e.totalTime=0}))},e.prototype.getOrCreateSource=function(e){if(this.isExist(e))return this.sourceById(e)
	var t=new i(e)
	return this.sources.push(t),t},e.prototype.isExist=function(e){return this.sources.some((function(t){return e===t.id}))},e.prototype.sourceById=function(e){return n.default.find(this.sources,(function(t){return e===t.id}))},e.prototype.updateSourceTimestamp=function(e,t){e?t.startTimestamp||(t.startTimestamp=Date.now()):t.startTimestamp&&(t.totalTime+=Date.now()-t.startTimestamp,t.startTimestamp=0)},e.prototype.arrangeSources=function(){return this.sources.sort((function(e,t){return t.totalTime-e.totalTime}))},e.prototype.toSourceId=function(e){return e.id},e}()
	t.DHSGeneratingStategy=r})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/ortc/ortcSession",["require","exports","./ortcTransport","./ortcMediaChannel","./ortcNegotiation","./ortcSdp","./ortcSsrcGenerator","./ortcVideoRendererGroup","./ortcHelper","../constants","../helper","../common/utils","../extensions/extensionsManager","../common/activeSpeaker/activeSpeakerManager","../common/activeSpeaker/dshGeneratingStrategy"],e)}((function(e,t){var n=e("./ortcTransport"),i=e("./ortcMediaChannel"),r=e("./ortcNegotiation"),o=e("./ortcSdp"),a=e("./ortcSsrcGenerator"),s=e("./ortcVideoRendererGroup"),c=e("./ortcHelper"),l=e("../constants"),u=e("../helper"),d=e("../common/utils"),p=e("../extensions/extensionsManager"),f=e("../common/activeSpeaker/activeSpeakerManager"),m=e("../common/activeSpeaker/dshGeneratingStrategy")
	function h(){var e=this
	function t(t){throw new Error("Invalid state change:"+e.state+" "+t+" changing: "+e.changing)}this.STABLE="stable",this.NEGOTIATION_REQUESTED="negotiation_requested",this.HAVE_LOCAL_OFFER="have_local_offer",this.HAVE_REMOTE_PRANSWER="have_remote_pranswer",this.HAVE_REMOTE_ANSWER="have_remote_answer",this.HAVE_REMOTE_OFFER="have_remote_offer",this.HAVE_LOCAL_PRANSWER="have_local_pranswer",this.HAVE_LOCAL_ANSWER="have_local_answer",this.TERMINATED="terminated",this.state=e.STABLE,this.changing=!1,this.change=function(n,i){switch(e.busy&&t(n),i&&(e.changing=i),n){case e.STABLE:e.state!==e.HAVE_REMOTE_ANSWER&&e.state!==e.HAVE_LOCAL_ANSWER&&t(n)
	break
	case e.NEGOTIATION_REQUESTED:e.state!==e.STABLE&&t(n)
	break
	case e.HAVE_LOCAL_OFFER:e.state!==e.STABLE&&e.state!==e.NEGOTIATION_REQUESTED&&t(n)
	break
	case e.HAVE_REMOTE_PRANSWER:case e.HAVE_REMOTE_ANSWER:e.state!==e.HAVE_LOCAL_OFFER&&e.state!==e.HAVE_REMOTE_PRANSWER&&t(n)
	break
	case e.HAVE_REMOTE_OFFER:e.state!==e.STABLE&&e.state!==e.NEGOTIATION_REQUESTED&&t(n)
	break
	case e.HAVE_LOCAL_PRANSWER:case e.HAVE_LOCAL_ANSWER:e.state!==e.HAVE_REMOTE_OFFER&&e.state!==e.HAVE_LOCAL_PRANSWER&&t(n)
	break
	case e.TERMINATED:break
	default:t(n)}e.state=n},this.complete=function(){e.changing=!1}}function v(e,t,v){this.configureModalitiesAsync=function(e){var t=V.then((function(){return new Promise((function(t){if(!e||!e.audio&&!e.video&&!e.screensharing)throw new Error("Invalid parameters!"+_stringify(e))
	var n=!g||!u.default.areNegotiatedDirectionsFulfilled(e,N)
	g=e,n&&$(),t(g)}))}))
	return V=t.catch((function(e){S.warn("Error during configuring modalities: ",e)})),t},this.processOfferAsync=function(e){return new Promise((function(t){R=!1
	var n,i=e.blob
	S.debug("PROCESS OFFER","sdp:",i),O.change(O.HAVE_REMOTE_OFFER),n=M.sdpToParams(i),I.processOffer(n),T=n.transportParams,t(y=u.default.invertModalities(c.default.getModalitiesFromMedia(n.media)))}))},this.createAnswerAsync=function(e){return new Promise((function(t){if(e)O.change(O.HAVE_LOCAL_PRANSWER,!0),b={audio:"sendrecv",video:"sendrecv",screensharing:"sendrecv"}
	else{if(O.change(O.HAVE_LOCAL_ANSWER,!0),!g)throw new Error("Modalities not configured for answer")
	b=u.default.excludePassiveModalities(g,G,y)}var n=I.createMediaDescriptorsForAnswer(b)
	function i(e,t){return t.label===e&&t.enabled}var r=n.some(i.bind(null,l.default.MEDIA_LABEL.audio)),o=n.some(i.bind(null,l.default.MEDIA_LABEL.video)),a=n.some(i.bind(null,l.default.MEDIA_LABEL.screensharing))
	t(D.assureInitAsync("controlled",[r,o,a]).then((function(){return D.waitIceCompletionIfNeededAsync(T).then((function(){return D.getLocalParamsAsync().then((function(t){W(n)
	var i=I.createAnswer(n,t,z(),e)
	O.complete()
	var r=M.paramsToSdp(i)
	return S.debug(e?"CREATE PRANSWER":"CREATE ANSWER","sdp:",r),{blob:r,modalities:b}}))}))})))}))},this.createOfferAsync=function(){return new Promise((function(e){if(R=!0,O.change(O.HAVE_LOCAL_OFFER,!0),b=u.default.excludePassiveModalities(g,G,y),y=b,u.default.hasSendDirectionality(b.screensharing)&&!_.allowSendScreensharing)throw new Error("unsupported shreensharing send directionality in _negotiatingModalities"+_stringify(b))
	var t=I.createMediaDescriptorsForOffer(b)
	e(D.assureInitAsync("controlling",[!!b.audio,!!b.video,!!b.screensharing]).then((function(){return D.getLocalParamsAsync().then((function(e){W(t)
	var n=I.createOffer(t,e,z())
	O.complete()
	var i=M.paramsToSdp(n)
	return S.debug("CREATE OFFER","sdp:",i),{blob:i,modalities:b}}))})))}))},this.processAnswerAsync=function(e,t){return new Promise((function(n){var i,r=e.blob;(S.debug(t?"PROCESS PRANSWER":"PROCESS ANSWER","sdp:",r),t)?(O.change(O.HAVE_REMOTE_PRANSWER),S.log("ignoring provisional answer"),n()):(O.change(O.HAVE_REMOTE_ANSWER),i=M.sdpToParams(r),I.processAnswer(i),n(u.default.invertModalities(c.default.getModalitiesFromMedia(i.media))))}))},this.completeNegotiationAsync=function(){return new Promise((function(e){O.change(O.STABLE,!0)
	var t,n,i,r=I.completeNegotiation(),o=r.media,a=c.default.findDescrFromMedia(o,l.default.MEDIA_LABEL.audio),s=c.default.findDescrFromMedia(o,l.default.MEDIA_LABEL.video),d=c.default.findDescrFromMedia(o,l.default.MEDIA_LABEL.screensharing),p=(t=a.send,n=s.send,i=d.send,t||n||i?x._getMediaStream({audio:t,video:n||i}):null),f=function(e){var t=arguments[1]
	if(p&&p.dispose(),e)return t
	throw t}
	e(Promise.all([D.configureTransportAsync(r.transportParams,[a.enabled,s.enabled,d.enabled]),p?p.start():Promise.resolve()]).then((function(){(function(){if(Z())throw new Error("session is already terminated")})()
	for(var e=0;e<o.length;e++)if(o[e].descr.label===l.default.MEDIA_LABEL.audio){var t=k[e].getRecvTrack()
	k[e].configureChannel(o[e],D.audioTransport,p),k[e].getRecvTrack()&&k[e].getRecvTrack()!==t?(Q(k[e].getRecvTrack()),k[e].onContributingSourcesChanged=q.onContributingSourcesChanged.bind(q)):!k[e].getRecvTrack()&&t&&(X(),k[e].onContributingSourcesChanged=null)}else o[e].descr.label===l.default.MEDIA_LABEL.video?k[e].configureChannel(o[e],D.videoTransport,p):o[e].descr.label===l.default.MEDIA_LABEL.screensharing&&k[e].configureChannel(o[e],D.screensharingTransport,p)
	F.update(k.filter((function(e){return l.default.MEDIA_LABEL.video===e.label||l.default.MEDIA_LABEL.screensharing===e.label}))),O.complete(),N=c.default.getModalitiesFromMedia(o)
	var n=u.default.excludePassiveModalities(g,G,y),i=P||!u.default.areNegotiatedDirectionsAcceptable(n,b,N)
	return i&&$(),S.log("_completeNegotiationAsync: configured:",_stringify(g),"_negotiatingModalities:",_stringify(b),"activeModalities:",_stringify(N)),{isComplete:!i,activeModalities:N,offeredModalities:y,attemptedModalities:b,configuredModalities:g,initiator:R}})).then(f.bind(null,!0),f.bind(null,!1)))}))},this.rejectNegotiationAsync=function(e,t){return new Promise((function(n){var i=e===l.default.RENEGOTIATION_ERROR.local
	O.state=O.STABLE,S.error("negotiation failed","error:",e),t&&(S.log("retrying failed negotiation"),$()),n({isComplete:i,activeModalities:N,offeredModalities:y,attemptedModalities:b,configuredModalities:g,initiator:R})}))},this.createRemoteRenderer=function(e,t){return F.create(e,t)},this.sendDtmf=function(e){var t=j(k,l.default.MEDIA_LABEL.audio)
	if(t)return t.sendDtmf(e)
	return Promise.reject(new Error("no audio channel"))},this.canSendDtmf=function(){var e=j(k,l.default.MEDIA_LABEL.audio)
	if(e)return e.canSendDtmf()
	return!1},this.getStatsAsync=J,this.terminate=function(){return S.log("terminate"),H.dispose(),J().then((function(){O.change(O.TERMINATED),D.stop(),X(),F.terminate(),k.forEach((function(e){e.terminate()})),C._onTerminated&&C._onTerminated(C)}))},this._deviceSelectionChanged=function(){S.log("_deviceSelectionChanged")
	var e=u.default.hasSendDirectionality(N.audio),t=u.default.hasSendDirectionality(N.video)
	if(!Z()&&(e||t)){var n=x._getMediaStream({audio:e,video:t})
	n.start().then((function(){e&&j(k,l.default.MEDIA_LABEL.audio).updateLocalMediaStream(n),t&&j(k,l.default.MEDIA_LABEL.video).updateLocalMediaStream(n),n.dispose()})).catch((function(e){K({type:l.default.MEDIA_ERROR.internalError,detail:e}),n.dispose()}))}},this._onTerminated=null,this.onNegotiationRequired=null,this.onContributingSourcesChanged=null,this.onSessionErrorOccurred=null,this.getExtensionsManager=function(){return H}
	var g,y,b,_=e.maContext.settings,E=e.config.iceTransportPolicy?e.config.iceTransportPolicy:l.default.ICE_TRANSPORT_POLICY.all,w=e.config.isConference&&_.numVideoChannelsGvc?_.numVideoChannelsGvc:1,S=e.getLogger().createChild("ortc"),x=e.getDeviceManager(),C=this,T=null,I=new r.default(S,_,w),A=null,M=new o.default,O=new h,k=[],N={},P=!1,R=!1,L={triggerIceReinvite:function(){_.disableIceReinvite?S.log("ICE-reinvite disabled - triggerIceReinvite skipped"):(S.log("triggerIceReinvite"),$(!0))},raiseError:K},D=new n.default(S,_,L,e.maContext.getRelayManager(),e.config.isRemoteClientLync,E,!0),U=Promise.resolve({}),F=s.default.build({logger:S}),B=a.default.build(),V=Promise.resolve(),G=e.config.passiveModalities,H=new p.default,q=new f.ActiveSpeakerManager(v.onContributingSourcesChanged,v.onDominantSpeakerChanged)
	function W(e){for(var t=0,n=0;n<e.length;n++){if(e[n].label!==l.default.MEDIA_LABEL.audio||k[n]){if(e[n].label===l.default.MEDIA_LABEL.video)k[n]||(k[n]=new i.default(S.createChild("VStrm"+t+":"),_,e[n].type,e[n].label,K,B.nextVideoStreamSsrc(),!1)),t++
	else if(e[n].label===l.default.MEDIA_LABEL.screensharing&&!k[n]){var r=!e[n].send
	k[n]=new i.default(S.createChild("SSStrm:"),_,e[n].type,e[n].label,K,B.nextVideoStreamSsrc(),r)}}else k[n]=new i.default(S.createChild("AStrm:"),_,e[n].type,e[n].label,K,B.nextAudioStreamSsrc(),!1)
	if(k[n]&&k[n].type!==e[n].type)throw new Error("Error in media descriptors ch.type: "+k[n].type+" descr.type: "+e[n].type)
	if(k[n]&&k[n].label!==e[n].label)throw new Error("Error in media descriptors ch.label: "+k[n].label+" descr.label: "+e[n].label)}}function j(e,t){for(var n=0;n<e.length;n++)if(e[n].label===t)return e[n]
	return null}function z(){for(var e=[],t=0;t<k.length;t++)k[t]&&(e[t]=k[t].getLocalParameters())
	return e}function K(e){S.error("Media error occurred","type:",e.type,"detail:",e.detail),C.onSessionErrorOccurred&&C.onSessionErrorOccurred(e)}function Y(e){e?S.error("_audio.onerror",function(e){if(e){var t={}
	return d.default.forOwn(e,(function(e,n){try{t[n]=t[n]="function"==typeof e?e():e}catch(i){t[n]="error: "+i}})),_stringify(t)}}(e)):S.error("_audio.onerror","error:",A?A.error:"<no audio element>")}function Q(e){A?(A.removeEventListener("error",Y),A.addEventListener("error",Y),window.detachMediaStream(A)):(A=document.createElement("audio"),document.body.appendChild(A),A.autoplay=!0,A.addEventListener("error",Y))
	var t=new MediaStream([e])
	window.attachMediaStream(A,t)}function X(){A&&(A.removeEventListener("error",Y),document.body.removeChild(A),window.detachMediaStream(A),A=null)}function $(e){O.state!==O.STABLE||O.changing?e&&(P=!0):(O.change(O.NEGOTIATION_REQUESTED),S.log("triggerNegotiation","mods:",_stringify(g),"force:",e),P=!1,C.onNegotiationRequired&&C.onNegotiationRequired())}function J(){return Z()?U:U=new Promise((function(e){var n={localStreams:[{tracks:[]}],remoteStreams:[{tracks:[]}]},i=j(k,l.default.MEDIA_LABEL.audio),r=j(k,l.default.MEDIA_LABEL.video),o=j(k,l.default.MEDIA_LABEL.screensharing)
	i&&i.getSendTrack()&&n.localStreams[0].tracks.push({stream:null,track:i.getSendTrack()}),r&&r.getSendTrack()&&n.localStreams[0].tracks.push({stream:null,track:r.getSendTrack()}),o&&o.getSendTrack()&&n.localStreams[0].tracks.push({stream:null,track:o.getSendTrack()}),i&&i.getRecvTrack()&&n.remoteStreams[0].tracks.push({stream:null,track:i.getRecvTrack()}),r&&r.getRecvTrack()&&n.remoteStreams[0].tracks.push({stream:null,track:r.getRecvTrack()}),o&&o.getRecvTrack()&&n.remoteStreams[0].tracks.push({stream:null,track:o.getRecvTrack()}),Promise.all([i?i.getReportsAsync():{},r?r.getReportsAsync():{},o?o.getReportsAsync():{}]).then((function(i){n.ortc={CorrelationId:t,mainAudio:i[0],mainVideo:i[1],appsharingVideo:i[2]},e(n)})).catch((function(t){S.error("getting statistics should never fail:",t),e(n)}))}))}function Z(){return O.state===O.TERMINATED}q.setStrategy(new m.DHSGeneratingStategy(e.maContext.settings.activeSpeaker)),S.log("create session","config:",e.config)}t.__esModule=!0,t.default={build:function(e,t,n){return new v(e,t,n)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/statistics/sessionStatistics",["require","exports"],e)}((function(e,t){function n(){var e,t,n,i=(new Date).getTime(),r=0,o=!1,a=!1,s=0,c=0,l="0",u=0,d={type:"none",detail:"none"},p=0,f=0
	function m(){e=e||t,++r}function h(e){return 1e4*e}this.negotiation={offering:{started:function(){t="Offering",m()}},answering:{started:function(){t="Answering",m()}},current:{completed:function(){1===r&&(o=!0)},rejected:function(){++u}}},this.terminated=function(){c=(new Date).getTime(),s=(new Date).getTime()-i},this.setMultiParty=function(){a=!0},this.setMediaLegId=function(e){n=e},this.setId=function(e){l=e},this.setError=function(e){d.type=e.type||"internalError",d.detail=e.detail||e.toString()},this.dtmfResult=function(e){e?++p:++f},this.getReport=function(){return{CorrelationId:l,CallNumber:0,RetargetCount:0,CreationTime:h(i),InitTime:h(i),TerminationTime:h(c),CallDuration:h(s),InitialNegotiationType:e||"none",InitialNegotiationCompleted:o,NegotiationCount:r,RejectedNegotiationCount:u,MediaLegId:n,MultiParty:a,ErrorType:d.type,ErrorDetail:d.detail,DtmfSuccess:p,DtmfFailure:f}}}t.__esModule=!0,t.default={build:function(){return new n}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/statistics/mediaLegId",["require","exports","../common/utils"],e)}((function(e,t){var n=e("../common/utils")
	function i(){var e
	this.process=function(t){return e||(e=t||n.default.uniqueId().toUpperCase()),e}}t.__esModule=!0,t.default={build:function(){return new i}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/session",["require","exports","./webrtc/webRtcSession","./ortc/ortcSession","./statistics/sessionStatistics","./statistics/mediaLegId","./constants"],e)}((function(e,t){var n=e("./webrtc/webRtcSession"),i=e("./ortc/ortcSession"),r=e("./statistics/sessionStatistics"),o=e("./statistics/mediaLegId"),a=e("./constants")
	function s(e,t,n,i){var s=this,c=r.default.build(),l=o.default.build(),u=t.maContext.settings,d=0
	c.setId(n),t.config.isConference&&c.setMultiParty(),this.createOfferAsync=function(){return c.negotiation.offering.started(),e.createOfferAsync.apply(e,arguments).then((function(e){return e.mediaLegId=l.process(e.mediaLegId),e})).catch((function(e){throw c.setError(e),e}))},this.processOfferAsync=function(t){return c.negotiation.answering.started(),l.process(t.mediaLegId),e.processOfferAsync.apply(e,arguments).catch((function(e){throw c.setError(e),e}))},this.processAnswerAsync=function(){return e.processAnswerAsync.apply(e,arguments).catch((function(e){throw c.setError(e),e}))},this.completeNegotiationAsync=function(){return d=0,e.completeNegotiationAsync.apply(e,arguments).then((function(e){return c.negotiation.current.completed(),e})).catch((function(e){throw c.setError(e),e}))},this.rejectNegotiationAsync=function(t){var n=++d<=u.renegotiationAttempts&&function(e){return a.default.RENEGOTIATION_ERROR.signaling===e||a.default.RENEGOTIATION_ERROR.media===e}(t)
	return c.negotiation.current.rejected(),e.rejectNegotiationAsync(t,n).catch((function(e){throw c.setError(e),e}))},this.terminate=function(){return c.terminated(),e.terminate.apply(e,arguments)},this.getStatsAsync=function(){return e.getStatsAsync.apply(e,arguments).then((function(e){return c.setMediaLegId(l.process()),e.metrics=c.getReport(),e}))},this.createAnswerAsync=function(){return e.createAnswerAsync.apply(e,arguments).then((function(e){return e.mediaLegId=l.process(e.mediaLegId),e})).catch((function(e){throw c.setError(e),e}))},this.configureModalitiesAsync=e.configureModalitiesAsync,this.createRemoteRenderer=e.createRemoteRenderer,this._deviceSelectionChanged=e._deviceSelectionChanged,this._onTerminated=null,this.sendDtmf=function(t){return e.sendDtmf(t).then((function(e){return c.dtmfResult(!0),e})).catch((function(e){throw c.dtmfResult(!1),e}))},this.canSendDtmf=function(){return e.canSendDtmf()},this.getExtensionsManager=function(){return e.getExtensionsManager()},e.onNegotiationRequired=i.onNegotiationRequired,e.onSessionErrorOccurred=function(t){c.setError(t),i.onSessionErrorOccurred.apply(e,arguments)},e._onTerminated=function(){s._onTerminated&&s._onTerminated.apply(e,arguments)}}t.__esModule=!0,t.default={build:function(e,t,r){return new s(("undefined"==typeof RTCIceGatherer?n.default:i.default).build.apply(this,arguments),e,t,r)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/device/deviceEnumerator",["require","exports","../constants","../common/utils","../common/userAgentAdapter"],e)}((function(e,t){var n=e("../constants"),i=e("../common/utils"),r=e("../common/userAgentAdapter")
	function o(e){var t,o,a,s=this,c=r.default.window,l=e.logger.createChild("DeviceEnumerator"),u=e.settings,d={},p=Promise.resolve()
	function f(e){var n=!1
	return t&&(i.default.forOwn(t,(function(t,i){e.hasOwnProperty(i)?t.label!==e[i].label&&(n=!0,l.log("media device label was updated")):(n=!0,l.log("media device removed","kind:",t.kind,"id:",t.id,"label:",t.label))})),i.default.forOwn(e,(function(e,i){t.hasOwnProperty(i)||(n=!0,l.log("media device added","kind:",e.kind,"id:",e.id,"label:",e.label))}))),t=e,n&&s.onDevicesChanged&&s.onDevicesChanged(t),t}d[n.default.MEDIA_DEVICE.microphone]={id:"default_audio_device",label:"Default audio device",kind:n.default.MEDIA_DEVICE.microphone},d[n.default.MEDIA_DEVICE.camera]={id:"default_video_device",label:"Default video device",kind:n.default.MEDIA_DEVICE.camera},this.onDevicesChanged=void 0,this.enumerateDevices=function(){return c.navigator.mediaDevices&&c.navigator.mediaDevices.enumerateDevices?(p=p.then((function(){return c.navigator.mediaDevices.enumerateDevices()})).then((function(e){return function(e){var t=function(e){var t={}
	return e.forEach((function(e){switch(e.kind){case"audioinput":e.deviceId!==n.default.MEDIA_DEVICE.defaultId&&(t[e.deviceId]={id:e.deviceId,label:e.label,kind:n.default.MEDIA_DEVICE.microphone}),t[d[n.default.MEDIA_DEVICE.microphone].id]=d[n.default.MEDIA_DEVICE.microphone]
	break
	case"videoinput":t[d[n.default.MEDIA_DEVICE.camera].id]=d[n.default.MEDIA_DEVICE.camera],t[e.deviceId]={id:e.deviceId,label:e.label,kind:n.default.MEDIA_DEVICE.camera}}})),t}(e)
	return f(t)}(e)})),p):Promise.reject(new Error("device enumeration unsupported"))},this.getDefaultDevices=function(){return d},this.getDeviceName=function(e){if(e===d[n.default.MEDIA_DEVICE.microphone].id)return Promise.resolve(d[n.default.MEDIA_DEVICE.microphone].label)
	if(e===d[n.default.MEDIA_DEVICE.camera].id)return Promise.resolve(d[n.default.MEDIA_DEVICE.camera].label)
	var i=t[e].kind===n.default.MEDIA_DEVICE.microphone?{audio:{deviceId:e},video:!0}:{audio:!0,video:{deviceId:e}}
	return c.navigator.mediaDevices.getUserMedia(i).then((function(){return s.enumerateDevices()})).then((function(t){return t[e].label}))},this.startDevicePolling=function(){var e=void 0!==u.devicePollingInterval?u.devicePollingInterval:3e3
	0===e||a||o||(l.log("starting device polling"),o=c.setTimeout((function t(){s.enumerateDevices().then((function(){o=c.setTimeout(t,e)}))}),e))},this.stopDevicePolling=function(){o&&(l.log("stopping device polling"),c.clearTimeout(o),o=void 0)},c.navigator.mediaDevices&&(c.navigator.mediaDevices.ondevicechange=function(){a=!0,s.stopDevicePolling(),s.enumerateDevices()})}t.__esModule=!0,t.default={build:function(e){return new o(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/device/mediaStream",["require","exports","../constants","../helper","../webrtc/resolutionTable","../common/utils","../common/userAgentAdapter"],e)}((function(e,t){var n=e("../constants"),i=e("../helper"),r=e("../webrtc/resolutionTable"),o=e("../common/utils"),a=e("../common/userAgentAdapter")
	function s(e){var t=e
	this.onApplyConstraints=null,this.onMute=null,this.dispose=function(){return t.dispose(this)},this.clone=function(){return t.getClient()},this.getObject=function(){return t.getObject()},this.applyConstraints=function(e){return t.applyConstraints(e)},this.setMute=function(e){t.setMute(e)},this.setHold=function(e){t.setHold(e)},this.start=function(){return t.start()},this.hasAudio=function(){return t.hasAudio()},this.hasVideo=function(){return t.hasVideo()},this.getConstraints=function(){return t.getConstraints()}}function c(e,t){var c,l,u,d=this,p=a.default.window,f=e.logger.createChild("MediaStream"),m=[],h=!1,v=!1,g=r.default.build(),y={}
	function b(){c&&c.getTracks().forEach((function(e){void 0!==e.enabled&&(e.enabled=!("audio"===e.kind&&h||v),f.log("control media stream track","kind:",e.kind,"enabled:",e.enabled,"muted:",e.muted))}))}function _(e){return new Promise((function(t,n){f.log("querying user media for stream:",_stringify(e)),p.navigator.getUserMedia(e,t,n)})).catch((function(e){throw e="SourceUnavailableError"===e.name?{type:n.default.MEDIA_ERROR.sourceUnavailableError,detail:"media device is already used by another process: "+e.toString()}:"ConstraintNotSatisfiedError"===e.name?{type:n.default.MEDIA_ERROR.constraintNotSatisfiedError,detail:"could not obtain constrained media stream: "+e.toString()}:{type:n.default.MEDIA_ERROR.permissionDeniedError,detail:"permission to use media device was denied: "+e.toString()}})).then((function(e){c=e,b(),f.log("media stream updated")}))}function E(e){u.gumSerializer=u.gumSerializer||Promise.resolve()
	var t=u.gumSerializer.then(e)
	return u.gumSerializer=t.catch((function(e){f.warn("previous gum operation failed:",e)})),t}function w(){if(c)try{c.getTracks().forEach((function(e){e.stop()})),f.log("media stream stopped")}catch(e){f.warn("failed to stop media stream:",e)}}this.getObject=function(){return c},this.applyConstraints=function(e){if(c&&e.maxFS&&e.maxFPS){var r=g.getResolution(e.maxFS)
	if(y.width!==r.width||y.height!==r.height||y.fps!==e.maxFPS)return y.width=r.width,y.height=r.height,y.fps=e.maxFPS,new Promise((function(e){f.log("applying stream constraints:",_stringify(y))
	var r=i.default.defer()
	m.forEach((function(e){e.onApplyConstraints&&e.onApplyConstraints(r.promise)})),e(E((function(){w()
	var e=function(){var e=g.getResolutions().filter((function(e){return e.width<=y.width&&e.height<=y.height})).reverse().map((function(e){return function(){return(n={maxWidth:y.width,minWidth:e.width,maxHeight:y.height,minHeight:e.height,maxFrameRate:y.fps})&&f.log("Setting mandatory constraints",_stringify(n)),y.width&&y.height&&y.fps?("object"!=typeof t.video&&(t.video={}),t.video.mandatory=n):delete t.video.mandatory,t
	var n}}))
	return e.push((function(){return delete t.video.mandatory,t})),e}()
	return l=_(e[0]()),e.slice(1).forEach((function(e){l=l.catch((function(t){if(n.default.MEDIA_ERROR.constraintNotSatisfiedError===t.type)return f.warn("could not obtain constrained media stream, will attempt weaker policy"),_(e())
	throw t}))})),l})).then(r.resolve).catch((function(e){throw f.error("failed to apply constraints:",_stringify(y),"error:",e),r.reject(e),e})))})).then((function(){return!0}))}return Promise.resolve(!1)},this.getClient=function(){var e=new s(this)
	return m.push(e),e},this.setMute=function(e){h=e,m.forEach((function(t){t.onMute&&t.onMute(e)})),b()},this.setHold=function(e){v=e,b()},this.dispose=function(e){return m.indexOf(e)>=0&&(o.default.remove(m,(function(t){return t===e})),0===m.length)?(d.onDisposed&&d.onDisposed(),function(){if(!l)return Promise.resolve()
	return f.log("queueing media stream stop"),E(w)}()):Promise.resolve()},this.start=function(){return l||(l=function(e){return f.log("queueing media stream update to:",_stringify(e)),E((function(){return _(e)}))}(t)),l},this.hasAudio=function(){return!!c&&0!==c.getAudioTracks().length},this.hasVideo=function(){return!!c&&0!==c.getVideoTracks().length},this.getConstraints=function(){return t},u=e.global.mediaStream=e.global.mediaStream||{}}t.__esModule=!0,t.default={build:function(e,t){return new c(e,t)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/device/deviceManager",["require","exports","../constants","./deviceEnumerator","./mediaStream","../common/utils","./videoRenderer"],e)}((function(e,t){var n=e("../constants"),i=e("./deviceEnumerator"),r=e("./mediaStream"),o=e("../common/utils"),a=e("./videoRenderer")
	t.__esModule=!0,t.default=function(e,t){this.enumerateDevicesAsync=y,this.getDeviceNameAsync=function(e){if(window.RTCIceGatherer)return u.getDeviceName(e)
	return Promise.resolve(l[e].label)},this.selectDevices=function(e){var t={}
	for(var n in e)if(e.hasOwnProperty(n)){var i=e[n]
	l.hasOwnProperty(i)?t[n]=i:c.warn("device selection is invalid","kind:",n,"id:",i)}if(o=d,a=t,_stringify(o)!==_stringify(a)){var r="camera"in d^"camera"in t||"microphone"in d^"microphone"in t
	d=t,s._deviceSelectionChanged&&(r||s._deviceSelectionChanged()),function(){if(m.length){var e=_({audio:!0,video:!0})
	return e.start().then((function(){m.forEach((function(t){t._attachMediaStreamRef(e)}))}))}Promise.resolve()}()}var o,a},this.getSelectedDevices=function(){return d},this.muteInputAsync=function(){return E(!1)},this.unmuteInputAsync=function(){return E(!0)},this.createPreviewRenderer=function(e,t){return new g(e,t)},this._getMediaStream=_
	var s=this,c=e.logger,l={},u=i.default.build({logger:c,settings:e.settings})
	u.onDevicesChanged=function(e){l=e,p.forEach((function(t){t.outdateIfAnyDeviceRemoved(e)})),t.onDevicesChanged&&t.onDevicesChanged(o.default.values(e))}
	var d={microphone:u.getDefaultDevices()[n.default.MEDIA_DEVICE.microphone].id,camera:u.getDefaultDevices()[n.default.MEDIA_DEVICE.camera].id},p=[],f=0,m=[],h=!0
	function v(e,t){var n=o.default.values(l)
	if(e.getSettings){var i=e.getSettings().deviceId
	return o.default.find(n,(function(e){return e.kind===t&&e.id===i}))}return o.default.find(n,(function(n){return n.kind===t&&n.label===e.label}))}this.Renderer=a.default,this.getDefaultDevices=function(){var e=_({audio:!0,video:!0})
	return e.start().catch((function(e){c.error("Could not start stream")})).then((function(){return y()})).then((function(){var t=u.getDefaultDevices(),i=e.getObject()
	if(i){var r=i.getAudioTracks()[0],a=i.getVideoTracks()[0]
	if(r){var s=v(r,n.default.MEDIA_DEVICE.microphone)
	s&&(t[n.default.MEDIA_DEVICE.microphone]=s)}if(a){var c=v(a,n.default.MEDIA_DEVICE.camera)
	c&&(t[n.default.MEDIA_DEVICE.camera]=c)}}return e.dispose(),o.default.values(t)}),(function(t){throw e.dispose(),t}))}
	var g=function(e,t){a.default.call(this,e,t)
	var n=this,i=this.dispose,r=null,s=!1
	this._attachMediaStreamRef=function(e){try{r&&(this.reattachEventListeners(),r.dispose(),r=null),e.onApplyConstraints=function(t){n.attachMediaStream(null),t.then((function(){n.attachMediaStream(e.getObject())}))},this.attachMediaStream(e.getObject()),r=e}catch(t){throw e.dispose(),t}},this.dispose=function(){s=!0,o.default.remove(m,(function(e){return e===n})),i(),r&&(r.dispose(),r=null)},this.startVideoAsync=function(){var e=_({audio:!0,video:!0})
	return e.start().then((function(){if(s)throw e.dispose(),new Error("disposed")
	n._attachMediaStreamRef(e),m.push(n)}))}}
	function y(){return u.enumerateDevices().then((function(e){return l=e,o.default.values(e)}))}function b(e,n){t.onDevicesPermissionChanged&&t.onDevicesPermissionChanged({hasMicrophonePermission:e,hasCameraPermission:n})}function _(t){c.log("retrieving media stream: ",_stringify(t))
	var i,a,s,l,m,v,g,y,_,E=function(e){return o.default.find(p,(function(t){return t.isSuitable(e,d)}))}(t)
	if(!E){var w={}
	if(t.audio&&(d.microphone?d.microphone===u.getDefaultDevices()[n.default.MEDIA_DEVICE.microphone].id?w.audio=!0:w.audio={deviceId:{exact:d.microphone}}:c.warn("ignoring audio modality due to missing microphone selection")),t.video&&(d.camera?d.camera===u.getDefaultDevices()[n.default.MEDIA_DEVICE.camera].id?w.video=!0:w.video={deviceId:{exact:d.camera}}:c.warn("ignoring video modality due to missing camera selection")),!w.audio&&!w.video)throw new Error("requesting nothing")
	return(i=w,a=d.microphone,s=d.camera,l=!!i.audio,m=!!i.video,v=!1,g={getStream:function(){return _},isSuitable:function(e,t){return!(v||e.audio!==l||e.video!==m||e.audio&&a!==t.microphone||e.video&&s!==t.camera)},outdateIfAnyDeviceRemoved:function(e){v||(v=!e[a]||!e[s])}},y=f++,_=r.default.build({global:e,logger:c},i),_.onDisposed=function(){c.log("release media stream","generation:",y,"cached:",p.length,"audio:",l,"video:",m),o.default.remove(p,(function(e){return e===g})),p.length||u.stopDevicePolling()},_.start().then((function(){_.setMute(!h),l=_.hasAudio(),m=_.hasVideo(),c.log("created media stream","generation:",y,"cached:",p.length,"audio:",l,"video:",m),b(!0,!0)})).catch((function(e){e&&e.type===n.default.MEDIA_ERROR.permissionDeniedError&&b(_.hasAudio(),_.hasVideo()),o.default.remove(p,(function(e){return e===g})),p.length||u.stopDevicePolling()})),u.startDevicePolling(),p.push(g),g).getStream().getClient()}return E.getStream().getClient()}function E(e){return h=e,p.forEach((function(t){t.getStream().setMute(!e)})),Promise.resolve()}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/common/capabilities",["require","exports","./userAgentAdapter"],e)}((function(e,t){var n=e("./userAgentAdapter"),i=function(){function e(e){this.window=n.default.window,this.overrides=this.getCapabilityOverrides(e.settings),this.audio=this.getCapability("audio"),this.video=this.getCapability("video"),this.screensharing=this.getCapability("screensharing")}return e.prototype.hasWebRtc=function(){return void 0!==this.window.RTCPeerConnection},e.prototype.hasOrtc=function(){return void 0!==this.window.RTCIceGatherer},e.prototype.hasMediaCapture=function(){return!!this.window.navigator.getUserMedia},e.prototype.getCapabilityOverrides=function(e){var t
	return e.capabilities&&(this.hasOrtc()?t=e.capabilities.ortc:this.hasWebRtc()&&(t=e.capabilities.webrtc)),t||{}},e.prototype.getCapability=function(e){return void 0!==this.overrides[e]?!!this.overrides[e]:this.hasMediaCapture()&&(this.hasOrtc()||this.hasWebRtc())},e}()
	t.__esModule=!0,t.default={build:function(e){return new i(e)}}})),function(e){"function"==typeof r&&r.amd&&r("../components/media-agent/lib/mediaAgent",["require","exports","./session","./device/deviceManager","./common/utils","./common/capabilities","./constants","./helper"],e)}((function(e,t){var n=e("./session"),i=e("./device/deviceManager"),r=e("./common/utils"),o=e("./common/capabilities"),a=e("./constants"),s=e("./helper"),c=function(e,t){var a=e.getLogger().createChild("MA",void 0,e.settings.debug),s=a.createChild("DeviceManager"),c=new i.default({logger:s,settings:e.settings},t),l=[],u=o.default.build({settings:e.settings})
	function d(){return c}c._deviceSelectionChanged=function(){l.forEach((function(e){e._deviceSelectionChanged()}))},this.createSession=function(t,i,o){var s=a.createChild("Session",i),c={getDeviceManager:d,getLogger:function(){return s},maContext:e,config:o||{}},u=n.default.build(c,i,t)
	return u._onTerminated=function(e){r.default.remove(l,(function(t){return t===e}))},l.push(u),u},this.getDeviceManager=d,this.getCapabilities=function(){return u},this.getScreenSharingManager=function(){return{onScreensChanged:function(){return{dispose:function(){}}},enumerateScreensAsync:function(){return Promise.resolve([])},enumerateApplicationsAsync:function(){return Promise.resolve([])}}}}
	t.__esModule=!0,t.default={build:function(e,t){return new c(e,t)},isPlatformSupported:function(){return navigator.getUserMedia&&("undefined"!=typeof RTCPeerConnection||"undefined"!=typeof RTCIceGatherer)&&!/^((?!chrome).)*safari/i.test(navigator.userAgent)},constants:a.default,helper:s.default}})),(t=n)(["../components/media-agent/lib/mediaAgent"]),e.MediaAgent=t("../components/media-agent/lib/mediaAgent").default,window.setTimeout=a})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.inherit,i=e.Utils.isFunction,r=e.Utils.URI,o=e.Utils.Http,a=e.Utils.Event,s=e.Utils.WeakMap,c=e.Stack.XHR,l=function(n,i){var a,s,l=n.get(n.app.relatedHref("communication")),u=n.get(l.link("mediaRelayAccessToken").href),d=!!n.get({rel:"root"},null)&&!!n.get({rel:"root"}).get("internal",!1),p=!1,f=[],m=[],h=[{addresses:["coturn-mdn.cloudapp.net"],udpPort:3478,tcpPort:3478,username:"HxZMPT6f",password:"3F7PkZG8tJKnMIpi",type:"turn"}],v=0
	function g(t){return t=t>2?t-2:0,e.Date.now()+6e4*t}function y(){return m=[],f=[],t.isOrtc()?n.send("GET",{rel:"mediaRelayAccessToken"}).then((function(){for(var e=u.get("userName"),t=u.get("password"),i=0,r=u.links("mediaRelay");i<r.length;i++){var o=r[i],a=n.get(o.href);(!d&&"Internet"==a.get("location")||d&&"Intranet"==a.get("location"))&&m.push({addresses:[a.get("host")],udpPort:a.get("udpPort"),tcpPort:a.get("tcpPort"),password:t,username:e,type:"msturn"})}v=g(u.get("duration"))})).catch((function(n){t.log("UcwaRelayManager::getMediaRelayAccessToken error: ",n),i&&i.record(e.TelemetryEvent.Call,{action:"getMediaRelayAccessToken",mediaType:t.useBrowserMedia()?"pluginless":"plugin",result:"failed",reason:n})})):n.send("GET",r.mergeQuery(l.link("mediaRelayAccessToken").href,{mrasType:"ietf"})).then((function(){var e=u.links("mediaRelay"),t=n.get(e[0].href)
	a="https://"+t.get("host")+"/relay",f.push({addresses:[],udpPort:t.get("udpPort"),tcpPort:t.get("tcpPort"),password:u.get("password"),username:u.get("userName"),type:"turn"}),v=g(u.get("duration"))})).catch((function(n){t.log("UcwaRelayManager::cannot get an IETF TURN relay redirector; using a test one, err: "+n),p=!0,v=0,i&&i.record(e.TelemetryEvent.Call,{action:"getIETFTurnRelayRedirector",mediaType:t.useBrowserMedia()?"pluginless":"plugin",result:"failed",reason:n})}))}return s=y(),{queryRelaysAsync:function(n){return void 0===n&&(n="msturn"),s.then((function(){if(!p&&e.Date.now()>v)return s=y()})).then((function(){return"msturn"==n?m:p?h:(new c).send({type:"GET",url:a,headers:{Accept:"application/json; charset=utf-8"}}).then((function(e){if(t.log("GET "+a+" returned "+e.status+" "+e.responseText),o.isSuccess(e.status)){var n=JSON.parse(e.responseText)
	return f[0].addresses=[n.relay],f}return t.log("Cannot get an IETF TURN relay; using a test one, err: "+e.status+" "+e.statusText),h}))}))}}},u=function e(n){void 0===n&&(n={})
	var r=function(){for(var e,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o]
	return t.log.apply(t,[(e=n.namespace,(i(e)?e():e||"")+":")].concat(r))}
	this.log=r,this.info=r,this.warn=r,this.error=r,this.debug=n.debug?r:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},this.createChild=function(t,i){return void 0===i&&(i=n.debug),new e({namespace:t,debug:i})}}
	t.MaxVideoChannels=t.isWebRtc()?1:6
	var d=new s
	t.getMediaAgent=function(i,r){if(!d.has(i)){var o=new u({namespace:"MA",debug:!0}),s=new l(i,r),c={getLogger:function(){return o},getRelayManager:function(){return s},settings:{debug:!0,preferSdesSrtp:!0,enableLocalVideoConstraints:!0,iceDisconnectedTimeoutMs:3e4,webrtcVideoCapabilityMaxFS:1200,webrtcVideoCapabilityMaxFPS:3e3,webrtcVideoCapabilityCheckIntervalMin:2e4,webrtcVideoCapabilityCheckIntervalMax:3e4,webrtcAudioChannelSignalingFeedback:"app recv:dsh",webrtcVideoChannelSignalingFeedback:"app recv:csrc,src",numVideoChannelsGvc:t.MaxVideoChannels}},p=new a,f=new a,m={onDevicesChanged:function(e){p.fire(e)},onDevicesPermissionChanged:function(e){f.fire(e)}},h=e.Settings.mediaAgent&&e.Settings.mediaAgent(c,m),v=n(h||t.MediaAgent.build(c,m),{devicesChanged:p.observer,permissionsChanged:f.observer,deviceManagerCallback:m})
	d.set(i,v)}return d.get(i)}})(e.Media||(e.Media={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.Model,i=e.Utils.Property,r=e.Utils.setHiddenProperty,o=function(){var o=i(),a=new t.MediaStream,s=new t.VideoChannel({name:"ActiveSpeaker Channel",isLocal:!1})
	s.stream.setSource(a)
	var c=n({channel:s,participant:o.asReadOnly()})
	return r(c,t.sInternal,{participant:o,setVideoStream:function(t){var n=s.stream,i=n.source.sink.format(),r=n.source.sink.container()
	n.setSource(t||a),n.source.sink.format(i),n.source.sink.container(r),e.Media.log("WebRtcActiveSpeaker::SetVideoStream  stream %c"+(t&&t._id()),"color:green;font-weight:bold")},setVideoStarted:function(e){return s.isStarted._set(e)}}),c}
	t.WebRtcActiveSpeaker=o})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.find,i=e.Utils.guid,r=e.Utils.check,o=e.Utils.async,a=e.Utils.assert,s=e.Utils.extend,c=e.Utils.random,l=e.Utils.values,u=e.Utils.filter,d=e.Utils.foreach,p=e.Utils.isEmptyObject,f=e.Utils.Task,m=e.Utils.Event,h=e.Utils.Command,v=e.Utils.DataUri,g=e.Utils.Promise,y=e.Utils.Property,b=e.Utils.Exception,_=e.Utils.Collection,E=e.Utils.StringEnum,w=e.Utils.EDoesNotExist,S=e.Utils.EInvalidState,x=e.Utils.ENotSupported,C=e.Utils.setHiddenProperty,T=e.Media.log,I=e.Media.watch,A=function(A){var M,O,k,N,P,R,L,D,U,F,B=new m,V=new m,G={},H=A.devices,q=A.ucwa,W=A.context,j=A.contextType,z=A.settings,K=A.tm,Y=A.participants,Q=A.selfParticipant,X=A.conversation,$=A.rConversation,J=A.rAVInvitation,Z={},ee=A.invitation,te=A.rInvitation,ne=A.operationId||i(),ie=A.sessionContext||i(),re={},oe=A.escalateAudioVideoUri,ae=y({value:oe?2:0}),se=y(),ce=oe?t.sEscalation:void 0,le=y({value:ee||te&&"onlineMeetingInvitation"==te.rel?t.Modality.State.Notified:t.Modality.State.Disconnected,reason:ce}),ue=y({value:ee&&!ee.hasVideo()||te&&"onlineMeetingInvitation"==te.rel&&X.meeting.availableModalities.audio()&&!X.meeting.availableModalities.video()||Qe()?t.Modality.State.Notified:t.Modality.State.Disconnected,reason:ce}),de=y({value:Qe()?t.Modality.State.Notified:t.Modality.State.Disconnected,reason:ce}),pe=y({value:""}),fe=null,me={},he=A.activeSpeaker,ve={audio:!1,video:!1},ge=new t.WebRtcRemoteMediaStream,ye=new t.WebRtcLocalMediaStream,be=_(),_e=!1,Ee={},we=null,Se=0,xe=A.callId||c(),Ce=0,Te=1,Ie=2,Ae=3,Me=4,Oe=5,ke=6,Ne=E("Inactive","ReceiveOnly","SendOnly","SendReceive","Unknown"),Pe=Ce,Re=Q.audio.isUnmuteRequested,Le=y({value:!1}),De=((P=new f).resolve(),F={onNegotiationRequired:function(){var e=b("skipping outgoing renegotiation because of pending incoming renegotiation"),t=function(){var e,t,n=u(l(Z),(function(e){return e.negotiated}))
	return n.length>0&&(a(1==n.length),e=(t=n[0]).resumeAudioVideoUri||t.resource.link("renegotiations").href,a(e)),e}(),n=!1
	t?(T("RENEGO REQUIRED"),P.promise.then((function(){if(_e)throw e
	return P=new f,U.createOfferAsync()})).then((function(r){if(n=!0,_e)throw e
	return function(e,t){T("Renegotiation SDP offer:\n",e)
	var n=i()
	return re[n]="",q.send("POST",t,{headers:{"Content-Type":"application/sdp"},query:{operationId:n},data:e,nobatch:!0})}(r.blob,t)})).catch((function(e){T(e),He("reject",e),qe("reject",e),g.resolve().then((function(){if(n)return U.rejectNegotiationAsync("local",!1)})).finally((function(){"pending"==P.state()&&P.resolve()}))}))):T("NEGO REQUIRED")},onContributingSourcesChanged:Je,onDominantSpeakerChanged:function(e){},onSessionErrorOccurred:function(t){K&&K.record(e.TelemetryEvent.Call,{action:"mediaSessionError",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),reason:t,callId:xe})
	var n=t.type+": "+t.detail
	T("WebRtcAudioVideoSession("+xe+")::onSessionErrorOccured",n),V.fire(n)}},e.Media.getMediaAgent(q,K)),Ue=H._dm.map((function(e){return!!e}))
	function Fe(e){if(Ue()){var t=H._dm()
	return e?t.muteInputAsync():t.unmuteInputAsync()}}a(X)
	var Be=y({value:!1,get:function(){return Be()},set:h((function(n,i){var r
	if(ze()&&i!==t.sEscalation){var o=n?"muteAudio":"unmuteAudio",a=q.get(Q[t.sInternal].audioLink)
	!n&&Re()?(Re(!1),r=Fe(n).then((function(){return n}))):r=f.run((function(){return a&&a.hasLink(o)?a:q.send("GET",Q[t.sInternal].audioLink)})).then((function(e){return q.send("POST",e.link(o).href)})).then((function(){return!n&&Re()&&Re(!1),n}))}else r=Fe(n).then((function(){return n}))
	return K&&K.monitor(r,e.TelemetryEvent.Call,{action:n?"muteAudio":"unmuteAudio",type:ze()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",callId:xe},{sendEndEventOnly:!0}),r}),Ue)}),Ve=y({value:!1,get:function(){return Ve()},set:function(e){if(!ze()&&Y.size()>0&&Y(0).audio.isOnHold()&&!Ve())return e
	var n=e?4:3
	return Se=ve.video?e?4:Q[t.sInternal].videoStartedBeforeHold()?3:2:0,D=e,Q[t.sInternal].videoStartedBeforeHold(e?Q.video.channels(0).isStarted():void 0),Q[t.sInternal].audioOnHold(e),f.run((function(){return U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(n),video:t.MediaEnum.enumcastMediaConfig(Se)}))})).then((function(){return(L=new f(D?"hold":"resume")).promise.then((function(){return D}))})).then((function(){return function(e){var t=[]
	if(e)for(var n in Ee){var i=tt(Ee[n],!0)
	t.push(i)}else for(var n in Ee)i=et(Ee[n],!0),t.push(i)
	return f.waitAll(t)}(e)})).then((function(){return e}))}})
	function Ge(){return(R=new f("selfVideo")).promise}function He(e,t){R&&"pending"==R.state()&&("resolve"==e?R.resolve():"reject"==e&&R.reject(t))}function qe(e,t){L&&"pending"==L.state()&&("resolve"==e?L.resolve(D):"reject"==e&&L.reject(t))}function We(e){a(e),delete Ee[e[t.sHref]]}function je(e){for(var t in e)""===e[t]&&delete e[t]
	return e}function ze(){var e=$&&$.get("state","")
	return"Conferencing"==e||"Conferenced"==e}function Ke(e){T("WebRtcAudioVideoSession("+xe+")::removeAllVideo",e),rt(ge),rt(ye),e!==t.sEscalation&&Q[t.sInternal].setVideoStream(null),Y.size()>0&&(Y(0)[t.sInternal].setVideoStream(null),Y(0)[t.sInternal].setVideoStarted(void 0))}function Ye(e){T("WebRtcAudioVideoSession("+xe+")::resetVideo",e),Y.each((function(e){rt(e.video.channels(0).stream),e[t.sInternal].setVideoStream(null)})),be.empty(),e!==t.sEscalation&&(Q[t.sInternal].setVideoStream(null),Q[t.sInternal].videoState(t.Modality.State.Disconnected),pe("")),he&&ze()&&(he[t.sInternal].setVideoStream(null),ge._isAttached(!1),he[t.sInternal].setVideoStarted(!1))}function Qe(){return ee&&ee.hasVideo()||te&&"onlineMeetingInvitation"==te.rel&&X.meeting.availableModalities.video()}function Xe(t){var n
	f.run((function(){return U.getStatsAsync()})).then((function(i){n=i&&_stringify(i),T("WebRtcAudioVideoSession("+xe+")::postMediaDiagnostics",t,n),n&&K&&K.record(e.TelemetryEvent.Call,{action:"postMediaDiagnostics",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",mediaStats:n,reason:t,callId:xe})})).catch((function(e){T("WebRtcAudioVideoSession("+xe+")::getStats failed",e)}))}function $e(e){pe(e.activeModalities.video||"")}function Je(e){var n=[]
	for(var i in me){var r=e.indexOf(+i);-1!=r?e.splice(r,1):n.push(i)}for(var o=0,a=n;o<a.length;o++)i=a[o],me[i][t.sInternal].isSpeaking(!1),delete me[i]
	for(var s=0,c=e;s<c.length;s++){i=c[s]
	var l=void 0
	if(Q[t.sInternal].audioSourceId()==i)l=Q
	else for(var u=0,d=Y();u<d.length;u++){var p=d[u]
	if(p[t.sInternal].audioSourceId()==i){l=p
	break}}l&&(l[t.sInternal].isSpeaking(!0),me[i]=l)}}function Ze(e){return e&&/^(Devices)?NotFoundError$/.test(e.name)&&(!H.selectedMicrophone()||"Disconnected"!=de()&&!H.selectedCamera())&&(e=b.call("The requested media stream could not be found, check your camera or microphone devices","DeviceNotFound",{reason:e})),e}function et(n,i){return new g((function(e){if(de()==t.Modality.State.Connecting)var n=de.changed((function(i,r,o){i!=t.Modality.State.Connecting&&(n.dispose(),e())}))
	else e()})).then((function(){var r,o
	if(de()!=t.Modality.State.Connected)throw S(de(),t.Modality.State.Connected)
	if(Ve()&&!i)throw b("OnHold")
	if(T("WebRtcAudioVideoSession("+xe+")::showParticipantVideo",n),n[t.sInternal].isLocal())return!1===n.video.channels(0).isStarted()?(Se=3,f.run((function(){return U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(3),video:t.MediaEnum.enumcastMediaConfig(Se)}))})).then((function(){return Ge()}))):(new f).resolve().promise
	if(ze()){if(ge._isAttached())for(var s=0,c=be();s<c.length;s++){var l=c[s]
	if(!l._isAttached()){r=l
	break}}else r=ge
	if(!r){if(!(be.size()<e.Media.MaxVideoChannels-1))throw T("Cannot find available stream"),w("No available stream")
	r=new t.WebRtcRemoteMediaStream({mediaSession:U}),be.add(r)}n[t.sInternal].setVideoStream(r),o=r._id.set(n[t.sInternal].videoSourceId()).then((function(){return r._isAttached.set(!0)})).then((function(){return it(r)})).then((function(){return function(e){a(e),Ee[e[t.sHref]]=e}(n)}))}else o=(new f).reject(x("cannot start remote video in 1:1 conversation")).promise
	return o}))}function tt(e,n){var i
	return T("WebRtcAudioVideoSession("+xe+")::removeParticipantVideo",e),e[t.sInternal].isLocal()?(Se=2,ze()||Y(0).video.channels(0).isVideoOn()||(Se=4),i=f.run((function(){return U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(3),video:t.MediaEnum.enumcastMediaConfig(Se)}))})).then((function(){return Ge()}))):i=ze()?f.wait(null,"sync").then((function(){var i=e.video.channels(0).stream,r=i.source.sink
	if(r._c()&&(r._c().dispose(),r._c(null)),n||We(e),i._isAttached())return rt(i).then((function(){return i._isAttached.set(!1)})).then((function(){return i._id.set(-1)})).then((function(){return e[t.sInternal].setVideoStream(null)}))})):(new f).reject(x("cannot remove remote video in 1:1 conversation")).promise,i}function nt(n){if(Le())T("WebRtcAudioVideoSession("+xe+")::already cleaned up",n)
	else{K&&K.record(e.TelemetryEvent.Call,{action:"cleanup",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),reason:n,callId:xe})
	var i=t.Modality.State.Disconnected
	T("WebRtcAudioVideoSession("+xe+")::cleanup",n)
	var r=g.resolve()
	ze()&&n!==t.sEscalation?Be._set(!1):r=Be.set(!1,n),Ve._set(!1),r.finally((function(){Q.audio.isMuted.get(),Q.audio.isOnHold.get(),Le(!0)})),Q[t.sInternal].audioOnHold(!1),Q[t.sInternal].videoStartedBeforeHold(void 0),q.event.off(ot),Ke(n),Ye(n),U&&(U.terminate(),U=null),Y.each((function(e){e[t.sInternal].setVideoStream(null),n!==t.sEscalation&&(e.video.channels(0)[t.sInternal].isVideoOn(!1),e[t.sInternal].setVideoStarted(!1))})),n!==t.sEscalation&&(Q.video.channels(0)[t.sInternal].isVideoOn(!1),Q[t.sInternal].setVideoStarted(!1)),ue(i),de(i,n),pe("")}}function it(e){return e._isRendering.set(!0)}function rt(e){return e._isRendering.set(!1)}function ot(e){var t=e.target.rel+" "+e.type,n=at[t]
	n&&(T("WebRtcAudioVideoSession("+xe+")::onServerEvent: "+t),n(e.status,e.resource,e))}A=null,q.event(ot),I("WebRtcAudioVideoSession("+xe+")::state:",le),I("WebRtcAudioVideoSession("+xe+")::audioState:",ue),I("WebRtcAudioVideoSession("+xe+")::videoState:",de),le.when(t.Modality.State.Connected,(function(e){return ue(t.Modality.State.Connected,e)})),le.when(t.Modality.State.Disconnected,(function(e){ue(t.Modality.State.Disconnected,e),de(t.Modality.State.Disconnected,e)})),de.when(t.Modality.State.Disconnected,Ye),y.observe([le,de,pe],(function(e,n,i){e==t.Modality.State.Connected&&n==t.Modality.State.Connected&&function(e){function t(e){e.local?it(ye):rt(ye),ze()||(e.remote?it(ge):rt(ge))}switch(e){case"sendonly":t({local:!0,remote:!1})
	break
	case"recvonly":t({local:!1,remote:!0})
	break
	case"sendrecv":t({local:!0,remote:!0})
	break
	case"inactive":case"":t({local:!1,remote:!1})}}(i)})),pe.changed((function(e){ze()||1!=Y.size()||(Y(0).video.channels(0)[t.sInternal].isVideoOn(e==t.MediaEnum.enumcastMediaConfig(3)||e==t.MediaEnum.enumcastMediaConfig(2)),se(t.MediaEnum.enumcastDirection(e)))})),Y.removed((function(n){var i=n[t.sInternal].audioSourceId()
	e.Media.isWebRtc()?fe&&fe[t.sInternal].audioSourceId()==i&&(fe=null):(delete me[i],We(n))})),s(G,{state:le.asReadOnly(),audioState:ue.asReadOnly(),videoState:de.asReadOnly(),start:o((function(n){if(0!=n.mainVideoConfig&&ve.video||0==n.mainVideoConfig&&3==n.audioConfig&&ve.audio)throw b("AlreadyStarted")
	T("WebRtcAudioVideoSession("+xe+")::start",n),r.state(Ve(),!1)
	var c=n.audioConfig,l=n.video&&n.video.previewContainer,u=n.video&&n.video.container,d=0!=n.mainVideoConfig,p=Se
	if(Se=n.mainVideoConfig,O=O||n.remoteUri,n=null,r.state(le(),[t.Modality.State.Disconnected,t.Modality.State.Notified,t.Modality.State.Connected]),(le()==t.Modality.State.Disconnected||le()==t.Modality.State.Notified)&&le(t.Modality.State.Connecting),ue()!=t.Modality.State.Disconnected&&ue()!=t.Modality.State.Notified||(ue(t.Modality.State.Connecting),!ze()&&Y.size()>0&&Y(0)[t.sInternal].audioState(t.Modality.State.Connecting)),d||de(t.Modality.State.Disconnected),(de()==t.Modality.State.Disconnected&&d||de()==t.Modality.State.Notified)&&(de(t.Modality.State.Connecting),!ze()&&Y.size()>0&&Y(0)[t.sInternal].videoState(t.Modality.State.Connecting)),ue()==t.Modality.State.Connected&&de()==t.Modality.State.Connecting)return f.run((function(){return U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(c),video:t.MediaEnum.enumcastMediaConfig(Se)}))})).then((function(){return Ge()})).catch((function(e){throw Se=p,!ze()&&Y.size()>0&&Y(0)[t.sInternal].videoState()==t.Modality.State.Connecting&&Y(0)[t.sInternal].videoState(t.Modality.State.Disconnected),de(t.Modality.State.Disconnected),e}))
	k=new f("starting a call")
	var m=f.run((function(){return U||(U=De.createSession(F,i(),{isRemoteClientLync:!0,isConference:ze()}),ge._mediaSession(U),ye._deviceManager(De.getDeviceManager())),U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(c),video:t.MediaEnum.enumcastMediaConfig(Se)}))})).then((function(){return Q[t.sInternal].setVideoStream(ye),u&&ge.source.sink.container(u),l&&ye.source.sink.container(l),ue()==t.Modality.State.Connecting&&!ze()&&Y.size()>0&&Y(0)[t.sInternal].audioState(t.Modality.State.Ringing),U.createOfferAsync()})).then((function(n){return function(n){function i(e,i,r){var o,a="9BCE36B8-2C70-44CA-AAA6-D3D332ADBD3F",c={nobatch:!0}
	return ze()?oe?c={headers:{"Content-Type":"multipart/alternative;boundary="+a+';type="application/sdp"',"Content-Length":""+(o=t.multipartSDP(n,a)).length},query:{operationId:ne,sessionContext:ie},data:o,nobatch:!0}:(c.data=t.multipartJsonAndSDP({offers:n,boundary:a,operationId:ne,sessionContext:ie,threadId:X.threadId(),context:e,contextType:i}),c.headers={"Content-Type":"multipart/related;boundary="+a+';type="application/vnd.microsoft.com.ucwa+json"'}):(c.data=t.multipartJsonAndSDP({to:r?void 0:O,offers:n,boundary:a,subject:X.topic(),importance:X.priority(),operationId:ne,sessionContext:ie,threadId:X.threadId(),context:e,contextType:i}),c.headers={"Content-Type":"multipart/related;boundary="+a+';type="application/vnd.microsoft.com.ucwa+json"'}),void 0!==e&&s(c.headers,{"X-MS-RequiresMinResourceVersion":2}),c}return a(n.length>0),o(_t).call(null).then((function(n){var r,o,a=i(n.revision>=2?W:void 0,j,"addAudioVideo"==n.rel)
	return r=q.send("POST",n.href,a).then((function(e){J||(J=e)})).catch((function(e){if(T("WebRtcAudioVideoSession("+xe+"):sendOffer: startAudioVideo failed",e),X.isThreadIdRejectedError(e))return X.resetThreadId(),a=i(n.revision>=2?W:void 0,j,"addAudioVideo"==n.rel),q.send("POST",n.href,a)
	throw e})),o=q.wait({type:"completed",target:{rel:"audioVideoInvitation"},resource:{direction:"Outgoing",threadId:X.threadId(),operationId:ne,sessionContext:ie}}).then((function(n){if(T("WebRtcAudioVideoSession("+xe+"):sendOffer: audioVideoInvitation completed",n),K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoInvitationCompleted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:n.status,reason:n.reason,direction:"Outgoing",callId:xe}),"Failure"==n.status)throw(J=n.resource).eventRecv=!0,t.EInvitationFailed(n.reason)
	return we.then((function(){return U.completeNegotiationAsync()})).catch((function(e){return T("Error setting final answer: ",e),g.resolve(null,"sync").then((function(){return U.rejectNegotiationAsync("local",!1)})).finally((function(){throw e}))})).then($e)})),f.waitAll([r,o])}))}([{sdp:n.blob,id:1}])})).then((function(){return le(t.Modality.State.Connected),de(""==pe()?t.Modality.State.Disconnected:t.Modality.State.Connected),k.resolve().promise})).catch((function(e){throw T("WebRtcAudioVideoSession("+xe+")::start failed",e),(e=Ze(e))&&!e.code&&e.type&&(e.code=e.type),Xe(e),J?(J.hasLink("cancel")&&q.send("POST",J.link("cancel").href,{nobatch:!0}),J.eventRecv&&nt()):nt(e),"pending"==k.state()&&k.reject(e),le(t.Modality.State.Disconnected,e),e}))
	return f.waitAll([m,k.promise]).then((function(){}))})),stop:o((function(n){if(T("WebRtcAudioVideoSession("+xe+")::stop",n),le()==t.Modality.State.Connecting){var i=k||N
	return i?(i.promise.cancel(),g.resolve()):(T("WebRtcAudioVideoSession("+xe+")::stop cannot be called in Connecting state without a pending start or accept"),g.reject(x("stop cannot be called in Connecting state without a pending start or accept")))}var r
	if("video"==n){ze()&&Y.each((function(e){e.video.channels(0).isStarted(!1)}))
	var o=Ve()?4:3
	Se=0,r=f.run((function(){return U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(o),video:t.MediaEnum.enumcastMediaConfig(Se)}))}))}else n===t.sEscalation||n&&"NotFound"==n.code?(nt(n),r=g.resolve()):(Xe(n),r=q.send("GET",$.link("audioVideo").href).then((function(e){return q.send("POST",e.link("stopAudioVideo").href,{query:{reason:n||"UserInitiatedAction"}})})).catch((function(t){T("WebRtcAudioVideoSession("+xe+")::stop",t),K&&K.record(e.TelemetryEvent.Call,{action:"stopAudioVideo",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),reason:t,callId:xe})})).finally((function(){return nt(n)})))
	return r.then((function(){}))})),cleanup:nt,sendDtmf:function(e){return f.run((function(){return U.sendDtmf(e)}))},escalated:B.observer,errorOccured:V.observer,muted:Be,onHold:Ve,selfVideoStream:ye,showParticipantVideo:et,removeParticipantVideo:tt,showActiveSpeakerVideo:function(){if(Ve())throw b("OnHold")
	a(he),a(!ge._isAttached()),he[t.sInternal].setVideoStream(ge)
	var e=he.channel.stream
	return e._id(-2),e._isAttached(!0),it(e)},removeActiveSpeakerVideo:function(){if(Ve())throw b("OnHold")
	return a(he),f.wait(null,"sync").then((function(){var e=he.channel.stream,n=e.source.sink
	n._c()&&(n._c().dispose(),n._c(null)),e._isAttached()&&(rt(e),e._isAttached(!1),e._id(-2),he[t.sInternal].setVideoStream(null))}))},removeVideo:o(Ke),escalationState:ae,preEscalationVideoConfig:se,isClean:Le.asReadOnly()}),ee&&s(G,{from:ee.from,accept:o((function(n){a(ee,'This is an outgoing call, so it cannot be "accepted"'),a(!ze(),"This is a conference"),a(1==Y.size(),"The caller is not in participants"),T("WebRtcAudioVideoSession("+xe+")::accept",n)
	var r,o=n&&n.video,s=o&&o.container,c=o&&o.previewContainer
	Se=o?t.MediaEnum.enumcastDirection(o.direction):z&&0==z.supportsVideo?0:2,le(t.Modality.State.Connecting),ue(t.Modality.State.Connecting),Y(0)[t.sInternal].audioState(t.Modality.State.Connecting),ee.hasVideo()&&(de(t.Modality.State.Connecting),Y(0)[t.sInternal].videoState(t.Modality.State.Connecting)),N=new f("accepting a call")
	var l=f.run((function(){if(le()==t.Modality.State.Disconnected)throw t.EInvitationFailed(le.reason)
	return Q[t.sInternal].setVideoStream(ye),s&&ge.source.sink.container(s),c&&ye.source.sink.container(c),U=De.createSession(F,i(),{isRemoteClientLync:!0,isConference:ze()}),ge._mediaSession(U),ye._deviceManager(De.getDeviceManager()),ee.offers.length>1&&T("WebRtcAudioVideoSession("+xe+")::accept:number of offers:",ee.offers.length),ee.offers.sort((function(e,t){var n=/\ba=label\b/gi
	return n.test(e.sdp)?-1:n.test(t.sdp)?1:0})),function t(n){return r=yt(ee.offers[n].sdp),U.processOfferAsync({blob:ee.offers[n].sdp}).catch((function(i){if(!i||"Canceled"!=i.code)return K&&K.record(e.TelemetryEvent.Call,{action:"processOfferAsync",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),reason:i,offerId:n,callId:xe}),U.rejectNegotiationAsync("local",!1).then((function(){if(++n<ee.offers.length)return t(n)
	throw i})).catch((function(e){throw e}))
	throw i}))}(0)})).then((function(e){return U.configureModalitiesAsync(je(e.video?{audio:e.audio,video:t.MediaEnum.enumcastMediaConfig(r)}:e))})).then((function(){return U.createAnswerAsync(!1)})).then((function(e){return ee.acceptWithAnswer(e.blob,ie)})).catch((function(e){throw T("WebRtcAudioVideoSession("+xe+")::accept failed",e),e&&!e.code&&e.type&&(e.code=e.type),le(t.Modality.State.Disconnected,e),de(t.Modality.State.Disconnected),Xe(e),nt(e),"pending"==N.state()&&N.reject(e),e}))
	return f.waitAll([l,N.promise])}))})
	var at={"audioVideoInvitation started":function(n,i){if("Outgoing"==i.get("direction")&&i.get("sessionContext")==ie)if(le()==t.Modality.State.Disconnected){if(i.hasLink("cancel")){var r=q.send("POST",i.link("cancel").href,{nobatch:!0})
	K&&K.monitor(r,e.TelemetryEvent.Call,{action:"cancel",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),callId:xe})}nt()}else(J=i).eventRecv=!0,k.status('awaiting "audioVideoNegotiation started or completed" event from UCWA')},"conversation added":function(e,t){t.get("threadId")==X.threadId()&&($=t)},"audioVideoNegotiation started":function(t,n,i){var r,o
	J&&i.sender.href==J.href&&(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoNegotiationStarted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),hasAnswer:n.hasLink("mediaProvisionalAnswer"),callId:xe}),n.hasLink("mediaProvisionalAnswer")&&((r=n.link("mediaProvisionalAnswer").href,o=v(r).data,T("Provisional answer from the remote party:\n"+o),f.run((function(){return U.processAnswerAsync({blob:o},!0)}))).catch((function(e){return T("Error setting provisional answer: ",e)})),k.status('awaiting "audioVideoNegotiation completed" event from UCWA')))},"audioVideoNegotiation completed":function(t,n,i){var r
	if(J&&i.sender.href==J.href)switch(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoNegotiationCompleted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:t,reason:i.reason,hasAnswer:n&&n.hasLink("mediaAnswer"),callId:xe}),t){case"Success":r=n.link("audioVideoSession").href,Z[r]=Z[r]||{},Z[r].negotiated=!0,we=bt(n.link("mediaAnswer").href),k.status('awaiting "audioVideoInvitation completed" event from UCWA')
	break
	case"Failure":"Ended"!=i.reason.subcode&&"ConnectedElsewhere"!=i.reason.subcode&&k&&k.status(i.reason&&i.reason.message)}},"audioVideoSession added":function(t,n){var i=n.href
	n.get("sessionContext")==ie&&(Z[i]=Z[i]||{},Z[i].resource=n,K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoSessionAdded",type:ze()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",callId:xe,href:i}))},"audioVideoSession deleted":function(t,n,i){i.target.href in Z&&(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoSessionDeleted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:t,reason:i.reason,callId:xe}),delete Z[i.target.href],2==ae()&&p(Z)&&(B.fire("failure"),ae(0)))},"audioVideoInvitation completed":function(n,i,r){var o
	J&&J.href==i.href&&"Incoming"==i.get("direction")&&(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoInvitationCompleted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:n,reason:r.reason,sessionContext:i.get("sessionContext",void 0),direction:"Incoming",callId:xe}),"Success"==n?(o=i.get("sessionContext"),d(Z,(function(e){e.resource.get("sessionContext")==o&&(e.negotiated=!0)})),U.completeNegotiationAsync().then((function(e){$e(e),a(!ze())
	var n=Y(0)
	n&&(n[t.sInternal].audioState(t.Modality.State.Connected),""!=pe()&&(n[t.sInternal].setVideoStream(ge),n[t.sInternal].videoState(t.Modality.State.Connected))),N.resolve(),le(t.Modality.State.Connected),de(""==pe()?t.Modality.State.Disconnected:t.Modality.State.Connected)})).catch((function(e){N&&(e=Ze(e),N.reject(e)),nt(),le(t.Modality.State.Disconnected,e)}))):(N&&N.reject(r.reason),nt(),le(t.Modality.State.Disconnected,r.reason)))},"audioVideoRenegotiation started":function(n,i){if(i.link("audioVideoSession").href in Z){K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoRenegotiationStarted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:n,hasOffer:i.hasLink("mediaOffer"),direction:i.get("direction",void 0),callId:xe})
	var r="Waiting for audioVideoRenegotiation completed event"
	if("Incoming"==i.get("direction")){var o=v(i.link("mediaOffer").href).data
	!ze()&&Y.size()>0&&(Pe=function(e){return/\ba=inactive\b/gim.test(e)}(o)?Te:Me),M=i,_e=!0,P.promise.then((function(){return function(e){var n=yt(e)
	return T("Incoming SDP offer:\n"+e),U.processOfferAsync({blob:e}).then((function(e){return U.configureModalitiesAsync(je(e.video?{audio:e.audio,video:t.MediaEnum.enumcastMediaConfig(n)}:e))})).then((function(){return U.createAnswerAsync(!1)})).then((function(e){return ze()||(Pe==Te?Pe=Ie:Pe==Me&&(Pe=Oe)),q.send("POST",M.link("answer").href,{headers:{"Content-Type":"application/sdp"},data:e.blob,nobatch:!0})}))}(o)})).catch((function(e){T(e),nt(e),le(t.Modality.State.Disconnected,e),_e=!1}))}else k&&"pending"==k.state()?k.status(r):R&&"pending"==R.state()?R.status(r):L&&"pending"==L.state()&&L.status(r)}},"audioVideoRenegotiation completed":function(n,i,r){var o,s,c=i.link("audioVideoSession").href
	c in Z&&(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoRenegotiationCompleted",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),status:n,reason:r.reason,hasAnswer:i.hasLink("mediaAnswer"),operationId:i.get("operationId",void 0),direction:i.get("direction",void 0),callId:xe}),"Outgoing"==i.get("direction")?(a(i.get("operationId")in re),delete re[i.get("operationId")],"Success"==n?(Z[c].renegotiated=!0,s=bt(i.link("mediaAnswer").href).then((function(){return U.completeNegotiationAsync()})).then((function(e){$e(e),de(""==pe()?t.Modality.State.Disconnected:t.Modality.State.Connected),He("resolve"),qe("resolve")}))):(s=f.run((function(){return U.rejectNegotiationAsync("signaling",!1)})),He("reject",o=r.reason),qe("reject",o)),s.catch((function(e){n="Failure",He("reject",o=e),qe("reject",o)})).finally((function(){k&&"pending"==k.state()&&("Success"==n?k.resolve():k.reject(o||r.reason)),"pending"==P.state()&&P.resolve()}))):("Success"==n?(ze()||(Pe==Ie?Pe=Ae:Pe==Oe&&(Pe=ke)),s=g.resolve(null,"sync").then((function(){return U.completeNegotiationAsync()})).then((function(e){ze()||(Pe==Ae&&"inactive"==e.activeModalities.audio?(Y(0)[t.sInternal].audioOnHold(!0),Y(0).video.channels(0)[t.sInternal].isVideoOn(!1)):Pe==ke&&Y(0)[t.sInternal].audioOnHold(!1),Pe=Ce),$e(e),de(""==pe()?t.Modality.State.Disconnected:t.Modality.State.Connected)}))):s=g.resolve(null,"sync").then((function(){return U.rejectNegotiationAsync("signaling",!1)})),s.catch(T).finally((function(){return _e=!1}))))},"audioVideo updated":function(n,i,r){J&&J.hasLink("audioVideo")&&i.href==J.link("audioVideo").href&&(K&&K.record(e.TelemetryEvent.Call,{action:"audioVideoUpdated",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:i.get("state",void 0),status:n,reason:r.reason,callId:xe}),"Disconnected"==i.get("state")?(Xe(r.reason),"Connected"==J.get("state")&&(nt(),le(t.Modality.State.Disconnected))):"Connected"==i.get("state")&&r.reason&&"SessionSwitched"==r.reason.subcode&&i.link("audioVideoSession").href in Z&&(B.fire("success"),ae(0)))},"participantAudio added":ct,"participantAudio updated":ct,"participantAudio deleted":ct,"participantVideo added":lt,"participantVideo updated":lt,"participantVideo deleted":lt,"escalateAudio deleted":function(e,t,n){n.target.href==oe&&(oe=null)},"resumeAudio added":ft,"resumeAudioVideo added":ft,"resumeAudio deleted":mt,"resumeAudioVideo deleted":mt,"dominantSpeakers added":vt,"dominantSpeakers updated":vt,"currentVideo added":ht,"currentVideo updated":ht}
	function st(e){var i=n(Y(),(function(n){return n[t.sHref]==e}))
	return i||(ze()||1!=Y.size()?q.send("GET",e).then((function(e){return st(e.link("contact").href)})):Y(0))}function ct(e,n,i){var r=i.in
	if($&&i.sender.href==$.href&&r)if("localParticipant"==r.rel)switch(i.type){case"added":case"updated":if(ze()&&1!=ae()){if(Q[t.sInternal].setMediaSourceId(i),n.has("audioDirection"),n.has("audioMuted")){var o=n.get("audioMuted")
	Be.get().then((function(){o&&Be()&&Re()&&(Re(!1),Fe(!1)),o&&!Be()&&Be._set(o),!o&&Be()&&(Re(!0),Fe(!0)),Q.audio.isMuted.get()}))}for(var s=0,c=Y();s<c.length;s++){var l=c[s];-1==l[t.sInternal].audioSourceId()&&dt(l)}}ve.audio=!0
	break
	case"deleted":ve.audio=!1
	break
	default:a(!1,"unexpected event type")}else"participant"==r.rel&&f.wait(st(r.href)).then((function(e){switch(i.type){case"added":case"updated":ze()&&(e[t.sInternal].setMediaSourceId(i),q.send("GET",i.target.href).then((function(n){n.has("audioDirection")&&e[t.sInternal].audioOnHold(n.get("audioDirection")==Ne.Inactive),n.has("audioMuted")&&e[t.sInternal].audioMuted(n.get("audioMuted")),n.has("audioSourceId")&&e[t.sInternal].audioSourceId(+n.get("audioSourceId"))}))),e[t.sInternal].audioState(t.Modality.State.Connected)
	break
	case"deleted":e[t.sInternal].audioState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}}))}function lt(e,n,i){var r=i.in
	if($&&i.sender.href==$.href&&r)if("localParticipant"==r.rel)switch(i.type){case"added":case"updated":if(ve.video=!0,ze()){Q[t.sInternal].setMediaSourceId(i)
	for(var o=function(e){dt(e).then((function(n){-1!=n&&(e.video.channels(0)[t.sInternal].isVideoOn()||ut(e,"Video").then((function(t){t&&q.send("GET",t).then((function(t){pt(e,{resource:t},!1)}))})))}))},s=0,c=Y();s<c.length;s++)o(c[s])}break
	case"deleted":rt(ye),ve.video=!1,ze()&&Q[t.sInternal].setMediaSourceId(i),Q.video.channels(0)[t.sInternal].isVideoOn(!1),Q[t.sInternal].setVideoStarted(!1),de(t.Modality.State.Disconnected),Q[t.sInternal].videoState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}else"participant"==r.rel&&f.wait(st(r.href)).then((function(e){switch(i.type){case"added":case"updated":ze()?(e[t.sInternal].setMediaSourceId(i),pt(e,i).then((function(){Ve()&&!e.video.channels(0).isVideoOn()&&We(e)}))):(e[t.sInternal].setVideoStream(ge),e[t.sInternal].videoState(t.Modality.State.Connected))
	break
	case"deleted":ze()?(e[t.sInternal].setMediaSourceId(i),tt(e)):e[t.sInternal].setVideoStream(null),e.video.channels(0)[t.sInternal].isVideoOn(!1),e[t.sInternal].setVideoStarted(!1),e[t.sInternal].videoState(t.Modality.State.Disconnected)
	break
	default:a(!1,"unexpected event type")}}))}function ut(n,i){var r=i.toLowerCase()+"Link"
	return n[t.sInternal][r]?g.resolve(n[t.sInternal][r]):n[t.sHref]?q.send("GET",n[t.sHref]).then((function(e){var t="participant"+i
	if(e.hasLink(t))return e.link(t).href})):(K&&K.record(e.TelemetryEvent.Call,{action:"getAudioVideoHref",type:ze()?"conf":"p2p",modalities:ve.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",state:le(),result:"failed",reason:"no href for participant",callId:xe}),g.resolve())}function dt(e){return(-1!=e[t.sInternal].audioSourceId()?g.resolve():ut(e,"Audio").then((function(e){return e&&q.send("GET",e)})).then((function(n){return n&&n.has("audioSourceId")&&e[t.sInternal].audioSourceId.set(+n.get("audioSourceId"))}))).then((function(){return e[t.sInternal].audioSourceId()}))}function pt(e,n,i){void 0===i&&(i=!1)
	var r=n.resource,o=n.target
	return f.run((function(){return r&&r.has("videoDirection")?r:o&&q.send("GET",o.href)})).then((function(n){var r,o
	n&&n.has("videoSourceId")&&(r=+n.get("videoSourceId"),e[t.sInternal].videoSourceId(r)),n&&n.has("videoDirection")&&(o=n.get("videoDirection"),e.video.channels(0)[t.sInternal].isVideoOn(o===Ne.SendOnly||o===Ne.SendReceive),o!=Ne.Inactive&&o!=Ne.Unknown&&(i&&de(t.Modality.State.Connected),e[t.sInternal].videoState(t.Modality.State.Connected),e[t.sInternal].audioState(t.Modality.State.Connected))),T("WebRtcAudioVideoSession("+xe+"):updateVideoState: ",e.displayName(),r,o)}))}function ft(e,t,n){var i,r=n.in
	r&&"audioVideoSession"==r.rel&&r.href in Z&&(i=r.href,Z[i].resumeAudioVideoUri=n.target.href,f.run((function(){if(!Z[i].renegotiated)return q.wait({type:"completed",target:{rel:"audioVideoRenegotiation"},resource:function(e){return"Outgoing"==e.get("direction")&&e.link("audioVideoSession").href in Z}})})).then(gt).catch(T))}function mt(e,t,n){var i=n.in
	i&&"audioVideoSession"==i.rel&&i.href in Z&&n.target.href==Z[i.href].resumeAudioVideoUri&&delete Z[i.href].resumeAudioVideoUri}function ht(n,i,r){if(e.Media.isWebRtc()){var o=r.in
	if(o&&$&&r.sender.href==$.href&&o.href==$.link("audioVideo").href){var a=void 0,s=X.videoService.activeSpeaker,c=i.get("currentVideoId")
	if(Q[t.sInternal].videoSourceId()==c)a=Q
	else for(var l=0,u=Y();l<u.length;l++){var d=u[l]
	if(d[t.sInternal].videoSourceId()==c){a=d,s.channel[t.sInternal].isVideoOn(!0)
	break}}s[t.sInternal].participant(a)}}}function vt(n,i,r){if(e.Media.isWebRtc()){var o=r.in
	if(o&&$&&r.sender.href==$.href&&o.href==$.link("audioVideo").href){var a=void 0,s=i.get("dominantSpeakerId")
	if(Q[t.sInternal].audioSourceId()==s)a=Q
	else for(var c=0,l=Y();c<l.length;c++){var u=l[c]
	if(u[t.sInternal].audioSourceId()==s){a=u
	break}}fe&&fe[t.sInternal].isSpeaking(!1),a&&(fe=a)[t.sInternal].isSpeaking(!0)}}}function gt(){var e=Ve()?4:3,n=4==se()?2:se()
	return Se=ve.video?Ve()?4:null!=n?n:2:0,U.configureModalitiesAsync(je({audio:t.MediaEnum.enumcastMediaConfig(e),video:t.MediaEnum.enumcastMediaConfig(Se)}))}function yt(e){return Ve()||!/\bm=video\b/gim.test(e)?4:de()!=t.Modality.State.Connected&&de()!=t.Modality.State.Connecting||1!=Se&&3!=Se?z&&0==z.supportsVideo?0:2:3}function bt(e){var t=v(e).data
	return T("Final answer from the remote party:\n"+t),f.run((function(){return U.processAnswerAsync({blob:t},!1)}))}function _t(){if(!$){var e=q.get(q.app.relatedHref("communication")).link("startAudioVideo")
	return e.rel="startAudioVideo",e}return oe?q.get(oe):q.send("GET",$.link("audioVideo").href).then((function(e){var t=e.link("addAudioVideo")
	return t.rel="addAudioVideo",t}))}return C(G,t.sInternal,{callId:xe,onParticipantDeleted:function(e){var n=e.target
	if($&&e.sender.href==$.href&&"participant"==n.rel&&"deleted"==e.type&&!e.in)return f.wait(st(n.href)).then((function(n){if(ze())return n[t.sInternal].setMediaSourceId(e),n.video.channels(0)[t.sInternal].isVideoOn(!1),n[t.sInternal].setVideoStarted(!1),n[t.sInternal].videoState(t.Modality.State.Disconnected),tt(n)
	n[t.sInternal].setVideoStream(null)}))}}),T("WebRtcAudioVideoSession("+xe+") created"),G}
	t.WebRtcAudioVideoSession=A})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.find,i=e.Utils.check,r=e.Utils.async,o=e.Utils.assert,a=e.Utils.extend,s=e.Utils.random,c=e.Utils.isArray,l=e.Utils.contains,u=e.Utils.isPrimitive,d=e.Utils.isNotEmptyString,p=e.Utils.setHiddenProperty,f=e.Utils.Task,m=e.Utils.Model,h=e.Utils.Command,v=e.Utils.Promise,g=e.Utils.Property,y=e.Utils.Exception,b=e.Utils.EInvalidArgument,_=e.Media.log,E=e.Media.watch,w=function(w){var S,x,C,T,I,A,M,O,k,N,P,R=m(),L=w.ucwa,D=w.participants,U=w.guestName,F=w.selfParticipant,B=w.settings,V=w.me.id()||"",G=w.mediaPlugin,H=w.devices,q=w.tm,W=w.conversation,j=e.Media.useBrowserMedia()?t.WebRtcAudioVideoSession:t.AudioVideoSession,z=w.rInvitation,K=w.rConversation,Y=s(),Q={}
	ue()
	var X,$,J=g({value:k||A?t.Modality.State.Notified:t.Modality.State.Disconnected}),Z=g({value:k||M?t.Modality.State.Notified:t.Modality.State.Disconnected}),ee=g({value:k&&k.hasVideo()||O?t.Modality.State.Notified:t.Modality.State.Disconnected})
	o(W),k||A||(z=null),w=null
	var te,ne,ie=g({value:!1,get:function(){return x?x.muted.get():ie()},set:function(n){var i
	if(n){if(!(i=X)){var r=$||v.resolve()
	i=X=r.then((function(){return x.muted.set(n)})).then((function(){return n})),X.finally((function(){X=null}))}}else(i=$)||(r=X||v.resolve(),i=$=r.then((function(){return x.muted.set(n)})).then((function(){return n})),$.finally((function(){$=null})))
	return q&&q.monitor(i,e.TelemetryEvent.Call,{action:n?"muteAudio":"unmuteAudio",type:le()?"conf":"p2p",modalities:W.activeModalities.video()?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",callId:x[t.sInternal].callId}),i}}),re=g({value:!1,get:function(){return x.onHold.get()},set:function(n){var i
	if(n){if(!(i=te)){var r=ne||v.resolve()
	i=te=r.then((function(){return x.onHold.set(n)})).then((function(){return n})),te.finally((function(){te=null}))}}else(i=ne)||(r=te||v.resolve(),i=ne=r.then((function(){return x.onHold.set(n)})).then((function(){return n})),ne.finally((function(){ne=null})))
	return q&&q.monitor(i,e.TelemetryEvent.Call,{action:n?"hold":"resume",type:le()?"conf":"p2p",modalities:W.activeModalities.video()?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",callId:x[t.sInternal].callId}),i}}),oe=g({value:null}),ae=e.Media.isWebRtc()?function(){var e=g(),n=new t.WebRtcActiveSpeaker
	n.channel.isStarted=g({value:!1,set:h((function(e){return(e?x.showActiveSpeakerVideo():x.removeActiveSpeakerVideo()).then((function(){return e}))}),e)})
	var i=W.state.equalsAny(t.Conversation.State.Conferenced,t.Conversation.State.Conferencing),r={},o=g.numeric(0)
	function a(e){var i=n.participant()
	i&&i[t.sHref]==e[t.sHref]&&(n.channel.isStarted(!1),n.channel[t.sInternal].isVideoOn(!1),n[t.sInternal].participant(void 0))}return g.observe([ee,i,o],(function(i,r,o){var a=i==t.Modality.State.Connected&&r&&o>0
	!a&&n.channel.isStarted()&&n.channel.isStarted(!1),e(a),n.channel[t.sInternal].isVideoOn(a)})),D.added((function(e){r[e[t.sHref]]=e.video.channels(0).isVideoOn.changed((function(t,n,i){void 0!==i&&(t?o.inc():o.dec(),t||a(e))}))})),D.removed((function(e){var n=r[e[t.sHref]]
	n&&n.dispose(),delete r[e[t.sHref]],a(e)})),n}():void 0,se=g.readonly(e.Media.isWebRtc()?"ActiveSpeaker":"MultiView")
	function ce(e,t,n){var i=g()
	R[e]=h(r(n),i),J.changed((function(e){var n=l(t,(function(t){return c(t)?e==t[0]&&J.reason===t[1]:e==t}))
	i(n)}))}function le(){var e=K&&K.get("state","")
	return"Conferencing"==e||"Conferenced"==e}function ue(){I=z&&"audioVideoInvitation"==z.rel,A=z&&"onlineMeetingInvitation"==z.rel&&W.meeting&&"Notified"==W.meeting.state()&&(W.meeting.availableModalities.audio()||W.meeting.availableModalities.video()),M=(!B||0!=B.supportsAudio)&&A&&W.meeting.availableModalities.audio(),O=(!B||0!=B.supportsVideo)&&A&&W.meeting.availableModalities.video(),k=I&&t.AudioVideoInvitation({resource:z,ucwa:L,from:me(z)}),N=I&&z}function de(e){var n
	"success"==e?(n=x.muted(),_("AudioVideoModality("+Y+") escalation success: old AVS("+x[t.sInternal].callId+"), new AVS("+T[t.sInternal].callId+")"),x.state.changed.off(J),x.audioState.changed.off(Z),x.videoState.changed.off(ee),x._onSessionError&&(x._onSessionError.dispose(),x._onSessionError=null),x.stop(t.sEscalation),x=T,T._onSessionError&&(T._onSessionError.dispose(),T._onSessionError=null),T.escalated.off(de),x.state.changed(J),x.audioState.changed(Z),x.videoState.changed(ee),x._onSessionError=x.errorOccured((function(e){x.stop(e).finally((function(){return J(t.Modality.State.Disconnected)}))})),T=null,n&&x.muted(n)):"failure"==e?(_("AudioVideoModality("+Y+") escalation failure: old AVS("+x[t.sInternal].callId+"), new AVS("+T[t.sInternal].callId+")"),T.escalated.off(de),T._onSessionError&&(T._onSessionError.dispose(),T._onSessionError=null),T.stop(),T=null):o(!1)}function pe(e){var n=e.target.rel+" "+e.type,i=e.resource
	switch(n){case"conversation added":i.get("threadId")==W.threadId()&&(K=i)
	break
	case"conversation deleted":K&&K.href==e.target.href&&(K=null)
	break
	case"escalateAudio added":K&&e.sender.href==K.href&&_e({uri:e.target.href})
	break
	case"escalateAudioVideo added":K&&e.sender.href==K.href&&_e({uri:e.target.href,video:!0})
	break
	case"audioVideoInvitation completed":!x&&N&&N.href==i.href&&"Incoming"==i.get("direction")&&("Failure"==e.status&&J(t.Modality.State.Disconnected,e.reason),"Success"!=e.status||J()!=t.Modality.State.Notified||J.reason||J(t.Modality.State.Disconnected,"AcceptedByOtherInstance"))
	break
	case"audioVideoInvitation started":i.has("direction")&&"Incoming"==i.get("direction")&&(K=fe())&&K.href==i.link("conversation").href&&(N=i,k=t.AudioVideoInvitation({resource:i,ucwa:L,from:me(i)}),J(t.Modality.State.Notified),k.hasVideo()&&ee(t.Modality.State.Notified),Z(t.Modality.State.Notified))
	break
	case"onlineMeetingInvitation started":"Incoming"==i.get("direction","")&&(K=fe())&&K.href==i.link("conversation").href&&(z=i,ue(),J(t.Modality.State.Notified),O&&ee(t.Modality.State.Notified),M&&Z(t.Modality.State.Notified))
	break
	case"onlineMeetingInvitation completed":"Incoming"==i.get("direction","")&&(K=fe(),x||!K||K.href!=i.link("conversation").href||J()!=t.Modality.State.Notified||J.reason||("Success"==e.status?J(t.Modality.State.Disconnected,"AcceptedByOtherInstance"):e.reason&&"ConnectedElsewhere"==e.reason.subcode&&J(t.Modality.State.Disconnected,e.reason)))}}function fe(){var e=W[t.sHref]
	return e?L.get(e):null}function me(e){var i,r,o=n(D(),(function(n){return n[t.sHref]==e.link("from").href}))
	return o||(i=L.get(e.link("from").href),r=i.get("uri"),D.each((function(e){e.person.id()==r&&(o=e)}))),o}function he(){return e.Media.useBrowserMedia()?void 0:H&&H.mediaCapabilities.installedVersion()}function ve(){le()&&R.start.enabled()&&W.chatService.state()!=t.Modality.State.Disconnected&&W.meeting.state()==t.OnlineMeeting.State.Connected&&(W.activeModalities.video()&&ee()==t.Modality.State.Disconnected&&Z()!=t.Modality.State.Connected?(J(t.Modality.State.Notified,Q),ee(t.Modality.State.Notified),Z(t.Modality.State.Notified),k||(k={hasVideo:function(){return!0}})):W.activeModalities.audio()&&Z()==t.Modality.State.Disconnected&&(J(t.Modality.State.Notified,Q),Z(t.Modality.State.Notified),k||(k={hasVideo:function(){return!1}})))}function ge(e){if(e){if((e=!0===e?{direction:"sendrecv"}:e).direction||a(e,{direction:"sendrecv"}),e&&H&&0==H.cameras().length)if(W.isGroupConversation())switch(e.direction){case"sendonly":e.direction=""
	break
	case"inactive":break
	default:e.direction="recvonly"}else e.direction="recvonly"
	return e}}function ye(n){var i=x.showParticipantVideo(n)
	return q&&q.monitor(i,e.TelemetryEvent.Call,{action:"showParticipantVideo",isLocal:n[t.sInternal].isLocal(),type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),callId:x[t.sInternal].callId}),i}function be(n){var i=x.removeParticipantVideo(n)
	return q&&q.monitor(i,e.TelemetryEvent.Call,{action:"removeParticipantVideo",isLocal:n[t.sInternal].isLocal(),type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),callId:x[t.sInternal].callId}),i}function _e(n){var i
	return o(!T),o(le()),_("AudioVideoModality("+Y+")::startEscalation"),(T=new j({ucwa:L,mediaPlugin:G,devices:H,tm:q,localUri:V,conversation:W,rConversation:K,participants:D,selfParticipant:F,activeSpeaker:ae,escalateAudioVideoUri:n.uri,settings:B})).escalated(de),x.escalationState(1),T.preEscalationVideoConfig(x.preEscalationVideoConfig()),T._onSessionError=T.errorOccured((function(e){T.stop(e)})),n.video&&x.removeVideo(),i=T.start({remoteUri:S,audioConfig:4,mainVideoConfig:n.video?4:0,video:n.video}),q&&q.monitor(i,e.TelemetryEvent.Call,{action:"escalate",type:"conf",modalities:n.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),oldCallId:x[t.sInternal].callId,callId:T[t.sInternal].callId}),i}return ce("start",[t.Modality.State.Connected,[t.Modality.State.Notified,Q],t.Modality.State.Disconnected],(function(n){var r,o=W.isGroupConversation()
	S=(n=n||{}).to,_("AudioVideoModality("+Y+")::start",n)
	var a=void 0===n.context?void 0:u(n.context)?n.contextType||"text/plain":"text/json",s=u(n.context)?n.context:_stringify(n.context)
	return o||(S?i(0==D.size(),"ambiguous remote party in 1:1 call"):S=D(0).uri(),i(S,"the remote participant URI is not specified")),x||(C&&(_("AudioVideoModality("+Y+")::cleanup session:"+C[t.sInternal].callId),C.cleanup(),C=null),(x=new j({ucwa:L,mediaPlugin:G,devices:H,tm:q,localUri:V,context:s,contextType:a,invitation:k,rInvitation:z,conversation:W,rConversation:K,participants:D,selfParticipant:F,activeSpeaker:ae,settings:B,callId:n.callId,operationId:n.operationId,sessionContext:n.sessionContext})).state.changed(J),x.audioState.changed(Z),x.videoState.changed(ee),x._onSessionError=x.errorOccured((function(e){x.stop(e).finally((function(){return J(t.Modality.State.Disconnected)}))}))),r=f.wait(null).then((function(){if(W.meeting){if(W.meeting.state()==t.Modality.State.Created)return W.meeting.start({name:U&&U(),uri:W.uri()})}else if(o)return W.addMeeting().start({name:U&&U(),uri:W.uri()})})).then((function(){return H&&H.init().catch()})).then((function(){n.video=ge(n.video)
	var e=n.video&&t.MediaEnum.enumcastDirection(n.video.direction)
	return x.start({remoteUri:S,audioConfig:3,mainVideoConfig:e||0,video:n.video})})).then((function(){le()&&K.hasLink("addParticipant")&&W[t.sInternal].inviteParticipants()})),J()!==t.Modality.State.Notified&&q&&q.monitor(r,e.TelemetryEvent.Call,{action:"Disconnected"===Z()?"start":"addVideo",modalities:n.video?"av":"audio",type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),joinType:W.isGroupConversation()&&U&&U()?"anon":void 0,callId:x[t.sInternal].callId,contextType:a}),r})),ce("stop",[t.Modality.State.Connected,t.Modality.State.Connecting],(function(n){if(x){if(P)return P
	var i=[],r="stop",o=x[t.sInternal].callId
	if(_("AudioVideoModality("+Y+")::stop",n),J()==t.Modality.State.Connecting)P=x.stop()
	else if("video"==n)r="stopVideo",i.push(x.stop(n)),T&&i.push(T.stop(n)),P=f.waitAll(i)
	else{if(n)throw b("modality","must be omitted or contain `video`")
	i.push(x.stop()),T&&(T.escalated.off(de),i.push(T.stop())),P=f.waitAll(i).finally((function(){return J(t.Modality.State.Disconnected)}))}return q&&q.monitor(P,e.TelemetryEvent.Call,{action:r,type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),joinType:W.isGroupConversation()&&U&&U()?"anon":void 0,callId:o,callState:J()}),P.finally((function(){P=null})),P}})),ce("accept",[t.Modality.State.Notified],(function(n){var i
	if(n=n||{},J(t.Modality.State.Notified,Q),_("AudioVideoModality("+Y+")::accept",n),A)n.callId=s(),i=W.meeting.accept().then((function(){return R.start(n)}))
	else{if(W.meeting&&"Connected"==W.meeting.state())return R.start(n)
	o(!x),C&&(_("AudioVideoModality("+Y+")::cleanup session:"+C[t.sInternal].callId),C.cleanup(),C=null),(x=new j({ucwa:L,mediaPlugin:G,devices:H,tm:q,localUri:V,rAVInvitation:N,conversation:W,rConversation:K,participants:D,selfParticipant:F,activeSpeaker:ae,invitation:k,settings:B})).state.changed(J),x.audioState.changed(Z),x.videoState.changed(ee),x._onSessionError=x.errorOccured((function(e){x.stop(e).finally((function(){return J(t.Modality.State.Disconnected)}))})),i=(H?H.init().catch():v.resolve()).then((function(){return n.video=ge(n.video),x.accept(n)}))}return q&&q.monitor(i,e.TelemetryEvent.Call,{action:"accept",type:W.isGroupConversation()?"conf":"p2p",modalities:n.video?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),hasVideo:k.hasVideo?k.hasVideo():void 0,sdpCount:k.offers&&k.offers.length,callId:n.callId||x&&x[t.sInternal].callId}),i})),ce("decline",[t.Modality.State.Notified],(function(n){if(void 0===n&&(n="Global"),!W.meeting||"Connected"!=W.meeting.state()){var i=A?W.meeting.decline(n):k.decline(n)
	return _("AudioVideoModality("+Y+")::decline",w),i.then((function(){J(t.Modality.State.Disconnected)})),q&&q.monitor(i,e.TelemetryEvent.Call,{action:"decline",type:W.isGroupConversation()?"conf":"p2p",modalities:k.hasVideo()?"av":"audio",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),callId:x&&x[t.sInternal].callId}),i}J(t.Modality.State.Disconnected)})),ce("sendDtmf",[t.Modality.State.Connected],(function(n){if(d(n)){switch(n=(n=n.trim().toLowerCase()).substr(0,1).toUpperCase()+n.substr(1)){case"Star":n="*"
	break
	case"Pound":n="#"}if(void 0!==t.MediaEnum.DtmfTone[n]){var i=x.sendDtmf(n).then((function(e){return e||n}))
	return q&&q.monitor(i,e.TelemetryEvent.Call,{action:"sendDtmf",type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),callId:x[t.sInternal].callId}),i}}throw b("tone","out of range")})),ce("transfer",[t.Modality.State.Connected],(function(n){var i=L.get(W[t.sHref]),r=L.get(i.link("audioVideo").href),o=s(),a=L.send("POST",r.link("transfer").href,{revision:2,data:{to:n,operationId:o}}).then((function(){return L.wait({type:"completed",target:{rel:"transfer"},resource:function(e){return e.get("operationId",null)==o}}).then((function(e){if("Success"!=e.status)throw y("TransferFailed",{reason:e.reason})}))}))
	return q&&q.monitor(a,e.TelemetryEvent.Call,{action:"transfer",type:W.isGroupConversation()?"conf":"p2p",mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he(),callId:x[t.sInternal].callId}),a})),E("AudioVideoModality("+Y+")::state:",J),E("AudioVideoModality("+Y+")::audioState:",Z),E("AudioVideoModality("+Y+")::videoState:",ee),J.when(t.Modality.State.Disconnected,(function(e,n){n!=t.Modality.State.Disconnected&&function(e){var n=Y+(x?":"+x[t.sInternal].callId:"")
	_("AudioVideoModality("+n+")::reset",e),o(J()==t.Modality.State.Disconnected,"reset should be called with Disconnected state"),x&&(x.state.changed.off(J),x.audioState.changed.off(Z),x.videoState.changed.off(ee),x._onSessionError&&(x._onSessionError.dispose(),x._onSessionError=null),e&&"NotFound"==e.code?x.stop(e):C=x),Z(t.Modality.State.Disconnected,e),ee(t.Modality.State.Disconnected,e),!le()&&D(0)&&(D(0)[t.sInternal].audioState(t.Modality.State.Disconnected),D(0)[t.sInternal].videoState(t.Modality.State.Disconnected)),z=null,ue(),x&&x.isClean.once(!0,(function(){x=null}))}(e)})),W.state.when(t.Conversation.State.Disconnected,(function(e){e&&"NotFound"==e.code&&(K=null),J(t.Modality.State.Disconnected,e)})),W.activeModalities.audio.when(!0,ve),W.activeModalities.video.when(!0,ve),Z.when(t.Modality.State.Connected,(function(){oe(new e.Date),_("%c Call connected "+oe(),"color:green;font-weight:bold")})),Z.changed(F[t.sInternal].audioState),ee.changed(F[t.sInternal].videoState),a(R,{state:J.asReadOnly(),audioState:Z.asReadOnly(),videoState:ee.asReadOnly(),connectedAt:oe.asReadOnly(),videoMode:se,activeSpeaker:ae,muted:ie,onHold:re,showParticipantVideo:ye,removeParticipantVideo:be}),k&&(R.from=k.from,q&&q.record(e.TelemetryEvent.Call,{action:"audioVideoInvitation",type:W.isGroupConversation()?"conf":"p2p",hasVideo:k.hasVideo(),mediaType:e.Media.useBrowserMedia()?"pluginless":"plugin",pluginVersion:he()})),L.event(pe),_("AudioVideoModality("+Y+") created"),p(R,t.sInternal,{onParticipantDeleted:function(e){return x&&x[t.sInternal].onParticipantDeleted(e)}}),R}
	t.AudioVideoModality=w})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.guid,i=e.Utils.Model,r=e.Utils.Command,o=e.Utils.Promise,a=e.Utils.Property,s=e.Utils.DisabledAsyncCommand,c=function(e){var c=e.tm,l=e.ucwa,u=e.name,d=e.invitation,p=e.conversation,f=a.just(d?t.Modality.State.Notified:t.Modality.State.Disconnected)
	function m(){var e=p[t.sHref]
	if(!e)throw Error("rel=conversation does not exist yet")
	return l.get(l.get(e).link("phoneAudio").href)}function h(e,t){return c?c.monitored("pstn",{action:t})(e):e}return l.observe("phoneAudio updated",(function(e){var n=e.sender,i=e.resource
	n.href==p[t.sHref]&&"Disconnected"==i.get("state")&&f()==t.Modality.State.Connected&&f(t.Modality.State.Disconnected)})),i({state:f.asReadOnly(),start:r.async(h((function(e){f(t.Modality.State.Connecting)
	var i=n()
	return o.resolve().then((function(){return p.meeting&&p.meeting.state()==t.OnlineMeeting.State.Created?p.meeting.start({name:u(),uri:p.uri()}):p.isGroupConversation()&&!p.meeting?p.addMeeting().start({name:u(),uri:p.uri()}):void 0})).then((function(){var e
	return p[t.sHref]?((e=m().link("addPhoneAudio")).rel="addPhoneAudio",e):((e=l.get(l.app.relatedHref("communication")).link("startPhoneAudio")).rel="startPhoneAudio",e)})).then((function(t){return l.send("POST",t.href,{data:{operationId:i,threadId:p.threadId(),phoneNumber:e&&e.teluri||p.selfParticipant.person.workPhone(),to:p.isGroupConversation()||"addPhoneAudio"==t.rel?void 0:p.participants(0).person.id()}})})).then((function(){return l.wait({type:"completed",target:{rel:"phoneAudioInvitation"},resource:function(e){return e.get("operationId",null)==i}}).then((function(e){if("Success"!=e.status)throw t.EInvitationFailed(e.reason)}))})).then((function(){f(t.Modality.State.Connected)}),(function(e){throw f(t.Modality.State.Disconnected,e),e}))}),"start"),f.equals(t.Modality.State.Disconnected)),stop:r.async(h((function(){return f(t.Modality.State.Disconnecting),o.resolve().then((function(){var e=m().link("stopPhoneAudio").href
	return l.send("POST",e)})).then((function(){f(t.Modality.State.Disconnected)}),(function(e){throw f(t.Modality.State.Disconnected,e),e}))}),"stop"),f.equals(t.Modality.State.Connected)),accept:s(),reject:r.async(h((function(e){return void 0===e&&(e="Global"),f(t.Modality.State.Disconnecting),o.resolve().then((function(){var t=d.link("decline").href
	return l.send("POST",t,{data:{reason:e}})})).then((function(){f(t.Modality.State.Disconnected)}),(function(e){throw f(t.Modality.State.Disconnected,e),e}))}),"reject"),f.equals(t.Modality.State.Notified))})}
	t.PhoneAudio=c})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){(function(e){var t=function(t,n){return e.ObservableResource(t,n,(function(e){e.property("conferenceId"),e.property("externalDirectoryUri"),e.property("internalDirectoryUri"),e.property("isAudioConferenceProviderEnabled"),e.property("participantPassCode"),e.property("tollNumber"),e.property("tollFreeNumbers"),e.member("defaultRegion",(function(e){e.property("name"),e.property("number"),e.property("languages")}))}))}
	e.PhoneDialInInformation=t})(e.Internal||(e.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.guid,i=e.Utils.assert,r=e.Utils.extend
	function o(e,t){var n,i="\r\n"
	for(n=0;n<e.length;++n)i+=a(e[n],t)
	return i+="\r\n--"+t+"--\r\n"}function a(e,t){return i(e&&e.sdp&&e.id&&t),"\r\n--"+t+"\r\nContent-Type: application/sdp\r\nContent-ID: "+e.id+"\r\nContent-Length: "+e.sdp.length+"\r\n\r\n"+e.sdp}t.multipartJsonAndSDP=function(e){var t,i,a,s=e.offers,c=e.boundary,l=e.subject,u=e.importance,d=e.operationId,p=e.threadId,f=e.sessionContext||n(),m=e.context,h=e.contextType,v="D63E5F1E-56D8-4EC4-B51B-02762CEA97D9",g="4EFFF0D8-65D2-4E52-9A1B-0FA835D4B478",y="2CAE7DF5 -0185-4FB8-84E7-AA6C57F10432",b="--"+c+"\r\n",_=b
	return t={operationId:d,threadId:p,subject:l,importance:u,sessionContext:f,mediaOffer:"cid:"+g},void 0!==m&&r(t,{customContent:"cid:"+y}),e.to?t.to=e.to:(t.telemetryId=n(),t.joinAudioMuted=!1,t.joinVideoMuted=!1),_+="Content-Type: application/vnd.microsoft.com.ucwa+json\r\nContent-Length: "+(i=_stringify(t)).length+"\r\n\r\n"+i+"\r\n",_+=b,_+="Content-ID: "+g+"\r\nContent-Type: multipart/alternative;boundary="+v+';type="application/sdp"\r\nContent-Length: '+(a=o(s,v)).length+"\r\n"+a,void 0!==m&&(_+="\r\n",_+=b,_+="Content-ID: "+y+"\r\nContent-Type:"+h+"\r\nContent-Disposition: render; handling=optional\r\n\r\n"+m),_+"\r\n--"+c+"--\r\n"},t.multipartSDP=o})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.async,i=e.Utils.assert,r=e.Utils.extend,o=e.Utils.Event,a=e.Utils.Property,s=e.Media.log,c=e.Media.PluginComponent,l=function(e){var l=e.channelId,u=e.mediaPlugin,d=e.container||a(),p=a({value:c.State.Unloaded}),f=new o,m=null,h=null,v=new t.VideoChannel({name:"local"})
	function g(e){"VIDEO_SIZE_CHANGED"==e.type&&f.fire({width:e.args[0],height:e.args[1]})}function y(e){if(i("GetRenderWindow"==e),m){var t=m.invoke(e)
	if(t.succeeded)return t[1]}return null}function b(e){s("Video channel "+l+" "+m.id()+" pcVideoUI.state = "+e),e==c.State.Unloading&&(e=c.State.Unloaded),p(e)}return{container:d,channelId:function(e){return 0==arguments.length?l:(l=e,this)},createVideoWindow:n((function(e){return i(!m),e=e||d(),i(e),(m=u.createComponent({type:"VideoUI",hide:!1})).state.changed(b),m.event(g,"async"),m.setContainer(e),m.load().then((function(){m.invoke("CreateVideoUI",!1),h=y("GetRenderWindow")}))})),destroyVideoWindow:function(){m&&(m.invoke("DestroyVideoWindows"),m.unload(),m.event.off(g),m.state.changed.off(b),p(c.State.Unloaded),m=null,h=null)},videoWindow:function(){return h=h||y("GetRenderWindow")},resizeVideoWindow:function(e){void 0===e&&(e=d()),i(e),m.invoke("ResizeWindow",e.clientWidth,e.clientHeight)},videoWindowState:p.asReadOnly(),resized:f.observer,channel:r(v,{isStarted:a({value:!1,set:function(e){return d.set(e?v.stream.source.sink.container():null).then((function(){return e}))}})})}}
	t.LocalVideoChannel=l})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.async,i=e.Utils.check,r=e.Utils.assert,o=e.Utils.foreach,a=e.Utils.Model,s=e.Utils.Property,c=e.Utils.Collection,l=e.Utils.ConstProperty,u=e.Media.PluginManager,d=function(d){var p,f,m=d.mediaPlugin,h=d.msi,v=d.pkg,g=d.dmg,y=d.tm,b=null,_=u.State.Uninitialized,E=c({subscribed:P,get:P}),w=c({subscribed:P,get:P}),S=c({subscribed:P,get:P}),x=s({set:function(e){return U(C(),e),e}}),C=s({set:function(e){return U(e,x()),e}}),T=s({set:function(e){return e&&b.invoke("SetSelectedVideoDevice",e.id()),e}}),I=s({value:!!e.Media.useBrowserMedia()}),A=c()
	h&&A.add(h,"msi"),v&&A.add(v,"pkg"),g&&A.add(g,"dmg")
	var M=s.bool(!0),O=s.bool(!0),k={isPluginInstalled:u().isPluginInstalled,installedVersion:u().installedVersion,isBrowserMediaSupported:I.asReadOnly(),pluginDownloadLinks:A.size()?A.asReadOnly():u().pluginDownloadLinks,isMicrophoneEnabled:M.asReadOnly(),isCameraEnabled:O.asReadOnly()},N=new t.LocalVideoChannel({mediaPlugin:m,container:s({value:null,set:function(e){return _==u.State.Initialized||e?P().then((function(){if(!N.videoWindow()&&e)return N.createVideoWindow(e)})).then((function(){return e?(i(T(),"No video camera"),b.invoke("StartVideoPreview",N.videoWindow(),T().name()),N.resized(D)):(b.invoke("StopVideoPreview"),N.destroyVideoWindow(),N.resized.off(D)),e})):(r(null===this()),this())}})})
	function P(){return y&&y.record(e.TelemetryEvent.DevicesInit,{action:"init",state:_}),p=p||u().state.changed((function(e,t,n){e==u.State.Uninitialized&&R()})),_==u.State.Uninitialized&&(_=u.State.Initializing,f=m.initMedia().then((function(){return(b=m.createComponent({type:"TuningWizard",hide:!0})).event(L,"async"),b.load().then((function(){F(b.invoke("GetAudioRenderDevicesDescription")),B(b.invoke("GetAudioCaptureDevicesDescription")),V(b.invoke("GetVideoDevicesDescription")),_=u.State.Initialized}))})).catch((function(t){y&&y.record(e.TelemetryEvent.DevicesInit,{action:"initDevicesMgrFailed",state:_,reason:t}),R()})),y&&y.monitor(f,e.TelemetryEvent.DevicesInit,{action:"initDevicesMgr",state:_})),f}function R(){b&&(b.event.off(L),b=null),p&&(p.dispose(),p=null),N.destroyVideoWindow(),N.resized.off(D),_=u.State.Uninitialized}function L(e){_==u.State.Initialized&&("AUDIO_DEVICES_CHANGED"==e.type?(F(b.invoke("GetAudioRenderDevicesDescription")),B(b.invoke("GetAudioCaptureDevicesDescription"))):"VIDEO_DEVICES_CHANGED"==e.type&&V(b.invoke("GetVideoDevicesDescription")))}function D(e){b.invoke("ResizeWindow",N.videoWindow(),e.width,e.height)}function U(e,t){e&&t&&b.invoke("SetSelectedAudioDevices",e.id(),t.id())}function F(e){r(e.succeeded)
	var t,n,i,o=[]
	for(t=1;t<e.length-1;t++)i=a({id:l(e[t]),name:l(e[t]),type:l("Speaker")}),o.push(i)
	n=o[e[e.length-1]],G(w,o),C(n||null,s.sUpdated)}function B(e){r(e.succeeded)
	var t,n,i,o=[]
	for(t=1;t<e.length-1;t++)i=a({id:l(e[t]),name:l(e[t]),type:l("Microphone")}),o.push(i)
	n=o[e[e.length-1]],G(E,o),x(n||null,s.sUpdated)}function V(e){r(e.succeeded)
	var t,n,i,o=[]
	for(t=1;t<e.length-1;t++)i=a({id:l(e[t]),name:l(e[t]),type:l("Camera"),localVideoChannel:N.channel}),o.push(i)
	n=o[e[e.length-1]],G(S,o),T(n||null,s.sUpdated)}function G(e,t){var n=[]
	e.each((function(e,i){var r,o=!1
	for(r=0;r<t.length;r++)if(e.id()==t[r].id()){o=!0,t.splice(r,1)
	break}o||n.push(i)})),o(n,(function(t){e.remove(t)})),o(t,(function(t){e.add(t)}))}return a({init:n(P),uninit:n(R),speakers:w.asReadOnly(),microphones:E.asReadOnly(),cameras:S.asReadOnly(),selectedSpeaker:C,selectedMicrophone:x,selectedCamera:T,mediaCapabilities:k,localVideoChannel:N.channel})}
	t.PluginDevicesManager=d})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.Model,i=e.Utils.Property,r=e.Utils.SourcedModel,o=e.Utils.ConstProperty,a=e.Utils.setHiddenProperty,s=e.Media.log,c=function(c){void 0===c&&(c={})
	var l=c.name,u=c.isLocal,d=i(),p=i(),f=i({value:!1}),m=e.Media.useBrowserMedia()?u?new t.WebRtcLocalMediaStream:new t.WebRtcRemoteMediaStream:new t.MediaStream,h=r(m),v=n({camera:o("unknown"),stream:h,isStarted:d,isVideoOn:f.asReadOnly(),isOnHold:p})
	return h.setSource(m),h.state.changed((function(n,i,r){if(s("VideoChannel "+l+" (): stream state: %c"+r+" -> "+n,"color:green;font-weight:bold","Reason: ",i),e.Media.useBrowserMedia()){switch(n){case t.MediaEnum.StreamState.Active:v.isStarted._set(!0)
	break
	case t.MediaEnum.StreamState.Stopped:v.isStarted._set(!1)}u&&f(n==t.MediaEnum.StreamState.Active||n==t.MediaEnum.StreamState.Inactive)}})),a(v,t.sInternal,{isVideoOn:f}),v}
	t.VideoChannel=c})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.async,i=e.Utils.assert,r=e.Utils.Model,o=e.Utils.Command,a=e.Utils.Property,s=e.Utils.EnabledCommand,c=e.Utils.EInvalidArgument,l=e.Media.log,u=e.Media.PluginComponent,d=function(e){void 0===e&&(e={})
	var d=e.mediaPlugin,p=a({value:u.State.Unloaded}),f=a({value:e.container,set:o((function(e){return e}),p.equalsAny(u.State.Unloaded,u.State.Loaded))}),m=a({value:t.MediaEnum.VideoFormat.Fit,set:o((function(e){return e}),p.equalsAny(u.State.Unloaded,u.State.Loaded)),check:function(e){if(!(e in t.MediaEnum.VideoFormat))throw c("format","`format` value is Fit, Crop or Stretch.")}}),h=a({value:{}}),v=a(),g=null
	function y(){g.event.off(b),g.state.changed.off(_),p(u.State.Unloaded),g=null,v(null)}function b(e){"VIDEO_SIZE_CHANGED"==e.type&&h({width:e.args[0],height:e.args[1]})}function _(e){l("Video sink "+g.id()+" pcVideoUI.state = "+e),e==u.State.Unloading&&(e=u.State.Unloaded),e===u.State.Unloaded&&p()!==u.State.Unloaded&&g?y():p(e)}return e=null,r({container:f,format:m,_format:m.map((function(e){return{Fit:0,Crop:1,Stretch:2}[e]})),_init:s(n((function(){return i(!g),i(f()),(g=d.createComponent({type:"VideoUI",hide:!1})).state.changed(_),g.event(b,"async"),g.setContainer(f()),g.load().then((function(){var e
	g.invoke("CreateVideoUI",!1),e=g.invoke("GetRenderWindow"),v(e[1])}))}))),_uninit:s((function(){g&&(g.invoke("DestroyVideoWindows"),g.unload(),g&&y())})),_resize:s((function(){i(f()),g.invoke("ResizeWindow",f().clientWidth,f().clientHeight)})),_videoWindow:v.asReadOnly(),_state:p.asReadOnly(),_size:h.asReadOnly(),_c:a({value:null}),_f:a({value:null})})}
	t.VideoSink=d})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.setHiddenProperty,i=e.Utils.Model,r=e.Utils.Property,o=e.Utils.BoolProperty,a=e.Media.log,s=function(e){void 0===e&&(e={})
	var s=r({value:t.MediaEnum.StreamState.Stopped}),c=i({sink:new t.VideoSink(e)}),l=r({value:0}),u=r({value:0}),d=o(!1),p=r({value:e.id}),f=r({value:!1}),m=i({state:s.asReadOnly(),source:c,width:l.asReadOnly(),height:u.asReadOnly(),_id:p,_isAttached:f})
	return n(m,"_state",s),n(m,"_isFlowing",d),n(m,"_setResolution",(function(e,t){})),s.changed((function(e,t,n){a("MediaStream ("+p()+"): stream state: %c"+n+" -> "+e,"color:green;font-weight:bold","Reason: ",t)})),m}
	t.MediaStream=s})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){(function(t){var n=e.Utils.Enum,i=e.Utils.StringEnum
	t.PreferredMediaAddressType=n("None","Direct","Relay"),t.MediaDeviceType=n("MIC","SPEAKER","PREVIEW","RENDER"),t.VideoFormat=i("Fit","Crop","Stretch"),t.NegotiationStatus=n("NS_SUCCESS","NS_LOCAL_INTERNAL_ERROR","NS_REMOTE_INTERNAL_ERROR","NS_OFFER_NOT_ACCEPTABLE","NS_OFFER_DECLINED","NS_LOCAL_CANCEL","NS_REMOTE_CANCEL","NS_REMOTE_MIME_UNSPPORTED"),t.MediaEvent=i("OFFER_READY","CHANNEL_CREATED","CHANNEL_DELETED","ANSWER_READY","CONNECTIVITY_CHECK_STATUS","MEDIA_CHANGED","INVALID_PROXY_CREDENTIAL"),t.AVEvent=i("DEVICE_INTENSITY_CHANGED","VIDEO_SIZE_CHANGED","NEG_STATUS","CHANNEL_DIRECTION_CHANGED","CHANNEL_DISCONNECTED","QUALITY_CHANGED","AUDIO_DEVICE_CHANGED","VIDEO_DEVICE_CHANGED","DOMINANT_SPEKAER_CHANGED","SUBSCRIPTION_STATE_CHANGED","CONTRIBUTING_SOURCES_CHANGED","VIDEO_CAPABILITY_CHANGED"),t.StreamState=i("Stopped","Started","Inactive","Active"),t.StreamType=n("Preview","MainRender","Render"),t.DtmfTone=n("0","1","2","3","4","5","6","7","8","9","*","#","A","B","C","D","Flash","Star","Pound"),t.enumcastDirection=function(e){var t
	return function(e){e[e[""]=0]="",e[e.sendonly=1]="sendonly",e[e.recvonly=2]="recvonly",e[e.sendrecv=3]="sendrecv",e[e.inactive=4]="inactive"}(t||(t={})),t[e]},t.enumcastMediaConfig=function(e){return["","sendonly","recvonly","sendrecv","inactive"][e]},t.enumcastStreamState=function(e){var n,i=t.StreamState
	switch(e){case 1:n=i.Started
	break
	case 2:n=i.Active
	break
	case 3:n=i.Inactive
	break
	case 4:n=i.Stopped}return n}})(t.MediaEnum||(t.MediaEnum={}))})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.setHiddenProperty,i=e.Utils.Task,r=e.Utils.Model,o=e.Utils.Symbol,a=e.Utils.Promise,s=e.Utils.Command,c=e.Utils.Property,l=e.Media.log,u=o("tmpStopped"),d=function(e){void 0===e&&(e={})
	var n=c({value:e.container}),i=c({value:t.MediaEnum.VideoFormat.Fit,set:function(e){return t.MediaEnum.VideoFormat.Fit}})
	return r({container:n,format:i,_c:c({value:null})})}
	t.LetterboxedVideoSink=d
	var p=function(e){void 0===e&&(e={})
	var o,p=c({value:t.MediaEnum.StreamState.Stopped}),f=r({sink:new d}),m=c({value:0}),h=c({value:0}),v=c({value:e.mediaSession}),g=c({value:-2}),y=c({value:!1}),b=c({value:!1,set:s((function(e,n){if(_=!1,e){if(!f.sink.container()||-1===g())return _=!0,a.resolve(!e)
	var r=(o=o||v().createRemoteRenderer(f.sink.container(),w)).getVideoElement()
	return r.style.width="100%",r.style.height="100%",i.run((function(){var e=o.subscribeVideoAsync(g())
	return p()==t.MediaEnum.StreamState.Stopped&&p(t.MediaEnum.StreamState.Started),e})).then((function(){return p()!=t.MediaEnum.StreamState.Active&&p(t.MediaEnum.StreamState.Inactive),e})).catch((function(n){return p(t.MediaEnum.StreamState.Stopped,n),!e}))}return o&&o.dispose(),o=null,p(n===u?t.MediaEnum.StreamState.Inactive:t.MediaEnum.StreamState.Stopped),a.resolve(e)}),v.map((function(e){return!!e})))}),_=!1,E=r({state:p.asReadOnly(),source:f,width:m.asReadOnly(),height:h.asReadOnly(),_id:g,_isRendering:b,_isAttached:y}),w={onVideoSizeChanged:function(e,n){l("WebRtcRemoteMediaStream: onVideoSizeChanged "+e+" X "+n),e&&n&&p(t.MediaEnum.StreamState.Active),m(e),h(n)}}
	function S(e){return function(t,n,i){if(b()||_){var r=e(i)?b.set(!1,u):a.resolve(!1)
	e(t)?r.then((function(){return b.set(!0)})):r.then((function(){return _=!0}))}}}return n(E,"_state",p),n(E,"_mediaSession",v),p.changed((function(e,t,n){l("MediaStream ("+g()+"): stream state: %c"+n+" -> "+e,"color:green;font-weight:bold","Reason: ",t)})),g.changed(S((function(e){return e>0}))),f.sink.container.changed(S((function(e){return!!e}))),E}
	t.WebRtcRemoteMediaStream=p
	var f=function(e){void 0===e&&(e={})
	var o,p=c({value:t.MediaEnum.StreamState.Stopped}),f=r({sink:new d}),m=c({value:0}),h=c({value:0}),v=c({value:e.deviceManager}),g=c({value:e.deviceId}),y=c({value:!1}),b=c({value:!1,set:s((function(e,n){if(_=!1,e){if(!f.sink.container())return _=!0,a.resolve(!e)
	var r=(o=o||v().createPreviewRenderer(f.sink.container(),w)).getVideoElement()
	return r.style.width="100%",r.style.height="100%",i.run((function(){var e=o.startVideoAsync()
	return p()==t.MediaEnum.StreamState.Stopped&&p(t.MediaEnum.StreamState.Started),e})).then((function(){return p()!=t.MediaEnum.StreamState.Active&&p(t.MediaEnum.StreamState.Inactive),e})).catch((function(n){return p(t.MediaEnum.StreamState.Stopped,n),!e}))}return o&&o.dispose(),o=null,p(n===u?t.MediaEnum.StreamState.Inactive:t.MediaEnum.StreamState.Stopped),a.resolve(e)}),v.map((function(e){return!!e})))}),_=!1,E=r({state:p.asReadOnly(),source:f,width:m.asReadOnly(),height:h.asReadOnly(),_id:g,_isRendering:b,_isAttached:y}),w={onVideoSizeChanged:function(e,n){l("WebRtcLocalMediaStream: onVideoSizeChanged "+e+" X "+n),e&&n&&p(t.MediaEnum.StreamState.Active),m(e),h(n)}}
	return n(E,"_state",p),n(E,"_deviceManager",v),p.changed((function(e,t,n){l("MediaStream ("+g()+"): stream state: %c"+n+" -> "+e,"color:green;font-weight:bold","Reason: ",t)})),f.sink.container.changed((function(e,t,n){if(b()||_){var i=n?b.set(!1,u):a.resolve(!1)
	e?i.then((function(){return b.set(!0)})):i.then((function(){return _=!0}))}})),E}
	t.WebRtcLocalMediaStream=f})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.assert,i=e.Utils.Model,r=e.Utils.Property,o=e.Media.log,a=function(e){var a=e.devicesManager,s=e.parentDevice,c=r({value:s.name()||s.id()}),l=r({value:!1,set:function(e){if(e){var t=a.selectedCamera()
	if(t&&t.id()!=s.id()){var i=a.cameras.filter((function(e){return e.id()==s.id()}))
	n(1==i.size()),a.selectedCamera(i(0))}d._deviceManager(a._dm())}return d._isRendering.set(e)}}),u=r(),d=new t.WebRtcLocalMediaStream({deviceId:s.id()}),p=i({camera:c.asReadOnly(),stream:d,isStarted:l,isVideoOn:l.asReadOnly(),isOnHold:u})
	return n(a),d.state.changed((function(e,t,n){o("VideoChannel "+c()+" ("+d._id()+"): stream state: %c"+n+" -> "+e,"color:green;font-weight:bold","Reason: ",t)})),p}
	t.WebRtcLocalVideoChannel=a})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.find,i=e.Utils.async,r=e.Utils.inherit,o=e.Utils.foreach,a=e.Utils.Task,s=e.Utils.Model,c=e.Utils.Promise,l=e.Utils.Property,u=e.Utils.Collection,d=e.Utils.ConstProperty,p=e.Utils.setHiddenProperty,f=e.Media.log,m=function(e,t){var n,i=l({value:e.label})
	return t.then((function(e){return i(e)})),s({id:d(e.id),name:i.asReadOnly(),type:d((n=e.kind,n[0].toUpperCase()+n.substr(1).toLowerCase()))})}
	t.WebRtcDevice=m
	var h=function(h){var v,g,y,b,_=u({subscribed:U,get:U}),E=u({subscribed:U,get:U}),w=u({subscribed:U,get:U}),S=l({set:function(e){return F(e,x()),e}}),x=l({set:function(e){return F(S(),e),e}}),C=d({id:d("default_speaker"),name:d("Default Speaker"),type:d("Speaker"),readOnly:!0})
	E.add(s({id:d("default_speaker"),name:d("Default Speaker"),type:d("Speaker")}))
	var T,I=l(),A=l(),M=l({value:!!e.Media.useBrowserMedia()}),O=l({value:void 0,reason:"NotNeeded"}),k=l({value:void 0,reason:"NotNeeded"}),N=l.bool(!1),P=l.bool(!1),R=u(),L={isBrowserMediaSupported:M.asReadOnly(),isPluginInstalled:O.asReadOnly(),installedVersion:k.asReadOnly(),pluginDownloadLinks:R.asReadOnly(),isMicrophoneEnabled:N.asReadOnly(),isCameraEnabled:P.asReadOnly()},D=l()
	function U(){if(!v)return v=e.Media.getMediaAgent(h),g=v.getDeviceManager(),D(g),y||(y=v.devicesChanged((function(e){return B(e)}))),b||(b=v.permissionsChanged((function(e){e&&N(e.hasMicrophonePermission),e&&P(e.hasCameraPermission)}))),c.resolve().then((function(){return g.getDefaultDevices()})).then((function(e){var t=n(e,(function(e){return"microphone"==e.kind})),i=n(e,(function(e){return"camera"==e.kind}))
	if(!t||!i)throw"No default device found"
	var r=t.id,o=i.id
	g.selectDevices({microphone:r,camera:o}),"default"!=r&&"default_audio_device"!=r&&I(r),"default"!=o&&"default_video_device"!=o&&A(o)})).catch((function(e){return f("Cannot get device ID from track!",e)})).then((function(){return g.enumerateDevicesAsync()})).then((function(e){return B(e)})).then((function(){}))}function F(e,t){e&&t&&(g.selectDevices({microphone:e.id(),camera:t.id()}),I(e.id()),A(t.id()))}function B(e){for(var n=[],i=[],o=[],s=function(e){var s=a.run((function(){return g.getDeviceNameAsync(e.id)})),c=new m(e,s)
	if(o.push(s),"Camera"==c.type()&&"default_video_device"!=c.id()&&"default"!=c.id()){var l=r(c,{localVideoChannel:new t.WebRtcLocalVideoChannel({devicesManager:T,parentDevice:c})})
	i.push(l)}else"Microphone"==c.type()&&"communications"!=c.id()&&"default_audio_device"!=c.id()&&"default"!=c.id()&&n.push(c)},l=0,u=e;l<u.length;l++)s(u[l])
	return c.all(o).then((function(){G(_,n),G(w,i),V(_,S,I),V(w,x,A)}))}function V(e,t,n){var i
	n()?(e.each((function(e,t){e.id()==n()&&(i=e)})),i?t()&&t().id()==i.id()||t(i,l.sUpdated):(t(void 0,l.sUpdated),n(void 0))):1==e.size()&&(t(e(0),l.sUpdated),n(e(0).id()))}function G(e,t){var n=[]
	e.each((function(e,i){for(var r=!1,o=0;o<t.length;o++)if(e.id()==t[o].id()){r=!0,t.splice(o,1)
	break}r||n.push(i)})),o(n,(function(t){return e.remove(t)})),o(t,(function(t){return e.add(t)}))}return T=s({init:i(U),uninit:i((function(){for(var e=0,t=w();e<t.length;e++)t[e].localVideoChannel.isStarted(!1)
	return y&&(y.dispose(),y=null),b&&(b.dispose(),b=null),v=null,g=null,D.set(null)})),speakers:E.asReadOnly(),microphones:_.asReadOnly(),cameras:w.asReadOnly(),selectedSpeaker:C,selectedMicrophone:S,selectedCamera:x,mediaCapabilities:L}),p(T,"_dm",D),T}
	t.WebRtcDevicesManager=h})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.foreach,i=e.Utils.batched,r=e.Utils.deepEqual,o=e.Utils.isArray,a=e.Utils.isFunction,s=e.Utils.isProperty,c=e.Utils.setHiddenProperty,l=e.Utils.Model,u=e.Utils.Symbol,d=e.Utils.Command,p=e.Utils.Property,f=e.Utils.Exception,m=e.Utils.Collection,h=e.Utils.ConstProperty,v=e.Utils.ENotSupported,g=e.Stack.Resource,y=u("updated"),b=u("hidden"),_=function e(t){var n=this
	this.properties={},this.commands={},this.collections={},this.members={},t({member:function(t,i){n.members[t]=new e(i)},command:function(e){n.commands[e]={}},property:function(e,t){n.properties[e]=t||{}},collection:function(t,i){n.collections[t]=o(i)?i[0]:new e(i)}})}
	t.ObservableResource=function e(o,u,E){var w,S=l(),x={},C={},T={},I={},A=p({value:!1,reason:f("Disconnected")}),M=a(E)?new _(E):E,O=p({value:null,get:function(){return O()||o.init().then((function(){return s(u)?u.get():u})).then((function(e){return o.get(e)}))}}),k=i((function(e){for(var t=O(),i=t.getSnapshot(),a={},s=!1,c=0,l=e;c<l.length;c++){var u=l[c],d=u[0],p=u[1],f=C[d][b],m=i[d],h=f.convert?f.convert(p):p
	r(h,m)||(s=!0,i[d]=h)}if(s)return n(i,(function(e,t){var n=C[t],i=n&&n[b]
	a[t]=i&&i.prepare?i.prepare(i.parse(e)):e})),o.send("PUT",t.href,{data:a})}),1/0)
	function N(){var e=w||O.get().then((function(e){return o.send("GET",e.href)}))
	return(w=e).then(null,(function(){w=null})),e}return n(M.collections,(function(e,t){var n=m({subscribed:N,get:function(){return O.get().then((function(e){return N()})).then((function(e){return null}))}})
	n[b]=e,x[t]=n,S[t]=n.asReadOnly()})),n(M.properties,(function(e,t){var n=a(e)?{parse:e}:e
	n.parse||(n.parse=function(e){return e})
	var i=p({subscribed:N,get:function(){return O.get().then((function(e){return e.has(t)?i():N().then((function(){return i()}))}))}})
	i[b]=n,C[t]=i
	var r=n.readOnly?h(!1):n.canInit?p.computed([O,A],(function(e,t){return!e||t})):A
	S[t]=i.fork(d((function(e){return O()?O.get().then((function(n){return k([t,e],0)})).then((function(){return i()})):e}),r))})),n(M.commands,(function(e,t){var n=p({get:function(){return O.get().then((function(e){return!e.hasLink(t)&&N()})).then((function(e){return e.hasLink(t)}))}})
	T[t]={enabled:n},S[t]=d((function(){throw v()}),n.asReadOnly())})),n(M.members,(function(t,n){var i=p({get:function(){return i()||N().then((function(e){return e.link(n).href}))}})
	I[n]=i,S[n]=e(o,i.asReadOnly(),t)})),o.init().then((function(){u instanceof g?O(u):s(u)?u.changed((function(e){return O(o.get(e))})):o.exists(u)&&O(o.get(u))})),O.once((function(e){return!!e}),(function(){var i=O()
	c(S,t.sHref,i.href),i.updated((function(){A(i.has("etag"),f("ETagMissing")),n(x,(function(t,n){for(var r=0,s=i.links(n);r<s.length;r++){var c=s[r]
	if(!t(c.href)){var l=t[b],u=a(l)?l(c.href):e(o,c.href,l)
	t.add(u,c.href)}}})),n(C,(function(e,t){var n=e[b].parse
	e(i.has(t)?n(i.get(t)):void 0,y)})),n(T,(function(e,t){e.enabled(i.hasLink(t))})),n(I,(function(e,t){i.hasLink(t)&&e(i.link(t).href)}))})),i.dirty.when(!0,(function(){w=null}))})),S}})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){e.Internal||(e.Internal={})})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(e){(function(e){var t=function(t){return e.ObservableResource(t,{rel:"policies"},(function(e){e.property("audioOnlyOnWifi"),e.property("callLogArchiving"),e.property("customerExperienceImprovementProgram"),e.property("emergencyDialMask"),e.property("emergencyDialString"),e.property("emoticons"),e.property("clientExchangeConnectivity"),e.property("exchangeUnifiedMessaging"),e.property("htmlMessaging"),e.property("logging"),e.property("loggingLevel"),e.property("messageArchiving"),e.property("messagingUrls"),e.property("multiViewJoin"),e.property("onlineFeedbackUrl"),e.property("photos"),e.property("saveCallLogs"),e.property("saveCredentials"),e.property("saveMessagingHistory"),e.property("sendFeedbackUrl"),e.property("sharingOnlyOnWifi"),e.property("softwareQualityMetrics"),e.property("telephonyMode"),e.property("videoOnlyOnWifi"),e.property("voicemailUri"),e.property("showNotification"),e.property("redirectClient"),e.property("chatDefaultClient"),e.property("callingDefaultClient")}))}
	e.GeneralPolicies=t})(e.Internal||(e.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.Model,i=e.Utils.Command,r=e.Utils.EnabledCommand,o=e.Utils.Task,a=e.Utils.Property,s=e.Utils.BoolProperty,c=e.Utils.ConstProperty,l=e.Utils.Promise,u=e.Utils.Collection,d=e.Utils.StringEnum,p=e.Utils.map,f=e.Utils.sha256Hash,m=e.Utils.isVoid,h=e.Utils.isNotEmptyString,v=e.Utils.foreach,g=e.Utils.extend,y=e.Utils.async,b=e.Utils.bind,_=e.Utils.EInvalidArgument,E=function(){var e=d("AddressBook","SkypeDirectory","All"),t=a({value:1,check:function(e){if(!(e>0&&(0|e)==e))throw _("limit","`limit` must be a positive integer")}}),i=a({check:function(e){if(!h(e))throw _("text","`text` must be set as a no empty query string before searching.")}}),r=a({value:e.AddressBook,check:function(t){if(!(t in e))throw _("sources","`sources` must be set as AddressBook, SkypeDirectory, or All.")}})
	return n({text:i,limit:t,sources:r})}
	t.SearchQuery=E
	var w=function(r){var o=r.ucwa,d=r.type,p=r.remoteOnly,m=r.contactmgr,h=r.me,b=new E,_=u(),w=u(),S=u(),x=a({value:!1}),C=s(!0),T=r.tm,I=!!r.settings&&r.settings.emailSearchUsesCache
	return _.add("id"),g(b,{supportedKeywords:_.asReadOnly(),keywords:w,moreResultsAvailable:x.asReadOnly(),getMore:i(y((function(){var i=o.get({rel:"people"}).link("search"),r=w.id||b.text()&&"id:"==b.text().slice(0,3).toLowerCase()&&b.text().slice(3),a={},s=[]
	function u(e){var t=n({result:e,matches:{},relevance:c(null)})
	S.add(t),s.push(t)}if(C(!1),r&&r.length>=1?i.revision>=2?(a.headers={"X-MS-RequiresMinResourceVersion":2},a.query={mail:r}):a.query={query:r,limit:1}:(a.query={query:b.text(),limit:b.limit()},T&&(T.excluded[b.text()]=!0)),1===b.limit()){var g=r&&r.length>=1&&!I?null:r||b.text()
	if(g){var y=m.getTransientContact(g)
	if(y)return T&&T.record(e.TelemetryEvent.Search,{source:"cached_contact"}),u(y),x(!1),l.resolve(s)}}var _=o.send("GET",i.href,a).then((function(e){var n=Object.keys(e.embedded).length
	return v(e.embedded,(function(e){if("person"==d&&"contact"==e.rel){if(!1===p||!function(e){try{return e.properties.uri.toLowerCase()===h.id().toLowerCase()}catch(t){return!1}}(e)){var i=m.get(e.href,!1)
	1===n&&m.cacheTransientContact(i),u(i)}}else"group"==d&&"distributionGroup"==e.rel&&u(new t.Group({ucwa:o,contactmgr:m,source:e.href,tm:T}))})),x(!!e.get("moreResultsAvailable",!1)),s})).catch((function(e){throw C(!0),e}))
	return T&&T.monitor(_,e.TelemetryEvent.Search,{query:a.query&&f(a.query.mail||a.query.query),type:a.query&&a.query.mail?"mail":"query"}),_})),C),results:S.asReadOnly()})}
	t.PersonOrGroupSearchQuery=w
	var S=function(e){return e.type="person",new w(e)}
	t.PersonSearchQuery=S
	var x=function(e){return e.type="group",new w(e)}
	t.GroupSearchQuery=x
	var C=function(e){var t=new E,i=u(),a=u(),s=n(),l={},d=[{key:"uri",call:function(e,t){return f(e.uri.get(),t)}},{key:"topic",call:function(e,t){return f(e.topic.get(),t)}},{key:"participant",call:function(e,t){return n=e.participants().concat([e.selfParticipant]),i=t,r=function(e,t){return f(t.name.get(),e)},o.waitAll([n,i]).then((function(e){if(0==e[0].length)throw l
	return o.waitAny(p(e[0],b(r,e[1])))}))
	var n,i,r}},{key:"group",call:function(e,t){return o.wait(e.isGroupConversation()!=t).then((function(e){if(e)throw l}))}}]
	function f(e,t){return o.waitAll([e,t]).then((function(e){if(e[0].toLowerCase().indexOf(e[1].toLowerCase())<0)throw l}))}return v(d,(function(e){a.add(e.key)})),g(t,{supportedKeywords:a.asReadOnly(),keywords:s,limit:c(null),moreResultsAvailable:c(!1),getMore:r(y((function(){var n=[],r=e(),a=p(r,(function(e){return function(e){var n=o.waitAny(p(d,(function(n){return n.call(e,t.text())}))),i=o.waitAll(p(d,(function(t){if(!m(s[t.key]))return t.call(e,s[t.key])})))
	return o.waitAll([n,i])}(e).then((function(){var t={result:e,matches:{},relevance:c(null)}
	i.add(t),n.push(t)}),(function(e){if(e!=l)throw e}))}))
	return o.waitAll(a).then((function(){return n}))}))),results:i.asReadOnly()})}
	t.ConversationSearchQuery=C})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.assert,i=e.Utils.Command,r=e.Utils.BoolProperty,o=e.Utils.extend,a=e.Utils.setHiddenProperty,s=e.Utils.isNotEmptyString,c=e.Utils.isObject,l=e.Utils.isPromise,u=e.Utils.foreach,d=e.Utils.Property,p=e.Utils.NumProperty,f=e.Utils.ConstProperty,m=e.Utils.ComputedProperty,h=e.Utils.Collection,v=e.Utils.EInvalidArgument,g=e.Utils.EDoesNotExist,y=e.Utils.ENotSupported,b=e.Utils.Task,E=e.Utils.filter,w=e.Utils.Model,S=function S(x){var C,T,I=x.ucwa,A=x.source,M=x.contactmgr,O=x.subscribe,k=x.unsubscribe,N=A&&!l(A)&&I.get(A),P=w(),R={},L=x.groupMemberships,D=x.tm,U=p(),F=r(!1),B=r(!1),V=m([U,F,B],(function(e){return e>=2||!e&&!F()&&B()})),G=h({get:$,subscribed:q,unsubscribed:W}),H=h({get:$,subscribed:q,unsubscribed:W})
	function q(){O&&O(),$()}function W(){k&&k()}function j(e){u(e.related.contact||[],(function(e){G(e.href)||G.add(M.get(e.href),e.href)}))}function z(e){u(e.links("distributionGroup"),(function(e){if(!H(e.href)){var t=new S({source:e.href,ucwa:I,contactmgr:M,subscribe:O,unsubscribe:k,tm:D})
	H.add(t,e.href)}}))}function K(e){if(!e||!e.id)throw v("contact","the given value is not a Person model")
	return I.send("GET",L.href).then((function(){var n,i=(n=e[t.sHref],E(L.links("myGroupMembership"),(function(e){var t=I.get(e.href)
	return t.hasLink(N.rel)&&t.link(N.rel).href==N.href&&t.link("contact").href==n})))
	if(1!=i.length)throw"distributionGroup"==N.rel||"myPrivacyRelationship"==N.rel?y(g(e)):g(e)
	return i[0].href}))}function Y(){return I.getRevisionOf(L).then((function(){if(F(!0),!V())throw y()}))}function Q(e,t){n(!P[e])
	var i=d({subscribed:X,get:function(){return X().then((function(){return i()}))},set:t})
	R[e]=i,P[e]=t?i:i.asReadOnly()}function X(){return b.wait(A).then((function(e){return C=C||I.send("GET",e)}))}function $(){return T=T||X().then((function(){if(j(N),z(N),"myPrivacyRelationship"!=N.rel&&"myContacts"!=N.rel)return(N.hasLink("groupContacts")?I.send("GET",N.link("groupContacts").href):N.hasLink("expandDistributionGroup")?I.send("GET",N.link("expandDistributionGroup").href):(new b).reject(new Error("Missing the group expansion link.")).promise).then((function(e){j(e),z(e)}))}))}function J(e){var t=e.in||{},n=e.target||{}
	t.href==N.href&&("deleted"==e.type&&G.remove(n.href),"added"==e.type&&(G(n.href)||G.add(M.get(n.href),n.href)))}return Q("name",(function(t){if(D&&D.record(e.TelemetryEvent.GroupRename),!s(t))throw v("name","The new name must be a non empty string.")
	return N?X().then((function(){return Y()})).then((function(){return I.send("PUT",N.href,{headers:{"X-MS-RequiresMinResourceVersion":2},data:o(N.getSnapshot(),{name:t})}).then((function(){return N.get("name")}))})):t})),Q("uri"),Q("relationshipLevel"),Q("id"),b.wait(A,"sync").then((function(e){B(!0),"myPrivacyRelationship"!=(N=N||I.get(e)).rel&&R.relationshipLevel("None"),N.updated((function(){u(R,(function(e,t){t in N.properties&&e(N.properties[t],d.sUpdated)}))})),(L=L||I.get({rel:"myGroupMemberships"})).updated((function(){var e=L.link("self").revision
	U(+e)})),I.event(J),N.deleted((function(){I.event.off(J)}))
	try{j(N)}catch(n){t.log("Failed to import persons for "+N.href+": "+n)}try{z(N)}catch(n){t.log("Failed to import groups for "+N.href+": "+n)}try{j(I.get(N.link("groupContacts").href))}catch(_){}a(P,t.sHref,N.href)})),o(P,{avatarUrl:f(null),type:f({group:"Custom",defaultGroup:"Others",pinnedGroup:"Favorites",distributionGroup:"Distribution",myPrivacyRelationship:"PrivacyRelationship"}[N&&N.rel||"group"]),groups:H.asReadOnly(),persons:G.asWritable({add:i((function(t){var n=function(e){if(!e||!c(e)&&!s(e))throw v("contact","the given value is not a Person model or valid URI")
	return b.wait(null).then((function(){return e.id?e.id.get():e}))}(t).then((function(e){return b.wait(null).then((function(){return P.id.get()})).then((function(){return N.get("id")})).then((function(t){return Y().then((function(){return I.send("POST",{rel:"myGroupMemberships"},{headers:{"X-MS-RequiresMinResourceVersion":2},query:"defaultGroup"==N.rel?{contactUri:e}:{groupId:t,contactUri:e}})}))}),(function(e){throw y(e)}))}))
	return D&&D.monitor(n,e.TelemetryEvent.ContactAdd),n}),V),remove:i((function(t){var n=K(t).then((function(e){return Y().then((function(){return I.send("DELETE",e,{headers:{"X-MS-RequiresMinResourceVersion":2}})}))}))
	return D&&D.monitor(n,e.TelemetryEvent.ContactRemove),n}),V)})})}
	t.Group=S})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.Command,i=e.Utils.EnabledCommand,r=e.Utils.DisabledCommand,o=e.Utils.BoolProperty,a=e.Utils.indexOf,s=e.Utils.foreach,c=e.Utils.NumProperty,l=e.Utils.ConstProperty,u=e.Utils.ComputedProperty,d=e.Utils.Collection,p=e.Utils.EInvalidArgument,f=e.Utils.isNotEmptyString,m=e.Utils.ENotSupported,h=e.Utils.Exception,v=e.Utils.Task,g=e.Utils.findIndex,y=e.Utils.Model,b=e.Utils.debounced,_=function(_){var E,w,S,x,C,T,I=_.ucwa,A=_.contactmgr,M=_.tm,O=_.autoPopulate,k=["group","pinnedGroup","distributionGroup","defaultGroup"],N=d({get:W,subscribed:function(){return q(W)},unsubscribed:$}),P=d({get:j,subscribed:function(){return q(j)},unsubscribed:$}),R=c(),L=o(!1),D=o(!1),U=u([R,L,D],(function(e){return e>=2||!e&&!L()&&D()})),F=[],B=[],V=30,G=0
	function H(e){return new t.Group({source:e,ucwa:I,contactmgr:A,subscribe:X,unsubscribe:$,groupMemberships:w,tm:M})}function q(e){X().then((function(){"Connected"==E.get("state")&&e()}))}function W(){var t=I.init().then((function(){return I.send("GET",{rel:"myContacts"}).then(z)}))
	return M&&M.monitor(t,e.TelemetryEvent.ContactsLoad,(function(){return{nContacts:N.size()}})),t.then((function(){O(N.size(),(function(e){N.add(A.get(e,!0,{isOrgContact:!0}),e)}))})),t}function j(){return I.init().then((function(){return v.waitAll([I.send("GET",{rel:"myGroups"}).then(K),I.send("GET",{rel:"myPrivacyRelationships"}).then(Y)]).then((function(){M&&M.record(e.TelemetryEvent.GroupsLoad,{nGroups:P.size()})}))}))}function z(e){s(e.related.contact||[],(function(e){N(e.href)||N.add(A.get(e.href),e.href)}))}function K(e){s(k,(function(t){s(e.links(t),(function(e){P(e.href)||P.add(H(e.href),e.href)}))}))}function Y(e){s(e.links("myPrivacyRelationship"),(function(e){P(e.href)||P.add(H(e.href),e.href)}))}function Q(e){return I.exists({rel:e})?v.wait({href:I.get({rel:e}).href}):I.send("GET",E.href).then((function(t){return t.link(e)}))}function X(){return++G>1?v.run((function(){throw h("AlreadySubscribed")})):I.init().then((function(){return Q("startOrRefreshSubscriptionToContactsAndGroups")})).then((function(t){var n=b((function(){return I.send("POST",t.href,{query:{duration:V}})}))
	n(),T=e.setInterval((function(){n().then(null,$)}),60*V*1e3)}))}function $(){0!=G&&(--G>0||I.init().then((function(){e.clearInterval(T),Q("stopSubscriptionToContactsAndGroups").then((function(e){return I.send("POST",e.href)}))})))}function J(){return I.getRevisionOf(w).then((function(){if(L(!0),w.set("qqq",!0),!U())throw m()}))}return I.init().then((function(){D(!0),w=I.get({rel:"myGroupMemberships"},null),E=I.get({rel:"myContactsAndGroupsSubscription"},null),S=I.get({rel:"myContacts"},null),x=I.get({rel:"myGroups"},null),C=I.get({rel:"myPrivacyRelationships"},null),S&&z(S),x&&K(x),C&&Y(C),w&&w.updated((function(){var e=w.link("self").revision
	R(+e)}))})),I.event((function(e){var t=e.in||{},n=e.target,i=n.href
	a(k,n.rel)>=0&&("myGroups"==t.rel?"deleted"==e.type?P.remove(i):"added"==e.type&&function(e){P(e)||(B.length>0?v.wait(null).then((function(){if(!I.get(e).has("name"))return I.send("GET",e)})).then((function(){var t=g(B,(function(t){return t.name()==I.get(e).get("name")}))
	t>=0?(F[t].promise.then((function(e){var t=g(B,(function(t){return t.name()==I.get(e).get("name")}))
	B[t]&&P.add(B[t],e),B.splice(t,1),F.splice(t,1)})),F[t].resolve(e)):P.add(H(e),e)})):P.add(H(e),e))}(i):"group"==n.rel&&"updated"==e.type&&P(i)&&I.send("GET",i)),"myContacts"==t.rel&&("added"!=e.type||N(i)?"deleted"==e.type&&N.remove(i):N.add(A.get(i),i))})),y({id:l(null),name:l(null),uri:l(null),avatarUrl:l(null),type:l("Root"),relationshipLevel:l("None"),createGroup:i((function(){M&&M.record(e.TelemetryEvent.GroupCreate)
	var t=new v,n=H(t.promise)
	return F.push(t),B.push(n),n})),persons:N.asWritable({add:r((function(){throw m()})),remove:n((function(t){var n=v.wait("string"==typeof t?t:t.id.get()).then((function(e){return I.send("GET",w.href).then((function(){return J()})).then((function(){return I.send("POST",w.link("removeContactFromAllGroups").href,{query:{contactUri:e},headers:{"X-MS-RequiresMinResourceVersion":2}})}))}))
	return M&&M.monitor(n,e.TelemetryEvent.ContactRemove),n}),U)}),groups:P.asWritable({add:n((function(n){return"Distribution"==n.type()?function(n){var i=I.get(n[t.sHref]).link("addToContactList"),r=I.send("POST",i.href)
	return M&&M.monitor(r,e.TelemetryEvent.GroupAdd,{type:n.type()}),r}(n):function(t){var n=t.name()
	if(!f(n))throw p("name","The group name must be a non empty string.")
	return J().then((function(){var i=I.send("POST",{rel:"myGroups"},{data:{displayName:n},headers:{"X-MS-RequiresMinResourceVersion":2}})
	return M&&M.monitor(i,e.TelemetryEvent.GroupAdd,{type:t.type()}),i}))}(n)}),U),remove:n((function(n){var i=I.get(n[t.sHref]).rel
	if("group"==i)return function(n){return J().then((function(){var i=I.send("DELETE",n[t.sHref],{headers:{"X-MS-RequiresMinResourceVersion":2}})
	return M&&M.monitor(i,e.TelemetryEvent.GroupRemove,{type:n.type()}),i}))}(n)
	if("distributionGroup"==i)return function(n){var i=I.get(n[t.sHref]).link("removeFromContactList"),r=I.send("POST",i.href)
	return M&&M.monitor(r,e.TelemetryEvent.GroupRemove,{type:n.type()}),r}(n)
	throw m({groupType:i})}),U)})})}
	t.RootGroup=_,_=t.RootGroup||(t.RootGroup={})})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.sdist,i=e.Utils.Model,r=e.Utils.Exception,o=e.Utils.EnabledCommand,a=e.Utils.EnabledAsyncCommand,s=function(s){var c=s.ucwa,l=s.psm,u=s.contactmgr,d=s.me,p=s.remoteSearchResultsOnly,f=s.tm,m=s.settings,h=new t.RootGroup({ucwa:c,contactmgr:u,tm:f,autoPopulate:function(n,i){c.init().then((function(){!m||!m.getContactsFromGraph||n>m.getContactsFromGraphLowerLimit||c.graph.getTopNContacts(10).then((function(r){for(var o=0,a=r;o<a.length;o++){var s=a[o]
	if(s.personType&&s.personType.class&&"Person"==s.personType.class){var c=v()
	c.text(s.scoredEmailAddresses[0].address),c.getMore().then((function(e){if(e[0]){var n=e[0].result
	i(n[t.sHref]),n.displayName.get()}}))}}f&&f.record(e.TelemetryEvent.ContactsAutoPopulate,{numberOfExistingContacts:n,autoPopulateContactLowerLimit:m.getContactsFromGraphLowerLimit,numberOfContactsToPopulate:r&&r.length})})).catch((function(t){f&&f.record(e.TelemetryEvent.ContactsAutoPopulate,{result:"failed",reason:t})}))}))}})
	function v(){return new t.PersonSearchQuery({ucwa:c,psm:l,contactmgr:u,remoteOnly:p,me:d,settings:m?m.searchSettings:{},tm:f})}return i({mePerson:d,all:h,createPersonSearchQuery:o(v),createGroupSearchQuery:o((function(){return new t.GroupSearchQuery({ucwa:c,psm:l,contactmgr:u,tm:f})})),lookupPersonById:a((function(e){if(!e)throw r("NoSipUri")
	e=e.toLowerCase()
	for(var t=function(t){return(t||"").toLowerCase()==e},i=0,o=u.get();i<o.length;i++){var a=o[i]
	if(t(a.id()))return a}var s=v()
	return s.text(e),s.limit(1),s.getMore().then((function(){if(!s.results(0))throw r("NotFound",{sipuri:e})
	var i=s.results(0).result
	if(t(i.id()))return i
	throw r("NotMatched",{sipuri:e,sdist:n(e,i.id()||"")})}))})),createGroup:h.createGroup})}
	t.PersonsAndGroupsManager=s})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.values,i=e.Utils.max,r=function(){function r(e){this.contacts={},this.contactExpiryTimers={},this.settings={},this.count=0,this.ucwa=e.ucwa,this.psm=e.psm,this.tm=e.tm,e.settings=e.settings||{},this.settings.maxCacheCount=e.settings.maxCacheCount||1e3,this.settings.useCacheForTransientContacts=void 0!==e.settings.useCacheForTransientContacts&&e.settings.useCacheForTransientContacts,this.settings.contactExpiryThreshold=e.settings.contactExpiryThreshold||36e5,this.settings.linkedPropFetchInterval=e.settings.linkedPropFetchInterval,this.settings.enableGetSubscribedProps=e.settings.enableGetSubscribedProps}return r.prototype.getTimeRemainingToExpiry=function(t){return i(+t.expires()-e.Date.now()-this.settings.contactExpiryThreshold,0)},r.prototype.addToCache=function(t,n){var i=this
	if(this.count<this.settings.maxCacheCount){this.contacts[t]=n,this.count++
	var r=function(){if(i.contacts[t]){var n=i.getTimeRemainingToExpiry(i.contacts[t])
	n>0?i.contactExpiryTimers[t]=e.setTimeout(r,n):i.deleteFromCache(t)}}
	n.expires.once((function(e){return!!e}),(function(){i.contactExpiryTimers[t]=e.setTimeout(r,i.getTimeRemainingToExpiry(n))}))}else this.tm&&this.tm.record(e.TelemetryEvent.ContactManager,{result:"cache_full",count:this.count})},r.prototype.deleteFromCache=function(t){this.contacts[t]&&(delete this.contacts[t],e.clearTimeout(this.contactExpiryTimers[t]),delete this.contactExpiryTimers[t],this.count--,this.tm&&this.tm.record(e.TelemetryEvent.ContactManager,{action:"cached_contact_delete",count:this.count}))},r.prototype.get=function(e,i,r){var o=this
	if(!e)return n(this.contacts)
	var a=function(){return new t.Person({href:e,name:i&&i.name,sipuri:i&&i.sipuri,photo:i&&i.photo,ucwa:o.ucwa,psm:o.psm,linkedPropFetchInterval:o.settings.linkedPropFetchInterval,enableGetSubscribedProps:o.settings.enableGetSubscribedProps,isOrgContact:r&&r.isOrgContact})}
	if("string"==typeof e){if(this.contacts[e])return this.contacts[e]
	var s=a()
	return!1!==i&&this.addToCache(e,s),s}return a()},r.prototype.getTransientContact=function(e){if(e&&(e=e.toLowerCase(),this.settings.useCacheForTransientContacts))for(var t in this.contacts)if((this.contacts[t].id()||"").toLowerCase()===e)return this.contacts[t]},r.prototype.cacheTransientContact=function(e){var n=e[t.sHref]
	this.settings.useCacheForTransientContacts&&n&&!this.contacts[n]&&this.addToCache(n,e)},r}()
	t.ContactManager=r})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.sleep,i=e.Utils.repeat,r=(e.Utils.Http,e.Utils.Task),o=e.Utils.NumProperty,a=function(){function t(e,t,n,i){void 0===n&&(n=25),this.ucwa=e,this.uris=t,this.duration=n,this.tm=i,this._size=o(),this.active={},this.size=this._size.asReadOnly(),this._size(t.length)
	for(var r=0,a=t;r<a.length;r++){var s=a[r]
	this.active[s]=!0}this.init()}return t.prototype.init=function(){var t=this
	this.dfd=r.wait(null,"sync").then((function(){var n=t.ucwa.get({rel:"presenceSubscriptions"}),i=t.ucwa.send("POST",n.href,{data:{duration:t.duration,uris:t.uris}})
	return t.tm&&t.tm.monitor(i,e.TelemetryEvent.PresenceSubscribe,{nUris:t._size()}),i})).then((function(e){t.rSubscription=e,t.rep=i((function(){return n(60*(t.duration-1)).then((function(){return t.extendDuration()}))})).catch((function(e){throw e&&"RequestFailed"==e.code&&404==e.rsp.status&&t.init(),e})),t.rSubscription.dirty.when(!0,(function(){return t.extendDuration()})),t.rSubscription.deleted((function(){t.stop(),t._size(0),t.active={}}))})).finally((function(){t.dfd=null}))},t.prototype.extendDuration=function(){return this.ucwa.send("POST",this.rSubscription.href,{query:{duration:this.duration}})},t.prototype.stop=function(){this.rep&&(this.rep.cancel(),this.rep=null)},t.prototype.add=function(e){this.active[e]||(this.active[e]=!0,this._size.inc())},t.prototype.remove=function(e){if(this.active[e]&&(this.active[e]=!1,this._size.dec(),0==this._size()))if(this.rSubscription)this.stop(),this.ucwa.send("DELETE",this.rSubscription.href)
	else if(this.dfd)try{this.dfd.cancel()}catch(t){}},t}()
	t.PresenceSubscription=a})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.batched,i=e.Utils.Subscription,r=function(){function e(e,i){var r=this
	this.subs={},this.refs={},this.dfds={}
	var o=i&&i.maxBatchSize,a=i&&i.duration,s=i&&i.tm
	this._subscribe=n((function(n){var i=new t.PresenceSubscription(e,n,a,s)
	return i.size.when(0,(function(){for(var e=0,t=n;e<t.length;e++){var i=t[e]
	r.remove(i)}})),i}),o||75)}return e.prototype.unsubscribe=function(e){var n=this.refs,i=this.subs,r=this.dfds
	if(n[e]--,0==n[e])if(i[e])i[e].remove(e)
	else{try{r[e].cancel()}catch(o){t.log("unsubscribe("+e+") failed",o&&o.stack||o)}this.remove(e)}},e.prototype.remove=function(e){delete this.dfds[e],delete this.refs[e],delete this.subs[e]},e.prototype.subscribe=function(e){var t=this,n=this.refs,r=this.subs,o=this.dfds,a=!1
	return o[e]?n[e]++:r[e]?(n[e]++,r[e].add(e)):(n[e]=1,o[e]=this._subscribe(e).then((function(t){r[e]=t,o[e]=null}))),new i((function(){a||(a=!0,t.unsubscribe(e))}))},e}()
	t.PresenceSubscriptionManager=r})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={}));(function(e){(function(e){var t;(function(t){var n=e.Utils.guid,i=e.Utils.async,r=e.Utils.check,o=e.Utils.assert,a=e.Utils.indexOf,s=e.Utils.Task,c=e.Utils.Event,l=e.Utils.Model,u=e.Utils.Property,d=e.Utils.StringEnum,p=e.Utils.BoolProperty,f=function d(f){var m=f.ucwa,h=f.rInvitation,v=f.rMeeting,g=f.from,y=f.threadId,b=f.subject,_=f.priority,E=f.conversation,w=f.contactManager,S=f.tm,x=u(),C=u(),T=u(),I=u(),A=u(),M=new c,O=new s,k=u({get:function(){return O.promise}})
	k.changed((function(e){return O.resolve(e)}))
	var N={start:i((function(e){var i=e&&e.uri,r=e&&e.name
	return s.run((function(){var e,a,c,l,u=n()
	return x(d.State.Connecting),delete R.start,M.fire(),e=i?m.send("POST",{rel:"joinOnlineMeeting"},{data:{operationId:u,threadId:y,anonymousDisplayName:r,onlineMeetingUri:i}}):m.send("POST",{rel:"startOnlineMeeting"},{data:{operationId:u,threadId:y,subject:b||"",importance:_||"Normal"}}),a=m.wait({type:"started",target:{rel:"onlineMeetingInvitation"},resource:{operationId:u}}).then((function(e){o(!h),(h=e.resource).updated(D)})),c=m.wait({type:"completed",target:{rel:"onlineMeetingInvitation"},resource:{operationId:u}}).then((function(e){if("Success"!=e.status)throw U(i,e),t.EInvitationFailed(e.reason)})),l=m.wait({type:"added",target:{rel:"onlineMeeting"},resource:function(e){return h&&e.link("conversation").href==h.link("conversation").href}}).then((function(e){h.updated.off(D),v||(v=e.resource).updated(D)})),s.waitAll([e,a,c,l])})).then((function(){x(d.State.Connected)})).catch((function(e){throw R.start=N.start,x(d.State.Created,e),M.fire(),e}))})),accept:i((function(){return r.state(x(),d.State.Notified),x(d.State.Connecting),s.run((function(){var n,i,r
	return r=m.send("POST",h.link("accept").href),S&&S.verbose&&S.monitor(r,e.TelemetryEvent.Meeting,{action:"postAccept",url:h.link("accept").href}),n=m.wait({type:"added",target:{rel:"onlineMeeting"},resource:function(e){return e.link("conversation").href==h.link("conversation").href}}).then((function(e){h.updated.off(D),v||(v=e.resource).updated(D)})),S&&S.verbose&&S.monitor(n,e.TelemetryEvent.Meeting,{action:"onlineMeetingAdded",url:h.href}),i=m.wait({type:"completed",target:{rel:"onlineMeetingInvitation",href:h.href}}).then((function(e){if("Success"!=e.status)throw U(e.resource.has("onlineMeetingUri")&&e.resource.get("onlineMeetingUri"),e),t.EInvitationFailed(e.reason)})),S&&S.verbose&&S.monitor(i,e.TelemetryEvent.Meeting,{action:"onlineMeetingInvitationCompleted",url:h.href}),s.waitAll([r,n,i])})).then((function(){delete R.accept,delete R.decline,x(d.State.Connected),M.fire()})).catch((function(e){throw x(d.State.Disconnected,e),e}))})),decline:i((function(e){return void 0===e&&(e="Global"),r.state(x(),d.State.Notified),m.send("POST",h.link("decline").href,{data:{reason:e}}).then((function(){return x(d.State.Disconnected)}))})),acknowledge:i((function(){return m.send("POST",h.link("acknowledge").href).then((function(){x(d.State.Disconnected)}))}))},P=u({get:function(){return v.link("phoneDialInInformation").href}}),R=l({from:g,changed:M.observer,dialin:t.PhoneDialInInformation&&new t.PhoneDialInInformation(m,P),state:x.asReadOnly(),subject:C.asReadOnly(),uri:T.asReadOnly(),priority:A.asReadOnly(),joinUrl:I.asReadOnly(),availableModalities:l({messaging:L("Messaging"),audio:L("Audio"),video:L("Video"),appSharing:L("ApplicationSharing")})})
	function L(e){var t=p(!1)
	return h&&h.updated((function(){var n=h.get("availableModalities",[]),i=a(n,e)>=0
	t(i)})),t.asReadOnly()}function D(){var e=v||h
	C(e.get("subject","")),T(e.get("onlineMeetingUri","")),I(e.get("joinUrl","")),A(e.get("importance","")),e.hasLink("organizer")&&k(e.link("organizer").href)
	var t=e.has("state")&&e.get("state")
	"Connected"==t?x(d.State.Connected):"Failed"==t&&x(d.State.Disconnected)}function U(e,t){if(t){var n=m.exists({rel:"application"})&&m.get({rel:"application"})
	return n&&n.hasLink("sendClientErrorReport")?m.send("POST",{rel:"sendClientErrorReport"},{data:{description:t.reason?t.reason.message:"Failed to join conference",conferenceUri:e,clientErrorCode:t.reason?t.reason.code:"FAILURE",rel:t.target.rel},nobatch:!0}):void 0}}return h?(o(g),x(d.State.Notified),R.accept=N.accept,R.decline=N.decline,R.acknowledge=N.acknowledge,h.updated(D)):v?(x(d.State.Connected),v.updated(D)):(o(y),x(d.State.Created),C(b),A(_),R.start=N.start),R.creator=w.get(k),m.event((function(e){var n=e.target,i=e.resource,r=e.in
	"added"==e.type&&"onlineMeeting"==n.rel&&r&&E[t.sHref]==r.href&&!v&&(v=i).updated(D)})),m.event((function(e){var n=e.target,i=e.resource
	"completed"==e.type&&"onlineMeetingInvitation"==n.rel&&i.link("conversation").href==E[t.sHref]&&"Connected"==i.get("state")&&x(d.State.Connected)})),R}
	t.OnlineMeeting=f,function(e){e.State=d("Created","Notified","Connecting","Connected","Disconnected"),e.AccessLevel=d("Everyone","Invited","Locked","SameEnterprise"),e.AutomaticLeaderAssignment=d("Disabled","Everyone","SameEnterprise"),e.EntryExitAnnouncement=d("Disabled","Enabled"),e.LobbyBypassForPhoneUsers=d("Disabled","Enabled"),e.PhoneUserAdmission=d("Disabled","Enabled")}(f=t.OnlineMeeting||(t.OnlineMeeting={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))})(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.dateToTimeStamp,i=e.Utils.timeStampToDate,r=e.Utils.Property,o=function(o,a){var s=void 0===a?{}:a,c=s.href,l=s.tm,u=r({value:c,get:function(){var t=o.send("POST",{rel:"myOnlineMeetings"},{data:d.toJSON()}).then((function(t){return l&&l.record(e.TelemetryEvent.ScheduleMeeting,{onlineMeetingId:t.get("onlineMeetingId",void 0)}),t.href}),(function(e){throw e}))
	return l&&l.monitor(t,e.TelemetryEvent.ScheduleMeeting,{},{timeout:5e3}),t}}),d=t.ObservableResource(o,u,(function(e){e.property("accessLevel",{canInit:!0}),e.property("attendees",{canInit:!0}),e.property("automaticLeaderAssignment",{canInit:!0}),e.property("description",{canInit:!0}),e.property("entryExitAnnouncement",{canInit:!0}),e.property("expirationTime",{canInit:!0,parse:i,convert:n,prepare:function(e){return e&&e.toJSON()}}),e.property("joinUrl",{readOnly:!0}),e.property("leaders",{canInit:!0}),e.property("lobbyBypassForPhoneUsers",{canInit:!0}),e.property("onlineMeetingId",{readOnly:!0}),e.property("onlineMeetingUri",{readOnly:!0}),e.property("organizerUri",{readOnly:!0}),e.property("phoneUserAdmission",{canInit:!0}),e.property("subject",{canInit:!0})}))
	return d}
	t.MyOnlineMeeting=o})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.isString,i=e.Utils.setHiddenProperty,r=e.Utils.sanitizeHtml,o=e.Utils.convertHtmlToText,s=e.Utils.convertTextToHtml,c=e.Utils.disableHtmlInText,l=e.Utils.Property,u=e.Utils.BaseModel,d=e.Utils.Collection,p=e.Utils.ConstProperty
	function f(e){var t=/^\s*<div>([\s\S]*)<\/div>\s*$/i
	return t.test(e)?f(e.replace(t,"$1")):e.trim()}var m=function(u){function m(a){var h=a.ucwa,v=a.href,g=void 0===v?"":v,y=a.sender,b=a.status,_=void 0===b?m.Status.Succeeded:b,E=a.time,w=void 0===E?new e.Date:E,S=a.participants,x=a.ndrs,C=a.text,T=a.html,I=a.direction,A=u.call(this)||this
	if(A.isEdited=p(!1),A.isDeleted=p(!1),C=(C||"").trim(),(T=(T||"").trim())&&!C)try{C=o(T)}catch(P){C=""}if(C&&!T)try{T=s(C)}catch(P){T=""}var M=!g||n(g)?p(g):g,O=n(_)?l({value:_}):_
	M.changed((function(e){return i(A,t.sHref,e)}))
	var k=d()
	function N(e){for(var n=0,i=e;n<i.length;n++)for(var r=i[n],o=0,a=S();o<a.length;o++){var s=a[o]
	s[t.sHref]!=r.href||k(r.href)||k.add(s,r.href)}}return x&&S&&N(x),O()!=m.Status.Succeeded&&h.wait({type:"completed",target:{rel:"message"},resource:function(e){return e.href==M()}}).then((function(e){O("Success"==e.status?m.Status.Succeeded:m.Status.Failed,e.reason),S&&N(e.resource.links("failedDeliveryParticipant"))})),A.sender=y,A.text=p(C&&c(C).trim()),A.html=p(T&&f(r(T))),A.timestamp=p(w),A.direction=p(I||(M()||""==M()?m.Direction.Incoming:m.Direction.Outgoing)),A.status=O.asReadOnly(),A.failedDeliveryParticipants=k.asReadOnly(),A}return a(m,u),m}(u)
	t.Message=m,function(e){(function(e){e.Pending="Pending",e.Succeeded="Succeeded",e.Failed="Failed"})(e.Status||(e.Status={})),function(e){e.Incoming="Incoming",e.Outgoing="Outgoing"}(e.Direction||(e.Direction={}))}(m=t.Message||(t.Message={}))})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.random,i=e.Utils.inherit,r=e.Utils.Property,o=e.Utils.BoolProperty,a=e.Utils.ConstProperty,s=e.Utils.Model,c=function(t,c,l){var u=r()
	return l.status&&l.status.changed((function(e,t){return u(t)})),i(s(l),{type:a(t),key:a(c||n()),timestamp:a(new e.Date),status:a("Succeeded"),reason:u.asReadOnly(),isRead:o(!1)},"append")}
	t.ActivityItem=c})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.map,i=e.Utils.keys,r=e.Utils.take,o=e.Utils.async,a=e.Utils.assert,s=e.Utils.extend,c=e.Utils.foreach,l=e.Utils.inherit,u=e.Utils.indexOf,d=e.Utils.isArray,p=e.Utils.isModel,f=e.Utils.isProperty,m=e.Utils.isCollection,h=e.Utils.isEmptyObject,v=e.Utils.timeStampToDate,g=e.Utils.isNotEmptyString,y=e.Utils.setHiddenProperty,b=e.Utils.disableHtmlInText,_=e.Utils.URI,E=e.Utils.Model,w=e.Utils.Property,S=e.Utils.Collection,x=e.Utils.StringEnum,C=e.Utils.Subscription,T=e.Utils.ConstProperty,I=function(){function o(p){var f,m,_=function(e){return e=/[?&]displayName=/.test(e)?e=e.split("?")[0]:e}(p.href),C=p.ucwa,I=p.name,A=p.sipuri,M=p.photo,O=p.psm||new t.PresenceSubscriptionManager(C),k={},N=null!=p.linkedPropFetchInterval?60*p.linkedPropFetchInterval*1e3:0,P=null==p.enableGetSubscribedProps||p.enableGetSubscribedProps,R=x("direct","linked","photo"),L=0,D=!!p.isOrgContact,U=("string"==typeof _?T(_):_).map((function(e){return C.get(e)})),F=E(),B=l(F)
	p=null
	var V={}
	function G(t){var n=V[t]
	return U.get().then((function(e){if(!(n.type==R.direct?e.has(n.internalName):e.hasLink(n.internalName)))return q()})).then((function(){switch(n.type){case R.linked:return(t=n.link,k[t]||(k[t]=C.send("GET",t).finally((function(){k[t]=null}))),k[t]).then((function(t){n.lastFetched=e.Date.now(),n.dirty=!1,z(n,t)}))
	case R.photo:return W()}var t})).then((function(){return n.property()}))}function H(t,n){a(g(t)),a(!n||R[n.type])
	var i=(n&&n.isCollection?S:w)({value:n&&n.value,get:function(){var n=V[t].lastFetched
	return V[t].observed?P||null==n?G(t):i():null!=n&&n>e.Date.now()-N?i():G(t)},subscribed:function(){(function(e){switch(e.observed=!0,e.type){case R.direct:U.get().then((function(t){t.has(e.internalName)||q()}))
	break
	case R.linked:t=e,1==++L?V.id.property.get().then((function(e){m=O.subscribe(e)})):t.dirty&&G(t.modelName)
	break
	case R.photo:e.property.get()}var t})(V[t])},unsubscribed:function(){var e;(e=V[t]).observed=!1,e.type==R.linked&&0==--L&&m&&(m.dispose(),m=null)}})
	return V[t]={internalName:n&&n.internal||t,modelName:t,type:n&&n.type||R.direct,field:n&&n.field,element:n&&n.element,observed:!1,dirty:!1,link:n&&n.link||null,transform:n&&n.transform,lastFetched:null,property:i},V[t].property.asReadOnly()}function q(){return f||(f=U.get().then((function(e){return C.send("GET",e.href)}))).then(null,(function(){f=null})),f}function W(){var e=V.avatarUrl
	if(e.link)return o.getPhotoUrl({ucwa:C,path:e.link}).then((function(t){e.property(t)}))}function j(e){var t=U(),n=e.target,i=e.in
	n&&"updated"==e.type&&i&&t&&i.href==t.href&&c(V,(function(e){e.type==R.linked&&n.rel==e.internalName&&(e.observed?G(e.modelName):e.dirty=!0)}))}function z(e,t){var n=e.field?e.element?u(t.get(e.field),e.element)>=0:t.properties[e.field]:t.get()
	e.property(e.transform?e.transform(n):n)}return function(){B.id=H("id",{internal:"uri",type:R.direct,value:A}),B.sourceNetwork=H("sourceNetwork"),B.company=H("company"),B.department=H("department"),B.office=H("office"),B.title=H("title"),B.expires=H("expires",{transform:v,type:R.direct}),B.emails=H("emails",{internal:"emailAddresses",type:R.direct,isCollection:!0,transform:function(e){return n(e||[],(function(e){return E({type:T(null),emailAddress:T(e)})}))}}),B.phoneNumbers=H("phoneNumbers",{internal:["workPhoneNumber","homePhoneNumber","mobilePhoneNumber","otherPhoneNumber"],type:R.direct,isCollection:!0,transform:function(e){var t={workPhoneNumber:"Work",homePhoneNumber:"Home",mobilePhoneNumber:"Cell",otherPhoneNumber:"Other"}
	return(e||[]).filter((function(e){var n=null,r=null,o=i(e)
	return 1==o.length&&o[0]in t&&(n=t[o[0]],r=e[o[0]]),n&&r})).map((function(e){var n=i(e)[0],r=e[n],a=o.extractPhoneNumber(r)
	return E({type:T(t[n]),telUri:T(r),displayString:T(a)})}))}}).sort((function(e,t){return e.type()<t.type()})),B.workPhone=H("workPhone",{internal:"workPhoneNumber",type:R.direct}),B.homePhone=H("homePhone",{internal:"homePhoneNumber",type:R.direct}),B.mobilePhone=H("mobilePhone",{internal:"mobilePhoneNumber",type:R.direct}),B.otherPhone=H("otherPhone",{internal:"otherPhoneNumber",type:R.direct}),B.type=H("type",{type:R.direct,value:/;user=phone$/.test(A)?"Phone":void 0}),B.displayName=H("displayName",{internal:"name",type:R.direct,value:I,transform:b}),B.avatarUrl=H("avatarUrl",{internal:"contactPhoto",type:R.photo,link:M}),B.status=H("status",{internal:"contactPresence",type:R.linked,field:"availability",transform:o.fixStatus}),B.endpointType=H("endpointType",{internal:"contactPresence",type:R.linked,field:"deviceType",transform:o.fixDeviceType}),B.lastSeenAt=H("lastSeenAt",{internal:"contactPresence",type:R.linked,field:"lastActive",transform:v}),B.activity=H("activity",{internal:"contactPresence",type:R.linked,field:"activity",transform:b}),B.relationship=H("relationship",{internal:"contactPrivacyRelationship",type:R.linked,field:"relationshipLevel"}),B.location=H("location",{internal:"contactLocation",type:R.linked,field:"location",transform:b}),s(B.location,{type:T(null),street:T(null),city:T(null),state:T(null),country:T(null),postalCode:T(null)}),B.note=E({type:H("note.type",{internal:"contactNote",type:R.linked,field:"type"}),text:H("note.text",{internal:"contactNote",type:R.linked,field:"message",transform:b})}),B.capabilities=E({chat:H("capabilities.chat",{internal:"contactSupportedModalities",type:R.linked,field:"modalities",element:"Messaging"}),audio:H("capabilities.audio",{internal:"contactSupportedModalities",type:R.linked,field:"modalities",element:"Audio"}),video:H("capabilities.video",{internal:"contactSupportedModalities",type:R.linked,field:"modalities",element:"Video"}),screenSharing:H("capabilities.screenSharing",{internal:"contactSupportedModalities",type:R.linked,field:"modalities",element:"ApplicationSharing"}),dataCollaboration:H("capabilities.dataCollaboration",{internal:"contactSupportedModalities",type:R.linked,field:"modalities",element:"DataCollaboration"})}),B.isBlocked=T(!1,{code:"NotSupported"}),B._isOrganizationContact=T(D),U.once((function(e){return!!e}),(function(){var e=U()
	y(F,t.sHref,e.href),e.updated((function(){c(V,(function(t){var n,i=t.internalName
	"type"===i&&"Phone"===e.properties[i]&&V["capabilities.audio"].property(!0),t.type==R.direct?(n=function(e){return t.transform?t.transform(e):e}(d(i)?i.filter((function(t){return e.properties[t]})).map((function(t){return r(e.properties,t)})):e.properties[i]),e.dirty()&&void 0===n||t.property(n)):t.link=e.relatedHref(i)}))}))})),C.restored((function(){for(var e=0,t=["status"];e<t.length;e++){var n=V[t[e]]
	n.observed&&n.property.get()}})),C.event(j)
	var e
	e=[],c(V,(function(t){var n
	t.type==R.linked&&t.link&&(n=C.get(t.link),h(n.properties)?e.push(t):z(t,n))})),W()}(),s(B,o.prototype,{firstName:T(null),lastName:T(null)})}return o.prototype.subscribe=function(){var e=[]
	return c(this,(function t(n){(f(n)||m(n))&&n.observed()&&e.push(n.subscribe()),p(n)&&c(n,t)})),new C((function(){for(var t=0,n=e;t<n.length;t++)n[t].dispose()
	e=[]}))},o}()
	t.Person=I,function(e){(function(e){e.Away="Away",e.Busy="Busy",e.DoNotDisturb="DoNotDisturb",e.Offline="Offline",e.Online="Online"})(e.Status||(e.Status={})),e.fixDeviceType=function(e){return{PC:"Desktop",Mobile:"Mobile",Web:"Web"}[e]||"Unknown"},e.fixStatus=function(t){return e.Status[t]||{BeRightBack:e.Status.Away,Idle:e.Status.Away,IdleOnline:e.Status.Away,IdleBusy:e.Status.Away,Unknown:e.Status.Offline}[t]||e.Status.Offline},e.extractPhoneNumber=function(e){return(e||"").replace(/^(.+:)?(.+)$/,"$2")},e.getPhotoUrl=o((function(e){var t=e.ucwa,n=e.path,i=t.get({rel:"applications"})
	return new _(i.href).path(n).query("")+""}))}(I=t.Person||(t.Person={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.map,i=e.Utils.clone,r=e.Utils.assert,o=e.Utils.extend,a=e.Utils.batched,s=e.Utils.foreach,c=e.Utils.inherit,l=e.Utils.debounce,u=e.Utils.isEmptyObject,d=e.Utils.timeStampToDate,p=e.Utils.setHiddenProperty,f=e.Utils.disableHtmlInText,m=e.Utils.Enum,h=e.Utils.Task,v=e.Utils.Model,g=e.Utils.Property,y=e.Utils.Exception,b=e.Utils.Collection,E=e.Utils.NumProperty,w=e.Utils.ConstProperty,S=e.Utils.SequentialStateMachine,x=function(x,C){var T,I=g.bool(!1),A=g.bool(!1),M=I.or(A),O=g.bool(!1),k=g.bool(!1),N=g.bool(!1),P=g.bool(!1),R=C&&C.supportsConferencing||w(!1),L=C&&C.guestName,D=C&&C.reportMyActivityInterval||18e4,U=C&&C.meActiveChangedDelay||1e4,F=g.bool(!0),B=y("Reconnecting"),V=m("Unavailable","Available"),G=S(V.Unavailable),H={},q={},W=v(),j=c(W),z=C&&C.tm,K=C&&C.sendActivityTelemetry,Y=C&&C.preferredDesktopEndpoint,Q=function(){return"redirectClient"===j._clientUpdatePolicy()},X=function(){return""!==j._clientUpdatePolicy()}
	C=null
	var $=x.init().then((function(){var e=x.get({rel:"me"})
	return u(e.properties)?x.send("GET",{rel:"me"}).then((function(){return e})):e}))
	G.defineState(V.Available,(function(){return ie().then((function(){var n,i,r
	i=function(){if(x.connected()&&!x.appDeleted()&&x.exists({rel:"reportMyActivity"})){t.log("%c reportMyActivity","color:green;font-weight:bold","active="+j.active())
	var i=x.send("POST",{rel:"reportMyActivity"},{priority:100,nobatch:!0}).catch((function(i){z&&z.record(e.TelemetryEvent.ReportActivityStopped,{reason:i}),i&&"RequestFailed"==i.code&&i.rsp&&409==i.rsp.status||(t.log("%c reportMyActivity stopped","color:red;font-weight:bold",i),e.clearInterval(n))}))
	K&&z&&z.monitor(i,e.TelemetryEvent.Activity,{action:"report",active:j.active(),doc_hidden:document&&document.hidden,doc_visibility_state:document&&document.visibilityState})}else t.log("%c reportMyActivity noop","color:red;font-weight:bold","ucwa_connected="+x.connected(),"appDeleted="+(x.connected()&&x.appDeleted()),"hasReportMyActivity="+(x.connected()&&!x.appDeleted()&&x.exists({rel:"reportMyActivity"})),"active="+j.active()),K&&z&&z.verbose&&z.record(e.TelemetryEvent.Activity,{action:"noop",active:j.active(),ucwa_connected:x.connected(),appDeleted:x.connected()&&x.appDeleted(),hasReportMyActivity:x.connected()&&!x.appDeleted()&&x.exists({rel:"reportMyActivity"}),doc_hidden:document&&document.hidden,doc_visibility_state:document&&document.visibilityState})},r=function(r,o,a){t.log("%c reportMyActivity - me active changed","color:red;font-weight:bold",a+"->"+r+"("+o+")"),K&&z&&z.verbose&&z.record(e.TelemetryEvent.Activity,{action:"user",active:r,reason:o,meActiveChangedDelay:U,doc_hidden:document&&document.hidden,doc_visibility_state:document&&document.visibilityState}),e.clearInterval(n),r&&X()&&!Q()&&(i(),n=e.setInterval(i,D))},j.active.changed(l(U,r)),x.restored((function(){Z(!1,B),Q()||ie().then((function(){Z(!0)})).finally((function(){return function(){for(var e in q)q[e].fetchOnce&&q[e].get()}()}))})),x.connected.when(!1,(function(){Z(!1)}))}))})),ee("id",{source:"uri"}),ee("displayName",{source:"name",parse:f}),ee("endpointUri",{source:"endpointUri"}),ee("title",{source:"title"}),ee("department",{source:"department"}),ee("emails",{source:"emailAddresses",isCollection:!0,parse:function(e){return n(e||[],(function(e){return v({type:w(null),emailAddress:w(e)})}))}}),ee("email",{source:"emailAddresses",parse:function(e){return e&&e[0]||""}}),j.phoneNumbers=te("phoneNumbers",{source:"phones",isCollection:!0,parse:function(e){return n(e||[],(function(e){var n=e.properties,i=n&&n.type&&n.type.charAt(0).toUpperCase()+n.type.slice(1),r=n&&n.number,o=t.Person.extractPhoneNumber(r)
	return{type:w(i),telUri:w(r),displayString:w(o)}}))},fetchAll:function(e){return h.waitAll(n(e.links("phone"),(function(e){return x.send("GET",e.href)})))}}),j.note=v({text:te("note.text",{source:"note",fetchOnce:!0,parse:function(e){return f(e&&e.message)},compose:function(e){return e&&e.message?i(e):{message:e,type:j.note.type()||"Personal"}}}),type:te("note.type",{source:"note",parse:function(e){return e&&e.type}}).asReadOnly()}),j.location=te("location",{source:"location",fetchOnce:!0,parse:function(e){return f(e&&e.location)},compose:function(e){return{location:e}}}),o(j.location,{type:w("Unknown"),street:w(null),city:w(null),state:w(null),country:w(null),postalCode:w(null)}),j.status=te("status",{source:"presence",value:"Offline",fetchOnce:!0,parse:function(e){return e?t.Person.fixStatus(e.availability):"Offline"},compose:function(e){var t={}
	return t.availability=e,t}}),j.activity=te("activity",{source:"presence",parse:function(e){return f(e&&e.activity)}}).asReadOnly(),j.endpointType=te("endpointType",{source:"presence",parse:function(e){return t.Person.fixDeviceType(e&&e.deviceType)}}).asReadOnly(),j.isBlocked=w(!1),j.lastSeenAt=te("lastSeenAt",{source:"presence",parse:function(e){return e&&d(e.lastActive)}}).asReadOnly(),j.note.reset=function(){return G.advanceTo(V.Available).then((function(){return x.send("POST",{rel:"note"},{priority:100,data:{}})})).then((function(e){return null}))},j.status.reset=function(){return G.advanceTo(V.Available).then((function(){return x.send("POST",{rel:"presence"},{priority:100,data:{}})})).then((function(e){return null}))},j.location.reset=function(){return G.advanceTo(V.Available).then((function(){return x.send("POST",{rel:"location"},{priority:100,data:{}})})).then((function(e){return null}))}
	var J=ee("avatarUrl",{source:"photo"}),Z=g.bool(!1)
	function ee(e,t){r(!j[e])
	var n=t&&t.source,i=t&&t.parse||function(e){return e},o=(t&&t.isCollection?b:g)({get:function(){return T||(T=$.then((function(){return x.send("GET",{rel:"me"})})).finally((function(){T=null}))),T.then((function(){return o()}))}})
	return o.fetchOnce=!1,q[e]=o,j[e]=o.asReadOnly(),$.then((function(e){e.updated((function(){e.has(n)&&o(i(e.get(n)))})),e.deleted((function(){o(i(void 0))}))})),o}function te(t,n){r(!j[t])
	var i=n.source,o={rel:i},a=n.parse,s=n.compose,c=n.fetchAll,l=n.fetchOnce,d={},p=(n&&n.isCollection?b:g)({subscribed:v,value:n.value,get:function(){return $.then((function(){return x.exists(o)?m():v()}))},set:function(t){return t===d?(d={},t):(z&&z.record(e.TelemetryEvent.MeSet,{rel:i}),G.advanceTo(V.Available).then((function(){return ne(i,s(t))})).then((function(){return p()})))}})
	function f(e){return d=e,p(e),e}function m(){return H[i]=H[i]||x.send("GET",o).finally((function(){H[i]=null})),H[i].then((function(e){return h.wait(c?c(e):e.properties).then(a).then(f)}))}function v(){return G.advanceTo(V.Available).then(m)}return x.event((function(e){e.type in{updated:1,added:1}&&e.target&&e.target.rel==o.rel?m():"deleted"==e.type&&e.target&&e.target.rel==o.rel&&f(a(void 0))})),$.then((function(){x.exists(o)&&(u(x.get(o).properties)?l&&m():f(a(x.get(o).properties)))})),p.fetchOnce=l,q[t]=p,p}function ne(e,t){var n=x.get({rel:e})
	return ne[e]=ne[e]||a((function(t){var r=i(n.properties)
	return s(t,(function(e){o(r,e)})),x.send("POST",{rel:e},{data:r,priority:100,nobatch:!0})}),1/0),ne[e](t,0)}function ie(){var t=Z.reason===B,n=X()
	return z&&z.verbose&&z.record(e.TelemetryEvent.MeMakeAvailable,{available:Z(),isReconnecting:t,policyAlreadyChecked:n,isUserMigrated:Q(),teamsAsDefaultClient:j._teamsAsDefaultClient()}),n||j._clientUpdatePolicy.once(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	return function(e){return t.indexOf(e)>=0}}(j._clientUpdatePolicy,"showNotification","redirectClient","none"),(function(){return ie()})),$.then((function(i){var r=[],o=[]
	if(I()&&r.push("Plain"),A()&&r.push("Html"),M()&&o.push("Messaging"),k()&&o.push("PhoneAudio"),O()&&o.push("Audio"),N()&&o.push("Video"),P()&&o.push("ApplicationSharing"),z&&z.verbose&&z.record(e.TelemetryEvent.MeMakeAvailable,{available:Z(),isReconnecting:t,policyAlreadyChecked:n,isUserMigrated:Q(),hasReportMyActivity:x.exists({rel:"reportMyActivity"}),teamsAsDefaultClient:j._teamsAsDefaultClient()}),n&&!Q()&&(t||!x.exists({rel:"reportMyActivity"}))){F(!1)
	var a=h.run((function(){if(i.hasLink("makeMeAvailable")){var t=x.send("POST",i.link("makeMeAvailable").href,{data:{SupportedModalities:o,SupportedMessageFormats:r,preferredDesktopEndpoint:Y},priority:100,nobatch:!0})
	return z&&z.monitor(t,e.TelemetryEvent.MeMakeAvailable,{supportedModalities:o&&o.join(),supportedFormats:r&&r.join(),preferredDesktopEndpoint:Y},{sendEndEventOnly:!0}),t}if(L&&L()){var n=x.get({rel:"communication"}),a=n.has("supportedMessageFormats")
	if(!a||a&&n.get("supportedMessageFormats")!=r){var s=n.get()
	s.supportedMessageFormats=r
	var c=x.send("PUT",{rel:"communication"},{data:s,priority:100,nobatch:!0})
	return z&&z.monitor(c,e.TelemetryEvent.Communication,{supportedFormats:r&&r.join()},{sendEndEventOnly:!0}),c}}}))
	return a.finally((function(){return x.send("GET",{rel:"me"},{nobatch:!0})}))}}))}j.available=Z.fork((function(e){if(Z()&&!e)throw new Error("cannot downgrade the availability by calling me.available(false)")
	return!Z()&&e?G.advanceTo(V.Available).then((function(){return Z(e),e})):e})),j.active=g.bool(!0),j.account=w(null),j._clientUpdatePolicy=g.just(""),j._teamsAsDefaultClient=E(0),j.capabilities=v({chat:o(M,{text:I.fork(F),html:A.fork(F)}),pstn:k.fork(F),audio:O.fork(F),video:N.fork(F),screenSharing:P.fork(F),dataCollaboration:w(!1),conferencing:R}),L&&L.changed(q.displayName),$.then((function(e){p(W,t.sHref,e.href),e.updated((function n(){e.hasLink("photo")&&!J()&&(e.updated.off(n),t.Person.getPhotoUrl({ucwa:x,path:e.link("photo").href}).catch((function(){return e.link("photo").href})).then((function(e){J(e)})))}))}))
	try{var re=x.get(x.app.relatedHref("communication")),oe=re.get("supportedModalities",[]),ae=re.get("supportedMessageFormats",[])
	ae.indexOf("Plain")>=0&&I(!0),ae.indexOf("Html")>=0&&A(!0),oe.indexOf("PhoneAudio")>=0&&k(!0),oe.indexOf("Audio")>=0&&O(!0),oe.indexOf("Video")>=0&&N(!0),oe.indexOf("ApplicationSharing")>=0&&P(!0)}catch(_){}return o(j,t.Person.prototype,{preferences:b.empty,firstName:w(null),lastName:w(null),office:w(null),company:w(null)})}
	t.MePerson=x})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.map,i=e.Utils.find,r=e.Utils.guid,o=e.Utils.clone,a=e.Utils.async,s=e.Utils.check,c=e.Utils.assert,l=e.Utils.extend,u=e.Utils.random,d=e.Utils.indexOf,p=e.Utils.inherit,f=e.Utils.isArray,m=e.Utils.isString,h=e.Utils.contains,v=e.Utils.isPrimitive,g=e.Utils.isDictionary,y=e.Utils.timeStampToDate,b=e.Utils.convertHtmlToText,_=e.Utils.convertTextToHtml,E=e.Utils.disableHtmlInText,w=e.Utils.Task,S=e.Utils.Model,x=e.Utils.SipUri,C=e.Utils.Symbol,T=e.Utils.Command,I=e.Utils.DataUri,A=e.Utils.Property,M=e.Utils.Collection,O=e.Utils.StringEnum,k=e.Utils.ConstProperty,N=e.Utils.EAlreadyExists,P=e.Utils.EInvalidArgument,R=t.Modality.State.Created,L=t.Modality.State.Notified,D=t.Modality.State.Connected,U=t.Modality.State.Connecting,F=t.Modality.State.Disconnected,B=C("status"),V=C("starting"),G=function(C){var G,H,q,W,j,z,K,Y,Q,X,$,J,Z=C.ucwa,ee=C.conversation,te=C.rInvitation,ne=C.guestName,ie=C.tm,re=C.settings,oe=ee.participants,ae=ee.selfParticipant,se=ee.topic,ce=ee.priority,le=ee.threadId,ue=M(),de=M(),pe=M(),fe=A(),me=O("Unknown","UserAccepted","AutoAccepted","ConnectedElsewhere","Other"),he=A(me.Unknown),ve=ne&&ne(),ge=M({get:function(){var e=G.get("negotiatedMessageFormats"),t=n(e,(function(e){return"Plain"==e?"Text":e}))
	return O.apply(null,t)}}),ye=S({state:fe.asReadOnly(),acceptType:he.asReadOnly(),messages:ue.asReadOnly(),shouldNotify:function(){return!0},supportedMessageFormats:ge.asReadOnly(),typingParticipantNames:pe.asReadOnly(),typingParticipants:de.asReadOnly()})
	function be(e){return i(ee.participants(),(function(n){return n[t.sHref]==e}))}function _e(t,n){try{return I(t.relatedHref(n)||"data:,").data||""}catch(i){return ie&&ie.record(e.TelemetryEvent.ChatMessageDecodingError,{reason:i}),"□"}}function Ee(e){try{return d(G.get("negotiatedMessageFormats"),e)>=0}catch(t){return!1}}function we(e){if("html"in e)return Ee("Html")||!G?{type:"text/html",data:e.html+""}:{type:"text/plain",data:b(e.html+"")}
	if("text"in e)return Ee("Plain")||!Ee("Html")?{type:"text/plain",data:e.text+""}:{type:"text/html",data:_(e.text+"")}
	throw P("message","must contain either `text` or `html` format")}function Se(n){var i=n.link("participant").href,r=n.link("participant").title,o=be(i),a=o&&o.person
	r&&a&&a.displayName()!=r&&((a=p(a)).displayName=k(E(r)))
	var s=new t.Message({href:n.href,participants:oe,sender:a,text:_e(n,"plainMessage"),html:_e(n,"htmlMessage"),direction:t.Message.Direction.Incoming,ucwa:Z})
	!function(e){return z&&z===j&&j.direction()==e.direction()}(s)?(ue.add(s),ie&&ie.record(e.TelemetryEvent.Chat,{action:"receiveMessage",type:ee.isGroupConversation()?"conf":"p2p",format:n.hasLink("htmlMessage")?"html":"plain",joinType:ve&&"anon",callId:Y,remoteType:a&&a.type()})):(z&&z.timestamp._set(s.timestamp()),K&&K(n.href)),j=s}function xe(e){var n=new t.Message({href:e.href,participants:oe,sender:ae.person,ndrs:e.ndrs,text:e.text,html:e.html,status:e.status,time:e.timestamp,direction:t.Message.Direction.Outgoing,ucwa:Z})
	return ue.add(n,e.id||r()),n}function Ce(){c(G,"rel=messaging must be known before starting observing its state"),G.updated((function(){var e=G.get("state","")
	"Disconnected"==e?fe(t.Modality.State.Disconnected):"Connected"==e&&fe(t.Modality.State.Connected),ge.get()}))}function Te(){var e=ee[t.sHref]
	return e?Z.get(e):null}function Ie(){var e=Te()
	return e&&"Conferenced"==e.get("state","")}function Ae(){return ee.meeting&&"Notified"==ee.meeting.state()&&ee.meeting.availableModalities.messaging()}function Me(){return!!te&&"Incoming"==te.get("direction")}function Oe(e){(G=e).deleted((function(){return G=null}))}function ke(e){Oe(Z.get(e)),Ce()}function Ne(){var e=Te()
	!G&&e.hasLink("messaging")&&(ke(e.link("messaging").href),e.updated.off(Ne))}function Pe(e,t,n){var i=A()
	ye[e]=T(a(n),i),fe.changed((function(e){var n=h(t,(function(t){return f(t)?e==t[0]&&fe.reason===t[1]:e==t}))
	i(n)}))}function Re(){Me()?(Y=r(),he(me.Unknown),function(){var n=I(te.relatedHref("message")||"data:,"),i="text/plain"==n.mime?n.data:"",r="text/html"==n.mime?n.data:"",o=Me()?oe(0):ae
	K=A()
	var a=new t.Message({href:K,sender:o.person,participants:oe,text:i,html:r,direction:t.Message.Direction.Incoming,ucwa:Z});(i||r)&&(j=z=a,ue.add(a)),ye.toast=S({sender:o,text:a.text,html:a.html,priority:k(te.get("importance",void 0)),subject:k(E(te.get("subject",void 0)))}),ie&&ie.record(e.TelemetryEvent.Chat,{action:"receiveMessage",type:ee.isGroupConversation()?"conf":"p2p",format:r?"html":"plain",joinType:ve&&"anon",callId:Y,isInvitation:!0,remoteType:o.person&&o.person.type()})}(),fe(L)):(te.hasLink("messaging")&&Oe(Z.get(te.link("messaging").href)),fe(U)),Z.wait({type:"completed",status:"Failure",target:{rel:"messagingInvitation",href:te.href}}).then((function(n){fe(t.Modality.State.Disconnected,n.reason),Me()&&n.reason&&"ConnectedElsewhere"===n.reason.subcode?(he(me.ConnectedElsewhere),ie&&ie.record(e.TelemetryEvent.Chat,{action:"accept",by:"other",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,result:"succeeded",remoteType:oe(0)&&oe(0).person.type()})):Me()&&he(me.Other)})),Z.wait({type:"completed",status:"Success",target:{rel:"messagingInvitation",href:te.href}}).then((function(n){(fe()==L||fe()==U&&!Me())&&(ke(te.link("messaging").href),fe(t.Modality.State.Connected,n.reason)),Me()&&n.reason&&"AutoAccepted"===n.reason.subcode?(he(me.AutoAccepted),ie&&ie.record(e.TelemetryEvent.Chat,{action:"accept",by:"auto",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,result:"succeeded",remoteType:oe(0)&&oe(0).person.type()}),!ee.isGroupConversation()&&oe(0)&&oe(0).person.type&&"ReplayBot"==oe(0).person.type()&&ee.acknowledge.enabled()&&ee.acknowledge()):Me()&&he(me.Other)})).catch((function(e){fe(t.Modality.State.Disconnected,e)}))}return Z.observe("message completed",(function(n){var r=n.resource
	G&&r.link("messaging").href==G.href&&("Incoming"==r.get("direction")?Se(r):i(ue(),(function(e){return e[t.sHref]==r.href}))||xe({href:r.href,text:_e(r,"plainMessage"),html:_e(r,"htmlMessage"),ndrs:r.links("failedDeliveryParticipant"),status:"Success"==n.status?t.Message.Status.Succeeded:t.Message.Status.Failed,timestamp:y(r.get("timeStamp",null))||new e.Date}))})),Z.event((function(e){var t=e.target,n=e.in||{}
	if(G&&G.hasLink("typingParticipants")&&n.href==G.link("typingParticipants").href)if("deleted"==e.type)de.remove(t.href),pe.remove(t.title)
	else if("added"==e.type){var i=be(t.href)
	i&&!de(t.href)&&de.add(i,t.href),t.title&&!pe(t.title)&&pe.add(t.title,t.title)}})),Z.event((function(e){var n=e.resource,i=e.target
	"started"==e.type&&"messagingInvitation"==i.rel&&n.link("conversation").href==ee[t.sHref]&&(te=n,Re())})),Z.event((function(n){var i=n.resource
	"onlineMeeting"===n.target.rel&&"added"===n.type&&i.hasLink("conversation")&&i.link("conversation").href===ee[t.sHref]&&!1===Q&&(Y=r(),ie&&ie.record(e.TelemetryEvent.Chat,{action:"escalate",type:"conf",joinType:ve&&"anon",callId:Y,remoteType:oe(0)&&oe(0).person.type()}))})),Z.event((function(n){var i=n.resource
	"onlineMeetingInvitation"===n.target.rel&&"completed"===n.type&&i.hasLink("conversation")&&i.link("conversation").href===ee[t.sHref]&&(n.reason&&"AutoAccepted"===n.reason.subcode?(he(me.AutoAccepted),ie&&ie.record(e.TelemetryEvent.Chat,{action:"accept",by:"auto",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,result:"succeeded",remoteType:oe(0)&&oe(0).person.type()})):n.reason&&"ConnectedElsewhere"===n.reason.subcode?(he(me.ConnectedElsewhere),ie&&ie.record(e.TelemetryEvent.Chat,{action:"accept",by:"other",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,result:"succeeded",remoteType:oe(0)&&oe(0).person.type()})):he(me.Other))})),Pe("start",[R,[U,V],F],(function(n){var i=(n=n||{}).message
	ve=n.name||ne&&ne()
	var o,a,c,d=n.to,p=void 0===n.context?void 0:(o=n.contextType)&&m(o)&&(o=o.toLowerCase())&&!h(["text/html","text/plain","application/sdp","application/gw-sdp","multipart/alternative"],(function(e){return e==o}))?n.contextType:v(n.context)?"text/x.custom":"application/json",f=v(n.context)?n.context:_stringify(n.context),y=n.timestamp,b=n.boundary,_=n.operationId||r(),E=n.sessionContext||r(),S=fe()===U&&fe.reason===V
	if(n=null,d&&!x.test(d))throw Error(".to must be a valid SIP URI")
	if(i&&!m(i)&&!g(i))throw Error('.message must be a string or a { text: "...", html: "..." } object')
	var C=ee.isGroupConversation()
	return Q=C,m(i)&&(i={text:i}),C||(d?s(0==oe.size(),"ambiguous remote party in 1:1 call"):d=oe(0).uri(),s(d,"the remote participant URI is not specified")),fe(t.Modality.State.Connecting),q=w.run((function(){if(ee.meeting){if(ee.meeting.state()==t.OnlineMeeting.State.Created)return ee.meeting.start({name:ve,uri:ee.uri()})}else if(C)return ee.addMeeting().start({name:ve,uri:ee.uri()})})).then((function(){var e=Te()
	if(!e)return(t=Z.get(Z.app.relatedHref("communication")).link("startMessaging")).rel="startMessaging",t
	var t,n=Z.get(e.link("messaging").href)
	return n.hasLink("addMessaging")?((t=n.link("addMessaging")).rel="addMessaging",t):Z.send("GET",n.href).then((function(e){var t=e.link("addMessaging")
	return t.rel="addMessaging",t}))})).then((function(e){var n={operationId:_,threadId:le()}
	if(Ie()||l(n,{to:"addMessaging"==e.rel?void 0:d,importance:ce(),subject:se(),sessionContext:E}),i){var r=we(i)
	n.message="data:"+r.type+","+I.encodeData(r.data),(c=A())(t.Message.Status.Pending)
	var o=A()
	Z.wait({type:"started",target:{rel:"message"},sender:function(e){return te&&te.link("conversation").href==e.href}}).then((function(e){o(e.target.href)})),a=xe({id:i.id,href:o.asReadOnly(),text:i.text,html:i.html,timestamp:y,status:c})}function s(){var t=void 0!==f&&e.revision>=2?function(e,t,n,i,r){var o="367A2DAE00F7417FB5CEFE6364C97D31",a=_stringify(l({},e,{customContent:"CID:"+o})),s=["--"+r,"Content-Type: application/vnd.microsoft.com.ucwa+json","Content-Length: "+a.length,"",a,"--"+r,"Content-Type: "+n,"Content-Id: "+o,"Content-Disposition: render; handling=optional","",t,"--"+r+"--",""].join("\r\n")
	return{headers:{"Content-Type":"multipart/related;boundary="+r+';type="application/vnd.microsoft.com.ucwa+json"',"Content-Length":s.length,"X-MS-RequiresMinResourceVersion":i},data:s}}(n,f,p,2,b||u()):{data:n}
	return t.nobatch=!0,t}var m=s(),h=Z.send("POST",e.href,m).catch((function(t){if(ee.isThreadIdRejectedError(t))return ee.resetThreadId(),n.threadId=le(),m=s(),Z.send("POST",e.href,m)
	throw t})),v=Z.wait({type:"started",target:{rel:"messagingInvitation"},resource:function(e){return e.get("operationId","")==_||e.get("threadId","")==le()}}).then((function(e){te=e.resource})),g=Z.wait({type:"completed",target:{rel:"messagingInvitation"},resource:function(e){return e.get("operationId","")==_||e.get("threadId","")==le()}}).then((function(e){if("Failure"==e.status)throw t.EInvitationFailed(e.reason,e.debug)
	te=e.resource,Oe(Z.get(te.link("messaging").href)),Ie()&&te.hasLink("acceptedByParticipant")&&Z.send("GET",te.link("acceptedByParticipant").href)}))
	return w.waitAll([h,v,g])})).then((function(){return c&&c(t.Message.Status.Succeeded),Ce(),Ie()&&ee[t.sInternal].inviteParticipants(),fe(t.Modality.State.Connected),a})).catch((function(e){throw fe(t.Modality.State.Disconnected,e),c&&c(t.Message.Status.Failed,e),te&&te.hasLink("cancel")&&Z.send("POST",te.link("cancel").href),e})).finally((function(){q=null})),S||(Y=r(),ie&&ie.monitor(q,e.TelemetryEvent.Chat,{action:"start",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,contextType:p,remoteType:oe(0)&&oe(0).person.type()})),q})),Pe("sendMessage",[R,L,U,D,F],(function(n,i){m(n)&&(n=i&&"html"==i.toLowerCase()?{html:n}:{text:n})
	var a=n[B]||A({value:"Pending"}),s=n[t.sHref]||A(),c=n.id||r()
	if(fe()!=D)return w.run((function(){if(!q&&!W&&fe()!=L){var r=ye.start({message:n})
	return ie&&ie.monitor(r,e.TelemetryEvent.Chat,{action:"sendMessage",type:ee.isGroupConversation()?"conf":"p2p",format:i?i.toLowerCase():"plain",joinType:ve&&"anon",callId:Y,remoteType:oe(0)&&oe(0).person.type()}),r}if(ue(c))throw N("message.id = "+c)
	return xe({id:c,href:s,text:n.text,html:n.html,status:a}),(q||W||ye.accept()).then((function(){return ye.sendMessage(l(n,((e={id:c})[t.sHref]=s,e[B]=a,e)))
	var e})).catch((function(e){throw a(t.Message.Status.Failed,e),e}))}))
	if(ue(c)&&!n[t.sHref])throw N("message.id = "+c)
	var u=we(n)
	if(oe(0)&&oe(0).person.type&&"ReplayBot"==oe(0).person.type())try{u=we(l(o(n),{text:"*****",html:"*****"}))}catch(f){}var d=ue(c)||xe({id:c,href:s,text:n.text,html:n.html,status:a}),p=w.wait(H).then((function(){return Z.send("POST",G.link("sendMessage").href,{headers:{"Content-Type":u.type},data:u.data,nobatch:!0})}))
	return H=p.finally((function(){return H=null})),p.then((function(e){s(e.href)})).catch((function(e){a(t.Message.Status.Failed,e)})),ie&&ie.monitor(p,e.TelemetryEvent.Chat,{action:"sendMessage",type:ee.isGroupConversation()?"conf":"p2p",format:i?i.toLowerCase():"plain",joinType:ve&&"anon",callId:Y,remoteType:oe(0)&&oe(0).person.type()}),p.then((function(){return d}))})),Pe("stop",[t.Modality.State.Connected,t.Modality.State.Connecting],(function(){if(!q){fe(t.Modality.State.Disconnecting)
	var n=Z.send("POST",G.link("stopMessaging").href).then((function(){fe(t.Modality.State.Disconnected)})).catch((function(e){throw fe(t.Modality.State.Connected),e}))
	return ie&&ie.monitor(n,e.TelemetryEvent.Chat,{action:"stop",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,remoteType:oe(0)&&oe(0).person.type()}),n}q.cancel()})),Pe("reject",[t.Modality.State.Notified],(function(n){void 0===n&&(n="Global"),fe(t.Modality.State.Disconnecting)
	var i=w.wait().then((function(){return Ae()?ee.meeting.decline(n):Z.send("POST",te.link("decline").href,{data:{reason:n}})})).then((function(){fe(t.Modality.State.Disconnected)}))
	return ie&&ie.monitor(i,e.TelemetryEvent.Chat,{action:"decline",joinType:ve&&"anon",type:ee.isGroupConversation()?"conf":"p2p",callId:Y,remoteType:oe(0)&&oe(0).person.type()}),i})),Pe("accept",[t.Modality.State.Notified],(function(n){return he(n&&n.acceptType||me.UserAccepted),fe(t.Modality.State.Connecting),Q=ee.isGroupConversation(),W=w.wait(null).then((function(){if(Ae())return ee.meeting.accept().then((function(){return fe(t.Modality.State.Connecting,V),ye.start(n)}))
	var i=Z.send("POST",te.link("accept").href)
	ie&&ie.verbose&&ie.monitor(i,e.TelemetryEvent.Chat,{action:"postAccept",callId:Y,url:te.link("accept").href})
	var r=Z.wait({type:"completed",target:{rel:"messagingInvitation",href:te.href}}).then((function(){Oe(Z.get(te.link("messaging").href))}))
	return ie&&ie.verbose&&ie.monitor(r,e.TelemetryEvent.Chat,{action:"messagingInvitationCompleted",callId:Y,url:te.href}),w.waitAll([i,r]).then((function(){Ce(),fe(t.Modality.State.Connected)}))})).catch((function(e){throw fe(t.Modality.State.Disconnected,e),e})).finally((function(){W=null})),ie&&ie.monitor(W,e.TelemetryEvent.Chat,{action:"accept",by:"user",type:ee.isGroupConversation()?"conf":"p2p",joinType:ve&&"anon",callId:Y,url:te.href,remoteType:oe(0)&&oe(0).person.type()}),W})),Pe("sendIsTyping",[t.Modality.State.Connected],(function(){return Z.send("POST",G.link("setIsTyping").href,{nobatch:!0})})),X=Te(),$=X&&X.hasLink("messaging")&&X.link("messaging").href,(J=$&&Z.exists($)&&Z.get($))&&"Connected"==J.get("state",null)?(fe(t.Modality.State.Connected),ke(Te().link("messaging").href),Y=r()):te?(Re(),re&&re.replayBot&&oe(0)&&oe(0).uri()&&oe(0).uri().toLowerCase().indexOf(re.replayBot.sipUri||"replaybot@domain.com")>=0&&e.setTimeout((function(){ye.accept({acceptType:me.AutoAccepted})}),2e3)):Ae()||fe(t.Modality.State.Created),fe.when(t.Modality.State.Disconnected,(function(e){z=null,K=null,j=null,(e&&"NotFound"==e.code||"Disconnected"==ee.state()&&!ee[t.sHref])&&(G=null,te=null)})),ee.state.when(t.Conversation.State.Disconnected,(function(e){return fe(t.Modality.State.Disconnected,e)})),ee.changed&&ee.changed((function(){Ae()&&(Y=r(),he(me.Unknown),fe(t.Modality.State.Notified),ee.meeting.state.when(t.OnlineMeeting.State.Connected,(function(){var e=Te()
	G||q||W||(e.hasLink("messaging")?ke(e.link("messaging").href):e.updated(Ne))})),ee.meeting.state.when(t.OnlineMeeting.State.Disconnected,(function(){return fe(t.Modality.State.Disconnected)})))})),t.watch("ChatService::state",fe),ye}
	t.ChatService=G,function(e){e.Options||(e.Options={})}(G=t.ChatService||(t.ChatService={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.bind,i=e.Utils.assert,r=e.Utils.foreach,o=e.Utils.inherit,a=e.Utils.isString,s=e.Utils.isEmptyObject,c=e.Utils.disableHtmlInText,l=e.Utils.setHiddenProperty,u=e.Utils.Enum,d=e.Utils.Task,p=e.Utils.Model,f=e.Utils.Command,m=e.Utils.Property,h=e.Utils.Exception,v=e.Utils.Collection,g=e.Utils.BoolProperty,y=e.Utils.ConstProperty,b=e.Utils.EDoesNotExist,_=e.Utils.EInvalidArgument,E=e.Utils.SequentialStateMachine,w=function w(S){var x,C=S.contactManager,T=S.ucwa,I=S.tm,A=a(S.href)?y(S.href):S.href,M=S.name,O=S.uri,k=y(!!S.isLocal),N=S.convState||y(null),P=A()&&T.get(A()),R=u("PureHref","Fetched"),L=E(R.PureHref),D=m({value:!1}),U=m({value:t.Modality.State.Disconnected}),F=m({value:w.State.Disconnected}),B=S.inConference,V=g(),G={},H={},q=0,W=m({value:t.Modality.State.Disconnected}),j=m({value:!1}),z=m({value:!1}),K=m({value:!1}),Y=m(),Q=m({value:O,set:function(e){if(e&&function(e){return e=e.toLowerCase(),G.uri()&&G.uri().toLowerCase()==e||G.workPhoneNumber()&&G.workPhoneNumber().toLowerCase()==e||G.otherPhoneNumber()&&G.otherPhoneNumber().toLowerCase()==e||ie.phoneNumbers.contains((function(t){return t.telUri()&&t.telUri.toLowerCase()==e}))}(e))return e
	throw _("endpoint","the given value is not a valid uri")}}),X=m({value:t.Modality.State.Disconnected}),$=t.MediaStream&&new t.MediaStream,J=v(),Z=m({value:-1}),ee=m({value:-1}),te={},ne=m({value:ae(void 0),get:function(){return ne()||le().then((function(){return ne()}))}}),ie=o(S.person||C.get(ne()||ne)),re=p(),oe=o(re,{state:F.asReadOnly(),person:ie,screenSharing:p({state:y(t.Modality.State.Disconnected),isControlling:y(!1),stream:p({state:y("Stopped"),width:y(0),height:y(0),source:p({sink:p({container:y(null)})})})}),chat:p({isTyping:D.asReadOnly(),state:U.asReadOnly()}),audio:p({state:W.asReadOnly(),isMuted:j.fork(f((function(n){var i=n?"muteAudio":"unmuteAudio",r=T.get(oe[t.sInternal].audioLink)
	return d.run((function(){return r&&r.hasLink(i)?r:T.send("GET",oe[t.sInternal].audioLink)})).then((function(e){if(!e)throw h("CannotMuteUnmuteRemoteParticipant",{reason:"AudioResourceNotFound",type:i})
	if(!e.hasLink(i))throw h("CannotMuteUnmuteRemoteParticipant",{reason:"LinkNotPresent",type:i})
	return T.send("POST",e.link(i).href)})).then((function(){return n})).catch((function(t){throw I&&I.record(e.TelemetryEvent.AudioMuteUnmuteRemoteFailed,{reason:t,type:i}),t}))}),B)),isOnHold:z.asReadOnly(),isSpeaking:K.asReadOnly(),endpoint:Q,isUnmuteRequested:m({value:!1})}),video:p({state:X.asReadOnly(),channels:J,_videoSourceId:ee.asReadOnly()}),isJoined:V.asReadOnly(),reset:function(e){ue(e),D(!1,e),W(t.Modality.State.Disconnected,e),j(!1,e),z(!1,e),K(!1,e),Y(void 0,e),oe.audio.isUnmuteRequested(!1,e),X(t.Modality.State.Disconnected,e),Z(-1,e),ee(-1,e),te={}}})
	function ae(e){return P&&P.hasLink("contact")&&P.link("contact").href||e}function se(){return A.get().then((function(){return ce(),P}))}function ce(){if(!T.exists(A()))throw b(A())
	P||(l(re,t.sHref,A()),(P=T.get(A())).updated((function(){V(!0),r(P.properties,(function(e,t){t in G&&G[t](e)})),r(H,(function(e,t){e.enabled(P.hasLink(t))})),ne(ae(ne())),P.hasLink("participantMessaging")&&U(t.Modality.State.Connected),P.hasLink("participantAudio")&&(oe[t.sInternal].audioLink=P.link("participantAudio").href)})),P.deleted(ue),P.memberships.changed((function(){var e=P.memberships.contains((function(e){return"typingParticipants"==e.rel}))
	D(e)})),P.dirty.changed(fe))}function le(){return se().then((function(){var e=L.advanceTo(R.Fetched)
	return e.then(),e.then()}))}function ue(e){for(var n in F(w.State.Disconnected,e),U(t.Modality.State.Disconnected,e),V(!1,e),H)H[n].enabled(!1,e)}function de(e,t){t=t||e
	var n=m({get:function(){return le().then((function(){return n()}))},unsubscribed:ve,subscribed:function(){he(),se().then((function(){P.has(t)||L.advanceTo(R.Fetched)}))}})
	G[t]=n,oe[e]=n.asReadOnly()}function pe(e){var t=m({unsubscribed:ve,subscribed:function(){he(),se().then((function(){P.hasLink(e)||L.advanceTo(R.Fetched)}))},get:function(){return se().then((function(){return P.hasLink(e)||L.advanceTo(R.Fetched).then((function(){return t()}))}))}})
	H[e]={enabled:t},oe[e]=f(n(me,e),t)}function fe(){P.dirty()&&q>0&&T.send("GET",P.href)}function me(e){return T.send("POST",P.link(e).href)}function he(){q++}function ve(){q--}function ge(e,n){e.changed((function(e,i,r){t.log("Participant ("+(G.displayName()||G.uri()||"")+")::"+n+"::",r+"=>"+e,i)}))}return S=null,t.VideoChannel&&((x=new t.VideoChannel({name:k()?"Self Channel":"Render Channel",isLocal:k()})).stream.setSource($),J.add(x)),de("displayName"),de("name"),de("role"),de("uri"),de("sourceNetwork"),de("workPhoneNumber"),de("otherPhoneNumber"),de("isAnonymous","anonymous"),de("organizer"),pe("admit"),pe("reject"),pe("eject"),pe("promote"),pe("demote"),l(re,t.sInternal,{state:F,audioState:W,videoState:X,isSpeaking:K,audioSourceId:Z,videoSourceId:ee,isInMediaRoster:te,setMediaSourceId:function(e){var n,i,r,o=e.target,a=e.resource,s=o.rel,c=e.in,l=c&&c.rel,u=e.type
	if(i=/^participant(Audio|Video)$/.exec(s))if(n=i[1],"added"==u||"updated"==u){if(!(i=/^(local)?participant$/i.exec(l)))return
	r="local"!=i[1]?+o.title:"Audio"==n?+a.get("audioSourceId",-1):+a.get("videoSourceId",-1),isNaN(r)&&(r=-1),"Audio"==n?(oe[t.sInternal].audioLink=o.href,Z(r)):(oe[t.sInternal].videoLink=o.href,ee(r))}else"deleted"==u&&"Video"==n&&(Z(-1),ee(-1))},isLocal:k,audioOnHold:z,audioMuted:j,videoStartedBeforeHold:Y,setVideoStarted:function(e){i(x.isStarted),x.isStarted._set(e)},setVideoStream:function(t){var n=x.stream,i=n.source.sink.format(),r=n.source.sink.container()
	n.setSource(t||$),e.Media.log("Participant::SetVideoStream  stream %c"+(t&&t._id())+", "+G.displayName(),"color:green;font-weight:bold"),t?(t.source.sink.format(i),t.source.sink.container(r)):(n.source.sink.format(i),n.source.sink.container(r))}}),ge(Z,"audioSourceId"),ge(ee,"videoSourceId"),ge(F,"state"),ge(W,"audio state"),ge(X,"video state"),M&&G.name(M),O&&G.uri(O),G.uri.changed(Q),m.observe([ie.displayName||y(null),G.name,G.uri],(function(e,t,n){return G.displayName(t||e||n||"")})),ie.displayName=G.displayName.asReadOnly().map(c),m.observe([ie.id||y(null),G.uri],(function(e,t){return G.uri(t||e)})),ie.id=G.uri.asReadOnly(),L.defineState(R.Fetched,(function(){if(s(P.properties))return T.send("GET",P.href)})),A.changed((function(){if(P=null,l(re,t.sHref,A()),L.reset(),A())try{ce()}catch(e){}else A.get().then(ce)})),m.observe([U,W,X,N],(function(e,n,i,r){F(r==t.Conversation.State.InLobby?w.State.InLobby:e==t.Modality.State.Connected||n==t.Modality.State.Connected?w.State.Connected:w.State.Disconnected)})),T.observe("participantMessaging deleted",(function(e){var n=e.in
	n&&n.href==A()&&U(t.Modality.State.Disconnected)})),oe}
	t.Participant=w,function(e){(function(e){e.Connected="Connected",e.Disconnected="Disconnected",e.InLobby="InLobby"})(e.State||(e.State={}))}(w=t.Participant||(t.Participant={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.guid,i=e.Utils.Radix,r=e.Utils.Base64,o=new e.Date("1601-01-01T00:00:00Z"),a=6.5536,s=26.2144,c=838.8608,l=2147483648,u=new i(256),d=function(){function t(t,i){if(void 0===t||t instanceof e.Date)this.time=t||new e.Date,this.guid=i||n(),this.next=[]
	else if("string"==typeof t){var d=r.decodeBytes(t)
	if(d.length<22||(d.length-22)%5!=0)throw SyntaxError("Invalid threadId: "+t)
	var p=d.slice(1,6).reverse().concat([1]),f=u.number(p)*a+ +o
	this.time=new e.Date(e.Math.round(f)),this.guid=n.parse(d.slice(6,22)),this.next=[]
	for(var m=22,h=this.time;m<d.length;m+=5){var v=u.number(d.slice(m,m+4).reverse()),g=v>=l?(v-l)*c:v*s,y=new e.Date(+h+g),b=15&d[m+4],_=d[m+4]>>4
	this.next.push({time:y,seqn:b,rand:_}),h=y}}}return t.prototype.toString=function(){var t=[1]
	t.push.apply(t,u.digits((+this.time-+o)/a).slice(0,5).reverse().map((function(e){return 0|e}))),t.push.apply(t,n.bytes(this.guid))
	for(var i=this.time,d=0,p=this.next;d<p.length;d++){for(var f=p[d],m=+f.time-+i,h=u.digits(m/s<e.Math.pow(2,31)?e.Math.round(m/s):e.Math.round(m/c)+l),v=3;v>=0;v--)t.push(h[v]||0)
	t.push((15&f.rand)<<4|15&f.seqn),i=f.time}return r.encodeBytes(t)},t.prototype.push=function(t,n,i){void 0===t&&(t=new e.Date),void 0===n&&(n=16*e.Math.random()|0),void 0===i&&(i=this.next.length),this.next.push({time:t,rand:n,seqn:i})},t.prototype.pop=function(){this.next.pop()},t}()
	t.ThreadId=d})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.AsyncCommand,i=e.Utils.DataUri,r=e.Utils.Exception,o=e.Utils.isPrimitive,a=e.Utils.Model,s=e.Utils.Property,c=e.Utils.setHiddenProperty,l=function(l){var u=l.rExtension,d=l.ucwa,p=l.tm,f=s({value:!0}),m=s(),h=s(),v=s(),g="4f97946f-dfe1-4954-aa51-7cff2c83f070"
	u.updated((function(){var t
	t=i(u.relatedHref("content")||"data:,"),m.set(t.mime),h.set(t.data),v.set(u.get("serviceName")),p&&p.record(e.TelemetryEvent.ConversationExtension,{action:"ucwa_updated"})}))
	var y=a({content:h.asReadOnly(),contentType:m.asReadOnly(),serviceName:v.asReadOnly(),sendData:n((function(t,n,a){if(null==t)throw r("ContentRequired")
	if(null==n)throw r("ContentTypeRequired")
	var s=function(e,t,n){var i=["--"+e,"Content-Type: application/vnd.microsoft.com.ucwa+json","",_stringify({input:"CID:"+g}),"--"+e,"Content-Type: "+n,"Content-Id: "+g,"",t,"--"+e+"--",""].join("\r\n")
	return{headers:{"Content-Type":"multipart/related;boundary="+e+';type="application/vnd.microsoft.com.ucwa+json"'},data:i}}(a||"3cd718e7-a311-4775-8178-e028bb921daa",t=o(t)?t:_stringify(t),n),c=d.send("POST",u.href,s).then((function(e){var t=i(e.relatedHref("result")||"data:,")
	return{content:t.data,contentType:t.mime}}))
	return p&&p.monitor(c,e.TelemetryEvent.ConversationExtension,{action:"send_data",href:u.href}),c}),f)})
	return c(y,t.sHref,u.href),y}
	t.ConversationExtension=l})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.find,i=e.Utils.guid,r=e.Utils.size,o=e.Utils.check,a=e.Utils.sleep,s=e.Utils.assert,c=e.Utils.extend,l=e.Utils.random,u=e.Utils.foreach,d=e.Utils.indexOf,p=e.Utils.inherit,f=e.Utils.contains,m=e.Utils.debounced,h=e.Utils.decorated,v=e.Utils.getOption,g=e.Utils.disableHtmlInText,y=e.Utils.setHiddenProperty,b=e.Utils.Task,_=e.Utils.Event,E=e.Utils.Model,w=e.Utils.Command,S=e.Utils.DataUri,x=e.Utils.WeakMap,C=e.Utils.Promise,T=e.Utils.Property,I=e.Utils.Exception,A=e.Utils.Collection,M=e.Utils.NumProperty,O=e.Utils.BoolProperty,k=e.Utils.AsyncCommand,N=e.Utils.ConstProperty,P=e.Utils.ENotSupported,R=e.Utils.EnabledCommand,L=e.Utils.DisabledAsyncCommand,D=e.Utils.ConstCollection,U=e.Utils.SourcedProperty,F=e.Utils.ComputedProperty,B=e.Utils.EInvalidArgument,V=e.Utils.EnabledAsyncCommand,G=function G(H){var q,W=H.ucwa,j=H.me,z=H.href,K=H.clt,Y=H.contactManager,Q=H.mediaPlugin,X=H.devices,$=H.sharedResources,J=H.rInvitation,Z=H.guestName,ee=H.muteNdrForMeeting,te=!1,ne=T({value:H.threadId||new t.ThreadId+""}),ie=T({value:H.topic||""}),re=T({value:H.priority||"Normal"}),oe=T({value:H.uri||null}),ae=H.tm,se=H.settings,ce=H.participants||A({get:function(){return b.run((function(){return W.send("GET",de.link("participants").href).then((function(e){var t=e.links("participant").map((function(e){return W.get(e.href)})),n=t.map((function(e){return W.send("GET",e.href).catch()}))
	return b.waitAll(n).then((function(){return $e(t)}))}))})).catch()}}),le=J?"onlineMeetingInvitation"==J.rel:!("isConference"in H)||!!v(H,"isConference"),ue=O(le)
	s(ue()||ce.size()<2),H=null
	var de,pe,fe,me=T({value:G.State.Created}),he=A(),ve=new _({added:function(e){return e()}}),ge=T({value:!1}),ye=T({value:!1}),be=T({value:!1}),_e=T({value:!1}),Ee=T({value:!1}),we=T({value:!1}),Se=T.just(!1),xe=T.just(!1),Ce=T.just(!1),Te=T.just(!1),Ie=T.just(!1),Ae=me.equalsAny(G.State.Conferenced,G.State.Conferencing),Me=A(),Oe=A({get:function(){return b.run((function(){if(de.hasLink("conversationExtensions")){var n=W.send("GET",de.link("conversationExtensions").href).then((function(e){var n=e.links("conversationExtension").map((function(e){return e.href}))
	Oe.removeAll((function(e){return n.indexOf(e[t.sHref])<0})),Je(n)}))
	return ae&&ae.monitor(n,e.TelemetryEvent.Conversation,{action:"getConvExtensions",href:de.link("conversationExtensions").href}),n}})).catch()}}),ke=E(),Ne=p(ke,{id:N(i()),threadId:ne.asReadOnly(),changed:ve.observer,state:me.asReadOnly(),isJoiningEnabled:N(!0),topic:ie.fork(w((function(e){return e}),me.equals("Created"))),priority:re.asReadOnly(),uri:oe.asReadOnly(),context:Xe(),attachConvLog:function(e){Pe.push(e)
	var t={Messaging:Se,Audio:xe,Video:Ce,ApplicationSharing:Te,DataCollaboration:Ie}
	for(var n in t)(e.modalities()||[]).indexOf(n)>=0&&t[n].set(!0)},modalities:c(he.asReadOnly(),{chat:Se.asReadOnly(),audio:xe.asReadOnly(),video:Ce.asReadOnly(),screenSharing:Te.asReadOnly(),dataCollaboration:Ie.asReadOnly()}),activeModalities:E({chat:ge.asReadOnly(),audio:ye.asReadOnly(),video:be.asReadOnly(),screenSharing:_e.asReadOnly(),dataCollaboration:Ee.asReadOnly()}),isGroupConversation:ue.asReadOnly(),acknowledge:k(m((function(){return W.send("POST",de.link("userAcknowledged").href)})),we),confirm:V(h([ae&&ae.monitored(e.TelemetryEvent.ConfAck)],(function(){return Ne.meeting.acknowledge()}))),addModality:function(e,n){var i
	return o(e==G.ModalityType.AppSharing,"NotImplemented",{modality:e}),s(!he(e),"AlreadyExists",{item:e}),c(n=n||{},{ucwa:W,contactManager:Y,participants:ce.asReadOnly(),threadId:ne(),rConversation:de,me:j,topic:ie(),priority:re()}),n.resource&&(n.invitation=t.AppSharingInvitation({resource:n.resource,createParticipant:function(e){return new t.Participant({href:e.href,ucwa:W,tm:ae,contactManager:Y,inConference:ue.asReadOnly()})},ucwa:W})),n.mediaPlugin=Q,n.sharedResources=$,i=t.AppSharingModality(n),he.add(i,e),i.state.when("Disconnected",(function(){he.remove(e)})),i},addMeeting:function(){return s(!Ne.meeting),Ne.meeting=new t.OnlineMeeting({ucwa:W,threadId:ne(),subject:ie(),priority:re(),conversation:Ne,contactManager:Y,tm:ae}),Ne.meeting.uri.changed(oe),ve.fire(),Ne.meeting},forceDisconnectConversation:function(e){Ze(e),ge(!1,e),ye(!1,e),be(!1,e),_e(!1,e),Ee(!1,e),we(!1,e),Ne.selfParticipant.reset(e)
	for(var t=0,n=ce();t<n.length;t++)n[t].reset(e)},resetThreadId:function(){var n=ne()
	ne.set(new t.ThreadId+"")
	var i=[]
	for(var r in Ne.activeModalities)Ne.activeModalities[r]()&&i.push(r)
	ae&&ae.record(e.TelemetryEvent.Conversation,{action:"reset_thread_id",threadId:n,newThreadId:ne(),type:ue()?"conf":"p2p",modalities:_stringify(i)})},isThreadIdRejectedError:function(e){return e&&e.rsp&&400==e.rsp.status&&e.rsp.data&&"ParameterValidationFailure"==e.rsp.data.subcode&&e.rsp.data.parameters&&e.rsp.data.parameters[0]&&"threadId"==e.rsp.data.parameters[0].name},leave:k((function(){var e=[]
	if(me()!=G.State.Disconnected){Ne.phoneAudioService&&e.push(Ne.phoneAudioService.stop().catch())
	for(var t=0,n=he();t<n.length;t++){var i=n[t]
	e.push(i.stop().catch())}return e.push(pe.stop().catch()),Ne.audioService&&e.push(Ne.audioService.stop().catch()),b.waitAll(e).then((function(){if(de)return W.send("DELETE",de.href)}))}}),me.map((function(e){return"Created"!=e&&"Disconnected"!=e}))),createParticipant:R(it),participantsCount:ce.size,participants:ce.fork({add:w(rt,me.equalsAny(G.State.Created,G.State.Connected,G.State.Conferenced,G.State.Disconnected)),remove:k((function(e){if("string"==typeof e&&(e=n(ce(),(function(t){return(t.uri()+"").toLowerCase()==(e+"").toLowerCase()}))),"object"==typeof e&&ce.contains((function(t){return t===e})))return b.run((function(){if(e.eject.enabled())return e.eject()
	if("Disconnected"!=e.state())throw I("InvalidState")})).then((function(){ce.removeAll((function(t){return t===e})),Re.delete(e)}))
	throw I("InvalidState")}),ce.reduce((function(e,t){return e||t.eject&&t.eject.enabled()||t.state&&"Disconnected"==t.state()}),!1))}),avatarUrlSmall:N(null),avatarUrlLarge:N(null),createInvitation:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},pendingInvitations:A.empty,spawnedConversation:N(null),extensions:Oe.asReadOnly()}),Pe=[],Re=new x,Le=M(),De=M(0),Ue=O(!1),Fe=F([Ae,Le,De,Ue],(function(e,t,n,i){return e&&(n>t||i)})),Be=new b,Ve=T({get:function(){return Ve()||Be.promise}})
	Ve.changed((function(e){e&&Be&&(Be.resolve(e),Be=null)}))
	var Ge,He=T({value:!1}),qe=T({value:!1})
	function We(e,n,i,r,o){var a=n.person,s=new t.ActivityItem(e,r,{author:a,persons:D([a]),context:N(void 0,P()),status:N(i?"Failed":"Succeeded",o||i)})
	s.isRead(!0),Me.add(s)}function je(e){if(te="Incoming"==(J=e).get("direction"),et(W.get(J.link("conversation").href)),ne.set(J.get("threadId")+""),Ne.context=Xe(),J.hasLink("from")&&te){var n=J.link("from").href
	nt(n,W.get(n).get("name",void 0))}else if(J.hasLink("to")&&!te){var i=J.link("to").href
	0==ce.filter((function(e){return e.person[t.sHref]==i})).size()&&rt(it(Y.get(i)))}me(te?G.State.Incoming:G.State.Connecting),"onlineMeetingInvitation"==J.rel&&(Ne.meeting=new t.OnlineMeeting({ucwa:W,rInvitation:J,from:te?ce(0):q,conversation:Ne,contactManager:Y,tm:ae}),ve.fire())}function ze(){return b.run((function(){var e=de.link("participants").href
	return W.send("GET",e).then((function(e){var i=[]
	ce.each((function(r,o){var a=r[t.sHref],s=n(e.links("participant"),(function(e){return e.href==a}))
	a&&!s&&i.push(o)}))
	for(var r=0,o=i;r<o.length;r++){var a=o[r]
	ce.remove(a)}}))}))}function Ke(e,n){var i=e
	ee&&"Outgoing"==e.direction()&&Ne.isGroupConversation()&&(i=p(e,{status:e.status.map((function(t){return"Failed"==t&&e.status.reason&&"RemoteFailure"==e.status.reason.code?"Succeeded":t}))}))
	var r=new t.ActivityItem("TextMessage",n,i)
	return"Outgoing"==e.direction()&&r.isRead(!0),Me.add(r,n),r}function Ye(){function e(e,t){for(var n=Ne.historyService.activityItems(),i=0;i<n.length;i++){var r=n[i]
	if(r.type()==t&&r.direction()==e.direction()){var o=+r.timestamp()-+e.timestamp()
	if(0==o)return!1
	if(o>0){if(!r.sender&&o<6e4)return!1
	break}}}return!0}function n(e){for(var t=0,n=Me();t<n.length;t++){var i=n[t]
	if("TextMessage"==i.type()){var r=i
	if(r.text()==e.text()&&r.direction()==e.direction())return!1}}return!0}var i=Pe.map((function(i){return i.conversationLogTranscripts.conversationLogTranscript.get().then((function(r){for(var o=0,a=r;o<a.length;o++){var s=a[o],c=s.timeStamp(),l=s.contact.href()
	if(K.test("AudioLog")){var u=s.audioTranscript.status()
	if(u){var d="Ended"==u?"CallEnded":"Connected"==u?"CallStarted":"",p=new t.ActivityItem(d,null,{direction:T.readonly(i.direction()),duration:T.readonly(+s.audioTranscript.duration()||null),timestamp:T.readonly(c),sender:l?Y.get(l):j})
	e(p,d)&&(Me.add(p),p.isRead(!0))}}if(K.test("MessageLog")){var f=s.messageTranscript,m=f.htmlMessage.href(),h=f.plainMessage.href()
	if(m||h){var v=new t.Message({ucwa:W,sender:l?Y.get(l):j,participants:ce.asReadOnly(),time:c,text:h,html:(m||"").replace(/style="[^"]+"[^"]+""/gim,""),direction:l?"Incoming":"Outgoing"})
	n(v)&&Ke(v).isRead(!0)}}}})).catch()}))
	return Pe.length=0,C.all(i).then((function(){}))}function Qe(e){c(e,{ucwa:W,tm:ae,contactManager:Y,inConference:ue.asReadOnly()})
	var n,i,r,o,a,s=new t.Participant(e),l=T(),u=T({value:!1})
	function d(e){if(e){if(!i){var t=r||C.resolve()
	o=i=t.then((function(){return fe.showParticipantVideo(s)})).then((function(){return e})),i.finally((function(){i=null}))}return o}return r||(t=i||C.resolve(),a=r=t.then((function(){return fe.removeParticipantVideo(s)})).then((function(){return e})),r.finally((function(){r=null}))),a}return s.video.channels(0)&&(e.isLocal?(n=s.video.state.map((function(e){return e==t.Modality.State.Connected})),s.video.channels(0).isStarted=T({value:!1,set:w(d,n)})):(s.video.state.changed((function(e){return l(e)})),T.observe([Ae,l],(function(e,n){return u(fe&&"ActiveSpeaker"!=fe.videoMode()&&e&&n==t.Modality.State.Connected)})),s.video.channels(0).isStarted=T({value:!1,set:w(d,u)}))),s}function Xe(){if(J&&"onlineMeetingInvitation"==J.rel){var e=N(J.get("subject",""))
	return e.type=N(void 0),e}var t,n=J&&J.relatedHref("customContent"),i=S(n||"data:,")
	return(t=N("text/json"===i.mime||"application/json"===i.mime?JSON.parse(i.data):i.data)).type=N(i.mime),t}function $e(e){(e=e||W.find((function(e){return"participant"==e.rel&&e.hasLink("conversation")&&e.link("conversation").href==de.href}))).forEach((function(e){e.get("local",!1)?Ve(e.href):nt(e.href,e.get("name",void 0))}))}function Je(e){u(e,(function(e){var n=Oe.index(e)
	if(n<0||null==n){var i=new t.ConversationExtension({ucwa:W,rExtension:W.get(e),tm:ae})
	Oe.add(i,e)}}))}function Ze(e){Ne[t.sHref]=null,z=null,de=null,J=null
	try{var n=new t.ThreadId(ne())
	n.push(),ne.set(n+"")}catch(a){}for(var i=0,r=ce();i<r.length;i++){var o=r[i]
	Re.get(o).set(null)}ue()&&ce.empty(),Le(void 0),De(0),delete Ne.meeting,ve.fire(),me(G.State.Disconnected,e),te=!1}function et(e){z=e.href,de=e,y(Ne,t.sHref,z),de.deleted(Ze),de.updated((function(){function e(e,t,n){!de.has(e)||n&&de.get(e)==n||t(g(""+de.get(e)))}e("state",me,"Disconnected"),e("importance",re),e("subject",ie)})),de.updated((function(){var e=de.get("activeModalities",[])
	ge(d(e,"Messaging")>=0),ye(d(e,"Audio")>=0),be(d(e,"Video")>=0),_e(d(e,"ApplicationSharing")>=0),Ee(d(e,"DataCollaboration")>=0)})),de.updated((function(){we(de.hasLink("userAcknowledged"))}))
	var n=de.updated((function(){de.has("participantCount")&&Le(+de.get("participantCount"))}))
	Le.once((function(e){return e>0&&("adhoc"==oe()||!oe())}),(function(){return n.dispose()})),Ue(!1),a(10).then((function(){return Ue(!0)}))}function tt(e){return n(ce(),(function(n){return n[t.sHref]==e}))}function nt(e,n){return b.run((function(){for(var n={},i=0,o=ce();i<o.length;i++){var a=o[i]
	if(a[t.sHref]==e)return a
	if(!a[t.sHref]){var c=a.person[t.sHref],l=a.person.id()
	s(c||l,"either /contact.href or uri must be known"),n[c||l.toLowerCase()]=a}}if(0==r(n))return null
	if(1==ce.size()&&!ue())return ce(0)
	var u={}
	function d(){var t=W.get(e),i=t.hasLink("contact")&&t.link("contact"),r=t.has("uri")&&t.get("uri")||"",o=i&&n[i.href]||n[r.toLowerCase()]
	if(o)return o
	if(i&&r)throw u}return b.run((function(){return d()||W.send("GET",e).then(d)})).catch((function(e){if(e===u)return null
	throw e}))})).then((function(t){if(t)Re.get(t)(e)
	else{var i=T({value:e})
	s(!W.get(e).get("local",!1)),t=Qe({href:i.asReadOnly(),name:n}),ce.add(t),Re.set(t,i)}}))}function it(e){var n=new b
	n.promise.then()
	var i=T({get:function(){return i()?i():(n||(n=new b).promise.then(),n.promise)}})
	i.changed((function(e){e&&n&&(n.resolve(e),n=null)})),"object"==typeof e&&s(e[t.sHref],"rel=contact is unknown")
	var r,o=Qe(((r={href:i.asReadOnly()})["object"==typeof e?"person":"uri"]=e,r))
	return Re.set(o,i),o}function rt(e){if("string"==typeof e&&(e=it(e)),"object"==typeof e){if(!Re.has(e))throw B("participant","is not created by this conversation")
	if(ce.add(e),"Connected"==me()||"Conferenced"==me())return at(e)}}function ot(){ce.each((function(e){e[t.sHref]||"Disconnected"!=e.state()||at(e)}))}function at(e){return s(!e[t.sHref]&&"Disconnected"==e.state()),e[t.sInternal].state("Connecting"),function(e){return W.send("POST",de.link("addParticipant").href,{data:{to:e}}).then((function(e){return W.wait({type:"completed",target:{rel:"participantInvitation",href:e.href}})})).then((function(e){if("Success"!=e.status)throw t.EInvitationFailed(e.reason)}))}(e.person.id()).then((function(n){return e[t.sInternal].state("Connected")}),(function(n){e[t.sInternal].state("Disconnected",n),We("ParticipantJoinFailed",e,n),ce.removeAll((function(t){return e===t})),Re.delete(e)}))}function st(){se&&!1===se.supportsMessaging||!Ae()||!Ne.meeting||Ne.meeting.state.once(t.OnlineMeeting.State.Connected,(function(){ge()&&Ne.chatService.start.enabled()&&fe.state()!=t.Modality.State.Disconnected&&Ne.chatService.start()}))}function ct(){se&&!1===se.supportsVideo||!Ae()||!Ne.meeting||Ne.meeting.state.once(t.OnlineMeeting.State.Connected,(function(){be()&&Ne.videoService.start.enabled()&&(fe.state()==t.Modality.State.Connected||fe.state()==t.Modality.State.Connecting)&&e.setTimeout((function(){Ne.videoService.start({video:{direction:"recvonly"}})}),0)}))}return W.event((function(e){var n=e.sender,i=e.target,r=e.in
	if(n.href==z&&/^(localParticipant|participant)$/.test(i.rel))if(r)"added"==e.type&&"lobby"==r.rel&&tt(i.href)[t.sInternal].state("InLobby")
	else if("deleted"==e.type)Ae()&&"participant"==i.rel&&b.run((function(){return fe[t.sInternal].onParticipantDeleted(e)})).finally((function(){ce.removeAll((function(e){return e[t.sHref]==i.href}))}))
	else if("added"==e.type)if(De.inc(),"localParticipant"==i.rel)Ve(i.href)
	else{var o=/\/(\w+@\w+\.\w+)$/.exec(i.href)
	nt(i.href,i.title||o&&o[1])}})),W.event((function(e){var n=e.target,i=e.in||{}
	"added"==e.type&&"onlineMeeting"==n.rel&&i.href==z&&(Ne.meeting||(Ne.meeting=new t.OnlineMeeting({ucwa:W,rMeeting:e.resource,conversation:Ne,contactManager:Y,tm:ae}),Ne.creator=Ne.meeting.creator,Ne.meeting.uri.changed(oe),ve.fire()))})),W.event((function(e){"completed"==e.type&&"onlineMeetingInvitation"==e.target.rel&&"Success"==e.status&&e.resource.link("conversation").href==z&&W.send("GET",z)})),W.event((function(e){var t=e.resource
	t&&"conversation"==t.rel&&t.get("threadId","")==ne()&&!de&&et(t)})),W.event((function(e){var t=e.resource
	!z&&"started"==e.type&&t.get("threadId","")==ne()&&/Invitation$/.test(t.rel)&&"Incoming"==t.get("direction","")&&je(t)})),W.event((function(e){var n=e.sender,i=e.target,r=e.in||{}
	if(n.href==z&&Ae()&&"participant"==r.rel&&/^participant(Audio|Video)$/.test(i.rel)){var o=tt(r.href)
	if(o){"added"!=e.type&&"updated"!=e.type&&be()||o[t.sInternal].setMediaSourceId(e)
	var a="deleted"==e.type?t.Modality.State.Disconnected:t.Modality.State.Connected
	"participantAudio"==i.rel?o[t.sInternal].audioState(a):o[t.sInternal].videoState(a)}}})),W.event((function(n){var i=n.sender,r=n.target,o=n.resource
	if(i.href==z&&"conversationExtension"==r.rel)switch(n.type){case"added":var a=new t.ConversationExtension({ucwa:W,rExtension:o,tm:ae})
	Oe.add(a,r.href),ae&&ae.record(e.TelemetryEvent.ConversationExtension,{action:"ucwa_added"})
	break
	case"deleted":Oe.remove(r.href)}})),me.when("Conferenced",(function(e,t){te&&ze()})),function(){var n
	y(ke,t.sHref,z),y(ke,t.sInternal,{inviteParticipants:ot,processInvitation:je}),Ne.participants.sync=ze,z&&(et(W.get(z)),ne.set(de.get("threadId",ne())),$e(),de.hasLink("onlineMeeting")&&(Ne.meeting=new t.OnlineMeeting({ucwa:W,rMeeting:W.get(de.link("onlineMeeting").href),conversation:Ne,contactManager:Y,tm:ae})),1==(n=W.find({rel:"conversationExtensions"}).filter((function(e){return de.hasLink("conversationExtensions")&&de.link("conversationExtensions").href==e.href}))).length&&n[0].hasLink("conversationExtension")&&Je(n[0].links("conversationExtension").map((function(e){return e.href})))),q=Qe({href:Ve.asReadOnly(),person:j,convState:me,isLocal:!0}),Ne.selfParticipant=q,J?je(J):oe()&&(Ne.meeting=new t.OnlineMeeting({ucwa:W,threadId:ne(),subject:ie(),priority:re(),conversation:Ne,contactManager:Y,tm:ae})),Ne.meeting&&Ne.meeting.uri.changed(oe),pe=new t.ChatService({ucwa:W,guestName:Z,conversation:Ne,rInvitation:J&&"messagingInvitation"==J.rel&&J,tm:ae,settings:se}),Ne.chatService=pe,q.chat.state=pe.state.map((function(e){return"Created"==e?"Disconnected":e}))
	var i,r,o,a,s,u=M(0),d=T({value:new e.Date}),p=l(),h=function(e){return p+":"+e}
	pe.messages.added((function(e,t){return Ke(e,h(t))})),pe.messages.removed((function(e,t){return Me.remove(h(t))})),Me.added((function(e){e.isRead()||(u.inc(),e.isRead.once(!0,(function(){return u.dec()}))),e.timestamp()>d()&&d(e.timestamp())})),Ne.historyService=E({activityItems:Me.sort((function(e,t){return e.timestamp()<t.timestamp()})),unreadActivityItemsCount:u.asReadOnly(),isHistoryDisclosed:N(!1),getMoreActivityItems:k(m(Ye),F([ue,ce.size],(function(e,t){return!e&&1==t&&!!K}))),markAllAsRead:V((function(){return Me.each((function(e){return e.isRead(!0)}))})),removeAll:V((function(){return Me.empty()})),addCustomActivityItem:R((function(e,n){Me.add(new t.ActivityItem(e,null,n))})),removeCustomActivityItem:R((function(e){Me.removeAll((function(t){return t.type()==e}))}))}),y(Ne,"addMessageActivityItem",Ke),Ne.lastModificationTimestamp=d.asReadOnly(),Ne.phoneAudioService=t.PhoneAudio&&new t.PhoneAudio({tm:ae,ucwa:W,name:Z,invitation:J&&"phoneAudioInvitation"==J.rel?J:null,conversation:Ne}),fe=t.AudioVideoModality&&new t.AudioVideoModality({ucwa:W,guestName:Z,mediaPlugin:Q,devices:X,participants:ce.asReadOnly(),selfParticipant:q,conversation:Ne,rConversation:de,me:j,rInvitation:J,tm:ae,settings:se}),Ne.audioService=fe&&E({callConnected:fe.connectedAt,state:fe.audioState,start:w(fe.start,F([j.capabilities.audio,fe.audioState,fe.start.enabled],(function(e,n,i){return e&&(n==t.Modality.State.Disconnected||n==t.Modality.State.Notified&&i)}))),stop:w(fe.stop,He),accept:w(fe.accept,F([j.capabilities.audio,fe.audioState],(function(e,n){return e&&n==t.Modality.State.Notified}))),reject:w(fe.decline,fe.audioState.equals(t.Modality.State.Notified)),transfer:fe.transfer,sendDtmf:fe.sendDtmf}),Ne.videoService=fe&&E({state:fe.videoState,start:k((function(e){return fe.start(c(e,{video:!0},"append"))}),F([j.capabilities.video,fe.audioState,fe.videoState,fe.start.enabled],(function(e,n,i,r){return t.log("me.capabilities.video = "+e+", avm.audioState = "+n+", avm.videoState = "+i+", avm.start.enabled = "+r),e&&(i==t.Modality.State.Disconnected||i==t.Modality.State.Notified&&r)&&(n==t.Modality.State.Connected||n==t.Modality.State.Disconnected||n==t.Modality.State.Notified&&r)}))),stop:k((function(){return fe.stop("video")}),qe),accept:k((function(e){return fe.accept(c(e,{video:!0}))}),F([j.capabilities.video,fe.videoState],(function(e,n){return e&&n==t.Modality.State.Notified}))),reject:w(fe.decline,fe.videoState.equals(t.Modality.State.Notified)),maxVideos:N(null),videoMode:fe&&fe.videoMode,activeSpeaker:fe&&fe.activeSpeaker}),Ne.screenSharingService=E({sharer:N(null),sharedResources:A.empty,controller:N(null),controlRequesters:A.empty,requestControl:L(),releaseControl:L(),acceptControlRequest:L(),rejectControlRequest:L(),start:L(),stop:L(),accept:L(),reject:L()}),Ne.fileTransferService=E({files:A.empty,send:L()}),fe&&c(q.audio,{isMuted:fe.muted,isOnHold:fe.onHold,isUnmuteRequested:T({value:!1})}),Ne.creator=Ne.meeting?Ne.meeting.creator:te?ce(0).person:J?q.person:z?W.find((function(e){return/Invitation$/.test(e.rel)&&e.hasLink("conversation")&&"Incoming"==e.get("direction")&&e.link("conversation").href==de.href})).length>0?ce(0).person:Ne.selfParticipant.person:q.person,me.changed((function(){switch(me()){case G.State.Connecting:case G.State.Connected:ue(!1)
	break
	case G.State.Conferencing:case G.State.Conferenced:ue(!0)}})),oe.changed((function(){oe()&&ue(!0)})),ce.size.changed((function(){switch(me()){case G.State.Created:case G.State.Disconnected:ue(ce.size()>1||le)}})),function(e){me.when("Conferenced",(function(){We("ParticipantJoined",e),me.once("Disconnected",(function(t){We("ParticipantLeft",e,null,null,t)}))})),ce.added((function(e){e.isJoined.changed((function(t){Fe()&&We(t?"ParticipantJoined":"ParticipantLeft",e)}))}))}(q),function(n){var i,r,o,a,s,c
	function l(e,n,i){var r=new t.ActivityItem(e,null,{direction:N(n),duration:N(i||null)})
	return r.isRead(!0),Me.add(r),r}function u(e){"AcceptedByOtherInstance"==e||e&&"ConnectedElsewhere"==e.subcode||l("CallMissed","Incoming"),i=null}function d(){c=l("CallStarted",te?"Incoming":"Outgoing"),o&&(o.dispose(),o=null),r=null,a=n.once("Connecting",f),s=n.once("Disconnected",m)}function p(){r&&(r.dispose(),r=null)}function f(){s&&(s.dispose(),s=null),a=null}function m(){l("CallEnded",te?"Incoming":"Outgoing",e.Math.round((e.Date.now()-c.timestamp())/1e3)),a&&(a.dispose(),a=null),s=null}n.when("Notified",(function(){i=n.once("Disconnected",u)})),n.when("Connecting",(function(){i&&(i.dispose(),i=null),r=n.once("Connected",d),o=n.once("Disconnected",p)}))}(q.audio.state),Ne.avatarUrl=(r=U(),ue.when(!1,(function(){i=ce.size.when(1,(function(){return r.setSource(ce(0).person.avatarUrl)}))})),ue.when(!0,(function(){r.setSource(N(null)),i&&(i.dispose(),i=null)})),r.asReadOnly()),ge.when(!0,st),be.when(!0,ct),fe&&(Ge=F([fe.state,fe.audioState],(function(e,n){return e==t.Modality.State.Connected&&n==t.Modality.State.Connected})),Ge.when(!0,ct)),fe&&(s=[fe.audioState,fe.videoState],Ae()||(o=T(),a=T(),q.audio.state.changed(o),q.video.state.changed(a),s.push(o),s.push(a)),T.observe(s,(function(e,n,i,r){var o=[t.Modality.State.Connected,t.Modality.State.Connecting],a=f(o,(function(t){return e==t}))
	!Ae()&&i&&(a=a&&f(o,(function(e){return i==e})))
	var s=f(o,(function(e){return n==e}))
	!Ae()&&r&&(s=s&&f(o,(function(e){return r==e}))),He(a),qe(s)})))}(),Ne}
	t.Conversation=G,function(e){(function(e){e.Created="Created",e.Conferenced="Conferenced",e.Conferencing="Conferencing",e.Connected="Connected",e.Connecting="Connecting",e.Disconnected="Disconnected",e.Disconnecting="Disconnecting",e.Incoming="Incoming",e.InLobby="InLobby"})(e.State||(e.State={})),function(e){e.AppSharing="AppSharing"}(e.ModalityType||(e.ModalityType={}))}(G=t.Conversation||(t.Conversation={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.find,i=e.Utils.hash,a=e.Utils.assert,s=e.Utils.extend,c=e.Utils.filter,l=e.Utils.isVoid,u=e.Utils.foreach,d=e.Utils.isString,p=e.Utils.debounced,f=e.Utils.decorated,m=e.Utils.getOption,h=e.Utils.isDictionary,v=e.Utils.isNotEmptyString,g=e.Utils.disableHtmlInText,y=e.Utils.Task,b=e.Utils.Model,_=e.Utils.Promise,E=e.Utils.Property,w=e.Utils.Exception,S=e.Utils.Collection,x=e.Utils.NumProperty,C=e.Utils.AsyncCommand,T=e.Utils.ConstProperty,I=e.Utils.EnabledCommand,A=function(A){var M=A.ucwa,O=A.me,k=A.gcs,N=A.contactManager,P=A.convLogSettings,R=A.mediaPlugin,L=A.devices,D=A.sharedResources,U=A.guestName,F=A.muteNdrForMeeting,B=A.tm,V=A.settings,G=this,H=S({subscribed:function(){return H.get()},get:function(){return M.send("GET",{rel:"conversations"}).then((function(e){var n=function(e){return H.contains((function(n){return n[t.sHref]==e}))},i=e.links("conversation").filter((function(e){return!n(e.href)})).map((function(e){return M.send("GET",e.href).then((function(e){return y.waitAll([M.send("GET",e.link("localParticipant").href),M.send("GET",e.link("messaging").href),e.hasLink("onlineMeeting")&&M.send("GET",e.link("onlineMeeting").href).then((function(e){var n=H().filter((function(e){return!e[t.sHref]&&!!e.uri()})).map((function(e){return e.uri().toLowerCase()})),i=e.get("onlineMeetingUri","").toLowerCase()
	if(n.indexOf(i)>=0)throw i}))])})).then((function(){if(n(e.href))throw e
	var t=K({href:e.href,threadId:M.get(e.href).get("threadId")})
	return ee(t),t.participants.get()})).catch()}))
	return y.waitAll(i).then((function(){return null}))}))}}),q=t.ObservableResource(M,{rel:"myOnlineMeetings"},(function(e){e.collection("myOnlineMeeting",[function(e){return new t.MyOnlineMeeting(M,{href:e,tm:B})}])})).myOnlineMeeting,W=(k?k.conversationHistory:T(null)).map((function(e){return"Enabled"==e}),(function(e){return e?"Enabled":"Disabled"})),j=E({value:!0}),z=x(0)
	function K(e){return s(e,{ucwa:M,me:O,clt:X,guestName:U,sharedResources:D,contactManager:N,mediaPlugin:R,devices:L,muteNdrForMeeting:F,tm:B,settings:V}),new t.Conversation(e)}function Y(e,n){a(l(n)||h(n)),n=n||{}
	var i=c(H(),(function(n){return 1==n.participants.size()&&!n.isGroupConversation()&&(d(e)?n.participants(0).person.id().toLowerCase()===e.toLowerCase():n.participants(0).person[t.sHref]==e[t.sHref])}))
	if(i.length>0)return i[0]
	var r=K({isConference:!1,threadId:n.threadId,topic:n.topic,priority:n.priority})
	ee(r)
	var o=r.createParticipant(e)
	return r.participants.add(o),"object"==typeof e&&e[t.sHref]&&N.cacheTransientContact(e),r}M.init().then((function(){M.restored((function(){M.send("GET",{rel:"conversations"}).then((function(n){for(var i=n.links("conversation").map((function(e){return e.href})),r=0,o=H();r<o.length;r++){var a=o[r]
	if(-1===i.indexOf(a[t.sHref])&&a.state()!=t.Conversation.State.Disconnected&&a.state()!=t.Conversation.State.Created){var s=[]
	for(var c in a.activeModalities)a.activeModalities[c]()&&s.push(c)
	a.forceDisconnectConversation(w("NotFound")),B&&B.record(e.TelemetryEvent.Conversation,{action:"force_disconnect",threadId:a.threadId(),type:a.isGroupConversation()?"conf":"p2p",modalities:_stringify(s)})}}}))}))
	var n=M.find({rel:"conversation"}).filter((function(e){return e.get("state","")in{Connected:1,Conferenced:1}}))
	u(n,(function(e){ee(K({href:e.href,threadId:e.get("threadId")}))}))}))
	var Q={},X=P&&new RegExp(P.type||"^(Audio|Message)Log$"),$=f([p,B&&B.monitored(e.TelemetryEvent.ConvLogs)],(function(){return r(G,void 0,_,(function(){var n,i,a,s,c,l,u,d,p,f=this
	return o(this,(function(m){switch(m.label){case 0:(n=k.conversationLogs[t.sHref])&&M.get(n).dirty(!0),m.label=1
	case 1:return m.trys.push([1,3,,7]),[4,k.conversationLogs.conversationLog.get()]
	case 2:return m.sent(),[3,7]
	case 3:if(!(i=m.sent())||"RequestFailed"!=i.code||409!=i.rsp.status)throw i
	return M.get(k[t.sHref]).dirty(!0),[4,k.conversationHistory.get()]
	case 4:if("Enabled"==m.sent())throw i
	return[4,k.conversationHistory.set("Enabled")]
	case 5:return m.sent(),M.get(n).dirty(!0),[4,k.conversationLogs.conversationLog.get()]
	case 6:return m.sent(),[3,7]
	case 7:for(a=[],s=M.get({rel:"conversationLogs"}).links("conversationLog"),c=s.slice(0,P.size||20).map((function(e){return k.conversationLogs.conversationLog(e.href)})),l=function(n){if(Q[n[t.sHref]])return"continue"
	Q[n[t.sHref]]=!0
	var i=r(f,void 0,_,(function(){var e,i,r,a,s,c,l
	return o(this,(function(o){switch(o.label){case 0:return i=(e=X).test,[4,n.type.get()]
	case 1:return i.apply(e,[o.sent()])?[4,n.conversationLogRecipient.get()]:[2]
	case 2:return 1!=(r=o.sent()).length?[2]:[4,(a=r[0]).contact.href.get()]
	case 3:return s=o.sent(),c=N.get(s,{sipuri:a.sipUri(),name:a.displayName(),photo:a.contactPhoto.href()}),(l=new t.ThreadId(n.threadId())).push(),Y(c,{threadId:l+"",topic:(n.subject()||"").replace(/^(Missed )?Conversation with (.*)$/i,"")}).attachConvLog(n),[2]}}))}))
	i.catch((function(i){B&&B.record(e.TelemetryEvent.ConvLogs,{result:"failed",reason:i,href:n[t.sHref]})})),a.push(i)},u=0,d=c.reverse();u<d.length;u++)p=d[u],l(p)
	return[4,_.all(a)]
	case 8:return m.sent(),[2]}}))}))}))
	if(P){var J=0,Z=!1
	M.observe("missedItems updated",(function(e){var t=e.resource.get("conversationLogsCount",0)
	t>J&&(J=t,Z&&$())}))}function ee(e){H(e.id())||H.add(e,e.id()),e.historyService.unreadActivityItemsCount.changed((function(){z(H().filter((function(e){return e.historyService.unreadActivityItemsCount()>0})).length)}))}return M.event((function(i){var r=i.resource
	if("started"==i.type&&/^(messaging|audioVideo|phoneAudio|onlineMeeting|applicationSharing)Invitation$/.test(r.rel)){var o=r.get("threadId")+"",a="Incoming"==r.get("direction"),s=n(H(),(function(e){return e.threadId()==o}))
	if(B&&B.verbose&&B.record(e.TelemetryEvent.Conversation,{action:"invitation",threadId:o,type:i.type,rel:r.rel,url:r.href,direction:r.get("direction")}),!s){var c=H().filter((function(e){return e.state()==t.Conversation.State.Disconnected||e.state()==t.Conversation.State.Created}))
	if("onlineMeetingInvitation"==r.rel){var l=r.get("onlineMeetingUri","").toLowerCase()
	s=n(c,(function(e){return(e.uri()+"").toLowerCase()==l}))}else s=n(c,(function(e){if(e.isGroupConversation()||1!=e.participants.size())return!1
	var n=e.participants(0).person
	if(a){var i=M.get(r.link("from").href)
	return(n.id()+"").toLowerCase()==(i.get("uri")+"").toLowerCase()||n[t.sHref]==i.link("contact").href}return n[t.sHref]==r.link("to").href}))
	s&&s[t.sInternal].processInvitation(r)}s||ee(s=K({rInvitation:r,threadId:o,topic:g(r.get("subject","")),priority:r.get("importance","Normal")})),"applicationSharingInvitation"!=r.rel||e.Settings.mediaAgent||s.addModality(t.Conversation.ModalityType.AppSharing,{resource:r})}})),b({conversations:H.asWritable({add:I(ee),remove:I((function(e){return e.leave().catch().then((function(){return H.remove(e.id())}))}))}),unreadConversationsCount:z.asReadOnly(),isHistoryEnabled:s(W,{auto:E.bool(!0)}),createConversation:I((function(e){a(l(e)||h(e))
	var t=K({isConference:m(e=e||{},"isConference",!0),threadId:e.threadId,topic:e.topic,priority:e.priority,participants:e.participants})
	return ee(t),t})),getConversation:I(Y),getConversationByUri:I((function(r,o){a(v(r))
	var s=n(H(),(function(e){return e.uri()==r}))
	if(!s){var c=void 0
	if(o&&o.wac&&r){var l=o.timeStamp||new e.Date
	l.setHours(0,0,0,0),c=new t.ThreadId(l,i(r))+""}ee(s=K({uri:r,threadId:c}))}return s})),getMoreConversations:C(p((function(){if(P){Z=!0
	var n=M.get(k[t.sHref])
	n.updated((function e(){k.conversationLogs[t.sHref]&&(n.updated.off(e),$())})),0!==P.poll&&e.setInterval($,1e3*(P.poll||3600))}return H.get().then((function(){j(!1)}))})),j),syncConversationLogs:$,createMeeting:I((function(){return new t.MyOnlineMeeting(M,{tm:B})})),meetings:q.asReadOnly(),createSearchQuery:I((function(){return new t.ConversationSearchQuery(H)}))})}
	t.ConversationsManager=A})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){(function(t){var n=e.Utils.timeStampToDate,i=e.Utils.DataUri,r=function(e){return t.ObservableResource(e,{rel:"communication"},(function(e){e.member("conversationLogs",(function(e){e.collection("conversationLog",(function(e){e.collection("conversationLogRecipient",(function(e){e.property("sipUri"),e.property("displayName"),e.member("contact",(function(e){return e.property("href")})),e.member("contactPhoto",(function(e){return e.property("href")}))})),e.member("conversationLogTranscripts",(function(e){e.collection("conversationLogTranscript",(function(e){e.member("audioTranscript",(function(e){e.property("status"),e.property("duration")})),e.member("messageTranscript",(function(e){e.member("htmlMessage",(function(e){return e.property("href",(function(e){return i(e).data}))})),e.member("plainMessage",(function(e){return e.property("href",(function(e){return i(e).data}))}))})),e.member("contact",(function(e){return e.property("href")})),e.property("timeStamp",n)}))})),e.property("type"),e.property("subject"),e.property("threadId"),e.property("direction"),e.property("modalities"),e.property("creationTime",n),e.property("totalRecipientsCount")}))})),e.property("conversationHistory"),e.property("audioPreference"),e.property("phoneNumber"),e.property("utcOffset"),e.property("voipFallbackToPhoneAudioTimeOut"),e.command("joinOnlineMeeting")}))}
	t.Communication=r})(t.Internal||(t.Internal={}))})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=t.clone,i={InvalidSetup:{identifier:"InvalidSetup",description:"Please check with the administrator of your tenant."},InternalError:{identifier:"InternalError",description:"An internal error occured. This may be a transient error. Please use exponential retry to try again. Stop retrying after 3 attempts."},Unauthorized:{identifier:"Unauthorized",description:"The user is unauthorized. Make sure the user is authenticated with a valid access token before making the request."}},r={28e3:{code:28e3,message:"The user does not have a valid Skype for Business Online license assigned.",category:i.InvalidSetup.identifier},28001:{code:28001,message:"Internal error while processing Windows authentication or authorization.",category:i.InternalError.identifier},28032:{code:28032,message:"The web ticket is invalid.",category:i.Unauthorized.identifier},28033:{code:28033,message:"The web ticket has expired.",category:i.Unauthorized.identifier},28055:{code:28055,message:"The OAuth token is invalid.",category:i.Unauthorized.identifier},28056:{code:28056,message:"The OAuth token has expired.",category:i.Unauthorized.identifier},28072:{code:28072,message:"The ticket presented could not be verified, a new ticket is required.",category:i.Unauthorized.identifier},28077:{code:28077,message:"Invalid Audience in the web ticket.",category:i.Unauthorized.identifier},28081:{code:28081,message:"No user principal name is found in JWT security token.",category:i.Unauthorized.identifier}},o={1:{code:1,message:"The user appears to be homed on premise. Make sure to home the user online to use this service.",category:i.InvalidSetup.identifier}}
	function a(e){var t=e.headers["X-Ms-Diagnostics"]||""
	return parseInt(t.split(";")[0],10)||null}t.errorMapper={map:function(t,s,c,l){var u=null
	!c||c.status<400||401===c.status||((u=function(e){var t=null
	e&&r[e]&&((t=n(r[e])).category=i[t.category])
	return t}(a(c)))||(u=function(e,t){var r=null
	404==t.status&&e&&/\/autodiscoverservice\.svc\/root\/oauth\/user/i.test(e.url)&&((r=n(o[1])).category=i[o[1].category])
	return r}(s,c)),function(e,t){e&&(t.errorDetails=e)}(u,t),u||l.record(e.TelemetryEvent.UnmappedError,{diagCode:a(c),diagHeader:c.headers&&c.headers["X-Ms-Diagnostics"],code:c.data&&c.data.code,subcode:c.data&&c.data.subcode,status:c.status}))}}})(e.Utils||(e.Utils={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){var n=e.Utils.errorMapper
	t.customAuth={wrap:function(t,i){return function(r,o){return t(r,(function(t){return function(t,n){var i=t.headers.Authorization,r=i&&i.replace("Bearer ","")
	if(r&&!n.defaults.sdk_user_domain)try{var o=JSON.parse(atob(r.split(".")[1])),a=/([\w+-.%]+)@(.*)/i.exec(o.upn)
	a&&3==a.length&&(n.defaults.sdk_user_alias=[a[1],e.TelemetryRecorder.PIIType.Identity],n.defaults.sdk_user_domain=n.oiiPropertyValue(a[2]))}catch(s){}}(t,i),o(t).then((function(e){return n.map(e,t,e,i),e}))}))}}}})(e.Auth||(e.Auth={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){var t;(function(t){var n=e.Utils.guid,i=e.Utils.keys,r=e.Utils.hash,o=e.Utils.async,a=e.Utils.sleep,s=e.Utils.extend,c=e.Utils.indexOf,l=e.Utils.isString,u=e.Utils.getOption,d=e.Utils.sha256Hash,p=e.Utils.errorMapper,f=e.Utils.debug.debugInfo,m=e.Utils.repeatAndExit,h=e.Utils.setHiddenProperty,v=e.Utils.getTimezoneOffsetString,g=e.Utils.Task,y=e.Utils.Model,b=e.Utils.Symbol,E=e.Utils.Command,w=e.Utils.EnvInfo,S=e.Utils.Property,x=e.Utils.Exception,C=e.Utils.StringEnum,T=e.Utils.EnabledCommand,I=e.Utils.DisabledCommand,A=e.Utils.EInvalidArgument,M=e.Stack.UCWA,O=e.Auth.customAuth,k=b("apps"),N=b("contactmanager"),P=function p(b){void 0===b&&(b={}),e.ls.bp.ctor.get()
	var P=S(),L=s(b.settings,e.ls.ctor.get()),D=y(),U=b.ConversationsManager||t.ConversationsManager,F=b.telemetryManager,B=L.cafeTenantToken,V=!!L.muteNdrForMeeting
	L.showTeamsAlert=L.showTeamsAlert||!1
	var G,H,q,W,j,z=new e.TelemetryRecorder(F,B,!1===L.telemetry?{"*":{}}:L.telemetry&&L.telemetry.disabled,L.telemetry&&L.telemetry.ttt,L.tzip_url||"https://swx.cdn.skype.com/jLync/tzip/index.html",!!L.verboseTelemetry),K=S(),Y=n(),Q=!1,X=b.initParams,$=b.ucwa||new M({tm:z,logs:L.logs&&L.logs.ucwa}),J=C("showNotification","redirectClient","none")
	function Z(e,t){var n=S(),i=E(t,n)
	return P.changed((function(t){n(c(e,t)>=0)})),i}function ee(e,t){return Z(e,o(t))}f.api_key=L.apiKey||X&&X.apiKey,z&&L.apiKey&&(z.defaults.api_key=L.apiKey),f.sdk_session=Y,f.correlation_ids=X&&X.correlationIds||{},z&&(L.ttt&&(z.defaults.ttt=!0),z.defaults.sdk_session=Y,z.addCorrelationIds(X)),L.logs&&(L.logs.saveConsole&&(e.Settings.saveConsole=L.logs.saveConsole),L.logs.size&&(e.Settings.logSize=L.logs.size)),e.Settings.logHttp&&(S.srcheck=!0)
	var te=!1===L.supportsSignIn?I(x("ECS")):ee([p.State.SignedOut],(function(t){if(s(t,L.signIn),void 0!==L.onprem&&(t.eopd=L.onprem),"test"==t.cors&&(t.cors=["outlook.office.com","outlook.office365.com"].indexOf(location.hostname)>=0&&["Chrome","Safari","Firefox"].indexOf(w.getBrowserName())>=0),location&&(/\.force\.com$/.test(location.hostname)?(t.id="f07523aa-0781-4a59-9628-07c4f659c65c",t.ssrels="applications|root|xframe"):/\.homedepot\.com$/.test(location.hostname)&&(t.origins=t.origins||[],l(t.origins)&&(t.origins=[t.origins]),t.origins.push("webdir3a.online.lync.com"))),z&&t.version&&(z.defaults.appVersion=t.version),f.client_id=t.client_id,z&&t.client_id&&(z.defaults.client_id=t.client_id),z&&(z.defaults.signInType=t.client_id||t.get_oauth_token?"online":"onprem",f.signin_type=z.defaults.signInType),z&&t.ecws&&(z.defaults.ecws=t.ecws),L.retry&&(t.retry=L.retry),G=!(!t.meeting&&!t.name),t.name&&K(t.name),t.meeting){if(!t.name)throw A("name","Default display name in anonymous meetings is required.")
	delete t.name}if(L.lockEndpointId){if(t.id)throw new Error(".id cannot be set as it is computed automatically")
	if(!t.version)throw new Error(".version is mandatory")
	t.id=r(t.version)}t.auth&&(t.auth=O.wrap(t.auth,z))
	var n=D.personsAndGroupsManager.mePerson.capabilities
	function i(e,t,n){var i=void 0!==e,r=void 0!==t
	return i&&r?e&&t:i&&!r?e:r?t:n}void 0!==L.enableInternalNS&&(t.enableInternalNS=L.enableInternalNS),t.defaultDelay=L.defaultDelay>=0?L.defaultDelay:60,n.chat.text(u(L,"supportsText",i(L.supportsMessaging,t.supportsMessaging,!0))),n.chat.html(u(L,"supportsHtml",i(L.supportsMessaging,t.supportsMessaging,!0))),n.audio(i(L.supportsAudio,t.supportsAudio,t.enableInternalNS)),n.video(i(L.supportsVideo,t.supportsVideo,t.enableInternalNS)),n.screenSharing(i(L.supportsSharing,t.supportsSharing,t.enableInternalNS)),L.remotePresenceOnlyMode&&(L.events=!1),void 0!==L.events&&(t.events=L.events),t.user=t.user||{isActive:D.personsAndGroupsManager.mePerson.active.asReadOnly(),inactivityTimeout:L.userInactivityTimeout||9e5},t.supportsWebRtc=e.Media&&e.Media.isWebRtc()
	var o=X&&X.correlationIds&&X.correlationIds.hostProperty||F&&F.hostname
	o&&(t.hostProperty=o),f.host_property=o,P(p.State.SigningIn)
	var a={}
	function c(e,t){D.personsAndGroupsManager.mePerson._teamsAsDefaultClient(e|t<<1)}function d(e){return e&&"string"==typeof e&&"teams"==e.toLowerCase()}if(W=new g("Checking client policy"),H=$.init(t).then((function(n){var i,r,o
	return L.showTeamsAlert?(r=L.checkClientPolicyInterval||864e5,o=function(){e.clearInterval(i)
	try{if(D.personsAndGroupsManager.mePerson._clientUpdatePolicy()===J.redirectClient)return}catch(n){if("Disconnected"===n.message)return
	throw n}$.send("GET",{rel:"policies"},{nobatch:!0}).then((function(e){if(c(d(e.has("chatDefaultClient")&&e.get("chatDefaultClient")),d(e.has("callingDefaultClient")&&e.get("callingDefaultClient"))),e.has(J.showNotification)&&e.has(J.redirectClient)){var n="Enabled"===e.get(J.showNotification)
	"Enabled"===e.get(J.redirectClient)?($.removeEventChannel(),$.deleteAppTemp().then((function(){t.events=!1,t.ecws=!1,L.events=!1,$.init(t).then((function(){$.removeEventChannel(),D.personsAndGroupsManager.mePerson._clientUpdatePolicy(J.redirectClient),D.personsAndGroupsManager.mePerson.active._set(!1),D.personsAndGroupsManager.mePerson.status._set("Offline"),W.resolve()}))}))):(D.personsAndGroupsManager.mePerson._clientUpdatePolicy(n?J.showNotification:J.none),W.resolve())}else D.personsAndGroupsManager.mePerson._clientUpdatePolicy(J.none),W.resolve()}),(function(e){throw R(e,L.signIn,z),P(p.State.SignedOut,e),e})),i=e.setInterval(o,r)},o()):(D.personsAndGroupsManager.mePerson._clientUpdatePolicy(J.none),c(d(D.policies.chatDefaultClient()),d(D.policies.callingDefaultClient())),W.resolve()),W.promise.then((function(){if(P(p.State.SignedIn),t.name)if(t.join_url)a.anon_join_type="onprem"
	else if(t.root&&(t.token||t.auth)){var e=$.exists({rel:"ms:rtc:saas:discover"})
	a.anon_join_type=e?"resource_forest":"p2p"}}))}),(function(e){throw R(e,L.signIn,z),P(p.State.SignedOut,e),e})),z){for(var m in t){var h=t[m],v=typeof h
	a["sp_"+m]=/number|boolean/.test(v)?h:"string"==v?"<hash:"+r(h)+">":"<type:"+v+">"}z.monitor(H,e.TelemetryEvent.SignIn,a,{timeout:18e4})}return H})),ne=ee(i(p.State),(function(){switch(P()){case p.State.SignedOut:return
	case p.State.SigningIn:return P(p.State.SigningOut),H.cancel(x("SignedOut")),H.catch()
	case p.State.SigningOut:return q
	case p.State.SignedIn:return P(p.State.SigningOut),q=$.deleteApp().then((function(e){P(p.State.SignedOut)}),(function(e){throw P(p.State.SignedOut,e),e})),z&&z.monitor(q,e.TelemetryEvent.SignOut,{timeout:1e4}),q}})),ie=ee([p.State.SignedIn],(function(e){var t=D.conversationsManager.createConversation({isConference:!1,topic:e.topic,priority:e.priority,threadId:e.threadId})
	return t.chatService.start({to:e.to,message:e.message,context:e.context,contextType:e.contextType,boundary:e.boundary,operationId:e.operationId,sessionContext:e.sessionContext}).then((function(){return t}))})),re=ee([p.State.SignedIn],(function(e){var t=D.conversationsManager.createConversation({isConference:!1,threadId:e.threadId})
	return(e.video?t.videoService.start(e):t.audioService.start(e)).then((function(){return t}))})),oe=ee([p.State.SignedIn],(function(e){var n=D.conversationsManager.createConversation({isConference:!1,threadId:e.threadId})
	return n.addModality(t.Conversation.ModalityType.AppSharing).start(e).then((function(){return n}))})),ae=ee([p.State.SignedIn],(function(e){void 0===e&&(e={})
	var t=D.conversationsManager.createConversation({isConference:!0,topic:e.topic,priority:e.priority,threadId:e.threadId})
	return t.addMeeting().start({uri:e.uri,name:e.name}).then((function(){return t.chatService.start()})).then((function(){return t}))})),se=Z([p.State.SignedIn],(function(){return $.getSnapshot()})),ce=S({value:!1})
	function le(){if(L.replayBot)if(P()==p.State.SignedIn)if($.exists({rel:"replayMessage"}))if(j.isHistoryEnabled())ce(!1,x("ConversationHistoryEnabled"))
	else{try{if(e.localStorage.getItem(L.replayBot.key))return void ce(!1,x("AlreadyReplayed-LS"))}catch(t){}try{if(new RegExp("\\breplaybot="+L.replayBot.key,"i").test(document.cookie))return void ce(!1,x("AlreadyReplayed-Cookie"))}catch(t){return void ce(!1,x("CookieReadFailure"))}ce(!0,"NoPriorState"),Q=!0}else ce(!1,x("Unsupported"))
	else ce(!1,x("NotSignedIn"))
	else ce(!1,x("DisabledByECS"))}var ue=E((function(t,n,i,r){var o=["--ef12279a-4107-40f9-8191-3765f3ebb9b1","Content-Type: application/json","",_stringify({idleTimeoutInSeconds:L.replayBot.idleTimeoutInSeconds,replayDisplayName:t,replayMessage:"CID:1",terminationMessage:"CID:2",toastMessage:r}),"--ef12279a-4107-40f9-8191-3765f3ebb9b1","Content-Type: text/html","Content-Id: 1","",n,"--ef12279a-4107-40f9-8191-3765f3ebb9b1","Content-Type: text/html","Content-Id: 2","",i,"--ef12279a-4107-40f9-8191-3765f3ebb9b1--",""].join("\r\n"),a=$.send("POST",{rel:"replayMessage"},{headers:{"Content-Type":'multipart/related;boundary=ef12279a-4107-40f9-8191-3765f3ebb9b1;type="application/json"'},data:o}).then((function(t){try{e.localStorage.setItem(L.replayBot.key,"true")}catch(n){}try{document.cookie="replaybot="+L.replayBot.key+";max-age=15552000"}catch(n){}})).finally(le)
	return z&&z.monitor(a,e.TelemetryEvent.ReplayMessage,{displayName:t}),a}),ce)
	return e.isUnitTested||(e.window[k]||h(e.window,k,[]),e.window[k].push(D)),function(){P(p.State.SignedOut),D.suspended=$.suspended,h(D,"ucwa",$)
	var n=new t.Communication($),i=new t.MePerson($,{guestName:K.asReadOnly(),supportsConferencing:n.joinOnlineMeeting.enabled.asReadOnly(),reportMyActivityInterval:L.reportMyActivityInterval,sendActivityTelemetry:!!L.sendActivityTelemetry,meActiveChangedDelay:L.meActiveChangedDelay,preferredDesktopEndpoint:L.pde,tm:z}),r=new t.PresenceSubscriptionManager($,{maxBatchSize:L.presenceSubscriptionsBatchSize,duration:L.presenceSubscriptionDuration,tm:z}),o=new t.ContactManager({ucwa:$,psm:r,settings:L.contactManager,tm:z})
	h(D,N,o)
	var s=t.MediaPlugin&&new t.MediaPlugin($,z,L),c=e.Media&&e.Media.useBrowserMedia()?t.WebRtcDevicesManager&&new t.WebRtcDevicesManager($):t.PluginDevicesManager&&new t.PluginDevicesManager({mediaPlugin:s,msi:L.plugin&&L.plugin.download&&L.plugin.download.msi,pkg:L.plugin&&L.plugin.download&&L.plugin.download.pkg,dmg:L.plugin&&L.plugin.download&&L.plugin.download.dmg,tm:z}),l=t.SharedResources&&t.SharedResources(s),u=new t.PersonsAndGroupsManager({ucwa:$,psm:r,contactmgr:o,remoteSearchResultsOnly:L.remoteSearchResultsOnly,me:i,tm:z,settings:L.pgm})
	j=new U({ucwa:$,me:i,gcs:n,guestName:K.asReadOnly(),mediaPlugin:s,contactManager:o,devices:c,sharedResources:l,convLogSettings:L.convLogSettings,muteNdrForMeeting:V,tm:z,settings:L}),D.mediaPolicies=t.MediaPolicies&&new t.MediaPolicies($),D.personsAndGroupsManager=u,D.conversationsManager=j,D.windows=l&&l.windows,D.monitors=l&&l.monitors,D.policies=new t.GeneralPolicies($),D.devicesManager=c,D.connected=$.connected,D.collectOII=S({value:z&&z.collectOII,set:function(e){return z.collectOII=e,e}}),P.when(p.State.SignedIn,(function(){z&&L.heartbeat&&e.setInterval((function(){z.record(e.TelemetryEvent.Heartbeat)}),1e3*L.heartbeat),e.setTimeout((function(){$.connected()||z&&z.record(e.TelemetryEvent.EventChannel,{result:"timeout",timeout:60,status:$.ecstatus(),reason:$.connected.reason})}),6e4),e.setTimeout((function(){$.connected()||z&&z.record(e.TelemetryEvent.EventChannel,{result:"timeout",timeout:300,status:$.ecstatus(),reason:$.connected.reason})}),3e5),$.connected.when(!0,(function(){z&&z.record(e.TelemetryEvent.EventChannel,{result:"connected"})}))
	var t=$.connected.when(!1,(function(t,n){P()!==p.State.SigningOut&&n&&(z&&z.record(e.TelemetryEvent.EventChannel,{result:"lost",state:P(),reason:t}),R(t,L.signIn,z),P(p.State.SignedOut,t))}))
	$.appDeleted.once(!0,(function(e){R(e,L.signIn,z),P(p.State.SignedOut,e)})),!1!==L.events&&i.available(!0),z&&(z.defaults.signed_in_at=(new e.Date).toISOString(),i.id.changed((function(t,n,i){t=/^sip(?:%3A|:)/i.test(t)?t.substring(4):t,z.defaults.sdk_user_id=t?d(t):void 0
	var r=/([\w+-.%]+)@(.*)/i.exec(t)
	r&&3==r.length&&(z.defaults.sdk_user_alias=[r[1],e.TelemetryRecorder.PIIType.Identity],z.defaults.sdk_user_domain=z.oiiPropertyValue(r[2]),f.sdk_user_domain=r[2])})))
	try{var r=$.get({rel:"ms:rtc:saas:discover"}).get("conferenceId")
	j.getConversationByUri(r)}catch(_){}le(),L.disableConversationHistory||G||!1===L.events||j.isHistoryEnabled.set.enabled.once(!0,(function(){if(j.isHistoryEnabled.auto()){var e=Q?L.replayBot.convHistoryEnableDelay||960:4.12
	m((function(t){return a(e).then((function(){return e*=2,j.isHistoryEnabled.set(!0).then((function(){return n.utcOffset.set(v())})).then(t,(function(e){if("RequestFailed"!=e.code||412!=e.rsp.status)throw e}))}))}))}})),P.once(p.State.SignedOut,(function(e){le(),c&&c.uninit(),s&&s.uninitMedia(),z&&delete z.defaults.sdk_user_id,t.dispose(),$.uninit(e)}))}))}(),s(D,{signInManager:y({state:P.asReadOnly(),createPasswordSignInParameter:T((function(e){return s(e,{type:"Password"})})),createImplicitOAuthSignInParameter:T((function(e){return s(e,{type:"ImplicitOAuth"})})),signIn:te,signOut:ne}),startMessaging:ie,startAudioVideo:re,startAppSharing:oe,startMeeting:ae,getSnapshot:se,getErrorReport:function(){var e=_stringify({session:Y,logs:L.logs&&L.logs.ucwa&&$.logs,snapshot:L.logs&&L.logs.ucwa&&$.getSnapshot()})
	e=(e=(e=(e=e.replace(/([-\.\w]+@[-\.\w]+)/gim,"<<$1>>")).replace(/\x22(data:text\/\w+(?:;charset=utf-8)?,)(.+?)\x22/gim,'"$1<<$2>>"')).replace(/(\/messages\x22\],\[\x22)(.+?)(\x22\])/gim,"$1<<$2>>$3")).replace(/\x22(name|title|department|company|workPhoneNumber|subject)\x22:\x22(.*?)\x22/gim,'"$1":"<<$2>>"')
	var t={},n=0
	return e.replace(/<<(.+?)>>/gim,(function(e,i){return"PII-"+(t[i]=t[i]||++n)}))},conversationsManager:j,replayMessage:ue})}
	function R(e,t,n){if(e&&"object"==typeof e){var i=e.rsp||e.response||{},r=t&&t.noretry,o=r&&r.indexOf("onprem")>=0&&i.data&&"NotFound"==i.data.code&&404==i.status&&e.req&&/\/autodiscoverservice\.svc\/root\/oauth\/user/i.test(e.req.url),a=r&&r.indexOf("notsfbuser")>=0&&i&&i.headers&&/^28000/.test(i.headers["X-Ms-Diagnostics"]),c=r&&r.indexOf("403crossdomain")>=0&&i&&403==i.status&&i.headers&&/^28070/.test(i.headers["X-Ms-Diagnostics"])
	s(e,{debug:{code:i.data&&i.data.code,subcode:i.data&&i.data.subcode,status:i.status,diag:i.headers&&i.headers["X-Ms-Diagnostics"],isRetryable:!(o||a||c)}}),p.map(e,e.req,e.rsp||e.response,n)}}t.Application=P,function(e){e.Options||(e.Options={}),function(e){e.SignedOut="SignedOut",e.SignedIn="SignedIn",e.SigningOut="SigningOut",e.SigningIn="SigningIn"}(e.State||(e.State={}))}(P=t.Application||(t.Application={}))})((t=e.Model||(e.Model={})).Internal||(t.Internal={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(t){(function(n){e.ttt&&(e.ttt.ctor=n.Internal.Application),n.Application=t.isUnitTested?n.Internal.Application:function(t){try{var i=e.$window.localStorage,r="lwsdk.ttt";/^(null|ecs)$/.test(i.getItem(r))&&(t&&t.settings&&t.settings.ttt?i.setItem(r,"ecs"):"ecs"==i.getItem(r)&&i.removeItem(r))}catch(_){}return e.ttt?e.ttt.root(t):new n.Internal.Application(t)}})(t.Model||(t.Model={}))})(e.Web||(e.Web={}))}(t||(t={})),function(e){(function(e){(function(t){try{define("vendor/skypeweb",{Application:t.Application,version:e.version,settings:e.Settings})}catch(_){}})(e.Model||(e.Model={}))})(e.Web||(e.Web={}))}(t||(t={}))}(Skype=window.Skype||{}),define("jCafe",["require","lodash-compat","vendor/skypeweb"],(function(e){var t=e("lodash-compat"),n=e("vendor/skypeweb"),i=t.clone(n)
	return i.Application=function(e){e=e||{}
	var i,r=t.pick(e,"telemetryManager"),o=""
	return e.localStorage.init({encrypt:function(e){return new Promise((function(t){t({response:_stringify(e)})}))},decrypt:function(e){return new Promise((function(t){t({response:JSON.parse(e)})}))}}),r.settings=t.pick(e.settings,(function(e,n){return t.startsWith(n,"supports")})),t.extend(r.settings,{onprem:e.settings.initParams&&e.settings.initParams.onprem,cafeTenantToken:e.settings.telemetry.cafeTenantToken},e.settings.jLync),e.settings.initParams&&e.settings.initParams.correlationIds&&(o=e.settings.initParams.correlationIds.hostProperty),t.extend(r.telemetryManager,{hostname:o,setAuthType:function(e){i=e},getAuthType:function(){return i}}),new n.Application(r)},i.Application.create=i.Application,i}))
	!function(e){var t=this||(0,eval)("this"),n=t.document,i=t.navigator,r=t.jQuery,o=t.JSON;(function(e){"function"==typeof define&&define.amd?define("vendor/knockout",["exports","require"],e):"object"==typeof exports&&"object"==typeof module?e(module.exports||exports):e(t.ko={})})((function(a,s){function c(e,t){return(null===e||typeof e in w)&&e===t}function l(t,n){var i
	return function(){i||(i=E.a.setTimeout((function(){i=e,t()}),n))}}function u(e,t){var n
	return function(){clearTimeout(n),n=E.a.setTimeout(e,t)}}function d(e,t){t&&t!==S?"beforeChange"===t?this.Kb(e):this.Ha(e,t):this.Lb(e)}function p(e,t){null!==t&&t.k&&t.k()}function f(e,t){var n=this.Hc,i=n[A]
	i.R||(this.lb&&this.Ma[t]?(n.Pb(t,e,this.Ma[t]),this.Ma[t]=null,--this.lb):i.r[t]||n.Pb(t,e,i.s?{ia:e}:n.uc(e)))}function m(e,t,n,i){E.d[e]={init:function(e,r,o,a,s){var c,l
	return E.m((function(){var o=E.a.c(r()),a=!n!=!o,u=!l;(u||t||a!==c)&&(u&&E.va.Aa()&&(l=E.a.ua(E.f.childNodes(e),!0)),a?(u||E.f.da(e,E.a.ua(l)),E.eb(i?i(s,o):s,e)):E.f.xa(e),c=a)}),null,{i:e}),{controlsDescendantBindings:!0}}},E.h.ta[e]=!1,E.f.Z[e]=!0}var h,v,g,y,b,_,E=void 0!==a?a:{}
	E.b=function(e,t){for(var n=e.split("."),i=E,r=0;r<n.length-1;r++)i=i[n[r]]
	i[n[n.length-1]]=t},E.G=function(e,t,n){e[t]=n},E.version="3.4.0",E.b("version",E.version),E.options={deferUpdates:!1,useOnlyNativeEvents:!1},E.a=function(){function a(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}function s(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	return e}function c(e,t){return e.__proto__=t,e}function l(e,t,n,i){var r=e[t].match(v)||[]
	E.a.q(n.match(v),(function(e){E.a.pa(r,e,i)})),e[t]=r.join(" ")}var u={__proto__:[]}instanceof Array,d="function"==typeof Symbol,p={},f={}
	p[i&&/Firefox\/2/i.test(i.userAgent)?"KeyboardEvent":"UIEvents"]=["keyup","keydown","keypress"],p.MouseEvents="click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave".split(" "),a(p,(function(e,t){if(t.length)for(var n=0,i=t.length;n<i;n++)f[t[n]]=e}))
	var m={propertychange:!0},h=n&&function(){for(var t=3,i=n.createElement("div"),r=i.getElementsByTagName("i");i.innerHTML="\x3c!--[if gt IE "+ ++t+"]><i></i><![endif]--\x3e",r[0];);return 4<t?t:e}(),v=/\S+/g
	return{cc:["authenticity_token",/^__RequestVerificationToken(_.*)?$/],q:function(e,t){for(var n=0,i=e.length;n<i;n++)t(e[n],n)},o:function(e,t){if("function"==typeof Array.prototype.indexOf)return Array.prototype.indexOf.call(e,t)
	for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n
	return-1},Sb:function(e,t,n){for(var i=0,r=e.length;i<r;i++)if(t.call(n,e[i],i))return e[i]
	return null},La:function(e,t){var n=E.a.o(e,t)
	0<n?e.splice(n,1):0===n&&e.shift()},Tb:function(e){for(var t=[],n=0,i=(e=e||[]).length;n<i;n++)0>E.a.o(t,e[n])&&t.push(e[n])
	return t},fb:function(e,t){for(var n=[],i=0,r=(e=e||[]).length;i<r;i++)n.push(t(e[i],i))
	return n},Ka:function(e,t){for(var n=[],i=0,r=(e=e||[]).length;i<r;i++)t(e[i],i)&&n.push(e[i])
	return n},ra:function(e,t){if(t instanceof Array)e.push.apply(e,t)
	else for(var n=0,i=t.length;n<i;n++)e.push(t[n])
	return e},pa:function(e,t,n){var i=E.a.o(E.a.zb(e),t)
	0>i?n&&e.push(t):n||e.splice(i,1)},ka:u,extend:s,Xa:c,Ya:u?c:s,D:a,Ca:function(e,t){if(!e)return e
	var n,i={}
	for(n in e)e.hasOwnProperty(n)&&(i[n]=t(e[n],n,e))
	return i},ob:function(e){for(;e.firstChild;)E.removeNode(e.firstChild)},jc:function(e){for(var t=((e=E.a.V(e))[0]&&e[0].ownerDocument||n).createElement("div"),i=0,r=e.length;i<r;i++)t.appendChild(E.$(e[i]))
	return t},ua:function(e,t){for(var n=0,i=e.length,r=[];n<i;n++){var o=e[n].cloneNode(!0)
	r.push(t?E.$(o):o)}return r},da:function(e,t){if(E.a.ob(e),t)for(var n=0,i=t.length;n<i;n++)e.appendChild(t[n])},qc:function(e,t){var n=e.nodeType?[e]:e
	if(0<n.length){for(var i=n[0],r=i.parentNode,o=0,a=t.length;o<a;o++)r.insertBefore(t[o],i)
	for(o=0,a=n.length;o<a;o++)E.removeNode(n[o])}},za:function(e,t){if(e.length){for(t=8===t.nodeType&&t.parentNode||t;e.length&&e[0].parentNode!==t;)e.splice(0,1)
	for(;1<e.length&&e[e.length-1].parentNode!==t;)e.length--
	if(1<e.length){var n=e[0],i=e[e.length-1]
	for(e.length=0;n!==i;)e.push(n),n=n.nextSibling
	e.push(i)}}return e},sc:function(e,t){7>h?e.setAttribute("selected",t):e.selected=t},$a:function(t){return null===t||t===e?"":t.trim?t.trim():t.toString().replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},nd:function(e,t){return e=e||"",!(t.length>e.length)&&e.substring(0,t.length)===t},Mc:function(e,t){if(e===t)return!0
	if(11===e.nodeType)return!1
	if(t.contains)return t.contains(3===e.nodeType?e.parentNode:e)
	if(t.compareDocumentPosition)return 16==(16&t.compareDocumentPosition(e))
	for(;e&&e!=t;)e=e.parentNode
	return!!e},nb:function(e){return E.a.Mc(e,e.ownerDocument.documentElement)},Qb:function(e){return!!E.a.Sb(e,E.a.nb)},A:function(e){return e&&e.tagName&&e.tagName.toLowerCase()},Wb:function(e){return E.onError?function(){try{return e.apply(this,arguments)}catch(s){throw E.onError&&E.onError(s),s}}:e},setTimeout:function(e,t){return setTimeout(E.a.Wb(e),t)},$b:function(e){setTimeout((function(){throw E.onError&&E.onError(e),e}),0)},p:function(e,t,n){var i=E.a.Wb(n)
	if(n=h&&m[t],E.options.useOnlyNativeEvents||n||!r)if(n||"function"!=typeof e.addEventListener){if(void 0===e.attachEvent)throw Error("Browser doesn't support addEventListener or attachEvent")
	var o=function(t){i.call(e,t)},a="on"+t
	e.attachEvent(a,o),E.a.F.oa(e,(function(){e.detachEvent(a,o)}))}else e.addEventListener(t,i,!1)
	else r(e).bind(t,i)},Da:function(e,i){if(!e||!e.nodeType)throw Error("element must be a DOM node when calling triggerEvent")
	var o
	if(o=!("input"!==E.a.A(e)||!e.type||"click"!=i.toLowerCase())&&("checkbox"==(o=e.type)||"radio"==o),E.options.useOnlyNativeEvents||!r||o)if("function"==typeof n.createEvent){if("function"!=typeof e.dispatchEvent)throw Error("The supplied element doesn't support dispatchEvent");(o=n.createEvent(f[i]||"HTMLEvents")).initEvent(i,!0,!0,t,0,0,0,0,0,!1,!1,!1,!1,0,e),e.dispatchEvent(o)}else if(o&&e.click)e.click()
	else{if(void 0===e.fireEvent)throw Error("Browser doesn't support triggering events")
	e.fireEvent("on"+i)}else r(e).trigger(i)},c:function(e){return E.H(e)?e():e},zb:function(e){return E.H(e)?e.t():e},bb:function(e,t,n){var i
	t&&("object"==typeof e.classList?(i=e.classList[n?"add":"remove"],E.a.q(t.match(v),(function(t){i.call(e.classList,t)}))):"string"==typeof e.className.baseVal?l(e.className,"baseVal",t,n):l(e,"className",t,n))},Za:function(t,n){var i=E.a.c(n)
	null!==i&&i!==e||(i="")
	var r=E.f.firstChild(t)
	!r||3!=r.nodeType||E.f.nextSibling(r)?E.f.da(t,[t.ownerDocument.createTextNode(i)]):r.data=i,E.a.Rc(t)},rc:function(e,t){if(e.name=t,7>=h)try{e.mergeAttributes(n.createElement("<input name='"+e.name+"'/>"),!1)}catch(s){}},Rc:function(e){9<=h&&(e=1==e.nodeType?e:e.parentNode).style&&(e.style.zoom=e.style.zoom)},Nc:function(e){if(h){var t=e.style.width
	e.style.width=0,e.style.width=t}},hd:function(e,t){e=E.a.c(e),t=E.a.c(t)
	for(var n=[],i=e;i<=t;i++)n.push(i)
	return n},V:function(e){for(var t=[],n=0,i=e.length;n<i;n++)t.push(e[n])
	return t},Yb:function(e){return d?Symbol(e):e},rd:6===h,sd:7===h,C:h,ec:function(e,t){for(var n=E.a.V(e.getElementsByTagName("input")).concat(E.a.V(e.getElementsByTagName("textarea"))),i="string"==typeof t?function(e){return e.name===t}:function(e){return t.test(e.name)},r=[],o=n.length-1;0<=o;o--)i(n[o])&&r.push(n[o])
	return r},ed:function(e){return"string"==typeof e&&(e=E.a.$a(e))?o&&o.parse?o.parse(e):new Function("return "+e)():null},Eb:function(e,t,n){if(!o||!o.stringify)throw Error("Cannot find _stringify(). Some browsers (e.g., IE < 8) don't support it natively, but you can overcome this by adding a script reference to json2.js, downloadable from http://www.json.org/json2.js")
	return o.stringify(E.a.c(e),t,n)},fd:function(e,t,i){var r=(i=i||{}).params||{},o=i.includeFields||this.cc,s=e
	if("object"==typeof e&&"form"===E.a.A(e)){s=e.action
	for(var c=o.length-1;0<=c;c--)for(var l=E.a.ec(e,o[c]),u=l.length-1;0<=u;u--)r[l[u].name]=l[u].value}t=E.a.c(t)
	var d=n.createElement("form")
	for(var p in d.style.display="none",d.action=s,d.method="post",t)(e=n.createElement("input")).type="hidden",e.name=p,e.value=E.a.Eb(E.a.c(t[p])),d.appendChild(e)
	a(r,(function(e,t){var i=n.createElement("input")
	i.type="hidden",i.name=e,i.value=t,d.appendChild(i)})),n.body.appendChild(d),i.submitter?i.submitter(d):d.submit(),setTimeout((function(){d.parentNode.removeChild(d)}),0)}}}(),E.b("utils",E.a),E.b("utils.arrayForEach",E.a.q),E.b("utils.arrayFirst",E.a.Sb),E.b("utils.arrayFilter",E.a.Ka),E.b("utils.arrayGetDistinctValues",E.a.Tb),E.b("utils.arrayIndexOf",E.a.o),E.b("utils.arrayMap",E.a.fb),E.b("utils.arrayPushAll",E.a.ra),E.b("utils.arrayRemoveItem",E.a.La),E.b("utils.extend",E.a.extend),E.b("utils.fieldsIncludedWithJsonPost",E.a.cc),E.b("utils.getFormFields",E.a.ec),E.b("utils.peekObservable",E.a.zb),E.b("utils.postJson",E.a.fd),E.b("utils.parseJson",E.a.ed),E.b("utils.registerEventHandler",E.a.p),E.b("utils.stringifyJson",E.a.Eb),E.b("utils.range",E.a.hd),E.b("utils.toggleDomNodeCssClass",E.a.bb),E.b("utils.triggerEvent",E.a.Da),E.b("utils.unwrapObservable",E.a.c),E.b("utils.objectForEach",E.a.D),E.b("utils.addOrRemoveItem",E.a.pa),E.b("utils.setTextContent",E.a.Za)
	E.b("unwrap",E.a.c),Function.prototype.bind||(Function.prototype.bind=function(e){var t=this
	if(1===arguments.length)return function(){return t.apply(e,arguments)}
	var n=Array.prototype.slice.call(arguments,1)
	return function(){var i=n.slice(0)
	return i.push.apply(i,arguments),t.apply(e,i)}}),E.a.e=new function(){function t(t,o){var a=t[i]
	if(!a||"null"===a||!r[a]){if(!o)return e
	a=t[i]="ko"+n++,r[a]={}}return r[a]}var n=0,i="__ko__"+(new Date).getTime(),r={}
	return{get:function(n,i){var r=t(n,!1)
	return r===e?e:r[i]},set:function(n,i,r){r===e&&t(n,!1)===e||(t(n,!0)[i]=r)},clear:function(e){var t=e[i]
	return!!t&&(delete r[t],e[i]=null,!0)},I:function(){return n+++i}}},E.b("utils.domData",E.a.e),E.b("utils.domData.clear",E.a.e.clear),E.a.F=new function(){function t(t,n){var r=E.a.e.get(t,i)
	return r===e&&n&&(r=[],E.a.e.set(t,i,r)),r}function n(e){if(i=t(e,!1))for(var i=i.slice(0),r=0;r<i.length;r++)i[r](e)
	if(E.a.e.clear(e),E.a.F.cleanExternalData(e),a[e.nodeType])for(i=e.firstChild;e=i;)i=e.nextSibling,8===e.nodeType&&n(e)}var i=E.a.e.I(),o={1:!0,8:!0,9:!0},a={1:!0,9:!0}
	return{oa:function(e,n){if("function"!=typeof n)throw Error("Callback must be a function")
	t(e,!0).push(n)},pc:function(n,r){var o=t(n,!1)
	o&&(E.a.La(o,r),0==o.length&&E.a.e.set(n,i,e))},$:function(e){if(o[e.nodeType]&&(n(e),a[e.nodeType])){var t=[]
	E.a.ra(t,e.getElementsByTagName("*"))
	for(var i=0,r=t.length;i<r;i++)n(t[i])}return e},removeNode:function(e){E.$(e),e.parentNode&&e.parentNode.removeChild(e)},cleanExternalData:function(e){r&&"function"==typeof r.cleanData&&r.cleanData([e])}}},E.$=E.a.F.$,E.removeNode=E.a.F.removeNode,E.b("cleanNode",E.$),E.b("removeNode",E.removeNode),E.b("utils.domNodeDisposal",E.a.F),E.b("utils.domNodeDisposal.addDisposeCallback",E.a.F.oa),E.b("utils.domNodeDisposal.removeDisposeCallback",E.a.F.pc),h=[0,"",""],b={thead:v=[1,"<table>","</table>"],tbody:v,tfoot:v,tr:[2,"<table><tbody>","</tbody></table>"],td:g=[3,"<table><tbody><tr>","</tr></tbody></table>"],th:g,option:y=[1,"<select multiple='multiple'>","</select>"],optgroup:y},_=8>=E.a.C,E.a.ma=function(e,i){var o
	if(r){if(r.parseHTML)o=r.parseHTML(e,i)||[]
	else if((o=r.clean([e],i))&&o[0]){for(var a=o[0];a.parentNode&&11!==a.parentNode.nodeType;)a=a.parentNode
	a.parentNode&&a.parentNode.removeChild(a)}}else{(o=i)||(o=n),a=o.parentWindow||o.defaultView||t
	var s,c=E.a.$a(e).toLowerCase(),l=o.createElement("div")
	for(s=(c=c.match(/^<([a-z]+)[ >]/))&&b[c[1]]||h,c=s[0],s="ignored<div>"+s[1]+e+s[2]+"</div>","function"==typeof a.innerShiv?l.appendChild(a.innerShiv(s)):(_&&o.appendChild(l),l.innerHTML=s,_&&l.parentNode.removeChild(l));c--;)l=l.lastChild
	o=E.a.V(l.lastChild.childNodes)}return o},E.a.Cb=function(t,n){if(E.a.ob(t),null!==(n=E.a.c(n))&&n!==e)if("string"!=typeof n&&(n=n.toString()),r)r(t).html(n)
	else for(var i=E.a.ma(n,t.ownerDocument),o=0;o<i.length;o++)t.appendChild(i[o])},E.b("utils.parseHtmlFragment",E.a.ma),E.b("utils.setHtml",E.a.Cb),E.M=function(){function t(e,n){if(e)if(8==e.nodeType)null!=(i=E.M.lc(e.nodeValue))&&n.push({Lc:e,cd:i})
	else if(1==e.nodeType)for(var i=0,r=e.childNodes,o=r.length;i<o;i++)t(r[i],n)}var n={}
	return{wb:function(e){if("function"!=typeof e)throw Error("You can only pass a function to ko.memoization.memoize()")
	var t=(4294967296*(1+Math.random())|0).toString(16).substring(1)+(4294967296*(1+Math.random())|0).toString(16).substring(1)
	return n[t]=e,"\x3c!--[ko_memo:"+t+"]--\x3e"},xc:function(t,i){var r=n[t]
	if(r===e)throw Error("Couldn't find any memo with ID "+t+". Perhaps it's already been unmemoized.")
	try{return r.apply(null,i||[]),!0}finally{delete n[t]}},yc:function(e,n){var i=[]
	t(e,i)
	for(var r=0,o=i.length;r<o;r++){var a=i[r].Lc,s=[a]
	n&&E.a.ra(s,n),E.M.xc(i[r].cd,s),a.nodeValue="",a.parentNode&&a.parentNode.removeChild(a)}},lc:function(e){return(e=e.match(/^\[ko_memo\:(.*?)\]$/))?e[1]:null}}}(),E.b("memoization",E.M),E.b("memoization.memoize",E.M.wb),E.b("memoization.unmemoize",E.M.xc),E.b("memoization.parseMemoText",E.M.lc),E.b("memoization.unmemoizeDomNodeAndDescendants",E.M.yc),E.Y=function(){function e(){if(o)for(var e,t=o,n=0;s<o;)if(e=r[s++]){if(s>t){if(5e3<=++n){s=o,E.a.$b(Error("'Too much recursion' after processing "+n+" task groups."))
	break}t=o}try{e()}catch(i){E.a.$b(i)}}}function i(){e(),s=o=r.length=0}var r=[],o=0,a=1,s=0
	return{scheduler:t.MutationObserver?function(e){var t=n.createElement("div")
	return new MutationObserver(e).observe(t,{attributes:!0}),function(){t.classList.toggle("foo")}}(i):n&&"onreadystatechange"in n.createElement("script")?function(e){var t=n.createElement("script")
	t.onreadystatechange=function(){t.onreadystatechange=null,n.documentElement.removeChild(t),t=null,e()},n.documentElement.appendChild(t)}:function(e){setTimeout(e,0)},Wa:function(e){return o||E.Y.scheduler(i),r[o++]=e,a++},cancel:function(e){(e-=a-o)>=s&&e<o&&(r[e]=null)},resetForTesting:function(){var e=o-s
	return s=o=r.length=0,e},md:e}}(),E.b("tasks",E.Y),E.b("tasks.schedule",E.Y.Wa),E.b("tasks.runEarly",E.Y.md),E.ya={throttle:function(e,t){e.throttleEvaluation=t
	var n=null
	return E.B({read:e,write:function(i){clearTimeout(n),n=E.a.setTimeout((function(){e(i)}),t)}})},rateLimit:function(e,t){var n,i,r
	"number"==typeof t?n=t:(n=t.timeout,i=t.method),e.cb=!1,r="notifyWhenChangesStop"==i?u:l,e.Ta((function(e){return r(e,n)}))},deferred:function(t,n){if(!0!==n)throw Error("The 'deferred' extender only accepts the value 'true', because it is not supported to turn deferral off once enabled.")
	t.cb||(t.cb=!0,t.Ta((function(n){var i
	return function(){E.Y.cancel(i),i=E.Y.Wa(n),t.notifySubscribers(e,"dirty")}})))},notify:function(e,t){e.equalityComparer="always"==t?null:c}}
	var w={undefined:1,boolean:1,number:1,string:1}
	E.b("extenders",E.ya),E.vc=function(e,t,n){this.ia=e,this.gb=t,this.Kc=n,this.R=!1,E.G(this,"dispose",this.k)},E.vc.prototype.k=function(){this.R=!0,this.Kc()},E.J=function(){E.a.Ya(this,x),x.rb(this)}
	var S="change",x={rb:function(e){e.K={},e.Nb=1},X:function(e,t,n){var i=this
	n=n||S
	var r=new E.vc(i,t?e.bind(t):e,(function(){E.a.La(i.K[n],r),i.Ia&&i.Ia(n)}))
	return i.sa&&i.sa(n),i.K[n]||(i.K[n]=[]),i.K[n].push(r),r},notifySubscribers:function(e,t){if((t=t||S)===S&&this.zc(),this.Pa(t))try{E.l.Ub()
	for(var n,i=this.K[t].slice(0),r=0;n=i[r];++r)n.R||n.gb(e)}finally{E.l.end()}},Na:function(){return this.Nb},Uc:function(e){return this.Na()!==e},zc:function(){++this.Nb},Ta:function(e){var t,n,i,r=this,o=E.H(r)
	r.Ha||(r.Ha=r.notifySubscribers,r.notifySubscribers=d)
	var a=e((function(){r.Mb=!1,o&&i===r&&(i=r()),t=!1,r.tb(n,i)&&r.Ha(n=i)}))
	r.Lb=function(e){r.Mb=t=!0,i=e,a()},r.Kb=function(e){t||(n=e,r.Ha(e,"beforeChange"))}},Pa:function(e){return this.K[e]&&this.K[e].length},Sc:function(e){if(e)return this.K[e]&&this.K[e].length||0
	var t=0
	return E.a.D(this.K,(function(e,n){"dirty"!==e&&(t+=n.length)})),t},tb:function(e,t){return!this.equalityComparer||!this.equalityComparer(e,t)},extend:function(e){var t=this
	return e&&E.a.D(e,(function(e,n){var i=E.ya[e]
	"function"==typeof i&&(t=i(t,n)||t)})),t}}
	E.G(x,"subscribe",x.X),E.G(x,"extend",x.extend),E.G(x,"getSubscriptionsCount",x.Sc),E.a.ka&&E.a.Xa(x,Function.prototype),E.J.fn=x,E.hc=function(e){return null!=e&&"function"==typeof e.X&&"function"==typeof e.notifySubscribers},E.b("subscribable",E.J),E.b("isSubscribable",E.hc),E.va=E.l=function(){function e(e){i.push(n),n=e}function t(){n=i.pop()}var n,i=[],r=0
	return{Ub:e,end:t,oc:function(e){if(n){if(!E.hc(e))throw Error("Only subscribable things can act as dependencies")
	n.gb.call(n.Gc,e,e.Cc||(e.Cc=++r))}},w:function(n,i,r){try{return e(),n.apply(i,r||[])}finally{t()}},Aa:function(){if(n)return n.m.Aa()},Sa:function(){if(n)return n.Sa}}}(),E.b("computedContext",E.va),E.b("computedContext.getDependenciesCount",E.va.Aa),E.b("computedContext.isInitial",E.va.Sa),E.b("ignoreDependencies",E.qd=E.l.w)
	var C=E.a.Yb("_latestValue")
	E.N=function(e){function t(){return 0<arguments.length?(t.tb(t[C],arguments[0])&&(t.ga(),t[C]=arguments[0],t.fa()),this):(E.l.oc(t),t[C])}return t[C]=e,E.a.ka||E.a.extend(t,E.J.fn),E.J.fn.rb(t),E.a.Ya(t,T),E.options.deferUpdates&&E.ya.deferred(t,!0),t}
	var T={equalityComparer:c,t:function(){return this[C]},fa:function(){this.notifySubscribers(this[C])},ga:function(){this.notifySubscribers(this[C],"beforeChange")}}
	E.a.ka&&E.a.Xa(T,E.J.fn)
	var I=E.N.gd="__ko_proto__"
	T[I]=E.N,E.Oa=function(t,n){return null!==t&&t!==e&&t[I]!==e&&(t[I]===n||E.Oa(t[I],n))},E.H=function(e){return E.Oa(e,E.N)},E.Ba=function(e){return!!("function"==typeof e&&e[I]===E.N||"function"==typeof e&&e[I]===E.B&&e.Vc)},E.b("observable",E.N),E.b("isObservable",E.H),E.b("isWriteableObservable",E.Ba),E.b("isWritableObservable",E.Ba),E.b("observable.fn",T),E.G(T,"peek",T.t),E.G(T,"valueHasMutated",T.fa),E.G(T,"valueWillMutate",T.ga),E.la=function(e){if("object"!=typeof(e=e||[])||!("length"in e))throw Error("The argument passed when initializing an observable array must be an array, or null, or undefined.")
	return e=E.N(e),E.a.Ya(e,E.la.fn),e.extend({trackArrayChanges:!0})},E.la.fn={remove:function(e){for(var t=this.t(),n=[],i="function"!=typeof e||E.H(e)?function(t){return t===e}:e,r=0;r<t.length;r++){var o=t[r]
	i(o)&&(0===n.length&&this.ga(),n.push(o),t.splice(r,1),r--)}return n.length&&this.fa(),n},removeAll:function(t){if(t===e){var n=this.t(),i=n.slice(0)
	return this.ga(),n.splice(0,n.length),this.fa(),i}return t?this.remove((function(e){return 0<=E.a.o(t,e)})):[]},destroy:function(e){var t=this.t(),n="function"!=typeof e||E.H(e)?function(t){return t===e}:e
	this.ga()
	for(var i=t.length-1;0<=i;i--)n(t[i])&&(t[i]._destroy=!0)
	this.fa()},destroyAll:function(t){return t===e?this.destroy((function(){return!0})):t?this.destroy((function(e){return 0<=E.a.o(t,e)})):[]},indexOf:function(e){var t=this()
	return E.a.o(t,e)},replace:function(e,t){var n=this.indexOf(e)
	0<=n&&(this.ga(),this.t()[n]=t,this.fa())}},E.a.ka&&E.a.Xa(E.la.fn,E.N.fn),E.a.q("pop push reverse shift sort splice unshift".split(" "),(function(e){E.la.fn[e]=function(){var t=this.t()
	this.ga(),this.Vb(t,e,arguments)
	var n=t[e].apply(t,arguments)
	return this.fa(),n===t?this:n}})),E.a.q(["slice"],(function(e){E.la.fn[e]=function(){var t=this()
	return t[e].apply(t,arguments)}})),E.b("observableArray",E.la),E.ya.trackArrayChanges=function(e,t){function n(){if(!r){r=!0
	var t=e.notifySubscribers
	e.notifySubscribers=function(e,n){return n&&n!==S||++a,t.apply(this,arguments)}
	var n=[].concat(e.t()||[])
	o=null,i=e.X((function(t){var i
	t=[].concat(t||[]),e.Pa("arrayChange")&&((!o||1<a)&&(o=E.a.ib(n,t,e.hb)),i=o),n=t,o=null,a=0,i&&i.length&&e.notifySubscribers(i,"arrayChange")}))}}if(e.hb={},t&&"object"==typeof t&&E.a.extend(e.hb,t),e.hb.sparse=!0,!e.Vb){var i,r=!1,o=null,a=0,s=e.sa,c=e.Ia
	e.sa=function(t){s&&s.call(e,t),"arrayChange"===t&&n()},e.Ia=function(t){c&&c.call(e,t),"arrayChange"!==t||e.Pa("arrayChange")||(i.k(),r=!1)},e.Vb=function(e,t,n){function i(e,t,n){return s[s.length]={status:e,value:t,index:n}}if(r&&!a){var s=[],c=e.length,l=n.length,u=0
	switch(t){case"push":u=c
	case"unshift":for(t=0;t<l;t++)i("added",n[t],u+t)
	break
	case"pop":u=c-1
	case"shift":c&&i("deleted",e[u],u)
	break
	case"splice":t=Math.min(Math.max(0,0>n[0]?c+n[0]:n[0]),c),c=1===l?c:Math.min(t+(n[1]||0),c),l=t+l-2,u=Math.max(c,l)
	for(var d=[],p=[],f=2;t<u;++t,++f)t<c&&p.push(i("deleted",e[t],t)),t<l&&d.push(i("added",n[f],t))
	E.a.dc(p,d)
	break
	default:return}o=s}}}}
	var A=E.a.Yb("_state")
	E.m=E.B=function(t,n,i){function r(){if(0<arguments.length){if("function"!=typeof o)throw Error("Cannot write a value to a ko.computed unless you specify a 'write' option. If you wish to read the current value, don't pass any parameters.")
	return o.apply(a.pb,arguments),this}return E.l.oc(r),(a.S||a.s&&r.Qa())&&r.aa(),a.T}if("object"==typeof t?i=t:(i=i||{},t&&(i.read=t)),"function"!=typeof i.read)throw Error("Pass a function that returns the value of the ko.computed")
	var o=i.write,a={T:e,S:!0,Ra:!1,Fb:!1,R:!1,Va:!1,s:!1,jd:i.read,pb:n||i.owner,i:i.disposeWhenNodeIsRemoved||i.i||null,wa:i.disposeWhen||i.wa,mb:null,r:{},L:0,bc:null}
	return r[A]=a,r.Vc="function"==typeof o,E.a.ka||E.a.extend(r,E.J.fn),E.J.fn.rb(r),E.a.Ya(r,M),i.pure?(a.Va=!0,a.s=!0,E.a.extend(r,O)):i.deferEvaluation&&E.a.extend(r,k),E.options.deferUpdates&&E.ya.deferred(r,!0),a.i&&(a.Fb=!0,a.i.nodeType||(a.i=null)),a.s||i.deferEvaluation||r.aa(),a.i&&r.ba()&&E.a.F.oa(a.i,a.mb=function(){r.k()}),r}
	var M={equalityComparer:c,Aa:function(){return this[A].L},Pb:function(e,t,n){if(this[A].Va&&t===this)throw Error("A 'pure' computed must not be called recursively")
	this[A].r[e]=n,n.Ga=this[A].L++,n.na=t.Na()},Qa:function(){var e,t,n=this[A].r
	for(e in n)if(n.hasOwnProperty(e)&&(t=n[e]).ia.Uc(t.na))return!0},bd:function(){this.Fa&&!this[A].Ra&&this.Fa()},ba:function(){return this[A].S||0<this[A].L},ld:function(){this.Mb||this.ac()},uc:function(e){if(e.cb&&!this[A].i){var t=e.X(this.bd,this,"dirty"),n=e.X(this.ld,this)
	return{ia:e,k:function(){t.k(),n.k()}}}return e.X(this.ac,this)},ac:function(){var e=this,t=e.throttleEvaluation
	t&&0<=t?(clearTimeout(this[A].bc),this[A].bc=E.a.setTimeout((function(){e.aa(!0)}),t)):e.Fa?e.Fa():e.aa(!0)},aa:function(e){var t=this[A],n=t.wa
	if(!t.Ra&&!t.R){if(t.i&&!E.a.nb(t.i)||n&&n()){if(!t.Fb)return void this.k()}else t.Fb=!1
	t.Ra=!0
	try{this.Qc(e)}finally{t.Ra=!1}t.L||this.k()}},Qc:function(t){var n=this[A],i=n.Va?e:!n.L,r={Hc:this,Ma:n.r,lb:n.L}
	E.l.Ub({Gc:r,gb:f,m:this,Sa:i}),n.r={},n.L=0,r=this.Pc(n,r),this.tb(n.T,r)&&(n.s||this.notifySubscribers(n.T,"beforeChange"),n.T=r,n.s?this.zc():t&&this.notifySubscribers(n.T)),i&&this.notifySubscribers(n.T,"awake")},Pc:function(e,t){try{var n=e.jd
	return e.pb?n.call(e.pb):n()}finally{E.l.end(),t.lb&&!e.s&&E.a.D(t.Ma,p),e.S=!1}},t:function(){var e=this[A]
	return(e.S&&!e.L||e.s&&this.Qa())&&this.aa(),e.T},Ta:function(e){E.J.fn.Ta.call(this,e),this.Fa=function(){this.Kb(this[A].T),this[A].S=!0,this.Lb(this)}},k:function(){var e=this[A]
	!e.s&&e.r&&E.a.D(e.r,(function(e,t){t.k&&t.k()})),e.i&&e.mb&&E.a.F.pc(e.i,e.mb),e.r=null,e.L=0,e.R=!0,e.S=!1,e.s=!1,e.i=null}},O={sa:function(e){var t=this,n=t[A]
	if(!n.R&&n.s&&"change"==e){if(n.s=!1,n.S||t.Qa())n.r=null,n.L=0,n.S=!0,t.aa()
	else{var i=[]
	E.a.D(n.r,(function(e,t){i[t.Ga]=e})),E.a.q(i,(function(e,i){var r=n.r[e],o=t.uc(r.ia)
	o.Ga=i,o.na=r.na,n.r[e]=o}))}n.R||t.notifySubscribers(n.T,"awake")}},Ia:function(t){var n=this[A]
	n.R||"change"!=t||this.Pa("change")||(E.a.D(n.r,(function(e,t){t.k&&(n.r[e]={ia:t.ia,Ga:t.Ga,na:t.na},t.k())})),n.s=!0,this.notifySubscribers(e,"asleep"))},Na:function(){var e=this[A]
	return e.s&&(e.S||this.Qa())&&this.aa(),E.J.fn.Na.call(this)}},k={sa:function(e){"change"!=e&&"beforeChange"!=e||this.t()}}
	E.a.ka&&E.a.Xa(M,E.J.fn)
	var N=E.N.gd
	E.m[N]=E.N,M[N]=E.m,E.Xc=function(e){return E.Oa(e,E.m)},E.Yc=function(e){return E.Oa(e,E.m)&&e[A]&&e[A].Va},E.b("computed",E.m),E.b("dependentObservable",E.m),E.b("isComputed",E.Xc),E.b("isPureComputed",E.Yc),E.b("computed.fn",M),E.G(M,"peek",M.t),E.G(M,"dispose",M.k),E.G(M,"isActive",M.ba),E.G(M,"getDependenciesCount",M.Aa),E.nc=function(e,t){return"function"==typeof e?E.m(e,t,{pure:!0}):((e=E.a.extend({},e)).pure=!0,E.m(e,t))},E.b("pureComputed",E.nc),function(){function t(i,r,o){if(o=o||new n,"object"!=typeof(i=r(i))||null===i||i===e||i instanceof RegExp||i instanceof Date||i instanceof String||i instanceof Number||i instanceof Boolean)return i
	var a=i instanceof Array?[]:{}
	return o.save(i,a),function(e,t){if(e instanceof Array){for(var n=0;n<e.length;n++)t(n)
	"function"==typeof e.toJSON&&t("toJSON")}else for(n in e)t(n)}(i,(function(n){var s=r(i[n])
	switch(typeof s){case"boolean":case"number":case"string":case"function":a[n]=s
	break
	case"object":case"undefined":var c=o.get(s)
	a[n]=c!==e?c:t(s,r,o)}})),a}function n(){this.keys=[],this.Ib=[]}E.wc=function(e){if(0==arguments.length)throw Error("When calling ko.toJS, pass the object you want to convert.")
	return t(e,(function(e){for(var t=0;E.H(e)&&10>t;t++)e=e()
	return e}))},E.toJSON=function(e,t,n){return e=E.wc(e),E.a.Eb(e,t,n)},n.prototype={save:function(e,t){var n=E.a.o(this.keys,e)
	0<=n?this.Ib[n]=t:(this.keys.push(e),this.Ib.push(t))},get:function(t){return 0<=(t=E.a.o(this.keys,t))?this.Ib[t]:e}}}(),E.b("toJS",E.wc),E.b("toJSON",E.toJSON),E.j={u:function(t){switch(E.a.A(t)){case"option":return!0===t.__ko__hasDomDataOptionValue__?E.a.e.get(t,E.d.options.xb):7>=E.a.C?t.getAttributeNode("value")&&t.getAttributeNode("value").specified?t.value:t.text:t.value
	case"select":return 0<=t.selectedIndex?E.j.u(t.options[t.selectedIndex]):e
	default:return t.value}},ha:function(t,n,i){switch(E.a.A(t)){case"option":"string"==typeof n?(E.a.e.set(t,E.d.options.xb,e),"__ko__hasDomDataOptionValue__"in t&&delete t.__ko__hasDomDataOptionValue__,t.value=n):(E.a.e.set(t,E.d.options.xb,n),t.__ko__hasDomDataOptionValue__=!0,t.value="number"==typeof n?n:"")
	break
	case"select":""!==n&&null!==n||(n=e)
	for(var r,o=-1,a=0,s=t.options.length;a<s;++a)if((r=E.j.u(t.options[a]))==n||""==r&&n===e){o=a
	break}(i||0<=o||n===e&&1<t.size)&&(t.selectedIndex=o)
	break
	default:null!==n&&n!==e||(n=""),t.value=n}}},E.b("selectExtensions",E.j),E.b("selectExtensions.readValue",E.j.u),E.b("selectExtensions.writeValue",E.j.ha),E.h=function(){function e(e){123===(e=E.a.$a(e)).charCodeAt(0)&&(e=e.slice(1,-1))
	var t,n=[],a=e.match(i),s=[],c=0
	if(a){a.push(",")
	for(var l,u=0;l=a[u];++u){var d=l.charCodeAt(0)
	if(44===d){if(0>=c){n.push(t&&s.length?{key:t,value:s.join("")}:{unknown:t||s.join("")}),t=c=0,s=[]
	continue}}else if(58===d){if(!c&&!t&&1===s.length){t=s.pop()
	continue}}else 47===d&&u&&1<l.length?(d=a[u-1].match(r))&&!o[d[0]]&&((a=(e=e.substr(e.indexOf(l)+1)).match(i)).push(","),u=-1,l="/"):40===d||123===d||91===d?++c:41===d||125===d||93===d?--c:t||s.length||34!==d&&39!==d||(l=l.slice(1,-1))
	s.push(l)}}return n}var t=["true","false","null","undefined"],n=/^(?:[$_a-z][$\w]*|(.+)(\.\s*[$_a-z][$\w]*|\[.+\]))$/i,i=RegExp("\"(?:[^\"\\\\]|\\\\.)*\"|'(?:[^'\\\\]|\\\\.)*'|/(?:[^/\\\\]|\\\\.)*/w*|[^\\s:,/][^,\"'{}()/:[\\]]*[^\\s,\"'{}()/:[\\]]|[^\\s]","g"),r=/[\])"'A-Za-z0-9_$]+$/,o={in:1,return:1,typeof:1},a={}
	return{ta:[],ea:a,yb:e,Ua:function(i,r){function o(e,i){var r
	if(!u){var d=E.getBindingHandler(e)
	if(d&&d.preprocess&&!(i=d.preprocess(i,e,o)))return;(d=a[e])&&(r=i,0<=E.a.o(t,r)?r=!1:(d=r.match(n),r=null!==d&&(d[1]?"Object("+d[1]+")"+d[2]:r)),d=r),d&&c.push("'"+e+"':function(_z){"+r+"=_z}")}l&&(i="function(){return "+i+" }"),s.push("'"+e+"':"+i)}var s=[],c=[],l=(r=r||{}).valueAccessors,u=r.bindingParams,d="string"==typeof i?e(i):i
	return E.a.q(d,(function(e){o(e.key||e.unknown,e.value)})),c.length&&o("_ko_property_writers","{"+c.join(",")+" }"),s.join(",")},ad:function(e,t){for(var n=0;n<e.length;n++)if(e[n].key==t)return!0
	return!1},Ea:function(e,t,n,i,r){e&&E.H(e)?!E.Ba(e)||r&&e.t()===i||e(i):(e=t.get("_ko_property_writers"))&&e[n]&&e[n](i)}}}(),E.b("expressionRewriting",E.h),E.b("expressionRewriting.bindingRewriteValidators",E.h.ta),E.b("expressionRewriting.parseObjectLiteral",E.h.yb),E.b("expressionRewriting.preProcessBindings",E.h.Ua),E.b("expressionRewriting._twoWayBindings",E.h.ea),E.b("jsonExpressionRewriting",E.h),E.b("jsonExpressionRewriting.insertPropertyAccessorsIntoJson",E.h.Ua);(function(){function e(e){return 8==e.nodeType&&a.test(o?e.text:e.nodeValue)}function t(e){return 8==e.nodeType&&s.test(o?e.text:e.nodeValue)}function i(n,i){for(var r=n,o=1,a=[];r=r.nextSibling;){if(t(r)&&0==--o)return a
	a.push(r),e(r)&&o++}if(!i)throw Error("Cannot find closing comment tag to match: "+n.nodeValue)
	return null}function r(e,t){var n=i(e,t)
	return n?0<n.length?n[n.length-1].nextSibling:e.nextSibling:null}var o=n&&"\x3c!--test--\x3e"===n.createComment("test").text,a=o?/^\x3c!--\s*ko(?:\s+([\s\S]+))?\s*--\x3e$/:/^\s*ko(?:\s+([\s\S]+))?\s*$/,s=o?/^\x3c!--\s*\/ko\s*--\x3e$/:/^\s*\/ko\s*$/,c={ul:!0,ol:!0}
	E.f={Z:{},childNodes:function(t){return e(t)?i(t):t.childNodes},xa:function(t){if(e(t))for(var n=0,i=(t=E.f.childNodes(t)).length;n<i;n++)E.removeNode(t[n])
	else E.a.ob(t)},da:function(t,n){if(e(t)){E.f.xa(t)
	for(var i=t.nextSibling,r=0,o=n.length;r<o;r++)i.parentNode.insertBefore(n[r],i)}else E.a.da(t,n)},mc:function(t,n){e(t)?t.parentNode.insertBefore(n,t.nextSibling):t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)},gc:function(t,n,i){i?e(t)?t.parentNode.insertBefore(n,i.nextSibling):i.nextSibling?t.insertBefore(n,i.nextSibling):t.appendChild(n):E.f.mc(t,n)},firstChild:function(n){return e(n)?!n.nextSibling||t(n.nextSibling)?null:n.nextSibling:n.firstChild},nextSibling:function(n){return e(n)&&(n=r(n)),n.nextSibling&&t(n.nextSibling)?null:n.nextSibling},Tc:e,pd:function(e){return(e=(o?e.text:e.nodeValue).match(a))?e[1]:null},kc:function(n){if(c[E.a.A(n)]){var i=n.firstChild
	if(i)do{if(1===i.nodeType){var o,a=null
	if(o=i.firstChild)do{if(a)a.push(o)
	else if(e(o)){var s=r(o,!0)
	s?o=s:a=[o]}else t(o)&&(a=[o])}while(o=o.nextSibling)
	if(o=a)for(a=i.nextSibling,s=0;s<o.length;s++)a?n.insertBefore(o[s],a):n.appendChild(o[s])}}while(i=i.nextSibling)}}}})(),E.b("virtualElements",E.f),E.b("virtualElements.allowedBindings",E.f.Z),E.b("virtualElements.emptyNode",E.f.xa),E.b("virtualElements.insertAfter",E.f.gc),E.b("virtualElements.prepend",E.f.mc),E.b("virtualElements.setDomNodeChildren",E.f.da),E.Q=function(){this.Fc={}},E.a.extend(E.Q.prototype,{nodeHasBindings:function(e){switch(e.nodeType){case 1:return null!=e.getAttribute("data-bind")||E.g.getComponentNameForNode(e)
	case 8:return E.f.Tc(e)
	default:return!1}},getBindings:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e):null
	return E.g.Ob(n,e,t,!1)},getBindingAccessors:function(e,t){var n=(n=this.getBindingsString(e,t))?this.parseBindingsString(n,t,e,{valueAccessors:!0}):null
	return E.g.Ob(n,e,t,!0)},getBindingsString:function(e){switch(e.nodeType){case 1:return e.getAttribute("data-bind")
	case 8:return E.f.pd(e)
	default:return null}},parseBindingsString:function(e,t,n,i){try{var r,o=this.Fc,a=e+(i&&i.valueAccessors||"")
	if(!(r=o[a])){var s,c="with($context){with($data||{}){return{"+E.h.Ua(e,i)+"}}}"
	s=new Function("$context","$element",c),r=o[a]=s}return r(t,n)}catch(l){throw l.message="Unable to parse bindings.\nBindings value: "+e+"\nMessage: "+l.message,l}}}),E.Q.instance=new E.Q,E.b("bindingProvider",E.Q),function(){function n(e){return function(){return e}}function i(e){return e()}function o(e){return E.a.Ca(E.l.w(e),(function(t,n){return function(){return e()[n]}}))}function a(e,t,i){return"function"==typeof e?o(e.bind(null,t,i)):E.a.Ca(e,n)}function s(e,t){return o(this.getBindings.bind(this,e,t))}function c(e,t,n){var i,r=E.f.firstChild(t),o=E.Q.instance,a=o.preprocessNode
	if(a){for(;i=r;)r=E.f.nextSibling(i),a.call(o,i)
	r=E.f.firstChild(t)}for(;i=r;)r=E.f.nextSibling(i),l(e,i,n)}function l(e,t,n){var i=!0,r=1===t.nodeType
	r&&E.f.kc(t),(r&&n||E.Q.instance.nodeHasBindings(t))&&(i=u(t,null,e,n).shouldBindDescendants),i&&!p[E.a.A(t)]&&c(e,t,!r)}function u(t,n,r,o){var a,c,l=E.a.e.get(t,f)
	if(!n){if(l)throw Error("You cannot apply bindings multiple times to the same element.")
	E.a.e.set(t,f,!0)}if(!l&&o&&E.tc(t,r),n&&"function"!=typeof n)a=n
	else{var u=E.Q.instance,d=u.getBindingAccessors||s,p=E.B((function(){return(a=n?n(r,t):d.call(u,t,r))&&r.P&&r.P(),a}),null,{i:t})
	a&&p.ba()||(p=null)}if(a){var m=p?function(e){return function(){return i(p()[e])}}:function(e){return a[e]},h=function(){return E.a.Ca(p?p():a,i)}
	h.get=function(e){return a[e]&&i(m(e))},h.has=function(e){return e in a},o=function(e){var t=[],n={},i=[]
	return E.a.D(e,(function r(o){if(!n[o]){var a=E.getBindingHandler(o)
	a&&(a.after&&(i.push(o),E.a.q(a.after,(function(t){if(e[t]){if(-1!==E.a.o(i,t))throw Error("Cannot combine the following bindings, because they have a cyclic dependency: "+i.join(", "))
	r(t)}})),i.length--),t.push({key:o,fc:a})),n[o]=!0}})),t}(a),E.a.q(o,(function(n){var i=n.fc.init,o=n.fc.update,s=n.key
	if(8===t.nodeType&&!E.f.Z[s])throw Error("The binding '"+s+"' cannot be used with virtual elements")
	try{"function"==typeof i&&E.l.w((function(){var n=i(t,m(s),h,r.$data,r)
	if(n&&n.controlsDescendantBindings){if(c!==e)throw Error("Multiple bindings ("+c+" and "+s+") are trying to control descendant bindings of the same element. You cannot use these bindings together on the same element.")
	c=s}})),"function"==typeof o&&E.B((function(){o(t,m(s),h,r.$data,r)}),null,{i:t})}catch(l){throw l.message='Unable to process binding "'+s+": "+a[s]+'"\nMessage: '+l.message,l}}))}return{shouldBindDescendants:c===e}}function d(e){return e&&e instanceof E.U?e:new E.U(e)}E.d={}
	var p={script:!0,textarea:!0,template:!0}
	E.getBindingHandler=function(e){return E.d[e]},E.U=function(t,n,i,r){var o,a=this,s="function"==typeof t&&!E.H(t),c=E.B((function(){var e=s?t():t,o=E.a.c(e)
	return n?(n.P&&n.P(),E.a.extend(a,n),c&&(a.P=c)):(a.$parents=[],a.$root=o,a.ko=E),a.$rawData=e,a.$data=o,i&&(a[i]=o),r&&r(a,n,o),a.$data}),null,{wa:function(){return o&&!E.a.Qb(o)},i:!0})
	c.ba()&&(a.P=c,c.equalityComparer=null,o=[],c.Ac=function(t){o.push(t),E.a.F.oa(t,(function(t){E.a.La(o,t),o.length||(c.k(),a.P=c=e)}))})},E.U.prototype.createChildContext=function(e,t,n){return new E.U(e,this,t,(function(e,t){e.$parentContext=t,e.$parent=t.$data,e.$parents=(t.$parents||[]).slice(0),e.$parents.unshift(e.$parent),n&&n(e)}))},E.U.prototype.extend=function(e){return new E.U(this.P||this.$data,this,null,(function(t,n){t.$rawData=n.$rawData,E.a.extend(t,"function"==typeof e?e():e)}))}
	var f=E.a.e.I(),m=E.a.e.I()
	E.tc=function(e,t){if(2!=arguments.length)return E.a.e.get(e,m)
	E.a.e.set(e,m,t),t.P&&t.P.Ac(e)},E.Ja=function(e,t,n){return 1===e.nodeType&&E.f.kc(e),u(e,t,d(n),!0)},E.Dc=function(e,t,n){return n=d(n),E.Ja(e,a(t,n,e),n)},E.eb=function(e,t){1!==t.nodeType&&8!==t.nodeType||c(d(e),t,!0)},E.Rb=function(e,n){if(!r&&t.jQuery&&(r=t.jQuery),n&&1!==n.nodeType&&8!==n.nodeType)throw Error("ko.applyBindings: first parameter should be your view model; second parameter should be a DOM node")
	n=n||t.document.body,l(d(e),n,!0)},E.kb=function(t){switch(t.nodeType){case 1:case 8:var n=E.tc(t)
	if(n)return n
	if(t.parentNode)return E.kb(t.parentNode)}return e},E.Jc=function(t){return(t=E.kb(t))?t.$data:e},E.b("bindingHandlers",E.d),E.b("applyBindings",E.Rb),E.b("applyBindingsToDescendants",E.eb),E.b("applyBindingAccessorsToNode",E.Ja),E.b("applyBindingsToNode",E.Dc),E.b("contextFor",E.kb),E.b("dataFor",E.Jc)}(),function(e){function t(t,i){var a,s=r.hasOwnProperty(t)?r[t]:e
	s?s.X(i):((s=r[t]=new E.J).X(i),n(t,(function(e,n){var i=!(!n||!n.synchronous)
	o[t]={definition:e,Zc:i},delete r[t],a||i?s.notifySubscribers(e):E.Y.Wa((function(){s.notifySubscribers(e)}))})),a=!0)}function n(e,t){i("getConfig",[e],(function(n){n?i("loadComponent",[e,n],(function(e){t(e,n)})):t(null,null)}))}function i(t,n,r,o){o||(o=E.g.loaders.slice(0))
	var a=o.shift()
	if(a){var s=a[t]
	if(s){var c=!1
	if(s.apply(a,n.concat((function(e){c?r(null):null!==e?r(e):i(t,n,r,o)})))!==e&&(c=!0,!a.suppressLoaderExceptions))throw Error("Component loaders must supply values by invoking the callback, not by returning values synchronously.")}else i(t,n,r,o)}else r(null)}var r={},o={}
	E.g={get:function(n,i){var r=o.hasOwnProperty(n)?o[n]:e
	r?r.Zc?E.l.w((function(){i(r.definition)})):E.Y.Wa((function(){i(r.definition)})):t(n,i)},Xb:function(e){delete o[e]},Jb:i},E.g.loaders=[],E.b("components",E.g),E.b("components.get",E.g.get),E.b("components.clearCachedDefinition",E.g.Xb)}(),function(){function e(e,t,n,i){function r(){0==--s&&i(o)}var o={},s=2,c=n.template
	n=n.viewModel,c?a(t,c,(function(t){E.g.Jb("loadTemplate",[e,t],(function(e){o.template=e,r()}))})):r(),n?a(t,n,(function(t){E.g.Jb("loadViewModel",[e,t],(function(e){o[u]=e,r()}))})):r()}function i(e,t,n){if("function"==typeof t)n((function(e){return new t(e)}))
	else if("function"==typeof t[u])n(t[u])
	else if("instance"in t){var r=t.instance
	n((function(){return r}))}else"viewModel"in t?i(e,t.viewModel,n):e("Unknown viewModel value: "+t)}function r(e){switch(E.a.A(e)){case"script":return E.a.ma(e.text)
	case"textarea":return E.a.ma(e.value)
	case"template":if(o(e.content))return E.a.ua(e.content.childNodes)}return E.a.ua(e.childNodes)}function o(e){return t.DocumentFragment?e instanceof DocumentFragment:e&&11===e.nodeType}function a(e,n,i){"string"==typeof n.require?s||t.require?(s||t.require)([n.require],i):e("Uses require, but no AMD loader is present"):i(n)}function c(e){return function(t){throw Error("Component '"+e+"': "+t)}}var l={}
	E.g.register=function(e,t){if(!t)throw Error("Invalid configuration for "+e)
	if(E.g.ub(e))throw Error("Component "+e+" is already registered")
	l[e]=t},E.g.ub=function(e){return l.hasOwnProperty(e)},E.g.od=function(e){delete l[e],E.g.Xb(e)},E.g.Zb={getConfig:function(e,t){t(l.hasOwnProperty(e)?l[e]:null)},loadComponent:function(t,n,i){var r=c(t)
	a(r,n,(function(n){e(t,r,n,i)}))},loadTemplate:function(e,i,a){if(e=c(e),"string"==typeof i)a(E.a.ma(i))
	else if(i instanceof Array)a(i)
	else if(o(i))a(E.a.V(i.childNodes))
	else if(i.element)if(i=i.element,t.HTMLElement?i instanceof HTMLElement:i&&i.tagName&&1===i.nodeType)a(r(i))
	else if("string"==typeof i){var s=n.getElementById(i)
	s?a(r(s)):e("Cannot find element with ID "+i)}else e("Unknown element type: "+i)
	else e("Unknown template value: "+i)},loadViewModel:function(e,t,n){i(c(e),t,n)}}
	var u="createViewModel"
	E.b("components.register",E.g.register),E.b("components.isRegistered",E.g.ub),E.b("components.unregister",E.g.od),E.b("components.defaultLoader",E.g.Zb),E.g.loaders.push(E.g.Zb),E.g.Bc=l}(),function(){function e(e,n){if(i=e.getAttribute("params")){var i=t.parseBindingsString(i,n,e,{valueAccessors:!0,bindingParams:!0}),r=(i=E.a.Ca(i,(function(t){return E.m(t,null,{i:e})})),E.a.Ca(i,(function(t){var n=t.t()
	return t.ba()?E.m({read:function(){return E.a.c(t())},write:E.Ba(n)&&function(e){t()(e)},i:e}):n})))
	return r.hasOwnProperty("$raw")||(r.$raw=i),r}return{$raw:{}}}E.g.getComponentNameForNode=function(e){var t=E.a.A(e)
	if(E.g.ub(t)&&(-1!=t.indexOf("-")||"[object HTMLUnknownElement]"==""+e||8>=E.a.C&&e.tagName===t))return t},E.g.Ob=function(t,n,i,r){if(1===n.nodeType){var o=E.g.getComponentNameForNode(n)
	if(o){if((t=t||{}).component)throw Error('Cannot use the "component" binding on a custom element matching a component')
	var a={name:o,params:e(n,i)}
	t.component=r?function(){return a}:a}}return t}
	var t=new E.Q
	9>E.a.C&&(E.g.register=function(e){return function(t){return n.createElement(t),e.apply(this,arguments)}}(E.g.register),n.createDocumentFragment=function(e){return function(){var t,n=e(),i=E.g.Bc
	for(t in i)i.hasOwnProperty(t)&&n.createElement(t)
	return n}}(n.createDocumentFragment))}(),function(e){var t=0
	E.d.component={init:function(e,n,i,r,o){function a(){var e=s&&s.dispose
	"function"==typeof e&&e.call(s),c=s=null}var s,c,l=E.a.V(E.f.childNodes(e))
	return E.a.F.oa(e,a),E.m((function(){var i,r,u=E.a.c(n())
	if("string"==typeof u?i=u:(i=E.a.c(u.name),r=E.a.c(u.params)),!i)throw Error("No component name specified")
	var d=c=++t
	E.g.get(i,(function(t){if(c===d){if(a(),!t)throw Error("Unknown component '"+i+"'");(function(e,t,n){if(!(t=t.template))throw Error("Component '"+e+"' has no template")
	e=E.a.ua(t),E.f.da(n,e)})(i,t,e)
	var n=function(e,t,n,i){var r=e.createViewModel
	return r?r.call(e,i,{element:t,templateNodes:n}):i}(t,e,l,r)
	t=o.createChildContext(n,void 0,(function(e){e.$component=n,e.$componentTemplateNodes=l})),s=n,E.eb(t,e)}}))}),null,{i:e}),{controlsDescendantBindings:!0}}},E.f.Z.component=!0}()
	var P={class:"className",for:"htmlFor"}
	E.d.attr={update:function(t,n){var i=E.a.c(n())||{}
	E.a.D(i,(function(n,i){var r=!1===(i=E.a.c(i))||null===i||i===e
	r&&t.removeAttribute(n),8>=E.a.C&&n in P?(n=P[n],r?t.removeAttribute(n):t[n]=i):r||t.setAttribute(n,i.toString()),"name"===n&&E.a.rc(t,r?"":i.toString())}))}},E.d.checked={after:["value","attr"],init:function(t,n,i){function r(){var e=t.checked,r=p?o():e
	if(!E.va.Sa()&&(!s||e)){var a=E.l.w(n)
	if(l){var c=u?a.t():a
	d!==r?(e&&(E.a.pa(c,r,!0),E.a.pa(c,d,!1)),d=r):E.a.pa(c,r,e),u&&E.Ba(a)&&a(c)}else E.h.Ea(a,i,"checked",r,!0)}}var o=E.nc((function(){return i.has("checkedValue")?E.a.c(i.get("checkedValue")):i.has("value")?E.a.c(i.get("value")):t.value})),a="checkbox"==t.type,s="radio"==t.type
	if(a||s){var c=n(),l=a&&E.a.c(c)instanceof Array,u=!(l&&c.push&&c.splice),d=l?o():e,p=s||l
	s&&!t.name&&E.d.uniqueName.init(t,(function(){return!0})),E.m(r,null,{i:t}),E.a.p(t,"click",r),E.m((function(){var e=E.a.c(n())
	t.checked=l?0<=E.a.o(e,o()):a?e:o()===e}),null,{i:t}),c=e}}},E.h.ea.checked=!0,E.d.checkedValue={update:function(e,t){e.value=E.a.c(t())}},E.d.css={update:function(e,t){var n=E.a.c(t())
	null!==n&&"object"==typeof n?E.a.D(n,(function(t,n){n=E.a.c(n),E.a.bb(e,t,n)})):(n=E.a.$a(String(n||"")),E.a.bb(e,e.__ko__cssValue,!1),e.__ko__cssValue=n,E.a.bb(e,n,!0))}},E.d.enable={update:function(e,t){var n=E.a.c(t())
	n&&e.disabled?e.removeAttribute("disabled"):n||e.disabled||(e.disabled=!0)}},E.d.disable={update:function(e,t){E.d.enable.update(e,(function(){return!E.a.c(t())}))}},E.d.event={init:function(e,t,n,i,r){var o=t()||{}
	E.a.D(o,(function(o){"string"==typeof o&&E.a.p(e,o,(function(e){var a,s=t()[o]
	if(s){try{var c=E.a.V(arguments)
	i=r.$data,c.unshift(i),a=s.apply(i,c)}finally{!0!==a&&(e.preventDefault?e.preventDefault():e.returnValue=!1)}!1===n.get(o+"Bubble")&&(e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation())}}))}))}},E.d.foreach={ic:function(e){return function(){var t=e(),n=E.a.zb(t)
	return n&&"number"!=typeof n.length?(E.a.c(t),{foreach:n.data,as:n.as,includeDestroyed:n.includeDestroyed,afterAdd:n.afterAdd,beforeRemove:n.beforeRemove,afterRender:n.afterRender,beforeMove:n.beforeMove,afterMove:n.afterMove,templateEngine:E.W.sb}):{foreach:t,templateEngine:E.W.sb}}},init:function(e,t){return E.d.template.init(e,E.d.foreach.ic(t))},update:function(e,t,n,i,r){return E.d.template.update(e,E.d.foreach.ic(t),n,i,r)}},E.h.ta.foreach=!1,E.f.Z.foreach=!0,E.d.hasfocus={init:function(e,t,n){function i(i){e.__ko_hasfocusUpdating=!0
	var r=e.ownerDocument
	if("activeElement"in r){var o
	try{o=r.activeElement}catch(a){o=r.body}i=o===e}r=t(),E.h.Ea(r,n,"hasfocus",i,!0),e.__ko_hasfocusLastValue=i,e.__ko_hasfocusUpdating=!1}var r=i.bind(null,!0),o=i.bind(null,!1)
	E.a.p(e,"focus",r),E.a.p(e,"focusin",r),E.a.p(e,"blur",o),E.a.p(e,"focusout",o)},update:function(e,t){var n=!!E.a.c(t())
	e.__ko_hasfocusUpdating||e.__ko_hasfocusLastValue===n||(n?e.focus():e.blur(),!n&&e.__ko_hasfocusLastValue&&e.ownerDocument.body.focus(),E.l.w(E.a.Da,null,[e,n?"focusin":"focusout"]))}},E.h.ea.hasfocus=!0,E.d.hasFocus=E.d.hasfocus,E.h.ea.hasFocus=!0,E.d.html={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){E.a.Cb(e,t())}},m("if"),m("ifnot",!1,!0),m("with",!0,!1,(function(e,t){return e.createChildContext(t)}))
	var R={}
	E.d.options={init:function(e){if("select"!==E.a.A(e))throw Error("options binding applies only to SELECT elements")
	for(;0<e.length;)e.remove(0)
	return{controlsDescendantBindings:!0}},update:function(t,n,i){function r(){return E.a.Ka(t.options,(function(e){return e.selected}))}function o(e,t,n){var i=typeof t
	return"function"==i?t(e):"string"==i?e[t]:n}function a(e,n){if(m&&u)E.j.ha(t,E.a.c(i.get("value")),!0)
	else if(f.length){var r=0<=E.a.o(f,E.j.u(n[0]))
	E.a.sc(n[0],r),m&&!r&&E.l.w(E.a.Da,null,[t,"change"])}}var s=t.multiple,c=0!=t.length&&s?t.scrollTop:null,l=E.a.c(n()),u=i.get("valueAllowUnset")&&i.has("value"),d=i.get("optionsIncludeDestroyed")
	n={}
	var p,f=[]
	u||(s?f=E.a.fb(r(),E.j.u):0<=t.selectedIndex&&f.push(E.j.u(t.options[t.selectedIndex]))),l&&(void 0===l.length&&(l=[l]),p=E.a.Ka(l,(function(t){return d||t===e||null===t||!E.a.c(t._destroy)})),i.has("optionsCaption")&&null!==(l=E.a.c(i.get("optionsCaption")))&&l!==e&&p.unshift(R))
	var m=!1
	n.beforeRemove=function(e){t.removeChild(e)},l=a,i.has("optionsAfterRender")&&"function"==typeof i.get("optionsAfterRender")&&(l=function(t,n){a(0,n),E.l.w(i.get("optionsAfterRender"),null,[n[0],t!==R?t:e])}),E.a.Bb(t,p,(function(n,r,a){return a.length&&(f=!u&&a[0].selected?[E.j.u(a[0])]:[],m=!0),r=t.ownerDocument.createElement("option"),n===R?(E.a.Za(r,i.get("optionsCaption")),E.j.ha(r,e)):(a=o(n,i.get("optionsValue"),n),E.j.ha(r,E.a.c(a)),n=o(n,i.get("optionsText"),a),E.a.Za(r,n)),[r]}),n,l),E.l.w((function(){u?E.j.ha(t,E.a.c(i.get("value")),!0):(s?f.length&&r().length<f.length:f.length&&0<=t.selectedIndex?E.j.u(t.options[t.selectedIndex])!==f[0]:f.length||0<=t.selectedIndex)&&E.a.Da(t,"change")})),E.a.Nc(t),c&&20<Math.abs(c-t.scrollTop)&&(t.scrollTop=c)}},E.d.options.xb=E.a.e.I(),E.d.selectedOptions={after:["options","foreach"],init:function(e,t,n){E.a.p(e,"change",(function(){var i=t(),r=[]
	E.a.q(e.getElementsByTagName("option"),(function(e){e.selected&&r.push(E.j.u(e))})),E.h.Ea(i,n,"selectedOptions",r)}))},update:function(e,t){if("select"!=E.a.A(e))throw Error("values binding applies only to SELECT elements")
	var n=E.a.c(t()),i=e.scrollTop
	n&&"number"==typeof n.length&&E.a.q(e.getElementsByTagName("option"),(function(e){var t=0<=E.a.o(n,E.j.u(e))
	e.selected!=t&&E.a.sc(e,t)})),e.scrollTop=i}},E.h.ea.selectedOptions=!0,E.d.style={update:function(t,n){var i=E.a.c(n()||{})
	E.a.D(i,(function(n,i){null!==(i=E.a.c(i))&&i!==e&&!1!==i||(i=""),t.style[n]=i}))}},E.d.submit={init:function(e,t,n,i,r){if("function"!=typeof t())throw Error("The value for a submit binding must be a function")
	E.a.p(e,"submit",(function(n){var i,o=t()
	try{i=o.call(r.$data,e)}finally{!0!==i&&(n.preventDefault?n.preventDefault():n.returnValue=!1)}}))}},E.d.text={init:function(){return{controlsDescendantBindings:!0}},update:function(e,t){E.a.Za(e,t())}},E.f.Z.text=!0,function(){if(t&&t.navigator)var n=function(e){if(e)return parseFloat(e[1])},i=t.opera&&t.opera.version&&parseInt(t.opera.version()),r=t.navigator.userAgent,o=n(r.match(/^(?:(?!chrome).)*version\/([^ ]*) safari/i)),a=n(r.match(/Firefox\/([^ ]*)/))
	if(10>E.a.C)var s=E.a.e.I(),c=E.a.e.I(),l=function(e){var t=this.activeElement;(t=t&&E.a.e.get(t,c))&&t(e)},u=function(e,t){var n=e.ownerDocument
	E.a.e.get(n,s)||(E.a.e.set(n,s,!0),E.a.p(n,"selectionchange",l)),E.a.e.set(e,c,t)}
	E.d.textInput={init:function(t,n,r){function s(e,n){E.a.p(t,e,n)}function c(){d||(p=t.value,d=E.a.setTimeout(l,4))}function l(){clearTimeout(d),p=d=e
	var i=t.value
	f!==i&&(f=i,E.h.Ea(n(),r,"textInput",i))}var d,p,f=t.value,m=9==E.a.C?c:l
	10>E.a.C?(s("propertychange",(function(e){"value"===e.propertyName&&m(e)})),8==E.a.C&&(s("keyup",l),s("keydown",l)),8<=E.a.C&&(u(t,m),s("dragend",c))):(s("input",l),5>o&&"textarea"===E.a.A(t)?(s("keydown",c),s("paste",c),s("cut",c)):11>i?s("keydown",c):4>a&&(s("DOMAutoComplete",l),s("dragdrop",l),s("drop",l))),s("change",l),E.m((function i(){var r=E.a.c(n())
	null!==r&&r!==e||(r=""),p!==e&&r===p?E.a.setTimeout(i,4):t.value!==r&&(f=r,t.value=r)}),null,{i:t})}},E.h.ea.textInput=!0,E.d.textinput={preprocess:function(e,t,n){n("textInput",e)}}}(),E.d.uniqueName={init:function(e,t){if(t()){var n="ko_unique_"+ ++E.d.uniqueName.Ic
	E.a.rc(e,n)}}},E.d.uniqueName.Ic=0,E.d.value={after:["options","foreach"],init:function(e,t,n){if("input"!=e.tagName.toLowerCase()||"checkbox"!=e.type&&"radio"!=e.type){var i=["change"],r=n.get("valueUpdate"),o=!1,a=null
	r&&("string"==typeof r&&(r=[r]),E.a.ra(i,r),i=E.a.Tb(i))
	var s=function(){a=null,o=!1
	var i=t(),r=E.j.u(e)
	E.h.Ea(i,n,"value",r)}
	!E.a.C||"input"!=e.tagName.toLowerCase()||"text"!=e.type||"off"==e.autocomplete||e.form&&"off"==e.form.autocomplete||-1!=E.a.o(i,"propertychange")||(E.a.p(e,"propertychange",(function(){o=!0})),E.a.p(e,"focus",(function(){o=!1})),E.a.p(e,"blur",(function(){o&&s()}))),E.a.q(i,(function(t){var n=s
	E.a.nd(t,"after")&&(n=function(){a=E.j.u(e),E.a.setTimeout(s,0)},t=t.substring(5)),E.a.p(e,t,n)}))
	var c=function(){var i=E.a.c(t()),r=E.j.u(e)
	if(null!==a&&i===a)E.a.setTimeout(c,0)
	else if(i!==r)if("select"===E.a.A(e)){var o=n.get("valueAllowUnset");(r=function(){E.j.ha(e,i,o)})(),o||i===E.j.u(e)?E.a.setTimeout(r,0):E.l.w(E.a.Da,null,[e,"change"])}else E.j.ha(e,i)}
	E.m(c,null,{i:e})}else E.Ja(e,{checkedValue:t})},update:function(){}},E.h.ea.value=!0,E.d.visible={update:function(e,t){var n=E.a.c(t()),i="none"!=e.style.display
	n&&!i?e.style.display="":!n&&i&&(e.style.display="none")}},function(e){E.d[e]={init:function(t,n,i,r,o){return E.d.event.init.call(this,t,(function(){var t={}
	return t[e]=n(),t}),i,r,o)}}}("click"),E.O=function(){},E.O.prototype.renderTemplateSource=function(){throw Error("Override renderTemplateSource")},E.O.prototype.createJavaScriptEvaluatorBlock=function(){throw Error("Override createJavaScriptEvaluatorBlock")},E.O.prototype.makeTemplateSource=function(e,t){if("string"==typeof e){var i=(t=t||n).getElementById(e)
	if(!i)throw Error("Cannot find template with ID "+e)
	return new E.v.n(i)}if(1==e.nodeType||8==e.nodeType)return new E.v.qa(e)
	throw Error("Unknown template type: "+e)},E.O.prototype.renderTemplate=function(e,t,n,i){return e=this.makeTemplateSource(e,i),this.renderTemplateSource(e,t,n,i)},E.O.prototype.isTemplateRewritten=function(e,t){return!1===this.allowTemplateRewriting||this.makeTemplateSource(e,t).data("isRewritten")},E.O.prototype.rewriteTemplate=function(e,t,n){t=t((e=this.makeTemplateSource(e,n)).text()),e.text(t),e.data("isRewritten",!0)},E.b("templateEngine",E.O),E.Gb=function(){function e(e,t,n,i){e=E.h.yb(e)
	for(var r=E.h.ta,o=0;o<e.length;o++){var a=e[o].key
	if(r.hasOwnProperty(a)){var s=r[a]
	if("function"==typeof s){if(a=s(e[o].value))throw Error(a)}else if(!s)throw Error("This template engine does not support the '"+a+"' binding within its templates")}}return n="ko.__tr_ambtns(function($context,$element){return(function(){return{ "+E.h.Ua(e,{valueAccessors:!0})+" } })()},'"+n.toLowerCase()+"')",i.createJavaScriptEvaluatorBlock(n)+t}var t=/(<([a-z]+\d*)(?:\s+(?!data-bind\s*=\s*)[a-z0-9\-]+(?:=(?:\"[^\"]*\"|\'[^\']*\'|[^>]*))?)*\s+)data-bind\s*=\s*(["'])([\s\S]*?)\3/gi,n=/\x3c!--\s*ko\b\s*([\s\S]*?)\s*--\x3e/g
	return{Oc:function(e,t,n){t.isTemplateRewritten(e,n)||t.rewriteTemplate(e,(function(e){return E.Gb.dd(e,t)}),n)},dd:function(i,r){return i.replace(t,(function(t,n,i,o,a){return e(a,n,i,r)})).replace(n,(function(t,n){return e(n,"\x3c!-- ko --\x3e","#comment",r)}))},Ec:function(e,t){return E.M.wb((function(n,i){var r=n.nextSibling
	r&&r.nodeName.toLowerCase()===t&&E.Ja(r,e,i)}))}}}(),E.b("__tr_ambtns",E.Gb.Ec),function(){E.v={},E.v.n=function(e){if(this.n=e){var t=E.a.A(e)
	this.ab="script"===t?1:"textarea"===t?2:"template"==t&&e.content&&11===e.content.nodeType?3:4}},E.v.n.prototype.text=function(){var e=1===this.ab?"text":2===this.ab?"value":"innerHTML"
	if(0==arguments.length)return this.n[e]
	var t=arguments[0]
	"innerHTML"===e?E.a.Cb(this.n,t):this.n[e]=t}
	var t=E.a.e.I()+"_"
	E.v.n.prototype.data=function(e){if(1===arguments.length)return E.a.e.get(this.n,t+e)
	E.a.e.set(this.n,t+e,arguments[1])}
	var n=E.a.e.I()
	E.v.n.prototype.nodes=function(){var t=this.n
	if(0==arguments.length)return(E.a.e.get(t,n)||{}).jb||(3===this.ab?t.content:4===this.ab?t:e)
	E.a.e.set(t,n,{jb:arguments[0]})},E.v.qa=function(e){this.n=e},E.v.qa.prototype=new E.v.n,E.v.qa.prototype.text=function(){if(0==arguments.length){var t=E.a.e.get(this.n,n)||{}
	return t.Hb===e&&t.jb&&(t.Hb=t.jb.innerHTML),t.Hb}E.a.e.set(this.n,n,{Hb:arguments[0]})},E.b("templateSources",E.v),E.b("templateSources.domElement",E.v.n),E.b("templateSources.anonymousTemplate",E.v.qa)}(),function(){function t(e,t,n){var i
	for(t=E.f.nextSibling(t);e&&(i=e)!==t;)n(i,e=E.f.nextSibling(i))}function n(e,n){if(e.length){var i=e[0],r=e[e.length-1],o=i.parentNode,a=E.Q.instance,s=a.preprocessNode
	if(s){if(t(i,r,(function(e,t){var n=e.previousSibling,o=s.call(a,e)
	o&&(e===i&&(i=o[0]||t),e===r&&(r=o[o.length-1]||n))})),e.length=0,!i)return
	i===r?e.push(i):(e.push(i,r),E.a.za(e,o))}t(i,r,(function(e){1!==e.nodeType&&8!==e.nodeType||E.Rb(n,e)})),t(i,r,(function(e){1!==e.nodeType&&8!==e.nodeType||E.M.yc(e,[n])})),E.a.za(e,o)}}function i(e){return e.nodeType?e:0<e.length?e[0]:null}function r(e,t,r,o,s){s=s||{}
	var c=(e&&i(e)||r||{}).ownerDocument,l=s.templateEngine||a
	if(E.Gb.Oc(r,l,c),"number"!=typeof(r=l.renderTemplate(r,o,s,c)).length||0<r.length&&"number"!=typeof r[0].nodeType)throw Error("Template engine must return an array of DOM nodes")
	switch(c=!1,t){case"replaceChildren":E.f.da(e,r),c=!0
	break
	case"replaceNode":E.a.qc(e,r),c=!0
	break
	case"ignoreTargetNode":break
	default:throw Error("Unknown renderMode: "+t)}return c&&(n(r,o),s.afterRender&&E.l.w(s.afterRender,null,[r,o.$data])),r}function o(e,t,n){return E.H(e)?e():"function"==typeof e?e(t,n):e}var a
	E.Db=function(t){if(t!=e&&!(t instanceof E.O))throw Error("templateEngine must inherit from ko.templateEngine")
	a=t},E.Ab=function(t,n,s,c,l){if(((s=s||{}).templateEngine||a)==e)throw Error("Set a template engine before calling renderTemplate")
	if(l=l||"replaceChildren",c){var u=i(c)
	return E.B((function(){var e=n&&n instanceof E.U?n:new E.U(E.a.c(n)),a=o(t,e.$data,e)
	e=r(c,l,a,e,s),"replaceNode"==l&&(u=i(c=e))}),null,{wa:function(){return!u||!E.a.nb(u)},i:u&&"replaceNode"==l?u.parentNode:u})}return E.M.wb((function(e){E.Ab(t,n,s,e,"replaceNode")}))},E.kd=function(t,i,a,s,c){function l(e,t){n(t,d),a.afterRender&&a.afterRender(t,e),d=null}function u(e,n){return d=c.createChildContext(e,a.as,(function(e){e.$index=n})),r(null,"ignoreTargetNode",o(t,e,d),d,a)}var d
	return E.B((function(){var t=E.a.c(i)||[]
	void 0===t.length&&(t=[t]),t=E.a.Ka(t,(function(t){return a.includeDestroyed||t===e||null===t||!E.a.c(t._destroy)})),E.l.w(E.a.Bb,null,[s,t,u,a,l])}),null,{i:s})}
	var s=E.a.e.I()
	E.d.template={init:function(e,t){var n=E.a.c(t())
	if("string"==typeof n||n.name)E.f.xa(e)
	else{if("nodes"in n){if(n=n.nodes||[],E.H(n))throw Error('The "nodes" option must be a plain, non-observable array.')}else n=E.f.childNodes(e)
	n=E.a.jc(n),new E.v.qa(e).nodes(n)}return{controlsDescendantBindings:!0}},update:function(t,n,i,r,o){var a,c=n()
	i=!0,r=null,"string"==typeof(n=E.a.c(c))?n={}:(c=n.name,"if"in n&&(i=E.a.c(n.if)),i&&"ifnot"in n&&(i=!E.a.c(n.ifnot)),a=E.a.c(n.data)),"foreach"in n?r=E.kd(c||t,i&&n.foreach||[],n,t,o):i?(o="data"in n?o.createChildContext(a,n.as):o,r=E.Ab(c||t,o,n,t)):E.f.xa(t),o=r,(a=E.a.e.get(t,s))&&"function"==typeof a.k&&a.k(),E.a.e.set(t,s,o&&o.ba()?o:e)}},E.h.ta.template=function(e){return 1==(e=E.h.yb(e)).length&&e[0].unknown||E.h.ad(e,"name")?null:"This template engine does not support anonymous templates nested within its templates"},E.f.Z.template=!0}(),E.b("setTemplateEngine",E.Db),E.b("renderTemplate",E.Ab),E.a.dc=function(e,t,n){var i,r,o,a,s
	if(e.length&&t.length)for(i=r=0;(!n||i<n)&&(a=e[r]);++r){for(o=0;s=t[o];++o)if(a.value===s.value){a.moved=s.index,s.moved=a.index,t.splice(o,1),i=o=0
	break}i+=o}}
	E.a.ib=function(){function e(e,t,n,i,r){var o,a,s,c,l,u=Math.min,d=Math.max,p=[],f=e.length,m=t.length,h=m-f||1,v=f+m+1
	for(o=0;o<=f;o++)for(c=s,p.push(s=[]),l=u(m,o+h),a=d(0,o-1);a<=l;a++)s[a]=a?o?e[o-1]===t[a-1]?c[a-1]:u(c[a]||v,s[a-1]||v)+1:a+1:o+1
	for(u=[],d=[],h=[],o=f,a=m;o||a;)m=p[o][a]-1,a&&m===p[o][a-1]?d.push(u[u.length]={status:n,value:t[--a],index:a}):o&&m===p[o-1][a]?h.push(u[u.length]={status:i,value:e[--o],index:o}):(--a,--o,r.sparse||u.push({status:"retained",value:t[a]}))
	return E.a.dc(h,d,!r.dontLimitMoves&&10*f),u.reverse()}return function(t,n,i){return i="boolean"==typeof i?{dontLimitMoves:i}:i||{},n=n||[],(t=t||[]).length<n.length?e(t,n,"added","deleted",i):e(n,t,"deleted","added",i)}}(),E.b("utils.compareArrays",E.a.ib),function(){function t(t,n,i,r,o){var a=[],s=E.B((function(){var e=n(i,o,E.a.za(a,t))||[]
	0<a.length&&(E.a.qc(a,e),r&&E.l.w(r,null,[i,e,o])),a.length=0,E.a.ra(a,e)}),null,{i:t,wa:function(){return!E.a.Qb(a)}})
	return{ca:a,B:s.ba()?s:e}}var n=E.a.e.I(),i=E.a.e.I()
	E.a.Bb=function(r,o,a,s,c){function l(e,t){w=f[t],y!==t&&(C[e]=w),w.qb(y++),E.a.za(w.ca,r),v.push(w),_.push(w)}function u(e,t){if(e)for(var n=0,i=t.length;n<i;n++)t[n]&&E.a.q(t[n].ca,(function(i){e(i,n,t[n].ja)}))}o=o||[],s=s||{}
	var d,p=E.a.e.get(r,n)===e,f=E.a.e.get(r,n)||[],m=E.a.fb(f,(function(e){return e.ja})),h=E.a.ib(m,o,s.dontLimitMoves),v=[],g=0,y=0,b=[],_=[]
	o=[]
	for(var w,S,x,C=[],T=(m=[],0);S=h[T];T++)switch(x=S.moved,S.status){case"deleted":x===e&&((w=f[g]).B&&(w.B.k(),w.B=e),E.a.za(w.ca,r).length&&(s.beforeRemove&&(v.push(w),_.push(w),w.ja===i?w=null:o[T]=w),w&&b.push.apply(b,w.ca))),g++
	break
	case"retained":l(T,g++)
	break
	case"added":x!==e?l(T,x):(w={ja:S.value,qb:E.N(y++)},v.push(w),_.push(w),p||(m[T]=w))}for(E.a.e.set(r,n,v),u(s.beforeMove,C),E.a.q(b,s.beforeRemove?E.$:E.removeNode),T=0,p=E.f.firstChild(r);w=_[T];T++){for(w.ca||E.a.extend(w,t(r,a,w.ja,c,w.qb)),g=0;h=w.ca[g];p=h.nextSibling,d=h,g++)h!==p&&E.f.gc(r,h,d)
	!w.Wc&&c&&(c(w.ja,w.ca,w.qb),w.Wc=!0)}for(u(s.beforeRemove,o),T=0;T<o.length;++T)o[T]&&(o[T].ja=i)
	u(s.afterMove,C),u(s.afterAdd,m)}}(),E.b("utils.setDomNodeChildrenFromArrayMapping",E.a.Bb),E.W=function(){this.allowTemplateRewriting=!1},E.W.prototype=new E.O,E.W.prototype.renderTemplateSource=function(e,t,n,i){return(t=9>E.a.C||!e.nodes?null:e.nodes())?E.a.V(t.cloneNode(!0).childNodes):(e=e.text(),E.a.ma(e,i))},E.W.sb=new E.W,E.Db(E.W.sb),E.b("nativeTemplateEngine",E.W),function(){E.vb=function(){var e=this.$c=function(){if(!r||r.tmpl)return 0
	try{if(0<=r.tmpl.tag.tmpl.open.toString().indexOf("__"))return 2}catch(e){}return 1}()
	this.renderTemplateSource=function(t,i,o,a){if(a=a||n,o=o||{},2>e)throw Error("Your version of jQuery.tmpl is too old. Please upgrade to jQuery.tmpl 1.0.0pre or later.")
	var s=t.data("precompiled")
	return s||(s=t.text()||"",s=r.template(null,"{{ko_with $item.koBindingContext}}"+s+"{{/ko_with}}"),t.data("precompiled",s)),t=[i.$data],i=r.extend({koBindingContext:i},o.templateOptions),(i=r.tmpl(s,t,i)).appendTo(a.createElement("div")),r.fragments={},i},this.createJavaScriptEvaluatorBlock=function(e){return"{{ko_code ((function() { return "+e+" })()) }}"},this.addTemplate=function(e,t){n.write("<script type='text/html' id='"+e+"'>"+t+"<\/script>")},0<e&&(r.tmpl.tag.ko_code={open:"__.push($1 || '');"},r.tmpl.tag.ko_with={open:"with($1) {",close:"} "})},E.vb.prototype=new E.O
	var e=new E.vb
	0<e.$c&&E.Db(e),E.b("jqueryTmplTemplateEngine",E.vb)}()}))}(),define("ui/modelHelpers/personHelper",["require","exports","module","lodash-compat","swx-cafe-application-instance","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("swx-constants").PEOPLE,o=/^(?:(\d+):)+/
	function a(e){return n.isFunction(e.type)}function s(e){return!!e._authorization&&n.isFunction(e._authorization)}function c(e){if(n.isString(e))return e.replace(o,"")}t.isMePersonId=function(e){var t=i.get().personsAndGroupsManager.mePerson,n=c(e)
	return t.id()===n||t._msaId&&c(t._msaId())===n},t.isMePerson=function(e){return t.isMePersonId(e.id())},t.isGuestId=function(e){return/^guest:/.test(e)},t.isGuest=function(e){return t.isGuestId(e.id())},t.isTechnicalAccount=function(e){return/^live:/.test(e.id())},t.isEchoContact=function(e){return t.isEchoContactId(e.id())},t.isEchoContactId=function(e){return e===r.ECHO_CONTACT_ID},t.isAgent=function(e){return function(e){return n.isFunction(e.isAgent)}(e)&&e.isAgent()},t.isAuthorizedContact=function(e){return!s(e)||e._authorization()===r.authorizationStates.AUTHORIZED},t.isSuggestedContact=function(e){return s(e)&&e._authorization()===r.authorizationStates.SUGGESTED},t.isPstn=function(e){return a(e)&&"Phone"===e.type()||!!e.phoneNumbers.size()&&e.id()===e.phoneNumbers(0).telUri()},t.hasPhoneNumbers=function(e){return!!e.phoneNumbers.size()},t.isKnownPerson=function(e){return!(!e||1!==i.get().personsAndGroupsManager.all.persons().filter((function(t){return t.id()===e.id()})).length)},t.isOrganizationContact=function(e){return!!n.isFunction(e._isOrganizationContact)&&e._isOrganizationContact()},t.getId=c,t.isWelcomeAgent=function(e){return!(!e||!a(e)||"ReplayBot"!==e.type())}})),define("utils/common/cafeObservable",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout"),n={}
	function i(e,t){if(n[t])return n[t]
	for(var i in e)if(i!==t&&e[i]===e[t])return n[t]=i,i
	return console.warn(!1,"Cannot properly extend "+t+". SWX cannot work properly ! Do you use knockout RELEASE version ?"),n[t]=t,t}return{newObservableProperty:function(e,n){var r,o,a,s,c,l=t.observable()
	function u(){l.valueHasMutated()}return c=(n=n||{}).keepAlive,o=i(r=t.pureComputed({deferEvaluation:!0,read:function(){return l(),e()}}),"subscribe"),a=r[o],r.subscribe=r[o]=function(){var t,n,o,l
	return r.getSubscriptionsCount()||(e.observed()||(l=e.get.bind(e)),c&&(s=e.subscribe()),e.changed(u,l)),n=i(r,"dispose"),t=a.apply(r,arguments),o=t[n].bind(t),t.dispose=t[n]=function(){o(),r.getSubscriptionsCount()||(e.changed.off(u),s&&(s.dispose(),s=null))},t},r},newDeferredObservableProperty:function(e,n){var r,o,a,s,c,l,u=t.observable()
	function d(){u.valueHasMutated()}function p(){var e
	r&&!c&&a.getSubscriptionsCount()&&(r.observed()||(e=r.get.bind(r)),l&&(c=r.subscribe()),r.changed(d,e))}return l=(n=n||{}).keepAlive,o=i(a=t.pureComputed({deferEvaluation:!0,read:function(){return u(),r?r():e}}),"subscribe"),s=a[o],a.subscribe=a[o]=function(){var e,t,n
	return t=i(a,"dispose"),e=s.apply(a,arguments),n=e[t].bind(e),p(),e.dispose=e[t]=function(){n(),r&&!a.getSubscriptionsCount()&&(r.changed.off(d),c&&(c.dispose(),c=null))},e},a.bindToProperty=function(e){r=e,p(),d()},a},newObservableCollection:function(e,n){var r,o,a,s,c,l,u,d=t.observable()
	return l=(n=n||{}).keepAlive,o=i(r=t.pureComputed({deferEvaluation:!0,read:function(){return d(),e()}}),"subscribe"),a=r[o].bind(r),r.subscribe=r[o]=function(){var t,n,o,u
	return r.getSubscriptionsCount()||(e.observed()||(u=e.get.bind(e)),l&&(c=e.subscribe()),s=s||e.observe((function(){d.valueHasMutated()})),u&&u()),n=i(r,"dispose"),t=a.apply(r,arguments),o=t[n].bind(t),t.dispose=t[n]=function(){o(),r.getSubscriptionsCount()===d.getSubscriptionsCount()&&(s&&(s.dispose(),s=null),c&&(c.dispose(),c=null))},t},u=r,t.utils.extend(u,t.observableArray.fn),r=u.extend({trackArrayChanges:!0})}}})),define("ui/telemetry/actions/actionNames",{audioVideo:{videoCall:"av_call_with_video",audioCall:"av_call_with_audio",pstnCall:"av_call_with_pstn",apiVideoCall:"av_api_call_with_video",apiAudioCall:"av_api_call_with_audio",toggleMute:"av_mute_unmute",toggleVideo:"av_video_on_off",showChat:"av_show_chat",hideChat:"av_hide_chat",toggleFullScreen:"av_full_screen",toggleNarrowMenu:"av_narrow_menu",toggleDialpad:"av_dialpad_on_off",toggleGridView:"av_grid_view",zoomInOut:"av_zoom_in_out",endCall:"av_end_call",acceptWithAudio:"av_accept_with_audio",acceptWithVideo:"av_accept_with_video",reject:"av_reject_call",joinCall:"av_join_call",joinCallWithVideo:"av_join_call_with_video",moreActions:"av_more_actions",addParticipants:"av_add_participants",shareScreenPreview:"av_share_screen_preview",shareScreen:"av_share_screen",stopSharingScreen:"av_stop_sharing_screen",submitParticipantsIn1to1:"av_submit_participants_in_1_1",submitParticipantsInGroup:"av_submit_participants_in_group",participantMenu:{show:"av_participantMenu_show",chat:"av_participantMenu_chat",pin:"av_partcipantMenu_pin",zoom:"av_partcipantMenu_zoom"},pluginInstall:{start:"av_plugin_install_start",installExtension:"av_install_extension",installPlugin:"av_install_plugin",restart:"av_plugin_install_restart",leave:"av_plugin_install_leave",stayInFlow:"av_plugin_install_cancel_leave",firefoxUnableToCall:"av_plugin_firefox_unable_to_call"},timeline:{endCall:"av_timeline_end_call",toggleMute:"av_timeline_mute_unmute"}},deviceSelection:{callScreenPaneOpened:"callScreenPaneOpened",microphoneSelected:"microphoneSelected",speakerSelected:"speakerSelected",cameraSelected:"cameraSelected"},contacts:{openPage:"contacts_contactsPage_openPage",openConversation:"contacts_contactsPage_openConversation",showContextMenu:"contacts_contactsPage_showContextMenu",contactRequestSent:"contacts_contactRequest_sent",contactRequestSuggestedSent:"contacts_contactRequest_suggestedSent",contactRequestAccepted:"contacts_contactRequest_accepted",contactRequestDeclined:"contacts_contactRequest_declined",contactBlocked:"contactBlocked",contactUnblocked:"contactUnblocked",contactDeleted:"contactDeleted",informationButtonClicked:"contacts_informationButton_clicked"},discoverAgents:{openPage:"agents_discoverAgentsPage_openPage",openConversation:"agents_discoverAgentsPage_openConversation"},contextMenu:{shown:"contextMenuShown",hidden:"contextMenuHidden",recents:{notificationsMuted:"contextMenu_recents_notificationsMuted",notificationsUnmuted:"contextMenu_recents_notificationsUnmuted"}},search:{directorySearchActivated:"directorySearchActivated",started:"searchStarted",startedLocal:"searchStartedLocal",startedDirectory:"searchStartedDirectory",reset:"searchReset"},focusManager:{tryRestoreFocus:"tryRestoreFocus"},conversation:{addParticipantsButton:"conversation_addParticipants_button_clicked",scheduleCallButton:"conversation_scheduleCall_button_clicked",moreActionsButton:"conversation_moreActions_button_clicked",mute:"conversation_mute_notifications_setting_changed"},scheduleCall:{scheduleCallConfirmButton:"conversation_scheduleCall_confirm_clicked"},chat:{removeMessage:"removeMessage",sendMessageButton:"send_message_button_clicked",editMessageButton:"edit_message_button_clicked",sendMessageEnter:"send_message_enter_key",editMessageEnter:"edit_message_enter_key",saveVideoMessage:"save_video_message",notificationsDisabled:"chat_notifications_disabled",notificationsEnabled:"chat_notifications_enabled"},skypeOut:{openPage:"skypeOut_openPage"},invites:{shareButton:"invites_share_button_clicked",copyButton:"invites_copy_button_clicked",mailButton:"invites_mail_button_clicked"},presence:{change:"mepresence_change"},userSettings:{openPage:"user_settings_open_page"},educationBubbles:{educationBubbleShown:"education_bubble_shown"},me:{expanded:"me_expanded",collapsed:"me_collapsed",accountLinkClicked:"me_account_link_clicked",signOutClicked:"me_sign_out_clicked",installPluginLinkClicked:"me_install_plugin_link_clicked",avatarFilePickerClicked:"me_avatar_file_picker_clicked",presenceChanged:"me_presence_changed",presenceLoaded:"me_presence_loaded",activityChanged:"me_activity_changed"},externalSignIn:{signIn:"external_sign_in",signInRequest:"external_sign_in_request",signInRequestAfterTokenRefresh:"external_sign_in_request_after_token_refresh",openSignInWindow:"external_open_sign_in_window"},shortCircuit:{contactsPageOpen:"sc_open_contactsPage",manageAddressBooks:"sc_open_manageAddressBooks",addNewNumber:"sc_open_pnv",deleteNumber:"sc_delete_phoneProof",toggleAutoBuddy:"sc_toggle_autoBuddy",togglePhoneProof:"sc_toggle_phoneProof"},notificationsSettings:{toggleNotifications:"toggleNotifications",toggleSound:"toggleSound",changeRingingDeferrerSetting:"ringingDeferrer_settingChanged"},notificationBox:{shown:"notification_box_shown",requestPermission:"notification_box_request_permission",permissionResponse:"notification_box_permission_response"},browserNotificationsOptInToast:{shown:"browser_notifications_opt_in_toast_shown"},allowBrowserNotificationsModalDialog:{shown:"allow_browser_notifications_modal_dialog_shown"}}),define("experience/defaultInitParams",[],(function(){return{apiKey:"<REQUIRED>",correlationIds:{experienceId:"",hostProperty:"",sessionId:"",tabId:"",userAppId:"",userId:""},fingerprint:"",flags:"",locale:"en-us",variant:"swx",jsonp:!0,disableTelemetry:!1}})),define("experience/settings",["require","experience/defaultInitParams"],(function(e){var t={enabled:!0,limit:3,delay:1e3,strategy:"fixed"}
	return{version:"1.125.43",biAppName:"swx-local",biClientName:"Web",platformId:"908",productName:"SWX",API:{version:1,exposeCafe:!1},ecsHosts:["https://a.config.skype.com","https://b.config.skype.com"],ecsSpacesKey:"SWG",ecsPesKey:"SkypePersonalization",ecsTrapKey:"MDN_TRAP",ecsCqfKey:"SkypeRealTimeMedia",ecsSkypeCallingT1Key:"SkypeCallingT1",ecsTrouterKey:"TrouterJScriptClient",ecsClientCobrandTag:"0",webApiServiceHost:"https://client-s.gateway.messenger.live.com",amdServiceHost:"https://api.asm.skype.com",assetsServiceHost:"https://apps.skypeassets.com/rates/skypeout",urlPServiceHost:"https://urlp.asm.skype.com",xmmFallbackUrl:"https://login.skype.com/login/sso",keyEncryptionServiceHost:"https://kes.skype.com/v1/swx",keyEncryptionServiceHostV2:"https://kes.skype.com/v2/swx",locationHost:"https://www.bing.com/maps",faqPageUrl:"https://www.skype.com/go/help.faq.skype.for.web",oneAccountSupportUrl:"https://go.skype.com/one.account.for.skype.and.microsoft",feedbackPageUrl:"https://feedback.skype.com",pollFallbackUrl:"https://login.skype.com/login/sso?go=webclient",meProfileUrl:"https://go.skype.com/myaccount?intsrc=client-_-webapp-_-production-_-go-myaccount",listParticipantNamesInConversationTopic:!0,isPollingEnabled:!0,maximumParticipantsAudio:25,maximumParticipantsVideo:10,mentionsTreshold:4,startConversationMaxParticipantCount:0,defaultBusinessContactsGroup:"Web Contacts",businessNotificationPersistence:{persistWhenConnectedElsewhere:{enabled:!1,timeout:9e5},persistWhenAutoAccepted:{enabled:!1,timeout:9e5}},youtubeWrapDelay:500,youtubeApiUrl:"https://www.youtube.com/iframe_api",mapsApiUrl:"https://ecn.dev.virtualearth.net/mapcontrol/mapcontrol.ashx?v=7.0",flagsApiUrl:"https://flagsapi.skype.com/flags/v1",calendarUrl:"https://outlook.live.com/owa/?path=/calendar/action/compose&",legacyCalendarUrl:"https://calendar.live.com/?rru=addevent&",webLoginUrl:"https://login.skype.com/login",webLoginClientId:"680081",cookiesPrivacyUrl:"https://go.skype.com/privacy/",loginPopup:{loginUrl:"https://login.microsoftonline.com/common/oauth2/authorize",clientId:"e48d4214-364e-4731-b2b6-47dabf529218",redirectUrl:"https://latest-swx.cdn.skype.com/swx4b/aad/externalSignInHandler.html",resourceUrl:"https://webdir.online.lync.com",defaultWidth:800,defaultHeight:600},maxSilentLoginRetries:3,application:{endpointId:"d97583cc-9781-4a59-9628-06c4e609c65b"},shellApp:{contactPollingInterval:15e3,chromeExtensionId:"blakpkgjpemejpbmfiglncklihnhjkij",chromeExtensionWebstoreUrl:"https://chrome.google.com/webstore/detail/blakpkgjpemejpbmfiglncklihnhjkij",bootstrapperUrl:"https://swx.cdn.skype.com/shared/v/1.2.9/SkypeBootstrap.min.js",indexPageUrl:void 0,connectShellAppHostRetries:2},images:{skypeLogo:"https://swx.cdn.skype.com/assets/skype_logo_white.png",relativeToAppBase:{defaultProfileAvatarSvg:"/assets/images/avatars/default-avatar-contact.svg",defaultGroupAvatarSvg:"/assets/images/avatars/default-avatar-group.svg",defaultPstnAvatarSvg:"/assets/images/avatars/avatar-pstn.svg"}},uicServiceUrl:{byPassword:"https://rtc-uic.cloudapp.net/v0/getuic-jsonp",bySkypeToken:"https://uic.login.skype.com/login/uic"},autoCalling:{waitTimeOut:6e3,callTimeout:12e4,serviceFailureTimeout:3e3},cqf:{skypeCallPercentage:10,groupCallPercentage:10,pstnCallPercentage:10,minimumCallLengthSec:5,inactivityTimeout:6e4},unansweredUI:{minCallDuration:5e3,defaultGreenButtons:{chatButton:!0,retryButton:!1}},avatarService:{host:"https://avatar.skype.com/v1/",contactAvatarEndpoint:"avatars/${contactId}?auth_key=${authKey}&returnDefaultImage=false&cacheHeaders=true",publicAvatarEndpoint:"avatars/${contactId}/public?returnDefaultImage=false&cacheHeaders=true"},agentProvisioningService:{host:"https://api.aps.skype.com/v1/"},contactSearchWebService:{host:"https://skypegraph.skype.com/search/v1.1/namesearch/swx",mirroringHost:"https://skypegraphprodcanary2.cloudapp.net/search/v1.1/namesearch/swx"},inviteWebService:{host:"https://inviteconnector.skype.com"},stratusService:{host:"https://profile.skype.com/profile/v1/",retry:t},contactsService:{host:"https://contacts.skype.com/",myContactsEndpoint:"contacts/${version}/users/${id}/contacts?delta&$filter=type eq 'skype' or type eq 'msn' or type eq 'pstn' or type eq 'agent' or type eq 'lync'&reason=${reason}",retry:t},entitlementService:{host:"https://consumer.entitlement.skype.com/",listingEndpoint:"/users/${username}/services",serviceEndpoint:"/users/${username}/services/${service}",retry:t},abchUserWebService:{appId:"f9606e30-ea4c-4cc2-b655-082b97e630ed",host:"https://people.directory.live-int.com/"},profileService:{appId:"f9606e30-ea4c-4cc2-b655-082b97e630ed",host:"https://pf.directory.live-int.com/",profileEndpoint:"profile/mine/System.ShortCircuitProfile.json"},pnvService:{host:"https://a.qalogin.skype.net/",pnvEndpoint:"shortcircuit/phonenumberverification",clientId:"580081"},commerce:{purchaseCreditUrl:"https://go.skype.com/store.buy.skypecredit",purchaseSubscriptionUrl:"https://go.skype.com/rates"},skypeFromOutlook:{host:"https://support.skype.com/",page:"/faq/FA12247/how-do-i-use-skype-from-my-outlook-com-account"},userOptionsService:{host:"https://options.skype.com",optionsEndpoint:"/options/v1/users/${userId}/options/${optionName}"},messageSearchService:{host:"https://scsquerycontroltower.cloudapp.net/",endpoints:{query:"v1/query"}},smsPriceWebService:{host:"https://skypesmssfe.trafficmanager.net"},controls:{sidebar:"Sidebar",content:"Content",me:"Me"},plugin:{pingHeartBeatTimeout:5e3,loadDelayMilisec:250,loadDuringDetection:!0,maxTotalLoadDelayMilisec:6e5,managerLoadTimeout:4e3,pluginInitTimeout:25e3,manifestKey:"SkypePluginManifestProd",ecsService:"prod",download:{msi:"https://swx.cdn.skype.com/plugin/SkypeWebPlugin.msi",pkg:"https://swx.cdn.skype.com/plugin/SkypeWebPlugin.pkg",minVersion:"7.0.0.5",maxVersion:"99.99.99.99"}},pluginless:{conversationServiceUrl:"https://api.conv.skype.com/conv/",mediaAgent:{numVideoChannelsGvc:6,renegotiationAttempts:3,enableReconnectChrome:!0,enableReconnectEdge:!0,reconnectGlareCallDropTimeout:1e4,preferSdesSrtp:!0,iceDisconnectedTimeoutMs:3e4,webrtcVideoCapabilityMaxFS:1200,webrtcVideoCapabilityMaxFPS:3e3,webrtcScreensharingCapabilityMaxFS:8160,webrtcScreensharingCapabilityMaxFPS:1500,webrtcVideoCapabilityCheckIntervalMin:2e4,webrtcVideoCapabilityCheckIntervalMax:3e4,webrtcScreensharingCapabilityCheckIntervalMin:0,webrtcScreensharingCapabilityCheckIntervalMax:0,enableLocalVideoConstraints:!0,webrtcAudioChannelSignalingFeedback:"app recv:dsh",webrtcVideoChannelSignalingFeedback:"app send:src recv:src",webrtcNativeCpuOveruseDisabled:!1,ortcVideoCapabilityMaxFS:1200,ortcVideoCapabilityMaxFPS:3e3,ortcVideoCapabilityCheckIntervalMin:2e4,ortcVideoCapabilityCheckIntervalMax:3e4,ortcPreferBundling:!0,webrtcResolutionManagerCooldownTimeout:15e3,webrtcResolutionManagerRetryDelay:5e3,webrtcMultiPartyVideoScaling:!1,capabilities:{webrtc:{screensharing:!1}},dtmf:{toneDuration:200,toneGap:100},activeSpeaker:{timeToPromote:3e3},webrtcVideoSubscriptionDisposeTimeout:0,ortcOutgoingScreenSharingEnabled:!1,webrtcOutgoingScreenSharingEnabled:!1,iceServerTransport:"udp,tcp"},allowedMinEdgeVersion:13},unreadMessageReminderType:"emphasized",featureFlags:{agentsDiscoverable:!1,agentsEnabled:!1,showAgentIdOnProfile:!1,showAgentRatingOnProfile:!1,showAgentExtraInfoOnProfile:!1,newChat:!1,pinningToDogfoodCloud:!1,resizeCallAndChat:!1,creditBalanceAutoUpdateEnabled:!1,contactListChangeNotification:!1,deactivateCache:!1,skypeDirectorySearch:!1,muteNotifications:!1,muteNotificationsWithClosedSidebar:!1,muteSpecificConversationsEnabled:!1,browserNativeNotificationsEnabled:!1,useDarkThemeForBrowserNotificationsOptInFlow:!1,browserNotificationEducationalToastEnabled:!1,notifyHostEvenWhenMeNotAvailable:!1,newConversationV2:!1,spaces:!1,lastSeen:!1,mobileIndicator:!1,hasBetaLabel:!1,hasFeedbackLink:!1,hasFeedbackLinkOnError:!1,hasTimelineBadge:!1,showContactsPageHint:!1,showContactsPageInformationalMessage:!1,showFirstRunLandingExperience:!1,includeSelfInParticipantsCount:!1,showAlternateShareDialogExperience:!1,canNotifyWithoutVideo:!1,silentLinking:!1,showDefaultAvatarInNotifications:!1,directorySearchSkypeAndLync:!1,fetchContactsByPageEnabled:!1,contactPageFilterTabs:!1,doNotSendContactsToChatService:!1,supportStandbyMode:!1,disablePollingOnKahuna:!1,unreadMessageReminderToast:!1,profileUpdateNotificationsEnabled:!1,skypeUriNavigationEnabled:!0,timezoneInChatServiceRequest:!1,addHighPriorityScript:!1,calling:!0,autoCalling:!1,NGCalling:!1,PSTN:!1,disableCallingOnIE:!1,disableCallingOnEdge:!1,disableCallingOnChrome:!1,disableCallingOnFirefox:!1,disableCallingOnSafari:!1,pluginAutoUpdate:!1,persistentPlugin:!1,persistentShellApp:!1,preloadPlugin:!1,preloadShellApp:!1,GVCEscalation:!1,GVCLocalEscalation:!1,GVCJoining:!1,GVCOutgoing:!1,callingFullScreen:!1,CQF:!1,unansweredCallUIEnabled:!1,deviceDisabledDialogEnabled:!1,pluginlessCallingFirefox:!1,pluginlessCallingChrome:!1,pluginlessCallingEdge:!1,pluginlessCallingElectron:!1,pluginlessCallingChromeLinux:!1,pluginlessVideoCallingChromeLinux:!1,pluginlessVideoCallingFirefox:!1,pluginlessGroupVideoCallingChromeLinux:!1,pluginlessPSTNCalling:!1,pluginlessIncomingScreenSharingEdge:!1,pluginlessRemoteEscalation:!1,pluginlessLocalEscalation:!1,hostlessGroupCallingPluginless:!0,swiftCardCommand:!1,swiftCardRendering:!1,swiftCardRenderingMediaCards:!1,botMessagesModeV2enabled:!1,suggestedActionsEnabled:!1,issueReporting:!1,callInfoCommand:!1,serviceFailureReporting:!1,skypeDataTelemetry:!1,shellAppLogs:!1,consoleLogging:!1,errorLogReporting:!1,enableUnreadMessagesLogging:!1,contextMenuQuoteMessagesEnabled:!1,contextMenuSaveVideoMessagesEnabled:!1,contextMenuMarkAsReadEnabled:!1,contextMenuCopyMessagesEnabled:!1,alternativeSidebarLayout:!1,formatQuotesEnabled:!1,skypeCallPolicySupport:!1,skypeVideoCallingPolicySupport:!1,spaceTopicEditor:!1,markReadMessagesV2Enabled:!1,copySelectionAsQuoteKeyboard:!1,GDPRwebApi:!1,userSettingsEnabled:!1,alternativeSettingsPositionEnabled:!1,showUnlistedSettings:!1,aboutPageEnabled:!1,moodMessageEditEnabled:!1,inviteFree:!1,inviteFreeImplicitIncomingContactRequest:!1,shortCircuit:!1,pesCDNAuthUrlFallbackEnabled:!1,pesFetchSmallAssetsOnDemand:!1,pesFetchMediumAssetsOnDemand:!1,pesFetchLargeAssetsOnDemand:!1,pesFetchMojiAssetsOnDemand:!1,pesCDNAuthEnabled:!1,pesUseExtraLargeEmoticons:!1,hideEmoticonPickerButton:!1,pesBingImageSearchEnabled:!1,pesGiphyImageSearchEnabled:!1,pesLocalSearchEnabled:!1,emoticonSettingsEnabled:!1,emoticonSuggestionEnabled:!1,emoticonImplicitSuggestionDisabled:!1,showEmoticonSuggestionsSetting:!1,suggestHiddenEmoticons:!1,pesStoreEnabled:!1,canvasEmoticonsEnabled:!1,urlPreviews:!1,youtubePlayer:!1,urlPreviewLoadYoutubePlayer:!1,incomingScreenSharing:!1,outgoingScreenSharing:!1,outgoingScreenSharingPreview:!1,transferCall:!1,incomingWikiMarkup:!1,isCloudVideoMessageEnabled:!1,isCloudAudioMessageEnabled:!1,isFlikMessageEnabled:!1,newUrlPreviewDomainEnabled:!1,contactCardRenderingEnabled:!1,sendContactCardEnabled:!1,aggressiveImplicitMentionsMatching:!1,enableAggressiveMentionsToast:!1,mentionsEnabled:!1,mentionsPeopleEnabled:!1,codeSnippetEnabled:!1,notificationsCenter:!1,supportMessageProperties:!1,enablePingEcsConfig:!0,enableEndpointEcsConfig:!0,heartsEnabled:!1,heartsNotificationEnabled:!1,showChatIntroText:!1,pollsEnabled:!1,translatorSendingEnabled:!1,showTimestampsInNarrowMode:!1,reactionsSupportEnabled:!1,photoSharingEnabled:!1,fileTransferEnabled:!1,mediaBarEnabled:!1,mediaBarV2Enabled:!1,fileDragDropEnabled:!1,filePasteEnabled:!1,showMessageDeliveryIndicator:!1,showMessageDeliveryStatus:!1,readReceiptEnabled:!1,isTypingIndicator:!1,showWhenIamTyping:!1,creditGifting:!1,failInitializationOnIE:!1,searchEducationBubble:!1,callEducationBubble:!1,chatEducationBubble:!1,scheduleCallEducationBubble1:!1,scheduleCallEducationBubble2:!1,scheduleCallFromConversation:!1,useLegacySchedulerUriFormat:!1,welcomeDialog:!1,useAzureBasedSilentLogin:!1,enableRawEmoticonsRendering:!1,fullScreenModeFromSidepane:!1,contentSearch:!1,giphy:!1,meCommandEnabled:!1,telemetrySearchEnabled:!1,uiActionPerfTelemetryEnabled:!1,runtimeErrorsTelemetryEnabled:!1,captureSourceInAllTelemetryEnabled:!1,idleUsersAnalytics:!1,usersAnalytics:!1,enhancedNotification:!1,sidebarReopenEnabled:!1,keyEncryptionServiceV2Enabled:!1,navigationMenuIconsEnabled:!1,favoritesConversationsEnabled:!1,favoriteContactsEnabled:!1,useGraphSearchAnnotations:!1,graphSearchMirroringEnabled:!1,syncThreadBeforeJoinConversationEnabled:!1,audioVideoSettingsSupport:!1,useWhiteThemeForSplashScreen:!1,showSignInButtonOnTimeout:!1,showSignInButtonOnSignout:!1,notificationsSettingsEnabled:!1,notificationsSoundsSettingsEnabled:!1,ringingDeferring:!1,chatNotificationsSettingsEnabled:!1,chatNotificationsSoundSettingsEnabled:!1,callNotificationsSettingsEnabled:!1,callNotificationsSoundSettingsEnabled:!1,incomingCallToastNotifications:!1,unreadMessageToastNotifications:!1,contactRequestToastNotifications:!1,chatRequestToastNotifications:!1,unreadMessageToastForActiveEndpoint:!1,chatMessageTypeNotificationEnabled:!1,useAvatarCache:!1,useAvatarInitials:!1,avatarServiceSupportsSizeParameter:!1,showOneAccountLink:!1,initPreferencesAfterSignin:!1,darkThemeEnabled:!1,videoAutoPlaybackSettingsEnabled:!1,askToUnblockPlugin:!0,smsSupportEnabled:!1,unreadConversationDebugger:!1,groupAvatarUpdateEnabled:!1,hideSystemMessages:!1,hideSidebarOnStart:!1,messageEnforceTextFormat:!1,removeConversationHistory:!1,headerControlsDisabled:!1,singleConversationMode:!1,skipChatCapabilityCheck:!1,lowFocusImportanceContactRequest:!1,enableBusinessContactManagement:!1,useBusinessWording:!1,searchEducationBubbleBusiness:!1,chatEducationBubbleBusiness:!1,notificationsToggleEnabled:!1,disableConcurrentActiveCalls:!1,disableContactCardMenu:!1,disableKes:!1,disableLeaveConversation:!1,disableOpenConversationWithAuthor:!1,disablePersistentContactPresenceSubscription:!1,optimizeSpaceForCC:!1,disableRemoveConversationConfirmation:!1,disableCallScreenChatOption:!1,showEducationalCarousel:!1,hasFeedbackIcon:!1,showPickerSpinner:!1,showSearchQueryMoreResultsAvailable:!1,callscreenMinMax:!1,showTeamsAlert:!1},retry:t,webApiService:{retry:{limit:5,delay:100,strategy:"exponential"},overrides:{ping:{strategy:"fixed"}},pingDelayTime:{min:30,max:60},endpointRetry:{base:5,limit:120,noiseFactor:.5},standbyPollingDelayTime:{min:30,max:30}},swift:{urlPrefixBlacklist:["http","file","smb"]},giphy:{apiKey:"x4Rn0SRIjjXEc",rating:"pg-13"},contactsPageInformationalMessage:{key:"",link:""},conversationHistoryPageSize:30,incomingCalls:{notificationTimeout:3e4,trouterServiceUrl:"https://go.trouter.io/v2/a",tpcServiceUrl:"https://prod.tpc.skype.com/v1/policies",registrarServiceUrl:"https://prod.registrar.skype.com/v2/registrations",registrarTtlInSeconds:3600,registrarRefreshTimeoutInMs:354e4,trouterReadyTimeoutInMs:2e4,trouterConnectTimeoutInMs:1e4,maxRegistrationTimeInMs:864e5,pnhAppId:"skype",pnhTemplate:"SkypeWeb_1.5",pnhNGCTemplate:"SkypeWebNGC_1.7",p2pToNgcNotificationTimeout:2e3,connectTimeout:9e4,trouterTelemetryEnvironment:"int"},telemetry:{uiTenantToken:"bb15b8f2b7f446d4af2e245fc3b07e79-31d92fdb-e7a5-4be8-b14f-c48048f67a59-7685",jSkypeTenantToken:"bb15b8f2b7f446d4af2e245fc3b07e79-31d92fdb-e7a5-4be8-b14f-c48048f67a59-7685",skypeConcoreToken:"53fdaa090eb946b5a1d6cbdeb4f2ef66-bcbf6380-2590-41cc-ae60-9e467cd51835-7413",chatTenantToken:"b1e7805369ba4b5eaff1c894e532d32e-8ea4e021-e32f-4ba5-82ec-c1c980641d31-7035",trouterTenantToken:"19fbe91e74c64280aade16524a7fe51f-e0eb76a5-68df-4e5c-8ce3-6d33e395df6c-7043",mdscToken:"695e6c4def6c4847b178d16c83b926c4-51ac8017-8fbb-4069-9bf4-3e9cc75ebad8-7393",logReportingToken:"695e6c4def6c4847b178d16c83b926c4-51ac8017-8fbb-4069-9bf4-3e9cc75ebad8-7393",logThrottleInterval:1e4,issueReportUrl:"",issueReportScript:"",upnCorrelationIdEnabled:!1},serviceQosReporter:{iterationCountBeforeFlushingQoSMetrics:50},URLSanitizer:{securedResources:{allowedDomains:["**.skypeassets.com","**.skype.com"],allowedProtocols:["http","https"]}},initParams:e("experience/defaultInitParams"),applicationLanguage:"en-us",pesCDNAuthentication:{skypeServiceHost:"static.asm.skype.com",tokenSourceEndpoint:"/pes/v1/petoken",cdnServiceHost:"static-asm.secure.skypeassets.com",cookieSourceEndpoint:"/token/token_to_cookies",securedPathsPattern:"static[.]asm[.]skype[.]com",cdnTokenTtlMs:3e5,rewriteRules:[{from:"static.asm.skype.com",to:"static-asm.secure.skypeassets.com"},{from:"api.asm.skype.com",to:"static-asm.secure.skypeassets.com"}]},pesSearchServices:{bingApiKey:"aGt3dUhqZkFrbnZyU2doM1FqQ0RPQUdEUTFTbzNqc0FmYlFWMEFSSytMVTpoa3d1SGpmQWtudnJTZ2gzUWpDRE9BR0RRMVNvM2pzQWZiUVYwQVJLK0xV",bingAuthMethod:"Basic",bingServiceURL:"https://api.datamarket.azure.com/Bing/Search/v1/Image",bingTriggerWords:["bing","meme","gif"],bingDefaultSearchTerm:"popular",bingPickFirst:"gif",bingMergeItems:!0,bingBorderStyle:"thin",giphy:{withQuerySources:["translate","random","search"],withoutQuerySources:["trending"],serviceUrl:"https://api.giphy.com",apiKey:"x4Rn0SRIjjXEc",rating:"pg-13"},localSearchCategories:["Greetings","Happy","Love","Angry","Confused","Disgust"],localSearchGroupByType:!0},pesPicker:{useSelectedTabIconForPicker:!1,tabPlacementOverrides:{bing:-1,giphyImages:4}},pesStoreServices:{catalogApiHost:"apps.skypeassets.com",catalogServiceEndpoint:"/personal-expression?expansion=full&language=${lang}",catalogItemByIdServiceEndpoint:"/offers/sticker-pack/skus/${offerId}",catalogPurchaseEndpoint:"/purchase",catalogDogfoodContentEnabled:!1,catalogPurchaseApiHost:"api.skype.com",catalogServiceVersion:"3.0",catalogPurchaseApiVersion:"1.0"},splashScreen:{learnMoreUrl:"",signInNotificationEnabled:!1},authentication:{anonymousMode:!1},messageFilters:{outgoingMessageFilter:null,chatLogMessageFilter:null},xcoEnv:"qa",translatorClientAppId:"FF63883DDDED40068EC45030A601460C",translatorServiceURI:{TRANSLATE:"https://dev.microsofttranslator.com/api/skype/translate",LANGUAGES:"https://dev.microsofttranslator.com/api/languages"},userSettings:{hiddenCategories:[],hiddenPreferences:[],privacySettingsFetchTimeout:1e3},displayAppVersion:!1,cloudFileSharing:{unsafeFileTypes:".ade,.adp,.app,.asp,.bas,.bat,.cer,.chm,.cmd,.com,.cpl,.crt,.csh,.der,.exe,.fxp,.gadget,.hlp,.hta,.inf,.ins,.isp,.its,.js,.jse,.ksh,.lnk,.mad,.maf,.mag,.mam,.maq,.mar,.mas,.mat,.mau,.mav,.maw,.mda,.mdb,.mde,.mdt,.mdw,.mdz,.msc,.msh,.msh1,.msh2,.mshxml,.msh1xml,.msh2xml,.msi,.msp,.mst,.ops,.pcd,.pif,.plg,.prf,.prg,.pst,.reg,.scf,.scr,.sct,.shb,.shs,.ps1,.ps1xml,.ps2,.ps2xml,.psc1,.psc2,.tmp,.url,.vb,.vbe,.vbs,.vsmacros,.vsw,.ws,.wsc,.wsf,.wsh,.xnk"},flags:"",welcomeExperience:{enabled:!1,minDelayBeforeFirstMessage:0,maxDelayBeforeFirstMessage:3e5,toastPersistenceTimeout:3e5,whitelist:[]},avatarCacheDuration:36e5,greenId:{iframeUrl:"https://fpt.skype.com",registerUrl:"https://register.greenid.skype.com/api/register",timeout:2e4},s4bTeamsAlert:{notificationUrl:"https://aka.ms/weblearnmore",migartedUrl:"https://aka.ms/weblaunchclient"}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-service-locator/lib/serviceLocator",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	function i(e){if(!n.isString(e)||""===e)throw new Error("You must provide a valid name for this service")}var r=function(){function e(){}return e.prototype.contains=function(e){return i(e),e in this},e.prototype.fetchOne=function(e){if(i(e),!this.contains(e))throw new Error("Service '"+e+"' not found")
	return this[e]},e.prototype.resolve=function(e){return this.fetchOne(e)},e.prototype.register=function(e,t){if(Object.isFrozen(this))throw new Error("Service locator is readonly when registering ' "+e+"'")
	if(i(e),this.contains(e))throw new Error("Service '"+e+"' already registered")
	this[e]=t},e.prototype.destroy=function(e){if(Object.isFrozen(this))throw new Error("Service locator is readonly when removing ' "+e+"'")
	var t=this.resolve(e)
	if(!this.hasOwnProperty(e))throw new Error("Service '"+e+"' does not belong to this locator")
	return delete this[e],t},e.prototype.reset=function(){var e=this
	if(Object.isFrozen(this))throw new Error("Service locator is readonly when clearing it")
	Object.keys(this).forEach((function(t){return e.destroy(t)}))},e}()
	t.ServiceLocator=r,t.build=function(){return new r}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-service-locator/lib/serviceLocatorBuilder",["require","exports","lodash-compat","./serviceLocator"],e)}((function(e,t){var n=e("lodash-compat"),i=e("./serviceLocator"),r=function(){function e(){this.options={factories:[],frozen:!1,baseLocator:i.ServiceLocator.prototype}}return e.prototype.withOptions=function(e){return n.assign(this.options,e),this},e.prototype.withService=function(e,t){var i={name:e.name,build:e.build}
	return t&&n.extend(i,t),this.options.factories.push(i),this},e.prototype.withServiceInstance=function(e,t){return t?this.options.factories.push({name:t.name,build:function(){return e}}):this.options.factories.push({name:e.name,build:function(){return e.instance}}),this},e.prototype.frozen=function(){return this.options.frozen=!0,this},e.prototype.withBase=function(e){return this.options.baseLocator=e,this},e.prototype.build=function(e){var t=this
	return Promise.all(this.options.factories.map((function(e){return Promise.resolve(e.build()).then((function(t){return[e.name,t]}))}))).then((function(n){return n.reduce((function(e,t){var n=t[0],i=t[1]
	return e.register(n,i),e}),e||Object.create(t.options.baseLocator))})).then((function(e){return t.options.frozen?Object.freeze(e):e}))},e.prototype.buildSync=function(e){var t=this.options.factories.map((function(e){return[e.name,e.build()]})).map((function(e){var t=e[0],n=e[1]
	if(void 0===n.then)return[t,n]
	throw new Error("#buildSync can't build "+t+" because it is asynchronous")})).reduce((function(e,t){var n=t[0],i=t[1]
	return e.register(n,i),e}),e||Object.create(this.options.baseLocator))
	return this.options.frozen?Object.freeze(t):t},e}()
	t.serviceLocatorBuilder=function(e){var t=new r
	return e?t.withOptions(e):t}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-service-locator/lib/index",["require","exports","./serviceLocator","./serviceLocatorBuilder"],e)}((function(e,t){var n=e("./serviceLocator")
	t.ServiceLocator=n
	var i=e("./serviceLocatorBuilder")
	t.serviceLocatorBuilder=i.serviceLocatorBuilder})),define("swx-service-locator",["swx-service-locator/lib/index"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-service-locator-instance/lib/instance",["require","exports","swx-service-locator"],e)}((function(e,t){var n=e("swx-service-locator")
	t.__esModule=!0,t.default=n.ServiceLocator.build()})),define("swx-service-locator-instance",["swx-service-locator-instance/lib/instance"],(function(e){return e})),function(e){e.version="2.7.1"}(clienttelemetry_build||(clienttelemetry_build={})),function(e){(function(e){(function(e){e[e.BT_STOP=0]="BT_STOP",e[e.BT_STOP_BASE=1]="BT_STOP_BASE",e[e.BT_BOOL=2]="BT_BOOL",e[e.BT_UINT8=3]="BT_UINT8",e[e.BT_UINT16=4]="BT_UINT16",e[e.BT_UINT32=5]="BT_UINT32",e[e.BT_UINT64=6]="BT_UINT64",e[e.BT_FLOAT=7]="BT_FLOAT",e[e.BT_DOUBLE=8]="BT_DOUBLE",e[e.BT_STRING=9]="BT_STRING",e[e.BT_STRUCT=10]="BT_STRUCT",e[e.BT_LIST=11]="BT_LIST",e[e.BT_SET=12]="BT_SET",e[e.BT_MAP=13]="BT_MAP",e[e.BT_INT8=14]="BT_INT8",e[e.BT_INT16=15]="BT_INT16",e[e.BT_INT32=16]="BT_INT32",e[e.BT_INT64=17]="BT_INT64",e[e.BT_WSTRING=18]="BT_WSTRING",e[e.BT_UNAVAILABLE=127]="BT_UNAVAILABLE"})(e.BondDataType||(e.BondDataType={}))
	e.BondDataType;(function(e){e[e.MARSHALED_PROTOCOL=0]="MARSHALED_PROTOCOL",e[e.MAFIA_PROTOCOL=17997]="MAFIA_PROTOCOL",e[e.COMPACT_PROTOCOL=16963]="COMPACT_PROTOCOL",e[e.JSON_PROTOCOL=21322]="JSON_PROTOCOL",e[e.PRETTY_JSON_PROTOCOL=20554]="PRETTY_JSON_PROTOCOL",e[e.SIMPLE_PROTOCOL=20563]="SIMPLE_PROTOCOL"})(e.ProtocolType||(e.ProtocolType={}))
	e.ProtocolType})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){(function(e){(function(e){var t=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e){for(var t=0;t<this._buffer.length&&this._buffer[t]!=e;++t);t==this._buffer.length&&this._buffer.push(e)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e}()
	e.Set=t
	var n=function(){function e(){this._buffer=[]}return e.prototype.Add=function(e,t){-1==this._getIndex(e)&&this._buffer.push({Key:e,Value:t})},e.prototype.AddOrReplace=function(e,t){var n=this._getIndex(e)
	n>=0?this._buffer[n]={Key:e,Value:t}:this._buffer.push({Key:e,Value:t})},e.prototype.Remove=function(e){var t=this._getIndex(e)
	t>=0&&this._buffer.splice(t,1)},e.prototype.Count=function(){return this._buffer.length},e.prototype.GetBuffer=function(){return this._buffer},e.prototype.ContainsKey=function(e){return this._getIndex(e)>=0},e.prototype.Get=function(e){var t=this._getIndex(e)
	return t>=0?this._buffer[t].Value:null},e.prototype._getIndex=function(e){for(var t=0,n=-1;t<this._buffer.length;++t)if(this._buffer[t].Key==e){n=t
	break}return n},e}()
	e.Map=n})(e.Collections||(e.Collections={}))})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){(function(t){(function(e){var i=function(){function e(){}return e.GetBytes=function(e){for(var t=[],n=0;n<e.length;++n){var i=e.charCodeAt(n)
	i<128?t.push(i):i<2048?t.push(192|i>>6,128|63&i):i<55296||i>=57344?t.push(224|i>>12,128|i>>6&63,128|63&i):(i=65536+((1023&i)<<10|1023&e.charCodeAt(++n)),t.push(240|i>>18,128|i>>12&63,128|i>>6&63,128|63&i))}return t},e}()
	e.Utf8=i
	var r=function(){function e(){}return e.GetString=function(e){var t,n,i,r,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=[],s=e.length%3
	for(t=0,i=e.length-s;t<i;t+=3)n=(e[t]<<16)+(e[t+1]<<8)+e[t+2],a.push([o.charAt((r=n)>>18&63),o.charAt(r>>12&63),o.charAt(r>>6&63),o.charAt(63&r)].join(""))
	switch(s){case 1:n=e[e.length-1],a.push(o.charAt(n>>2)),a.push(o.charAt(n<<4&63)),a.push("==")
	break
	case 2:n=(e[e.length-2]<<8)+e[e.length-1],a.push(o.charAt(n>>10)),a.push(o.charAt(n>>4&63)),a.push(o.charAt(n<<2&63)),a.push("=")}return a.join("")},e}()
	e.Base64=r
	var o=function(){function e(){}return e.GetBytes=function(e){for(var t=[];4294967168&e;)t.push(127&e|128),e>>>=7
	return t.push(127&e),t},e}()
	e.Varint=o
	var a=function(){function e(){}return e.GetBytes=function(e){for(var t=e.low,n=e.high,i=[];n||4294967168&t;)i.push(127&t|128),t=(127&n)<<25|t>>>7,n>>>=7
	return i.push(127&t),i},e}()
	e.Varint64=a
	var s=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(4))
	i.setFloat32(0,e,!0)
	for(var r=[],o=0;o<4;++o)r.push(i.getUint8(o))
	return r}return n.ConvertNumberToArray(e,!1)},e}()
	e.Float=s
	var c=function(){function e(){}return e.GetBytes=function(e){if(t.BrowserChecker.IsDataViewSupport()){var i=new DataView(new ArrayBuffer(8))
	i.setFloat64(0,e,!0)
	for(var r=[],o=0;o<8;++o)r.push(i.getUint8(o))
	return r}return n.ConvertNumberToArray(e,!0)},e}()
	e.Double=c
	var l=function(){function e(){}return e.EncodeZigzag16=function(e){return(e=t.Number.ToInt16(e))<<1^e>>15},e.EncodeZigzag32=function(e){return(e=t.Number.ToInt32(e))<<1^e>>31},e.EncodeZigzag64=function(e){var n=e.low,i=e.high,r=i<<1|n>>>31,o=n<<1
	2147483648&i&&(r=~r,o=~o)
	var a=new t.UInt64("0")
	return a.low=o,a.high=r,a},e}()
	e.Zigzag=l})(t.Encoding||(t.Encoding={})),function(i){var r=function(){function e(){}return e.GetString=function(e){for(var t=[],n=0;n<e.length;++n){var i=e[n]
	if(i<=191)t.push(String.fromCharCode(i))
	else if(i<=223){var r=e[++n]
	t.push(String.fromCharCode((31&i)<<6|63&r))}else if(i<=239){r=e[++n]
	var o=e[++n]
	t.push(String.fromCharCode((15&i)<<12|(63&r)<<6|63&o))}else{i=(7&i)<<18|(63&(r=e[++n]))<<12|(63&(o=e[++n]))<<6|63&e[++n],i-=65536,t.push(String.fromCharCode(55296|i>>10&1023)),t.push(String.fromCharCode(56320|1023&i))}}return t.join("")},e}()
	i.Utf8=r
	var o=function(){function e(){}return e.GetBytes=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=[],i=0;i<e.length;++i){var r=t.indexOf(e.charAt(i++)),o=t.indexOf(e.charAt(i++)),a=t.indexOf(e.charAt(i++)),s=t.indexOf(e.charAt(i))
	n.push(r<<2|o>>4),a>=0&&(n.push(o<<4&240|a>>2),s>=0&&n.push(a<<6&192|s))}return n},e}()
	i.Base64=o
	var a=function(){function t(){}return t.GetInt64=function(t){var n=new e.Bond.Int64("0"),i=this._Read(t)
	return n.low=i[0],i.length>1&&(n.high=i[1]),n},t.GetNumber=function(e){return this._Read(e)[0]},t._Read=function(e){for(var t=[],n=0,i=!0,r=0;i;){if(i=0!=(128&(o=e.shift())),o&=127,!(r<28)){n|=o<<r,t.push(n),n=o>>4,r=3
	break}n|=o<<r,r+=7}for(;i;){var o
	if(i=0!=(128&(o=e.shift())),n|=(o&=127)<<r,(r+=7)>=32)break}return t.push(n),t},t}()
	i.Varint=a
	var s=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(4)),r=0;r<4;++r)i.setUint8(r,e[r])
	return i.getFloat32(0,!0)}return n.ConvertArrayToNumber(e,!1)},e}()
	i.Float=s
	var c=function(){function e(){}return e.GetNumber=function(e){if(t.BrowserChecker.IsDataViewSupport()){for(var i=new DataView(new ArrayBuffer(8)),r=0;r<8;++r)i.setUint8(r,e[r])
	return i.getFloat64(0,!0)}return n.ConvertArrayToNumber(e,!0)},e}()
	i.Double=c
	var l=function(){function t(){}return t.DecodeZigzag16=function(e){return((65535&e)>>>1^-(1&e))<<16>>16},t.DecodeZigzag32=function(e){return e>>>1^-(1&e)},t.DecodeZigzag64=function(t){var n=1&t.high,i=t.high>>>1,r=1&t.low,o=t.low>>>1
	o|=n<<31,r&&(o^=4294967295,i^=4294967295)
	var a=new e.Bond.UInt64("0")
	return a.low=o,a.high=i,a},t}()
	i.Zigzag=l}(t.Decoding||(t.Decoding={}))
	var n=function(){function e(){}return e.ConvertNumberToArray=function(e,t){if(!e)return t?this._doubleZero:this._floatZero
	var n=t?52:23,i=(1<<(t?11:8)-1)-1,r=1-i,o=i,a=e<0?1:0
	e=Math.abs(e)
	for(var s=Math.floor(e),c=e-s,l=2*(i+2)+n,u=new Array(l),d=0;d<l;)u[d++]=0
	for(d=i+2;d&&s;)u[--d]=s%2,s=Math.floor(s/2)
	for(d=i+1;d<l-1&&c>0;)(c*=2)>=1?(u[++d]=1,--c):u[++d]=0
	for(var p=0;p<l&&!u[p];++p);var f=i+1-p,m=p+n
	if(u[m+1]){for(d=m;d>p&&!(u[d]=1-u[d]);--d);d==p&&++f}if(f>o||s)return a?t?this._doubleNegInifinity:this._floatNegInifinity:t?this._doubleInifinity:this._floatInifinity
	if(f<r)return t?this._doubleZero:this._floatZero
	if(t){var h=0
	for(d=0;d<20;++d)h=h<<1|u[++p]
	for(var v=0;d<52;++d)v=v<<1|u[++p]
	return[255&v,v>>8&255,v>>16&255,v>>>24,255&(h=a<<31|2147483647&(h|=f+i<<20)),h>>8&255,h>>16&255,h>>>24]}var g=0
	for(d=0;d<23;++d)g=g<<1|u[++p]
	return[255&(g=a<<31|2147483647&(g|=f+i<<23)),g>>8&255,g>>16&255,g>>>24]},e.ConvertArrayToNumber=function(e,n){var i=(1<<(n?11:8)-1)-1,r=0!=(128&e[n?7:3]),o=n?(127&e[7])<<4|(240&e[6])>>4:(127&e[3])<<1|(128&e[2])>>7
	if(255==o)throw new t.Exception("Not a valid float/double buffer.")
	var a=1,s=1
	if(n){var c=(15&e[6])<<28|(255&e[5])<<20|(255&e[4])<<12,l=e[3]<<24|(255&e[2])<<16|(255&e[1])<<8|255&e[0]
	if(!o&&!c&&!l)return 0
	for(var u=0;u<20;++u)s/=2,c<0&&(a+=s),c<<=1
	for(u=0;u<32;++u)s/=2,l<0&&(a+=s),l<<=1}else{var d=(127&e[2])<<25|(255&e[1])<<17|(255&e[0])<<9
	if(!o&&!d)return 0
	for(u=0;u<23;++u)s/=2,d<0&&(a+=s),d<<=1}return a*=Math.pow(2,o-i),r?0-a:a},e._floatZero=[0,0,0,0],e._doubleZero=[0,0,0,0,0,0,0,0],e._floatInifinity=[0,0,128,127],e._floatNegInifinity=[0,0,128,255],e._doubleInifinity=[0,0,0,0,0,0,240,127],e._doubleNegInifinity=[0,0,0,0,0,0,240,255],e}()})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){(function(e){(function(t){var n=function(){function t(){this._buffer=[]}return t.prototype.WriteByte=function(t){this._buffer.push(e.Number.ToByte(t))},t.prototype.Write=function(e,t,n){for(;n--;)this.WriteByte(e[t++])},t.prototype.GetBuffer=function(){return this._buffer},t}()
	t.MemoryStream=n})(e.IO||(e.IO={}))})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){(function(e){var t=function(e,t){this.Type=e,this.Id=t}
	e.FieldTag=t
	var n=function(e,t){this.ElementType=e,this.Size=t}
	e.ContainerTag=n
	var i=function(e,t,n){this.KeyType=e,this.ValueType=t,this.Size=n}
	e.KeyValueContainerTag=i
	var r=function(){}
	e.Bonded=r
	var o=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e),this.low<0&&(this.high=-1)}return e.prototype.Equals=function(t){var n=new e(t)
	return this.low==n.low&&this.high==n.high},e}()
	e.Int64=o
	var a=function(){function e(e){this.low=0,this.high=0,this.low=parseInt(e)}return e.prototype.Equals=function(t){var n=new e(t)
	return this.low==n.low&&this.high==n.high},e}()
	e.UInt64=a
	var s=function(){function e(){}return e.ToByte=function(e){return this.ToUInt8(e)},e.ToInt8=function(e){return 127&e|(128&e)<<24>>24},e.ToInt16=function(e){return 32767&e|(32768&e)<<16>>16},e.ToInt32=function(e){return 2147483647&e|2147483648&e},e.ToUInt8=function(e){return 255&e},e.ToUInt16=function(e){return 65535&e},e.ToUInt32=function(e){return 4294967295&e},e}()
	e.Number=s
	var c=function(e){this.Message=e}
	e.Exception=c
	var l=function(){}
	e.KeyValuePair=l
	var u=function(){function e(){}return e.IsDataViewSupport=function(){return"undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},e}()
	e.BrowserChecker=u})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){(function(e){var t=function(){function t(e){this._stream=e}return t.prototype.WriteBlob=function(e){this._stream.Write(e,0,e.length)},t.prototype.WriteBool=function(e){this._stream.WriteByte(e?1:0)},t.prototype.WriteContainerBegin=function(e,t){this.WriteUInt8(t),this.WriteUInt32(e)},t.prototype.WriteMapContainerBegin=function(e,t,n){this.WriteUInt8(t),this.WriteUInt8(n),this.WriteUInt32(e)},t.prototype.WriteContainerEnd=function(){},t.prototype.WriteDouble=function(t){var n=e.Encoding.Double.GetBytes(t)
	this._stream.Write(n,0,n.length)},t.prototype.WriteFloat=function(t){var n=e.Encoding.Float.GetBytes(t)
	this._stream.Write(n,0,n.length)},t.prototype.WriteFieldBegin=function(e,t,n){t<=5?this._stream.WriteByte(e|t<<5):t<=255?(this._stream.WriteByte(192|e),this._stream.WriteByte(t)):(this._stream.WriteByte(224|e),this._stream.WriteByte(t),this._stream.WriteByte(t>>8))},t.prototype.WriteFieldEnd=function(){},t.prototype.WriteFieldOmitted=function(e,t,n){},t.prototype.WriteInt16=function(t){t=e.Encoding.Zigzag.EncodeZigzag16(t),this.WriteUInt16(t)},t.prototype.WriteInt32=function(t){t=e.Encoding.Zigzag.EncodeZigzag32(t),this.WriteUInt32(t)},t.prototype.WriteInt64=function(t){this.WriteUInt64(e.Encoding.Zigzag.EncodeZigzag64(t))},t.prototype.WriteInt8=function(t){this._stream.WriteByte(e.Number.ToInt8(t))},t.prototype.WriteString=function(t){if(""==t)this.WriteUInt32(0)
	else{var n=e.Encoding.Utf8.GetBytes(t)
	this.WriteUInt32(n.length),this._stream.Write(n,0,n.length)}},t.prototype.WriteStructBegin=function(e,t){},t.prototype.WriteStructEnd=function(t){this.WriteUInt8(t?e.BondDataType.BT_STOP_BASE:e.BondDataType.BT_STOP)},t.prototype.WriteUInt16=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt16(t))
	this._stream.Write(n,0,n.length)},t.prototype.WriteUInt32=function(t){var n=e.Encoding.Varint.GetBytes(e.Number.ToUInt32(t))
	this._stream.Write(n,0,n.length)},t.prototype.WriteUInt64=function(t){var n=e.Encoding.Varint64.GetBytes(t)
	this._stream.Write(n,0,n.length)},t.prototype.WriteUInt8=function(t){this._stream.WriteByte(e.Number.ToUInt8(t))},t.prototype.WriteWString=function(e){this.WriteUInt32(e.length)
	for(var t=0;t<e.length;++t){var n=e.charCodeAt(t)
	this._stream.WriteByte(n),this._stream.WriteByte(n>>>8)}},t}()
	e.CompactBinaryProtocolWriter=t
	var n=function(){}
	e.CompactBinaryProtocolReader=n})(e.Bond||(e.Bond={}))}(Microsoft||(Microsoft={})),function(e){var t=function(){function t(){}return t.IsSafari=function(){if(null===t._isSafari)if("undefined"!=typeof navigator&&navigator.userAgent){var e=navigator.userAgent.toLowerCase()
	e.indexOf("safari")>=0&&e.indexOf("chrome")<0?t._isSafari=!0:t._isSafari=!1}else t._isSafari=!1
	return t._isSafari},t.IsReactNative=function(){return null===t._isReactNative&&("undefined"!=typeof navigator&&navigator.product?t._isReactNative="ReactNative"===navigator.product:t._isReactNative=!1),t._isReactNative},t.IsUint8ArrSupported=function(){return!e.Utils.IsSafari()&&"undefined"!=typeof Uint8Array&&!e.Utils.IsReactNative()},t.ajax=function(e,n){var i=t._createConnection()
	if(e.headers){var r="qsp=true"
	for(var o in e.headers)r+="&",r+=encodeURIComponent(o),r+="=",r+=encodeURIComponent(e.headers[o])
	e.url.indexOf("?")<0?e.url+="?":e.url+="&",e.url+=r}i.open(e.type,e.url,!n),e.complete&&(i.onload=function(){void 0===i.status&&(i.status=200),e.complete(i)},i.ontimeout=function(){void 0===i.status&&(i.status=500),e.complete(i)},i.onerror=function(){e.complete(i)}),i.send(e.data)},t.keys=function(e){if(Object.keys)return Object.keys(e)
	var t=[]
	for(var n in e)e.hasOwnProperty(n)&&t.push(n)
	return t},t.IsUsingXDomainRequest=function(){null==t._usingXDomainRequest&&(void 0===(new XMLHttpRequest).withCredentials&&"undefined"!=typeof XDomainRequest?t._usingXDomainRequest=!0:t._usingXDomainRequest=!1)
	return t._usingXDomainRequest},t._createConnection=function(){var e=new XMLHttpRequest
	return t.IsUsingXDomainRequest()?new XDomainRequest:e},t._isSafari=null,t._isReactNative=null,t._usingXDomainRequest=null,t}()
	e.Utils=t}(sct||(sct={})),function(e){(function(e){(function(e){(function(t){var n=function(){function e(){}return e.GetGuid=function(){var e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1,5)}
	return[e(),e(),"-",e(),"-",e(),"-",e(),"-",e(),e(),e()].join("")},e.GetTimeStamp=function(){var e=(new Date).getTime(),t=new Microsoft.Bond.Int64("0")
	return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e.GetTimeStampWithValue=function(e){var t=new Microsoft.Bond.Int64("0")
	return t.low=4294967295&e,t.high=Math.floor(e/4294967296),t},e}()
	t.utils=n,function(e){e[e.NotSet=0]="NotSet",e[e.Event=1]="Event",e[e.PerformanceCounter=2]="PerformanceCounter",e[e.Anomaly=3]="Anomaly",e[e.Prediction=4]="Prediction",e[e.TraceLog=5]="TraceLog",e[e.EventSourceLog=6]="EventSourceLog",e[e.HttpLog=7]="HttpLog",e[e.PerformanceCounterAzure=8]="PerformanceCounterAzure",e[e.PerformanceCounterGfs=9]="PerformanceCounterGfs"}(t.RecordType||(t.RecordType={}))
	t.RecordType;(function(e){e[e.NotSet=0]="NotSet",e[e.O365=1]="O365",e[e.SkypeBI=2]="SkypeBI",e[e.SkypeData=3]="SkypeData"})(t.PIIScrubber||(t.PIIScrubber={}))
	t.PIIScrubber;(function(e){e[e.NotSet=0]="NotSet",e[e.DistinguishedName=1]="DistinguishedName",e[e.GenericData=2]="GenericData",e[e.IPV4Address=3]="IPV4Address",e[e.IPv6Address=4]="IPv6Address",e[e.MailSubject=5]="MailSubject",e[e.PhoneNumber=6]="PhoneNumber",e[e.QueryString=7]="QueryString",e[e.SipAddress=8]="SipAddress",e[e.SmtpAddress=9]="SmtpAddress",e[e.Identity=10]="Identity",e[e.Uri=11]="Uri",e[e.Fqdn=12]="Fqdn",e[e.IPV4AddressLegacy=13]="IPV4AddressLegacy"})(t.PIIKind||(t.PIIKind={}))
	t.PIIKind;(function(e){e[e.Unknown=0]="Unknown",e[e.MSACID=1]="MSACID",e[e.MSAPUID=2]="MSAPUID",e[e.ANID=3]="ANID",e[e.OrgIdCID=4]="OrgIdCID",e[e.OrgIdPUID=5]="OrgIdPUID",e[e.UserObjectId=6]="UserObjectId",e[e.Skype=7]="Skype",e[e.Yammer=8]="Yammer",e[e.EmailAddress=9]="EmailAddress",e[e.PhoneNumber=10]="PhoneNumber",e[e.SipAddress=11]="SipAddress",e[e.MUID=12]="MUID"})(t.UserIdType||(t.UserIdType={}))
	t.UserIdType
	var i=function(){function t(){this.ScrubType=e.datamodels.PIIScrubber.NotSet,this.Kind=e.datamodels.PIIKind.NotSet,this.RawContent=""}return t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){t.WriteStructBegin(null,n),this.ScrubType!=e.datamodels.PIIScrubber.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,1,null),t.WriteInt32(this.ScrubType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,1,null),this.Kind!=e.datamodels.PIIKind.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),t.WriteInt32(this.Kind),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),""!=this.RawContent?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteString(this.RawContent),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,3,null),t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}()
	t.PII=i
	var r=function(){function t(){this.Id=n.GetGuid(),this.Timestamp=n.GetTimeStamp(),this.Type="",this.EventType="",this.Extension=new Microsoft.Bond.Collections.Map,this.RecordType=e.datamodels.RecordType.NotSet,this.PIIExtensions=new Microsoft.Bond.Collections.Map}return t.prototype.AddOrReplacePII=function(t,n,i){var r=new e.datamodels.PII
	r.RawContent=n,r.Kind=i,r.ScrubType=e.datamodels.PIIScrubber.O365,this.PIIExtensions.AddOrReplace(t,r)},t.prototype.Write=function(e){this.WriteImpl(e,!1)},t.prototype.WriteImpl=function(t,n){if(t.WriteStructBegin(null,n),""!=this.Id?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,1,null),t.WriteString(this.Id),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,1,null),this.Timestamp.Equals("0")?t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,3,null):(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,3,null),t.WriteInt64(this.Timestamp),t.WriteFieldEnd()),""!=this.Type?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),t.WriteString(this.Type),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),""!=this.EventType?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,6,null),t.WriteString(this.EventType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,6,null),this.Extension.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,13,null),t.WriteMapContainerBegin(this.Extension.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRING)
	for(var i=0;i<this.Extension.GetBuffer().length;++i)t.WriteString(this.Extension.GetBuffer()[i].Key),t.WriteString(this.Extension.GetBuffer()[i].Value)
	t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,13,null)
	if(this.RecordType!=e.datamodels.RecordType.NotSet?(t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,24,null),t.WriteInt32(this.RecordType),t.WriteFieldEnd()):t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,24,null),this.PIIExtensions.Count()){t.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_MAP,30,null),t.WriteMapContainerBegin(this.PIIExtensions.Count(),Microsoft.Bond.BondDataType.BT_STRING,Microsoft.Bond.BondDataType.BT_STRUCT)
	for(var r=0;r<this.PIIExtensions.GetBuffer().length;++r)t.WriteString(this.PIIExtensions.GetBuffer()[r].Key),this.PIIExtensions.GetBuffer()[r].Value.WriteImpl(t,!1)
	t.WriteContainerEnd(),t.WriteFieldEnd()}else t.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_MAP,30,null)
	t.WriteStructEnd(n)},t.prototype.Read=function(e){this.ReadImpl(e,!1)},t.prototype.ReadImpl=function(e,t){},t}()
	t.Record=r
	var o=function(){function e(){this.Source="",this.DataPackageId="",this.Timestamp=new Microsoft.Bond.Int64("0"),this.Records=[]}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),""!=this.Source?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,2,null),e.WriteString(this.Source),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,2,null),""!=this.DataPackageId?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_STRING,5,null),e.WriteString(this.DataPackageId),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_STRING,5,null),this.Timestamp.Equals("0")?e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT64,6,null):(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT64,6,null),e.WriteInt64(this.Timestamp),e.WriteFieldEnd()),this.Records.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,8,null),e.WriteContainerBegin(this.Records.length,Microsoft.Bond.BondDataType.BT_STRUCT)
	for(var n=0;n<this.Records.length;++n)this.Records[n].WriteImpl(e,!1)
	e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,8,null)
	e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}()
	t.DataPackage=o
	var a=function(){function e(){this.DataPackages=[],this.RequestRetryCount=0}return e.prototype.Write=function(e){this.WriteImpl(e,!1)},e.prototype.WriteImpl=function(e,t){if(e.WriteStructBegin(null,t),this.DataPackages.length){e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_LIST,1,null),e.WriteContainerBegin(this.DataPackages.length,Microsoft.Bond.BondDataType.BT_STRUCT)
	for(var n=0;n<this.DataPackages.length;++n)this.DataPackages[n].WriteImpl(e,!1)
	e.WriteContainerEnd(),e.WriteFieldEnd()}else e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_LIST,1,null)
	0!=this.RequestRetryCount?(e.WriteFieldBegin(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteInt32(this.RequestRetryCount),e.WriteFieldEnd()):e.WriteFieldOmitted(Microsoft.Bond.BondDataType.BT_INT32,2,null),e.WriteStructEnd(t)},e.prototype.Read=function(e){this.ReadImpl(e,!1)},e.prototype.ReadImpl=function(e,t){},e}()
	t.ClientToCollectorRequest=a})(e.datamodels||(e.datamodels={}))})(e.telemetry||(e.telemetry={}))})(e.applications||(e.applications={}))}(microsoft||(microsoft={})),function(e){(function(e){(function(e){(function(t){(function(e){e[e.SENT=0]="SENT",e[e.SEND_FAILED=1]="SEND_FAILED"})(t.CallbackEventType||(t.CallbackEventType={}))
	var n=t.CallbackEventType;(function(e){e[e.DATARV_ERROR_OK=0]="DATARV_ERROR_OK",e[e.DATARV_ERROR_INVALID_EVENT=1]="DATARV_ERROR_INVALID_EVENT",e[e.DATARV_ERROR_INVALID_CONFIG=2]="DATARV_ERROR_INVALID_CONFIG",e[e.DATARV_ERROR_INVALID_DEPENDENCIES=3]="DATARV_ERROR_INVALID_DEPENDENCIES",e[e.DATARV_ERROR_INVALID_STATUS=4]="DATARV_ERROR_INVALID_STATUS",e[e.DATARV_ERROR_INVALID_ARG=5]="DATARV_ERROR_INVALID_ARG"})(t.DATARV_ERROR||(t.DATARV_ERROR={}))
	var i=t.DATARV_ERROR,r=function(){function e(e){this._errorCode=i.DATARV_ERROR_OK,this._errorCode=e}return e.prototype.ErrorCode=function(){return this._errorCode},e.prototype.toString=function(){switch(this._errorCode){case i.DATARV_ERROR_OK:return"DATARV_ERROR_OK"
	case i.DATARV_ERROR_INVALID_EVENT:return"Event is invalid. Either event.Id is empty, or event.Timestamp is empty, or event.EventType is empty."
	case i.DATARV_ERROR_INVALID_CONFIG:return"Invalid configuration. CollectorUrl is missing."
	case i.DATARV_ERROR_INVALID_DEPENDENCIES:return"DATARV_ERROR_INVALID_DEPENDENCIES"
	case i.DATARV_ERROR_INVALID_STATUS:return"Telemetry Manager is not initialized."
	case i.DATARV_ERROR_INVALID_ARG:return"TenantToken is null or empty, or events is null."
	default:return"Unknown error"}},e}()
	t.Exception=r
	var o=function(){}
	t.TelemetryConfig=o
	var a=function(){function e(){}return e.CreateTelemetryManager=function(){return new l},e}()
	t.TelemetryManagerFactory=a
	var s,c=function(){function e(){}return e.MaxPackageSizeInBytes=function(){return 3e6},e.TimeIntervalForNextSendInMS=function(){return 1e3},e}();(function(e){e[e.Created=0]="Created",e[e.Initialized=1]="Initialized",e[e.Started=2]="Started"})(s||(s={}))
	var l=function(){function t(){this._MaxPackageSizeInBytes=c.MaxPackageSizeInBytes(),this._listeners=[],this._status=s.Created,this._etag=null,this._testServerResponseHook=null,this._isPaused=!1}return t.prototype.Initialize=function(e){if(this._status!=s.Created)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	if(!e||!e.collectorUrl)throw new r(i.DATARV_ERROR_INVALID_CONFIG)
	this._config=e,this._Reset(),this._status=s.Initialized,this._Verbose("Initialize() done")},t.prototype.AddListener=function(e){if(this._status<s.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	this._Verbose(["AddListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""))
	for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return void this._Verbose("the listener has been added already, index: "+t)
	this._listeners.push(e),this._Verbose("AddListener() done, the new length: "+this._listeners.length)},t.prototype.RemoveListener=function(e){if(this._status<s.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	this._Verbose(["RemoveListener(), status: ",this._status," old length: ",this._listeners.length," func: ",e].join(""))
	for(var t=0;t<this._listeners.length;++t)if(this._listeners[t]==e)return 1==this._listeners.length?this._listeners=[]:t==this._listeners.length-1?this._listeners.pop():this._listeners[t]=this._listeners.pop(),void this._Verbose(["this listener has been found, index: ",t,"new length: ",this._listeners.length].join(""))
	this._Verbose("listener isn't been found, new length"+this._listeners.length)},t.prototype.Start=function(){if(this._status<s.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	this._Verbose(["Start(), status:",this._status,"tag:",t._tag].join(" ")),this._status>=s.Started&&this._Verbose("Start() already, ignore"),++t._tag,this._status=s.Started,this._Verbose(["Start() done, status: ",this._status,"tag: ",t._tag].join(""))},t.prototype.Stop=function(){if(this._status<s.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	this._Verbose("Stop(), status: "+this._status),this._status!=s.Initialized?(this._Reset(),this._status=s.Initialized,this._Verbose("Stop() done, status: "+this._status)):this._Verbose("Stop() already, ignore")},t.prototype.Pause=function(){this._isPaused=!0,this._CleanTimer()},t.prototype.Resume=function(){this._isPaused=!1,this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1)},t.prototype.Flush=function(e){this._eventsCache.IsEmpty()||this._WorkThread(e,!0)},t.prototype.SendAsync=function(e,n){if(this._status<s.Initialized)throw new r(i.DATARV_ERROR_INVALID_STATUS)
	if(this._Verbose(["SendAsync(), status:",this._status,"tenantToken:",e,"count:",n.length].join(" ")),this._status<s.Started)return this._Info("SendAsync(), not started, ignore, return false"),!1
	if(!e||!n)throw this._Error("SendAsync(), tenantToken or events is null or empty"),new r(i.DATARV_ERROR_INVALID_ARG)
	for(var o=0;o<n.length;++o)if(!n[o].Id||!t._eventTypeRegex.test(n[o].EventType)||n[o].Timestamp.Equals("0"))throw this._Error(["eventId:",n[o].Id,"eventType:",n[o].EventType,"timestamp high:",n[o].Timestamp.high,"timestamp low:",n[o].Timestamp.low].join("")),new r(i.DATARV_ERROR_INVALID_EVENT)
	return this._eventsCache.AddEvents(e,n),this._Verbose(["SendAsync(), currentTimer: ",this._timer,"eventsCacheIsEmpty",this._eventsCache.IsEmpty()].join(" ")),this._eventsCache.IsEmpty()||this._timer||this._ScheduleTimer(!1),this._Verbose("SendAsync() done"),!0},t.prototype._WorkThread=function(e,n){var i=this
	try{if(this._Verbose("_WorkThread, status: "+this._status),this._status<s.Started)return void this._Verbose("_WorkThread, status is not started, return")
	var r=this._eventsCache.DequeuEvents()
	if(null==r)return this._Verbose("_WorkThread, No events found, return"),void this._CleanTimer()
	var o=this._PackEvents(r.tenantToken,r.events)
	if(this._eventsCache.AddEvents(r.tenantToken,o.remainedEvents),null==o.buffer||0==o.buffer.length)return void(this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1)))
	if(this._testServerResponseHook){var a=this._testServerResponseHook()
	return void setTimeout(this._SendCallback(l,r.tenantToken,o.sendEvents,a,!1,null),100)}var c={type:"POST",url:this._config.collectorUrl,processData:!1,headers:{"content-type":"application/bond-compact-binary","client-id":"NO_AUTH","sdk-version":"ACT-Web-JS-"+clienttelemetry_build.version},complete:function(t){return i._SendCallback(l,r.tenantToken,o.sendEvents,t,n,e)}}
	sct.Utils.IsUint8ArrSupported()?(this._Verbose("Uint8Array is defined, send with binary format directly."),c.data=new Uint8Array(o.buffer)):(this._Verbose("Uint8Array is undefined, send with base64 encode."),c.data=Microsoft.Bond.Encoding.Base64.GetString(o.buffer),c.headers["content-encoding"]="base64"),r.tenantToken&&(c.headers["x-apikey"]=r.tenantToken)
	var l=t._tag
	this._lastActiveTime=(new Date).getTime(),sct.Utils.ajax(c,n),this._Verbose("_Workthread, send via jquery, tag: "+l)}catch(u){this._Error("_WorkThread, exception: "+u)}},t.prototype._PackEvents=function(t,n){this._Verbose("_PackageEvents, total Count: "+n.length)
	var i,r=new e.datamodels.ClientToCollectorRequest,o=new e.datamodels.DataPackage
	o.Source="JS_default_source",o.DataPackageId=e.datamodels.utils.GetGuid(),o.Timestamp=e.datamodels.utils.GetTimeStamp()
	var a=n
	for(n=[];o.Records=[],o.Records.push.apply(o.Records,a),r.DataPackages=[],r.DataPackages.push(o),i=this._Serialize(r),this._Verbose(["_PackageEvents, sendEvents.length:",a.length,"buffer.length:",i.length,"MaxPackageSize:",this._MaxPackageSizeInBytes].join("")),!(i.length<this._MaxPackageSizeInBytes);){if(1==a.length){a=[],i=null
	break}var s=a.splice(0,Math.floor(a.length/2))
	this._Verbose("_PackageEvents, too large, package again"),n.push.apply(n,a),a=s}return this._Verbose(["_PakcageEvents done, sendEventsCount:",a.length,"buffer.length:",null==i?0:i.length,"remained events:",n.length].join("")),{buffer:i,sendEvents:a,remainedEvents:n}},t.prototype._Serialize=function(e){var t=new Microsoft.Bond.IO.MemoryStream,n=new Microsoft.Bond.CompactBinaryProtocolWriter(t)
	return e.Write(n),t.GetBuffer()},t.prototype._SendCallback=function(e,i,r,o,a,c){if(this._Verbose(["_SendCallback","tag:",e,"current tag:",t._tag,"tenantToken:",i,"events count:",r.length,"jqXHR:",o].join("")),c&&c(o?o.status:0,i,r),!a){var l=null!=o&&o.status>=200&&o.status<300
	if(this._status<s.Started||e<t._tag)this._Verbose("_SendCallback, is not started, or tag is not the same, return")
	else{if(!l&&(!o||o.status&&400!=o.status))return this._Verbose("retry statusCode: "+(o?o.status:0)),this._eventsCache.AddEvents(i,r),void this._ScheduleTimer(!0)
	for(var u=0;u<this._listeners.length;++u)this._listeners[u](l?n.SENT:n.SEND_FAILED,o?o.status:0,i,r)
	this._eventsCache.IsEmpty()?(this._Verbose("eventsCache is empty, stop schedule"),this._CleanTimer()):(this._Verbose("eventsCache is not empty, schedule for next run"),this._ScheduleTimer(!1))}}},t.prototype._CleanTimer=function(){this._Verbose("_CleanTimer(), timer: "+this._timer),this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._ScheduleTimer=function(e){var t=this
	if(!this._isPaused)if(this._Verbose("_ScheduleTimer: isRetry: "+e),this._CleanTimer(),e){this._Verbose("_ScheduleTimer, current factor: "+this._rescheduleFactor)
	n=Math.floor(5*this._rescheduleFactor*(1+Math.random()))
	this._timer=setTimeout((function(){return t._WorkThread(null,!1)}),1e3*n),this._Verbose("_ScheduleTimer, next try (s): "+n),this._rescheduleFactor<<=1,this._rescheduleFactor>64&&(this._rescheduleFactor=1)}else{var n=0,i=(new Date).getTime()-this._lastActiveTime
	n=i>c.TimeIntervalForNextSendInMS()?0:c.TimeIntervalForNextSendInMS()-i,this._timer=setTimeout((function(){return t._WorkThread(null,!1)}),n),this._Verbose("_ScheduleTimer, next try: "+n),this._rescheduleFactor=1}},t.prototype._Verbose=function(e){this._config.log&&this._config.log.Verbose("[TelemetryManagerImpl]: "+e)},t.prototype._Info=function(e){this._config.log&&this._config.log.Info("[TelemetryManagerImpl]: "+e)},t.prototype._Error=function(e){this._config.log&&this._config.log.Error("[TelemetryManagerImpl]: "+e)},t.prototype._Reset=function(){this._Verbose("Reset()"),this._CleanTimer(),this._lastActiveTime=0,this._rescheduleFactor=1,this._sendingEvents=[],this._eventsCache=new u},t.prototype.__GetListenerArray=function(){return this._listeners},t.prototype.__GetTotalEventsCount=function(){return this._eventsCache.GetTotalEventsCount()},t.prototype.__IsScheduled=function(){return null!=this._timer},t.prototype.__ChageMaxPackageSizeInKB=function(e){this._MaxPackageSizeInBytes=1024*e},t.prototype.__SetTestServerResponseHook=function(e){this._testServerResponseHook=e},t._eventTypeRegex=/^[a-zA-Z0-9]([a-zA-Z0-9]|_){2,98}[a-zA-Z0-9]$/,t._tag=0,t}(),u=function(){function e(){this._events={},this._tokens=[]}return e.prototype.AddEvents=function(e,t){t.length&&(this._events[e]||(this._events[e]=[],this._tokens.push(e)),this._events[e].push.apply(this._events[e],t))},e.prototype.IsEmpty=function(){return 0==this._tokens.length},e.prototype.DequeuEvents=function(){if(0==this._tokens.length)return null
	var e=this._tokens.shift(),t=this._events[e]
	return delete this._events[e],{tenantToken:e,events:t}},e.prototype.GetTotalEventsCount=function(){var e=0
	for(var t in this._events)e+=this._events[t].length
	return e},e}()})(e._sender||(e._sender={}))})(e.telemetry||(e.telemetry={}))})(e.applications||(e.applications={}))}(microsoft||(microsoft={})),function(e){(function(t){(function(t){var n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),i=function(){this.collectorUrl=null,this.enableAutoUserSession=!1,this.browserOverrides=new r}
	t.LogConfiguration=i
	var r=function(){this.onSaveData=null,this.onGetData=null}
	t.LogConfigurationBrowserOverrides=r
	var o=function(){function e(){this.value=null,this.pii=null}return e._isPii=function(e){return null!=e&&e!==t.datamodels.PIIKind.NotSet&&!isNaN(e)&&void 0!==t.datamodels.PIIKind[e]},e}(),a=function(){function e(){this.name=null,this.timestamp=null,this.properties={},this.eventType=null}return e.prototype.setProperty=function(n,i,r){if(!n||!e._propertyNameRegex.test(n))throw new c(s.INVALID_PROPERTY_NAME)
	this.properties[n]=r?{value:i,pii:r!=t.datamodels.PIIKind.NotSet?r:null}:{value:i,pii:null}},e._propertyNameRegex=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,e}()
	t.EventProperties=a,function(e){e[e.INVALID_TENANT_TOKEN=1]="INVALID_TENANT_TOKEN",e[e.MISSING_EVENT_PROPERTIES_NAME=2]="MISSING_EVENT_PROPERTIES_NAME",e[e.INVALID_PROPERTY_NAME=3]="INVALID_PROPERTY_NAME",e[e.MISSING_FAILURE_SIGNATURE=5]="MISSING_FAILURE_SIGNATURE",e[e.MISSING_FAILURE_DETAIL=6]="MISSING_FAILURE_DETAIL",e[e.MISSING_PAGEVIEW_ID=7]="MISSING_PAGEVIEW_ID",e[e.MISSING_PAGEVIEW_NAME=8]="MISSING_PAGEVIEW_NAME",e[e.INVALID_SESSION_STATE=9]="INVALID_SESSION_STATE",e[e.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET=10]="INVALID_CONFIGURATION_USE_CUSTOM_GET_SET"}(t.TelemetryError||(t.TelemetryError={}))
	var s=t.TelemetryError,c=function(){function e(e){this.errorCode=null,this.errorCode=e}return e.prototype.ErrorCode=function(){return this.errorCode},e.prototype.toString=function(){switch(this.errorCode){case s.INVALID_TENANT_TOKEN:return"Invalid tenant token"
	case s.MISSING_EVENT_PROPERTIES_NAME:return"Eventproperties.name can not be null or empty"
	case s.INVALID_PROPERTY_NAME:return"Invalid Key. Key does not conform to regular expression ^[a-zA-Z0-9](([a-zA-Z0-9|_|.]){0,98}[a-zA-Z0-9])?$"
	case s.MISSING_FAILURE_SIGNATURE:return"Failure signature can't be null or empty."
	case s.MISSING_FAILURE_DETAIL:return"Failure detail can't be null or empty."
	case s.MISSING_PAGEVIEW_ID:return"Pageview id can't be null or empty."
	case s.MISSING_PAGEVIEW_NAME:return"Pageview name can't be null or empty."
	case s.INVALID_SESSION_STATE:return"Session state has to be a value from the SessionState enum."
	case s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET:return"Invalid configuration provided during initialization. Both onGetConfigData and onSaveConfigData must be provided together.  These are manditory when running in a non-brower enviornment"
	default:return"Unknown error"}},e}()
	t.Exception=c
	var l=function(){function n(e){this.contextMap={},this.piiKind=t.datamodels.PIIKind.NotSet,this._allowDeviceInfoFields=!1,this._allowDeviceInfoFields=e}return n.prototype.setAppId=function(e){e&&(this.contextMap["AppInfo.Id"]=e)},n.prototype.setAppVersion=function(e){e&&(this.contextMap["AppInfo.Version"]=e)},n.prototype.setAppLanguage=function(e){e&&(this.contextMap["AppInfo.Language"]=e)},n.prototype.setDeviceId=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.Id"]=e,u.checkAndUpdateDeviceId(e))},n.prototype.setDeviceOsName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsName"]=e)},n.prototype.setDeviceOsVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.OsVersion"]=e)},n.prototype.setDeviceBrowserName=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserName"]=e)},n.prototype.setDeviceBrowserVersion=function(e){e&&this._allowDeviceInfoFields&&(this.contextMap["DeviceInfo.BrowserVersion"]=e)},n.prototype.setUserId=function(t,n,i){if(t&&(this.contextMap["UserInfo.Id"]=t),i)this.contextMap["UserInfo.IdType"]=i
	else{var r
	switch(n){case e.applications.telemetry.datamodels.PIIKind.SipAddress:r=e.applications.telemetry.datamodels.UserIdType.SipAddress
	break
	case e.applications.telemetry.datamodels.PIIKind.PhoneNumber:r=e.applications.telemetry.datamodels.UserIdType.PhoneNumber
	break
	case e.applications.telemetry.datamodels.PIIKind.SmtpAddress:r=e.applications.telemetry.datamodels.UserIdType.EmailAddress
	break
	default:r=e.applications.telemetry.datamodels.UserIdType.Unknown}this.contextMap["UserInfo.IdType"]=r}if(n)o._isPii(n)&&(this.piiKind=n)
	else{var a
	switch(i){case e.applications.telemetry.datamodels.UserIdType.Skype:a=e.applications.telemetry.datamodels.PIIKind.Identity
	break
	case e.applications.telemetry.datamodels.UserIdType.EmailAddress:a=e.applications.telemetry.datamodels.PIIKind.SmtpAddress
	break
	case e.applications.telemetry.datamodels.UserIdType.PhoneNumber:a=e.applications.telemetry.datamodels.PIIKind.PhoneNumber
	break
	case e.applications.telemetry.datamodels.UserIdType.SipAddress:a=e.applications.telemetry.datamodels.PIIKind.SipAddress
	break
	default:a=e.applications.telemetry.datamodels.PIIKind.NotSet}o._isPii(a)&&(this.piiKind=a)}},n.prototype.setUserMsaId=function(e){e&&(this.contextMap["UserInfo.MsaId"]=e)},n.prototype.setUserANID=function(e){e&&(this.contextMap["UserInfo.ANID"]=e)},n.prototype.setUserAdvertisingId=function(e){e&&(this.contextMap["UserInfo.AdvertisingId"]=e)},n.prototype.setUserTimeZone=function(e){e&&(this.contextMap["UserInfo.TimeZone"]=e)},n.prototype.setUserLanguage=function(e){e&&(this.contextMap["UserInfo.Language"]=e)},n}()
	t.SemanticContext=l
	var u=function(){function e(){}return e.initialize=function(n){this._overrides=n
	var i=e._getAppLanguage()
	i&&e.semanticContext.setAppLanguage(i)
	var r=e._getUserLanguage()
	r&&e.semanticContext.setUserLanguage(r)
	var o=(new Date).getTimezoneOffset(),a=o%60,s=(o-a)/60,c="+"
	s>0&&(c="-"),s=Math.abs(s),a=Math.abs(a),e.semanticContext.setUserTimeZone(c+(s<10?"0"+s:s.toString())+":"+(a<10?"0"+a:a.toString())),e._getUserAgent()&&(e.semanticContext.setDeviceBrowserName(e._getBrowserName()),e.semanticContext.setDeviceBrowserVersion(e._getBrowserVersion()),e.semanticContext.setDeviceOsName(e._getOsName()),e.semanticContext.setDeviceOsVersion(e._getOsVersion()))
	var l=e._getData(e.DEVICE_ID_COOKIE)
	l&&""!=l||(l=t.datamodels.utils.GetGuid()),e.semanticContext.setDeviceId(l)},e.checkAndUpdateDeviceId=function(t){e._getData(e.DEVICE_ID_COOKIE)!=t&&(e._saveData(e.DEVICE_ID_COOKIE,t),e._saveData(e.FIRST_LAUNCH_TIME_COOKIE,(new Date).getTime().toString()))
	var n=e._getData(e.FIRST_LAUNCH_TIME_COOKIE)
	e.firstLaunchTime=parseInt(n)},e._saveData=function(e,t){if(this._overrides.onSaveData)this._overrides.onSaveData(e,t)
	else if("undefined"!=typeof document&&document.cookie){document.cookie=e+"="+t+"; expires=Mon, 31 Dec 2029 23:59:59 GMT"}},e._getData=function(e){if(this._overrides.onGetData)return this._overrides.onGetData(e)||""
	if("undefined"!=typeof document&&document.cookie)for(var t=e+"=",n=document.cookie.split(";"),i=0;i<n.length;i++){for(var r=n[i],o=0;" "==r.charAt(o);)o++
	if(0==(r=r.substring(o)).indexOf(t))return r.substring(t.length,r.length)}return""},e._getUserAgent=function(){return"undefined"!=typeof navigator&&navigator.userAgent||""},e._getAppLanguage=function(){return"undefined"!=typeof document&&document.documentElement?document.documentElement.lang:null},e._getUserLanguage=function(){return"undefined"!=typeof navigator?navigator.userLanguage||navigator.language:null},e._userAgentContainsString=function(t){return e._getUserAgent().indexOf(t)>-1},e._isIe=function(){return e._userAgentContainsString("Trident")},e._isEdge=function(){return e._userAgentContainsString(e.BROWSERS.EDGE)},e._isOpera=function(){return e._userAgentContainsString("OPR/")},e._getBrowserName=function(){return e._isOpera()?e.BROWSERS.UNKNOWN:e._userAgentContainsString(e.BROWSERS.PHANTOMJS)?e.BROWSERS.PHANTOMJS:e._isEdge()?e.BROWSERS.EDGE:e._userAgentContainsString(e.BROWSERS.ELECTRON)?e.BROWSERS.ELECTRON:e._userAgentContainsString(e.BROWSERS.CHROME)?e.BROWSERS.CHROME:e._userAgentContainsString(e.BROWSERS.FIREFOX)?e.BROWSERS.FIREFOX:e._userAgentContainsString(e.BROWSERS.SAFARI)?e.BROWSERS.SAFARI:e._userAgentContainsString(e.BROWSERS.SKYPE_SHELL)?e.BROWSERS.SKYPE_SHELL:e._isIe()?e.BROWSERS.MSIE:e.BROWSERS.UNKNOWN},e._getBrowserVersion=function(){return e._isIe()?function(){var t,n=e._getUserAgent(),i=n.match(new RegExp(e.BROWSERS.MSIE+" "+e.REGEX_VERSION))
	if(i)return i[1]
	if(t=n.match(new RegExp("rv:"+e.REGEX_VERSION)))return t[1]}():function(t){var n
	t===e.BROWSERS.SAFARI&&(t="Version")
	if(n=e._getUserAgent().match(new RegExp(t+"/"+e.REGEX_VERSION)))return n[1]
	return e.UNKNOWN_VERSION}(e._getBrowserName())},e._getOsName=function(){return e._getUserAgent().match(/windows\sphone\s\d+\.\d+/i)?e.OPERATING_SYSTEMS.WINDOWS_PHONE:e._getUserAgent().match(/ arm;/i)?e.OPERATING_SYSTEMS.WINDOWS_RT:e._getUserAgent().match(/(iPad|iPhone|iPod)(?=.*like Mac OS X)/i)?e.OPERATING_SYSTEMS.IOS:e._getUserAgent().match(/android/i)?e.OPERATING_SYSTEMS.ANDROID:e._getUserAgent().match(/(linux|joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)/i)?e.OPERATING_SYSTEMS.LINUX:e._getUserAgent().match(/(macintosh|mac os x)/i)?e.OPERATING_SYSTEMS.MACOSX:e._getUserAgent().match(/(windows|win32)/i)?e.OPERATING_SYSTEMS.WINDOWS:e.OPERATING_SYSTEMS.UNKNOWN},e._getOsVersion=function(){return e._getOsName()===e.OPERATING_SYSTEMS.WINDOWS?function(){var t=e._getUserAgent().match(new RegExp("Windows NT "+e.REGEX_VERSION))
	if(t&&e.VERSION_MAPPINGS[t[1]])return e.VERSION_MAPPINGS[t[1]]
	return e.UNKNOWN_VERSION}():e._getOsName()===e.OPERATING_SYSTEMS.MACOSX?function(){var t=e._getUserAgent().match(new RegExp(e.OPERATING_SYSTEMS.MACOSX+" "+e.REGEX_VERSION_MAC))
	if(t){var n=t[1].replace(/_/g,".")
	if(n){var i=function(e){if(e.indexOf(".")>-1)return"."
	if(e.indexOf("_")>-1)return"_"
	return null}(n)
	return i?n.split(i)[0]:n}}return e.UNKNOWN_VERSION}():e.UNKNOWN_VERSION},e.semanticContext=new l(!0),e.firstLaunchTime=-1,e.BROWSERS={MSIE:"MSIE",CHROME:"Chrome",FIREFOX:"Firefox",SAFARI:"Safari",EDGE:"Edge",ELECTRON:"Electron",SKYPE_SHELL:"SkypeShell",PHANTOMJS:"PhantomJS",UNKNOWN:"Unknown"},e.OPERATING_SYSTEMS={WINDOWS:"Windows",MACOSX:"Mac OS X",WINDOWS_PHONE:"Windows Phone",WINDOWS_RT:"Windows RT",IOS:"iOS",ANDROID:"Android",LINUX:"Linux",UNKNOWN:"Unknown"},e.VERSION_MAPPINGS={5.1:"XP","6.0":"Vista",6.1:"7",6.2:"8",6.3:"8.1","10.0":"10"},e.REGEX_VERSION="([\\d,.]+)",e.REGEX_VERSION_MAC="([\\d,_,.]+)",e.UNKNOWN_VERSION="Unknown",e.DEVICE_ID_COOKIE="MicrosoftApplicationsTelemetryDeviceId",e.FIRST_LAUNCH_TIME_COOKIE="MicrosoftApplicationsTelemetryFirstLaunchTime",e}();(function(e){e[e.STARTED=0]="STARTED",e[e.ENDED=1]="ENDED"})(t.SessionState||(t.SessionState={}))
	var d=t.SessionState,p=function(){function e(){}return e.initialize=function(t,i){if(!e._initialized){if(!t)throw new c(s.INVALID_TENANT_TOKEN)
	if(e._defaultToken=t,e._tmConfig.collectorUrl="https://browser.pipe.aria.microsoft.com/Collector/3.0/",e._configuration=i,!("undefined"!=typeof window||i&&i.browserOverrides&&i.browserOverrides.onGetData))throw new c(s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET)
	var o=new r
	if(i&&(i.collectorUrl&&(e._tmConfig.collectorUrl=i.collectorUrl),i.browserOverrides)){if(i.browserOverrides.onGetData?!i.browserOverrides.onSaveData:i.browserOverrides.onSaveData)throw new c(s.INVALID_CONFIGURATION_USE_CUSTOM_GET_SET)
	o.onGetData=i.browserOverrides.onGetData,o.onSaveData=i.browserOverrides.onSaveData}n.Initialize(e._tmConfig),n.Start(),u.initialize(o),e._initialized=!0,"undefined"!=typeof window&&window.addEventListener&&i&&i.enableAutoUserSession&&(e._logger=new f,e._logger.logSession(d.STARTED),window.addEventListener("beforeunload",e._teardown))}},e.pauseTransmission=function(){n.Pause()},e.resumeTransmission=function(){n.Resume()},e.flush=function(e){n.Flush(e)},e.addCallbackListener=function(t){e._initialized&&n.AddListener(t)},e.setContext=function(t,n,i){e._contextProperties.setProperty(t,n,i)},e.isInitialized=function(){return e._initialized},e.getDefaultToken=function(){return e._defaultToken},e.getSemanticContext=function(){return e._semanticContext},e._getInitIdForToken=function(n){return e._initIdMap[n]||(e._initIdMap[n]=t.datamodels.utils.GetGuid()),e._initIdMap[n]},e._getSequenceForToken=function(t){return e._sequenceMap[t]||(e._sequenceMap[t]=0),e._sequenceMap[t]++,e._sequenceMap[t]},e._teardown=function(){e._logger&&e._logger.logSession(d.ENDED),e.flush()},e.__backToUninitialized=function(){e._tmConfig=new t._sender.TelemetryConfig,e._semanticContext=new l(!0),e._contextProperties=new a,e._configuration=null,n=t._sender.TelemetryManagerFactory.CreateTelemetryManager(),e._initialized=!1,e._initIdMap={},e._sequenceMap={}},e._initialized=!1,e._defaultToken=null,e._tmConfig=new t._sender.TelemetryConfig,e._logger=null,e._initIdMap={},e._sequenceMap={},e._configuration=null,e._contextProperties=new a,e._semanticContext=new l(!0),e}()
	t.LogManager=p
	var f=function(){function e(e){this._initId=null,this._tenantToken=null,this._contextProperties=new a,this._semanticContext=new l(!1),this._sessionStartTime=0,this._sessionId=null,this._tenantToken=e||p.getDefaultToken(),this._initId=p._getInitIdForToken(this._tenantToken)}return e.prototype.logEvent=function(e){if(!e.name)throw new c(s.MISSING_EVENT_PROPERTIES_NAME)
	var t=this._createEventRecord(e.name,e.eventType)
	this._addPropertiesAndSendEvent(t,e)},e.prototype.logFailure=function(e,t,n,i,r){if(!e)throw new c(s.MISSING_FAILURE_SIGNATURE)
	if(!t)throw new c(s.MISSING_FAILURE_DETAIL)
	var o=this._createEventRecord("failure","failure")
	o.Extension.Add("Failure.Signature",e),o.Extension.Add("Failure.Detail",t),n&&o.Extension.Add("Failure.Category",n),i&&o.Extension.Add("Failure.Id",i),this._addPropertiesAndSendEvent(o,r)},e.prototype.logPageView=function(e,t,n,i,r,o){if(!e)throw new c(s.MISSING_PAGEVIEW_ID)
	if(!t)throw new c(s.MISSING_PAGEVIEW_NAME)
	var a=this._createEventRecord("pageview","pageview")
	a.Extension.Add("PageView.Id",e),a.Extension.Add("PageView.Name",t),n&&a.Extension.Add("PageView.Category",n),i&&a.Extension.Add("PageView.Uri",i),r&&a.Extension.Add("PageView.ReferrerUri",r),this._addPropertiesAndSendEvent(a,o)},e.prototype.logSession=function(e,n){if(e!==d.STARTED&&e!==d.ENDED)throw new c(s.INVALID_SESSION_STATE)
	var i=this._createEventRecord("session","session")
	if(e===d.STARTED){if(this._sessionStartTime>0)return
	this._sessionStartTime=(new Date).getTime(),this._sessionId=t.datamodels.utils.GetGuid(),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Started")}else if(e===d.ENDED){if(0==this._sessionStartTime)return
	var r=Math.floor(((new Date).getTime()-this._sessionStartTime)/1e3)
	i.Extension.Add("Session.Duration",r.toString()),i.Extension.Add("Session.DurationBucket",this._getSessionDurationFromTime(r)),i.Extension.Add("Session.Id",this._sessionId),i.Extension.Add("Session.State","Ended"),this._sessionId=null,this._sessionStartTime=0}i.Extension.Add("Session.FirstLaunchTime",this._getISOString(new Date(u.firstLaunchTime))),this._addPropertiesAndSendEvent(i,n)},e.prototype.getSessionId=function(){return this._sessionId},e.prototype.setContext=function(e,t,n){this._contextProperties.setProperty(e,t,n)},e.prototype.getSemanticContext=function(){return this._semanticContext},e.prototype._getSessionDurationFromTime=function(e){return e<0?"Undefined":e<=3?"UpTo3Sec":e<=10?"UpTo10Sec":e<=30?"UpTo30Sec":e<=60?"UpTo60Sec":e<=180?"UpTo3Min":e<=600?"UpTo10Min":e<=1800?"UpTo30Min":"Above30Min"},e.prototype._createEventRecord=function(e,n){var i=new t.datamodels.Record
	n||(n="custom"),i.EventType=e.toLowerCase(),i.Type=n.toLowerCase(),i.Extension.Add("EventInfo.Source","JS_default_source"),i.Extension.Add("EventInfo.InitId",this._initId),i.Extension.Add("EventInfo.Sequence",p._getSequenceForToken(this._tenantToken).toString()),i.Extension.Add("EventInfo.Name",e.toLowerCase())
	var r=new Date
	return i.Timestamp=t.datamodels.utils.GetTimeStampWithValue(r.getTime()),i.Extension.Add("EventInfo.Time",this._getISOString(r)),i.Extension.Add("EventInfo.SdkVersion","ACT-Web-JS-"+clienttelemetry_build.version),i},e.prototype._getISOString=function(e){function t(e){return e<10?"0"+e:e.toString()}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+(((n=e.getUTCMilliseconds())<10?"00"+n:n<100?"0"+n:n.toString())+"Z")
	var n},e.prototype._addCustomPropertiesToEvent=function(e,t){this._addSemanticContext(e,u.semanticContext),this._addSemanticContext(e,p._semanticContext),this._addSemanticContext(e,this._semanticContext),this._sessionId&&e.Extension.Add("Session.Id",this._sessionId),this._addEventPropertiesToEvent(e,p._contextProperties),this._addEventPropertiesToEvent(e,this._contextProperties),this._addEventPropertiesToEvent(e,t)},e.prototype._addSemanticContext=function(e,n){if(n&&n.contextMap){var i=n.contextMap
	for(var r in n.contextMap)"UserInfo.Id"==r&&n.piiKind!=t.datamodels.PIIKind.NotSet?e.AddOrReplacePII(r,i[r],n.piiKind):e.Extension.AddOrReplace(r,i[r])}},e.prototype._addEventPropertiesToEvent=function(e,n){if(n){n.timestamp&&n.timestamp>=new Date("1/1/2000").getTime()&&(e.Timestamp=t.datamodels.utils.GetTimeStampWithValue(n.timestamp),e.Extension.AddOrReplace("EventInfo.Time",this._getISOString(new Date(n.timestamp)))),n.name&&(e.EventType=n.name.toLowerCase(),e.Extension.AddOrReplace("EventInfo.Name",n.name.toLowerCase()))
	var i=n.properties
	if(i)for(var r in i)r&&(i[r].value||!1===i[r].value||0==i[r].value||""==i[r].value)&&(o._isPii(i[r].pii)?(e.AddOrReplacePII(r,i[r].value.toString(),i[r].pii),e.Extension.Remove(r)):(e.Extension.AddOrReplace(r,i[r].value.toString()),e.PIIExtensions.Remove(r)))}},e.prototype._addPropertiesAndSendEvent=function(e,t){this._addCustomPropertiesToEvent(e,t),p.isInitialized()&&(this._sanitizeName(e),n.SendAsync(this._tenantToken,[e]))},e.prototype._sanitizeName=function(e){var t=e.EventType.replace(/\./g,"_")
	e.EventType=t,e.Extension.AddOrReplace("EventInfo.Name",t)},e}()
	t.Logger=f})(t.telemetry||(t.telemetry={}))})(e.applications||(e.applications={}))}(microsoft||(microsoft={})),define("microsoft-aria",["microsoft-aria/lib/aria"],(function(e){return e})),define("microsoft-aria/lib/aria",(function(){})),define("telemetry/manager/telemetryManager",["require","microsoft-aria","usertiming","lodash-compat","experience/settings"],(function(e){e("microsoft-aria")
	var t=e("usertiming"),n=e("lodash-compat"),i=e("experience/settings"),r=window
	function o(){var e,o={},a={},s={},c={},l=!0,u=this
	function d(e){if("string"!=typeof e)throw"Performance telemetry mark name must be a string"
	return{start:e+"_start",end:e+"_end",measurement:e+"_ttc",context:e+"_context"}}function p(e){t.clearMarks(e.start),t.clearMarks(e.end),t.clearMeasures(e.measurement)}function f(e){return t.getEntriesByName(e).length>0}function m(e){return"string"==typeof e||"number"==typeof e||"boolean"==typeof e}function h(e){return e+""}u.enabled=function(e){l=e},u.setCommonProperty=function(e,t,n){if("string"!=typeof e)throw new Error("Property name should be string")
	if(void 0!==n&&"number"!=typeof n)throw new Error("PIIType should be number")
	if(!m(t)&&"function"!=typeof t)throw new Error("Value should be string, number, boolean or function.")
	var i=void 0===n?r.skypeTelemetryManager.PIIType.NotSet:n
	o[e]=[t,i]},u.setSkypeUserId=function(e){u.setCommonProperty("user_id",e,r.skypeTelemetryManager.PIIType.Identity),u.setCommonProperty("Skype_InitiatingUser_Username",e)},u.sendEvent=function(e,t,n){if(l){if("string"!=typeof e)throw new Error("Tenant ID should be string")
	if("string"!=typeof t)throw new Error("Event name should be string")
	u._getLogger(e)
	var i=new microsoft.applications.telemetry.EventProperties
	i.name=t,function(e,t){Object.keys(t).forEach((function(n){var i=t[n]
	if(Array.isArray(i)){if(!m(i[0]))throw new Error("Value should be string, number or boolean.")
	if("number"!=typeof i[1])throw new Error("PIIType should be number")
	e.setProperty(n,h(i[0]),i[1])}else m(i)&&e.setProperty(n,h(i),r.skypeTelemetryManager.PIIType.NotSet)}))}(i,n),function(e){Object.keys(o).forEach((function(t){var n=o[t],i="function"==typeof n[0]?n[0]():n[0]
	e.setProperty(t,h(i),n[1])}))}(i),s[e].logEvent(i)}},u.flush=function(){microsoft.applications.telemetry.LogManager.flush()},u.setAppProperties=function(t){e=t},u.traceStart=function(e,n){var i=d(e);(f(i.start)||f(i.end))&&p(i),t.mark(i.start),a[i.context]=n},u.traceEnd=function(e,i){var r=d(e)
	f(r.end)&&(t.clearMarks(r.end),t.clearMeasures(r.measurement)),f(r.start)&&(t.mark(r.end),t.measure(r.measurement,r.start,r.end),a[r.context]=a[r.context]||{},n.merge(a[r.context],i))},u.traceDump=function(e){var n=d(e),i={duration:void 0,startTime:void 0}
	if(f(n.start)&&!f(n.end)&&u.traceEnd(e),f(n.measurement)){var r=t.getEntriesByName(n.measurement)[0].duration,o=t.now()-t.getEntriesByName(n.end)[0].startTime+r
	r>1&&o<604800&&(i.duration=Math.round(r),i.startTime=Math.round(Date.now()-o),i.context=a[n.context])}return p(n),a[n.context]=void 0,i},u._getLogger=function(t){return s[t]||(microsoft.applications.telemetry.LogManager.initialize(t),s[t]=new microsoft.applications.telemetry.Logger(t),c[t]=s[t].getSemanticContext(),c[t].setAppVersion(e),s[t]._semanticContext.setAppLanguage(i.applicationLanguage)),s[t]},u._getEventProperties=function(){return new microsoft.applications.telemetry.EventProperties}}r.skypeTelemetryManager||(r.skypeTelemetryManager={}),r.skypeTelemetryManager.PIIType={NotSet:0,DistinguishedName:1,GenericData:2,IPV4Address:3,IPv6Address:4,MailSubject:5,PhoneNumber:6,QueryString:7,SipAddress:8,SmtpAddress:9,Identity:10,Uri:11,Fqdn:12,IPV4AddressLegacy:13},r.skypeTelemetryManager.create=function(){return new o}})),define("ui/session/localSession",["require","exports","module","swx-utils-common","swx-utils-common"],(function(e,t){var n,i=e("swx-utils-common").guid,r=e("swx-utils-common").sessionStorage,o={},a=i.create(),s="swx-sessionid"
	t.getSessionId=function(){return n||((n=r.get(s))||(n=i.create(),r.set(s,n)),n)},t.getTabSessionId=function(){return a},t.setTelemetrySessionValue=function(e,t){if(!t)throw new Error("You are trying to set session parameter with a null value. Key:"+e)
	o[e]=t},t.getTelemetrySessionKeyValuePairs=function(){var e={}
	for(var t in o)o.hasOwnProperty(t)&&(e[t]=o[t])
	return e}})),define("ui/telemetry/telemetryClient",["require","exports","module","telemetry/manager/telemetryManager","experience/settings","swx-browser-globals","ui/session/localSession","swx-browser-detect","swx-constants/lib/common","swx-service-locator-instance"],(function(e,t){e("telemetry/manager/telemetryManager")
	var n,i=e("experience/settings"),r=e("swx-browser-globals"),o=e("ui/session/localSession"),a=e("swx-browser-detect").default,s=e("swx-constants/lib/common").default,c=e("swx-service-locator-instance").default
	function l(e){var t,n=0,r=[]
	i.initParams&&i.initParams.correlationIds&&((t=function(e){return i.telemetry.upnCorrelationIdEnabled?-1:e.indexOf("upn")}(r=Object.keys(i.initParams.correlationIds)))>-1&&r.splice(t,1),r.forEach((function(t){n++
	var r=i.initParams.correlationIds[t]
	r&&""!==r&&r.length<=128&&n<=10&&e.setCommonProperty("cid_"+t,r)})))}function u(e,t,n){n&&e.setCommonProperty(t,n)}function d(e){e.setAppProperties(i.version),function(e){u(e,"session_id",o.getSessionId()),u(e,"tab_session_id",o.getTabSessionId())}(e),function(e){var t=a.getBrowserInfo()
	e.setCommonProperty("user_agent_name",t.browserName),e.setCommonProperty("user_agent_version",t.browserMajorVersion)}(e),function(e){var t=a.getSystemInfo()
	e.setCommonProperty("user_agent_OS",t.osName),e.setCommonProperty("user_agent_OS_version",t.osVersion),e.setCommonProperty("device_type",t.deviceType)}(e),function(e){var t=a.getScreenInfo()
	e.setCommonProperty("screen_width",t.width),e.setCommonProperty("screen_height",t.height)}(e),l(e),function(e){i.initParams&&(u(e,"environment_id",i.initParams.environment),u(e,"api_key",i.initParams.apiKey),u(e,"locale",i.initParams.locale)),e.setCommonProperty("ui_version",i.uiVersion),e.setCommonProperty("version",i.version),e.setCommonProperty("property",i.biAppName),e.setCommonProperty("Client_Name",i.biClientName)}(e),function(e){i.eTag&&e.setCommonProperty("etag",i.eTag),i.configIds&&i.configIds.length>0&&e.setCommonProperty("cfg_ids",i.configIds+"")}(e),function(e){var t
	if(i.telemetry.selectedTargets){t=r.getWindow().location.hostname
	for(var n=0;n<i.telemetry.selectedTargets.length;n++)if(new RegExp(i.telemetry.selectedTargets[n]).test(t)){e.setCommonProperty("selected_target",!0)
	break}}}(e),function(e){e.setCommonProperty("browser_notifications_enabled",(function(){var e=r.getWindow().Notification
	return!(!e||"granted"!==e.permission)}))}(e),function(e){if(c.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.TELEMETRY_CAPTURE_SOURCE_ENABLED)){var t=a.getBrowserInfo().getUrlParams()
	t&&t.source&&t.source.length<=20&&t.source.match(/^[a-z0-9]+$/i)&&e.setCommonProperty("source",t.source.toLowerCase())}}(e)}t.reset=function(){n=null},t.get=function(){return n||d(n=r.getWindow().skypeTelemetryManager.create()),n}})),define("ui/telemetry/actions/registry/traceableAction",["require","exports","module","lodash-compat","swx-utils-common","usertiming","experience/settings","swx-service-locator-instance","swx-constants","ui/telemetry/telemetryClient"],(function(e,t){var n=e("lodash-compat"),i=e("swx-utils-common").guid,r=e("usertiming"),o=e("experience/settings"),a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("ui/telemetry/telemetryClient")
	function l(e,t){var l,u=this,d=i.create(),p={start:(l=d+"_mark_")+"start",beforeRender:l+"before_render",afterRender:l+"after_render"},f=function(e){var t=e+"_duration_"
	return{beforeRenderDuration:t+"before_render",afterRenderDuration:t+"after_render"}}(d),m=!1,h=a.resolve(s.serviceLocator.FEATURE_FLAGS)
	function v(t){var n=r.getEntriesByName(t)
	n&&n[0]&&(e[function(e){return e.replace(d+"_","")}(t)]=n[0].duration)}function g(){return r.getEntriesByName(p.start).length>0}u.startTrace=function(){r.mark(p.start)},u.markBeforeRender=function(){g()&&(r.mark(p.beforeRender),r.measure(f.beforeRenderDuration,p.start,p.beforeRender),v(f.beforeRenderDuration),m=!0)},u.markAfterRender=function(){g()&&(r.mark(p.afterRender),r.measure(f.afterRenderDuration,p.start,p.afterRender),v(f.afterRenderDuration),m=!0)},u.addEventData=function(t){n.isPlainObject(t)&&n.merge(e,t)},u.endTrace=function(){m&&(h.isFeatureOn(s.featureFlags.TELEMETRY_UIACTIONPERF_ENABLED)&&c.get().sendEvent(o.telemetry.uiTenantToken,"ui_action_perf",e),n.forIn(p,(function(e){r.clearMarks(e)})),n.forIn(f,(function(e){r.clearMeasures(e)})),t())}}t.build=function(e,t){return new l(e,t)}})),define("ui/telemetry/actions/registry/api",["require","ui/telemetry/actions/registry/traceableAction"],(function(e){var t=e("ui/telemetry/actions/registry/traceableAction")
	return function(){var e={}
	function n(t){delete e[t]}this.createAction=function(i){return e[i.actionName]=t.build(i,n.bind(void 0,i.actionName)),e[i.actionName]},this.getAction=function(t){return e[t]}}}))
	define("ui/telemetry/actions/registry/singleton",["require","exports","module","ui/telemetry/actions/registry/api"],(function(e,t){var n,i=e("ui/telemetry/actions/registry/api")
	t.getInstance=function(){return n||(n=new i),n}})),define("ui/telemetry/actions/actionTelemetryApi",["require","exports","module","lodash-compat","experience/settings","ui/telemetry/actions/registry/singleton","ui/telemetry/telemetryClient"],(function(e,t){var n=e("lodash-compat"),i=e("experience/settings"),r=e("ui/telemetry/actions/registry/singleton"),o=e("ui/telemetry/telemetryClient")
	function a(){var e=this
	e.recordAction=function(e,t){var r=n.merge({actionName:e},t)
	o.get().sendEvent(i.telemetry.uiTenantToken,"ui_action",r)},e.createTraceableAction=function(e){var t={actionName:e}
	return r.getInstance().createAction(t)},e.getTraceableAction=function(e){return r.getInstance().getAction(e)}}t.build=function(){return new a}})),define("experience/api/me",["require","exports","module","vendor/knockout","swx-cafe-application-instance","swx-enums","ui/modelHelpers/personHelper","utils/common/cafeObservable","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionTelemetryApi"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-cafe-application-instance"),r=e("swx-enums"),o=e("ui/modelHelpers/personHelper"),a=e("utils/common/cafeObservable"),s=e("ui/telemetry/actions/actionNames"),c=e("ui/telemetry/actions/actionTelemetryApi"),l=n.observable(!1)
	t.isExpanded=l,t.expose=function(){var e=i.get().personsAndGroupsManager.mePerson,t=n.observable(!1),u=a.newObservableProperty(e.status,{keepAlive:!0}),d={read:function(){return u()},write:function(t){e.status(t),f.recordAction(s.presence.change,{presence:t})}},p=a.newObservableCollection(i.get().personsAndGroupsManager.all.persons,{keepAlive:!0}),f=c.build(),m=n.observable(!1)
	return i.get().signInManager.state.changed((function(e){t(e===r.loginState.SignedIn||e===r.loginState.SigningOut)})),e.id.get().then((function(){m(!0)})),{authenticated:t,uri:a.newObservableProperty(e.id),displayName:a.newObservableProperty(e.displayName),avatar:a.newObservableProperty(e.avatarUrl),status:n.computed(d),resetStatus:function(){e.status.reset()},mood:a.newObservableProperty(e.activity),note:{type:a.newObservableProperty(e.note.type),text:a.newObservableProperty(e.note.text)},numberOfNonAgentContacts:n.computed({read:function(){return m()?p().filter((function(e){return!o.isAgent(e)})).length:0}}),isExpanded:l}}})),define("experience/api/contact",["require","exports","module","swx-cafe-application-instance","swx-enums","swx-constants","ui/telemetry/actions/actionNames","utils/common/cafeObservable","swx-service-locator-instance"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-enums"),r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("utils/common/cafeObservable"),s=e("swx-service-locator-instance").default
	t.getByUri=function(e){var t=!s.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.DISABLE_PERSISTENT_CONTACT_PRESENCE_SUBSCRIPTION),c={status:a.newDeferredObservableProperty(null,{keepAlive:t}),displayName:a.newDeferredObservableProperty(),avatar:a.newDeferredObservableProperty(),uri:a.newDeferredObservableProperty()},l=s.resolve(r.serviceLocator.ACTION_TELEMETRY).createTraceableAction(o.search.started),u=n.get().personsAndGroupsManager.createPersonSearchQuery(),d=i.searchScope.AddressBook
	return l.startTrace(),u.sources(d).keywords.id=e,u.getMore().then((function(){var e=u.results().length,t=e?u.results(0).result:void 0
	t&&(c.status.bindToProperty(t.status),c.displayName.bindToProperty(t.displayName),c.avatar.bindToProperty(t.avatarUrl),c.uri.bindToProperty(t.id)),l.markBeforeRender(),l.addEventData({source:"api_contact_search",results:e}),l.endTrace()})),c}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-pubsub/lib/pubSub",["require","exports"],e)}((function(e,t){function n(e){for(var t in e)if(!e[t])throw new Error(t+" is mandatory")}function i(e,t){return t&&t.indexOf(e)>=0}function r(e,t){t&&i(e,t)&&t.splice(t.indexOf(e),1)}var o=function(){function e(){this.callbacks={},this.bulkHandlers=[]}return e.prototype.addBulkSubscriber=function(e){n({callback:e}),i(e,this.bulkHandlers)||this.bulkHandlers.push(e)},e.prototype.removeBulkSubscriber=function(e){n({callback:e}),r(e,this.bulkHandlers)},e.prototype.subscribe=function(e,t){n({eventName:e,callback:t}),this.callbacks[e]=this.callbacks[e]||[],i(t,this.callbacks[e])||this.callbacks[e].push(t)},e.prototype.unsubscribe=function(e,t){n({eventName:e,callback:t}),r(t,this.callbacks[e])},e.prototype.publish=function(e,t){if(void 0===t&&(t=null),n({eventName:e}),this.callbacks[e])for(var i=this.callbacks[e].slice(0),r=i.length-1;r>=0;r--)i[r](t)
	this.bulkHandlers.slice(0).reverse().forEach((function(n){return n(e,t)}))},e.prototype.unsubscribeAll=function(){this.callbacks={},this.bulkHandlers=[]},e}()
	t.__esModule=!0,t.default=o,t.build=function(){return new o}})),define("swx-pubsub",["swx-pubsub/lib/pubSub"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-pubsub-instance/lib/instance",["require","exports","swx-pubsub"],e)}((function(e,t){var n=e("swx-pubsub")
	t.__esModule=!0,t.default=n.build()})),define("swx-pubsub-instance",["swx-pubsub-instance/lib/instance"],(function(e){return e})),define("experience/api/auth/authEventHandler",["require","exports","module","swx-constants","swx-pubsub-instance"],(function(e,t){var n,i=e("swx-constants").COMMON,r=e("swx-pubsub-instance").default
	function o(e){r.publish(i.events.auth.SIGNIN_FAILED,e)}function a(){n=!0,r.unsubscribe(i.apiUIEvents.SWX_SPLASHSCREEN_LOADED,a)}t.init=function(){r.subscribe(i.apiUIEvents.SWX_SPLASHSCREEN_LOADED,a)},t.destroy=function(){r.unsubscribe(i.apiUIEvents.SWX_SPLASHSCREEN_LOADED,a)},t.deferActionOnSplashscreen=function(e,t){function o(){"function"==typeof e&&e(t)}n?(o(),r.unsubscribe(i.apiUIEvents.SWX_SPLASHSCREEN_LOADED,o)):r.subscribe(i.apiUIEvents.SWX_SPLASHSCREEN_LOADED,o)},t.setErrorType=function(e){e.message===i.silentLogin.errorMessages.NOT_LINKED&&(e.name=i.api.auth.errorTypes.NOT_LINKED,e.reason=i.api.auth.errorMessages.NOT_LINKED)},t.startAuthFailedFlow=function(e,n,r){!function(e){return e&&e.name===i.api.auth.errorTypes.NOT_LINKED}(e)?t.deferActionOnSplashscreen(o,e):r?n():t.deferActionOnSplashscreen(n)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/helpers",["require","exports"],e)}((function(e,t){function n(e){var t
	try{t=void 0===e?"undefined":e instanceof Error?e.toString():_stringify(e)||""}catch(n){t="!!!LOG TRACER ERROR!!!Unable to parse argument!!!",console.error("Log tracer failed to serialize following argument",e)}return t}t.getFormattedMessage=function(e){for(var t="",i=!1,r=function(e){return r=function(e){return i||e?(i=e,"\n"):" "},i=e,""},o=2;o<e.length;o++){var a=e[o]
	if("string"==typeof a||void 0===a)t+=r(!1)+a
	else{var s=n(a)
	t+=r(s.length>200)+s}}return t},t.getTimeOfDayString=function(){function e(e){return(e<10?"0":"")+e}var t=new Date
	return e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+":"+t.getMilliseconds()}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/bufferingWriter",["require","exports","./helpers"],e)}((function(e,t){var n=e("./helpers")
	t.build=function(e,t,n){return new i(e,t,n)}
	var i=function(e,t,i){function r(r,o,a){var s=(new Date).toUTCString(),c=a[0],l=a[1],u=n.getFormattedMessage(a),d="["+s+"]["+o+"]["+(l?l+"][":"")+c+"] "+u,p=["["+s+"]",c+" -> "+u]
	if(l&&p.splice(1,0,"["+l+"]"),e)try{e[r].apply(e,p)}catch(f){console.error("Write error",e,e[r])}t.addMessage(d),"error"===o&&i.addMessage(d)}this.supportsCorrelationId=function(){return!0},this.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return r("log","log",e)},this.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return r("info","info",e)},this.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return r("warn","warn",e)},this.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return r("error","error",e)},this.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return r("log","debug",e)}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/consoleWriter",["require","exports","./helpers"],e)}((function(e,t){var n=e("./helpers")
	t.build=function(){var e={}
	return["error","warn","info","log"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return console[t].bind(console,n.getTimeOfDayString())}})})),e.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	function i(e,t,n){var i=e.length,r=0,o=e.indexOf("\n",r)
	do{for(var a=Math.min(i,r+t),s=a;o>=r&&o<s;a=o+1,o=e.indexOf("\n",o+1));n(e.substring(r,a)),r=a}while(r<i)}var r={accumulatedLength:0},o=[n.getTimeOfDayString(),e[0]],a=o.reduce((function(e,t){return e+t.length+2}),0),s=e.length
	function c(e,t){var n="string"==typeof e?e.length:0,i=1024-t,o="string"==typeof e&&-1!==e.indexOf("\n")
	return r.accumulatedLength+=n,!!(r.accumulatedLength>i||o)&&(r.accumulatedLength=0,!0)}for(var l=1;l<e.length;l++)if(c(e[l],a)){s=l
	break}console.log.apply(console,o.concat(Array.prototype.slice.call(e,1,s)))
	var u=s
	for(l=u;l<e.length;l++){var d=c(e[l],0)
	l>u&&(d||l===e.length-1)&&console.log.apply(console,Array.prototype.slice.call(e,u,l)),d&&(i(e[l],1024,console.log.bind(console)),u=l+1)}},e}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/telemetryWriter",["require","exports","lodash-compat","./helpers"],e)}((function(e,t){var n=e("lodash-compat"),i=e("./helpers")
	t.build=function(e,t){var r={supportsCorrelationId:function(){return!0}}
	return["log","info","warn","debug"].forEach((function(t){r[t]=e?e[t]:n.noop})),r.error=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o]
	e&&e.error.apply(r,n)
	var a=i.getFormattedMessage(n),s=n[0],c=void 0!==n[1]?n[1]:"",l={namespace:s,message:a,shortMessage:void 0!==n[2]?n[2]:"",correlationId:c,level:"error"}
	t.send(l)},r}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/messageBuffer",["require","exports"],e)}((function(e,t){t.build=function(){var e,t={clear:function(){e=[],0},addMessage:function(t){t.length,e.push(t)},toString:function(){return e.join("\n")}}
	return t.clear(),t}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/nullLogger",["require","exports"],e)}((function(e,t){t.build=function(){return new n}
	var n=function(){function e(){}return e.prototype.log=function(){},e.prototype.info=function(){},e.prototype.warn=function(){},e.prototype.error=function(){},e.prototype.debug=function(){},e.prototype.createChild=function(){return this},e.prototype.supportsCorrelationId=function(){return!1},e}()})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/decoratingLogger",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	t.build=function e(t,i,r,o){var a={}
	function s(e){return"function"==typeof e.supportsCorrelationId&&e.supportsCorrelationId()}function c(e){return"function"==typeof e?e():e}return["error","warn","info","log"].forEach((function(e){Object.defineProperty(a,e,{get:function(){return s(t)?t[e].bind(t,i(),c(r)):t[e].bind(t,i())}})})),o?Object.defineProperty(a,"debug",{get:function(){return s(t)?t.debug.bind(t,i(),c(r)):t.debug.bind(t,i())}}):a.debug=n.noop,a.createChild=function(n,a,s){return void 0===s&&(s=o),void 0===a&&(a=r),e(t,"function"==typeof n?function(){return i()+"::"+n()}:function(){return i()+"::"+n},a,s)},a}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/telemetryReporter",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	t.build=function(){var e={send:n.noop,update:function(t){var i=t.reporting.telemetryManager,r=t.reporting.telemetryToken,o=t.reporting.throttleInterval
	e.send=i&&r?n.throttle((function(e){i.sendEvent(r,"logging",e)}),o,{trailing:!1}):n.noop}}
	return e}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-log-tracer/lib/api",["require","exports","lodash-compat","./bufferingWriter","./consoleWriter","./telemetryWriter","./messageBuffer","./nullLogger","./decoratingLogger","./telemetryReporter","swx-browser-globals"],e)}((function(e,t){var n,i,r=e("lodash-compat"),o=e("./bufferingWriter"),a=e("./consoleWriter"),s=e("./telemetryWriter"),c=e("./messageBuffer"),l=e("./nullLogger"),u=e("./decoratingLogger"),d=e("./telemetryReporter"),p=e("swx-browser-globals"),f=c.build(),m=c.build(),h=l.build(),v=d.build()
	function g(e,t,i){var r
	function c(c){return function(){return r||(r=function(){var r
	if(n.logToBuffer){var c=n.logToConsole?console:null
	r=o.build(c,f,m)}else n.logToConsole&&(r=a.build())
	return n.reporting.enabled&&(r=s.build(r,v)),r?u.build(r,(function(){return e}),t,i):h}()),r[c]}}return Object.create(Object.prototype,{log:{get:c("log")},info:{get:c("info")},warn:{get:c("warn")},error:{get:c("error")},debug:{get:c("debug")},createChild:{get:c("createChild")}})}function y(e){n={logToConsole:!1,logToBuffer:!1,logUnhandled:!1,reporting:{enabled:!1,throttleInterval:1e4,telemetryManager:null,telemetryToken:null}},r.merge(n,e),v.update(n),function(){i&&(p.getWindow().removeEventListener("error",b),i=null)
	n.logUnhandled&&(i=g("Unhandled Exceptions"),p.getWindow().addEventListener("error",b))}()}function b(e){try{i.error(_stringify(e.error,["message","arguments","type","name","stack"]))}catch(t){i.error("Error: "+e)}}t.getLogs=function(){return{all:f.toString(),error:m.toString()}},t.clearLogs=function(){f.clear(),m.clear()},t.getLogger=g,t.configure=y,y()})),define("swx-log-tracer",["swx-log-tracer/lib/api"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-util-calling-stack/lib/callingStack",["require","exports","swx-browser-detect","swx-constants","../../swx-log-tracer"],e)}((function(e,t){var n=e("swx-browser-detect"),i=e("swx-constants"),r=e("../../swx-log-tracer").getLogger("CallingStack"),o=null,a=null,s=function(){function e(){this.outOfBrowserAvailable=!1}return e.prototype.isPluginlessEnabledInCurrentBrowser=function(){var e=n.default.getBrowserInfo(),t=n.default.getSystemInfo()
	return!(e.browserName!==n.default.BROWSERS.FIREFOX||!a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_FIREFOX])||(e.browserName!==n.default.BROWSERS.CHROME||!(e.browserMajorVersion<55||e.isYandex))&&(!(e.browserName!==n.default.BROWSERS.CHROME||!a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_CHROME])||(e.browserName===n.default.BROWSERS.CHROME&&a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_CHROME_NO_EXTENSION]?!this.outOfBrowserAvailable:!!(e.browserName===n.default.BROWSERS.EDGE&&a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_EDGE]&&e.browserMajorVersion>=a.pluginless.allowedMinEdgeVersion)||(!(e.browserName!==n.default.BROWSERS.ELECTRON||!a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_ELECTRON])||!(t.osName!==n.default.OPERATING_SYSTEMS.LINUX||e.browserName!==n.default.BROWSERS.CHROME||!a.featureFlags[i.COMMON.featureFlags.PLUGINLESS_CALLING_CHROME_LINUX]))))},e.prototype.isPluginlessCallingSupported=function(){var e=n.default.getBrowserInfo()
	return!!a.featureFlags[i.COMMON.featureFlags.NG_CALLING]&&(e.isPluginlessCallingSupported&&this.isPluginlessEnabledInCurrentBrowser())},e.prototype.isInBrowserPluginSupported=function(){return!1},e.prototype.isInBrowserCallingSupported=function(){return this.isPluginlessCallingSupported()},e.prototype.isOutofBrowserCallingSupported=function(){return!n.default.getBrowserInfo().isInBrowserPluginSupported&&!this.isPluginlessCallingSupported()},e.prototype.isPluginlessOnly=function(){var e=n.default.getBrowserInfo(),t=n.default.getSystemInfo()
	return e.browserName===n.default.BROWSERS.EDGE&&e.browserMajorVersion>13||t.osName===n.default.OPERATING_SYSTEMS.LINUX},e.prototype.initInfo=function(){return this.browserCheckPromise||(r.info("No browser checks necessary"),this.browserCheckPromise=Promise.resolve(void 0)),this.browserCheckPromise},e}()
	t.init=function(e){return a=e},t.get=function(){if(!a)throw new Error("No settings found for calling stack!")
	return o=o||new s},t.__esModule=!0,t.default={get:t.get,init:t.init}})),define("swx-util-calling-stack",["swx-util-calling-stack/lib/callingStack"],(function(e){return e})),define("constants/components",{calling:{CALL_SCREEN:"swx-call-screen",ROSTER:"swx-call-roster",CALL_ANIMATION:"swx-call-animation",END_CALL:"swx-end-call",CONTENT:"swx-call-content",HEADER:"swx-call-header",FOOTER:"swx-call-footer",PARTICIPANT_MENU:"swx-participant-menu",JOINCALL_BUTTON:"swx-joincall-button",START_CALL_BUTTON:"swx-start-call-button",SKYPEOUT_PAGE:"swx-skype-out",SKYPEOUT_HEADER:"swx-skype-out-header",SKYPEOUT_DIALPAD:"swx-dialpad",SKYPEOUT_COUNTRY_PICKER:"swx-countrypicker",CQF:"swx-cqf",CQF_STAR_RATING:"swx-star-rating",CQF_QUESTION:"swx-cqf-question",SCREEN_SHARING_PREVIEW:"swx-screen-sharing-preview",UNANSWERED_CALL:"swx-unanswered-call",CALL_SCREEN_MODAL:"swx-call-screen-modal",ADD_PARTICIPANTS:"swx-add-participants"},chat:{CHAT_LOG:"swx-chat-log",CHAT_INPUT:"swx-chat-input",CONVERSATION:"swx-conversation",GROUP_SEARCH:"swx-group-search",INVITE_LINK:"swx-invite-link",HEADER_NEW_CONVERSATION:"swx-header-new-conversation",MESSAGE:"swx-message",NAVIGATION:"swx-navigation",SIDEBAR:"swx-sidebar",NEW_CONVERSATION:"swx-new-conversation",CONTACT_PICKER_INPUT:"swx-contact-picker-input",SPACE_SETTINGS:"swx-space-settings",RECENTS:"swx-recents",TEXTAREA:"swx-textarea",CURRENT_CALL:"swx-current-call",UNREAD_MESSAGE_COUNTER:"swx-unread-message-counter",CURRENT_CALL_ACTIONS:"swx-current-call-actions",RECENT_ITEM:"swx-recent-item",CONTACT_PILL:"swx-contact-pill",CONTACT_CARD:"swx-contact-card",MENU_ITEM:"swx-menu-item",HEADER:"swx-header",HEADER_SINGLE_CONVERSATION:"swx-header-single-conversation",GROUP_PROFILE:"swx-group-profile",TYPING_INDICATOR:"swx-typing-indicator",EXPRESSION_PICKER:"swx-expression-picker",EXPRESSION_ITEMS_PICKER:"swx-expressionitems-picker",EXPRESSION_ITEM_ROSTER:"swx-expressionitem-roster",EXPRESSION_STORE_V2_BROWSE_PACKS:"swx-expressionstore-v2-browsepacks",CONVERSATION_SHARE_LINK:"swx-conversation-share-link",SELECTED_PARTICIPANTS_CONVERSATION:"swx-selected-participants-conversation",CONVERSATION_CARD:"swx-conversation-card",SHARE_DIALOG_INPUT:"swx-share-dialog-input",FILE_PICKER:"swx-file-picker",NOTIFICATIONS_CENTER:"swx-notifications-center",NOTIFICATIONS_MENU_ITEM:"swx-notifications-menu-item",NOTIFICATIONS_TOGGLE_BUTTON:"swx-notifications-toggle-button",UPLOAD_MANAGER:"swx-upload-manager",POLL_DESIGNER:"swx-poll-designer",STICKY_MESSAGE:"swx-sticky-message",FILE_TRANSFER_ACTIVITY_ACTIONS:"swx-filetransfer-activity-actions",CHAT_INPUT_ACTION_PICKER:"swx-chat-input-action-picker",CHAT_INPUT_SEND_CONTACT_CARD:"swx-chat-input-send-contact-card",CHAT_INPUT_POLL_BUTTON:"swx-chat-input-poll-button",SHARE_CONTROL:"swx-share-control",START_CONVERSATION_OVERLAY:"swx-start-conversation-overlay",SUGGESTION_LIST:"swx-suggestion-list",VIDEO_PLAYER:"swx-video-player",AUDIO_PLAYER:"swx-audio-player",GIFPLAYER:"swx-gif-player",HEART_TOAST:"swx-heart-toast",USER_LIST_POPUP:"swx-user-list-popup",TRANSLATOR_SETTINGS:"swx-translator-settings",TRANSLATOR_LANGUAGE_PICKER:"swx-translator-language-picker",MORE_ACTIONS_BUTTON:"swx-more-actions-button",HEART:"swx-heart",NARRATOR:"swx-narrator",MESSAGES_SEARCH:"swx-messages-search",MUTE_CONVERSATION_SETTING_ITEM:"swx-mute-conversation-setting-item",MESSAGE_DESTINATION_PICKER:"swx-message-destination-picker",SMS_PRICE:"swx-sms-price"},experience:{BUTTON:"swx-button",SEARCH_INPUT:"swx-search-input",SEARCH_RESULTS:"swx-search-results",LOADING_ANIMATION:"swx-loading-animation",RADIO_BUTTON:"swx-radio-button",SELECT_BOX:"swx-select-box",TOGGLE_BUTTON:"swx-toggle-button",AVATAR_FILE_PICKER:"swx-avatar-file-picker",EDUCATIONAL_CAROUSEL:"swx-edu-carousel",TEAMS_ALERT:"swx-teams-alert",TEAMS_MIGRATED:"swx-teams-migrated"},people:{AVATAR:"swx-avatar",AVATAR_DEPRECATED:"swx-avatar-deprecated",NAME:"swx-name",CONTACT_PICKER:"swx-contact-picker",PEOPLE_SEARCH:"swx-people-search",CONTACT_LIST_MENU_ITEM:"swx-contact-list-menu-item",DIRECTORY_SEARCH:"swx-directory-search",DISCOVER_AGENTS_PAGE:"swx-discover-agents",CONTACTS_PAGE:"swx-contacts",CONTACT_PROFILE:"swx-contact-profile",CONTACT_PROFILE_PHONE_NUMBER:"swx-contact-profile-phone-number",CONTACT_REQUEST_INCOMING:"swx-contact-request-incoming",CONTACT_REQUEST_OUTGOING:"swx-contact-request-outgoing",CONTACT_REQUEST_OUTGOING_RESEND:"swx-contact-request-outgoing-resend"},commerce:{CREDIT_BALANCE:"swx-credit-balance",SUBSCRIPTION_ENTITLEMENT:"swx-subscription-entitlement"},me:{AREA:"swx-me-area",PRESENCE_POPUP:"swx-me-presence-popup",MOOD_MESSAGE:"swx-me-mood-message"},userSettings:{USER_SETTINGS_PAGE:"swx-user-settings-page",SHORT_CIRCUIT:"swx-short-circuit",ABOUT:"swx-about",AUDIO_VIDEO_SETTINGS_PANE:"swx-audio-video-settings-pane"},notifications:{NOTIFICATION_BOX:"swx-notification-box"}}),define("ui/viewModels/chat/navigationHelper",["require","exports","module","lodash-compat","swx-pubsub-instance","swx-constants","constants/components"],(function(e,t){var n=e("lodash-compat"),i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=e("constants/components")
	t.navigateToContactsPage=function(e){e=n.isFunction(e)?e:n.noop,i.publish(r.events.navigation.NAVIGATE,{page:o.people.CONTACTS_PAGE}),e()},t.navigateToConversation=function(e,t){i.publish(r.events.navigation.OPEN_CONVERSATION,{model:e,origin:t})}})),define("browser/dom",["require","exports","module","lodash-compat","swx-browser-globals"],(function(e,t){var n=e("lodash-compat"),i=e("swx-browser-globals")
	function r(e,t){var n=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector
	return!!n&&n.call(e,t)}function o(e,t,n){n?c(e,t):l(e,t)}function a(e,t){var n=(t=t||i.getDocument()).querySelectorAll(e)
	return Array.prototype.slice.call(n,0)}function s(e,t){if(e.classList)return e.classList.contains(t)
	for(var n=e.className?e.className.split(" "):[],i=0;i<n.length;i++)if(n[i]===t)return!0
	return!1}function c(e,t){if(n.isString(t))if(e.classList)e.classList.add(t)
	else{var i=" "+e.className+" "
	i.indexOf(t)<0&&(i+=t+" "),e.className=i.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}}function l(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(t,"").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function u(e){return null!==e&&(e.removeClass=function(t){l(e,t)},e.addClass=function(t){c(e,t)},e.hasClass=function(t){return s(e,t)},e.setClass=function(t,n){o(e,t,n)}),e}t.createElement=function(e){return n.isString(e)?u(i.getDocument().createElement(e)):null},t.findElement=function(e){return n.isString(e)?u(i.getDocument().querySelector(e)):null},t.isElement=function(e){return Boolean(e&&1===e.nodeType)},t.getElement=function(e,t){return t=t||i.getDocument(),n.isString(e)?u(t.querySelector(e)):function(e){return!(!e||!n.isString(e.tagName)&&!n.isString(e.nodeName))}(e)?u(e):null},t.getElementById=function(e,n){return e?t.getElement("#"+e,n):null},t.getElements=a,t.getSibling=function(e,t){return t?e.previousSibling:e.nextSibling},t.getNavigableChildren=function(e){return a(['[tabindex]:not([tabindex=""]):not([tabindex="-1"]):not([disabled])'],e)},t.isA=function(e,t){if(n.isElement(e))return e.tagName.toLowerCase()===t
	return!1},t.isVisible=function(e){return Boolean(e.offsetParent)},t.hasClass=s,t.getParentWithClass=function(e,t){for(;e&&!s(e,t);)e=e.parentNode
	return e},t.getParentMatching=function(e,t){for(;e&&!r(e,t);)e=e.parentNode
	return e},t.addClass=c,t.setClass=o,t.removeClass=l,t.extendObject=u,t.createDomObserverSubscription=function(e,t){var n,r=i.getWindow(),o=r.MutationObserver||r.WebKitMutationObserver
	o?(n=new o((function(e){e&&e[0]&&(e[0].addedNodes&&e[0].addedNodes.length||e[0].removedNodes&&e[0].removedNodes.length)&&t()}))).observe(e,{childList:!0,subtree:!0}):e.addEventListener("DOMSubtreeModified",t,!1)
	return{dispose:function(){o?n.disconnect():e.removeEventListener("DOMSubtreeModified",t)}}},t.getElementOffset=function(e){var t={offsetLeft:0,offsetTop:0}
	for(;e;)t.offsetLeft+=e.offsetLeft+e.clientLeft-e.scrollLeft,t.offsetTop+=e.offsetTop+e.clientTop-e.scrollTop,e=e.offsetParent
	return t},t.findFirstCommonAncestor=function(e,t){var n=e
	for(;n&&!n.contains(t);)n=n.parentNode
	return n},t.getLastChildElement=function(e){var t=e.lastChild
	for(;t&&1!==t.nodeType;)t=t.previousSibling
	return t},t.isDocumentHidden=function(){return i.getDocument().hidden}})),define("services/plugin/pluginDownload",["require","browser/dom","swx-browser-detect","experience/settings"],(function(e){var t=e("browser/dom"),n=e("swx-browser-detect").default,i=e("experience/settings")
	return{downloadPlatformSpecificInstaller:function(){(function(e){var n=t.createElement("iframe")
	n.src=e,n.width="0",n.height="0",n.style.border="0",n.style.position="absolute",n.style.top="0",n.style.left="0",document.body.appendChild(n)})(n.getSystemInfo().osName===n.OPERATING_SYSTEMS.WINDOWS?i.plugin.download.msi:i.plugin.download.pkg)}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-i18n/lib/plurals",["require","exports"],e)}((function(e,t){var n="",i="_few",r="_many",o={af:"af",am:"am",ar:"ar",as:"as",az:"az",be:"be",bg:"bg",bn:"bn",bs:"bs",chr:"chr",ca:"ca",cs:"cs",cy:"cy",da:"da",de:"de",el:"el",en:"en",es:"es",et:"et",eu:"eu",fa:"fa",fi:"fi",fil:"fil",fr:"fr",ga:"ga",gd:"gd",gl:"gl",gu:"gu",ha:"ha",he:"he",hi:"hi",hr:"hr",hu:"hu",hy:"hy",id:"id",ig:"ig",is:"is",it:"it",iw:"iw",ja:"ja",ka:"ka",kk:"kk",km:"km",kn:"kn",ko:"ko",kok:"kok",ku:"ku",ky:"ky",lb:"lb",lt:"lt",lv:"lv",mi:"mi",ml:"ml",mn:"mn",mr:"mr",ms:"ms",ne:"ne",nl:"nl",nn:"nn",nb:"nb",no:"no",nso:"nso",or:"or",pa:"pa",pl:"pl",prs:"prs",pt_br:"pt-br",pt_pt:"pt-pt",qps:"qps",qut:"qut",quz:"quz",ro:"ro",ru:"ru",rw:"rw",sd:"sd",si:"si",sl:"sl",sk:"sk",sq:"sq",sr:"sr",sv:"sv",sw:"sw",ta:"ta",te:"te",tg:"tg",th:"th",ti:"ti",tk:"tk",tn:"tn",tr_tr:"tr-tr",tt:"tt",ug:"ug",uk:"uk",ur:"ur",uz:"uz",vi:"vi",wo:"wo",xh:"xh",yo:"yo",zh:"zh",zu:"zu"},a={group0:{languages:[o.ja,o.id,o.ko,o.tr_tr,o.vi,o.zh,o.az,o.ig,o.fa,o.ka,o.km,o.kn,o.ms,o.prs,o.th,o.tt,o.ug,o.wo,o.yo]},group1:{languages:[o.bg,o.ca,o.cy,o.da,o.de,o.el,o.en,o.es,o.et,o.fi,o.he,o.hu,o.it,o.iw,o.nb,o.nl,o.no,o.pt_pt,o.qps,o.sv,o.af,o.as,o.bn,o.chr,o.eu,o.gl,o.gu,o.ha,o.hy,o.is,o.kk,o.kok,o.ku,o.ky,o.lb,o.mi,o.ml,o.mn,o.mr,o.ne,o.nn,o.or,o.pa,o.qut,o.quz,o.rw,o.sd,o.si,o.sq,o.sw,o.ta,o.te,o.tk,o.tn,o.ur,o.xh,o.zu]},group2:{languages:[o.fr,o.pt_br,o.am,o.fil,o.hi,o.nso,o.tg,o.ti,o.uz]},group3:{languages:[o.lv]},group4:{languages:[o.gd]},group5:{languages:[o.ro]},group6:{languages:[o.lt]},group7:{languages:[o.ru,o.uk,o.hr,o.sr,o.be,o.bs,o.sl]},group8:{languages:[o.cs,o.sk]},group9:{languages:[o.pl]},group11:{languages:[o.ga]},group12:{languages:[o.ar]}}
	t.pluralizationLocale=o
	var s=o.en
	t.getPluralSuffix=function(e,t){t||(t=s)
	var o=null,c=""
	for(var l in a)-1!==a[l].languages.indexOf(t)&&(o=l)
	switch(o){case"group0":c=1===e?n:i
	break
	case"group1":c=1===e?n:r
	break
	case"group2":c=e>1?r:n
	break
	case"group3":c=e%10==1&&e%100!=11?n:0===e?i:r
	break
	case"group4":c=1===e||11===e?n:2===e||12===e?i:r
	break
	case"group5":c=1===e?n:0===e||e%100>0&&e%100<20?i:r
	break
	case"group6":c=e%10==1&&e%100!=11?n:e%10>=2&&(e%100<10||e%100>=20)?r:i
	break
	case"group7":c=e%10==1&&e%100!=11?n:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?i:r
	break
	case"group8":c=1===e?n:e>=2&&e<=4?i:r
	break
	case"group9":c=1===e?n:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?i:r
	break
	case"group11":c=1===e?n:e>=2&&e<=10?i:r
	break
	case"group12":c=1===e?n:2===e?i:r
	break
	default:c=""}return c},t.setLocale=function(e){s=e}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-i18n/lib/resources",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat"),i={}
	function r(e){if(!e)throw new Error("[i18n / resources] Specified destination for localizations resources is not reachable")}t.set=function(e){r(e),i=e},t.merge=function(e){r(e),i=n.merge(i,e)},t.get=function(){return i}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-i18n/lib/localization",["require","exports","./plurals","./resources"],e)}((function(e,t){var n=e("./plurals"),i=e("./resources")
	function r(e){var t=i.get()
	return t&&t[e]||e}t.fetch=function(e){if("object"!=typeof e)throw new Error("[i18n / localization] Argument must be type of object")
	var t,i,o,a=e.key
	if(!a)throw new Error("[i18n / localization] Missing key")
	var s=r(a)
	if(void 0!==e.count&&(t=e.count,e.params=e.params||{},e.params.count=t,a+=n.getPluralSuffix(t,e.locale)),e.params)for(i in s=r(a),e.params)if(e.params.hasOwnProperty(i)){if("function"==typeof(o=e.params[i]))throw new Error("[i18n / localization] Replacement value must not be a function")
	s=s.replace(new RegExp("{"+i+"}","g"),o)}return s}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-i18n/lib/knockoutBindingExtensions",["require","exports","./localization"],e)}((function(e,t){var n=e("./localization")
	t.init=function(e){e.bindingHandlers.l10n={update:function(t,i,r,o,a){var s=e.utils.unwrapObservable(i()),c=s.params
	for(var l in c)c.hasOwnProperty(l)&&"function"==typeof c[l]&&(c[l]=e.utils.unwrapObservable(c[l]()))
	var u=n.fetch(s)
	e.bindingHandlers.html.update(t,(function(){return u}),r,o,a)}},e.bindingHandlers.l10n_attr={update:function(t,i,r,o,a){var s,c,l=e.utils.unwrapObservable(i())
	function u(){var e={}
	return e[c]=s,e}for(c in l)l.hasOwnProperty(c)&&(s=n.fetch({key:l[c]}),e.bindingHandlers.attr.update(t,u,r,o,a))}}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-i18n/lib/index",["require","exports","./knockoutBindingExtensions","./localization","./plurals","./resources"],e)}((function(e,t){var n=e("./knockoutBindingExtensions")
	t.knockoutBindingExtensions=n
	var i=e("./localization")
	t.localization=i
	var r=e("./plurals")
	t.plurals=r
	var o=e("./resources")
	t.resources=o}))
	define("swx-i18n",["swx-i18n/lib/index"],(function(e){return e})),define("ui/viewModels/calling/helpers/browserInstallContent",["require","swx-browser-detect","experience/settings","swx-i18n","swx-constants","swx-service-locator-instance"],(function(e){var t=e("swx-browser-detect").default,n=e("experience/settings"),i=e("swx-i18n").localization,r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a="/images/components/av/installSteps/",s=".jpg",c={"Mac OS X":{Chrome:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Mac_01_Chrome",text:"pluginInstall_mac_chrome_text_download"},install:{image:"Mac_02_Install",text:"pluginInstall_mac_chrome_text_install"},enjoy:{image:"Mac_03_Skype",text:"pluginInstall_mac_chrome_text_enjoy"},unblock:{image:"Blocked_Chrome",text:"pluginInstall_unblock_text_chrome_subtitle"},extensionStart:{image:"PluginChromeIcon",text:"pluginInstall_extension_main_text_subtitle"},extensionInstallFailed:{image:"CloseScreen",text:"pluginInstall_extension_main_install_failed_text_subtitle"},extensionInstallPlugin:{image:"DownloadIcon",text:"pluginInstall_extension_main_installed_text_subtitle"}},Safari:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Mac_01_Safari",text:"pluginInstall_mac_safari_text_download"},install:{image:"Mac_02_Install",text:"pluginInstall_mac_safari_text_install"},enjoy:{image:"Mac_03_Skype",text:"pluginInstall_mac_safari_text_enjoy"}},Firefox:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Mac_01_Firefox",text:"pluginInstall_mac_firefox_text_download"},install:{image:"Mac_02_Install",text:"pluginInstall_mac_firefox_text_install"},enjoy:{image:"Mac_03_Skype",text:"pluginInstall_mac_firefox_text_enjoy"},unblock:{image:"Blocked_Firefox",text:"pluginInstall_unblock_text_firefox_subtitle"}},Unknown:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Mac_01_Safari",text:"pluginInstall_mac_unknown_text_download"},install:{image:"Mac_02_Install",text:"pluginInstall_mac_unknown_text_install"},enjoy:{image:"Mac_03_Skype",text:"pluginInstall_mac_unknown_text_enjoy"}}},Windows:{Chrome:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Windows_01_Chrome",text:"pluginInstall_windows_chrome_text_download"},install:{image:"Windows_02_Install",text:"pluginInstall_windows_chrome_text_install"},enjoy:{image:"Windows_03_Skype",text:"pluginInstall_windows_chrome_text_enjoy"},unblock:{image:"Blocked_Chrome",text:"pluginInstall_unblock_text_chrome_subtitle"},extensionStart:{image:"PluginChromeIcon",text:"pluginInstall_extension_main_text_subtitle"},extensionInstallFailed:{image:"CloseScreen",text:"pluginInstall_extension_main_install_failed_text_subtitle"},extensionInstallPlugin:{image:"DownloadIcon",text:"pluginInstall_extension_main_installed_text_subtitle"}},MSIE:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Windows_01_IE",text:"pluginInstall_windows_msie_text_download"},install:{image:"Windows_02_Install",text:"pluginInstall_windows_msie_text_install"},enjoy:{image:"Windows_03_Skype",text:"pluginInstall_windows_msie_text_enjoy"}},Firefox:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Windows_01_Firefox",text:"pluginInstall_windows_firefox_text_download"},install:{image:"Windows_02_Firefox",text:"pluginInstall_windows_firefox_text_install"},enjoy:{image:"Windows_03_Skype",text:"pluginInstall_windows_firefox_text_enjoy"},unblock:{image:"Blocked_Firefox",text:"pluginInstall_unblock_text_firefox_subtitle"}},Unknown:{closeScreen:{image:"CloseScreen",text:"pluginInstall_main_close_screen_subtitle"},download:{image:"Windows_01_IE",text:"pluginInstall_windows_unknown_text_download"},install:{image:"Windows_02_Install",text:"pluginInstall_windows_unknown_text_install"},enjoy:{image:"Windows_03_Skype",text:"pluginInstall_windows_unknown_text_enjoy"}}}}
	function l(e){return[n.assetsBaseUrl,a,e,s].join("")}function u(e){return e+"_4b"}function d(e){return o.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.USE_BUSINESS_WORDING)?i.fetch({key:u(e)}):i.fetch({key:e})}return{getInstallResources:function(){var e,n,r,o={osName:t.getSystemInfo().osName,browserName:t.getBrowserInfo().browserName}
	return n=o.osName!==t.OPERATING_SYSTEMS.MACOSX?{osName:t.OPERATING_SYSTEMS.WINDOWS,browserName:t.BROWSERS.MSIE}:{osName:t.OPERATING_SYSTEMS.MACOSX,browserName:t.BROWSERS.SAFARI},function(e,t){var n,r=c[e][t]
	r||(r=c.Windows.Unknown)
	n={images:{closeScreen:l(r.closeScreen.image),download:l(r.download.image),install:l(r.install.image),enjoy:l(r.enjoy.image)},text:{closeScreen:i.fetch({key:r.closeScreen.text}),download:i.fetch({key:r.download.text}),install:i.fetch({key:r.install.text}),enjoy:d(r.enjoy.text)}},r.unblock&&function(e,t){e.images.unblock=l(t.image),e.text.unblock=i.fetch({key:t.text})}(n,r.unblock)
	r.extensionStart&&function(e,t){e.images.extensionStart=l(t.extensionStart.image),e.text.extensionStart=i.fetch({key:t.extensionStart.text}),e.images.extensionInstallPlugin=l(t.extensionInstallPlugin.image),e.text.extensionInstallPlugin=i.fetch({key:t.extensionInstallPlugin.text}),e.images.extensionInstallFailed=l(t.extensionInstallFailed.image),e.text.extensionInstallFailed=i.fetch({key:t.extensionInstallFailed.text})}(n,r)
	return n}((e=(r=t.getSystemInfo().osName)===t.OPERATING_SYSTEMS.WINDOWS||r===t.OPERATING_SYSTEMS.MACOSX?o:n).osName,e.browserName)}}})),define("constants/calling.resources",[],(function(){return{notifications:{incomingCall:{linkTemplate:'<a href="http://skype.com/go/help.faq.skype.for.web" target="_blank">{notification_text_learnMore}</a>'}},fallbackMessages:{skypeUpgradeLink:'<a href="https://www.skype.com/en/download-skype" target="_blank">https://www.skype.com/en/download-skype</a>',ngcUpgradeLink:'<a href="https://go.skype.com/groupupgrade/" target="_blank">https://go.skype.com/groupupgrade/</a>'},pluginInstall:{terms:'<a href="https://www.skype.com/en/legal/tou/" target="_blank">{pluginInstall_steps_text_termsLink}</a>',privacy:'<a href="https://www.skype.com/en/legal/privacy/" target="_blank">{pluginInstall_steps_text_privacyLink}</a>'}}})),define("ui/viewModels/calling/plugin/downloadStepViewModel",["require","exports","module","swx-cafe-application-instance","services/plugin/pluginDownload","swx-constants","ui/viewModels/calling/helpers/browserInstallContent","swx-enums","swx-i18n","constants/calling.resources","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("services/plugin/pluginDownload"),r=e("swx-constants").CALLING,o=e("ui/viewModels/calling/helpers/browserInstallContent"),a=e("swx-enums"),s=e("swx-i18n").localization,c=e("constants/calling.resources").pluginInstall,l=e("ui/telemetry/actions/actionNames"),u=e("swx-constants").COMMON,d=e("swx-service-locator-instance").default,p=function(e){var p=e.next,f=e.close,m=o.getInstallResources(),h=n.get().personsAndGroupsManager.mePerson.capabilities.audio,v=n.get().devicesManager.mediaCapabilities,g={terms:"pluginInstall_steps_text_termsLink",privacy:"pluginInstall_steps_text_privacyLink"},y=d.resolve(u.serviceLocator.FEATURE_FLAGS)
	function b(){h.changed.off(_)}function _(e,t){t!==a.callingNotSupportedReasons.PluginNotInstalled&&(E(),b(),p())}function E(){e.conversation||e.suppressEndedEvent||e.onPluginInstallEnded(r.PLUGIN_INSTALL_EXIT_METHOD.PLUGIN_DETECTED,!0)}function w(){v.isPluginInstalled.changed.off(S)}function S(e){e&&(E(),w(),p())}this.id=t.STEP_ID,this.label=s.fetch({key:"pluginInstall_label_text_download"}),this.downloadImage=m.images.download,this.downloadText=m.text.download,this.installImage=m.images.install,this.installText=m.text.install,this.enjoyImage=m.images.enjoy,this.enjoyText=m.text.enjoy,this.showAutoUpdateDisclaimer=!y.isFeatureOn(u.featureFlags.USE_BUSINESS_WORDING),this.showTermsAndPrivacy=!y.isFeatureOn(u.featureFlags.USE_BUSINESS_WORDING),e.conversation&&e.conversation.audioService.start.enabled.reason===a.callingNotSupportedReasons.PluginNotInstalled&&(h=e.conversation.audioService.start.enabled),this.show=function(){var e=d.resolve(u.serviceLocator.ACTION_TELEMETRY)
	if(v.isPluginInstalled){if(v.isPluginInstalled())return w(),void p()
	v.isPluginInstalled.changed(S)}else{if(h.reason!==a.callingNotSupportedReasons.PluginNotInstalled)return b(),void p()
	h.changed(_)}i.downloadPlatformSpecificInstaller(),e.recordAction(l.audioVideo.pluginInstall.installPlugin)},this.restartDownload=function(){var e=d.resolve(u.serviceLocator.ACTION_TELEMETRY)
	i.downloadPlatformSpecificInstaller(),e.recordAction(l.audioVideo.pluginInstall.restart)},this.close=function(){v.isPluginInstalled?w():b(),f()},this.getLink=function(e){var t=g[e],n=s.fetch({key:t})
	return c[e].replace("{"+t+"}",n)}}
	t.STEP_ID=r.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_STEPS,t.build=function(e){return new p(e)}})),define("constants/cssClasses",["require","exports","module"],(function(e,t){t.HIDE="swx-hide",t.LIST_SELECTABLE="list-selectable",t.SEARCH_ITEM="searchItem",t.MODAL_DIALOG="swx-overlayModal",t.contextMenu={CONTEXT_MENU:"swxContextMenu",FLIPPED:"flipped",items:{BLOCK_CONTACT:"blockContactMenuItem",CALL_SKYPE:"callSkypeMenuItem",DELETE_CONTACT:"deleteContactMenuItem",START_PSTN_CALL:"startPSTNCallMenuItem",UNBLOCK_CONTACT:"unblockContactMenuItem",VIDEO_CALL:"videoCallMenuItem",SCHEDULE_CALL:"scheduleCallMenuItem"}},t.avatar={AVATAR:"Avatar",AVATAR_PRESENCE:"Avatar--presence",AVATAR_GROUP:"Avatar--group",AVATAR_SELECTED:"Avatar--selected",AVATAR_USE_DEFAULT:"Avatar--defaultAvatar",AVATAR_AGENT:"Avatar--agent",AVATAR_PSTN:"Avatar--pstn",AVATAR_SIZE:"Avatar--size",AVATAR_ABSOLUTE:"Avatar--absolute",AVATAR_FULL_SIZE:"Avatar--fullSize"},t.avatarDeprecated={GROUP_AVATAR:"group",SHOW_PRESENCE:"presence"},t.presence={BLOCKED:"blocked"},t.contacts={CONTACT_TILE:"contactTile",TILE_NAME:"tileName"},t.discoverAgents={PAGE:"DiscoverAgentsPage"},t.base={SWX:"swx",DESKTOP:"desktop",OVERLAY_CONTAINER:"overlayContainer"},t.educationBubbles={PREFIX:"EducationBubble--",LARGE:"EducationBubble--large"}})),define("utils/common/statusMapper",["require","exports","module","swx-enums","swx-i18n","swx-service-locator-instance","swx-constants"],(function(e,t){var n=e("swx-enums"),i=e("swx-i18n").localization,r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON
	function a(e,t){return e.toLowerCase()===t.toLowerCase()}function s(e,t){return e&&t===n.endpointType.Mobile}function c(e){return a(e,n.onlineStatus.Idle)||a(e,n.onlineStatus.Away)||a(e,n.onlineStatus.BeRightBack)||a(e,n.onlineStatus.OutForLunch)}function l(e){return a(e,n.onlineStatus.Online)}t.getStatusIconClass=function(e,t,i){return e?l(e)?n.onlineStatus.Online.toLowerCase():function(e){return a(e,n.onlineStatus.Hidden)||a(e,n.onlineStatus.Offline)}(e)?n.onlineStatus.Offline.toLowerCase():c(e)?s(i,t)?n.endpointType.Mobile.toLowerCase():n.onlineStatus.Idle.toLowerCase():function(e){return a(e,n.onlineStatus.Busy)||a(e,n.onlineStatus.OnThePhone)}(e)?n.onlineStatus.Busy.toLowerCase():function(e){return a(e,n.onlineStatus.DoNotDisturb)}(e)?n.onlineStatus.DoNotDisturb.toLowerCase():e.toLowerCase():""},t.getAvailabilityText=function(e,t,a){switch(e){case n.onlineStatus.Online:return r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.USE_BUSINESS_WORDING)?i.fetch({key:"message_text_presenceAvailable"}):i.fetch({key:"message_text_presenceOnline"})
	case n.onlineStatus.Offline:case n.onlineStatus.Hidden:return i.fetch({key:"message_text_presenceOffline"})
	case n.onlineStatus.BeRightBack:case n.onlineStatus.OutForLunch:case n.onlineStatus.Away:case n.onlineStatus.Idle:return s(a,t)?i.fetch({key:"message_text_presenceMobile"}):i.fetch({key:"message_text_presenceAway"})
	case n.onlineStatus.DoNotDisturb:return i.fetch({key:"message_text_presenceDoNotDisturb"})
	case n.onlineStatus.OnThePhone:case n.onlineStatus.Busy:return i.fetch({key:"message_text_presenceBusy"})
	case n.onlineStatus.Unknown:return i.fetch({key:"message_text_presenceUnknown"})
	default:return null}},t.getMeAvailabilityText=function(e){switch(e){case n.onlineStatus.Online:return i.fetch({key:"message_text_presenceOnline"})
	case n.onlineStatus.Offline:return i.fetch({key:"message_text_presenceOffline"})
	case n.onlineStatus.Hidden:return i.fetch({key:"message_text_presenceHidden"})
	case n.onlineStatus.BeRightBack:case n.onlineStatus.OutForLunch:case n.onlineStatus.Away:case n.onlineStatus.Idle:return i.fetch({key:"message_text_presenceAway"})
	case n.onlineStatus.DoNotDisturb:return i.fetch({key:"message_text_presenceDoNotDisturb"})
	case n.onlineStatus.OnThePhone:case n.onlineStatus.Busy:return i.fetch({key:"message_text_presenceBusy"})
	default:return null}},t.isNotificationOn=function(e){return l(e)||c(e)}})),define("ui/modelHelpers/activities",{"in-a-meeting":"inAMeeting","urgent-interruptions-only":"urgentInterruptionsOnly","on-the-phone":"onThePhone","in-a-conference":"inAConference","off-work":"offWork","out-of-office":"outOfOffice",presenting:"presenting"}),define("ui/modelHelpers/activityMapper",["require","exports","module","swx-i18n","ui/modelHelpers/activities"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/modelHelpers/activities")
	t.map=function(e){return i[e]?n.fetch({key:"message_text_activity_"+i[e]}):e}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-g11n/lib/formatter",["require","exports"],e)}((function(e,t){var n=/dName|dAbbr|mName|mAbbr|dd|d|MM|M|yyyy|yy|HH|H|hh|h|mm|m|tt|ss|s|'[^']*'|'[^']*'/g
	t.formatDate=function(e,t,i){var r=i.calendar,o=i.time,a=r.days,s=r.months
	return t.replace(n,(function(t){var n
	switch(t){case"dName":n=a.names[e.getDay()]
	break
	case"dAbbr":n=a.namesAbbr[e.getDay()]
	break
	case"mName":n=s.names[e.getMonth()]
	break
	case"mAbbr":n=s.namesAbbr[e.getMonth()]
	break
	case"tt":n=e.getHours()<12?o.AM:o.PM
	break
	case"yyyy":n=e.getFullYear()
	break
	case"yy":n=e.getFullYear()%100
	break
	case"d":n=e.getDate()
	break
	case"dd":1===(n=e.getDate()).toString().length&&(n="0"+n)
	break
	case"M":n=e.getMonth()+1
	break
	case"MM":1===(n=e.getMonth()+1).toString().length&&(n="0"+n)
	break
	case"h":n=e.getHours()%12||12
	break
	case"hh":1===(n=e.getHours()%12||12).toString().length&&(n="0"+n)
	break
	case"H":n=e.getHours()
	break
	case"HH":1===(n=e.getHours()).toString().length&&(n="0"+n)
	break
	case"m":n=e.getMinutes()
	break
	case"mm":1===(n=e.getMinutes()).toString().length&&(n="0"+n)
	break
	case"s":n=e.getSeconds()
	break
	case"ss":1===(n=e.getSeconds()).toString().length&&(n="0"+n)}return void 0!==n?n:t.slice(1,t.length-1)}))},t.formatDuration=function(e,t){var i,r
	return function(e){return/HH|H|hh|h/.test(e)}(t)&&(i=Math.floor(e/60/60),e-=60*i*60),function(e){return/mm|m/.test(e)}(t)&&(r=Math.floor(e/60),e-=60*r),t.replace(n,(function(t){var n
	switch(t){case"h":case"H":n=i
	break
	case"hh":case"HH":1===(n=i).toString().length&&(n="0"+n)
	break
	case"m":n=r
	break
	case"mm":1===(n=r).toString().length&&(n="0"+n)
	break
	case"s":n=e
	break
	case"ss":1===(n=e).toString().length&&(n="0"+n)}return void 0!==n?n:t.slice(1,t.length-1)}))}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-g11n/lib/settings",["require","exports"],e)}((function(e,t){var n={calendar:{days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December"],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},firstDay:0},time:{AM:"am",PM:"pm",separator:":",format:{duration:"mm:ss",short:"h:mm tt",long:"h:mm:ss tt"}},date:{separator:"/",format:{dayMonth:"M/d",dayMonthYear:"M/d/yy",dayAbbr:"dAbbr",dayName:"dName",dateAbbr:"mAbbr d yyyy",shortDateAbbr:"mAbbr d"}},dir:"ltr"}
	t.set=function(e){n=e},t.get=function(){return n}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-g11n/lib/globalization",["require","exports","swx-browser-globals","./formatter","./settings"],e)}((function(e,t){var n=e("swx-browser-globals"),i=e("./formatter"),r=e("./settings")
	function o(e,t){e.dir||(e.dir=t)}t.init=function(e){r.set(e)},t.initLocaleDirection=function(e){var t=n.getDocument().documentElement
	t.dir?o(e,t.dir):r.get().dir&&o(e,r.get().dir)},t.formatDate=function(e,t){var n=r.get().time.format[t]
	if(n||(n=r.get().date.format[t]),!n)throw new Error("No format found with a key:"+t+"in settings of:"+_stringify(r.get().date.format))
	return i.formatDate(e,n,r.get())},t.formatDuration=function(e,t){var n=r.get().time.format[t]
	if(!n)throw new Error("No format found with a key:"+t+"in settings of:"+_stringify(r.get().time.format))
	return i.formatDuration(e,n)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-g11n/lib/index",["require","exports","./formatter","./globalization","./settings"],e)}((function(e,t){var n=e("./formatter")
	t.formatter=n
	var i=e("./globalization")
	t.globalization=i
	var r=e("./settings")
	t.settings=r})),define("swx-g11n",["swx-g11n/lib/index"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/conversation",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	function i(e,t){return Promise.all(n.map(e,(function(e){var n=t.createParticipant(e)
	return t.participants.add(n)})))}t.isGuestHostConversation=function(e){return!(!e||!e.indexOf)&&!!(e.indexOf("guesthost_")>-1)},t.createConversation=function(e,t,n){return e.length>1||n?function(e,t){var n=t.createConversation()
	return i(e,n),n}(e,t):function(e,t){return t.getConversation(e)}(e[0],t)},t.addPersonsToConversation=i,t.getParticipantFromConversation=function(e,t){return e.participants.filter((function(e){return e.person.id()===t}))(0)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/conversationCache",["require","exports"],e)}((function(e,t){var n=[]
	t.forModel=function(e){var t=n.filter((function(t){return t.model===e}))[0]
	return t||(t={model:e},n.push(t)),t}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/dateTime",["require","exports","swx-i18n","swx-g11n","swx-constants","swx-browser-globals","swx-pubsub-instance"],e)}((function(e,t){var n,i=e("swx-i18n"),r=e("swx-g11n"),o=e("swx-constants"),a=e("swx-browser-globals"),s=e("swx-pubsub-instance"),c=6e4,l=36e5,u=864e5,d=o.COMMON.globalizationFormatKeys,p=o.COMMON.events.system.DATE_CHANGED
	function f(e){return 0===e||e>0&&!0!==e}function m(e,n){var i=t.getDate(e)
	return r.globalization.formatDate(i,n)}function h(){var e,i
	a.getWindow().setTimeout((function(){(function(){var e=t.getDate()
	e.setHours(0,0,0,0)
	var i=n<e
	return i&&(n=e),i})()&&s.default.publish(p,null),h()}),(e=t.getDate(),i=e.getTime(),e.setHours(24,0,0,0)-i+1e3))}function v(e,n){void 0===n&&(n=null)
	var i=n?t.getDate(n):t.getDate(),r=i.setDate(i.getDate()-e)
	return t.getDate(r).setHours(0,0,0,0)}t.amNotifyingDayChange=!1,t.now=function(){return a.getWindow().Date.now()},t.getDate=function(e){void 0===e&&(e=null)
	var t=a.getWindow().Date
	return null!==e?new t(e):new t},t.formatDate=function(e){return f(e)?m(e,function(e){var n=t.getDate(e).getFullYear(),i=t.getDate().getFullYear()
	return n===i?d.date.SHORT_DATE_ABBREVIATION:d.date.DATE_ABBREVIATION}(e)):""},t.formatTimestampShort=function(e){return f(e)?m(e,d.time.SHORT):""},t.formatTimestamp=function(e,n){if(void 0===n&&(n=null),f(e)){var i=function(e,t){var n=d.time.SHORT,i=e<v(6,t),r=e<t
	i?n=d.date.DAY_MONTH:r&&(n=d.date.DAY_ABBREVIATION)
	return n}(e,n||t.getMidnight(t.getDate().getTime()))
	return m(e,i)}return""},t.formatTimestampLong=function(e,n){if(void 0===n&&(n=null),f(e)){var r=t.formatTimestampShort(e)
	return e<(n||t.getMidnight(t.getDate().getTime()))?i.localization.fetch({key:"message_text_longTimeStamp",params:{date:t.formatDate(e),time:r}}):r}return""},t.formatTimestampForceLong=function(e){if(f(e)){var n=t.formatTimestampShort(e)
	return i.localization.fetch({key:"message_text_longTimeStamp",params:{date:t.formatDate(e),time:n}})}return""},t.getDateGroup=function(e){if(f(e)){var n=t.getDate(e),o=t.getMidnight(e),a=t.getDate().setHours(0,0,0,0),s=v(1),c=v(7)
	return o===a?i.localization.fetch({key:"today"}):o===s?i.localization.fetch({key:"yesterday"}):o<c?i.localization.fetch({key:"olderThanAWeek"}):r.globalization.formatDate(n,d.date.DAY_NAME)}return""},t.getMidnight=function(e){return f(e)?t.getDate(e).setHours(0,0,0,0):0},t.formatCallDuration=function(e){return r.globalization.formatDuration(e,d.time.CALL_DURATION)},t.notifyOnDayChange=function(){t.amNotifyingDayChange||(t.amNotifyingDayChange=!0,(n=t.getDate()).setHours(0,0,0,0),h())},t.getTimeSinceTimestamp=function(e,n){if(void 0===n&&(n=null),(n=n||{}).now=n.now||t.now(),n.key=n.key||"duration",e&&f(e.getTime())&&f(n.now)){var r=n.now-e.getTime()
	return Math.floor(r/u)>0?i.localization.fetch({key:n.key+"_days",count:Math.floor(r/u),params:n.params}):Math.floor(r/l)>0?i.localization.fetch({key:n.key+"_hours",count:Math.floor(r/l),params:n.params}):Math.floor(r/c)>0?i.localization.fetch({key:n.key+"_minutes",count:Math.floor(r/c),params:n.params}):i.localization.fetch({key:n.key+"_moment",params:n.params})}return""}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/countryCodes",["require","exports"],e)}((function(e,t){t.CountryCodes={eu:"Europe",uk:"United Kingdom",af:"Afghanistan",ax:"&Aring;land Islands",al:"Albania",dz:"Algeria",as:"American Samoa",ad:"Andorra",ao:"Angola",ai:"Anguilla",aq:"Antarctica",ag:"Antigua and Barbuda",ar:"Argentina",am:"Armenia",aw:"Aruba",au:"Australia",at:"Austria",az:"Azerbaijan",bs:"Bahamas",bh:"Bahrain",bd:"Bangladesh",bb:"Barbados",by:"Belarus",be:"Belgium",bz:"Belize",bj:"Benin",bm:"Bermuda",bt:"Bhutan",bo:"Bolivia, Plurinational State of",ba:"Bosnia and Herzegovina",bw:"Botswana",bv:"Bouvet Island",br:"Brazil",io:"British Indian Ocean Territory",bn:"Brunei Darussalam",bg:"Bulgaria",bf:"Burkina Faso",bi:"Burundi",kh:"Cambodia",cm:"Cameroon",ca:"Canada",cv:"Cabo Verde",ky:"Cayman Islands",cf:"Central African Republic",td:"Chad",cl:"Chile",cn:"China",cx:"Christmas Island",cc:"Cocos (Keeling) Islands",co:"Colombia",km:"Comoros",cg:"Congo",cd:"Congo, the Democratic Republic of the",ck:"Cook Islands",cr:"Costa Rica",ci:"C&ocirc;te d'Ivoire",hr:"Croatia",cu:"Cuba",cy:"Cyprus",cz:"Czech Republic",dk:"Denmark",dj:"Djibouti",dm:"Dominica",do:"Dominican Republic",ec:"Ecuador",eg:"Egypt",sv:"El Salvador",gq:"Equatorial Guinea",er:"Eritrea",ee:"Estonia",et:"Ethiopia",fk:"Falkland Islands (Malvinas)",fo:"Faroe Islands",fj:"Fiji",fi:"Finland",fr:"France",gf:"French Guiana",pf:"French Polynesia",tf:"French Southern Territories",ga:"Gabon",gm:"Gambia",ge:"Georgia",de:"Germany",gh:"Ghana",gi:"Gibraltar",gr:"Greece",gl:"Greenland",gd:"Grenada",gp:"Guadeloupe",gu:"Guam",gt:"Guatemala",gg:"Guernsey",gn:"Guinea",gw:"Guinea-Bissau",gy:"Guyana",ht:"Haiti",hm:"Heard Island and McDonald Islands",va:"Holy See (Vatican City State)",hn:"Honduras",hk:"Hong Kong",hu:"Hungary",is:"Iceland",in:"India",id:"Indonesia",ir:"Iran, Islamic Republic of",iq:"Iraq",ie:"Ireland",im:"Isle of Man",il:"Israel",it:"Italy",jm:"Jamaica",jp:"Japan",je:"Jersey",jo:"Jordan",kz:"Kazakhstan",ke:"Kenya",ki:"Kiribati",kp:"Korea, Democratic People's Republic of",kr:"Korea, Republic of",kw:"Kuwait",kg:"Kyrgyzstan",la:"Lao People's Democratic Republic",lv:"Latvia",lb:"Lebanon",ls:"Lesotho",lr:"Liberia",ly:"Libya",li:"Liechtenstein",lt:"Lithuania",lu:"Luxembourg",mo:"Macao SAR",mk:"Macedonia, the former Yugoslav Republic of",mg:"Madagascar",mw:"Malawi",my:"Malaysia",mv:"Maldives",ml:"Mali",mt:"Malta",mh:"Marshall Islands",mq:"Martinique",mr:"Mauritania",mu:"Mauritius",yt:"Mayotte",mx:"Mexico",fm:"Micronesia, Federated States of",md:"Moldova, Republic of",mc:"Monaco",mn:"Mongolia",me:"Montenegro",ms:"Montserrat",ma:"Morocco",mz:"Mozambique",mm:"Myanmar",na:"Namibia",nr:"Nauru",np:"Nepal",nl:"Netherlands",an:"Netherlands Antilles",nc:"New Caledonia",nz:"New Zealand",ni:"Nicaragua",ne:"Niger",ng:"Nigeria",nu:"Niue",nf:"Norfolk Island",mp:"Northern Mariana Islands",no:"Norway",om:"Oman",pk:"Pakistan",pw:"Palau",ps:"Palestinian Authority",pa:"Panama",pg:"Papua New Guinea",py:"Paraguay",pe:"Peru",ph:"Philippines",pn:"Pitcairn",pl:"Poland",pt:"Portugal",pr:"Puerto Rico",qa:"Qatar",re:"R&eacute;union",ro:"Romania",ru:"Russian Federation",rw:"Rwanda",bl:"Saint Barth&eacute;lemy",sh:"Saint Helena, Ascension and Tristan da Cunha",kn:"Saint Kitts and Nevis",lc:"Saint Lucia",mf:"Saint Martin (French part)",pm:"Saint Pierre and Miquelon",vc:"Saint Vincent and the Grenadines",ws:"Samoa",sm:"San Marino",st:"Sao Tome and Principe",sa:"Saudi Arabia",sn:"Senegal",rs:"Serbia",sc:"Seychelles",sl:"Sierra Leone",sg:"Singapore",sk:"Slovakia",si:"Slovenia",sb:"Solomon Islands",so:"Somalia",za:"South Africa",gs:"South Georgia and the South Sandwich Islands",es:"Spain",lk:"Sri Lanka",sd:"Sudan",sr:"Suriname",sj:"Svalbard and Jan Mayen",sz:"Swaziland",se:"Sweden",ch:"Switzerland",sy:"Syrian Arab Republic",tw:"Taiwan",tj:"Tajikistan",tz:"Tanzania, United Republic of",th:"Thailand",tl:"Timor-Leste",tg:"Togo",tk:"Tokelau",to:"Tonga",tt:"Trinidad and Tobago",tn:"Tunisia",tr:"Turkey",tm:"Turkmenistan",tc:"Turks and Caicos Islands",tv:"Tuvalu",ug:"Uganda",ua:"Ukraine",ae:"United Arab Emirates",gb:"United Kingdom",us:"United States",um:"United States Minor Outlying Islands",uy:"Uruguay",uz:"Uzbekistan",vu:"Vanuatu",ve:"Venezuela, Bolivarian Republic of",vn:"Viet Nam",vg:"Virgin Islands, British",vi:"Virgin Islands, U.S.",wf:"Wallis and Futuna",ye:"Yemen",zm:"Zambia",zw:"Zimbabwe"}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/aggregateEncoder",["require","exports","lodash-compat","./countryCodes"],e)}((function(e,t){var n,i=e("lodash-compat"),r=e("./countryCodes")
	function o(e,t){return void 0===e?t:e}(function(e){e[e.Element=1]="Element",e[e.Text=3]="Text"})(n||(n={})),t.build=function(e){var t=new a
	return t.init(e),t}
	var a=function(){function e(){this.xml=!0,this.countryCodes={},this.largeEmoticonClass="large",this.emoticonEncoder={},this.domTransformers=[],this.domDecoders=[],this._private={separators:{"   ":!0,"\n":!0,"\r":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0," ":!0,"　":!0},createMentionElement:function(e,t,n,i){var r=e.get().personsAndGroupsManager,o=n.match(/^\d+:/),a="mention"
	if(o&&(n=n.substring(o[0].length)),n===r.mePerson.id())i=r.mePerson.displayName(),a+=" me"
	else{var s=r.all.persons(n)
	s&&(i=s.displayName())}i=this.escapeXml(i)
	var c=t.createElement("span")
	c.setAttribute("title",n),c.textContent=i
	var l=t.createElement("i")
	return l.setAttribute("class",a),l.appendChild(c),l},createFlagElement:function(e,t,n){var i=e.createElement("span")
	return i.textContent=n,i.setAttribute("class","flag "+t),i.textContent="(flag:"+t+")",i},encapsulateInRootElement:function(e){for(var t;t!==e;)t=e,e=e.replace(/<\s*?root[\s\S]*?>.*?(<\s*?\/\s*?root\s*?>)?/gi,"")
	return"<root>"+e+"</root>"},decapsulateFromRootElement:function(e){return e.match(/<root ?\/>/)||7===e.length?"":e.substring(6,e.length-7)},parseXML:function(e){var t
	try{if(window.DOMParser){var n=new DOMParser
	n.async=!1,t=n.parseFromString(e,"text/xml")}else{var i=new ActiveXObject("Microsoft.XMLDOM")
	if(i.async=!1,i.loadXML(e))return i}}catch(o){return null}var r=t.parseError
	return r&&0!==r.errorCode||t.getElementsByTagName("parsererror").length>0?null:t},xmlToString:function(e){var t
	try{t=(new XMLSerializer).serializeToString(e)}catch(n){t=e.xml}return t},xmlEscapeMap:{"<":"&lt;",">":"&gt;","&":"&amp;",'"':"&quot;","'":"&apos;"},escapeXml:function(e){var t=this.xmlEscapeMap
	return e.replace(/[<>&"']/g,(function(e){return t[e]}))},unescapeXml:function(e){var t={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"}
	return e.replace(/&lt;|&gt;|&amp;|&quot;|&apos/g,(function(e){return t[e]}))}}}return e.prototype.init=function(e){e=e||{},this.app=e.app,this.xml=o(e.xml,this.xml),this.countryCodes=o(e.countries,r.CountryCodes),this.largeEmoticonClass=o(e.largeEmoticonClass,this.largeEmoticonClass),this.emoticonEncoder=o(e.emoticonEncoder,this.emoticonEncoder),e.domTransformers&&e.domTransformers.length&&(this.domTransformers=this.domTransformers.concat(e.domTransformers)),e.domDecoders&&e.domDecoders.length&&(this.domDecoders=this.domDecoders.concat(e.domDecoders))},e.prototype.encode=function(e,t){void 0===t&&(t=!0)
	var n=new DOMParser
	if("string"!=typeof e)throw new TypeError("Text parameter must be of type string.")
	var r=t?i.escape(e):e
	try{var o=n.parseFromString(r,"text/html")
	if(0!==o.getElementsByTagName("parsererror").length)throw new Error("ParserError")
	return this.domTransformers.forEach((function(e){try{e.transformRawToXml(o,o.body)}catch(t){}})),function(e){var t=e.implementation.createDocument(e.body.namespaceURI,"message",null)
	for(;0!==e.body.childNodes.length;)t.childNodes[0].appendChild(e.body.childNodes[0])
	return t.childNodes[0].outerHTML.replace(/(?:^<message.*?>|<\/message>$)/g,"").replace(/&nbsp;/g," ")}(o)}catch(a){return r}},e.prototype.decode=function(e){var t,n,i=this
	function r(e,t){t.parentNode&&t.parentNode.replaceChild(e,t)}try{var o=this._private.parseXML(this._private.encapsulateInRootElement(e))
	if(o)return n=o.documentElement,function(){var e=n.getElementsByTagName("flag"),a=[]
	for(t=0;t<e.length;++t){var s=i._private.createFlagElement(o,e[t].getAttribute("country"),e[t].textContent)
	a.push([s,e[t]])}for(t=0;t<a.length;++t)r(a[t][0],a[t][1])}(),function(){var e=n.getElementsByTagName("ss"),a=[],s=e.length<=3&&e.length>0
	if(s)for(t=0;t<n.childNodes.length;++t){var c=0===n.childNodes[t].textContent.replace(" ","").length
	s=s&&("ss"===n.childNodes[t].tagName||c)}var l=e.length>20
	for(t=0;t<e.length;++t){var u=i.emoticonEncoder.createHtmlElement(o,e[t].getAttribute("type"),e[t].textContent,s,l,i.largeEmoticonClass)
	u&&a.push([u,e[t]])}for(t=0;t<a.length;++t)r(a[t][0],a[t][1])}(),function(){if(i.app){var e=n.getElementsByTagName("at"),a=[]
	for(t=0;t<e.length;++t){var s=i._private.createMentionElement(i.app,o,e[t].getAttribute("id"),e[t].textContent)
	a.push([s,e[t]])}for(t=0;t<a.length;++t)r(a[t][0],a[t][1])}}(),this.domDecoders.forEach((function(e){try{e.transformRawToXml(o,n)}catch(t){}})),this.emoticonEncoder.fixInvalidHtml(this._private.decapsulateFromRootElement(this._private.xmlToString(o)))}catch(a){console.error(a.stack)}return e},e.prototype.escapeXml=function(e){return this._private.escapeXml(e)},e.prototype.getNodeTextContent=function(e){var t=this._private.parseXML(this._private.encapsulateInRootElement(e))
	return t&&t.documentElement?t.documentElement.textContent:e},e.prototype.firstLetter=function(e,t){for(var n=t=o(t,0);n<e.length;++n)if(!this._private.separators[e[n]])return n
	return-1},e.prototype.firstSeparator=function(e,t){for(var n=t=o(t,0);n<e.length;++n)if(this._private.separators[e[n]])return n
	return-1},e}()})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-emoticon-map-instance/lib/map",["require","exports"],e)}((function(e,t){t.map={":)":"smile",":-)":"smile",":=)":"smile","(smile)":"smile",":(":"sad",":-(":"sad",":=(":"sad","(sad)":"sad",":<":"sad",":-<":"sad",":D":"laugh",":-D":"laugh",":=D":"laugh",":d":"laugh",":-d":"laugh",":=d":"laugh","(laugh)":"laugh",":>":"laugh",":->":"laugh","(lol)":"laugh","(LOL)":"laugh","(cool)":"cool","8-)":"cool","8=)":"cool","B-)":"cool","B=)":"cool",":O":"surprised",":-O":"surprised",":=O":"surprised",":o":"surprised",":-o":"surprised",":=o":"surprised","(surprised)":"surprised",";)":"wink",";-)":"wink",";=)":"wink","(wink)":"wink",";(":"cry",";-(":"cry",";=(":"cry","(cry)":"cry",":'(":"cry","(:|":"sweat","(sweat)":"sweat",":|":"speechless",":-|":"speechless",":=|":"speechless","(speechless)":"speechless","(kiss)":"kiss",":*":"kiss",":-*":"kiss",":=*":"kiss","(xo)":"kiss","(K)":"kiss","(k)":"kiss",":P":"tongueout",":-P":"tongueout",":=P":"tongueout",":p":"tongueout",":-p":"tongueout",":=p":"tongueout","(tongueout)":"tongueout",":$":"blush",":-$":"blush",":=$":"blush",':">':"blush","(blush)":"blush",":^)":"wonder","(wonder)":"wonder","|-)":"sleepy","I-)":"sleepy","I=)":"sleepy","(snooze)":"sleepy","|-(":"dull","|(":"dull","|=(":"dull","(dull)":"dull","(inlove)":"inlove","(love)":"inlove",":]":"inlove",":-]":"inlove","]:)":"eg",">:)":"eg","(grin)":"eg","(yn)":"fingerscrossed","(fingers)":"fingerscrossed","(fingerscrossed)":"fingerscrossed","(crossedfingers)":"fingerscrossed","(yawn)":"yawn","(puke)":"puke",":&":"puke",":-&":"puke",":=&":"puke","+o(":"puke","(doh)":"doh","(angry)":"angry",":@":"angry",":-@":"angry",":=@":"angry","x(":"angry","x-(":"angry","X(":"angry","X-(":"angry","x=(":"angry","X=(":"angry",";@":"angry",";-@":"angry","(wasntme)":"wasntme","(wm)":"wasntme","(party)":"party","<O)":"party","<o)":"party","<:o)":"party","(worry)":"worry",":S":"worry",":s":"worry",":-s":"worry",":-S":"worry",":=s":"worry",":=S":"worry","(mm)":"mmm","(mmm)":"mmm","(mmmm)":"mmm","(nerd)":"nerdy","8-|":"nerdy","B-|":"nerdy","8|":"nerdy","B|":"nerdy","8=|":"nerdy","B=|":"nerdy",":x":"lipssealed",":-x":"lipssealed",":X":"lipssealed",":-X":"lipssealed",":#":"lipssealed",":-#":"lipssealed",":=x":"lipssealed",":=X":"lipssealed",":=#":"lipssealed","(wave)":"hi","(hi)":"hi","(bye)":"hi","(BYE)":"hi","(Bye)":"hi","(Hi)":"hi","(HI)":"hi","(facepalm)":"facepalm","(fail)":"facepalm","(devil)":"devil","(6)":"devil","(angel)":"angel","(A)":"angel","(a)":"angel","(envy)":"envy","(V)":"envy","(v)":"envy","(wait)":"wait","(hug)":"hug","(bear)":"hug","(makeup)":"makeup","(kate)":"makeup","(chuckle)":"giggle","(giggle)":"giggle","(clap)":"clap","(think)":"think",":-?":"think",":?":"think",":=?":"think","*-)":"think","(bow)":"bow","(rofl)":"rofl","(rotfl)":"rofl","(whew)":"whew","(phew)":"whew","(happy)":"happy","(smirk)":"smirk","(nod)":"nod","(shake)":"shake","(waiting)":"waiting","(forever)":"waiting","(impatience)":"waiting","(emo)":"emo","(y)":"yes","(Y)":"yes","(ok)":"yes","(yes)":"yes","(OK)":"yes","(oK)":"yes","(Ok)":"yes","(n)":"no","(N)":"no","(no)":"no","(handshake)":"handshake","(highfive)":"highfive","(hifive)":"highfive","(h5)":"highfive","(heart)":"heart","(h)":"heart","(H)":"heart","(l)":"heart","(L)":"heart","<3":"heart","(lalala)":"lalala","(lalalala)":"lalala","(lala)":"lalala","(notlistening)":"lalala","(heidy)":"heidy","(squirrel)":"heidy","(F)":"flower","(f)":"flower","(flower)":"flower","(rain)":"rain","(london)":"rain","(st)":"rain","(ST)":"rain","(St)":"rain","(sun)":"sun","(#)":"sun","(tumbleweed)":"tumbleweed","(music)":"music","(8)":"music","(bandit)":"bandit","(tmi)":"tmi","(coffee)":"coffee","(c)":"coffee","(C)":"coffee","(pi)":"pizza","(pizza)":"pizza","(cash)":"cash","(mo)":"cash","($)":"cash","(flex)":"muscle","(muscle)":"muscle","(^)":"cake","(cake)":"cake","(beer)":"beer","(bricklayers)":"beer","(B)":"beer","(b)":"beer","(d)":"drink","(D)":"drink","(drink)":"drink","\\o/":"dance","\\:D/":"dance","\\:d/":"dance","(dance)":"dance","(ninja)":"ninja","(J)":"ninja","(j)":"ninja","(*)":"star","(star)":"star","(headbang)":"headbang","(banghead)":"headbang","(swear)":"swear","(drunk)":"drunk","(finger)":"finger","(poolparty)":"poolparty","(hrv)":"poolparty","(rock)":"rock","(smoking)":"smoke","(smoke)":"smoke","(ci)":"smoke","(bug)":"bug","(toivo)":"toivo","(wfh)":"wfh","(@h)":"wfh","(@H)":"wfh","(hollest)":"hollest","(zilmer)":"priidu","(e)":"mail","(m)":"mail","(mail)":"mail","(E)":"mail","(o)":"time","(O)":"time","(time)":"time","(clock)":"time","(0)":"time","(~)":"movie","(film)":"movie","(movie)":"movie","(mp)":"phone","(ph)":"phone","(phone)":"phone","(talk)":"talk","(call)":"call","(T)":"call","(t)":"call","(punch)":"punch","*|":"punch","*-|":"punch","(skype)":"skype","(ss)":"skype","(u)":"brokenheart","(U)":"brokenheart","(brokenheart)":"brokenheart","(mooning)":"mooning","(oliver)":"oliver","(bartlett)":"bertlett","(football)":"bertlett","(soccer)":"bertlett","(so)":"bertlett","(talktothehand)":"talktothehand","(idea)":"idea",":i":"idea",":I":"idea","*-:)":"idea","(sheep)":"sheep","(bah)":"sheep","(cat)":"cat",":3":"cat","(@)":"cat","(meow)":"cat","(bike)":"bike","(bicycle)":"bike","(sander)":"bike","(dog)":"dog",":o3":"dog","(&)":"dog"},t.maxLength=16,t.minLength=2,t.firstLetters="8:(B;|I]>+xX<*\\",t.firstLettersMap={8:"8",":":":","(":"(",B:"B",";":";","|":"|",I:"I","]":"]",">":">","+":"+",x:"x",X:"X","<":"<","*":"*","\\":"\\"}})),define("swx-emoticon-map-instance",["swx-emoticon-map-instance/lib/map"],(function(e){return e}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/domTransformers",["require","exports","lodash-compat","./countryCodes"],e)})((function(e,t){var n=e("lodash-compat"),i=e("./countryCodes"),r=function(){function e(){}return e.prototype.transformRawToXml=function(e,t){var n=[]
	for(n.push(t);0!==n.length;){var i=n.pop()
	i.nodeType===Node.TEXT_NODE?this.encodeTextNodeToXml(e,i):"pre"!==i.nodeName.toLowerCase()&&this.isElementAllowed(i)&&this.pushChildNodes(n,i)}},e.prototype.encodeTextNodeToXml=function(e,t){var n=t.parentNode,i=this.encodeWords(e,t)
	if(0!==i.length){for(var r=0;r<i.length;r++)n.insertBefore(i[r],t)
	n.removeChild(t)}},e.prototype.encodeWords=function(e,t){var i=this,r=t.nodeValue,o=this.getAllWords(r),a=0,s=[]
	return o.forEach((function(t){var o=i.wordRawToXml(e,t[0])
	n.isUndefined(o)||0===o.length||(a!==t.index&&s.push(e.createTextNode(r.substring(a,t.index))),a=t.index+t[0].length,s=s.concat(o))})),0!==a&&a<r.length&&s.push(e.createTextNode(r.substring(a))),s},e.prototype.getAllWords=function(e){for(var t,n=this.wordMatcher(),i=[];null!==(t=n.exec(e));)i.push(t)
	return i},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e.prototype.wordMatcher=function(){return/[\w()#:\-=<>\u2329\u232A;'\|\$"\]\*\^&\+@\{\?Ǝ\/\\!~]+/g},e}()
	t.WordDomTransformer=r
	var o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.build=function(){return new t},t.prototype.isElementAllowed=function(e){return"span"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("flag")},t.prototype.wordRawToXml=function(e,t){var n=t.match(/^\(flag:([A-Za-z]{2})\)$/i),r=n&&n[1].toLowerCase()
	return r&&i.CountryCodes[r]?[this.createXmlElement(e,r,t)]:[]},t.prototype.createXmlElement=function(e,t,n){var i=e.createElement("flag")
	return i.setAttribute("country",t),i.innerText=n,i},t}(r)
	t.FlagDomTransformer=o
	var a=function(e){function t(t){var n=e.call(this)||this
	return n.isOutgoing=t,n}return __extends(t,e),t.build=function(e){return void 0===e&&(e=!1),new t(e)},t.prototype.isElementAllowed=function(e){return"a"!==e.nodeName.toLowerCase()},t.prototype.wordRawToXml=function(e,t){var n=t.match(/^(\()?(.*?)((\.|\?|\!|\))+)?$/i),i=n[1],r=n[2],o=n[3],a=r.match(/^(?:https?:\/\/|mailto:)(.+)$/i),s=a&&a[0]
	if(s||(s=(a=r.match(/^[^@]+@(?:\w+(?:\.\w+)+)$/i))&&"mailto:"+a[0]),s||(s=(a=r.match(/^www\.\S+$/i))&&"http://"+a[0]),s){var c=[]
	return i&&c.push(e.createTextNode(i)),c.push(this.createXmlElement(e,s,r)),o&&c.push(e.createTextNode(o)),c}return[]},t.prototype.createXmlElement=function(e,t,n){var i=e.createElement("a")
	return i.setAttribute("href",t),this.isOutgoing||(i.setAttribute("title",t),i.setAttribute("target","_blank"),i.setAttribute("tabindex","-1")),i.innerText=n,i},t.prototype.wordMatcher=function(){return/\S+/g},t}(r)
	t.URLDomTransformer=a
	var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.build=function(){return new t},t.prototype.isElementAllowed=function(e){return"pre"!==e.nodeName.toLowerCase()},t.prototype.getAllWords=function(e){for(var t,n=/\r?\n/g,i=[];null!==(t=n.exec(e));)i.push(t)
	return i},t.prototype.wordRawToXml=function(e,t){return[this.createXmlElement(e)]},t.prototype.createXmlElement=function(e){return e.createElement("br")},t}(r)
	t.NewLineDomTransformer=s
	var c=function(){function e(){}return e.prototype.transformRawToXml=function(e,t){var n=[]
	for(n.push(t);0!==n.length;){var i=n.pop()
	this.isDesiredElement(i)?this.visitElement(e,i):i.nodeType===Node.ELEMENT_NODE&&this.pushChildNodes(n,i)}},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e}()
	t.ElementVisitor=c}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/emoticonEncoder",["require","exports","swx-constants","swx-emoticon-map-instance","swx-service-locator-instance","../domTransformers","swx-cafe-application-instance"],e)})((function(e,t){var n=e("swx-constants"),i=e("swx-emoticon-map-instance"),r=e("swx-service-locator-instance"),o=e("../domTransformers"),a=e("swx-cafe-application-instance"),s=/^\w$/
	function c(e,t,n){var i=e.createElement("ss")
	return i.setAttribute("type",t),i.innerText=n,i}var l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isElementAllowed=function(e){return"span"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("emoticon")},t.prototype.wordRawToXml=function(e,t){for(var n,r=[],o=0,a=0;a<t.length;a++){for(var l=void 0,u=-1,d=a+1;d<t.length+1;d++){var p=t.substring(a,d),f=i.map.hasOwnProperty(p)&&i.map[p]
	f&&(n=t[d],!s.test(n))&&(l=f,u=d)}l&&(o!==a&&r.push(e.createTextNode(t.substring(o,a))),o=u,r.push(c(e,l,t.substring(a,u))),a=u-1)}return 0!==o&&o<t.length&&r.push(e.createTextNode(t.substring(o))),r},t}(o.WordDomTransformer)
	t._EmoticonEncoder=l
	var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createHtmlElement=function(e,t,n,i,r,o){var a=e.createElement("span"),s=["emoticon"]
	s.push(t),r||s.push("animated"),i&&s.push(o),a.setAttribute("class",s.join(" "))
	var c=e.createElement("span")
	return c.textContent=n,c.setAttribute("class","emoSprite"),a.appendChild(c),a},t.prototype.fixInvalidHtml=function(e){return e.replace(/<span class="emoSprite"\s*\/>/g,'<span class="emoSprite"></span>')},t.prototype.hasEmoticons=function(e){return e.indexOf('<span class="emoSprite">')>-1},t.prototype.hasLargeEmoticon=function(e){return/<span class="emoticon\s?\w*\s?(animated)?\s+\w*large"><span class="emoSprite">.*<\/span><\/span>/i.test(e)},t}(l)
	t._SpanEmoticonEncoder=u
	var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.canShowLargeEmoticon=function(){var e=a.get().personsAndGroupsManager.mePerson.preferences(n.COMMON.userSettings.preferences.SHOW_LARGE_EMOTICONS)
	return e?e.value():null},t.prototype.canShowAnimatedEmoticon=function(){var e=a.get().personsAndGroupsManager.mePerson.preferences(n.COMMON.userSettings.preferences.SHOW_ANIMATED_EMOTICONS)
	return e?e.value():null},t.prototype.createHtmlElement=function(e,t,r,o,s,c){var l=e.createElement("span"),u=e.createElement("canvas"),d=["emoticon"],p=a.get().personsAndGroupsManager.mePerson,f=p.preferences(n.COMMON.userSettings.preferences.SHOW_ANIMATED_EMOTICONS),m=p.preferences(n.COMMON.userSettings.preferences.SHOW_LARGE_EMOTICONS),h=a.get().personsAndGroupsManager.mePerson.preferences(n.COMMON.userSettings.preferences.SHOW_EMOTICONS),v=!h||h.value()
	if(t&&i.map.hasOwnProperty(r)&&v)return u.setAttribute("data-item-id",t),u.textContent=r,!s&&(f&&this.canShowAnimatedEmoticon()||!f)&&u.setAttribute("data-is-animated","true"),o&&(m&&this.canShowLargeEmoticon()||!m)&&d.push(c),m&&m.value.get().then((function(e){if(!1===e){var t=d.indexOf(c,0)
	t>-1&&(d.splice(t,1),l.setAttribute("class",d.join(" ")))}})),l.setAttribute("class",d.join(" ")),l.appendChild(u),l},t.prototype.fixInvalidHtml=function(e){return e.replace(/<canvas((?:\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*)\s*\/>/g,"<canvas$1></canvas>")},t.prototype.hasEmoticons=function(e){return e.indexOf("<canvas")>-1},t.prototype.hasLargeEmoticon=function(e){return/<span class="emoticon\s?\w*\s?(animated)?\s+\w*large"><canvas(\s?(data-[-a-z]*|height|width)="[a-z0-9]*")*>.*<\/canvas><\/span>/i.test(e)},t}(l)
	t._CanvasEmoticonEncoder=d,t.build=function(){return r.default.resolve(n.COMMON.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.COMMON.featureFlags.CANVAS_EMOTICONS_ENABLED)?new d:new u}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/markupDecoder",["require","exports","../domTransformers"],e)})((function(e,t){var n=e("../domTransformers"),i={b:"*",s:"~",i:"_"},r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isDesiredElement=function(e){var t=e.nodeType===Node.ELEMENT_NODE?e.nodeName.toLowerCase():"",n=e.nodeType===Node.ELEMENT_NODE?e.className.toLowerCase():""
	return""!==t&&("b"===t||"s"===t||"i"===t&&-1===n.indexOf("mention"))},t.prototype.visitElement=function(e,t){var n=t.parentNode,r=t.childNodes.length
	n.insertBefore(e.createTextNode(i[t.nodeName.toLowerCase()]),t)
	for(var o=0;o<r;o++)n.insertBefore(t.childNodes[0],t)
	n.insertBefore(e.createTextNode(i[t.nodeName.toLowerCase()]),t),n.removeChild(t)},t}(n.ElementVisitor)
	t.build=function(){return new r}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/mentionsDecoder",["require","exports","lodash-compat","swx-cafe-application-instance","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isDesiredElement=function(e){var t=e.nodeType===Node.ELEMENT_NODE?e.nodeName.toLowerCase():"",n=e.nodeType===Node.ELEMENT_NODE?e.className.toLowerCase():""
	return"i"===t&&-1!==n.indexOf("mention")},t.prototype.visitElement=function(e,t){var r=t.parentNode,o=1===t.childNodes.length&&t.childNodes[0]
	if(o){var a=o.title.toLowerCase(),s=i.get().personsAndGroupsManager.all.persons(),c=n.find(s,(function(e){return e.id().toLowerCase()===a})),l=c&&c.isAgent()?"("+c.displayName().replace(/(\(|\))/g,"")+")":o.title
	r.replaceChild(e.createTextNode("@"+l),t)}},t}(e("../domTransformers").ElementVisitor)
	t.build=function(){return new r}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/mentionsEncoder",["require","exports","lodash-compat","swx-cafe-application-instance","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("../domTransformers"),o=/(\(|\))/g,a=function(e){function t(t){var n=e.call(this)||this
	return n.conversation=t,n}return __extends(t,e),t.prototype.createXmlElement=function(e,t){var n=e.createElement("at")
	return n.setAttribute("id",t.type+":"+t.skypeId),n.innerText=t.defaultDisplayName,n},t.prototype.getMentionUserData=function(e){var t,r="",a={defaultDisplayName:"",displayName:"",skypeId:"",type:"",isMePerson:!1}
	if(e){var s=0===(e=e.toLowerCase()).indexOf("("),c=s?e.substring(1,e.length-1):"",l=i.get().personsAndGroupsManager.mePerson,u=i.get().personsAndGroupsManager.all.persons()
	if(this.conversation){var d=this.conversation.participants().map((function(e){return e.person}))
	u=u.concat(d)}if(a.isMePerson=e===l.id().toLowerCase()||s&&l.displayName().replace(o,"").toLowerCase()===c,t=a.isMePerson?l:n.find(u,(function(t){return t.id().toLowerCase()===e||s&&t.displayName().replace(o,"").toLowerCase()===c})))return a.skypeId=t.id(),a.type=t._type(),a.displayName=t.displayName(),t.firstName()&&(a.defaultDisplayName=t.firstName(),r=" "),t.lastName()&&(a.defaultDisplayName+=r+t.lastName()),a.defaultDisplayName||(a.defaultDisplayName=a.displayName),a}},t.prototype.isElementAllowed=function(e){return"i"!==e.nodeName.toLowerCase()||-1===e.className.toLowerCase().indexOf("mention")},t.prototype.wordRawToXml=function(e,t){for(var n,i=[],r=t.substring(1),o=/[\.,_:\-;?]$/,a=this.getMentionUserData(r);!a&&r.match(o);)n=r.charAt(r.length-1),r=r.substring(0,r.length-1),a=this.getMentionUserData(r)
	return a&&(i.push(this.createXmlElement(e,a)),n&&i.push(e.createTextNode(n))),i},t.prototype.wordMatcher=function(){return/@([a-z0-9\.,\-_:]+|\(.+?\))/gi},t}(r.WordDomTransformer)
	t.build=function(e){return new a(e)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/noTranslateDomTransformer",["require","exports"],e)}((function(e,t){var n=function(){function e(e){this.mode=e}return e.prototype.decorate=function(e,t){var n=t.parentNode,i=e.createElement("span")
	i.setAttribute("class","notranslate"),n.replaceChild(i,t),i.appendChild(t)},e.prototype.excludeFromTranslation=function(e){var t=e.nodeName.toLowerCase(),n=e.className.toLowerCase()
	return"ss"===t||"at"===t||"flag"===t||"a"===t||"span"===t&&(-1!==n.indexOf("emoticon")||-1!==n.indexOf("flag"))||"i"===t&&-1!==n.indexOf("mention")||"pre"===t},e.prototype.isNoTranslateElement=function(e){var t=e.nodeName.toLowerCase(),n=e.className.toLowerCase()
	return"span"===t&&-1!==n.indexOf("notranslate")},e.prototype.pushChildNodes=function(e,t){for(var n=0;n<t.childNodes.length;n++)e.push(t.childNodes[n])},e.prototype.removeElement=function(e,t){for(var n=t.parentNode,i=t.childNodes.length,r=0;r<i;r++)n.insertBefore(t.childNodes[0],t)
	n.removeChild(t)},e.prototype.transformRawToXml=function(t,n){var i,r,o=[]
	for(this.mode===e.Mode.Add?(i=this.excludeFromTranslation,r=this.decorate):(i=this.isNoTranslateElement,r=this.removeElement),o.push(n);0!==o.length;){var a=o.pop()
	a.nodeType===Node.ELEMENT_NODE&&i(a)?r(t,a):this.pushChildNodes(o,a)}},e}()
	n.Mode={Add:"add",Remove:"remove"},t.build=function(e){return new n(e)},t.Mode=n.Mode}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/quoteDecoder",["require","exports","lodash-compat","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.isDesiredElement=function(e){var t=e.nodeType===Node.ELEMENT_NODE?e.nodeName.toLowerCase():""
	return""!==t&&"quote"===t},t.prototype.visitElement=function(e,t){var i=t.parentNode,r=t,o=n.unescape(r.getAttribute("authorname")),a=r.getAttribute("timestamp"),s=e.createElement("div"),c=e.createElement("p"),l=e.createElement("a"),u=e.createElement("span")
	s.setAttribute("class","quotedText"),c.setAttribute("class","quoted")
	for(var d=r.childNodes.length;d>2;d--)c.appendChild(r.childNodes[1])
	s.appendChild(c),l.textContent=o+", ",l.setAttribute("class","author"),l.setAttribute("role","button"),l.setAttribute("author",r.getAttribute("author")),s.appendChild(l),this.timeFormat&&(u.textContent=this.timeFormat(1e3*Number(a))),u.setAttribute("class","time"),s.appendChild(u),i.insertBefore(s,t),i.removeChild(t)},t}(e("../domTransformers").ElementVisitor)
	t.QuoteDecoder=i,t.build=function(e){var t=new i
	return t.timeFormat=e,t}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/quoteEncoder",["require","exports","lodash-compat","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this
	return t.shouldMaintainLegacyQuote=!0,t.QUOTE_NODE="quote",t.AUTHOR_ATTR="author",t.AUTHOR_NAME_ATTR="authorname",t.CONVERSATION_ATTR="conversation",t.TIMESTAMP_ATTR="timestamp",t.LEGACY_QUOTE_NODE="legacyquote",t.LEGACY_ANNOTATION_TEXT_NODE="\r\n\r\n<<< ",t}return __extends(t,e),t.prototype.isElementAllowed=function(e){return"#text"!=e.nodeName},t.prototype.createXmlElement=function(e,t){if(!(n.isUndefined(t)||n.isUndefined(t.author)||n.isUndefined(t.authorName)||n.isUndefined(t.conversationId)||n.isUndefined(t.quoteMessage)||n.isUndefined(t.timestamp))){var i=e.createElement(this.QUOTE_NODE)
	i.setAttribute(this.AUTHOR_ATTR,t.author),i.setAttribute(this.AUTHOR_NAME_ATTR,t.authorName),i.setAttribute(this.CONVERSATION_ATTR,t.conversationId)
	var r=this.isValidTimestampString(t.timestamp)?Math.round(Date.parse(t.timestamp)/1e3).toString():""
	i.setAttribute(this.TIMESTAMP_ATTR,r)
	var o=e.createTextNode(t.quoteMessage)
	return this.shouldMaintainLegacyQuote?i=this.createAndAppendLegacyQuoteNode(e,t,i,o):i.appendChild(o),i}},t.prototype.isValidTimestampString=function(e){var t=new Date(e)
	return"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t.getTime())},t.prototype.getLegacyTimeStamp=function(e){if(this.isValidTimestampString(e)){var t=new Date(e)
	return t.toLocaleDateString()+" "+t.toLocaleTimeString()}return""},t.prototype.createElementWithText=function(e,t,n){var i=e.createElement(t)
	return i.textContent=n,i},t.prototype.createAndAppendLegacyQuoteNode=function(e,t,n,i){var r=this.getLegacyTimeStamp(t.timestamp),o=this.createElementWithText(e,this.LEGACY_QUOTE_NODE,"["+r+"] "+t.authorName+": ")
	n.appendChild(o),n.appendChild(i)
	var a=this.createElementWithText(e,this.LEGACY_QUOTE_NODE,this.LEGACY_ANNOTATION_TEXT_NODE)
	return n.appendChild(a),n},t.prototype.wordRawToXml=function(e,t){try{var i=[],r=JSON.parse(t),o=this.createXmlElement(e,r)
	return n.isUndefined(o)||i.push(o),i}catch(a){return[]}},t.prototype.wordMatcher=function(){return/{.*}/g},t}(e("../domTransformers").WordDomTransformer)
	t.QuoteEncoder=i,t.build=function(){return new i}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/codeSnippetEncoder",["require","exports","lodash-compat","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this
	return t.PRE_NODE="pre",t.RAW_PRE_ATTR="raw_pre",t.RAW_POST_ATTR="raw_post",t.CODE_WRAPPER_MATCHER=/(\{code})((?:.|[\r\n])*)(\{code})/g,t.GLOBAL_CODE_MATCHER=/^(!!)((?:.|[\r\n])*)$/g,t}return __extends(t,e),t.prototype.isElementAllowed=function(e){return e.nodeName.toLowerCase()!==this.PRE_NODE},t.prototype.createXmlElement=function(e,t,i,r){if(!i||n.isUndefined(t)||n.isNull(t))return null
	var o=e.createElement(this.PRE_NODE)
	return o.setAttribute(this.RAW_PRE_ATTR,i),r&&o.setAttribute(this.RAW_POST_ATTR,r),o.textContent=t,o},t.prototype.wordRawToXml=function(e,t){var n=this
	try{var i=[]
	return[this.GLOBAL_CODE_MATCHER,this.CODE_WRAPPER_MATCHER].forEach((function(r){var o=r.exec(t)
	null!==o&&o.length>=2&&0===i.length&&i.push(n.createXmlElement(e,o[2],o[1],o[3]))})),i}catch(r){return[]}},t.prototype.wordMatcher=function(){return/(\{code}(?:.|[\r\n])*\{code})|(^!!(?:.|[\r\n])*)$/g},t}(e("../domTransformers").WordDomTransformer)
	t.CodeSnippetEncoder=i,t.build=function(){return new i}}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},factory,root,context,definition,callback,domains,iFrameReference,host,eventRegistered,state,processing,settings,defaultSettings,_messageListener,_destroyIFrame,_callCallback,_getIFrameSource,setCallback,createIFrame;(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoders/codeSnippetDecoder",["require","exports","lodash-compat","../domTransformers"],e)})((function(e,t){var n=e("lodash-compat"),i=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this
	return t.PRE_NODE="pre",t.RAW_PRE_ATTR="raw_pre",t.RAW_POST_ATTR="raw_post",t.UNESCAPED_MATCHER=/<|>/g,t}return __extends(t,e),t.prototype.isDesiredElement=function(e){return(e.nodeType===Node.ELEMENT_NODE?e.nodeName.toLowerCase():"")===this.PRE_NODE},t.prototype.visitElement=function(e,t){var i=t.parentNode,r=t.childNodes.length,o=e.createElement(this.PRE_NODE),a=t.getAttribute(this.RAW_PRE_ATTR),s=t.getAttribute(this.RAW_POST_ATTR)
	a&&o.setAttribute(this.RAW_PRE_ATTR,a)
	for(var c=0;c<r;c++)o.appendChild(t.childNodes[0])
	s&&o.setAttribute(this.RAW_POST_ATTR,s),this.UNESCAPED_MATCHER.test(o.innerHTML)&&(o.innerHTML=n.escape(o.innerHTML)),i.insertBefore(o,t),i.removeChild(t)},t}(e("../domTransformers").ElementVisitor)
	t.CodeSnippetDecoder=i,t.build=function(){return new i}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/encoderFactory",["require","exports","lodash-compat","swx-constants","./encoders/emoticonEncoder","./encoders/codeSnippetEncoder","./aggregateEncoder","./domTransformers","./encoders/mentionsEncoder","swx-service-locator-instance"],e)}((function(e,t){var n=e("lodash-compat"),i=e("swx-constants"),r=e("./encoders/emoticonEncoder"),o=e("./encoders/codeSnippetEncoder"),a=e("./aggregateEncoder"),s=e("./domTransformers"),c=e("./encoders/mentionsEncoder"),l=e("swx-service-locator-instance")
	t.build=function(e,t){var u=l.default.resolve(i.COMMON.serviceLocator.FEATURE_FLAGS),d=n.extend({app:e},t),p=r.build(),f=s.FlagDomTransformer.build(),m=[]
	u.isFeatureOn(i.COMMON.featureFlags.CODE_SNIPPET_ENABLED)&&m.push(o.build()),m=m.concat([f,p]),u.isFeatureOn(i.COMMON.featureFlags.MENTIONS_ENABLED)&&m.push(c.build(t&&t.conversation))
	var h=d.domTransformers||m
	return t&&t.domTransformeExtensions&&(h=h.concat(t.domTransformeExtensions)),t&&t.domDecoders&&(d.domDecoders=t.domDecoders),u.isFeatureOn(i.COMMON.featureFlags.PES_USE_EXTRA_LARGE_EMOTICONS)&&(d.largeEmoticonClass="extraLarge"),d.emoticonEncoder=p,d.domTransformers=h,a.build(d)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-encoder/lib/index",["require","exports","./aggregateEncoder","./encoders/emoticonEncoder","./encoders/markupDecoder","./encoders/mentionsDecoder","./encoders/mentionsEncoder","./encoders/noTranslateDomTransformer","./encoders/quoteDecoder","./encoders/quoteEncoder","./encoders/codeSnippetEncoder","./encoders/codeSnippetDecoder","./countryCodes","./domTransformers","./encoderFactory"],e)}((function(e,t){var n=e("./aggregateEncoder")
	t.AggregateEncoder=n
	var i=e("./encoders/emoticonEncoder")
	t.EmoticonEncoder=i
	var r=e("./encoders/markupDecoder")
	t.MarkupDecoder=r
	var o=e("./encoders/mentionsDecoder")
	t.MentionDecoder=o
	var a=e("./encoders/mentionsEncoder")
	t.MentionEncoder=a
	var s=e("./encoders/noTranslateDomTransformer")
	t.NoTranslateDomTransformer=s
	var c=e("./encoders/quoteDecoder")
	t.QuoteDecoder=c
	var l=e("./encoders/quoteEncoder")
	t.QuoteEncoder=l
	var u=e("./encoders/codeSnippetEncoder")
	t.CodeSnippetEncoder=u
	var d=e("./encoders/codeSnippetDecoder")
	t.CodeSnippetDecoder=d
	var p=e("./countryCodes")
	t.CountryCodes=p.CountryCodes
	var f=e("./domTransformers")
	t.WordDomTransformer=f.WordDomTransformer,t.FlagDomTransformer=f.FlagDomTransformer,t.URLDomTransformer=f.URLDomTransformer,t.NewLineDomTransformer=f.NewLineDomTransformer,t.ElementVisitor=f.ElementVisitor,function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(e("./encoderFactory"))})),define("swx-encoder",["swx-encoder/lib/index"],(function(e){return e})),factory=function e(t){var n=function(t){return e(t)}
	if(n.version="0.7.3",!t||!t.document||9!==t.document.nodeType)return n.isSupported=!1,n
	var i=t.document,r=i,o=t.DocumentFragment,a=t.HTMLTemplateElement,s=t.NodeFilter,c=t.NamedNodeMap||t.MozNamedAttrMap,l=t.Text,u=t.Comment,d=t.DOMParser
	"function"==typeof a&&(i=i.createElement("template").content.ownerDocument)
	var p=i.implementation,f=i.createNodeIterator,m=i.getElementsByTagName,h=i.createDocumentFragment,v=r.importNode,g={}
	n.isSupported=void 0!==p.createHTMLDocument&&9!==i.documentMode
	var y=function(e,t){for(var n=t.length;n--;)e[t[n]]=!0
	return e},b=function(e){var t,n={}
	for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t])
	return n},_=null,E=y({},["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr","svg","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","switch","symbol","text","textpath","title","tref","tspan","view","vkern","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","feSpecularLighting","feTile","feTurbulence","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmuliscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mpspace","msqrt","mystyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","#text"]),w=null,S=y({},["accept","action","align","alt","autocomplete","background","bgcolor","border","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","coords","datetime","default","dir","disabled","download","enctype","face","for","headers","height","hidden","high","href","hreflang","id","ismap","label","lang","list","loop","low","max","maxlength","media","method","min","multiple","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","rows","rowspan","spellcheck","scope","selected","shape","size","span","srclang","start","src","step","style","summary","tabindex","title","type","usemap","valign","value","width","xmlns","accent-height","accumulate","additivive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","clip","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mode","min","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","surfacescale","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","u1","u2","unicode","values","viewbox","visibility","vert-adv-y","vert-origin-x","vert-origin-y","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","y","y1","y2","z","zoomandpan","accent","accentunder","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","display","displaystyle","fence","frame","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),x=null,C=null,T=!0,I=!1,A=!1,M=!1,O=!1,k=!1,N=!1,P=!0,R=!0,L=y({},["audio","head","math","script","style","svg","video"]),D=null,U=i.createElement("form"),F=function(e){try{e.parentNode.removeChild(e)}catch(t){e.outerHTML=""}},B=function(e){return f.call(e.ownerDocument||e,e,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,(function(){return s.FILTER_ACCEPT}),!1)},V=/\{\{.*|.*\}\}/gm,G=/<%.*|.*%>/gm,H=function(e){if(Y("beforeSanitizeElements",e,null),!((t=e)instanceof l||t instanceof u||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof c&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute))return F(e),!0
	var t,n=e.nodeName.toLowerCase()
	if(Y("uponSanitizeElement",e,{tagName:n}),!_[n]||x[n]){if(R&&!L[n]&&"function"==typeof e.insertAdjacentHTML)try{e.insertAdjacentHTML("AfterEnd",e.innerHTML)}catch(r){}return F(e),!0}if(!I||e.firstElementChild||e.content&&e.content.firstElementChild||(e.innerHTML=e.textContent.replace(/</g,"&lt;")),A&&3===e.nodeType){var i=e.textContent
	i=(i=i.replace(V," ")).replace(G," "),e.textContent=i}return Y("afterSanitizeElements",e,null),!1},q=/^data-[\w.\u00B7-\uFFFF-]/,W=/^(?:\w+script|data):/i,j=/[\x00-\x20\xA0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,z=function(e){Y("beforeSanitizeAttributes",e,null)
	var n=e.attributes
	if(n){for(var r,o,a,s,c,l={attrName:"",attrValue:"",keepAttr:!0},u=n.length;u--;)if(o=(r=n[u]).name,a=r.value,s=o.toLowerCase(),l.attrName=s,l.attrValue=a,l.keepAttr=!0,Y("uponSanitizeAttribute",e,l),a=l.attrValue,"name"===s&&"IMG"===e.nodeName&&n.id?(c=n.id,n=Array.prototype.slice.apply(n),e.removeAttribute("id"),e.removeAttribute(o),n.indexOf(c)>u&&e.setAttribute("id",c.value)):("id"===o&&e.setAttribute(o,""),e.removeAttribute(o)),l.keepAttr&&(!P||"id"!==s&&"name"!==s||!(a in t||a in i||a in U))&&(w[s]&&!C[s]||!A&&T&&q.test(s))&&(!W.test(a.replace(j,""))||"src"===s&&0===a.indexOf("data:")&&"IMG"===e.nodeName))try{A&&(a=(a=a.replace(V," ")).replace(G," ")),e.setAttribute(o,a)}catch(d){}Y("afterSanitizeAttributes",e,null)}},K=function(e){var t,n=B(e)
	for(Y("beforeSanitizeShadowDOM",e,null);t=n.nextNode();)Y("uponSanitizeShadowNode",t,null),H(t)||(t.content instanceof o&&K(t.content),z(t))
	Y("afterSanitizeShadowDOM",e,null)},Y=function(e,t,i){g[e]&&g[e].forEach((function(e){e.call(n,t,i,D)}))}
	return n.sanitize=function(e,i){if(e||(e=""),"string"!=typeof e&&(e=e.toString()),!n.isSupported)return"object"==typeof t.toStaticHTML||"function"==typeof t.toStaticHTML?t.toStaticHTML(e):e
	if(function(e){"object"!=typeof e&&(e={}),_="ALLOWED_TAGS"in e?y({},e.ALLOWED_TAGS):E,w="ALLOWED_ATTR"in e?y({},e.ALLOWED_ATTR):S,x="FORBID_TAGS"in e?y({},e.FORBID_TAGS):{},C="FORBID_ATTR"in e?y({},e.FORBID_ATTR):{},T=!1!==e.ALLOW_DATA_ATTR,I=e.SAFE_FOR_JQUERY||!1,A=e.SAFE_FOR_TEMPLATES||!1,M=e.WHOLE_DOCUMENT||!1,O=e.RETURN_DOM||!1,k=e.RETURN_DOM_FRAGMENT||!1,N=e.RETURN_DOM_IMPORT||!1,P=!1!==e.SANITIZE_DOM,R=!1!==e.KEEP_CONTENT,k&&(O=!0),e.ADD_TAGS&&(_===E&&(_=b(_)),y(_,e.ADD_TAGS)),e.ADD_ATTR&&(w===S&&(w=b(w)),y(w,e.ADD_ATTR)),R&&(_["#text"]=!0),Object&&"freeze"in Object&&Object.freeze(e),D=e}(i),!O&&!M&&-1===e.indexOf("<"))return e
	var a,s,c=function(e){var t,n
	try{t=(new d).parseFromString(e,"text/html")}catch(i){}return t||((n=(t=p.createHTMLDocument("")).body).parentNode.removeChild(n.parentNode.firstElementChild),n.outerHTML=e),"function"==typeof t.getElementsByTagName?t.getElementsByTagName(M?"html":"body")[0]:m.call(t,M?"html":"body")[0]}(e)
	if(!c)return O?null:""
	for(var l,u=B(c);a=u.nextNode();)3===a.nodeType&&a===s||H(a)||(a.content instanceof o&&K(a.content),z(a),s=a)
	if(O){if(k)for(l=h.call(c.ownerDocument);c.firstChild;)l.appendChild(c.firstChild)
	else l=c
	return N&&(l=v.call(r,l,!0)),l}return M?c.outerHTML:c.innerHTML},n.addHook=function(e,t){"function"==typeof t&&(g[e]=g[e]||[],g[e].push(t))},n.removeHook=function(e){g[e]&&g[e].pop()},n.removeHooks=function(e){g[e]&&(g[e]=[])},n.removeAllHooks=function(){g=[]},n},root="undefined"==typeof window?null:window,"function"==typeof define&&define.amd?define("dompurify/src/purify",[],(function(){return factory(root)})):"undefined"!=typeof module?module.exports=factory(root):root.DOMPurify=factory(root),define("dompurify",["dompurify/src/purify"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/messageSanitizer",["require","exports","lodash-compat","swx-cafe-application-instance","swx-constants","swx-encoder","swx-encoder","swx-encoder","swx-service-locator-instance","swx-utils-common","dompurify","./dateTime"],e)}((function(e,t){var n,i,r,o,a,s,c=e("lodash-compat"),l=e("swx-cafe-application-instance"),u=e("swx-constants"),d=e("swx-encoder"),p=e("swx-encoder"),f=e("swx-encoder"),m=e("swx-service-locator-instance"),h=e("swx-utils-common"),v=e("dompurify"),g=e("./dateTime"),y='(?:(?:\\s*title="[^"]+?"\\s*)|(?:\\s*tabindex="-1"\\s*)|(?:\\s*target="_blank"\\s*)){0,3}',b=h.regex.multilineRegExp(["(&lt;a ",y,'href="((?:https?://|mailto:)[^"]+?)"',y,"&gt;)","((?:(?!&lt;/a&gt;)[\\s\\S])*)","(&lt;/a&gt;)"],"gi"),_='&lt;i class="'+u.COMMON.mentions.class+'"&gt;&lt;span title="(.*?)"&gt;(.*?)&lt;/span&gt;&lt;/i&gt;',E=/((([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,}))/gi,w=/(&lt;a href="skype:\+\d+"&gt;(\+?[\s\d\-]*\d)&lt;\/a&gt;)/gi,S=/(<a href="skype:\+\d+">(\+?[\s\d\-]*\d)<\/a>)/gi,x=["(",'&lt;span class="emoticon [a-z0-9]+\\s?(?:animated)?\\s?\\s?(?:large|extraLarge)?\\s?"&gt;','&lt;span class="emoSprite"&gt;',"|",'&lt;span class="emoticon\\s?(?:large|extraLarge)?\\s?"&gt;','&lt;canvas(?:\\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*&gt;',")","(?:.+?)","(","&lt;/span&gt;&lt;/span&gt;","|","&lt;/canvas&gt;&lt;/span&gt;",")"],C=h.regex.multilineRegExp(["(?:",'<span class="emoticon [a-z0-9]+\\s?(?:animated)?\\s?\\s?(?:large|extraLarge)?\\s?">','<span class="emoSprite">',"|",'<span class="emoticon\\s?(?:large|extraLarge)?\\s?">','<canvas(?:\\s?(?:data-[-a-z]*|height|width)="[a-z0-9]*")*>',")","(?:.+?)","(?:","</span></span>","|","</canvas></span>",")"],"gi"),T=h.regex.multilineRegExp(x,"gi"),I=h.regex.multilineRegExp(x,"i"),A=/&lt;span class="flag ([^"]{2})"&gt;[\s]*\(flag:\1\)[\s]*&lt;\/span&gt;/gi,M=/&lt;flag country="([^"]{2})"&gt;[\s]*\(flag:\1\)[\s]*&lt;\/flag&gt;/gi,O=/<ss type="\w+">.*?<\/ss>/g,k=/<flag country="[\w+]{2}">(?:.+?)<\/flag>/gi,N=/<span class="flag [^"]{2}">(?:.+?)<\/span>/gi,P=/(<(?:\/?)(?:quote|legacyquote)[^>]*>)/gi,R={text:/Edited previous message: /,edited:/<e_m [^<>]+>/g,editedEnd:/<\/e_m>/g,quoted:P},L=/\b((https?:\/\/|w{3}\.)\S+)/gi,D=[(n="^(https?://)?")+(i="(([0-9a-z_!~*'()\\.&=+$%-]+:)?[0-9a-z_!~*'()\\.&=+$%-]+@)?")+"("+(o="([0-9a-z][0-9a-z_-]*)?[0-9a-z]")+"\\.)+(com|org|net|edu|gov|mil|aero|arpa|asia|biz|cat|coop|info|int|jobs|mobi|museum|name|pro|tel|travel|[a-z]{2})"+(a="(:\\d{1,5})?")+(s="([#/].*)?$"),n+i+"("+(r="(\\d{1,2}|1\\d{2}|2[0-4]\\d|25[0-5])")+"\\.){3}"+r+a+s,n+i+o+a+s].map((function(e){return new RegExp(e,"i")})),U='<ss type="(.*?)">(.*?)</ss>',F={bold:W("b","\\*"),italic:W("i","_"),strike:W("s","~"),rawBold:new RegExp("(&lt;b&gt;)(.*?)(&lt;/b&gt;)","gi"),rawItalic:new RegExp("(&lt;i&gt;)(.*?)(&lt;/i&gt;)","gi"),rawFontColor:new RegExp('(&lt;font\\s+color="#[a-f0-9]{6}"&gt;)(.*?)(&lt;/font&gt;)',"gi")},B={"*":function(e){return j("b","*",e)},_:function(e){return j("i","_",e)},"~":function(e){return j("s","~",e)}},V={code:{opening:46,closing:12},codeBlock:{opening:25,closing:12},rawBold:{opening:9,closing:10},rawItalic:{opening:9,closing:10},rawFontColor:{opening:28,closing:13},default:{opening:34,closing:10}},G={"<":"&lt;",">":"&gt;","&lt;":"<","&gt;":">","&LT;":"<","&GT;":">","&":"&amp;",'"':"&quot;","'":"&apos;","&amp;":"&","&quot;":'"',"&apos;":"'","&#39;":"'","&#96;":"`","&AMP;":"&","&QUOT;":'"',"&APOS;":"'"},H="mailto:",q={ALLOWED_ATTR:["href","target","type","country","id","authorname","timestamp","author","raw_pre","raw_post"],ALLOWED_TAGS:["b","i","s","u","a","ss","flag","at","pre","quote","legacyquote","br","pre"]}
	function W(e,t,n){return void 0===n&&(n=!1),new RegExp("((?:&lt;"+e+' raw_pre="'+t+'"'+(n?"":' raw_post="'+t+'"')+"&gt;)+)([\\s\\S]*?)((?:&lt;/"+e+"&gt;)+)","gi")}function j(e,t,n){return'<{0} raw_pre="{1}" raw_post="{1}">{2}</{0}>'.split("{0}").join(e).split("{1}").join(t).split("{2}").join(n)}function z(e){return G[e]}function K(e){return e.replace(/([<>])/gi,z)}function Y(e){return e.replace(/(&lt;|&gt;)/gi,z)}function Q(e,t){return e.replace(t,Y)}function X(e){return e.match(I).slice(1).reduce(Q,e)}function $(e,t){return e.search(h.regex.escapeSpecialChars(t))>-1?e:e.replace(/(<a|&lt;a)/,(function(e){return e+" "+t}))}function J(e,t,n,i,r){var o,a
	return o=Y(t),a=Y(r),0!==n.indexOf(H)&&(o=$(o,'target="_blank"')),o=$(o,'tabindex="-1"'),(o=$(o,'title="'+n+'"'))+i+a}function Z(e,t){var n=t.match(/(\+?[\s\d\-]*\d)&lt;/i)[0]
	return n.slice(0,n.length-4)}function ee(e){return function(e){return e.replace(/&(lt|gt|amp|quot|apos|#39|#96);/gi,z)}(e.replace(b,J))}function te(e){return e.replace(/<a(:?>|\s.*?>)/g,"").replace(/<\/a>/g,"")}function ne(e){return Object.keys(R).reduce((function(e,t){return e.replace(R[t],"")}),e)}function ie(e){function t(e,t,n,i,r){var o=V[e]||V.default
	return"rawFontColor"===e&&(n=n.replace(/font(\s+)color/i,"font color")),Y(n.substr(0,o.opening))+i+Y(r.substr(0,o.closing))}return Object.keys(F).reduce((function(e,n){return e.replace(F[n],t.bind(null,n))}),e)}function re(e,t){var n,i,r,o=0
	if(!(t&&Object.keys(t).length>0&&!a(e)&&e.length>1))return[]
	do{if(o>=e.length-1)return[]
	if(-1===(n=p(e,o,u)))return[]
	r=e.charAt(n),i=f(e,n,r),t=c.omit(t,r),o+=1}while(-1===i)
	return[n,i]
	function a(e){return!e||!/\S/.test(e)}function s(e,t){for(var n,i=0;i<e.length;i++)if(n=e[i],!(void 0!==t&&t.length>0&&-1!==t.indexOf(n)))return" "===n
	return!0}function l(e){return e.split("").reverse().join("")}function u(e,n,i){var r=[",",".",";",":","?","!","(",")"]
	return void 0!==t[n]&&(s(l(e),r)||s(i,r))}function d(e,t,n,i){var r=[",",".",";",":","?","!","(",")"]
	return n===e&&c.first(i)!==e&&(s(l(t),r)||s(i,r))}function p(e,t,n){for(var i=t;i<=e.length;i++)if(n(e.substring(0,i),e[i],e.substring(i+1,e.length)))return i
	return-1}function f(e,t,n){var i,r,o=t
	do{if(-1===(i=p(e,o+=1,d.bind(null,n))))return-1
	r=e.substring(t+1,i)}while(a(r))
	return i}}function oe(e,t){var n,i,r,o,a,s=re(t,e),l=s[0],u=s[1]
	return void 0===l||void 0===u||l<0||u<0?t:(i=e[n=t.charAt(l)],a=t.substring(0,l),r=t.substring(l+1,u),o=t.substring(u+1),a+i(oe(c.omit(e,n),r))+oe(e,o))}function ae(e){var t=e.split(/\r?\n/)
	return c.map(t,(function(e){return oe(B,e)})).join("\r\n")}function se(e,t){var n
	function i(e){var t=e.replace(/[\u0080-\u9999]/g,"z")
	return D.some((function(e){return e.test(t)}))}return void 0===t&&(t=!1),e.replace(L,(function(e,r){return i(r)?(r=function(e){return e.replace(/(["''])/gi,z)}(r),n=/^w{3}\./i.test(r)?"http://"+r:r,"<a"+(t?"":' tabindex="-1" target="_blank"')+' href="'+n+'">'+r+"</a>"):r})).replace(E,(function(e,t){return i(t)?'<a href="mailto:'+t+'">'+t+"</a>":t}))}function ce(e,t,n){var i,r=K(e.replace(/&/g,"&amp;")),o=r.match(t)
	return o?o.forEach((function(e,t){var a=r.indexOf(e),s=a+e.length,c=o[t+1]
	0===t&&(i=n(r.substring(0,a))),i+=r.substring(a,s),r=r.substring(s)
	var l=c?r.indexOf(c):void 0
	i+=n(r.substring(0,l))})):i=n(r),Y(i.replace(/&amp;/g,"&"))}function le(e){v.addHook("beforeSanitizeElements",(function(e,t,n){(function(e,t){e&&e.nodeName&&e.nodeName.toLowerCase()===t&&(e.innerHTML=c.escape(e.innerHTML))})(e,"legacyquote")})),v.addHook("beforeSanitizeAttributes",(function(e,t,n){de(e,"target","_blank"),function(e,t,n){e&&e.tagName&&e.tagName.toLowerCase()===n&&e.hasAttribute(t)&&e.setAttribute(t,c.escape(e.getAttribute(t)))}(e,"authorname","quote")})),v.addHook("afterSanitizeAttributes",(function(e,t,n){var i=function(e,t){if(e&&e.tagName&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(t))return e.getAttribute(t)
	return null}(e,"href")
	i&&(de(e,"rel","noreferrer noopener"),de(e,"onclick","return false;"),de(e,"title",i))}))
	var t=v.sanitize(e,q)
	return v.removeHook("beforeSanitizeElements"),v.removeHook("beforeSanitizeAttributes"),v.removeHook("afterSanitizeAttributes"),t.replace("&nbsp;"," ")}function ue(e){return e.replace(/(\r?\n)|(&lt;br\s?\/&gt;)/gm,"<br/>")}function de(e,t,n){return e&&e.tagName&&"a"===e.tagName.toLowerCase()&&(e.hasAttribute(t)||e.setAttribute(t,n)),e}function pe(e,t){void 0===t&&(t=null),e=function(e){return e.replace(String.fromCharCode(11),"")}(e=e.trim())
	var n=d.URLDomTransformer.build(!0)
	return e=ae(e=d.build(l,{conversation:t,domTransformeExtensions:[n]}).encode(e,!0))}function fe(e,t){var n=c.isArray(t)?t:[t]
	return c.each(n,(function(t){e=e.replace(t,"")})),!(e=e.trim())}t.escapeHTML=function(e){return function(e){return e.replace(/([<>&"'])/gi,z)}(e.replace(b,J))},t.unescapeHTML=ee,t.removeAnchorTags=te,t.removeMetaData=ne,t.handleWikiMarkup=ie,t.stripHTML=function(e){return v.sanitize(e,{ALLOWED_TAGS:[]})},t.escapeIncomingXml=le,t.escapeIncomingHTML=function(e){var t=m.default.resolve(u.COMMON.serviceLocator.FEATURE_FLAGS).isFeatureOn(u.COMMON.featureFlags.INCOMING_WIKI_MARKUP),n=K(e)
	return n=(n=(n=function(e){var t,n=0,i=[],r=new RegExp(_,"gi"),o=new RegExp(_,"i")
	function a(e,t){return i[n]=t,e.replace(t,"DUMMY"+n++)}var s=r.exec(e)
	if(!s)return e
	var c=e
	function l(e,n){t=t.replace("DUMMY"+n,e)}for(;s;){var u=s[0].match(o).splice(1)
	t=Y(t=u.reduce(a,s[0])),i.forEach(l),c=c.replace(s[0],t),s=r.exec(e)}return c}(n=(n=n.replace(T,X)).replace(A,Y))).replace(b,J)).replace(w,Z),t?ie(n):n},t.escapeOutgoingHTML=function(e){return K(e).replace(/&lt;ss type="[^"]*"&gt;/gi,Y).replace(/&lt;\/ss&gt;/gi,Y).replace(M,Y)},t.removeNoTranslateTags=function(e){var t=f.NoTranslateDomTransformer.build(f.NoTranslateDomTransformer.Mode.Remove)
	return d.build(l,{domTransformers:[t]}).encode(e,!1)},t.webify=ue,t.getMessageSanitizedContent=function(e){var t=p.CodeSnippetDecoder.build(),n=p.CodeSnippetEncoder.build(),i=!/^<pre\s/.test(e)&&/^!!|\{code}/.test(e),r=void 0!==e&&i?d.build(l,{domTransformers:[n]}).encode(e):e,o=le(void 0!==r?d.build(l,{domDecoders:[t]}).decode(r):e),a=p.QuoteDecoder.build(g.formatTimestampLong),s=ne(d.build(l,{domDecoders:[a]}).decode(o).replace(S,Z))
	return ue(v.sanitize(s,{ADD_ATTR:["target","rel","onclick","title","author","role","raw_pre","raw_post"],ADD_TAGS:["at"]})).replace(/&nbsp;/g," ")},t.compactHtml=function(e){var t=p.MarkupDecoder.build(),n=p.MentionDecoder.build(),i=p.CodeSnippetDecoder.build(),r=d.build(l,{domTransformers:[t,n,i]}).encode(e,!1)
	return r=function(e){for(var t=new RegExp(U,"gi"),n=new RegExp(U,"i"),i=e,r=t.exec(e);r;){var o=n.exec(r[0])
	o&&(i=i.replace(o[0],o[2])),r=t.exec(e)}return i}(r)},t.processOutgoingTextMessage=pe,t.processOutgoingTextMessageForTranslation=function(e,t){void 0===t&&(t=null)
	var n=pe(e,t),i=f.NoTranslateDomTransformer.build(f.NoTranslateDomTransformer.Mode.Add)
	return d.build(l,{domTransformers:[i]}).encode(n,!1)},t.processIncomingSanitizedTextMessageForTranslation=function(e){var t=f.NoTranslateDomTransformer.build(f.NoTranslateDomTransformer.Mode.Add)
	return d.build(l,{domTransformers:[t]}).encode(e,!1)},t.isMessageWithMentionOnly=function(e){return fe(e,[/<at id="(.*?)">.*?<\/at>/g,/<i class="(.*?)"><span title="(.*?)">.*?<\/span><\/i>/g])},t.isMessageWithEmoticonsOnly=function(e){return fe(e,[O,k,C,N,P])}
	var me={"text/typed":{"text/html":function(e){var t=p.EmoticonEncoder.build(),n=d.URLDomTransformer.build(),i=d.NewLineDomTransformer.build(),r=d.FlagDomTransformer.build(),o=p.MentionEncoder.build(null),a=p.QuoteDecoder.build(g.formatTimestampLong),s=d.build(l,{domTransformers:[r,t,n,i,o],domDecoders:[a]}),c=s.encode(e),u=s.decode(c)
	return v.sanitize(u,{ADD_ATTR:["target","rel","onclick"]})}}}
	function he(e){var t=/href="(.*?)"/i
	return(e.match(/(<a.*?<\/a>)/gi)||[]).reduce((function(e,n){var i=(n.match(t)[1]||"").replace("&amp;","&")
	return e.replace(n,i)}),e)}function ve(e){return e.replace(/<br\s*\/?>/g,"\r\n")}t.transform=function(e,t,n,i){void 0===i&&(i=null)
	var r=me[t]&&me[t][n]
	if(r)return r(e,i)
	throw new Error("Encoder from "+t+" to "+n+" is not available")},t.validateUnescapedLink=function(e){return K(e).replace(b,J)},t.encodeEmoticonsTextRepresentation=function(e){return ce(e,T,(function(e){var t=d.build(l)
	return t.decode(t.encode(e))}))},t.encodeEmoticonsRawRepresentation=function(e){var t=d.build(l),n=t.encode(e,!1)
	return t.decode(n)},t.encodeLinkTextRepresentation=function(e){return ce(e,b,se)},t.unboxHrefContent=he,t.unwebify=ve,t.getSanitizedTopic=function(e){return ee(te(e))},t.getEmoticonNamesFromMessage=function(e){for(var t,n=[],i=/(?:<ss type=")(\w+)">/g;t=i.exec(e);){var r=t[1]
	n.push(r)}return n},t.encode=function(e){return d.build(l).encode(e)},t.quotesPresentInHTML=function(e){var t=/<div class=["\']quotedText["\'']>.*[\S\s]*<\/div>/gi.exec(e)
	return c.isUndefined(t)||c.isNull(t)?"":t[0]},t.quotesPresentInXML=function(e){var t=/<quote.*[\S\s]*<\/quote>/gi.exec(e)
	return c.isUndefined(t)||c.isNull(t)?"":t[0]},t.extractMessageTextContent=function(e){var t=ve(e)
	return t=he(t=d.build(l).getNodeTextContent(t))}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/sort",["require","exports"],e)}((function(e,t){t.byId=function(e,t){return e.id-t.id},t.byTimestamp=function(e,t){return e.timestamp-t.timestamp},t.byTimestampDescending=function(e,t){return t.timestamp-e.timestamp}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/spaceMail",["require","exports","swx-i18n"],e)}((function(e,t){var n=e("swx-i18n")
	t.createMailtoLink=function(e,t){return"mailto:?subject="+encodeURI(n.localization.fetch({key:"spaces_email_subject"}))+"&body="+function(e,t){var i=n.localization.fetch({key:"spaces_email_greeting"}),r=n.localization.fetch({key:"spaces_email_joinMe",params:{spaceName:e}}),o=n.localization.fetch({key:"spaces_email_link"})
	return encodeURI(i+"\r\n\r\n"+r+"\r\n"+o+" "+t)}(e,t)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/urlParser",["require","exports"],e)}((function(e,t){t.getParam=function(e,t){var n=decodeURIComponent(e),i=new RegExp("("+t+")=([^&]+)"),r=n.match(i)
	return r&&r[2]?r[2]:void 0},t.getRoute=function(e){void 0===e&&(e=null)
	var t=new RegExp("index[^#]*#(.+)/"),n=e&&e.match(t)
	return n&&n[1]?n[1]:void 0},t.isHttps=function(e){return/^https:/.test(e)},t.isYoutubeLink=function(e){var t=/(?:youtube\.com|youtu\.be)\/watch(?:\?|\&|&amp;)v=([\w-]{11})/.exec(e)
	return t||(t=/(?:youtube\.com|youtu\.be)\/([\w-]{11})/.exec(e)),!!t}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/urlValidator",["require","exports","lodash-compat","swx-constants"],e)}((function(e,t){var n=e("lodash-compat"),i=e("swx-constants"),r=/^(?:([^:\/?#]+):)?(?:\/\/(?:([\S][^\/]*)(?:[\@]))?([^\/\\?:#]*)(?:\:(\d*)?)?)?([^?#]*)(?:(?:\?)([^#]*))?(?:#(.*))?/
	t.ALLOW_EMPTY=i.COMMON.urlValidator.ALLOW_EMPTY
	var o={allowedDomains:["**"],allowedProtocols:[t.ALLOW_EMPTY,"http","https"],allowedPorts:[t.ALLOW_EMPTY]}
	function a(e){return e.toString().replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function s(e){var t=a(e)
	return"^"+(t=(t=(t=t.replace("\\*\\*","[^\\/]*")).replace("\\*","[^.\\/]*")).replace("\\?","."))+"$"}function c(e){if(n.isUndefined(e))throw new Error("`undefined` is not a valid argument")
	return e===t.ALLOW_EMPTY?n.isUndefined:n.isFunction(e)?e:(n.isRegExp(e)||(e=new RegExp(s(e),"i")),e.test.bind(e))}function l(e){var t=(e=e.toString().trim()).split("#",2)[1]
	e=e.split("#",2)[0]
	var n=r.exec(e)
	return n&&{scheme:n[1],user:n[2],host:n[3],port:n[4],path:n[5],query:n[6],hash:t}}t.validate=function(e,t){if(void 0===t&&(t=null),!e)return!1
	var i=n.clone(o)
	t&&n.extend(i,t)
	var r=l(e)
	return!!r&&(!(!n.isEmpty(i.allowedProtocols)&&!n.some(i.allowedProtocols,(function(e){return c(e)(r.scheme)})))&&(!(!n.isEmpty(i.allowedDomains)&&!n.some(i.allowedDomains,(function(e){return c(e)(r.host)})))&&!(!n.isEmpty(i.allowedPorts)&&!n.some(i.allowedPorts,(function(e){return c(e)(r.port)})))))},t.$unit={escapeRegExp:a,wildcardToRegExp:s,asMatcher:c,explodeURL:l}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/participant",["require","exports"],e)}((function(e,t){t.isMeParticipant=function(e,t){return t.mePerson.id()===e.person.id()}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-chat/lib/index",["require","exports","./conversation","./conversationCache","./dateTime","./messageSanitizer","./sort","./spaceMail","./urlParser","./urlValidator","./participant"],e)}((function(e,t){var n=e("./conversation")
	t.conversation=n
	var i=e("./conversationCache")
	t.conversationCache=i
	var r=e("./dateTime")
	t.dateTime=r
	var o=e("./messageSanitizer")
	t.messageSanitizer=o
	var a=e("./sort")
	t.sort=a
	var s=e("./spaceMail")
	t.spaceMail=s
	var c=e("./urlParser")
	t.urlParser=c
	var l=e("./urlValidator")
	t.urlValidator=l
	var u=e("./participant")
	t.participant=u})),define("swx-utils-chat",["swx-utils-chat/lib/index"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/lastSeenConverter",["require","exports","swx-i18n","swx-constants"],e)}((function(e,t){var n=e("swx-i18n"),i=e("swx-constants"),r=[{max:2,msg:"presence_lastseen_moments"},{max:59,msg:"presence_lastseen_minutes"},{max:1439,msg:"presence_lastseen_hours",recalculate:60},{max:10080,msg:"presence_lastseen_days",recalculate:1440}],o=10080,a="presence_lastseen_date_short",s="presence_lastseen_date_full",c=i.COMMON.globalizationFormatKeys,l=function(){function e(e,t){this.dateTime=e,this.g11nFormatter=t}return e.prototype.getMessage=function(e){var t,i={}
	return"number"!=typeof e?"":(this.isMoreThanOneWeek(e)?(t=this.toDate(e),this.isWithinThisCalendarYear(t)?(i.key=a,i.params={shortdate:this.g11nFormatter.formatDate(t,c.date.DAY_MONTH)}):(i.key=s,i.params={fulldate:this.g11nFormatter.formatDate(t,c.date.DAY_MONTH_YEAR)})):i=this.getLastSeenTranslationOptions(e),n.localization.fetch(i))},e.prototype.toDate=function(e){return this.dateTime.getDate(this.dateTime.now()-6e4*e)},e.prototype.isWithinThisCalendarYear=function(e){return e.getFullYear()===this.dateTime.getDate(null).getFullYear()},e.prototype.isMoreThanOneWeek=function(e){return e>o},e.prototype.getLastSeenTranslationOptions=function(e){for(var t={},n=0;n<r.length;n++){var i=r[n]
	if(t={},!(e>i.max)){var o=void 0!==i.recalculate?Math.floor(e/i.recalculate):e
	t.key=i.msg,t.params={number:o}
	break}}return t},e}()
	t.__esModule=!0,t.default=l})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/organizePersons",["require","exports","swx-utils-common","swx-i18n"],e)}((function(e,t){var n=e("swx-utils-common"),i=e("swx-i18n")
	function r(e){var t=e.displayName()||e.id()||"",r=n.stringUtils.clean(n.stringUtils.normalize(t))[0]
	return n.stringUtils.isNotEmpty(r)?r.toUpperCase():i.localization.fetch({key:"message_bucketName_other"})}function o(e){return{sortValue:n.stringUtils.clean(n.stringUtils.normalize(e.displayName())),person:e}}function a(e){return e.person}t.getBucketName=r,t.byAlphabet=function(e){var t={}
	return e.forEach((function(e){var n=r(e)
	t[n]||(t[n]=[]),t[n].push(e)})),function(e){var t,r=[],s=i.localization.fetch({key:"message_bucketName_other"})
	Object.keys(e).sort().forEach((function(i){if(i===s)t={name:i,contacts:e[i]}
	else{var c=e[i].map(o)
	c=n.array.sortByProperty(c,"sortValue"),r.push({name:i,contacts:c.map(a)})}})),t&&r.push(t)
	return r}(t)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/personPropertyFormatter",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	t.getId=function(e){if(n.isString(e))return e.replace(/^((\d+):)+/,"")},t.truncateDisplayName=function(e,t){if(void 0===t&&(t=15),t||(t=15),!e)return e
	if(e.length<=t)return e.trim()
	var n=e.substring(0,t).lastIndexOf(" ")
	return-1===n&&(n=t),e.substring(0,n).trim()}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/progressiveTimeout",["require","exports","swx-utils-common"],e)}((function(e,t){var n=e("swx-utils-common"),i=[{timeout:1,limit:59},{timeout:60,limit:1439},{timeout:1440,limit:null}],r=function(){function e(e){this.timeouts={},this.$unit={timeouts:this.timeouts},this.timeoutProvider=e}return e.prototype.start=function(e,t){this.timeouts.hasOwnProperty(e)||(this.timeouts[e]={callbacks:{},timeoutId:null,timeout:this.getTimeout()})
	var i=this.timeouts[e]
	i.callbacks||(i.callbacks={})
	var r=n.guid.create()
	return i.callbacks[r]=t,null===i.timeoutId&&this.runCallbacks(e),r},e.prototype.stop=function(e,t){var n=this.timeouts[e]
	n&&(n.callbacks.hasOwnProperty(t)&&delete n.callbacks[t],0===Object.keys(n.callbacks).length&&(this.timeoutProvider.clearTimeout(n.timeoutId),n.timeoutId=null))},e.prototype.reset=function(e,t){this.timeouts.hasOwnProperty(e)&&(this.timeouts[e].timeout=this.getTimeout(t))},e.prototype.getTimeout=function(e){if(void 0===e&&(e=null),null==e)return this.toMilliseconds(i[0].timeout)
	for(var t=0;t<i.length;t++){var n=i[t]
	if(!(n.limit&&e>n.limit))return this.toMilliseconds(n.timeout)}return this.toMilliseconds(i[i.length-1].timeout)},e.prototype.toMilliseconds=function(e){return 60*e*1e3},e.prototype.runCallbacks=function(e){var t=this,n=this.timeouts[e]
	for(var i in n.timeoutId=this.timeoutProvider.setTimeout((function(){t.runCallbacks(e)}),n.timeout),n.callbacks)n.callbacks.hasOwnProperty(i)&&n.callbacks[i]()},e}()
	t.__esModule=!0,t.default=r})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/userDataProcessor",["require","exports","swx-cafe-application-instance","swx-encoder","swx-utils-chat","lodash-compat"],e)}((function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-encoder"),r=e("swx-utils-chat"),o=e("lodash-compat"),a=/(<flag country="\S+">\S+<\/flag>|<ss type="\S+">\S+<\/ss>)/gi
	t.sanitize=function(e){if(o.isString(e)){var t=i.build(n),s=e
	if(null===e.match(a)){var c=r.messageSanitizer.escapeIncomingHTML(e)
	s=t.encode(c,!1)}return r.messageSanitizer.escapeIncomingHTML(t.decode(s))}return""},t.sanitizeXml=function(e){return o.isString(e)?o.escape(e):""},t.stripAnchors=function(e){return o.isString(e)?r.messageSanitizer.removeAnchorTags(e):""}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/avatar/cache",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat"),i="404Avatar",r=function(){function e(e,t,n){this.cacheInstanceProvider=e,this.settings=t,this.dateTime=n}return e.prototype.add=function(e){var t=this,n=this.cacheInstanceProvider.get()
	return n.getItem(i).then((function(r){return r&&Array.isArray(r)||(r=[]),r.push({src:e,expiresAt:t.dateTime.now()+t.settings.avatarCacheDuration}),n.setItem(i,r)}))},e.prototype.isCached=function(e){var t=this,r=this.cacheInstanceProvider.get()
	return e?r.getItem(i).then((function(o){var a=n.find(o,{src:e})
	return a?a.expiresAt<t.dateTime.now()?(n.remove(o,{src:e}),r.setItem(i,o).then((function(){return Promise.resolve(!1)}))):Promise.resolve(!0):Promise.resolve(!1)})):Promise.resolve(!1)},e}()
	t.__esModule=!0,t.default=r})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/avatar/helper",["require","exports"],e)}((function(e,t){var n=".AvatarInitials text",i=["rgb(153, 180, 51)","rgb(107, 165, 231)","rgb(231, 115, 189)","rgb(0, 163, 0)","rgb(30, 113, 69)","rgb(255, 0, 151)","rgb(126, 56, 120)","rgb(96, 60, 186)","rgb(29, 29, 29)","rgb(0, 171, 169)","rgb(45, 137, 239)","rgb(43, 87, 151)","rgb(218, 83, 44)","rgb(185, 29, 71)","rgb(238, 17, 17)"],r=function(){function e(e){this.document=e}return e.prototype.showColoredInitials=function(e,t){void 0===t&&(t=null),t&&this.isValidDisplayName(t)?(this.setBackgroundColor(e,t),this.setInitials(e,t)):this.resetInitials(e)},e.prototype.setBackgroundColor=function(e,t){e.querySelector("img").style.display="none",e.style.backgroundColor=this.getBackgroundColor(t)},e.prototype.setInitials=function(e,t){var i=e.querySelector(n)
	if(!i){var r=this.document.createElementNS("http://www.w3.org/2000/svg","svg"),o=r.namespaceURI
	r.setAttribute("viewBox","0 0 47 47"),r.setAttribute("class","AvatarInitials"),(i=this.document.createElementNS(o,"text")).setAttribute("x","50%"),i.setAttribute("y","65%"),r.appendChild(i),e.appendChild(r)}i.textContent=this.getInitials(t)},e.prototype.isValidDisplayName=function(e){return!!e&&!!this.filterDisplayName(e)},e.prototype.resetInitials=function(e){var t=e.querySelector(n),i=e.querySelector("img")
	e.style.backgroundColor="",i.style.display="block",t&&(t.textContent="")},e.prototype.getBackgroundColor=function(e){for(var t=0,n=e.length-1;n>=0;n--){var r=e.charCodeAt(n),o=n%8
	t^=(r<<o)+(r>>8-o)}return i[t%i.length]},e.prototype.getInitials=function(e){var t="",n=(e=this.filterDisplayName(e)).split(" ")
	return 2===n.length?(t+=n[0][0].toUpperCase(),t+=n[1][0].toUpperCase()):3===n.length?(t+=n[0][0].toUpperCase(),t+=n[2][0].toUpperCase()):0!==n.length&&(t+=n[0][0].toUpperCase()),t},e.prototype.filterDisplayName=function(e){var t=e.replace(/\(([^)]*)\)/gi,"")
	return(t=(t=t.replace(/[^ A-Za-z0-9]/gi,"")).replace(/\s+/gi," "))&&(t=t.trim()),t},e}()
	t.__esModule=!0,t.default=r})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-utils-people/lib/index",["require","exports","./lastSeenConverter","./organizePersons","./personPropertyFormatter","./progressiveTimeout","./userDataProcessor","./avatar/cache","./avatar/helper"],e)}((function(e,t){var n=e("./lastSeenConverter")
	t.lastSeenConverter=n
	var i=e("./organizePersons")
	t.organizePersons=i
	var r=e("./personPropertyFormatter")
	t.personPropertyFormatter=r
	var o=e("./progressiveTimeout")
	t.progressiveTimeout=o
	var a=e("./userDataProcessor")
	t.userDataProcessor=a
	var s=e("./avatar/cache")
	t.avatarCache=s
	var c=e("./avatar/helper")
	t.avatarHelper=c})),define("swx-utils-people",["swx-utils-people/lib/index"],(function(e){return e})),define("utils/people/lastSeenConverter",["require","lodash-compat","swx-g11n","swx-utils-chat","swx-utils-people"],(function(e){var t=e("lodash-compat"),n=e("swx-g11n").globalization,i=e("swx-utils-chat").dateTime,r=new(0,e("swx-utils-people").lastSeenConverter.default)(i,n)
	return t.bindAll(r),r})),define("ui/viewModels/people/properties/locationText",["require","swx-utils-common","utils/common/cafeObservable"],(function(e){var t=e("swx-utils-common").stringUtils,n=e("utils/common/cafeObservable")
	function i(e){var t=this
	return t.location={city:n.newObservableProperty(e.location.city),country:n.newObservableProperty(e.location.country)},t.compute=function(){return i.format({city:t.location.city(),country:t.location.country()})},t.dispose=function(){t.location.city.dispose(),t.location.country.dispose()},t}return i.build=function(e){return new i(e)},i.format=function(e){if(e&&t.isNotEmpty(e.city)&&t.isNotEmpty(e.country))return e.city+", "+e.country},i})),define("ui/modelHelpers/conversationHelper",["require","exports","module","swx-enums","swx-cafe-application-instance","swx-browser-detect","swx-util-calling-stack","swx-i18n","ui/modelHelpers/personHelper","lodash-compat"],(function(e,t){var n=e("swx-enums"),i=e("swx-cafe-application-instance"),r=e("swx-browser-detect").default,o=e("swx-util-calling-stack"),a=e("swx-i18n").localization,s=e("ui/modelHelpers/personHelper"),c=e("lodash-compat")
	function l(e){if(e&&!e.isGroupConversation()&&e.participants.size()>0)return e.participants()[0].person}t.createSpaceTopic=function(){return a.fetch({key:"spaces_default_name"})},t.isCallingActive=function(e){return!!function(e){return e.selfParticipant.audio.state()!==n.callConnectionState.Disconnected&&e.selfParticipant.audio.state()!==n.callConnectionState.Notified}(e)&&(!o.get().isOutofBrowserCallingSupported()&&(r.getBrowserInfo().isShellApp||e.autoCall&&e.autoCall(),!0))},t.isOneToOneConversationWithEcho=function(e){var t=l(e)
	return!!t&&s.isEchoContact(t)},t.isOneToOneConversationWithAgent=function(e){var t=l(e)
	return!!t&&s.isAgent(t)},t.isOneToOneConversationWithBlockedPerson=function(e){var t=l(e)
	return!!t&&t.isBlocked()},t.agentSupportsIm=function(e){return!!t.isOneToOneConversationWithAgent(e)&&!!e.participants()[0].person.capabilities.chat()},t.getExistingConversationWithPerson=function(e){var t=i.get().conversationsManager.conversations()
	return c.find(t,(function(t){return!t.isGroupConversation()&&1===t.participants.size()&&t.participants()[0].person.id()===e.id()}))},t.isPstnEndpoint=function(e){return/^(\+)?\d+$/.test(e)},t.isPstnParticipant=function(e){return!!e.audio.endpoint&&(t.isPstnEndpoint(e.audio.endpoint())||s.isPstn(e.person))},t.isPstnOnlyConversation=function(e){var n=e.participants.subscribe()
	if(!e.participants.size())return n.dispose(),!1
	for(var i=0;i<e.participants.size();i++){var r=e.participants(i)
	if(!r.audio.endpoint||!s.isPstn(r.person)&&!t.isPstnEndpoint(r.audio.endpoint()))return n.dispose(),!1}return n.dispose(),!0},t.isConversationWithPstn=function(e){return e.participants().some(t.isPstnParticipant)},t.isAtLeastOnceParticipantOnline=function(e){return e.participants().some((function(e){var t=e.person.status()
	return t!==n.onlineStatus.Offline||t!==n.onlineStatus.Unknown}))},t.isConversationWithWelcomeAgent=function(e){if(!e.isGroupConversation()){var t=e.participants(0)
	if(t&&s.isWelcomeAgent(t.person))return!0}return!1}})),define("ui/viewModels/people/properties/displayNameText",["require","swx-i18n","swx-utils-common","ui/modelHelpers/personHelper","ui/modelHelpers/conversationHelper","utils/common/cafeObservable"],(function(e){var t=e("swx-i18n").localization,n=e("swx-utils-common").stringUtils,i=e("ui/modelHelpers/personHelper"),r=e("ui/modelHelpers/conversationHelper"),o=e("utils/common/cafeObservable")
	function a(e){var t=this
	return t.displayName=o.newObservableProperty(e.displayName),t.compute=function(){return a.format(e.id(),t.displayName())},t.dispose=function(){t.displayName.dispose()},t}return a.build=function(e){return new a(e)},a.format=function(e,o){var a=o
	return i.isGuestId(e)&&(a=t.fetch({key:"guest_user_displayname",params:{displayName:o}})),r.isPstnEndpoint(a)&&(a=n.forceLTREmbedding(a)),a},a})),define("ui/viewModels/people/properties/agentDetails",["require","lodash-compat","vendor/knockout","utils/common/cafeObservable","swx-constants","swx-service-locator-instance","swx-i18n"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/cafeObservable"),r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a=e("swx-i18n").localization
	function s(e){var s,c=this,l={GROUP_PRIVATE:{key:"label_text_agent_profile_capabilities_group_chat_mention_only_mode",params:{botName:t.escape(e.displayName())}},GROUP_ALL:{key:"label_text_agent_profile_capabilities_group_chat_all_messages_mode"}}
	function u(){s&&(t.invoke(s,"dispose"),s=void 0)}function d(e){return e&&(e=e.replace(/(https?\:\/\/)(\S+)(\w{2,4})(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi,p)),e}function p(e){var t=e
	return t.match("^https?://")||(t="http://"+t),'<a href="'+t+'" target="_blank">'+e+"</a>"}function f(){var e=[],n=o.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.BOT_MESSAGES_MODE_V2_ENABLED)
	return t.forOwn(s.capabilities,(function(t,i){if(t()){var r=a.fetch({key:"label_text_agent_profile_capabilities_"+i})
	n&&(r=function(e,t){var n=s.messagesModeAll
	if("group_chat"===t){var i=n&&n()?l.GROUP_ALL:l.GROUP_PRIVATE
	e+=" "+a.fetch(i)}return e}(r,i)),e.push(r)}})),e.length?e.join(a.fetch({key:"label_text_agent_profile_capabilities_join_char"})):a.fetch({key:"label_text_agent_profile_capabilities_none"})}function m(){for(var e=[],t=s.rating()||0,n=(t%1).toFixed(1),i=1;i<=t;i++)e.push(1)
	return n>=.5&&n<.75?e.push(.5):n>=.75&&e.push(1),e}function h(){return d(s.description())}function v(){return d(s.extraInfo())}return t.isFunction(e.isAgent)?c.isAgent=i.newObservableProperty(e.isAgent):c.isAgent=n.observable(!1),c.compute=function(){return c.isAgent()?function(){s||((s={certification:i.newObservableProperty(e.agentDetails.certification),rating:i.newObservableProperty(e.agentDetails.rating),author:i.newObservableProperty(e.agentDetails.author),description:i.newObservableProperty(e.agentDetails.description),website:i.newObservableProperty(e.agentDetails.website),privacyStatement:i.newObservableProperty(e.agentDetails.privacyStatement),termsOfService:i.newObservableProperty(e.agentDetails.termsOfService),extraInfo:i.newObservableProperty(e.agentDetails.extraInfo),messagesModeAll:i.newObservableProperty(e.agentDetails.messages_mode_all)}).capabilities=((r={audio_send:i.newObservableProperty(e.capabilities.audio),video_send:i.newObservableProperty(e.capabilities.video),im_send:i.newObservableProperty(e.capabilities.chat),screen_sharing:i.newObservableProperty(e.capabilities.screenSharing),gvc:i.newObservableProperty(e.capabilities._gvc),group_chat:i.newObservableProperty(e.capabilities._groupChat),file_send:i.newObservableProperty(e.capabilities._fileSend),contact_send:i.newObservableProperty(e.capabilities._contactSend),videomessage_send:i.newObservableProperty(e.capabilities._videoMessageSend),audiomessage_send:i.newObservableProperty(e.capabilities._audioMessageSend),mediamessage_send:i.newObservableProperty(e.capabilities._mediaMessageSend),media_autoplay:i.newObservableProperty(e.capabilities._mediaAutoplay),photo_send:i.newObservableProperty(e.capabilities._photoSend),moji_send:i.newObservableProperty(e.capabilities._mojiSend),location_send:i.newObservableProperty(e.capabilities._locationSend)}).dispose=function(){t.invoke(r,"dispose")},r),s.capabilitiesText=n.computed(f),s.ratingStars=n.computed(m),s.descriptionWithLinks=n.computed(h),s.extraInfoWithLinks=n.computed(v))
	var r
	return s}():u()},c.dispose=function(){c.isAgent.dispose&&c.isAgent.dispose(),u()},c}return s.build=function(e){return new s(e)},s}))
	define("ui/viewModels/people/properties/pstnDetails",["require","vendor/knockout","ui/modelHelpers/personHelper"],(function(e){var t=e("vendor/knockout"),n=e("ui/modelHelpers/personHelper")
	function i(e){var i=this
	function r(){i.phoneNumbers(e.phoneNumbers())}return i.isPstn=t.observable(n.isPstn(e)),i.phoneNumbers=t.observable([]),e.phoneNumbers.changed(r),i.dispose=function(){e.phoneNumbers.changed.off(r)},i}return i.build=function(e){return new i(e)},i})),define("ui/viewModels/people/contact",["require","lodash-compat","vendor/knockout","swx-i18n","swx-constants","swx-service-locator-instance","swx-utils-common","swx-enums","constants/cssClasses","utils/common/statusMapper","ui/modelHelpers/activityMapper","utils/common/cafeObservable","utils/people/lastSeenConverter","ui/viewModels/people/properties/locationText","ui/viewModels/people/properties/displayNameText","ui/viewModels/people/properties/agentDetails","ui/viewModels/people/properties/pstnDetails","swx-utils-chat"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a=e("swx-utils-common").stringUtils,s=e("swx-enums"),c=e("constants/cssClasses"),l=e("utils/common/statusMapper"),u=e("ui/modelHelpers/activityMapper"),d=e("utils/common/cafeObservable"),p=e("utils/people/lastSeenConverter"),f=e("ui/viewModels/people/properties/locationText"),m=e("ui/viewModels/people/properties/displayNameText"),h=e("ui/viewModels/people/properties/agentDetails"),v=e("ui/viewModels/people/properties/pstnDetails"),g=e("swx-utils-chat").messageSanitizer
	function y(e,y){var b,_=this,E=m.build(e),w=f.build(e),S=h.build(e),x=v.build(e),C=o.resolve(r.serviceLocator.FEATURE_FLAGS),T=C.isFeatureOn(r.featureFlags.LAST_SEEN),I=C.isFeatureOn(r.featureFlags.MOBILE_INDICATOR),A=d.newObservableProperty(e.lastSeenAt,{keepAlive:y.keepLastSeenAtSubscription}),M=o.resolve(r.serviceLocator.PROGRESSIVE_TIMEOUT)
	function O(){return u.map(_.activity())}function k(){return _.status()===s.onlineStatus.Online?l.getAvailabilityText(_.status()):_.lastSeen()}_.id=n.observable(e.id()),_.avatar=d.newObservableProperty(e.avatarUrl,{keepAlive:!0}),_.status=d.newObservableProperty(e.status,{keepAlive:y.keepPresenceSubscription}),_.activity=d.newObservableProperty(e.activity,{keepAlive:y.keepActivitySubscription}),_.endpointType=d.newObservableProperty(e.endpointType,{keepAlive:y.keepEndpointTypeSubscription}),_.isAgent=S.isAgent,_.agentDetails=n.computed(S.compute),_.isBlocked=d.newObservableProperty(e.isBlocked),_.isActive=n.observable(!1),_.location=w.location,_.locationText=n.computed(w.compute),_.isPstn=x.isPstn,_.phoneNumbers=x.phoneNumbers,_.isMobile=n.computed((function(){return _.endpointType()===s.endpointType.Mobile&&I})),_.displayName=n.computed(E.compute),_.displayNameUnescaped=n.computed((function(){return t.unescape(_.displayName())})),_.lastSeen=T?n.computed((function(){var e,n,i
	if(void 0===A())return
	return e=t.isString(A())?new Date(A()).getTime():A().getTime(),n=Math.floor((Date.now()-e)/1e3),i=Math.round(n/60),M.reset(_.id(),i),p.getMessage(i)})):n.observable(null),_.statusClassName=n.computed((function(){if(_.isBlocked())return c.presence.BLOCKED
	return l.getStatusIconClass(_.status(),_.endpointType(),I)})),_.textDetails=n.computed((function(){return _.displayName()+", "+_.id()+", "+l.getAvailabilityText(_.status())})),_.displayMessage=n.computed((function(){var e
	if(_.isBlocked())return i.fetch({key:"message_text_contactBlocked"})
	if(_.isAgent()&&_.agentDetails()){var t=_.agentDetails().description()
	if(t)return t}if(_.isPstn()){var n=_.phoneNumbers()
	if(1===n.length)return n[0].displayString()===_.displayName()?"":a.forceLTREmbedding(n[0].displayString())}e=y.moodMessageFirst?O()||k():k()||O()
	return e||_.locationText()||l.getAvailabilityText(_.status(),_.endpointType(),I)})),_.ariaLabel=n.computed((function(){var e=l.getAvailabilityText(_.status()),t=g.stripHTML(_.displayMessage())
	return e===t?_.displayName()+" "+e:_.displayName()+" "+e+" "+t})),_.getPerson=function(){return e},_.dispose=function(){M.stop(_.id(),b),_.avatar.dispose(),_.status.dispose(),_.activity.dispose(),_.endpointType.dispose(),_.isBlocked.dispose(),_.locationText.dispose(),_.displayName.dispose(),_.displayNameUnescaped.dispose(),_.agentDetails.dispose(),A.dispose(),E.dispose(),w.dispose(),S.dispose(),x.dispose(),T&&_.lastSeen.dispose(),_.statusClassName.dispose(),_.displayMessage.dispose(),_.textDetails.dispose(),_.isMobile.dispose()},b=M.start(_.id(),(function(){A.notifySubscribers()}))}return y.build=function(e,t){return new y(e,t)},y})),define("ui/viewModels/people/contactBuilder",["require","exports","module","ui/viewModels/people/contact","vendor/knockout","swx-constants","swx-enums","lodash-compat"],(function(e,t){var n=e("ui/viewModels/people/contact"),i=e("vendor/knockout"),r=e("swx-constants").PEOPLE.showStrategies,o=e("swx-enums").onlineStatus,a=e("lodash-compat")
	t.build=function(e,t){var s
	return t=t||{},a.defaults(t,{keepPresenceSubscription:!0,keepActivitySubscription:!0,keepLastSeenAtSubscription:!0,keepEndpointTypeSubscription:!0,moodMessageFirst:!1}),s=n.build(e,t),t.hideable&&(s=function(e){var t=e.dispose
	return e.hideStrategy=i.observable(),e.isFavorite=i.observable(),e.isHidden=i.computed(n,e),e.dispose=function(){t.call(e),e.isHidden.dispose()},e
	function n(){return e.hideStrategy()===r.AVAILABLE_ONLY?!e.status()||e.status()===o.Offline||e.status()===o.Hidden||e.status()===o.Unknown:e.hideStrategy()===r.AGENTS_ONLY&&!e.isAgent()}}(s)),s}})),define("ui/viewModels/chat/conversationTile",["require","vendor/knockout","ui/viewModels/people/contactBuilder","swx-utils-chat","utils/common/cafeObservable","swx-constants","swx-enums","swx-i18n","swx-service-locator-instance"],(function(e){var t=e("vendor/knockout"),n=e("ui/viewModels/people/contactBuilder"),i=e("swx-utils-chat").messageSanitizer,r=e("utils/common/cafeObservable"),o=e("swx-constants").COMMON,a=e("swx-enums"),s=e("swx-i18n").localization,c=e("swx-service-locator-instance").default
	function l(e,l){var u,d=this
	function p(){var e=d.contact()
	return e?e.displayMessage():function(e,t){if(!e)return""
	c.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.INCLUDE_SELF_IN_PARTICIPANTS_COUNT)&&t++
	return s.fetch({key:"label_text_participant",count:t})}(d.amInConversation(),d.participantCount())}function f(){u&&(u.dispose(),u=null)}d.isGroup=r.newObservableProperty(e.isGroupConversation),d.participantCount=r.newObservableProperty(e.participantsCount),d.selfParticipantState=r.newObservableProperty(e.selfParticipant.state),d.amInConversation=t.computed((function(){return d.selfParticipantState()===a.participantState.Connected})),d.contact=t.observable(),d.isAgent=t.computed((function(){var e=d.contact()
	return!!e&&e.isAgent()})),d.isCertifiedAgent=t.computed((function(){var e=d.contact()
	return!!(d.isAgent()&&e.agentDetails()&&e.agentDetails().certification())})),d.isPstn=t.computed((function(){var e=d.contact()
	return!!e&&e.isPstn()})),d.id=t.computed((function(){var e=d.contact()
	return e?e.id():void 0})),d.statusClassName=t.computed((function(){var e=d.contact()
	return e?e.statusClassName():""})),d.isBlocked=t.computed((function(){var e=d.contact()
	return!!e&&e.isBlocked()})),d.displayMessage=t.computed(p),d.displayMessageTitle=t.computed((function(){return i.stripHTML(p())})),d.dispose=function(){d.isAgent.dispose(),d.isCertifiedAgent.dispose(),d.isPstn.dispose(),d.id.dispose(),d.statusClassName.dispose(),d.isBlocked.dispose(),d.displayMessage.dispose(),d.displayMessageTitle.dispose(),d.amInConversation.dispose(),d.contact()&&d.contact().dispose(),f()},d.isGroup()||(u=e.participants.added((function(e){setTimeout(f)
	var t=n.build(e.person,l.contactOptions)
	d.contact(t)})))}return{build:function(e,t){return new l(e,t=t||{})}}})),define("ui/viewModels/chat/conversationTopic",["require","exports","module","vendor/knockout","swx-i18n","swx-utils-common","swx-constants","utils/common/cafeObservable","ui/modelHelpers/conversationHelper","swx-utils-common","swx-utils-chat"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("swx-utils-common").async,o=e("swx-constants").COMMON,a=e("utils/common/cafeObservable"),s=e("ui/modelHelpers/conversationHelper"),c=e("swx-utils-common").stringUtils,l=e("swx-utils-chat").messageSanitizer,u=function(e){var t,u=this,d=e,p=d.participants(0),f=a.newObservableProperty(d.topic),m=f.subscribe((function(e){E(e),_()})),h=[],v=i.fetch({key:"conversation_header_topic_untitled_conversation"})
	function g(){t||(t=!0,r.execute((function(){var e
	t&&(u.topic((e=h.map((function(e){return s.isPstnEndpoint(e.displayName())?c.forceLTREmbedding(e.displayName()):e.displayName()}))).length<1?v:e.join(o.conversation.TOPIC_DELIMITER)),t=!1)})))}function y(){b(),d.participants().length?d.participants().slice(0,o.conversation.NUMBER_OF_PARTICIPANT_NAMES_IN_TOPIC).forEach((function(e){h.push({displayName:e.person.displayName,subscription:e.person.displayName.changed(g)})})):u.topic(v)}function b(){h.forEach((function(e){e.subscription.dispose()})),h=[]}function _(){b(),d.participants.changed.off(y)}function E(e){var n,i=e?l.getSanitizedTopic(e):v
	s.isPstnEndpoint(i)&&(i=c.forceLTREmbedding(i)),u.topic(""===(n=i.replace(/<[^a\/].*?>(.*?)<\/[^a].*?>/gi,"$1").replace(/(<.*?\.{3,})$/,"").trim())?"":l.validateUnescapedLink(n).replace(/&lt;/g,"<").replace(/&gt;/g,">")),t=!1}u.topic=n.observable(v),!d.isGroupConversation()&&p&&(u.displayName=a.newObservableProperty(p.person.displayName)),f()?E(f()):d.participants.changed(y),u.dispose=function(){m.dispose(),_()}}
	t.build=function(e){return new u(e)}})),define("ui/viewModels/calling/plugin/startStepViewModel",["require","exports","module","swx-constants","utils/common/cafeObservable","swx-i18n","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic"],(function(e,t){var n=e("swx-constants").CALLING,i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("ui/telemetry/actions/actionNames"),a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default,c=e("ui/viewModels/chat/conversationTile"),l=e("ui/viewModels/chat/conversationTopic"),u=function(e){var n=e.next,u=e.conversation,d=s.resolve(a.serviceLocator.FEATURE_FLAGS),p=l.build(u),f=c.build(u)
	this.id=t.STEP_ID,this.label=r.fetch({key:"pluginInstall_label_text_start"}),this.avatar=i.newObservableProperty(u.avatarUrl),this.isGroupConversation=i.newObservableProperty(u.isGroupConversation),this.showAutoUpdateDisclaimer=!d.isFeatureOn(a.featureFlags.USE_BUSINESS_WORDING),this.topic=p.topic,this.isPstn=f.isPstn,this.show=function(){s.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(o.audioVideo.pluginInstall.start)},this.close=function(){e.close()},this.installClick=function(){n()}}
	t.STEP_ID=n.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_START,t.build=function(e){return new u(e)}})),define("ui/viewModels/calling/plugin/closeStepViewModel",["require","exports","module","ui/viewModels/calling/helpers/browserInstallContent","swx-constants","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("ui/viewModels/calling/helpers/browserInstallContent"),i=e("swx-constants").CALLING,r=e("ui/telemetry/actions/actionNames"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=function(e){var s=e.next,c=e.close,l=n.getInstallResources()
	this.id=t.STEP_ID,this.closeScreenImageUrl=l.images.closeScreen,this.isFirefox=e.isFirefox,this.next=function(){var e=a.resolve(o.serviceLocator.ACTION_TELEMETRY)
	s(),e.recordAction(r.audioVideo.pluginInstall.stayInFlow)},this.close=function(){var t=a.resolve(o.serviceLocator.ACTION_TELEMETRY)
	e.onPluginInstallEnded(i.PLUGIN_INSTALL_EXIT_METHOD.CLOSE,!1),c(),t.recordAction(r.audioVideo.pluginInstall.leave)}}
	t.STEP_ID=i.CALLING_SETUP_STEPS.CLOSE_CALLING_SETUP,t.build=function(e){return new s(e)}})),define("ui/viewModels/calling/plugin/firefoxUnableToCallStepViewModel",["require","exports","module","swx-constants","utils/common/cafeObservable","swx-i18n","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic"],(function(e,t){var n=e("swx-constants").CALLING,i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("ui/telemetry/actions/actionNames"),a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default,c=e("ui/viewModels/chat/conversationTile"),l=e("ui/viewModels/chat/conversationTopic"),u=function(e){var n=e.conversation,u=l.build(n),d=c.build(n)
	this.id=t.STEP_ID,this.label=r.fetch({key:"pluginInstall_label_text_start"}),this.avatar=i.newObservableProperty(n.avatarUrl),this.isGroupConversation=i.newObservableProperty(n.isGroupConversation),this.topic=u.topic,this.isPstn=d.isPstn,this.show=function(){s.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(o.audioVideo.pluginInstall.firefoxUnableToCall)},this.close=function(){e.close()}}
	t.STEP_ID=n.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_FIREFOX_UNABLE_TO_CALL,t.build=function(e){return new u(e)}})),define("browser/chrome",[],(function(){return window.chrome||{}})),define("browser/document",[],(function(){return document})),define("ui/viewModels/calling/plugin/extensionInstallHelper",["require","exports","module","browser/document","experience/settings"],(function(e,t){var n=e("browser/document"),i=e("experience/settings"),r=function(){this.buildLinkElement=function(){var e=n.createElement("link")
	return e.setAttribute("rel","chrome-webstore-item"),e.setAttribute("href",i.shellApp.chromeExtensionWebstoreUrl),e},this.buildContentScriptElement=function(){var e=n.createElement("script"),t="chrome-extension://"+i.shellApp.chromeExtensionId+"/content-script.js"
	return e.setAttribute("src",t),e}}
	t.build=function(){return new r}})),define("ui/viewModels/calling/plugin/extensionInstallStepViewModel",["require","exports","module","browser/chrome","browser/document","experience/settings","swx-constants","ui/viewModels/calling/plugin/extensionInstallHelper","ui/viewModels/calling/helpers/browserInstallContent","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("browser/chrome"),i=e("browser/document"),r=e("experience/settings"),o=e("swx-constants").CALLING,a=e("ui/viewModels/calling/plugin/extensionInstallHelper"),s=e("ui/viewModels/calling/helpers/browserInstallContent"),c=e("ui/telemetry/actions/actionNames"),l=e("swx-constants").COMMON,u=e("swx-service-locator-instance").default,d=function(e){var o=s.getInstallResources(),d=a.build()
	function p(){var t
	t=d.buildContentScriptElement(),i.head.appendChild(t),e.next()}function f(){e.nextOnFailed()}this.id=t.STEP_ID,this.skypeChromeImageUrl=o.images.extensionStart,this.isFirefox=e.isFirefox,this.show=function(){var e,t=u.resolve(l.serviceLocator.ACTION_TELEMETRY)
	e=d.buildLinkElement(),i.head.appendChild(e),t.recordAction(c.audioVideo.pluginInstall.installExtension)},this.close=function(){e.close()},this.installClick=function(){try{n.webstore.install(r.shellApp.chromeExtensionWebstoreUrl,p,f)}catch(e){f()}}}
	t.STEP_ID=o.CALLING_SETUP_STEPS.OVERLAY_EXTENSION_INSTALL,t.build=function(e){return new d(e)}})),define("ui/viewModels/calling/plugin/extensionInstallFailedStepViewModel",["require","exports","module","browser/document","browser/window","experience/settings","swx-constants","ui/viewModels/calling/plugin/extensionInstallHelper","ui/viewModels/calling/helpers/browserInstallContent"],(function(e,t){var n=e("browser/document"),i=e("browser/window"),r=e("experience/settings"),o=e("swx-constants").CALLING,a=e("ui/viewModels/calling/plugin/extensionInstallHelper"),s=e("ui/viewModels/calling/helpers/browserInstallContent"),c=function(e){var o,c=s.getInstallResources(),l=a.build()
	function u(){var e=n.querySelector("head"),t=l.buildContentScriptElement()
	t.onload=d,t.onerror=e.removeChild.bind(e,t),e.appendChild(t)}function d(){i.clearInterval(o),e.next()}this.id=t.STEP_ID,this.chromeWebstoreUrl=r.shellApp.chromeExtensionWebstoreUrl,this.imageUrl=c.images.extensionInstallFailed,this.isFirefox=e.isFirefox,this.show=function(){o=i.setInterval(u,1e3)},this.close=function(){o&&i.clearInterval(o),e.close()}}
	t.STEP_ID=o.CALLING_SETUP_STEPS.OVERLAY_EXTENSION_INSTALL_FAILED,t.build=function(e){return new c(e)}})),define("ui/viewModels/calling/plugin/extensionInstalledStepViewModel",["require","exports","module","swx-enums","swx-cafe-application-instance","swx-constants","ui/viewModels/calling/helpers/browserInstallContent"],(function(e,t){var n=e("swx-enums"),i=e("swx-cafe-application-instance"),r=e("swx-constants").CALLING,o=e("ui/viewModels/calling/helpers/browserInstallContent"),a=function(e){var r=e.next,a=o.getInstallResources(),s=i.get().personsAndGroupsManager.mePerson.capabilities.audio
	function c(){s.changed.off(l)}function l(e,t){t!==n.callingNotSupportedReasons.PluginNotInstalled&&(c(),r())}this.id=t.STEP_ID,this.getPluginImageUrl=a.images.extensionInstallPlugin,this.isFirefox=e.isFirefox,this.show=function(){s.reason===n.callingNotSupportedReasons.PluginNotInstalled?s.changed(l):r()},this.close=function(){c(),e.close()},this.installClick=function(){c(),r()}}
	t.STEP_ID=r.CALLING_SETUP_STEPS.OVERLAY_EXTENSION_INSTALLED,t.build=function(e){return new a(e)}})),define("ui/viewModels/calling/plugin/unblockStepViewModel",["require","exports","module","swx-cafe-application-instance","ui/viewModels/calling/helpers/browserInstallContent","swx-enums","swx-i18n","swx-constants"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("ui/viewModels/calling/helpers/browserInstallContent"),r=e("swx-enums"),o=e("swx-i18n").localization,a=e("swx-constants").CALLING,s=function(e){var s=e.next,c=e.close,l=i.getInstallResources(),u=n.get().personsAndGroupsManager.mePerson.capabilities.audio
	function d(t,n){n!==r.callingNotSupportedReasons.PluginBlocked&&(e.conversation||e.onPluginInstallEnded(a.PLUGIN_INSTALL_EXIT_METHOD.PLUGIN_DETECTED,!0,a.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_UNBLOCK),u.changed.off(d),s())}this.id=t.STEP_ID,this.label=o.fetch({key:"pluginInstall_label_text_unblock"}),this.unblockText=l.text.unblock,this.unblockImageUrl=l.images.unblock,this.isFirefox=e.isFirefox,this.show=function(){u.changed(d)},this.close=function(){c()}}
	t.STEP_ID=a.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_UNBLOCK,t.build=function(e){return new s(e)}})),define("ui/viewModels/calling/plugin/callbackStepViewModel",["require","exports","module","swx-constants","utils/common/cafeObservable","swx-i18n","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic"],(function(e,t){var n=e("swx-constants").CALLING,i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("ui/viewModels/chat/conversationTile"),a=e("ui/viewModels/chat/conversationTopic"),s=function(e){var s=e.next,c=e.conversation,l=a.build(c),u=o.build(c)
	this.id=t.STEP_ID,this.label=r.fetch({key:"pluginInstall_label_text_continue"}),this.conversationModel=c,this.avatar=i.newObservableProperty(c.avatarUrl),this.isGroupConversation=i.newObservableProperty(c.isGroupConversation),this.topic=l.topic,this.isPstn=u.isPstn,this.placeCallTextKey=function(){return e.isOutgoing?"pluginInstall_callback_text_call":"pluginInstall_callback_text_accept"},this.placeCall=function(){e.onPluginInstallEnded(n.PLUGIN_INSTALL_EXIT_METHOD.CALL_STARTED,!0,n.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_CALLBACK),s()},this.notNow=function(){e.onPluginInstallEnded(n.PLUGIN_INSTALL_EXIT_METHOD.CLOSE,!0,n.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_CALLBACK),s()}}
	t.STEP_ID=n.CALLING_SETUP_STEPS.OVERLAY_PLUGIN_CALLBACK,t.build=function(e){return new s(e)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-overlay/lib/helpers",["require","exports"],e)}((function(e,t){var n,i
	t.urlRedirect=function(e){window.location.href=e},t.platform=(n=window.navigator.userAgent,i="",n.match(/windows/i)?i="windows":n.match(/macintosh/i)?i="mac":n.match(/linux/i)?i="linux":n.match(/android/i)?i="android":n.match(/iphone|ipad|ipod/i)?i="ios":n.match(/blackberry/i)&&(i="blackberry"),i),t.onMobileBrowser=function(){var e=e,t=window.navigator.userAgent
	return-1!==["android","ios","blackberry"].indexOf(e)||!("windows"!==e||!t.match(/phone|iemobile/i))}(),t.extend=function(e,t){var n,i,r=Object.keys(t),o=r.length
	for(i=0;i<o;i++)e[n=r[i]]=t[n]
	return e},t.cssTransitionEndEventName=function(){var e,t=document.createElement("div"),n={transition:"transitionend",OTransition:"otransitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"}
	for(e in n)if(n.hasOwnProperty(e)&&void 0!==t.style[e])return n[e]
	return""}(),t.cssTransitionsSupported=""!==t.cssTransitionEndEventName,t.hasClass=function(e,t){var n=new RegExp("(?:^|\\s)"+t+"(?!\\S)","g")
	return!!e.className.match(n)},t.addClass=function(e,n){return!(!e||!0===t.hasClass(e,n))&&(e.className+=" "+n,!0)},t.removeClass=function(e,n){var i
	return!(!e||!1===t.hasClass(e,n))&&(i=new RegExp("(?:^|\\s)"+n+"(?!\\S)","g"),e.className=e.className.replace(i,""),!0)},t.bind=document.addEventListener?function(e,t,n){e.addEventListener(t,n,!1)}:function(e,t,n){e.attachEvent(t,n)},t.unbind=document.removeEventListener?function(e,t,n){e.removeEventListener(t,n,!1)}:function(e,t,n){e.detachEvent(t,n)},
	/*! discuss at: http://phpjs.org/functions/base64_decode/
			original by: Tyler Akins (http://rumkin.com)
			improved by: Thunder.m
			improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
			improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
			input by: Aman Gupta
			input by: Brett Zamir (http://brett-zamir.me)
			bugfixed by: Onno Marsman
			bugfixed by: Pellentesque Malesuada
			bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
			example 1: base64_decode('S2V2aW4gdmFuIFpvbm5ldmVsZA==');
			returns 1: 'Kevin van Zonneveld'
			example 2: base64_decode('YQ===');
			returns 2: 'a'
			example 3: base64_decode('4pyTIMOgIGxhIG1vZGU=');
			returns 3: '✓ à la mode' */
	t.base64Decode=function(e){var t,n,i,r,o,a,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c=0,l=0,u=[]
	if(!e)return e
	e+=""
	do{t=(a=s.indexOf(e.charAt(c++))<<18|s.indexOf(e.charAt(c++))<<12|(r=s.indexOf(e.charAt(c++)))<<6|(o=s.indexOf(e.charAt(c++))))>>16&255,n=a>>8&255,i=255&a,u[l++]=64===r?String.fromCharCode(t):64===o?String.fromCharCode(t,n):String.fromCharCode(t,n,i)}while(c<e.length)
	return u.join("").replace(/\0+$/,"")},t.murmurhash=function(e,t){for(var n,i,r=3&e.length,o=e.length-r,a=t,s=3432918353,c=461845907,l=0;l<o;)i=255&e.charCodeAt(l)|(255&e.charCodeAt(++l))<<8|(255&e.charCodeAt(++l))<<16|(255&e.charCodeAt(++l))<<24,++l,a=27492+(65535&(n=5*(65535&(a=(a^=i=(65535&(i=(i=(65535&i)*s+(((i>>>16)*s&65535)<<16)&4294967295)<<15|i>>>17))*c+(((i>>>16)*c&65535)<<16)&4294967295)<<13|a>>>19))+((5*(a>>>16)&65535)<<16)&4294967295))+((58964+(n>>>16)&65535)<<16)
	switch(i=0,r){case 3:i^=(255&e.charCodeAt(l+2))<<16
	case 2:i^=(255&e.charCodeAt(l+1))<<8
	case 1:a^=i=(65535&(i=(i=(65535&(i^=255&e.charCodeAt(l)))*s+(((i>>>16)*s&65535)<<16)&4294967295)<<15|i>>>17))*c+(((i>>>16)*c&65535)<<16)&4294967295}return a^=e.length,a=2246822507*(65535&(a^=a>>>16))+((2246822507*(a>>>16)&65535)<<16)&4294967295,a=3266489909*(65535&(a^=a>>>13))+((3266489909*(a>>>16)&65535)<<16)&4294967295,(a^=a>>>16)>>>0},t.parseJSONString=function(e){var t
	try{t=JSON.parse(e)}catch(n){return!1}return t}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-focus-handler/lib/focusHandler",["require","exports","lodash-compat"],e)}((function(e,t){var n,i,r=e("lodash-compat")
	function o(){var e,t,n,o=r.debounce(s,50)
	function a(e,t){n={element:e,priority:t}}function s(){var e
	n&&(e=n.element)&&(e.focus(),t(e)),o.cancel(),n=null}return{addFocusRequestToQueue:function(r,c){return void 0===c&&(c=i.Low),n||(e=new Promise((function(e){t=e}))),c===i.Immediate?(a(r,c),s()):(!n||c<n.priority)&&a(r,c),o(),e}}}(function(e){e[e.Immediate=0]="Immediate",e[e.High=1]="High",e[e.Low=2]="Low"})(i=t.Priorities||(t.Priorities={})),t.get=function(){return n||(n=o()),n},t.reset=function(){n=null},t.build=o})),define("swx-focus-handler",["swx-focus-handler/lib/focusHandler"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-overlay/lib/overlay",["require","exports","./helpers","swx-focus-handler"],e)}((function(e,t){var n,i,r,o,a,s=e("./helpers"),c=e("swx-focus-handler"),l=null,u=null,d=!1,p=!1,f={},m={},h={next:{activeClass:"next",activeTransitionClass:"",inactiveClass:"prev",inactiveTransitionClass:"prevInTransition"},previous:{activeClass:"prev",activeTransitionClass:"prevInTransition",inactiveClass:"next",inactiveTransitionClass:""}}
	function v(){return!(!m.content||!m.contentParent)&&(m.contentParent.appendChild(m.content),l.removeChild(m.slide),m={},!0)}function g(e){var t
	!1!==d&&(t=e.target,!1===l.contains(t)&&y())}function y(){c.get().addFocusRequestToQueue(f.contentContainer)}function b(e){27===e.keyCode&&t.hide()}n=document.createElement("div"),s.addClass(n,"overlayContainer"),l=n,i=document.createElement("div"),r=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div"),s.addClass(i,"overlaySlide"),s.addClass(r,"table"),s.addClass(o,"tableCell"),s.addClass(a,"overlaySlideContent"),s.addClass(a,"themeWhite"),a.tabIndex=-1,a.setAttribute("role","dialog"),a.setAttribute("aria-label",""),o.appendChild(a),r.appendChild(o),i.appendChild(r),u=i,s.bind(document,"focusin",g),p=!1,t.display=function(e,t,n,i){var r,o=null
	return p=!!(i=i||{}).skipSlideCreation&&i.skipSlideCreation,"string"==typeof e&&("string"!=typeof t&&(t=""),0===e.indexOf("#")&&(e=e.substr(1)),null!==(r=document.getElementById(e))&&(r!==f.content&&(void 0!==n&&!0===d&&void 0!==h[n]&&(o=h[n]),p||(m=s.extend({},f),f=function(e){var t={}
	return t.content=e,t.contentParent=e.parentNode,t.slide=u.cloneNode(!0),t.contentContainer=t.slide.querySelector(".overlaySlideContent"),t.contentContainer.appendChild(e),t}(r),f.contentContainer.setAttribute("aria-label",t)),!1===d&&(document.body.appendChild(l),d=!0),null!==o&&(s.removeClass(l,o.activeClass),s.removeClass(l,o.inactiveClass),s.addClass(l,o.activeClass)),function(e){var t,n=e.length
	for(t=0;t<n;t++)s.addClass(l,e[t])}(i.containerClasses),p?(s.unbind(document,"focusin",g),l.appendChild(r)):(function(e){var t=m.slide
	!1!==d&&!1!==s.cssTransitionsSupported&&null!==e?(""!==e.inactiveTransitionClass&&(s.bind(t,s.cssTransitionEndEventName,(function(){s.removeClass(t,e.inactiveTransitionClass)})),s.addClass(t,e.inactiveTransitionClass)),s.bind(t,s.cssTransitionEndEventName,v),s.addClass(t,e.inactiveClass)):v()}(o),function(e){!1!==s.cssTransitionsSupported&&null!==e?(""!==e.activeTransitionClass&&(s.bind(f.slide,s.cssTransitionEndEventName,(function(){s.removeClass(f.slide,e.activeTransitionClass)})),s.addClass(f.slide,e.activeTransitionClass)),s.addClass(f.slide,e.activeClass),window.setTimeout((function(){s.removeClass(f.slide,e.activeClass)}),10),l.appendChild(f.slide)):l.appendChild(f.slide)}(o),y()),!0)))},t.hide=function(){return m=s.extend({},f),!(!p&&!1===v())&&(l.parentNode.removeChild(l),d=!1,s.unbind(document,"keydown",b),f={},!0)},t.bindHide=function(e){return!(!e||"object"!=typeof e)&&(s.bind(e,"click",t.hide),s.bind(document,"keydown",b),!0)},t.isOverlayDisplayed=function(){return d},t.getOverlayContainer=function(){return l}})),define("swx-overlay",["swx-overlay/lib/overlay"],(function(e){return e})),define("utils/common/accessibility",["require","exports","module","lodash-compat","swx-constants","browser/dom","vendor/knockout"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("browser/dom"),o=e("vendor/knockout"),a="showFocusRing"
	t.initFocusRing=function(e){e.addEventListener("keydown",(function(){r.hasClass(e,a)||r.addClass(e,a)}),!1),e.addEventListener("mousedown",(function(){r.removeClass(e,a)}),!1)},t.updateAriaLiveHtml=function(e,t){if(!o.isObservable(e))throw new Error("Parameter must be a ko.observable.")
	e(""),e("<span>"+t+"</span>")},t.narrator=new function(){var e=this,t={}
	this.announce=function(e,r){(function(e,i,r){t.hasOwnProperty(e)&&n.forEach(t[e],(function(e){e(i,r)}))})(i.events.browser.NARRATOR_ANNOUNCE,e,r)},this.on=function(i,r){if(i&&r){t.hasOwnProperty(i)||(t[i]=[]),n.any(t[i],(function(e){return e===r}))||t[i].push(r)
	var o=n.partial(e.off,i,r)
	return{cancel:o,dispose:o}}},this.off=function(e,i){return t.hasOwnProperty(e)?n.first(n.remove(t[e],(function(e){return e===i}))):null},this.removeAllListeners=function(e){e?t.hasOwnProperty(e)&&delete t[e]:t={}}}})),define("ui/modalDialog/modalDialog",["require","exports","module","browser/dom","browser/document","vendor/knockout","swx-constants","swx-constants","swx-overlay","constants/cssClasses","utils/common/accessibility","swx-g11n"],(function(e,t){var n=e("browser/dom"),i=e("browser/document"),r=e("vendor/knockout"),o=e("swx-constants").KEYS,a=e("swx-constants").COMMON,s=e("swx-overlay"),c=e("constants/cssClasses"),l=e("utils/common/accessibility"),u=e("swx-g11n").globalization,d=!1
	function p(){return n.findElement("."+c.MODAL_DIALOG+":not(."+c.HIDE+")")}function f(e){e.keyCode===o.ESCAPE&&t.hide()}t.build=function(e,t,o){var a=function(e,t){var o,a=n.getElementById(e)
	a&&r.removeNode(a)
	return(o=n.createElement("div")).innerHTML=t,a=o.firstChild,i.body.appendChild(a),a}(e,o)
	return r.applyBindings(t,a),a},t.show=function(e,t,r,o){var p,m,h=s.isOverlayDisplayed()
	r=r||"",s.display(e,t,r,{containerClasses:[c.base.SWX,c.base.DESKTOP],skipSlideCreation:o}),h||l.initFocusRing(s.getOverlayContainer()),p=n.getElementById(e),m=n.getParentWithClass(p,c.base.OVERLAY_CONTAINER),u.initLocaleDirection(m),n.removeClass(p,c.HIDE),i.addEventListener(a.events.browser.KEYDOWN,f,!1),d=!0},t.hide=function(e){var t=n.getElementById(e)||p()
	i.removeEventListener(a.events.browser.KEYDOWN,f,!1),s.hide(),t&&n.addClass(t,c.HIDE),d=!1},t.dispose=function(e){var i=n.getElementById(e)||p()
	t.hide(e),i&&r.removeNode(i)},t.isDisplayed=function(){return d}})),define("ui/viewModels/calling/plugin/pluginInstallViewModel",["require","exports","module","ui/viewModels/calling/plugin/downloadStepViewModel","ui/viewModels/calling/plugin/startStepViewModel","ui/viewModels/calling/plugin/closeStepViewModel","ui/viewModels/calling/plugin/firefoxUnableToCallStepViewModel","ui/viewModels/calling/plugin/extensionInstallStepViewModel","ui/viewModels/calling/plugin/extensionInstallFailedStepViewModel","ui/viewModels/calling/plugin/extensionInstalledStepViewModel","ui/viewModels/calling/plugin/unblockStepViewModel","ui/viewModels/calling/plugin/callbackStepViewModel","ui/telemetry/telemetryClient","browser/document","swx-utils-common","vendor/knockout","swx-constants","experience/settings","swx-utils-common","swx-browser-detect","ui/modalDialog/modalDialog","swx-cafe-application-instance","browser/window"],(function(e,t){var n=e("ui/viewModels/calling/plugin/downloadStepViewModel"),i=e("ui/viewModels/calling/plugin/startStepViewModel"),r=e("ui/viewModels/calling/plugin/closeStepViewModel"),o=e("ui/viewModels/calling/plugin/firefoxUnableToCallStepViewModel"),a=e("ui/viewModels/calling/plugin/extensionInstallStepViewModel"),s=e("ui/viewModels/calling/plugin/extensionInstallFailedStepViewModel"),c=e("ui/viewModels/calling/plugin/extensionInstalledStepViewModel"),l=e("ui/viewModels/calling/plugin/unblockStepViewModel"),u=e("ui/viewModels/calling/plugin/callbackStepViewModel"),d=e("ui/telemetry/telemetryClient"),p=e("browser/document"),f=e("swx-utils-common").guid,m=e("vendor/knockout"),h=e("swx-constants"),v=e("experience/settings"),g=e("swx-utils-common").stopwatch,y=e("swx-browser-detect").default,b=e("ui/modalDialog/modalDialog"),_=e("swx-cafe-application-instance"),E=e("browser/window"),w=4e3,S=h.CALLING,x=h.OUT_OF_BROWSER,C=function(e,t){if("string"!=typeof e)throw new Error("source param is mandatory")
	t=t||{}
	var h,C,T,I=this,A=_.get(),M=y.getBrowserInfo(),O=M.browserName===y.BROWSERS.FIREFOX,k=f.create(),N=[],P=0,R=0,L=S.NA,D=t.conversation,U=t.isOutgoing
	function F(){E.clearInterval(T),b.hide()}function B(){P=R,q("next")}function V(){R=P,P=N.length-1,W(h,"next")}function G(){R=P,P++,q("next")}function H(){R=P,P+=2,q("next")}function q(e){P>=N.length?F():W(N[P],e)}function W(e,t){I.activeStep(e),b.show(e.id,e.label,t),e.show&&e.show()}function j(e,n,i){(function(e,t,n){var i={name:S.TELEMETRY_EVENTS.PLUGIN_INSTALL_ENDED,plugin_install_context_id:k,source:S.NA,installationReason:L,success:t.toString(),exitMethod:e,durationInMs:C.duration().toString(10),closeScreen:n||N[R].id}
	d.get().sendEvent(v.telemetry.uiTenantToken,"PluginInstall",i)})(e,n,i),t.done&&t.done(e,n)}this.firefoxUnableToCall=m.observable(O&&M.browserMajorVersion>51),this.activeStep=m.observable(),this.start=function(){if(I.firefoxUnableToCall())return f=o.build({close:F,conversation:D}),I.activeStep(f),b.show("closeCallingSetup",f.label,""),void f.show()
	var f,m,_
	C=g.build(),function(){var e=M.isBrowserDefaultToBlockPlugin,o=M.isInBrowserPluginSupported,d=M.browserName===y.BROWSERS.CHROME,f=Boolean(p.querySelector(x.shellAppMetaSelector)),m=t.onlyUnblock
	U&&D&&!m&&(v={onPluginInstallEnded:j,next:G,close:V,conversation:D},N.push(i.build(v)))
	var v
	!d||o||f||m||(function(){var e={isFirefox:O,onPluginInstallEnded:j,next:H,nextOnFailed:G,close:V,conversation:D}
	N.push(a.build(e))}(),function(){var e={isFirefox:O,onPluginInstallEnded:j,next:G,close:V,conversation:D}
	N.push(s.build(e))}(),function(){var e={isFirefox:O,onPluginInstallEnded:j,next:G,close:V,conversation:D}
	N.push(c.build(e))}())
	m||function(e){var t
	e=e||{},t={onPluginInstallEnded:j,next:D||e.isUnblockStepIncluded?G:F,close:V,conversation:D,suppressEndedEvent:e.isUnblockStepIncluded},N.push(n.build(t))}({isUnblockStepIncluded:e})
	e&&function(){var e={isFirefox:O,onPluginInstallEnded:j,next:D?G:F,close:V,conversation:D}
	N.push(l.build(e))}()
	D&&function(){var e={onPluginInstallEnded:j,next:F,close:F,conversation:D,isVideo:t.isVideo,isOutgoing:U}
	N.push(u.build(e))}();(function(){var e={onPluginInstallEnded:j,next:B,close:F}
	h=r.build(e)})()}(),P=0,q(""),m=A.devicesManager.mediaCapabilities,T=m.isPluginInstalled?E.setInterval((function(){m.isPluginInstalled.get()}),w):E.setInterval((function(){A.devicesManager.checkMediaCapabilities()}),w),_={name:S.TELEMETRY_EVENTS.PLUGIN_INSTALL_STARTED,plugin_install_context_id:k,source:e,installationReason:L,success:S.NA,exitMethod:S.NA,durationInMs:S.NA,closeScreen:S.NA},d.get().sendEvent(v.telemetry.uiTenantToken,"PluginInstall",_)}}
	t.build=function(e,t){return new C(e,t)}})),define("text",{load:function(e){throw new Error("Dynamic load not allowed: "+e)}}),define("text!views/calling/pluginInstall.html",[],(function(){return'<div id="overlayPluginSlides" class="swx-overlayModal swx-hide">\r\n    \x3c!-- ko ifnot: firefoxUnableToCall --\x3e\r\n    \x3c!-- ko with: activeStep --\x3e\r\n\r\n    <div id="overlayPluginStart" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n              <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_main_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_main_text_subtitle\' }"></p>\r\n            </div>\r\n            <swx-avatar params="isGroupAvatar: isGroupConversation, avatar: avatar, displayName: topic, isPstn: isPstn, size: 160" class="avatar"></swx-avatar>\r\n            <div class="buttonRow">\r\n                <button class="btn green narrow large" data-bind="click: installClick" type="button">\r\n                    <span class="iconfont after arrowRight pull2" data-bind="l10n: { \'key\': \'pluginInstall_main_text_install\' }"></span>\r\n                </button>\r\n            </div>\r\n            \x3c!-- ko if: showAutoUpdateDisclaimer --\x3e\r\n            <div class="autoUpdateDisclaimer">\r\n                <p data-bind="l10n: { \'key\': \'pluginInstall_label_text_autoUpdateDisclaimer\' }"></p>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayExtensionInstall" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n              <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_text_subtitle\' }"></p>\r\n            </div>\r\n            <div class="illustration">\r\n                <img data-bind="attr: { src: skypeChromeImageUrl }, css: { firefox: isFirefox }" alt="" role="presentation" aria-hidden="true"/>\r\n            </div>\r\n            <div class="buttonRow">\r\n                <button class="btn green narrow large" data-bind="click: installClick" type="button">\r\n                    <span class="iconfont after arrowRight pull2" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_text_add_extension\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayExtensionInstallFailed" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n              <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_install_failed_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_install_failed_text_subtitle\' }"></p>\r\n            </div>\r\n            <div class="illustration">\r\n                <img data-bind="attr: { src: imageUrl }, css: { firefox: isFirefox }" alt="" role="presentation" aria-hidden="true"/>\r\n            </div>\r\n            <div class="buttonRow">\r\n                <a class="btn green narrow large" target="_blank" data-bind="attr: { href: chromeWebstoreUrl }">\r\n                    <span class="iconfont after arrowRight pull2" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_install_failed_go_to_chrome_webstore_text\' }"></span>\r\n                </a>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayExtensionInstalled" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n              <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_installed_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_installed_text_subtitle\' }"></p>\r\n            </div>\r\n            <div class="illustration">\r\n                <img data-bind="attr: { src: getPluginImageUrl }, css: { firefox: isFirefox }" alt="" role="presentation" aria-hidden="true"/>\r\n            </div>\r\n            <div class="buttonRow">\r\n                <button class="btn green narrow large" data-bind="click: installClick" type="button">\r\n                    <span class="iconfont after arrowRight pull2" data-bind="l10n: { \'key\': \'pluginInstall_extension_main_installed_get_plugin_text\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="closeCallingSetup" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_main_close_screen_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_main_close_screen_subtitle\' }"></p>\r\n            </div>\r\n            <div class="illustration">\r\n                <img data-bind="attr: { src: closeScreenImageUrl }, css: { firefox: isFirefox }" alt="" role="presentation" aria-hidden="true"/>\r\n            </div>\r\n            <div class="buttonRow">\r\n                <button class="btn green narrow large" data-bind="click: next" type="button">\r\n                    <span class="iconfont after arrowRight pull2" data-bind="l10n: { \'key\': \'pluginInstall_main_close_screen_finish_text\' }">\r\n                    </span>\r\n                </button>\r\n\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span data-bind="l10n: { \'key\': \'pluginInstall_main_close_screen_leave_text\' }"></span>\r\n                </button>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayPluginSteps" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n            <div class="left">\r\n                <button class="btn narrow transparent" data-bind="click: restartDownload" type="button">\r\n                    <span class="iconfont reload pull2" data-bind="l10n: { \'key\': \'pluginInstall_steps_text_restart\' }"></span>\r\n                </button>\r\n            </div>\r\n            <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_steps_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_steps_text_subtitle\' }"></p>\r\n            </div>\r\n            <div class="grid verticalGutter">\r\n                <div class="row">\r\n                    <div class="column unit4">\r\n                        <div class="icon">\r\n                            <img data-bind="attr: { src: downloadImage }" alt="" role="presentation" aria-hidden="true"/>\r\n                        </div>\r\n                        <div class="text">\r\n                            <p class="fontSize-h3 fontSizeNarrow-h4" data-bind="text: downloadText"></p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="column unit4">\r\n                        <div class="icon">\r\n                            <img data-bind="attr: { src: installImage }" alt="" role="presentation" aria-hidden="true"/>\r\n                        </div>\r\n                        <div class="text">\r\n                            <p class="fontSize-h3 fontSizeNarrow-h4" data-bind="text: installText"></p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="column unit4">\r\n                        <div class="icon">\r\n                            <img data-bind="attr: { src: enjoyImage }" alt="" role="presentation" aria-hidden="true"/>\r\n                        </div>\r\n                        <div class="text">\r\n                            <p class="fontSize-h3 fontSizeNarrow-h4" data-bind="text: enjoyText"></p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \x3c!-- ko if: showTermsAndPrivacy --\x3e\r\n            <div class="termsOfUse">\r\n                <p data-bind="l10n: { \'key\': \'pluginInstall_steps_text_termsAndPrivacy\', \'params\': { \'terms_link\': getLink(\'terms\'), \'privacy_link\': getLink(\'privacy\') } }"></p>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: showAutoUpdateDisclaimer --\x3e\r\n            <div class="autoUpdateDisclaimer">\r\n                <p data-bind="l10n: { \'key\': \'pluginInstall_label_text_autoUpdateDisclaimer\' }"></p>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayPluginUnblock" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayControls">\r\n            <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_unblock_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="text: unblockText"></p>\r\n            </div>\r\n            <div class="illustration">\r\n                <img data-bind="attr: { src: unblockImageUrl }, css: { firefox: isFirefox }" alt="" role="presentation" aria-hidden="true"/>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="overlayPluginCallback" data-bind="if: $parent.activeStep().id === $element.id">\r\n        <div class="overlayMain">\r\n            <h1 class="ellipsis" data-bind="l10n: { \'key\': \'pluginInstall_callback_text_title\', params: { displayName: topic }  }"></h1>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_callback_text_subtitle\' }"></p>\r\n            </div>\r\n            <swx-avatar params="isGroupAvatar: isGroupConversation, avatar: avatar, displayName: topic, isPstn: isPstn, size: 160" class="avatar"></swx-avatar>\r\n            <div class="dual buttonRow">\r\n                <div class="column alignRight">\r\n                    <button class="btn primary large" data-bind="click: placeCall" type="button">\r\n                        <span data-bind="l10n: { \'key\': placeCallTextKey() }"></span>\r\n                    </button>\r\n                </div>\r\n                <div class="column alignLeft">\r\n                    <button class="btn secondary large" data-bind="click: notNow" type="button">\r\n                        <span data-bind="l10n: { \'key\': \'pluginInstall_callback_text_notNow\' }"></span>\r\n                    </button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: firefoxUnableToCall --\x3e\r\n    \x3c!-- ko with: activeStep --\x3e\r\n    <div id="closeCallingSetup" data-bind="if: $parent.activeStep().id === \'overlayPluginFirefoxUnableToCall\'">\r\n        <div class="overlayControls">\r\n              <div class="right">\r\n                <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <div class="overlayMain">\r\n            <div class="title">\r\n                <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'pluginInstall_firefox_unable_to_call_text_title\' }"></h1>\r\n            </div>\r\n            <div class="subtitle">\r\n                <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'pluginInstall_firefox_unable_to_call_text_subtitle\' }"></p>\r\n            </div>\r\n            <swx-avatar params="isGroupAvatar: isGroupConversation, avatar: avatar, displayName: topic, isPstn: isPstn, size: 160" class="avatar"></swx-avatar>\r\n            <div class="buttonRow">\r\n                <button class="btn green narrow large" data-bind="click: close" type="button">\r\n                    <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("services/calling/pluginInstall",["require","exports","module","ui/viewModels/calling/plugin/pluginInstallViewModel","swx-cafe-application-instance","swx-enums","text!views/calling/pluginInstall.html","ui/modalDialog/modalDialog"],(function(e,t){var n=e("ui/viewModels/calling/plugin/pluginInstallViewModel"),i=e("swx-cafe-application-instance"),r=e("swx-enums"),o=e("text!views/calling/pluginInstall.html"),a=e("ui/modalDialog/modalDialog")
	t.startInstallFlow=function(e,t){a.isDisplayed()&&a.dispose()
	var i=n.build(e,t)
	return a.build("overlayPluginSlides",i,o),i.start(),i},t.isPluginInstalled=function(e,t){var n=i.get().devicesManager.mediaCapabilities
	if(n.isPluginInstalled)return new Promise((function(e){n.isBrowserMediaSupported()||n.isPluginInstalled()?e(!0):n.isPluginInstalled.get().finally((function(){e(n.isPluginInstalled())}))}))
	var o=i.get().personsAndGroupsManager.mePerson.capabilities.audio,a=i.get().personsAndGroupsManager.mePerson.capabilities.video
	return t?e.videoService.start.enabled.get().then((function(e){return a.reason!==r.callingNotSupportedReasons.PluginNotInstalled&&e})):e.audioService.start.enabled.get().then((function(e){return o.reason!==r.callingNotSupportedReasons.PluginNotInstalled&&e}))}})),define("ui/controls/calling/sounds",["require","exports","module","experience/settings"],(function(e,t){var n=e("experience/settings"),i={},r={},o="skype_sounds_",a=[{mimeType:"audio/mp4",extension:"m4a"},{mimeType:"audio/ogg",extension:"ogg"}]
	function s(e){function t(){r[e]||c(e)}var n=l(e).play()
	n&&n.then&&n.then(t,t)}function c(e){var t=l(e)
	r[e]=!1,t.pause(),t.load()}function l(e){var n
	if(!function(e){for(var n in t.KEYS)if(t.KEYS[n]===e)return!0
	return!1}(e))throw new Error("Invalid sound: "+e)
	return(n=i[e])||(n=document.createElement("audio"),a.forEach((function(r){var o=document.createElement("source"),a=t.buildSoundAssetUrl(e,r.extension)
	o.setAttribute("type",r.mimeType),o.setAttribute("src",a),n.appendChild(o),i[e]=n})),n.id=o+e),n}t.KEYS={CALL_ANSWER:"call-answer",CALL_CONNECTING:"call-connecting-loop",CALL_DIALING:"call-dialing",CALL_END_CALL:"call-endcall",CALL_ERROR_1:"call-error-1",CALL_ERROR_2:"call-error-2",CALL_HOLD:"call-hold-loop",CALL_INCOMING:"call-incoming-loop",CALL_NO_ANSWER:"call-no-answer",CALL_OUTGOING:"call-outgoing-original-loop",CALL_OUTGOING_P1:"call-outgoing-p1",CALL_OUTGOING_P2:"call-outgoing-p2-loop",CALL_RECONNECT:"call-reconnect-loop",CALL_RESUME:"call-resume",CAM_SHUTTER_CLOSE:"cam-shutter-close",CAM_SHUTTER_OPEN:"cam-shutter-open",CONTACTS_ADDED:"contacts-added",CONTACTS_AVAILABLE:"contacts-available",CONTACTS_RECEIVED:"contacts-received",FILE_TRANSFER_COMPLETE:"file-transfer-complete",FILE_TRANSFER_FAILED:"file-transfer-failed",FILE_TRANSFER_INCOMING:"file-transfer-incoming",LOGIN:"login",LOGOUT:"logout",MESSAGE_RECEIVED_1:"message-received-1",MESSAGE_RECEIVED_2:"message-received-2",MESSAGE_RECEIVED_3:"message-received-3",MESSAGE_RECEIVED_4:"message-received-4",MESSAGE_SENT:"message-sent",VIDEO_MESSAGE_RECORD_START:"video-message-record-start",VIDEO_MESSAGE_RECORD_STOP:"video-message-record-stop",VOICEMAIL_RECEIVED:"voicemail-received"},t.playLoop=function(e){var t=l(e)
	r[e]=!0,t.setAttribute("loop",!0),s(e)},t.playOnce=function(e,t){var n=l(e),i="ended"
	n.addEventListener(i,(function e(){t&&t(),n.removeEventListener(i,e)})),s(e)},t.stop=function(e){c(e)},t.clearCache=function(){i={}},t.buildSoundAssetUrl=function(e,t){return[n.assetsBaseUrl,"/audio","/",t,"/",e,".",t].join("")}})),define("utils/common/disposableMixin",["require","swx-pubsub-instance","browser/window","swx-constants","vendor/knockout"],(function(e){var t=e("swx-pubsub-instance").default,n=e("browser/window"),i=e("swx-constants").COMMON.disposableGroups,r=e("vendor/knockout")
	return{registerPubSubEvent:function(e,n){t.subscribe(e,n),this._dmRegisterDisposableItem(i.PUB_SUB,{eventName:e,callback:n})},unregisterPubSubEvent:function(e,n){t.unsubscribe(e,n),this._dmUnRegisterDisposableItem(i.PUB_SUB,(function(t){return t.eventName===e&&t.callback===n}))},registerComputed:function(e){var t=r.computed(e)
	return this.registerDisposable(t),t},observable:function(){return r.observable.apply(r,arguments)},observableArray:function(){return r.observableArray.apply(r,arguments)},registerDisposable:function(e){if(!e.dispose)throw new TypeError("Item does not implement Disposable")
	this._dmRegisterDisposableItem(i.GENERIC_DISPOSABLE,e)},unregisterDisposable:function(e){e.dispose(),this._dmUnRegisterDisposableItem(i.GENERIC_DISPOSABLE,(function(t){return t===e}))},registerInterval:function(e,t){var r=n.setInterval(e,t)
	return this._dmRegisterDisposableItem(i.INTERVAL,r),r},unregisterInterval:function(e){n.clearInterval(e),this._dmUnRegisterDisposableItem(i.INTERVAL,(function(t){return t===e}))},registerDOMEvent:function(e,t,n,r){e.addEventListener(t,n,r),this._dmRegisterDisposableItem(i.DOM_EVENT,{object:e,event:t,handler:n,useCapture:r})},unregisterDOMEvent:function(e,t,n,r){e.removeEventListener(t,n,r),this._dmUnRegisterDisposableItem(i.DOM_EVENT,(function(i){return i.object===e&&i.event===t&&i.handler===n&&i.useCapture===r}))},registerTimeout:function(e,t){var r=n.setTimeout(e,t)
	return this._dmRegisterDisposableItem(i.TIMEOUT,r),r},unregisterTimeout:function(e){n.clearTimeout(e),this._dmUnRegisterDisposableItem(i.TIMEOUT,(function(t){return t===e}))},_dmDisposeAll:function(){if(this._disposableItems){for(var e in this._disposableItems)this._disposableItems.hasOwnProperty(e)&&r(e,this._disposableItems[e]||[])
	this._disposableItems=null}function r(e,r){switch(e){case i.PUB_SUB:r.forEach((function(e){t.unsubscribe(e.eventName,e.callback)}))
	break
	case i.GENERIC_DISPOSABLE:r.forEach((function(e){e.dispose()}))
	break
	case i.INTERVAL:r.forEach(n.clearInterval)
	break
	case i.TIMEOUT:r.forEach(n.clearTimeout)
	break
	case i.DOM_EVENT:r.forEach((function(e){e.object.removeEventListener(e.event,e.handler,e.useCapture)}))}}},_dmRegisterDisposableItem:function(e,t){(function(e){if(!e._dmDisposeExtended){var t=e.dispose
	e.dispose=function(){e._dmDisposeAll(),t&&t.call(e)},e._dmDisposeExtended=!0}})(this),this._disposableItems=this._disposableItems||{},this._disposableItems[e]=this._disposableItems[e]||[],this._disposableItems[e].push(t)},_dmUnRegisterDisposableItem:function(e,t){this._disposableItems=this._disposableItems||{}
	for(var n=this._disposableItems[e]||[],i=0;i<n.length;i++)if(t(n[i])){n.splice(i,1)
	break}}}})),define("services/ecs/jsonp",["require","swx-browser-globals","swx-utils-common","experience/settings"],(function(e){var t=e("swx-browser-globals"),n=e("swx-utils-common").loader,i=e("experience/settings"),r=function(){}
	return{request:function(e,o,a,s,c){var l,u,d,p=t.getWindow()
	if(c=c||"callback",!e||!o)throw"mandatory options missing"
	d=function(){p.clearTimeout(u),s&&(s(),s=null,a=null)},l=e+(/\?/.test(e)?"&":"?")+c+"=Skype."+o,p.Skype[o]=function(){p.clearTimeout(u),a&&(a.apply(null,arguments),a=null),p.Skype[o]=null,s=null},n.loadScript(l,r,d),u=p.setTimeout(d,i.jsonpTimeout||2e4)}}}))
	context=this,definition=function(){var context=this,XHR2
	if("window"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0]
	else try{XHR2=require("xhr2")}catch(ex){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(!0===e.crossOrigin){var t=context[xmlHttpRequest]?new XMLHttpRequest:null
	if(t&&"withCredentials"in t)return t
	if(context[xDomainRequest])return new XDomainRequest
	throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}}
	function succeed(e){var t=protocolRe.exec(e.url)
	return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){return e._aborted?n(e.request):e._timedOut?n(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request)))}}function setHeaders(e,t){var n,i=t.headers||{}
	i.Accept=i.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"]
	var r="undefined"!=typeof FormData&&t.data instanceof FormData
	for(n in t.crossOrigin||i[requestedWith]||(i[requestedWith]=defaultHeaders.requestedWith),i[contentType]||r||(i[contentType]=t.contentType||defaultHeaders.contentType),i)i.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,i[n])}function setCredentials(e,t){void 0!==t.withCredentials&&void 0!==e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,i){var r=uniqid++,o=e.jsonpCallback||"callback",a=e.jsonpCallbackName||reqwest.getcallbackPrefix(r),s=new RegExp("((^|\\?|&)"+o+")=([^&]+)"),c=i.match(s),l=doc.createElement("script"),u=0,d=-1!==navigator.userAgent.indexOf("MSIE 10.0")
	return c?"?"===c[3]?i=i.replace(s,"$1="+a):a=c[3]:i=urlappend(i,o+"="+a),context[a]=generalCallback,l.type="text/javascript",l.src=i,l.async=!0,void 0===l.onreadystatechange||d||(l.htmlFor=l.id="_reqwest_"+r),l.onload=l.onreadystatechange=function(){if(l[readyState]&&"complete"!==l[readyState]&&"loaded"!==l[readyState]||u)return!1
	l.onload=l.onreadystatechange=null,l.onclick&&l.onclick(),t(lastValue),lastValue=void 0,head.removeChild(l),u=1},head.appendChild(l),{abort:function(){l.onload=l.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(l),u=1}}}function getRequest(e,t){var n,i=this.o,r=(i.method||"GET").toUpperCase(),o="string"==typeof i?i:i.url,a=!1!==i.processData&&i.data&&"string"!=typeof i.data?reqwest.toQueryString(i.data):i.data||null,s=!1
	return"jsonp"!=i.type&&"GET"!=r||!a||(o=urlappend(o,a),a=null),"jsonp"==i.type?handleJsonp(i,e,t,o):((n=i.xhr&&i.xhr(i)||xhr(i)).open(r,o,!1!==i.async),setHeaders(n,i),setCredentials(n,i),context[xDomainRequest]&&n instanceof context[xDomainRequest]?(n.onload=e,n.onerror=t,n.onprogress=function(){},s=!0):n.onreadystatechange=handleReadyState(this,e,t),i.before&&i.before(n),s?setTimeout((function(){n.send(a)}),200):n.send(a),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){if(null!==e)return e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={}
	var self=this
	function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"))
	resp="jsonp"!==type?self.request:resp
	var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse
	try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break
	case"js":resp=eval(r)
	break
	case"html":resp=r
	break
	case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp)
	complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n)
	complete(e)}fn=fn||function(){},o.timeout&&(this.timeout=setTimeout((function(){timedOut()}),o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push((function(){o.error.apply(o,arguments)})),o.complete&&this._completeHandlers.push((function(){o.complete.apply(o,arguments)})),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n,i,r,o,a=e.name,s=e.tagName.toLowerCase(),c=function(e){e&&!e.disabled&&t(a,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))}
	if(!e.disabled&&a)switch(s){case"input":/reset|button|image|file/i.test(e.type)||(n=/checkbox/i.test(e.type),i=/radio/i.test(e.type),r=e.value,(!n&&!i||e.checked)&&t(a,normalize(n&&""===r?"on":r)))
	break
	case"textarea":t(a,normalize(e.value))
	break
	case"select":if("select-one"===e.type.toLowerCase())c(e.selectedIndex>=0?e.options[e.selectedIndex]:null)
	else for(o=0;e.length&&o<e.length;o++)e.options[o].selected&&c(e.options[o])}}function eachFormElement(){var e,t,n=this,i=function(e,t){var i,r,o
	for(i=0;i<t.length;i++)for(o=e[byTag](t[i]),r=0;r<o.length;r++)serial(o[r],n)}
	for(t=0;t<arguments.length;t++)/input|select|textarea/i.test((e=arguments[t]).tagName)&&serial(e,n),i(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={}
	return eachFormElement.apply((function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n}),arguments),e}function buildParams(e,t,n,i){var r,o,a,s=/\[\]$/
	if(isArray(t))for(o=0;t&&o<t.length;o++)a=t[o],n||s.test(e)?i(e,a):buildParams(e+"["+("object"==typeof a?o:"")+"]",a,n,i)
	else if(t&&"[object Object]"===t.toString())for(r in t)buildParams(e+"["+r+"]",t[r],n,i)
	else i(e,t)}return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},catch:function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[]
	return eachFormElement.apply((function(t,n){e.push({name:t,value:n})}),arguments),e},reqwest.serialize=function(){if(0===arguments.length)return""
	var e,t=Array.prototype.slice.call(arguments,0)
	return(e=t.pop())&&e.nodeType&&t.push(e)&&(e=null),e&&(e=e.type),("map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString).apply(null,t)},reqwest.toQueryString=function(e,t){var n,i,r=t||!1,o=[],a=encodeURIComponent,s=function(e,t){t="function"==typeof t?t():null==t?"":t,o[o.length]=a(e)+"="+a(t)}
	if(isArray(e))for(i=0;e&&i<e.length;i++)s(e[i].name,e[i].value)
	else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],r,s)
	return o.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){for(var t in e=e||{})globalSetupOptions[t]=e[t]},reqwest},"undefined"!=typeof module&&module.exports?module.exports=definition():"function"==typeof define&&define.amd?define("reqwest/reqwest",definition):context.reqwest=definition(),define("reqwest",["reqwest/reqwest"],(function(e){return e})),define("services/ecs/configLoader",["require","lodash-compat","experience/settings","services/ecs/jsonp","reqwest"],(function(e){var t=e("lodash-compat"),n=e("experience/settings"),i=e("services/ecs/jsonp"),r=e("reqwest")
	return new function(){var e=1,o=908
	function a(e,i,r,a,s){var c=function(){for(var e=n.version.split(".",4);e.length<4;)e.push("0")
	return e[3]=e[2],e[2]=n.ecsClientCobrandTag,o+"_"+e.join(".")}(),l=function(e){var n=t.keys(e).reduce((function(t,n){return e[n]?t.concat([n,e[n]].join("=")):t}),[])
	if(n.length>0)return n.join("&")}(a),u=i+"/config/v1/"+e+"/"+c+"/"+r,d="?"
	return r.indexOf(d)>-1&&(d="&"),l&&(u+=d+l,d="&"),s&&(u+=d+"id="+s),u}this.loadConfig=function(o,s,c){var l=function(e,t,i,r){var o,s=[],c={}
	n.initParams&&n.initParams.apiKey&&(c.apikey=n.initParams.apiKey)
	for(o=0;o<t.length;o++)s.push(a(e,t[o],i,c,r))
	return s}(o,function(){if(t.isString(n.ecsHosts))return JSON.parse(n.ecsHosts)
	return n.ecsHosts||[]}(),s,c)
	return new Promise((function(t,o){var a=0,s=0,c=e
	e+=1,l&&l.length?(function e(u){function d(e){t(e)}function p(){var t
	a/l.length>=2?o(new Error("configuration service unreachable")):(t=(s+=1)%l.length,e(l[t]))}if(a++,!1===n.initParams.jsonp){var f={url:u,method:"GET",crossOrigin:!0,dataType:"json"}
	r.compat(f).then(d,p)}else i.request(u,"onConfigurationLoaded_"+c,d,p)}(l[s]),s+=1):o(new Error("no configuration service endpoint"))}))}}})),define("ui/calling/unansweredCallHandler",["require","exports","module","lodash-compat","swx-constants","swx-constants","ui/modelHelpers/conversationHelper","utils/common/disposableMixin","services/ecs/configLoader","swx-enums","vendor/knockout","swx-log-tracer","swx-service-locator-instance","experience/settings"],(function(e,t){var n,i,r=e("lodash-compat"),o=e("swx-constants").CALLING,a=e("swx-constants").COMMON,s=e("ui/modelHelpers/conversationHelper"),c=e("utils/common/disposableMixin"),l=e("services/ecs/configLoader"),u=e("swx-enums"),d=e("vendor/knockout"),p=e("swx-log-tracer").getLogger(),f=e("swx-service-locator-instance").default,m=e("experience/settings"),h={},v=!1,g=!1,y=!1,b=!1,_=!1,E=!1,w=!1,S=!1,x=null,C=0,T=null
	function I(){t.newCallStartedInShellApp(null),t.previousCallEndedInShellApp(null),g=!1,y=!1,b=!1,E=!1,w=!1,x=null,C=0}function A(e){var t=e.audio.state.when(u.callConnectionState.Connected,(function(){y=!0}))
	h.registerDisposable(t)}t.init=function(){var e=f.resolve(a.serviceLocator.FEATURE_FLAGS)
	return v=!1,T=null,e.isFeatureOn(a.featureFlags.UNANSWERED_CALL_UI)?(T&&i||(i=l.loadConfig(u.ecsClientNames.Skype,m.ecsSkypeCallingT1Key)),i).then((function(e){r.isEmpty(e)?(p.log("[Unanswered Call UI] ECS config empty"),v=!0):v=(T=e).UnansweredCallUIEnabled})).catch((function(e){p.log("[Unanswered Call UI] failed to get ECS config",e),v=!0})):Promise.resolve()},t.newCallStartedInShellApp=d.observable(null),t.previousCallEndedInShellApp=d.observable(null),t.observe=function(e){if(v){n=e,I()
	var i=n.selfParticipant.audio.state.when(u.callConnectionState.Connected,(function(){g=!0}))
	h.registerDisposable(i),e.participants.added(A),s.isCallingActive(n)||t.newCallStartedInShellApp(n),x=(new Date).getTime(),E=n.mediaConnectionType()===u.mediaConnectionType.Pluginless,w=s.isPstnEndpoint(n.participants(0).audio.endpoint())}},t.callEnded=function(){v&&n&&(_=n.audioService.callHadNoMicrophone(),C=(new Date).getTime()-x,t.newCallStartedInShellApp()&&t.previousCallEndedInShellApp(n),h.dispose&&h.dispose())},t.callHungUpByCaller=function(){b=!0},t.callStarting=function(e){S=e},t.setup=function(){if(!v)return Promise.reject(new Error("Unanswered call UI is disabled"))
	if(n.selfParticipant.audio.state.reason===u.callDisconnectionReason.CallEscalated)return Promise.reject(new Error("Unanswered call UI is ignoring call escalations"))
	var e=m.unansweredUI.minCallDuration
	return new Promise((function(t,i){function s(e){f.resolve(a.serviceLocator.PUBSUB).publish(a.events.navigation.OPEN_CONVERSATION,{model:n,origin:a.telemetry.historyLoadOrigin.UNANSWERED_CALL_UI}),t({reason:e,wasVideoCall:S,ecsConfig:T}),I()}function c(){i(new Error("Unanswered call UI should not be shown in this scenario")),I()}!E&&r.some(n.participants(),(function(e){return!e.audio.state.reason}))&&(b=!0),n.isGroupConversation()?y?c():!b||C>=e?s(o.UNANSWERED_CALL_REASONS.UNAVAILABLE):c():function(){if(g||w||_)c()
	else{var t=n.participants(0).audio.state.reason
	!b||C>=e?s(function(e){return e===u.callDisconnectionReason.Busy?o.UNANSWERED_CALL_REASONS.BUSY:o.UNANSWERED_CALL_REASONS.MISSED}(t)):c()}}()}))},r.extend(h,c)})),define("ui/viewModels/calling/helpers/callingFacade",["require","exports","module","swx-constants","swx-constants","swx-util-calling-stack","swx-enums","ui/viewModels/chat/navigationHelper","services/calling/pluginInstall","swx-pubsub-instance","ui/controls/calling/sounds","swx-cafe-application-instance","swx-service-locator-instance","ui/calling/unansweredCallHandler"],(function(e,t){var n=e("swx-constants").CALLING,i=e("swx-constants").COMMON,r=e("swx-util-calling-stack"),o=e("swx-enums"),a=e("ui/viewModels/chat/navigationHelper"),s=e("services/calling/pluginInstall"),c=e("swx-pubsub-instance").default,l=e("ui/controls/calling/sounds"),u=e("swx-cafe-application-instance"),d=e("swx-service-locator-instance").default,p=e("ui/calling/unansweredCallHandler")
	function f(e,t,i,r){return c.publish(n.EVENTS.START_CALL,{conversation:e,isVideo:t,source:i}),p.callStarting(t),l.playLoop(l.KEYS.CALL_CONNECTING),r&&a.navigateToConversation(e,i),t?e.videoService.start():e.audioService.start()}function m(e,t){return c.publish(n.EVENTS.ANSWER,{conversation:e,isVideo:t}),t&&e.videoService.accept.enabled()?e.videoService.accept():e.audioService.accept()}function h(e,t,r,c,l,p){var h=u.get().personsAndGroupsManager.mePerson.capabilities.audio.reason,v=d.resolve(i.serviceLocator.FEATURE_FLAGS),g=h===o.callingNotSupportedReasons.PluginBlocked
	return!v.isFeatureOn(i.featureFlags.ASK_TO_UNBLOCK_PLUGIN)&&g?Promise.reject(Error(o.callingNotSupportedReasons.PluginBlocked)):new Promise((function(i,u){s.startInstallFlow(c,{isOutgoing:r,conversation:e,isVideo:t,done:function(r,s){if(e&&s&&r===n.PLUGIN_INSTALL_EXIT_METHOD.CALL_STARTED){var c
	c=e.selfParticipant.audio.state()===o.callConnectionState.Notified?m(e,t):f(e,t,"pluginInstallCallback"),p&&a.navigateToConversation(e,l),i(c)}else u(Error("Plugin install result: "+s+", exitMethod: "+r))},onlyUnblock:g})}))}t.placeCall=function(e,t,n,i){return l.playOnce(l.KEYS.CALL_DIALING),r.get().isPluginlessCallingSupported()?f(e,t,n,i):function(e,t,n,i){return s.isPluginInstalled(e,t).then((function(r){return r?f(e,t,n,i):h(e,t,!0,"outgoing",n,i)}))}(e,t,n,i)},t.acceptCall=m,t.rejectCall=function(e){c.publish(n.EVENTS.REJECT,{conversation:e}),e.audioService.reject()},t.installPlugin=function(e,t,n,i){h(t,i=i||!1,n,e)}})),define("experience/api/helpers/modality",["require","exports","module","lodash-compat","swx-constants","swx-enums","ui/viewModels/calling/helpers/callingFacade","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("swx-enums"),o=e("ui/viewModels/calling/helpers/callingFacade"),a=e("ui/telemetry/actions/actionNames"),s=e("swx-service-locator-instance").default,c=i.modalityType,l=i.api.modality.errorMessages
	function u(e){return n.contains(e,c.VIDEO)}function d(e){return n.contains(e,c.AUDIO)}function p(e){return n.contains(e,c.CHAT)}t.startModalities=function(e,t,c){var f=e.modalities,m=e.conversation,h=""
	function v(){n.isFunction(t)&&t()}function g(e){if(n.isFunction(c))try{c(e)}catch(t){console.log(l.ERROR_CALLBACK_ERROR)}}function y(e){var t,n,c
	e.start.enabled.reason===r.callingNotSupportedReasons.PluginNotInstalled?(t=e===m.videoService,n=s.resolve(i.serviceLocator.ACTION_TELEMETRY),c=t?a.audioVideo.apiVideoCall:a.audioVideo.apiAudioCall,n.recordAction(c),o.placeCall(m,t,"integrationAPI")):h=l.MODALITY_START_FAILED}f&&!n.isEmpty(f)?n.isArray(f)?!function(e){return u(e)||d(e)||p(e)}(f)?g(l.MODALITY_TYPE_NOT_SUPPORTED):(u(f)&&(m.videoService.start.enabled()?m.videoService.start():y(m.videoService)),d(f)&&(m.audioService.start.enabled()?m.audioService.start():y(m.audioService)),p(f)&&m.chatService.start.enabled()&&e.startChatService&&m.chatService.start(),""===h?v():g(h)):g(l.INVALID_MODALITIES):v()}})),define("experience/api/error",["require","exports","module","lodash-compat"],(function(e,t){var n=e("lodash-compat")
	t.asApiError=function(e,t){var i
	return e instanceof Error?i=Object.create(e):n.isString(e)?i=new Error(e):(i=new Error("Unknown: please check *data* property for more info")).data=e,i.name=["SWXApi",t||"",i.name].join(":"),i}})),define("telemetry/chat/conversationJoined",["require","exports","module","experience/settings","ui/modelHelpers/personHelper","swx-utils-chat","ui/telemetry/telemetryClient","swx-browser-globals","swx-constants"],(function(e,t){var n,i=e("experience/settings"),r=e("ui/modelHelpers/personHelper"),o=e("swx-utils-chat").conversation,a=e("ui/telemetry/telemetryClient"),s=e("swx-browser-globals"),c=e("swx-constants").COMMON,l=c.telemetry.conversationJoined,u=c.telemetry.conversationOrigin
	function d(){var e=this
	function t(t,n,r){n=n||l.result.INCONCLUSIVE
	var c=l.TYPE,d=s.getWindow(),p={milestone:t,result:n.toString(),client_time:(new d.Date).getTime().toString(),Prefix:e._prefix,thread_id:e._threadId.toString(),conversationOrigin:o.isGuestHostConversation(e._threadId)?u.GUEST_HOST:u.NORMAL}
	r&&(p.participantsCount=r),a.get().sendEvent(i.telemetry.chatTenantToken,c,p)}function n(){e._threadId=void 0,e._prefix=void 0}return e._threadId=void 0,e._prefix=void 0,e.onJoinConversation=function(n){var i,o=-1===n.prefix.indexOf(":"),a=(i=n.prefix,r.isGuestId(i)?l.result.SIGNED_OUT:l.result.SIGNED_IN)
	e._threadId=n.uri,e._prefix=o?"":function(e){return/^(.*):/.exec(e)[1]}(n.prefix),t(l.milestoneType.CLIENT_INIT,a)},e.onJoinConversationError=function(i){e.isTriggered()&&(t(l.milestoneType.ERROR,i),n())},e.onConversationJoined=function(i){e.isTriggered()&&(t(l.milestoneType.END,l.result.SUCCESS,i?i.participantsCount+1:i),n())},e.isTriggered=function(){return e._threadId},e.isTriggeredFor=function(t){return e._threadId===t},e}t.get=function(){return n||(n=new d),n}})),define("experience/api/helpers/conversationsSynchronizer",["require","exports","module","swx-cafe-application-instance"],(function(e,t){var n=e("swx-cafe-application-instance")
	t.sync=function(){function e(){return Promise.all([])}function t(e){var t=(e=e||n.get().conversationsManager.conversations()).reduce((function(e,t){return t.conversationId?e.concat([t.conversationId]):e.concat([t.uri()||t.uri.get()])}),[])
	return Promise.all(t)}return n.get().conversationsManager.conversations.get().then((function(i){var r=n.get().conversationsManager
	return r.conversations.size()<1&&r.getMoreConversations.enabled()?r.getMoreConversations(1).then(t).catch(e):t(i)}))}})),define("experience/api/helpers/conversationFacade",["require","exports","module","vendor/knockout"],(function(e,t){var n=e("vendor/knockout")
	function i(e){var t=this
	function i(){t.participantsCount(e.participantsCount())}function r(){t.isJoiningEnabled(e.isJoiningEnabled())}return t.participantsCount=n.observable(0),t.isJoiningEnabled=n.observable(!0),t.init=function(){e.participants.changed(i),e.isJoiningEnabled.changed(r)},t.dispose=function(){e.participants.changed.off(i),e.isJoiningEnabled.changed.off(r)},t.isJoinable=function(){return e.isJoiningEnabled.set.enabled()},t.makeJoinable=function(){e.isJoiningEnabled.set.enabled.once(!0,(function(){e.isJoiningEnabled.set(!0)}))},t.getJoinUrl=function(){return e.uri.get()},t}t.build=function(e){return new i(e)}})),define("experience/api/helpers/contentNavigator",["require","exports","module","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default
	function r(e){var t=!1,r=null,o=null,a=n.apiUIEvents.SWX_CONTENT_LOADED
	function s(){return i.resolve(n.serviceLocator.PUBSUB)}function c(e){s().publish(n.events.navigation.OPEN_CONVERSATION,{model:e,origin:n.telemetry.historyLoadOrigin.NEW_CHAT_API_START_CONVERSATION,contentElementId:o})}s().subscribe(a,(function n(i){c=i.contentElementId,o=o||(e.firstChild?e.firstChild.getAttribute("id"):null),c===o&&(s().unsubscribe(a,n),t=!0,r&&(r(),r=null))
	var c})),this.navigateToConversation=function(e){t?c(e):r=c.bind(void 0,e)}}t.build=function(e){return new r(e)}})),define("experience/api/helpers/contentNavigatorStore",["require","exports","module","lodash-compat","experience/api/helpers/contentNavigator","browser/dom"],(function(e,t){var n=e("lodash-compat"),i=e("experience/api/helpers/contentNavigator"),r=e("browser/dom"),o=[]
	t.add=function(e){var t=r.getElement(e),n=i.build(t)
	o.push({contentContainer:t,navigator:n})},t.get=function(e){var t=r.getElement(e)
	return t?n.find(o,(function(e){return e.contentContainer===t})).navigator:function(){if(o.length>0)return o[0].navigator}()},t.clear=function(){o=[]}})),define("experience/api/helpers/conversation",["require","exports","module","lodash-compat","swx-cafe-application-instance","experience/api/auth/authEventHandler","experience/api/helpers/modality","experience/api/error","swx-utils-chat","swx-enums","swx-constants","telemetry/chat/conversationJoined","experience/api/helpers/conversationsSynchronizer","experience/api/helpers/conversationFacade","experience/settings","swx-service-locator-instance","experience/api/helpers/contentNavigatorStore"],(function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("experience/api/auth/authEventHandler"),o=e("experience/api/helpers/modality"),a=e("experience/api/error").asApiError,s=e("swx-utils-chat").conversation,c=e("swx-enums"),l=e("swx-constants").COMMON,u=e("telemetry/chat/conversationJoined"),d=e("experience/api/helpers/conversationsSynchronizer"),p=e("experience/api/helpers/conversationFacade"),f=e("experience/settings"),m=e("swx-service-locator-instance").default,h=e("experience/api/helpers/contentNavigatorStore"),v=l.api.conversation.errorMessages
	function g(e,t){n.isFunction(e)&&e(a(t))}function y(e){m.resolve(l.serviceLocator.FEATURE_FLAGS).isFeatureOn(l.featureFlags.SINGLE_CONVERSATION_MODE)&&r.deferActionOnSplashscreen((function(e){m.resolve(l.serviceLocator.PUBSUB).publish(l.apiUIEvents.SWX_SINGLE_CONVERSATION,e)}),e)}function b(e,t){var n
	t instanceof XMLHttpRequest&&(n=0===t.status?"Timeout while joining converstation":t.response,t=new Error(n))
	try{y(t)}catch(i){console.error(i)}u.get().onJoinConversationError(t),g(e,t)}function _(e){return 2===f.API.version?e:p.build(e)}t.startConversation=function(e,t,r,a,l){var u,d=g.bind(null,a)
	function p(e,c){var u=i.get().conversationsManager,p=s.createConversation(e,u,c),f={modalities:t,conversation:p},m=h.get(l)
	o.startModalities(f,(function(){m&&m.navigateToConversation(p),function(e,t,i){if(!n.isFunction(t))return
	try{t(_(e))}catch(r){g(i,v.SUCCESS_CALLBACK_ERROR)}}(p,r,a)}),d)}Array.isArray(e)?0!==e.length?((u=f.startConversationMaxParticipantCount)>0&&e.length>u&&(e=e.slice(0,u)),f.authentication&&f.authentication.anonymousMode?p(e):function(e){var t,n=c.searchScope.All
	return t=e.map((function(e){var t=i.get().personsAndGroupsManager.createPersonSearchQuery()
	return new Promise((function(i,r){function o(){t.results().length?i(t.results(0).result):r()}"tel:"===e.substring(0,4)?(t.sources(n),t.text(e)):t.sources(n).keywords.id=e,t.getMore().then(o,r)}))})),Promise.all(t)}(e).then((function(e){p(e)}),(function(){d(v.SEARCH_FAILED)})).catch(d)):p([],!0):d(v.URI_NOT_VALID)},t.joinConversation=function(e,t,r,a,s,c){var p=b.bind(null,a),f=i.get().conversationsManager
	if(n.isString(e))try{i.get().personsAndGroupsManager.mePerson.id.get().then((function(t){u.get().onJoinConversation({uri:e,prefix:t}),d.sync().then((function(){s?f._getConversationByUri(e).then(g).catch(p):g(f.getConversationByUri(e))})).catch(p)})).catch(p)}catch(E){p(E)}else p(v.URI_NOT_VALID)
	function g(e){var i={modalities:t,conversation:e,startChatService:!0},s=h.get(c)
	o.startModalities(i,(function(){s&&s.navigateToConversation(e),function(e,t,i){if(m.resolve(l.serviceLocator.PUBSUB).publish(l.apiUIEvents.SWX_CHAT_LOADED),!n.isFunction(t))return
	try{t(_(e)),y()}catch(r){b(i,v.SUCCESS_CALLBACK_ERROR)}}(e,r,a)}),p)}}})),define("experience/api/conversation",["require","exports","module","swx-cafe-application-instance","experience/api/helpers/conversation","experience/api/helpers/modality","swx-utils-chat","swx-constants","constants/components","experience/settings","swx-service-locator-instance","swx-pubsub-instance","experience/api/helpers/contentNavigatorStore","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("experience/api/helpers/conversation"),r=e("experience/api/helpers/modality"),o=e("swx-utils-chat").conversation,a=e("swx-constants").COMMON,s=e("constants/components"),c=e("experience/settings"),l=e("swx-service-locator-instance").default,u=e("swx-pubsub-instance").default,d=e("experience/api/helpers/contentNavigatorStore"),p=e("ui/telemetry/telemetryClient")
	t.newConversation=function(){var e={page:s.chat.NEW_CONVERSATION,origin:a.telemetry.historyLoadOrigin.NEW_CONVERSATION_API}
	u.publish(a.events.navigation.NAVIGATE,e)},t.startConversation=function(e,t,n,r){i.startConversation(e,t,n,r)},t.joinConversation=function(e,t,r,o,s){var u=l.resolve(a.serviceLocator.FEATURE_FLAGS)
	function d(){u.isFeatureOn(a.featureFlags.SYNC_THREAD_BEFORE_JOIN_CONVERSATION_FLOW_ENABLED)?i.joinConversation(e,t,r,o,!0):i.joinConversation(e,t,r,o,!1)}s&&s.inviteId?function(e,t){var i=n.get().personsAndGroupsManager
	if(i._autoBuddyFromInvite)return new Promise((function(n,r){function o(){p.get().sendEvent(c.telemetry.uiTenantToken,a.telemetry.autoBuddy.SUCCESS,{}),n()}i._autoBuddyFromInvite(e,t).then(o,r)}))}(s.inviteId,e).then(d,d):d()},t.renderConversation=function(e,t){return function(e,t){return new Promise((function(s,u){var p=t&&t.modalities?t.modalities:null
	function f(t){l.resolve(a.serviceLocator.CONTROLS_BUILDER).build(c.controls.content.toLowerCase(),e),s(t)}function m(e){u(e)}if(e)if("string"==typeof e||e instanceof Node){if(d.add(e),t&&t.conversation){var h=d.get(e)
	return h&&h.navigateToConversation(t.conversation),void f(t.conversation)}t&&(t.participants||t.conversationId)?t.participants?Array.isArray(t.participants)?i.startConversation(t.participants,p,f,m,e):m(a.api.renderConversation.errorMessages.PARTICIPANTS_WRONG_FORMAT):t.conversationId&&("string"==typeof t.conversationId?i.joinConversation(t.conversationId,p,f,m,!1,e):m(a.api.renderConversation.errorMessages.CONVERSATION_ID_WRONG_FORMAT)):function(e,t,i,a){var s=n.get().conversationsManager,c=o.createConversation([],s,!0),l={modalities:e,conversation:c}
	function u(){var e=d.get(t)
	e&&e.navigateToConversation(c),i(c)}r.startModalities(l,u,a)}(p,e,f,m)}else m(a.api.renderConversation.errorMessages.CONTAINER_NOT_ELEMENT_NOT_SELECTOR)
	else m(a.api.renderConversation.errorMessages.CONTAINER_UNDEFINED)}))}(e,t)}})),define("utils/common/styleModeHelper",["require","exports","module","lodash-compat","browser/window","vendor/knockout","swx-constants","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("browser/window"),r=e("vendor/knockout"),o=e("swx-constants").COMMON,a=e("experience/settings"),s=o.styleMode,c=null,l={kahuna:"kahuna",owa:"outlook",o365:"o365",wac:"wac"},u={kahuna:"kahuna",owa:"outlook"}
	function d(){var e,t=this,c=n.debounce((function(){var e=m()
	t.currentMode(h(e))}),500),d=[],p=function(){var t=v(l)
	t&&(e=t)
	return!!t}(),f=!!v(u)
	function m(){var e=0
	return 0===d.length?i.innerWidth:(d.forEach((function(t){e+=t.offsetWidth})),e)}function h(e){return e<=s.breakpoint.MEDIUM?s.NARROW:e>s.breakpoint.MEDIUM&&e<=s.breakpoint.WIDE?s.MEDIUM:s.WIDE}function v(e){return n.find(e,(function(e){return a.biAppName.toLowerCase().indexOf(e.toLowerCase())>-1}))}t.currentMode=r.observable(h(m())),p||i.addEventListener(o.events.browser.RESIZE,c),t.addContainer=function(e){d.push(e),t.currentMode(h(m()))},t.appIsVisible=function(){return d.length>0&&m()>0},t.isIntegratedProperty=function(){return p},t.isConsumerIntegrated=function(){return f},t.host=function(){return e},t.dispose=function(){p||i.removeEventListener(o.events.browser.RESIZE,c),d=[]}}t.get=function(){return null===c&&(c=new d),c},t.dispose=function(){null!==c&&(c.dispose(),c=null)}})),define("notifications/common/browserNativeNotification",["require","exports","module","swx-browser-globals","swx-i18n","swx-constants"],(function(e,t){var n=e("swx-browser-globals"),i=e("swx-i18n").localization,r=e("swx-constants").COMMON
	function o(e,t,i){var r,o,a=n.getWindow(),s=e.title()||e.sender.displayName()
	t.icon=e.sender.avatar(),e.active(!0),r=new a.Notification(s,t),o=e.active.subscribe((function(e){!1===e&&r.close()})),e.sound.play(),e.onshow&&e.onshow(),r.onclick=function(){r.close(),i||(e.open&&e.open(),function(){var e=n.getWindow()
	e.$WLXIM&&e.$WLXIM.showSidebar()}()),a.focus()},r.onclose=function(){o&&o.dispose()}}return t.create=function(e){var t,n=r.notifications,a=!1
	switch(e.type){case n.CHAT:case n.UNREAD_MESSAGE:case n.CONTACT_REQUEST:t={body:e.description()},o(e,t,a)
	break
	case n.AUDIO_WITHOUT_VIDEO:case n.AUDIO:case n.INCOMING_CALL:o(e,t={body:i.fetch({key:"toast_incoming_text_title"})},a=!0)}},t})),define("notifications/common/notificationHub",["require","swx-browser-globals","swx-service-locator-instance","swx-constants","utils/common/styleModeHelper","swx-browser-detect","notifications/common/browserNativeNotification"],(function(e){var t,n=e("swx-browser-globals"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("utils/common/styleModeHelper"),a=e("swx-browser-detect").default,s=e("notifications/common/browserNativeNotification"),c=7e3,l=100,u=n.getWindow(),d=n.getDocument(),p=!1,f=!0,m=r.notifications,h=[],v={}
	function g(){return!(!d.hasFocus()||!o.get().appIsVisible())}function y(){var e
	f=!0,t?setTimeout((function(){for(var t=0;t<h.length;t++)w(e=h[t])||_(e)
	h=[]}),l):h=[]}function b(){f=!1}function _(e){var n=i.resolve(r.serviceLocator.FEATURE_FLAGS),a=!o.get().isIntegratedProperty()||!o.get().appIsVisible(),s=e.type===m.UNREAD_MESSAGE||e.type===m.CHAT
	if(!1!==e.active())if(n.isFeatureOn(r.featureFlags.ENHANCED_NOTIFICATION)&&!f&&s)e.wasDelayed=!0,h.push(e)
	else{if(s&&o.get().isConsumerIntegrated()&&!a)return
	e.active(!0)
	try{t(e)}catch(l){console.error("setNotificationHandler error",l)}e.publishUnreadMessageTelemetry&&a&&e.publishUnreadMessageTelemetry(E(e)),e.onshow&&a&&e.onshow(),e.autoDeactivation&&setTimeout((function(){e.active()&&e.active(!1)}),c)}}function E(e){return{isDelayedNotification:!!e.wasDelayed,notificationQueueLength:h.length,displayType:e.displayType}}function w(e){return!!(e.displayType!==r.telemetry.browserToast.displayType.REMINDER&&e.conversation&&e.conversation._consumptionHorizon&&e.activityOccurence)&&e.conversation._consumptionHorizon.lastReadMessageTimestamp>=e.activityOccurence.getTime()}return v.notify=function(e){var n=e.type===m.AUDIO_WITHOUT_VIDEO||e.type===m.AUDIO||e.type===m.INCOMING_CALL
	v.areBrowserNotificationsSupported()&&u.Notification.permission===r.permission.GRANTED?(g()||s.create(e),n&&t&&_(e),e.publishUnreadMessageTelemetry&&!g()&&e.publishUnreadMessageTelemetry(E(e))):t&&_(e)},v.addNotificationListener=function(e){(function(){var e=i.resolve(r.serviceLocator.FEATURE_FLAGS)
	if(p)return
	p=!0,e.isFeatureOn(r.featureFlags.ENHANCED_NOTIFICATION)&&(u.addEventListener(r.events.browser.FOCUS,y),u.addEventListener(r.events.browser.BLUR,b))})(),t=e},v.removeNotificationListener=function(){var e=i.resolve(r.serviceLocator.FEATURE_FLAGS)
	t&&(t=null),p=!1,e.isFeatureOn(r.featureFlags.ENHANCED_NOTIFICATION)&&(u.removeEventListener(r.events.browser.FOCUS,y),u.removeEventListener(r.events.browser.BLUR,b))},v.areBrowserNotificationsSupported=function(){return i.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.BROWSER_NATIVE_NOTIFICATIONS_ENABLED)&&!!u.Notification&&"Chrome"===a.getBrowserInfo().browserName&&"Windows"===a.getSystemInfo().osName},v})),define("experience/api/notifications",["require","exports","module","notifications/common/notificationHub"],(function(e,t){var n=e("notifications/common/notificationHub")
	t.setNotificationHandler=function(e){n.addNotificationListener(e)}})),define("utils/chat/unreadConversations",["require","vendor/knockout","swx-cafe-application-instance","utils/common/cafeObservable"],(function(e){var t,n=e("vendor/knockout"),i=e("swx-cafe-application-instance"),r=e("utils/common/cafeObservable")
	function o(){var e,t=n.observableArray(),o=r.newObservableProperty(i.get().conversationsManager.unreadConversationsCount).extend({rateLimit:300})
	function a(e,i){n.utils.addOrRemoveItem(t(),e,!i),t.valueHasMutated()}function s(e){e.__subUnread&&e.__subUnread.dispose()
	var t=e.historyService.activityItems
	t().length&&(e.__subUnread=t(t().length-1).isRead.changed(a.bind(null,e)))}function c(e){e.__subUnreadActivityItems=e.historyService.activityItems.changed(s.bind(null,e))}function l(e){e.__subUnreadActivityItems.dispose()}return{getUnread:n.pureComputed({deferEvaluation:!0,read:function(){return e||(i.get().conversationsManager.conversations.added(c),i.get().conversationsManager.conversations.removed(l),e=!0),t()}}),getCount:o}}return{getInstance:function(){return t||(t=o()),t},destroy:function(){t=null}}})),define("experience/api/calling",["require","vendor/knockout","swx-cafe-application-instance","swx-constants","swx-pubsub-instance","ui/viewModels/calling/helpers/callingFacade","swx-constants","constants/components","swx-enums"],(function(e){var t=e("vendor/knockout"),n=e("swx-cafe-application-instance"),i=e("swx-constants").CALLING,r=e("swx-pubsub-instance").default,o=e("ui/viewModels/calling/helpers/callingFacade"),a=e("swx-constants").COMMON,s=e("constants/components"),c=e("swx-enums"),l=t.observable(!1),u=t.observable(!1)
	function d(){r.subscribe(i.EVENTS.FULLSCREEN_CHANGED,(function(e){l(e)})),n.get().personsAndGroupsManager.mePerson.capabilities.audio.changed((function(e,t){var n=t!==c.callingNotSupportedReasons.PluginNotInstalled
	u(n)}))}function p(){o.installPlugin("callingApi")}function f(){var e={page:s.calling.SKYPEOUT_PAGE,origin:a.telemetry.historyLoadOrigin.SKYPEOUT_PAGE_API}
	r.publish(a.events.navigation.NAVIGATE,e)}return{buildApi:function(){return d(),{isPluginInstalled:t.computed((function(){return u()})),openPstnPage:f,startPluginInstall:p,isFullScreen:t.computed((function(){return l()}))}}}})),define("ui/appOverlay/appOverlay",["require","exports","module","swx-browser-globals","browser/dom","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("swx-browser-globals"),i=e("browser/dom"),r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a=null,s=null,c="swx-app-overlay"
	t.create=function(e){return s||function(){var e=n.getDocument()
	if(!a){var t,l=o.resolve(r.serviceLocator.CONTROLS_BUILDER)
	t=l.registeredElements.length?e.querySelector(l.registeredElements[0].element):e.querySelector("body"),a=t.parentNode}(s=i.createElement("div")).id=c,a.appendChild(s)}(),e&&e.content&&s.appendChild(e.content),e&&e.className&&s.classList.add(e.className),s},t.destroy=function(){a.removeChild(n.getDocument().querySelector("#"+c)),s=null,a=void 0}})),"undefined"==typeof SKYPE&&(window.SKYPE={}),SKYPE.linking=(domains={pre:"https://a.prelogin.skype.net",qa:"https://a.qalogin.skype.net",dogfood:"https://dogfood.login.skype.com",live:"https://a.login.skype.com"},iFrameReference=null,host=null,eventRegistered=!1,state="",processing=!1,settings={},defaultSettings={env:"dogfood",theme:"skype-blue",client_id:null,redirect_uri:null,rps_token:null,setlang:null,welcome:!1,createTechnical:!1,microsoft:!0,hidden:!1,relink:!1,site_name:null},_messageListener=function(e){var t
	if(n=e.origin,(i=["https://login.skype.com","https://prelogin.skype.net","https://qalogin.skype.net","https://a.pre.lw.skype.net","https://a.qa.lw.skype.net","https://a.lw.skype.com","https://a.prelogin.skype.net","https://a.qalogin.skype.net","https://a.login.skype.com"]).push(host),-1!==i.indexOf(n)){var n,i,r=e.data
	if("string"==typeof r)try{r=JSON.parse(e.data)}catch(s){}var o=r.state||null
	if(state===o){for(var a in t={},r)r.hasOwnProperty(a)&&(t[a]=r[a])
	_callCallback(t)}}},_destroyIFrame=function(){iFrameReference&&(iFrameReference.parentNode&&iFrameReference.parentNode.removeChild(iFrameReference),iFrameReference=null)},_callCallback=function(e){processing=!1,"function"==typeof callback&&callback(e)},_getIFrameSource=function(){var e,t,n=(new Date).getTime()
	return host=domains[settings.env]||domains.dogfood,state="linkingsdk_"+n,e={response_type:"postmessage",client_id:settings.client_id,env:settings.env,theme:settings.theme,redirect_uri:settings.redirect_uri,state:state},settings.microsoft&&(e.partner="999"),settings.setlang&&(e.setlang=settings.setlang),settings.relink&&(e.scenario="relink"),settings.createTechnical&&(e.scenario="silentCreateTechnical"),settings.welcome&&(e.scenario="welcome"),settings.site_name&&(e.site_name=settings.site_name),t=function(e){var t=[]
	for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))
	return t.join("&")}(e)+"#access_token="+encodeURIComponent(settings.rps_token),host+"/linking?"+t},{init:function(e){if(settings={},callback=null,eventRegistered=!1,state="",processing=!1,window.addEventListener?window.removeEventListener("message",_messageListener):window.detachEvent("onmessage",_messageListener),_destroyIFrame(),"object"==typeof e)for(var t in(e=e||{}).hasOwnProperty("callback")&&setCallback(e.callback),defaultSettings)e.hasOwnProperty(t)?settings[t]=e[t]:settings[t]=defaultSettings[t]
	return eventRegistered||(eventRegistered=!0,window.addEventListener?window.addEventListener("message",_messageListener):window.attachEvent("onmessage",_messageListener)),this},setCallback:setCallback=function(e){return"function"==typeof e&&(callback=e),this},getIFrame:createIFrame=function(){if(!processing){var e
	if(function(){if(!settings.client_id||!settings.rps_token)throw"[linking.js] client_id not initialized. Call init() first."
	if(settings.createTechnical&&settings.welcome)throw"[linking.js] cannot initialize both createTechnical and welcome flows at the same time."
	settings.redirect_uri||(settings.redirect_uri=window.location.protocol+"//"+window.location.host+window.location.pathname)}(),processing=!0,"postMessage"in window&&"object"==typeof JSON&&JSON.parse)return e=_getIFrameSource(),_destroyIFrame(),(iFrameReference=document.createElement("iframe")).frameBorder=0,iFrameReference.width="100%",iFrameReference.height="100%",iFrameReference.id="linkingFrame"+Math.floor(10*Math.random()+1),iFrameReference.style.backgroundColor="#00AFF0",settings.hidden&&(iFrameReference.style.display="none"),iFrameReference.setAttribute("src",e),iFrameReference
	_callCallback({error:"unsupported_browser"})}},load:function(e){var t=createIFrame()
	t&&e.appendChild(t)}}),define("swx-xco/lib/linking",(function(){})),
	/**
	* @copyright © Microsoft. All rights reserved.
	*
	* Skype Silent Login SDK v1.0.
	* Provides background authentication for Skype services.
	*
	* See http://aka.ms/SkypeLoginGuide for more info and onboarding process.
	*
	* How to use:
	* ===========
	* 1) Load the script in the page
	*
	* 2) Initialize with your application's options
	*        SKYPE.login.Silent.init(<options>);
	*
	*    The options object:
	*        {
	*            env:          <live|qa|pre>, // Skype environment to be used: Live (default), QA, PRE. Optional.
	*            client_id:    <client id>,   // Client id of your application. Mandatory.
	*            redirect_uri: <uri>,         // Redirect uri of your application. If left empty, will be autodetected from current location. (Optional, recommended)
	*            microsoft:    <false|true>   // Use the Microsoft or Skype Silent login. Optional
	*            use_azure:    <false|true>   // Use Microsft Silent Login in Azure. Optional, default false.
	*        }
	*
	* 3) Set the callback function, which will be called on success or error. It will obtain the response object as a parameter.
	*    The response object contains either the Skypetoken (parameter 'skypetoken') or error (parameter 'error').
	*
	* 4) Trigger the load() whenever needed.
	*
	* 5) Read the response data/get the Skypetoken from response.
	*
	* Example usage:
	* ==============
	* <script type='text/javascript'>
	*    SKYPE.login.Silent
	*      .init({
	*          env:'pre',
	*          client_id:'999999',
	*          redirect_uri:'https://presecure.skype.net/um-tools/mirror',
	*          microsoft: false,
	*          use_azure: false
	*          })
	*      .setCallback(
	*          function (data){
	*              alert(_stringify(data));
	*          })
	*      .load();
	* <\/script>
	*
	* Error cases:
	* ============
	* In case of failed authentication, you may receive one of the following errors in the response:
	* - 'unsupported_browser' - This browser doesn't support capabilities needed for Silent login. You may ask the user for upgrade.
	* - 'timeout'             - The Silent login API didn't answer within the given time window (20s). This might be caused by cross-domain restrictions, misconfiguration or network issues.
	* - 'invalid_grant'       - Authentication failed. User is probably not signed in.
	* - 'not_linked'          - Applies to the Microsoft Silent login (option 'microsoft: true'). Microsoft user is signed in, but not linked to any Skype account.
	*
	* Browser support:
	* ================
	* - IE 8+
	* - Firefox 3.5+
	* - Chrome 4+
	* - Safari 4+
	*/
	function(){void 0===window.SKYPE&&(window.SKYPE={})
	var e=window.SKYPE
	e.login=e.login||{},e.login.Silent=function(){var e,t={pre:"https://prelogin.skype.net",qa:"https://qalogin.skype.net",live:"https://login.skype.com"},n={pre:"https://a.pre.lw.skype.net",qa:"https://a.qa.lw.skype.net",live:"https://a.lw.skype.com"},i=null,r={},o={},a=null,s=null,c="",l=!1,u=!1,d=null,p={env:"live",client_id:null,redirect_uri:null,microsoft:!1,use_azure:!1},f=function(e,t){if(null===d&&(d=window.location.host.match(/^(pre|qa).*\.net$/)||document.cookie.indexOf("debug")>-1||window.location.search.indexOf("debug")>-1),d)try{e="[silentlogin.js] - "+function(e,t){if("string"==typeof t)return e+" - "+t
	if("object"!=typeof t)return e
	var n=[]
	for(var i in t)"skypetoken"===i?n.push(i+": <HIDDEN>"):n.push(i+": "+_stringify(t[i]))
	return e+=" - "+n.join(", "),e}(e,t),console.log(e)}catch(n){}}
	var m=function(e){if(f("Received message from "+e.origin),s&&e.origin===s){var t=e.data
	if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(r){}f("Message data",t)
	var n=t.state||null
	if(c===n){for(var i in window.clearTimeout(a),o={},t)t.hasOwnProperty(i)&&(o[i]=t[i])
	v()}else f("State "+n+" doesn't match the last submitted state "+c)}},h=function(){i&&(e.removeChild(i),i=null)},v=function(){f("Calling callback function",o),u=!1,"function"==typeof r&&r(o)},g=function(){h(),(o={}).error="timeout",v()},y=function(){var e=(new Date).getTime(),i=t
	c="silentloginsdk_"+e
	var r={response_type:"postmessage",client_id:p.client_id,redirect_uri:p.redirect_uri,state:c,_accept:"1.0",_nc:e}
	return p.microsoft&&(r.partner="999",i=p.use_azure?n:t),(s=i[p.env]||i.live)+"/login/silent?"+function(e){var t=[]
	for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]))
	return t.join("&")}(r)}
	var b=function(e){return"function"==typeof e&&(r=e),this}
	return{init:function(e){return"object"==typeof e&&((e=e||{}).hasOwnProperty("callback")&&b(e.callback),p=function(e,t){for(var n in e)t.hasOwnProperty(n)&&(e[n]=t[n])
	return e}(p,e)),l||(l=!0,window.addEventListener?window.addEventListener("message",m,!1):window.attachEvent("onmessage",m)),this},setCallback:b,load:function(){if(!u){if(function(){if(!p.client_id)throw"[silentlogin.js] client_id not initialized. Call init() first."
	p.redirect_uri||(p.redirect_uri=window.location.protocol+"//"+window.location.host+window.location.pathname)}(),u=!0,!("postMessage"in window)||"object"!=typeof JSON||!JSON.parse)return o={error:"unsupported_browser"},void v()
	var t
	window.clearTimeout(a),a=window.setTimeout(g,2e4),t=y(),h(),void 0===e&&(e=document.body||document.head||document.getElementsByTagName("head")[0]),(i=document.createElement("iframe")).frameBorder=0,i.width="1px",i.height="1px",i.style.display="none",i.style.visibility="hidden",i.id="silentLoginFrame"+Math.floor(10*Math.random()+1),i.setAttribute("tabindex",-1),i.setAttribute("src",t),e.appendChild(i),f("Created iFrame: "+t)}},getSkypetoken:function(){return o.skypetoken||null},getFullResponse:function(){return o}}}()}(),define("swx-xco/lib/silentlogin",(function(){})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-xco/lib/index",["require","exports","./linking","./silentlogin"],e)}((function(e,t){e("./linking"),e("./silentlogin"),t.linking=SKYPE.linking,t.silentLogin=SKYPE.login.Silent})),define("swx-xco",["swx-xco/lib/index"],(function(e){return e}))
	define("telemetry/authentication/linking",["require","exports","module","ui/telemetry/telemetryClient","experience/settings"],(function(e,t){var n=e("ui/telemetry/telemetryClient"),i=e("experience/settings")
	function r(){return{send:function(e){n.get().sendEvent(i.telemetry.uiTenantToken,"linking",{flow:e})}}}t.build=function(){return new r}})),define("utils/common/localStorage",[],(function(){function e(){try{return window&&window.localStorage}catch(e){}}return{set:function(t,n){if(e())try{window.localStorage.setItem(t,n)}catch(i){}},get:function(t){if(e())try{return window.localStorage.getItem(t)}catch(n){}},remove:function(t){if(e())try{window.localStorage.removeItem(t)}catch(n){}}}})),define("services/telemetry/common/telemetryContext",["require","swx-constants"],(function(e){var t,n=e("swx-constants").COMMON
	function i(){this.sentEmoticonsInfo=[],this.sentMessagesInfo=[],this.receivedMessagesInfo=[],this.currentConversation=null,this.timelineLoadOrigin=n.telemetry.NOT_AVAILABLE,this.historyLoadOrigin=n.telemetry.NOT_AVAILABLE,this.timelineInSearchMode=n.telemetry.NOT_AVAILABLE,this.timelineLoadStatusCode=n.telemetry.NOT_AVAILABLE,this.activeEndpoints=n.telemetry.NOT_AVAILABLE,this.isChatHistoryLoad404=n.telemetry.NOT_AVAILABLE,this.chatHistoryLoadResult={},this.statusCode=!1}return i.get=function(){return t||(t=new i),t},i})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-telemetry-buckets/lib/telemetryBuckets",["require","exports","swx-constants","swx-enums"],e)}((function(e,t){var n,i,r,o=e("swx-constants"),a=e("swx-enums"),s=6e4,c=36e5,l=24*c,u=o.COMMON.telemetry.NOT_AVAILABLE
	function d(e,t){return 0===e?n.conversationCountBucket.Zero:1===e?n.conversationCountBucket.One:2===e?n.conversationCountBucket.Two:3===e?n.conversationCountBucket.Three:4===e?n.conversationCountBucket.Four:5===e?n.conversationCountBucket.Five:e>5&&e<=10?n.conversationCountBucket.Less10:e>10&&e<=15?n.conversationCountBucket.Less15:e>15&&e<=20?n.conversationCountBucket.Less20:e>20&&e<=50?n.conversationCountBucket.Less50:t&&e>50?Math.round(e/50)+n.conversationCountBucket.More50:e>50&&e<=100?n.conversationCountBucket.Less100:e>100?Math.round(e/100)+n.conversationCountBucket.More100:void 0}function p(e){return 0===e?n.durationBucket.Zero:1===e?n.durationBucket.One:2===e?n.durationBucket.Two:3===e?n.durationBucket.Three:4===e?n.durationBucket.Four:5===e?n.durationBucket.Five:e>5&&e<=10?n.durationBucket.Less10:e>10?Math.round(e/10)+n.durationBucket.More10:n.durationBucket.Na}function f(e){return Math.round(Math.abs((Date.now()-e)/864e5))}(function(e){(function(e){e.Zero="zero",e.One="1",e.Two="2",e.Less5="3-5",e.Less10="5-10",e.Less25="10-25",e.Less50="25-50",e.Less100="50-100",e.More100="x100"})(e.participantCountBucket||(e.participantCountBucket={})),function(e){e.Min1="1MIN",e.Min5="5MIN",e.Min10="10MIN",e.Min30="30MIN",e.Hour1="1HOUR",e.Hour3="3HOUR",e.Hour6="6HOUR",e.Hour9="9HOUR",e.Hour12="12HOUR",e.Hour18="18HOUR",e.Hour24="24HOUR",e.Days="DAY"}(e.timeDeltaBucket||(e.timeDeltaBucket={})),function(e){e.Zero="zero",e.Less5="1-5",e.Less10="5-10",e.Less25="10-25",e.Less50="25-50",e.Less100="50-100",e.Less150="100-150",e.Less200="150-200",e.More200="x200"}(e.contactCountBucket||(e.contactCountBucket={})),function(e){e.Zero="zero",e.One="1",e.Two="2",e.Three="3",e.Four="4",e.Five="5",e.Less10="5-10",e.Less15="10-15",e.Less20="15-20",e.Less50="20-50",e.More50="x50",e.Less100="50-100",e.More100="x100"}(e.conversationCountBucket||(e.conversationCountBucket={})),function(e){e.Min="1MIN",e.Less5Min="5MIN",e.Less10Min="10MIN",e.Less20Min="20MIN",e.Less1Hour="1hour",e.Less1Day="1DAY",e.Less2Days="2DAYS",e.Less4Days="3_4_DAYS",e.Less6Days="5_6_DAYS",e.Less14Days="7_14_DAYS",e.Less21Days="15_21_DAYS",e.Less29Days="22_29_DAYS",e.Na="n/a"}(e.lifetimeBucket||(e.lifetimeBucket={})),function(e){e.YouTube="YT",e.Gif="GIF",e.Twitter="TWIT",e.Other="WWW"}(e.urlContentTypeBucket||(e.urlContentTypeBucket={})),function(e){e.UrlOnly="URL",e.TextWithUrl="URL_MID",e.TextEndingWithUrl="URL_END"}(e.urlPositionBucket||(e.urlPositionBucket={})),function(e){e.Na="n/a",e.Zero="0SEC",e.One="1SEC",e.Two="2SEC",e.Three="3SEC",e.Four="4SEC",e.Five="5SEC",e.Less10="5-10SEC",e.More10="x10SEC"}(e.durationBucket||(e.durationBucket={})),function(e){e.Picture="picture",e.Video="video",e.Audio="audio",e.Office="office",e.Archive="archive",e.Binary="binary",e.Pdf="pdf",e.Other="other"}(e.fileTypeBucket||(e.fileTypeBucket={}))})(n=t.enums||(t.enums={})),function(e){e[e.Start=200]="Start",e[e.End=399]="End"}(i||(i={})),function(e){e[e.Start=400]="Start",e[e.End=599]="End"}(r||(r={})),t.getFileTypeGroup=function(e){switch(e){case"png":case"jpg":case"gif":case"bmp":case"tiff":return n.fileTypeBucket.Picture
	case"avi":case"mp4":case"mkv":case"wmv":case"m4v":return n.fileTypeBucket.Video
	case"mp3":case"cda":case"m4a":case"wav":return n.fileTypeBucket.Audio
	case"xls":case"xlsx":case"xlsm":case"doc":case"docx":case"ppt":case"pptx":return n.fileTypeBucket.Office
	case"zip":case"rar":case"ace":case"7z":case"dmg":return n.fileTypeBucket.Archive
	case"exe":case"msi":case"iso":return n.fileTypeBucket.Binary
	case"pdf":return n.fileTypeBucket.Pdf
	default:return n.fileTypeBucket.Other}},t.getDurationGroup=function(e){return e<=s?n.timeDeltaBucket.Min1:e>s&&e<=3e5?n.timeDeltaBucket.Min5:e>3e5&&e<=6e5?n.timeDeltaBucket.Min10:e>6e5&&e<=18e5?n.timeDeltaBucket.Min30:e>18e5&&e<=c?n.timeDeltaBucket.Hour1:e>c&&e<=3*c?n.timeDeltaBucket.Hour3:e>3*c&&e<=6*c?n.timeDeltaBucket.Hour6:e>6*c&&e<=9*c?n.timeDeltaBucket.Hour9:e>9*c&&e<=12*c?n.timeDeltaBucket.Hour12:e>12*c&&e<=18*c?n.timeDeltaBucket.Hour18:e>18*c&&e<=24*c?n.timeDeltaBucket.Hour24:e>l?Math.round(e/l)+n.timeDeltaBucket.Days:void 0},t.getParticipantCountGroup=function(e){return 0===e?n.participantCountBucket.Zero:1===e?n.participantCountBucket.One:2===e?n.participantCountBucket.Two:e>2&&e<=5?n.participantCountBucket.Less5:e>5&&e<=10?n.participantCountBucket.Less10:e>10&&e<=25?n.participantCountBucket.Less25:e>25&&e<=50?n.participantCountBucket.Less50:e>50&&e<=100?n.participantCountBucket.Less100:e>100?Math.round(e/100)+n.participantCountBucket.More100:void 0},t.getMessageType=function(e){switch(e.model.type_()){case a.activityType.TextMessage:if(e.previews){var t=e.previews()
	if(t.length>0)return t[0].type_()}return a.activityType.TextMessage
	case a.activityType.VideoMessage:case a.activityType.PictureMessage:case a.activityType.MojiMessage:case a.activityType.FileTransfer:return e.model.type_()
	default:return a.activityType.Na}},t.getContactsGroup=function(e){return 0===e?n.contactCountBucket.Zero:e>=1&&e<=5?n.contactCountBucket.Less5:e>5&&e<=10?n.contactCountBucket.Less10:e>10&&e<=25?n.contactCountBucket.Less25:e>25&&e<=50?n.contactCountBucket.Less50:e>50&&e<=100?n.contactCountBucket.Less100:e>100&&e<=150?n.contactCountBucket.Less150:e>150&&e<=200?n.contactCountBucket.Less200:e>200?Math.round(e/200)+n.contactCountBucket.More200:void 0},t.getConversationCountGroup=function(e){return d(e)},t.getMessageCountGroup=function(e){return d(e,!0)},t.getSecondsDurationGroup=p,t.getSecondsDurationGroupFromMs=function(e){return p((t=e,Math.round(t/1e3)))
	var t},t.isError=function(e){return!(i.Start<=e&&e<i.End)&&(r.Start<=e&&e<r.End||u)},t.getUrlContentType=function(e){return e.indexOf("www.youtube.com")>-1?n.urlContentTypeBucket.YouTube:/^http.*\.gif$/.exec(e)?n.urlContentTypeBucket.Gif:e.indexOf("twitter.com")>-1?n.urlContentTypeBucket.Twitter:n.urlContentTypeBucket.Other},t.getMessageLifeDurationGroup=function(e){return e<s?n.lifetimeBucket.Min:e<3e5?n.lifetimeBucket.Less5Min:e<6e5?n.lifetimeBucket.Less10Min:e<12e5?n.lifetimeBucket.Less20Min:e<c?n.lifetimeBucket.Less1Hour:e<l?n.lifetimeBucket.Less1Day:e<2*l?n.lifetimeBucket.Less2Days:e<4*l?n.lifetimeBucket.Less4Days:e<6*l?n.lifetimeBucket.Less6Days:e<14*l?n.lifetimeBucket.Less14Days:e<21*l?n.lifetimeBucket.Less21Days:e<29*l?n.lifetimeBucket.Less29Days:n.lifetimeBucket.Na},t.isMau=function(e){return e?!(!e.sidebar||!e.sidebar.lastTimeOpened)&&f(new Date(e.sidebar.lastTimeOpened))<=30:u},t.isMauCandidate=function(e){return e?!(!e.sidebar||!e.sidebar.lastTimeOpened)&&f(new Date(e.sidebar.lastTimeOpened))>30:u},t.isDauCandidate=function(e){if(!e)return u
	if(e.sidebar&&e.sidebar.lastTimeOpened){var t=f(new Date(e.sidebar.lastTimeOpened))
	return t>1&&t<=30}return!1},t.getDays=f})),define("swx-telemetry-buckets",["swx-telemetry-buckets/lib/telemetryBuckets"],(function(e){return e})),define("telemetry/chat/sidebarReopenedEvent",["require","exports","module","lodash-compat","swx-constants","experience/settings","ui/telemetry/telemetryClient","services/telemetry/common/telemetryContext","swx-browser-globals","swx-cafe-application-instance","swx-telemetry-buckets"],(function(e,t){var n,i=e("lodash-compat"),r=e("swx-constants").COMMON,o=r.telemetry.browserToast,a=e("experience/settings"),s=e("ui/telemetry/telemetryClient"),c=e("services/telemetry/common/telemetryContext"),l=e("swx-browser-globals"),u=e("swx-cafe-application-instance"),d=e("swx-telemetry-buckets")
	function p(){var e,t,p=this,f=E(),m=r.telemetry.NOT_AVAILABLE,h=u.get().conversationsManager
	function v(e){return function(e){var t,n,i
	if(u.get().conversationsManager&&u.get().conversationsManager._allConversations){for(t=u.get().conversationsManager._allConversations(),e.numberOfConversations=t.length,n=0;n<t.length;n++)y(t[n],e)
	for(void 0===e.daysSinceLastConversation&&(e.daysSinceLastConversation=m),i=u.get().conversationsManager._unreadConversations(),e.numberOfUnreadConversations=i.length,e.numberOfUnreadNonGroups=0,e.numberOfUnreadGroups=0,n=0;n<i.length;n++)b(i[n],e)}}(e),function(e){var t={},n=l.getWindow().localStorage.getItem(r.telemetry.idleUsersAnalytics.localKeys.sidebarActivity)
	n&&(t=JSON.parse(n))
	e.daysSinceSidebarOpened=function(e){if(e&&e.sidebar&&e.sidebar.lastTimeOpened)return d.getDays(new Date(e.sidebar.lastTimeOpened))
	return m}(t),e.isMau=d.isMau(t),e.isMauCandidate=d.isMauCandidate(t),e.isDauCandidate=d.isDauCandidate(t)}(e),e.getDaysSinceLastSignIn=function(){try{var e,t=r.telemetry.idleUsersAnalytics.localKeys.signInData,n=l.getWindow().localStorage.getItem(t),i=n?JSON.parse(n):[]
	return!i||i.length<2?m:(e=i[i.length-2],d.getDays(new Date(e)))}catch(o){return m}}(),e.numberOfContacts=u.get().personsAndGroupsManager&&u.get().personsAndGroupsManager.all.persons()?u.get().personsAndGroupsManager.all.persons().length:m,e.endpointsCount=c.get().activeEndpoints.length,e}function g(e,t){s.get().sendEvent(a.telemetry.chatTenantToken,e,t)}function y(e,t){var n,i=e.lastMessage
	i&&(n=d.getDays(new Date(i.composetime)),(void 0===t.daysSinceLastConversation||t.daysSinceLastConversation>n)&&(t.daysSinceLastConversation=n))}function b(e,t){var n;(n=e.id,i.isString(n)&&/^19:/.test(n))?t.numberOfUnreadGroups=t.numberOfUnreadGroups+1:t.numberOfUnreadNonGroups=t.numberOfUnreadNonGroups+1}function _(e){if(!h._unreadCounversationsCounters)return Promise.reject(e)
	return h._unreadCounversationsCounters().then((function(t){var n=t[0]||0,i=t[1]||0,r=m
	return 0===n&&0===i?r=o.unreadState.NONE:n>0&&0===i?r=o.unreadState.PASSIVE:0===n&&i>0?r=o.unreadState.ACTIVE:n>0&&i>0&&(r=o.unreadState.BOTH),e.pastUnreadMessages=n,e.activeUnreadMessages=i,e.unreadState=r,e}))}function E(){return l.getWindow().Date.now()}p.publishReopen=function(){e=l.getWindow().setTimeout(p.publishCloseTimeout,6e4)
	var n=r.telemetry.reopenSidebar.REOPENED
	return t=!0,_({}).then(v,v).then(g.bind(null,n),g.bind(null,n))},p.publishCloseTimeout=function(n){if(!t)return Promise.resolve()
	l.getWindow().clearTimeout(e)
	var i=r.telemetry.reopenSidebar.CLOSE_TIMEOUT,o={timeToClose:E()-f,closedByUser:!!n}
	return t=!1,_(o).then(v,v).then(g.bind(null,i),g.bind(null,i))},p.clear=function(){n=null}}t.build=function(){return n||(n=new p),n}})),define("telemetry/authentication/signIn",["require","exports","module","ui/telemetry/telemetryClient","experience/settings","swx-constants","swx-utils-common","utils/common/localStorage","swx-browser-globals","swx-utils-common","telemetry/chat/sidebarReopenedEvent","swx-service-locator-instance"],(function(e,t){var n=e("ui/telemetry/telemetryClient"),i=e("experience/settings"),r=e("swx-constants").COMMON,o=e("swx-utils-common").stopwatch,a=e("utils/common/localStorage"),s=e("swx-browser-globals"),c=e("swx-utils-common").sessionStorage,l=e("telemetry/chat/sidebarReopenedEvent"),u=e("swx-service-locator-instance").default,d=500
	function p(){(function(){var e,t,n,i=r.telemetry.idleUsersAnalytics.localKeys.signInData,o=r.telemetry.idleUsersAnalytics.localKeys.sidebarActivity
	try{(e=(n=a.get(i))?JSON.parse(n):[]).length>=10&&e.splice(0,e.length-9),e.push(new Date),a.set(i,_stringify(e)),(t=(n=a.get(o))?JSON.parse(n):{sidebar:{}}).sidebar.numberOfSignIns?t.sidebar.numberOfSignIns=t.sidebar.numberOfSignIns+1:t.sidebar.numberOfSignIns=1,a.set(o,_stringify(t)),function(e){if(!u.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.REOPEN_SIDEBAR))return
	if(!e.sidebar.state||"opened"!==e.sidebar.state)return
	var t=s.getWindow(),n=function(){try{t.$ToggleSidebar&&(t.$ToggleSidebar(),l.build().publishReopen())}catch(e){}}
	t.$Do&&t.$Do.when&&t.$ToggleSidebar?t.$Do.when("$WLXIM.SidebarCreated",0,n):t.setTimeout(n,d)}(t)}catch(c){}})()
	var e=o.build()
	return{send:function(t){var o,a={}
	a.duration=e.duration(),a.authType=t.authType,a.success=t.hasSucceed,a.hostname=location.hostname,a.retry=t.retry||!1,t.isExternalSignIn&&(a.isExternalSignIn=t.isExternalSignIn),(o=c.get(r.storageKeys.AAD_TOKEN_EXPIRED))&&c.remove(r.storageKeys.AAD_TOKEN_EXPIRED),o&&(a.isExternalSignInAfterTokenRefresh=!0),t.hasSucceed||(a.error=t.error,a.jCafeStatus=t.jCafeStatus||"",t.details&&(a.reason=t.details.reason||"",a.request=t.details.request||"",a.response=t.details.response||"")),t.flow&&(a.flow=t.flow),n.get().sendEvent(i.telemetry.uiTenantToken,"signIn",a),n.get().setAuthType&&n.get().setAuthType(t.authType)}}}t.build=function(){return new p}})),define("experience/api/auth/linking",["require","exports","module","swx-cafe-application-instance","experience/settings","ui/appOverlay/appOverlay","swx-xco","swx-constants","swx-enums","telemetry/authentication/linking","telemetry/authentication/signIn","experience/api/auth/authEventHandler"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("experience/settings"),r=e("ui/appOverlay/appOverlay"),o=e("swx-xco").linking,a=e("swx-constants").COMMON,s=e("swx-enums"),c=e("telemetry/authentication/linking"),l=e("telemetry/authentication/signIn"),u=e("experience/api/auth/authEventHandler")
	function d(e){l.build().send(e)}function p(e,t){"function"==typeof e&&e(t)}t.start=function(e){var t,l,f=function(e){return e.relink?a.api.auth.accountLinking.RELINK_FLOW:e.createTechnical?a.api.auth.accountLinking.INLINE_NEW_USER_FLOW:a.api.auth.accountLinking.WELCOME_FLOW}(e)
	if(!e.rps_token)throw"[XCO Linking] You have to provide an rps token!"
	if(e.welcome&&e.createTechnical)throw'[XCO Linking] You cannot start both "createTechnical" and "welcome" flows'
	function m(e){var t=n.get().signInManager
	if(function(e){return e&&e.skypetoken}(e)){var r=t.createTokenImplicitOAuthSignInParameter({skypetoken:e.skypetoken,rps_token:e.rps_token,expires_in:e.expires_in,client_id:i.implicitOAuthParams.client_id,site_name:e.site_name})
	return t.signIn(r)}return Promise.reject()}t={client_id:"580081",clientVersion:i.uiVersion,rps_token:e.rps_token,microsoft:!0,env:i.xcoEnv,setlang:i.initParams.locale,createTechnical:e.createTechnical||!1,hidden:e.hidden||!1,welcome:e.welcome||!1,relink:e.relink||!1,theme:"skype-white",site_name:e.site_name||null,callback:function(t){var n=e.callback||m
	return function(e){return e&&e.error}(t)&&function(e,t,n){d({authType:s.authType.ImplicitOAuth,hasSucceed:!1,error:t.error,flow:e}),u.startAuthFailedFlow(t,n)}(f,t,n),n(t).then((function(){p(e.onSuccess),r.destroy(),t=f,d({authType:s.authType.ImplicitOAuth,hasSucceed:!0,flow:t})
	var t}),(function(){p(e.onError,t),r.destroy()}))}},l=f,c.build().send(l),o.init(t),o.load(r.create())}})),define("telemetry/authentication/setAuthProvider",["require","exports","module","ui/telemetry/telemetryClient","experience/settings"],(function(e,t){var n=e("ui/telemetry/telemetryClient"),i=e("experience/settings")
	function r(){return{send:function(e){var t={}
	t.authType=e.authType,t.success=e.hasSucceed,t.implicitSignIn=e.implicitSignIn,t.hostname=location.hostname,e.hasSucceed||(t.error=e.error,e.details&&(t.details=e.details)),n.get().sendEvent(i.telemetry.uiTenantToken,"setAuthProvider",t),n.get().setAuthType&&n.get().setAuthType(e.authType)}}}t.build=function(){return new r}})),define("experience/authContext",["require","lodash-compat"],(function(e){var t=e("lodash-compat"),n={implicitSignIn:!1,implicitSignOut:!1},i=t.clone(n)
	return{get:function(){return i},reset:function(){t.assign(i,n)}}})),define("experience/api/authentication",["require","swx-cafe-application-instance","swx-constants","experience/settings","experience/api/auth/linking","experience/api/error","telemetry/authentication/signIn","telemetry/authentication/setAuthProvider","experience/api/auth/authEventHandler","experience/authContext","swx-service-locator-instance","lodash-compat","swx-pubsub-instance","swx-enums"],(function(e){var t,n,i,r,o,a=e("swx-cafe-application-instance"),s=e("swx-constants").COMMON,c=e("experience/settings"),l=e("experience/api/auth/linking"),u=e("experience/api/error").asApiError,d=e("telemetry/authentication/signIn"),p=e("telemetry/authentication/setAuthProvider"),f=e("experience/api/auth/authEventHandler"),m=e("experience/authContext"),h=e("swx-service-locator-instance").default,v=e("lodash-compat"),g=e("swx-pubsub-instance").default,y=e("swx-enums"),b=410,_="LimitExceeded"
	function E(e){if(v.isFunction(e))try{e.apply(null,[].slice.call(arguments,1))}catch(t){}}function w(e,p,y){try{(function(e,n,p,y){var w,S,C=a.get().signInManager,T=v.defaults(e,{id:c.application.endpointId,version:x()}),I=d.build(),A=!1
	if(y=y||{},!o)return void O(new Error(s.api.auth.errorMessages.AUTH_DISABLED))
	if(!C.signIn.enabled())return void O(new Error(s.api.auth.errorMessages.ALREADY_SIGNED_IN))
	function M(){m.reset(),window.clearTimeout(w),E(n)}function O(e){m.reset(),function(e){return e&&e.name===s.api.auth.errorTypes.NOT_LINKED}(e)?function(e,t,n){var o=c(s.api.auth.accountLinking.WELCOME_FLOW),a=!1
	h.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.SILENT_LINKING)&&(o=c(s.api.auth.accountLinking.INLINE_NEW_USER_FLOW),a=!0)
	function c(e){return function(){var o={rps_token:i,onSuccess:t,onFailure:n}
	e===s.api.auth.accountLinking.WELCOME_FLOW&&(o.welcome=!0),e===s.api.auth.accountLinking.INLINE_NEW_USER_FLOW&&(o.createTechnical=!0,o.hidden=!0),function(e){r&&(e.site_name=r)}(o),l.start(o)}}f.startAuthFailedFlow(e,o,a)}(e,n,p):(E(p,u(e)),f.deferActionOnSplashscreen((function(){g.publish(s.events.auth.SIGNIN_FAILED,e)}),e)),t=!0}function k(){U(function(e){var t=new Error(s.silentLogin.errorMessages.TIMED_OUT)
	return t.jCafeStatus=e,t}(S)),n=null,p=null}function N(){var e=s.api.auth.DEFAULT_SIGNIN_TIMEOUT
	return c.authentication&&c.authentication.signInTimeout&&(e=c.authentication.signInTimeout),e}function P(){w||(w=window.setTimeout(k,N()))}function R(){w&&(window.clearTimeout(w),w=void 0)}function L(){window.addEventListener(s.events.browser.FOCUS,P),window.addEventListener(s.events.browser.BLUR,R)}function D(){window.removeEventListener(s.events.browser.FOCUS,P),window.removeEventListener(s.events.browser.BLUR,R)}function U(n){A||(A=!0,R(),D(),function(e,n,i,r){var o
	o={authType:n,hasSucceed:!0,retry:t,isExternalSignIn:Boolean(r)},i&&(o.hasSucceed=!1,o.error=i.message,o.details=i.details,i.jCafeStatus&&(o.jCafeStatus=i.jCafeStatus))
	e.send(o)}(I,e.type,n,y.isExternalSignIn),n?O(n):M())}P(),L(),C.signIn(T).then((function(){U(null)}),(function(e){U(function(e){var t,n,o,a
	e=e||{},i=e.rps_token,r=e.site_name,t=e.reason,n=e.req||e.request,o=e.rsp||e.response,a=new Error(e.error||e.code||e.message||""),f.setErrorType(a),a.details={},t&&(a.details.reason=_stringify(t))
	n&&(a.details.request=_stringify(n))
	o&&(a.details.response=_stringify(o),(o.status===b||o.data&&o.data.subcode===_)&&(a.name=s.api.auth.errorTypes.TOO_MANY_CONNECTIONS_ERROR))
	return a}(e))}),(function(e){S=e}))})(function(e){var t,n=a.get().signInManager,i=c.implicitOAuthParams&&{client_id:c.implicitOAuthParams.client_id}||{}
	if(e.type===s.api.auth.authProviderType.SKYPE_TOKEN)return v.merge({},i,n.createTokenSignInParameter({getToken:e.getToken,getExpiryTime:e.getExpiryTime}))
	if(e.type===s.api.auth.authProviderType.IMPLICIT_AUTH)return n.createImplicitOAuthSignInParameter(c.implicitOAuthParams)
	if(e.type===s.api.auth.authProviderType.PASSWORD)return v.merge({},i,n.createPasswordSignInParameter({username:e.username,password:e.password}))
	if(e.type===s.api.auth.authProviderType.ANONYMOUS)return t={type:"Anonymous",meeting:e.options.conferenceUri,name:e.options.displayName},e.options.useInternalAnonFlow&&(t.xmscwt=e.options.useInternalAnonFlow),e.options.discoverUri&&(t.root={user:e.options.discoverUri}),t
	throw new Error("invalid auth type")}(n),e,p,y)}catch(w){E(p,u(w,"signIn"))}}function S(e,t,n,i){var r={authType:t.type,hasSucceed:!0,implicitSignIn:n}
	i&&(r.hasSucceed=!1,r.error=i.message||"Unknown error",i.data&&(r.details=i.data)),e.send(r)}function x(){return"{product}({version} - {workload})".replace("{product}",c.productName||"unknown").replace("{version}",c.version||"").replace("{workload}",c.initParams.correlationIds.hostProperty||"unknown")}return{init:function(){o=!0,f.init()},destroy:function(){o=!1,f.destroy()},setAuthProvider:function(e,i,r){var o=!1!==i,a=p.build()
	t=!1,n=e,o?(m.get().implicitSignIn=!0,w((function(){S(a,e,o),E(i)}),(function(t){S(a,e,o,t),E(r,t)}))):S(a,e,o)},signIn:w,signOut:function(e,n){var i=a.get().signInManager,r=a.get().personsAndGroupsManager.mePerson
	function c(e){m.reset(),E(n,u(e,"signOut"))}t=!1,i.signOut.enabled()?i.signOut().then((function(){o=!1,m.reset(),r.status(y.onlineStatus.Offline),E(e)}),c):c(s.api.auth.errorMessages.ALREADY_SIGNED_OUT)}}})),define("experience/api/events",["require","exports","module","lodash-compat","swx-service-locator-instance","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON
	t.subscribeUI=function(e,t){var o=i.resolve(r.serviceLocator.PUBSUB)
	if(!n.isString(e)||!n.isFunction(t))throw new TypeError("invalid arguments; expected an event name (String) and callback (Function)")
	o.subscribe(e,t)}})),define("utils/common/applicationFocusManager",["require","exports","module","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionNames","browser/dom","browser/document","swx-browser-detect"],(function(e,t){var n=e("swx-service-locator-instance").default,i=e("swx-constants").COMMON,r=e("ui/telemetry/actions/actionNames"),o=e("browser/dom"),a=e("browser/document"),s=e("swx-browser-detect").default,c="data-focusManager",l=[],u=null,d=0
	function p(e){t.focusTrackingEnabled&&(e.target!==t.getLastFocusedElement()&&(e.target.setAttribute("data-focusManager",d),l.push(d),d++),l.length>2&&m(l.shift()))}function f(e){return a.querySelector("["+c+'="'+e+'"]')}function m(e){var t=f(e)
	t&&t.removeAttribute(c)}return t.focusTrackingEnabled=!1,t.reset=function(){l.forEach(m),l=[],d=0},t.setDefaultFocusElement=function(e){u=e},t.getDefaultFocusElement=function(){return u},t.getLastFocusedElement=function(){return l.length?f(l[l.length-1]):null},t.removeLastFocusedElement=function(){m(l.pop())},t.registerContainer=function(e){e.addEventListener("focus",p,!0)},t.unregisterContainer=function(e){e.removeEventListener("focus",p,!0)},t.tryRestoreFocus=function(){if(t.focusTrackingEnabled){n.resolve(i.serviceLocator.ACTION_TELEMETRY).recordAction(r.focusManager.tryRestoreFocus)
	var e=t.getLastFocusedElement()
	if(e&&e.focus(),e!==a.activeElement)if(!a.querySelector("#swxSplashScreen")){var o=a.querySelector(".swx .chat .inputField"),s=a.querySelector(".swx .search .inputField")
	o&&o.focus(),o!==a.activeElement&&s&&s.focus()}}},t.isAnyElementFocused=function(){var e=a.activeElement
	return!!(!s.getBrowserInfo().isIeEngine||e&&Object.keys(e).length)&&!o.isA(e,"body")},t})),define("utils/common/appVisibilityProvider",["require","exports","module","vendor/knockout","browser/document","browser/window","swx-browser-detect","utils/common/applicationFocusManager"],(function(e,t){var n=e("vendor/knockout"),i=e("browser/document"),r=e("browser/window"),o=e("swx-browser-detect").default,a=e("utils/common/applicationFocusManager")
	function s(e){t.hasFocus(e)}t.hasFocus=n.observable(),t.isVisible=function(e){e&&a.tryRestoreFocus()},t.init=function(){o.getBrowserInfo().browserName===o.BROWSERS.EDGE?(r.addEventListener("focusin",s.bind(null,!0)),r.addEventListener("focusout",s.bind(null,!1))):(r.addEventListener("focus",s.bind(null,!0)),r.addEventListener("blur",s.bind(null,!1))),t.hasFocus(i.hasFocus())}})),define("experience/api/visibility",["require","exports","module","utils/common/appVisibilityProvider"],(function(e,t){var n=e("utils/common/appVisibilityProvider")
	t.setFocus=function(e){n.isVisible(e)}})),define("experience/api/focus",["require","exports","module","utils/common/applicationFocusManager"],(function(e,t){var n=e("utils/common/applicationFocusManager")
	t.restoreFocus=function(){n.tryRestoreFocus()}})),define("experience/api/rendering",["require","exports","module","swx-constants","experience/settings","swx-service-locator-instance","experience/api/helpers/contentNavigatorStore"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=e("swx-service-locator-instance").default,o=e("experience/api/helpers/contentNavigatorStore")
	function a(e,t,i){return r.resolve(n.serviceLocator.CONTROLS_BUILDER).build(e,t,i)}t.renderContent=function(e,t){o.add(e),a(i.controls.content.toLowerCase(),e,t)},t.renderSidebar=function(e,t){a(i.controls.sidebar.toLowerCase(),e,t)},t.renderMe=function(e,t){a(i.controls.me.toLowerCase(),e,t)}})),define("experience/api/messageFilter",["require","lodash-compat","experience/settings"],(function(e){var t=e("lodash-compat"),n=e("experience/settings")
	return{setOutgoingMessageFilter:function(e){if(!t.isFunction(e))throw"Message filter needs to be a valid function object"
	n.messageFilters.outgoingMessageFilter=e},setChatLogMessageFilter:function(e){if(!t.isFunction(e))throw"Message filter needs to be a valid function object"
	n.messageFilters.chatLogMessageFilter=e}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-skypeuri-parser/lib/skypeUriParser",["require","exports","lodash-compat"],e)}((function(e,t){var n,i=e("lodash-compat"),r={discoverbots:"swx-discover-agents"}
	function o(e){return/^skype:\??([a-zA-Z0-9;:_\-\+]){1,}\??[a-zA-Z0-9=?&]*$/i.test(e)}function a(e,t){var n=e.indexOf(t)
	return n>-1?[e.substr(0,n),e.substr(n+1)]:[e]}function s(e,t){switch(e){case n.Call:return r=(i=t).video,o=i.token,a=i.topic,s=i.origin,{video:"true"===r,token:o,topic:a,origin:s}
	case n.Chat:return function(e){var t=e.topic
	return{topic:t}}(t)
	default:return null}var i,r,o,a,s}(function(e){e[e.Call=0]="Call",e[e.Chat=1]="Chat",e[e.Navigate=2]="Navigate",e[e.Unknown=3]="Unknown"})(n=t.ActivityType||(t.ActivityType={})),t.parse=function(e){if(o(e)){var t,c=function(e){var t=a(e,":"),n=t[0],i=a(t[1],"?"),r=i[0].split(";").filter((function(e){return""!==e})),o=i[1]||""
	return{scheme:n,resourceIdentifiers:r,queryString:o}}(e),l=c.queryString.split("&"),u=l[0],d=l.reduce((function(e,t){var n=t.split("="),i=n[0],r=n[1]
	return e[i]=r,e}),{}),p=function(e){if("chat"===e)return n.Chat
	return n.Call}(u)
	return i.has(r,c.queryString)&&(t=r[c.queryString],p=n.Navigate),{activityType:p,participants:c.resourceIdentifiers,navigationId:t,activityParameters:s(p,d)}}},t.isValidSkypeUri=o,t.containsSkypeUri=function(e){return/skype:\??(\S+;?){1,}\??.*/i.test(e)}})),define("swx-skypeuri-parser",["swx-skypeuri-parser/lib/skypeUriParser"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-ui-navigation/lib/navigation",["require","exports","swx-browser-globals","swx-skypeuri-parser","swx-pubsub-instance","swx-constants","swx-cafe-application-instance","swx-service-locator-instance","swx-utils-chat","swx-enums"],e)}((function(e,t){var n=e("swx-browser-globals"),i=e("swx-skypeuri-parser"),r=e("swx-pubsub-instance"),o=e("swx-constants"),a=e("swx-cafe-application-instance"),s=e("swx-service-locator-instance"),c=e("swx-utils-chat"),l=e("swx-enums")
	function u(e){var t=e.map((function(e){var t=a.get().personsAndGroupsManager.createPersonSearchQuery()
	return new Promise((function(n){t.sources(l.searchScope.All),t.text(e),t.getMore().then((function(){t.results().length&&n(t.results(0).result)}))}))}))
	return Promise.all(t)}t.navigate=function(e,t){return s.default.resolve(o.COMMON.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.COMMON.featureFlags.SKYPE_URI_NAVIGATION_ENABLED)&&0===e.indexOf("skype:")?function(e,t){var n=i.parse(e)
	if(n)switch(n.activityType){case i.ActivityType.Call:return function(e,t,n){return new Promise((function(i){u(e.participants).then((function(e){var r=1===e.length?o.COMMON.telemetry.navigation.ONE_TO_ONE_CALL_SKYPE_URI:o.COMMON.telemetry.navigation.GROUP_CALL_SKYPE_URI
	if(t&&e.length){var s=c.conversation.createConversation(e,a.get().conversationsManager)
	s._conversationIdReady&&s._conversationIdReady.once(!0,(function(){t.placeCall(s,n,r).then(i,i)}))}else i()}))}))}(n,t,n.activityParameters.video)
	case i.ActivityType.Chat:return function(e){return u(e.participants).then((function(e){if(e.length){var t={model:c.conversation.createConversation(e,a.get().conversationsManager),origin:1===e.length?o.COMMON.telemetry.navigation.ONE_TO_ONE_CHAT_SKYPE_URI:o.COMMON.telemetry.navigation.GROUP_CHAT_SKYPE_URI}
	r.default.publish(o.COMMON.events.navigation.OPEN_CONVERSATION,t)}}))}(n)
	case i.ActivityType.Navigate:return function(e){return u(e.participants).then((function(t){if(e.navigationId){var n={page:e.navigationId,origin:o.COMMON.telemetry.historyLoadOrigin.SKYPE_URI}
	r.default.publish(o.COMMON.events.navigation.NAVIGATE,n)}}))}(n)}}(e,t):function(e){var t=n.getWindow().open()
	return t.opener=null,t.location.href=e,Promise.resolve()}(e)}})),define("swx-ui-navigation",["swx-ui-navigation/lib/navigation"],(function(e){return e})),define("experience/api/navigation",["require","exports","module","swx-ui-navigation"],(function(e,t){var n=e("swx-ui-navigation")
	t.navigateBySkypeUri=function(e){n.navigate(e)}})),define("experience/api/flagsObservable",["require","exports","module","lodash-compat","swx-constants","vendor/knockout","swx-service-locator-instance","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("vendor/knockout"),o=e("swx-service-locator-instance").default,a=e("experience/settings")
	t.expose=function(){var e=r.observable(""),t=o.resolve(i.serviceLocator.PUBSUB),s={read:e,write:function(e){a.flags=""===e?"[]":e}}
	return t.subscribe(i.events.flags.SET_FLAG,(function(t){if(!n.isString(t))throw new TypeError("invalid arguments; expected a flag name (String)")
	e(t)})),{flags:r.computed(s)}}})),define("experience/api/builder",["require","exports","module","jCafe","swx-cafe-application-instance","experience/api/me","experience/api/contact","experience/api/conversation","experience/api/notifications","utils/chat/unreadConversations","experience/api/calling","experience/api/authentication","experience/api/events","experience/api/visibility","experience/api/focus","experience/api/rendering","experience/settings","experience/api/messageFilter","experience/api/navigation","experience/api/flagsObservable"],(function(e,t){var n=e("jCafe"),i=e("swx-cafe-application-instance"),r=e("experience/api/me"),o=e("experience/api/contact"),a=e("experience/api/conversation"),s=e("experience/api/notifications"),c=e("utils/chat/unreadConversations"),l=e("experience/api/calling"),u=e("experience/api/authentication"),d=e("experience/api/events"),p=e("experience/api/visibility"),f=e("experience/api/focus"),m=e("experience/api/rendering"),h=e("experience/settings"),v=e("experience/api/messageFilter"),g=e("experience/api/navigation"),y=e("experience/api/flagsObservable")
	t.get=function(){var e={}
	return 1===h.API.version&&(function(e){u.init(),e.setAuthProvider=u.setAuthProvider,e.signIn=u.signIn,e.signOut=u.signOut}(e),function(e){e.me=r.expose()}(e),function(e){e.contact=o.getByUri}(e),function(e){e.setNotificationHandler=s.setNotificationHandler}(e),function(e){e.renderContent=m.renderContent,e.renderSidebar=m.renderSidebar,e.renderMe=m.renderMe}(e),function(e){e.startConversation=a.startConversation,e.joinConversation=a.joinConversation,e.newConversation=a.newConversation}(e),function(e){e.activity={unreadConversations:c.getInstance().getCount}}(e),function(e){e.setFocus=p.setFocus}(e),function(e){e.focus={restoreFocus:f.restoreFocus}}(e),function(e){e.subscribeUI=d.subscribeUI}(e),function(e){e.getVersion=function(){return h.version}}(e),function(e){e.calling=l.buildApi()}(e),function(e){e.setPluginAutoUpdate=function(e){h.featureFlags.pluginAutoUpdate=e}}(e),function(e){e.isAvailable=function(){return!0}}(e),function(e){e.flags=y.expose()}(e),function(e){e.navigateBySkypeUri=g.navigateBySkypeUri}(e)),2===h.API.version&&(function(e){e.UIApplicationInstance=i.get()}(e),function(e){e.renderConversation=a.renderConversation}(e),function(e){e.setAnonymousUserMode=function(e){h.authentication.anonymousMode=!!e}}(e),function(e){e.setOutgoingMessageFilter=v.setOutgoingMessageFilter}(e),function(e){e.setChatLogMessageFilter=v.setChatLogMessageFilter}(e)),h.API.exposeCafe&&function(e){e.application=n.Application}(e),e}})),define("experience/componentsInitializer",[],(function(){return{init:function(e,t,n){var i=0,r=window.setTimeout((function(){t=null,n("Initialization not completed by timeout period.")}),3e3)
	function o(){++i===e.length&&(window.clearTimeout(r),t&&(t(),e.forEach((function(e){e.load&&e.load()}))))}e.forEach((function(e){e.init(o)}))}}})),define("text!views/experience/sidebar.html",[],(function(){return'<swx-sidebar data-bind="event: { mousemove: handleUserAction, click: handleUserAction, mousewheel: handleUserAction, keydown: handleUserAction }"></swx-sidebar>\r\n'})),define("text!views/chat/shareDialog.html",[],(function(){return'<div id="swx-share-dialog" data-bind="css:{ \'swx-hide\': isHidden }">\r\n    <div id="top-bar">\r\n        <div id="title-holder">\r\n            <span id="title"\r\n                  data-bind="l10n: { \'key\': \'share_on_skype_dialog_title\'}">\r\n            </span>\r\n        </div>\r\n    </div>\r\n\r\n    <div id="lower-pane">\r\n\r\n        <div id="link-preview-placeholder"></div>\r\n\r\n        <div class="conversationControl chat themeLight">\r\n            <swx-chat-input\r\n                class="input"\r\n                data-bind="css: { showCover: false, hide: false }"\r\n                params="conversationModel: null,\r\n                        alwaysHideExpressionPicker: true">\r\n            </swx-chat-input>\r\n        </div>\r\n\r\n        <div class="shareButtonHolder">\r\n            <swx-button params="cssClass: \'primary circle\',\r\n                                disabled: !shareButtonEnabled,\r\n                                textKey: \'share_on_skype_share_button\',\r\n                                titleKey: \'share_on_skype_share_button\',\r\n                                action: share">\r\n            </swx-button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("utils/common/eventMixin",["require","lodash-compat","swx-log-tracer"],(function(e){var t=e("lodash-compat"),n=e("swx-log-tracer").getLogger()
	function i(){this.listeners=null,this._disposeExtended=!1,this._parentContext=null,this._childrenContexts=null}function r(e,t,n,i){var r=e&&e.listeners&&e.listeners[t],o=!1
	return!!r&&(r.forEach((function(e){e.direction&n&&(e.callback.call(e.context,i),o=!0)})),o)}function o(e){if(!e._disposeExtended){var t=e.dispose
	e.dispose=function(){t&&t.call(e),e.disposeEvents()},e._disposeExtended=!0}}return i.prototype.DIRECTION={PARENT:1,CHILD:2,ANY:3},i.prototype.dispatchEvent=function(e,t,o){var a=!1
	return!!e&&((o=o||i.DIRECTION.ANY)&i.DIRECTION.PARENT&&(this._parentContext||n.error("Dispatching to parent, but parent context wasn't set !"),a=r(this._parentContext,e,i.DIRECTION.CHILD,t)),o&i.DIRECTION.CHILD&&this._childrenContexts&&this._childrenContexts.forEach((function(n){a=r(n,e,i.DIRECTION.PARENT,t)||a})),a)},i.prototype.addChildContext=function(e){this._childrenContexts=this._childrenContexts||[],this._childrenContexts.push(e),o(this)},i.prototype.removeChildContext=function(e){if(this._childrenContexts){var t=this._childrenContexts.indexOf(e);-1!==t&&this._childrenContexts.splice(t,1)}},i.prototype.setContext=function(e){this._parentContext=e,this._parentContext.addChildContext&&this._parentContext.addChildContext(this),o(this)},i.prototype.disposeEvents=function(){this.listeners=null,this._childrenContexts=null,this._parentContext&&this._parentContext.removeChildContext&&this._parentContext.removeChildContext(this),this._parentContext=null},i.prototype.registerEvent=function(e,t,n,r){var a,s,c
	return e&&t?(o(this),this.listeners=this.listeners||{},this.listeners[e]=this.listeners[e]||[],a=this.listeners[e],0==(n&i.DIRECTION.ANY)&&(r=n,n=i.DIRECTION.ANY),n=n||i.DIRECTION.ANY,s=function(e,t,n){return e.filter((function(e){return e.callback===t&&e.context===n}))[0]}(a,t,r),s?null:(c={callback:t,direction:n,context:r},a.push(c),{dispose:function(){(function(e,t){e.splice(e.indexOf(t),1)})(a,c)}})):null},i.prototype.forwardEvent=function(e,t,n,r,o){0==(r&i.DIRECTION.ANY)&&(o=r,r=i.DIRECTION.ANY),this.registerEvent(e,(function(i){n&&n.call(o,i),this.dispatchEvent(e,i,t,o)}),r,this)},t.assign(i,i.prototype),i})),define("ui/viewModels/chat/shareDialog",["require","exports","module","lodash-compat","vendor/knockout","swx-constants","utils/common/eventMixin","swx-cafe-application-instance"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("swx-constants").COMMON.events,o=e("utils/common/eventMixin"),a=e("swx-cafe-application-instance")
	function s(e,t){var o=this,s=[]
	o.sharedUrl=e,o.flowId=t,o.isHidden=i.observable(!0),o.show=function(){o.isHidden(!1)},o.dispose=function(){},o.shareButtonEnabled=i.observable(!0),o.chatInputAsync=new Promise((function(e){o.registerEvent(r.textarea.INITIALIZATION_COMPLETE,(function(t){e(t.messageBody)}))})),o.share=function(){var e=o.chatInputAsync.then((function(e){var t,i,r;(i=a.get().conversationsManager,r=i.conversations(),r.length>0?(t=n.max(r,(function(e){return e.lastModificationTimestamp()})),Promise.resolve([t])):i.getMoreConversations.enabled()?i.getMoreConversations(1).then((function(){return[n.first(i.conversations())]})):Promise.resolve([])).then((function(t){var i=e()
	n.forEach(t,(function(e){(function(e,t){var n=e.chatService;(t=t.trim()).length>0&&n.sendMessage(t),o.sharedUrl&&n.sendMessage(o.sharedUrl)})(e,i)}))}))}))
	return s.push(e),e.then((function(){s.remove(e)})),e},o.whenAllSharingOpsCompleted=function(){return Promise.all(s)}}n.assign(s.prototype,o),t.build=function(e,t){return new s(e,t)}}))
	define("ui/controls/experience/shareDialogController",["require","exports","module","vendor/knockout","browser/dom","browser/window","swx-constants","swx-service-locator-instance","text!views/chat/shareDialog.html","ui/viewModels/chat/shareDialog"],(function(e,t){var n=e("vendor/knockout"),i=e("browser/dom"),r=e("browser/window"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("text!views/chat/shareDialog.html"),c=e("ui/viewModels/chat/shareDialog"),l=".swx",u="swx-share-dialog"
	t.getRawQueryString=function(){return r.location.search},t.conditionallyLaunchSharingExperience=function(){a.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.SHOW_ALTERNATE_SHARE_DIALOG_EXPERIENCE)&&function(){(function(){if(i.getElement("#"+u))throw new Error("Internal API error: Share Dialog should not be launched more than once")})()
	var e=function(){for(var e=t.getRawQueryString()||"",n=(e=e.replace(/^\??/,"")).split("&"),i={},r=0;r<n.length;r++){var o=n[r].split("="),a=decodeURIComponent(o[0]||"").toLowerCase(),s=decodeURIComponent(o[1]||""),c=i[a]
	c||(c=[],i[a]=c),c.push(s)}return{sharedUrl:(i.sharedurl||[])[0],flowId:(i.flowid||[])[0]}}(),r=c.build(e.sharedUrl,e.flowId),o=function(){var e=i.createElement("div")
	e.innerHTML=s
	var t=e.firstChild
	return i.getElement(l).appendChild(t),t}()
	n.applyBindings(r,o),r.show()}()}})),define("utils/common/resizeHandler",["require","browser/dom"],(function(e){var t=e("browser/dom"),n="RESIZING"
	return function(e){if(!e)throw new Error("Container must not be null")
	var i=null
	function r(){t.removeClass(e,n),clearTimeout(i),i=null}this.resize=function(){i?clearTimeout(i):t.addClass(e,n),i=setTimeout(r,500)},this.dispose=function(){r()}}})),define("ui/viewModels/experience/sidebar",["require","lodash-compat","swx-cafe-application-instance","vendor/knockout","browser/window","swx-utils-common","swx-constants","swx-service-locator-instance","utils/common/styleModeHelper","utils/common/resizeHandler"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("vendor/knockout"),r=e("browser/window"),o=e("swx-utils-common").async,a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default,c=e("utils/common/styleModeHelper"),l=e("utils/common/resizeHandler"),u=a.events.narrowMode,d=a.events.navigation,p=a.events.search,f=a.events.contextMenu
	return function(e){var m,h,v,g,y=this,b=n.get(),_=s.resolve(a.serviceLocator.PUBSUB),E=!1,w=!1,S=!1,x=0,C=0
	function T(e){e(d.NAVIGATE,R),e(d.OPEN_CONVERSATION,R),e(u.SHOW_SIDEBAR,y.slideIn),e(u.HIDE_SIDEBAR,y.slideOut),e(f.MENU_SHOWN,N),e(f.MENU_HIDDEN,P)}function I(e){e(p.QUERY_CHANGED,O),e(p.RESET,k),e(p.INPUT_FOCUS,A),e(p.INPUT_BLUR,M)}function A(){E=!0,y.expand()}function M(e){E=!1,0===e&&y.collapse(y)}function O(e){e?w=!0:!e&&E?w=!1:R()}function k(){E&&(w=!1)}function N(){r.clearTimeout(C),S=!0}function P(e){S=!1,e||y.collapse()}function R(){E=!1,w=!1,S=!1,y.collapse(),r.clearTimeout(C)}function L(){y.isExpanded()||!w&&!E||y.expand(),g.resize()}function D(e){r.clearTimeout(C),e.timeout?C=r.setTimeout(y.isExpanded.bind(y,e.expanded),e.timeout):y.isExpanded(e.expanded)}function U(e){r.clearTimeout(x),x=r.setTimeout(y.showTooltips.bind(y,e),500)}function F(e){_.publish(u.SIDEBAR_STATE_CHANGED,e)}function B(e){T(e?_.subscribe.bind(_):_.unsubscribe.bind(_)),!e&&y.isExpanded()&&y.isExpanded(!1)}function V(e){S?r.clearTimeout(C):e()}function G(e){return function(){y.isActive()&&e.apply(y,arguments)}}y.isActive=i.pureComputed((function(){return c.get().currentMode()===a.styleMode.NARROW})),y.isExpanded=i.observable(!1),y.showTooltips=i.observable(!1),y.showPreSlideClass=i.observable(!1),y.addSlideInClass=i.observable(!1),y.addSlideOutClass=i.observable(!1),y.init=function(){h=y.isActive.subscribe(B),v=y.isExpanded.subscribe(F),I(_.subscribe.bind(_)),m=t.debounce(L,1e3),r.addEventListener(a.events.browser.RESIZE,m),g=new l(e),o.execute(L),y.isActive()&&T(_.subscribe.bind(_))},y.dispose=function(){g.dispose(),h.dispose(),v.dispose(),T(_.unsubscribe.bind(_)),I(_.unsubscribe.bind(_)),r.removeEventListener(a.events.browser.RESIZE,m)},y.expand=G((function(e){V((function(){y.isExpanded()||U(!0)
	D({expanded:!0,timeout:e&&500})}))})),y.collapse=G((function(e){V((function(){E||(U(!1),w||D({expanded:!1,timeout:e&&500}))}))})),y.slideIn=G((function(){y.addSlideInClass(!0),y.addSlideOutClass(!1)})),y.slideOut=G((function(){y.addSlideInClass(!1),y.addSlideOutClass(!0)})),y.slideTransitionEnded=function(){_.publish(u.SIDEBAR_TRANSITION_ENDED)},y.handleUserAction=function(){return b.isEndpointActive&&b.isEndpointActive.set(!0),!0}}})),define("ui/controls/experience/sidebar",["require","exports","module","vendor/knockout","browser/dom","text!views/experience/sidebar.html","ui/controls/experience/shareDialogController","ui/viewModels/experience/sidebar","utils/common/styleModeHelper","swx-constants","lodash-compat","swx-service-locator-instance"],(function(e,t){var n=e("vendor/knockout"),i=e("browser/dom"),r=e("text!views/experience/sidebar.html"),o=e("ui/controls/experience/shareDialogController"),a=e("ui/viewModels/experience/sidebar"),s=e("utils/common/styleModeHelper"),c=e("swx-constants").COMMON,l=e("lodash-compat"),u=e("swx-service-locator-instance").default,d="inactive"
	t.name="sidebar",t.render=function(e,t){var p=i.createElement("div"),f=u.resolve(c.serviceLocator.FEATURE_FLAGS)
	p.className="side themeWhite",i.addClass(p,function(e){return c.sidebar.cssClasses[function(e){return e&&l.has(e,"sidebarPosition")&&l.isString(e.sidebarPosition)&&e.sidebarPosition.toLowerCase()===c.sidebar.position.LEFT}(e)?"SLIDE_LEFT_TO_RIGHT":"SLIDE_RIGHT_TO_LEFT"]}(e)),p.innerHTML=r,f.isFeatureOn(c.featureFlags.HIDE_SIDEBAR_ON_START)&&function(e){function t(){e.parentElement.style.display="none"}u.resolve(c.serviceLocator.PUBSUB).subscribe(c.apiUIEvents.SWX_TIMELINE_LOADED,t)}(p),n.applyBindings(function(e){var t
	return e.setAttribute("data-bind",function(){var e=","
	return[t(),n(),i()].join(e)
	function t(){return"event:{"+["mouseover: expand","mouseout: collapse"].join(e)+"}"}function n(){return"css:{"+["active: isExpanded()","inactive: !isExpanded()","showTooltips: showTooltips()","slideIn: addSlideInClass()","slideOut: addSlideOutClass()"].join(e)+"}"}function i(){return['transitionEnd: {callback: slideTransitionEnded, moreElementsToWatch: ["aside.sideContainer"]}'].join(e)}}()),i.addClass(e,d),t=new a(e),t.init(),t}(p),p),t(p),o.conditionallyLaunchSharingExperience(),s.get().addContainer(p)}})),define("text!views/experience/content.html",[],(function(){return'<swx-notification-box></swx-notification-box>\r\n<swx-navigation></swx-navigation>\r\n\r\n\x3c!-- content overlay used for masking chat area when sidebar is expanded --\x3e\r\n<span class="swxContentOverlay" data-bind="css: { active: showOverlay }, click: hideOverlay"></span>\r\n\r\n\x3c!-- named templates for various message types contents --\x3e\r\n<script type="text/html" id="pictureMessageContentTemplate">\r\n    <p class="PictureSharing">\r\n        <a class="thumbnailHolder"\r\n           data-bind="click: open, attr: {href: pictureUrl}, l10n_attr: {\'aria-label\': \'media_picturesharing_label\', \'title\': \'media_picturesharing_label\'}"\r\n           target="_blank" tabindex="-1">\r\n\r\n            <span class="pictureIcon">\r\n                <span class="iconfont picture"></span>\r\n            </span>\r\n\r\n            \x3c!-- ko if: hasFailed --\x3e\r\n            <span class="failedIcon">\r\n                <span class="iconfont errorSad"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: isPending --\x3e\r\n            <span class="progressIndicatorContainer">\r\n                <span class="progressIndicator" data-bind="style: {backgroundImage: progressIndicatorBG}"></span>\r\n                <span class="fill"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: thumbnailUrl --\x3e\r\n            <span class="thumbnail" data-bind="style: { backgroundImage: \'url(\\\'\' + thumbnailUrl() + \'\\\')\' }"></span>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko ifnot: thumbnailUrl --\x3e\r\n            <span class="thumbnail" style="display:none"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </a>\r\n        <span class="offScreen" data-bind="text: content"></span>\r\n    </p>\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="contactInfoMessageContentTemplate">\r\n    <span class="offScreen" data-bind="text: content"></span>\r\n    <div class ="contactsList" data-bind="foreach: contacts">\r\n        <div class="contact clickable">\r\n            \x3c!--ko ifnot: ($parent.isMePersonContactMessage(name()) || $parent.isPSTNContactMessage(name())) --\x3e\r\n            <a class="avatarLink" data-bind="click: $parent.openConversationWithUser.bind(this, name()), attr: {title: titleKey}" role="button">\r\n                <swx-avatar params="avatar: avatar, isFullSize: true, displayName: fullName"></swx-avatar>\r\n            </a>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!--ko if: ($parent.isMePersonContactMessage(name()) && !$parent.isPSTNContactMessage(name())) --\x3e\r\n            <swx-avatar params="avatar: avatar, isFullSize: true, displayName: fullName"></swx-avatar>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!--ko if: (!$parent.isMePersonContactMessage(name()) && $parent.isPSTNContactMessage(name())) --\x3e\r\n            <span class="iconfont callStart pstn"></span>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="info">\r\n                \x3c!--ko if: $parent.contactHasFullName(name()) --\x3e\r\n                <div class="fullName" data-bind="css: {pstn: $parent.isPSTNContactMessage(name())}">\r\n                    <span class="strong fontSize-p" data-bind="text: fullName"></span>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!--ko ifnot: $parent.isPSTNContactMessage(name()) --\x3e\r\n                <div class="name">\r\n                    <span class="fontSize-p" data-bind="text: name"></span>\r\n                </div>\r\n                \x3c!--ko ifnot: $parent.isMePersonContactMessage(name()) --\x3e\r\n                <div class="action">\r\n                    <a role="button" class="actionLink clickable" data-bind="click: $parent.openConversationWithUser.bind(this, name()), l10n: {key: actionKey}" tabindex="-2">\r\n                    </a>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="fileTransferMessageContentTemplate">\r\n    <p data-bind="css:typeClasses" data-bind="css:{aborted:isAborted}" class="FileTransfer">\r\n        <span class="icon iconfont file" data-bind="css:iconClasses"></span>\r\n\r\n        <span class="filename" data-bind="text:fileName"></span>\r\n\r\n        \x3c!-- ko if: isAborted --\x3e\r\n        <span class="aborted iconfont cancel" data-bind="l10n_attr: {\'title\': \'file_transfer_upload_canceled\' }"></span>\r\n        <span class="errorMessage" data-bind="l10n: {\'key\': \'file_transfer_upload_canceled\' }, l10n_attr: {\'title\':\'file_transfer_upload_canceled\'}, l10n_attr:{\'aria-label\':\'file_transfer_upload_canceled\'}"></span>\r\n        <span class="filesize" data-bind="text:fileSize"></span>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko ifnot: isAborted --\x3e\r\n        <span class="filesize" data-bind="text:fileSize"></span>\r\n        <swx-filetransfer-activity-actions params="message:$data, onabort:abortUploading"></swx-filetransfer-activity-actions>\r\n        \x3c!-- /ko --\x3e\r\n    </p>\r\n\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="videoMessageContentTemplate">\r\n    <div class="video-message">\r\n\r\n        <div class="media-holder" data-bind="css: orientationClass">\r\n            <div class="media-content">\r\n\r\n                <div class="videoIcon">\r\n                    <span class="iconfont videomail"></span>\r\n                </div>\r\n\r\n                \x3c!-- ko if: hasFailed --\x3e\r\n                <span class="failedIcon">\r\n                    <span class="iconfont errorSad"></span>\r\n                </span>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: isLoaded() & !isPlaying() --\x3e\r\n                <div class="thumbnail" data-bind="click: play, style: { backgroundImage: \'url(\\\'\' + thumbnailUrl + \'\\\')\' }"></div>\r\n                <a href="#" class="iconfont play playButton" data-bind="click: play, l10n_attr: { \'aria-label\': \'media_clicktoplay\' }" role="button" tabindex="-1"></a>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: isPlaying --\x3e\r\n                <swx-video-player params="media: mediaUrl, thumbnail: thumbnailUrl, autoplay: true, displayCurrentTime: true, displayTotalTime: true, messageId: $parent.clientmessageid, conversationId: $parent.conversationId"></swx-video-player>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: hasExpired --\x3e\r\n        <p class="errorMessage" data-bind="l10n: { key: \'media_videomessage_expired\' }"></p>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="audioMessageContentTemplate">\r\n    <div class="audio-message">\r\n        \x3c!-- ko ifnot: hasExpired --\x3e\r\n        <div class="media-holder">\r\n            <div class="media-content">\r\n\r\n                <div class="audioIcon">\r\n                    <span class="iconfont audiomail"></span>\r\n                </div>\r\n\r\n                \x3c!-- ko if: hasFailed --\x3e\r\n                <span class="failedIcon">\r\n                    <span class="iconfont errorSad"></span>\r\n                </span>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: isLoaded() & !isPlaying() --\x3e\r\n                <a href="#" class="iconfont play playButton" data-bind="click: play, l10n_attr: { \'aria-label\': \'media_clicktoplay\' }" role="button" tabindex="-1"></a>\r\n                <span class="voiceMessage" data-bind="l10n: { key: \'media_voice_message\' }"></span>\r\n\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: isPlaying --\x3e\r\n                <swx-audio-player params="media: mediaUrl, autoplay: true, messageId: $parent.messageId, conversationId: $parent.conversationId"></swx-audio-player>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: hasExpired --\x3e\r\n        <p data-bind="l10n: { key: \'media_audiomessage_expired\' }"></p>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="mojiMessageContentTemplate">\r\n    <p data-bind="css: typeClasses">\r\n        <span class="mojiContent">\r\n            <span class="mojiplaceholder"></span>\r\n            <img class="mojithumbnail" data-bind="attr: { src: mojiThumbnailUrl}" alt="" role="presentation"\r\n                 aria-hidden="true"/>\r\n            <video class="moji" data-bind="css: {hide: !isMojiPlaying()}, attr: { src: mojiUrl }"></video>\r\n            <span class="mojimask" data-bind="click: stopMojiPlay"></span>\r\n            <a href="#" class="actionButtons iconfont play mojiplay clickable"\r\n               data-bind="css: {hide: isMojiPlaying}, click: playMoji,\r\n                          l10n_attr: { \'aria-label\': \'pes_moji_playbutton_label\' }"\r\n               role="button" tabindex="-1"></a>\r\n        </span>\r\n        <span class="mojitext" data-bind="visible: isMojiPlayed()">\r\n            <span class="mojiTitle" data-bind="css: {hide: !mojiTitle() && mojiTitle() === \'\'}, text: mojiTitle"></span>\r\n            <span class="mojiLink">\r\n                <a data-bind="css: {hide: !mojiLinkName() && mojiLinkName() === \'\'}, text: mojiLinkName,\r\n                              attr: {href: mojiLinkUrl}"\r\n                   target="_blank" tabindex="-1"></a>\r\n            </span>\r\n            <span class="mojiCopyright"\r\n                  data-bind="css: {hide: !mojiCopyright() || mojiCopyright() === \'\'}, text: mojiCopyright"></span>\r\n        </span>\r\n        <span class="moji-error-state ">\r\n            <span class="icon iconfont flikDeletedStroke"></span>\r\n            <span class="text" data-bind="text: mojiErrorText"></span>\r\n        </span>\r\n    </p>\r\n\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="textMessageContentTemplate">\r\n    \x3c!-- ko if: isCopySelectionAsQuoteEnabled --\x3e\r\n    <p data-bind="html: content, css: typeClasses, visible: !translationItem.visible(), click: $parent.messageClicked.bind(this), event: {copy: onCopy}"></p>\r\n    \x3c!-- /ko --\x3e\r\n\r\n     \x3c!-- ko if: !isCopySelectionAsQuoteEnabled --\x3e\r\n    <p data-bind="html: content, css: typeClasses, visible: !translationItem.visible(), click: $parent.messageClicked.bind(this)"></p>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: translationItem.isEnabled --\x3e\r\n    <p data-bind="html: translationItem.translationText, visible: translationItem.visible()"></p>\r\n    <p><a href="#" role="button" data-bind="text: translationItem.toggleText, attr: {title: translationItem.toggleText, \'aria-label\': translationItem.toggleText}, click: translationItem.toggle"></a></p>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: reactionsVM.enabled && reactionsVM.reactionsCount() > 0 --\x3e\r\n    <div class="reactionsBar">\r\n        <span data-bind="foreach: {data: reactionsVM.reactions(), as: \'reaction\'}">\r\n            \x3c!-- ko if: reaction.key !== $parent.reactionsVM.dummyReaction --\x3e\r\n            <span class="reactionItem">\r\n                <span class="emoticon" data-bind="\r\n                    attr: {\r\n                        title: $parent.reactionsVM.getUserListNames(reaction.key)\r\n                    },\r\n                    style: {\r\n                        \'background-image\' : $parent.reactionsVM.getEmoticonUrl(reaction.key)\r\n                    },\r\n                    css: {highDpi: $parent.reactionsVM.showHighDpiClass}">\r\n                </span>\r\n                <span class="counter smaller" data-bind="text: reaction.users.length"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="callingMessageContentTemplate">\r\n    <p data-bind="html: content, css: typeClasses"></p>\r\n    <p class="liveSessionDuration small" data-bind="html: liveSessionDuration"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="ngcUpgradeMessageContentTemplate">\r\n    <p data-bind="html: content, css: typeClasses"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="pluginFreeMessageContentTemplate">\r\n    <p data-bind="html: content, css: typeClasses"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="pstnMessageContentTemplate">\r\n    <p data-bind="css: typeClasses"><span data-bind="html: content, click: addCreditTelemetry"></span><a data-bind="click: navigateToDialPad, visible: linkVisible" class="clickable"> <span data-bind="html: linkContent"></span></a></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="contactRequestIncomingMessageContentTemplate">\r\n    <p data-bind="css: typeClasses">\r\n        <swx-avatar params="avatar: author.avatar, isAgent: author.isAgent, displayName: author.displayName, isPstn: author.isPstn, size: 65"></swx-avatar>\r\n    </p>\r\n    <div class="contactRequestMessage contactRequestIncomingMessage">\r\n        <p data-bind="l10n: { key: \'message_text_contactRequestIncomingMessage\', params: { displayName: author.displayName } }"></p>\r\n\r\n        <p data-bind="html: greeting"></p>\r\n\r\n        <p data-bind="html: setTimestamp" class="timestamp"></p>\r\n    </div>\r\n    <div class="triple buttonRow">\r\n        <div class="column">\r\n            <button type="button" class="btn primary clickable contactRequestAccept"\r\n                    data-bind="click: acceptContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: 1, callback: focusHandlerCallback }" tabindex="-1"><span\r\n                data-bind="l10n: { key: \'message_text_contactRequestAcceptAction\' }"></span></button>\r\n        </div>\r\n        <div class="column">\r\n            <button type="button" class="btn secondary clickable contactRequestDecline"\r\n                    data-bind="click: declineContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }" tabindex="-1"><span\r\n                data-bind="l10n: { key: \'message_text_contactRequestDeclineAction\' }"></span></button>\r\n        </div>\r\n        <div class="column">\r\n            <button type="button" class="btn secondary clickable contactRequestBlock"\r\n                    data-bind="click: blockContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }" tabindex="-1"><span\r\n                data-bind="l10n: { key: \'action_button_block\' }"></span></button>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="contactRequestIncomingInviteFreeMessageContentTemplate">\r\n    <p class="contactRequestResendMessage" data-bind="css: typeClasses"><span\r\n        data-bind="html: content"></span>\r\n        <a data-bind="l10n: { key: \'invite_free_block_person\' }, click: blockContactRequest"\r\n           class="clickable" tabindex="-1"></a></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="contactRequestOutgoingMessageContentTemplate">\r\n    \x3c!-- ko if: !isBusinessContactMgmtEnabled --\x3e\r\n    <p data-bind="css: typeClasses">\r\n        <swx-avatar params="avatar: author.avatar, isAgent: author.isAgent, displayName: author.displayName, isPstn: author.isPstn, size: 65"></swx-avatar>\r\n    </p>\r\n    <div class="contactRequestMessage contactRequestOutgoingMessage">\r\n        <p data-bind="l10n: { key: \'message_text_contactRequestOutgoingMessage\', params: { displayName: author.displayName } }"></p>\r\n    </div>\r\n    <div class="buttonRow">\r\n        <button type="button" class="btn primary clickable contactRequestSend" data-swx-testId="sendContactRequest"\r\n                data-bind="click: sendContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: focusImportance, callback: focusHandlerCallback }" tabindex="-1"><span\r\n            data-bind="l10n: { key: \'message_text_contactRequestSendAction\' }"></span></button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: isBusinessContactMgmtEnabled --\x3e\r\n    <div class="contactRequestMessage contactRequestOutgoingMessage">\r\n        <p data-bind="l10n: { key: \'message_text_contactRequestOutgoingMessage\', params: { displayName: author.displayName } }"></p>\r\n    </div>\r\n    <div class="contactRequestMessage">\r\n        <div class="ContactProfile--action-item fontSize-p">\r\n            <span>\r\n                <a href="#" role="button" data-bind="click: sendContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: focusImportance, callback: focusHandlerCallback }, l10n: {key: \'contact_information_add_to_contacts\'}" tabindex="-1"></a>\r\n            </span>\r\n        </div>\r\n    </div>\r\n   \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="contactRequestOutgoingResendMessageContentTemplate">\r\n    <p class="contactRequestResendMessage" data-bind="css: typeClasses"><span\r\n        data-bind="l10n: { key: \'message_text_contactRequestOutgoingResendMessage\' }, css: { \'in-progress\': actionInProgress }"></span> - <a\r\n        data-bind="l10n: { key: \'message_text_contactRequestOutgoingResendAction\' }, click: sendContactRequest, css: { \'in-progress\': actionInProgress }"\r\n        class="clickable"></a></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="contactRequestOutgoingAgentMessageContentTemplate">\r\n    <p data-bind="css: typeClasses">\r\n        <swx-avatar params="avatar: author.avatar, isAgent: author.isAgent, isPstn: author.isPstn, size: 65"></swx-avatar>\r\n    </p>\r\n    <div class="contactRequestMessage contactRequestOutgoingMessage">\r\n        <p data-bind="l10n: { key: \'message_text_contactRequestOutgoingMessage\', params: { displayName: author.displayName } }"></p>\r\n    </div>\r\n    <div class="buttonRow">\r\n        <button type="button" class="btn primary clickable contactRequestSend" data-swx-testId="sendContactRequest"\r\n                data-bind="click: sendContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: focusImportance, callback: focusHandlerCallback }" tabindex="-1"><span\r\n            class="contactRequestBtnText" data-bind="l10n: { key: \'message_text_contactRequestSendAction\' }"></span></button>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="suggestedContactMessageContentTemplate">\r\n    <p data-bind="css: typeClasses">\r\n        <swx-avatar params="avatar: author.avatar, isAgent: author.isAgent, displayName: author.displayName, size: 65"></swx-avatar>\r\n    </p>\r\n    <div class="contactRequestMessage suggestedContactMessage">\r\n        <p data-bind="l10n: { key: \'message_text_suggestedContactGreeting\', params: { displayName: author.displayName } }"></p>\r\n    </div>\r\n    <div class="buttonRow">\r\n        <button type="button" class="btn primary clickable contactRequestSend" data-bind="click: sendContactRequest, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: 1, callback: focusHandlerCallback }" tabindex="-1"\r\n               ><span data-bind="l10n: { key: \'message_text_suggestedContactConnectAction\' }"></span>\r\n        </button>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="unblockContactMessageContentTemplate">\r\n    <div data-bind="css: typeClasses">\r\n        <div class="contactRequestMessage unblockContactMessage">\r\n            <p data-bind="l10n: { key: \'message_text_contactBlockedMessage\', params: { displayName: author.displayName } }"></p>\r\n        </div>\r\n        <div class="buttonRow">\r\n            <div class="column alignLeft">\r\n                <button type="button" class="btn primary clickable unblockContact"\r\n                        data-bind="click: unblockContact, disable: actionInProgress, css: { \'in-progress\': actionInProgress }, focusHandler: { priority: 1, callback: focusHandlerCallback }" tabindex="-1"\r\n                       ><span data-bind="l10n: { key: \'message_text_unblockContact\' }"></span></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="spacesWelcomeMessageContentTemplate">\r\n    <div class="welcomeMessage">\r\n        <span class="emoticon hi large animated"><span class="emoSprite">(hi)</span><canvas data-item-id="hi" data-is-animated="true"></canvas></span>\r\n\r\n        <div data-bind="css: {clickable: spaceLink() || showSpacesCTA()}">\r\n            <div data-bind="l10n: { key: \'spaces_welcomeTitle\' }" class="title fontSize-h2"></div>\r\n            <div data-bind="text: welcomeMessage" class="fontSize-p"></div>\r\n        </div>\r\n        \x3c!-- ko if: isJoiningEnabled --\x3e\r\n        <swx-invite-link class="invite-link"\r\n                         params="topic: conversation.topic, uri: conversation.uri, isMessageContent: true">\r\n        </swx-invite-link>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- ko if: showSpacesCTA --\x3e\r\n    <div class="ctas">\r\n        <div class="cta clickable" data-bind="click: editTopicAction, enterKey: editTopicAction" tabindex="-1">\r\n            <div data-bind="l10n: { key: \'spaces_welcomeRenameBtnTitle\' }"\r\n                 class="title fontSize-h3 iconfont edit"></div>\r\n            <div data-bind="l10n: { key: \'spaces_welcomeRenameBtnMessage\' }" class="description fontSize-p"></div>\r\n        </div>\r\n        <div class="cta clickable" data-bind="click: settingsAction, enterKey: settingsAction" tabindex="-1">\r\n            <div data-bind="l10n: { key: \'spaces_welcomeSettingsBtnTitle\' }"\r\n                 class="title fontSize-h3 iconfont settings"></div>\r\n            <div data-bind="l10n: { key: \'spaces_welcomeSettingsBtnMessage\' }" class="description fontSize-p"></div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: othersAddedMessageContent --\x3e\r\n    <div class="participantMessage clickable">\r\n        <p data-bind="html: othersAddedMessageContent, css: typeClasses"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: agentsMessageContent --\x3e\r\n    <div class="participantMessage">\r\n        <p data-bind="html: agentsMessageContent, css: typeClasses"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="urlMessageContentTemplate">\r\n    \x3c!--ko if: !copyLinkEnabled() --\x3e\r\n    <div  class="messageTextWrapper">\r\n        <p data-bind="html: content, visible: !translationItem.visible(), click: $parent.messageClicked.bind(this)" class="urlPreviewText"></p>\r\n        \x3c!-- ko if: translationItem.isEnabled --\x3e\r\n        <p data-bind="html: translationItem.translationText, visible: translationItem.visible()" class="urlPreviewText"></p>\r\n        <p><a href="#" role="button" data-bind="text: translationItem.toggleText, attr: {title: translationItem.toggleText, \'aria-label\': translationItem.toggleText}, click: translationItem.toggle"></a></p>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showGiphyMetadata --\x3e\r\n    <span class="giphyMetadata fontSize-p" data-bind="text: giphyMetadata"></span>\r\n    \x3c!-- /ko --\x3e\r\n    <div data-bind="foreach: previews">\r\n        \x3c!--ko if: !ytPlayer() --\x3e\r\n        <div data-bind="css: typeClasses" class="urlPreview">\r\n            <a class="thumbnail"\r\n               data-bind="attr: { href: url, title: url, target: target, rel: rel}, event: {click: $parent.openUrlPreview.bind(this, url())}, css: {noScale: originalSize(), scaledByW: scaledByW(), scaledByH: scaledByH(), gif: isGif()}" tabindex="-1">\r\n                \x3c!-- ko if: typeClasses.youtube --\x3e\r\n                <span class="iconfont play"></span>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                <img class="scaled" alt="" aria-hidden="true" role="presentation"\r\n                     data-bind="css: {scaledW: scaledByW(), scaledH: scaledByH(), originalSize: originalSize(), originalGif: isGif(), tall: tall, wide: wide}, attr: {src: thumbnail}"/>\r\n                <span class="mask"></span>\r\n                <div class="info" data-bind="css: {gif: isGif()}">\r\n                    <span class="title strong fontSize-p" data-bind="text: title"></span>\r\n                    <span class="description fontSize-p" data-bind="text: description"></span>\r\n                    <div class="domainName site fontSize-p">\r\n                        <img class="favicon" alt="" role="presentation" aria-hidden="true"\r\n                                                                              data-bind="attr: {src: favicon}, css: { hide: !favicon() }"/>\r\n                        <span data-bind="text: site"></span>\r\n                    </div>\r\n                </div>\r\n            </a>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!--ko if: ytPlayer() --\x3e\r\n        <div class="message-youtube-embed">\r\n            <iframe data-bind="attr: {\'id\': playerId, \'src\': youtubeUri }"\r\n                    type="text/html" allowfullscreen frameborder="0"\r\n                    class="chat-youtube-iframe" tabindex="-2"></iframe>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="pollMessageContentTemplate">\r\n    <div data-bind="css: { \'poll-message\': true, \'poll-message--disabled\': answerSent }">\r\n        <p class="poll-message-heading" data-bind="html: content"></p>\r\n\r\n        <fieldset class="poll-message-content" data-bind="template: { name: \'pollMessageAnswerTemplate\', foreach: pollAnswers, as: \'answer\' }"></fieldset>\r\n\r\n        <div data-bind="text: peopleVotedText" class="fontSize-p"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="pollMessageAnswerTemplate">\r\n    <label class="poll-message-answer">\r\n        <input type="radio" data-bind="value: $index, checked: $parent.checkedAnswer, disable: $parent.answerSent, click: $parent.onAnswerClick" tabindex="-1" />\r\n        <div class="poll-message-answer-box">\r\n            <div class="poll-message-answer-votes-bar" data-bind="style: { width: (answer.barWidth + \'%\') }"></div>\r\n            <span class="poll-message-answer-text" data-bind="html: answer.answerText"></span>\r\n            <span class="poll-message-answer-votes-count" data-bind="text: answer.users.length || \'\'"></span>\r\n        </div>\r\n    </label>\r\n    <div class="poll-message-answer-votes">\r\n        <div class="poll-message-answer-avatars" data-bind="foreach: answer.users">\r\n            \x3c!-- ko if: ($index() < 2) --\x3e\r\n                \x3c!-- ko if: person --\x3e\r\n                    <swx-avatar-deprecated params="avatar: person.avatarUrl(), isGroupAvatar: false, displayName: displayName" data-bind="attr: {title: displayName}"></swx-avatar-deprecated>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko ifnot: person --\x3e\r\n                    <swx-avatar-deprecated params="isGroupAvatar: false, displayName: displayName" data-bind="attr: {title: displayName}"></swx-avatar-deprecated>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: (answer.users.length > 2) --\x3e\r\n            <div class="poll-message-answer-ellipsis" data-bind="click: $parent.pollAvatarsVM.onEllipsisClick.bind($data, $index())"></div>\r\n            <swx-user-list-popup params="\r\n                eventContext: $parent,\r\n                isSelfPopup: $parent.pollAvatarsVM.isSelfPopup.bind(null, $index()),\r\n                title: $parent.pollAvatarsVM.votedByCount(answer.users.length),\r\n                users: $parent.pollAvatarsVM.users"></swx-user-list-popup>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardMessageContentTemplate">\r\n    <div class="swift">\r\n        \x3c!-- ko if: !swift.isSupported() && swift.isValid()--\x3e\r\n            \x3c!-- ko template: { name: \'swiftUnsupported\', data: swift } --\x3e\x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: swift.isSupported() --\x3e\r\n            \x3c!-- ko if: swift.isCarousel --\x3e\r\n                \x3c!-- ko template: { name: \'swiftCarouselCard\', data: swift } --\x3e\x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !swift.isCarousel --\x3e\r\n                \x3c!-- ko template: { name: \'swiftSingleCard\', data: swift.cards[0] } --\x3e\x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftUnsupported">\r\n    <div class="card unsupported">\r\n        <span class="main emoticon hi animated">\r\n            <span class="emoSprite">(hi)</span>\r\n            <canvas data-item-id="hi" data-is-animated="true"></canvas>\r\n        </span>\r\n        <div class="text">\r\n            <div data-bind="l10n: { key: \'message_text_swift_unsupported\' }"></div>\r\n        </div>\r\n        <div class="buttons">\r\n            <div class="button" data-bind="attr: { tabindex: button.isValid() ? 0 : null, role: button.isValid() ? \'button\' : null, title: button.tooltip },\r\n                                        enterKey: button.isValid() ? button.action : null,\r\n                                        click: button.isValid() ? button.action : null, clickBubble: false">\r\n                <span class="normal" data-bind="text: button.title"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSingleCard">\r\n    <div class="card" data-bind="template: { name: contentType === \'Hero\' || contentType === \'Thumb\' ? \'swiftCard\' : \'swiftCard\' + contentType, data: content },\r\n                                 css: contentType.toLowerCase()"></div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCarouselCard">\r\n    <div class="carousel" data-bind="css: { first: isFirst, last: isLast, multiple: isMultiple }">\r\n        <div class="container" data-bind="css: { multiLine: areButtonsMultiLine },\r\n                                          foreach: {\r\n                                              data: cards,\r\n                                              as: \'card\',\r\n                                              afterRender: function(e, card) { e[1].addEventListener(\'focus\', function() { moveToCard(card); }, true); }\r\n                                          },\r\n                                          style: { left: carouselLeftPosition(), right: carouselRightPosition() }">\r\n            <div class="card" data-bind="template: { name: card.contentType === \'Hero\' || card.contentType === \'Thumb\' ? \'swiftCard\' : \'swiftCard\' + card.contentType, data: card.content },\r\n                                        css: card.contentType.toLowerCase()"></div>\r\n        </div>\r\n        <div class="prev" data-bind="click: prevCard, enterKey: prevCard, l10n_attr: { title: \'message_text_swift_prevCard\' }">\r\n            <div class="button iconfont" role="button" tabindex="0"></div>\r\n        </div>\r\n        <div class="next" data-bind="click: nextCard, enterKey: nextCard, l10n_attr: { title: \'message_text_swift_nextCard\' }">\r\n            <div class="button iconfont" role="button" tabindex="0"></div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCard">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (tap && tap.isValid()) ? -1 : null, role: (tap && tap.isValid()) ? \'presentation\' : null, title: (tap && tap.isValid()) ? tap.tooltip : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: mainSection.isValid() --\x3e\r\n            \x3c!-- ko template: { name: \'swiftSection\', data: mainSection } --\x3e\x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: buttons, as: \'button\' }, css: { multiLine: areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardFlex">\r\n    <div class="cardContent" data-bind="attr: { tabindex: (tap && tap.isValid()) ? -1 : null, role: (tap && tap.isValid()) ? \'presentation\' : null, title: (tap && tap.isValid()) ? tap.tooltip : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        <div class="section">\r\n            \x3c!-- ko if: title || subtitle || text --\x3e\r\n            <div class="textContent">\r\n                \x3c!-- ko if: title --\x3e\r\n                <h1 data-bind="html: title, attr: { title: $element.textContent }"></h1>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: subtitle --\x3e\r\n                <h2 data-bind="html: subtitle, attr: { title: $element.textContent }"></h2>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: text --\x3e\r\n                <p class="normal" data-bind="html: text, attr: { title: $element.textContent }, css: expandedText() "></p>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: images.length > 0 --\x3e\r\n            \x3c!-- ko with: images[0] --\x3e\r\n            <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n                <img data-bind="attr: { src: url, alt: alt, width: uiSize().width, height: uiSize().height },\r\n                                    style: { left: leftAlignment(), bottom: bottomAlignment(), right: rightAlignment()}" />\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n\r\n        \x3c!-- ko if: buttons.length > 0 --\x3e\r\n        <div class="buttons" data-bind="foreach: { data: buttons, as: \'button\' }, css: { multiLine: areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardReceipt">\r\n    <div data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? tap.tooltip : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        \x3c!-- ko if: title --\x3e\r\n            <h1 data-bind="html: title"></h1>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: facts.length !== 0 --\x3e\r\n            <div class="facts" role="list" data-bind="foreach: { data: facts, as: \'fact\' }">\r\n                \x3c!-- ko template: { name: \'swiftFact\', data: fact } --\x3e\x3c!-- /ko --\x3e\r\n            </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: displayedItems().length !== 0 --\x3e\r\n            <div class="items" role="list" data-bind="foreach: { data: displayedItems, as: \'item\' }">\r\n                <div class="item" role="listitem">\r\n                    \x3c!-- ko template: { name: item.images.length !== 0 ? \'swiftSection\' : \'swiftItem\', data: item } --\x3e\x3c!-- /ko --\x3e\r\n                </div>\r\n            </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: showFoldButton --\x3e\r\n        <div class="button fold" data-bind="attr: { tabindex: -1, role: \'button\', title: foldButtonText() },\r\n                                   enterKey: triggerFoldAction,\r\n                                   click: triggerFoldAction, clickBubble: false">\r\n            <span class="normal" data-bind="text: foldButtonText()"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="summary">\r\n            \x3c!-- ko if: vat --\x3e\r\n                <div class="line">\r\n                    <span class="key normal" data-bind="l10n: { key: \'message_text_swift_vat\' }"></span>\r\n                    <span class="value normal" data-bind="text: vat"></span>\r\n                </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: tax --\x3e\r\n                <div class="line">\r\n                    <span class="key normal" data-bind="l10n: { key: \'message_text_swift_tax\' }"></span>\r\n                    <span class="value normal" data-bind="text: tax"></span>\r\n                </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="line">\r\n                <span class="key normal" data-bind="l10n: { key: \'message_text_swift_totalPrice\' }"></span>\r\n                <span class="value normal" data-bind="text: total"></span>\r\n            </div>\r\n        </div>\r\n        <div class="buttons" data-bind="foreach: { data: buttons, as: \'button\' }, css: { multiLine: areButtonsMultiLine}">\r\n            \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardSignIn">\r\n    <span class="main emoticon hi animated">\r\n        <span class="emoSprite">(hi)</span>\r\n        <canvas data-item-id="hi" data-is-animated="true"></canvas>\r\n    </span>\r\n    <div class="text" data-bind="html: text"></div>\r\n    <div class="buttons" data-bind="foreach: { data: buttons, as: \'button\' }">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftSection">\r\n    <div class="section" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'presentation\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                css: { tap: tap && tap.isValid() },\r\n                enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n        <div class="textContent">\r\n            \x3c!-- ko if: title --\x3e\r\n                <h1 data-bind="html: title, attr: { title: $element.textContent }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: price --\x3e\r\n                <span class="price normal" data-bind="html: price, attr: { title: $element.textContent }"></span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: subtitle --\x3e\r\n                <h2 data-bind="html: subtitle, attr: { title: $element.textContent }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: text --\x3e\r\n                <p class="normal" data-bind="html: text, attr: { title: $element.textContent }, css: expandedText() "></p>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- ko if: images.length > 0 --\x3e\r\n            \x3c!-- ko with: images[0] --\x3e\r\n                <div class="image" data-bind="attr: { tabindex: (tap && tap.isValid()) ? 0 : null, role: (tap && tap.isValid()) ? \'button\' : null, title: (tap && tap.isValid()) ? getTitleByType() : null },\r\n                                              css: { tap: tap && tap.isValid() },\r\n                                              enterKey: (tap && tap.isValid()) ? tap.action : null,\r\n                                              click: (tap && tap.isValid()) ? tap.action : null, clickBubble: false">\r\n                    <img data-bind="attr: { src: url, alt: alt, width: uiSize().width, height: uiSize().height },\r\n                                    style: { left: leftAlignment(), bottom: bottomAlignment(), right: rightAlignment()}" />\r\n                </div>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftButton">\r\n    <div class="button" data-bind="attr: { tabindex: isValid() ? -1 : null, role: isValid() ? \'button\' : null, title: tooltip },\r\n                                   enterKey: isValid() ? action : null,\r\n                                   click: isValid() ? action : null, clickBubble: false">\r\n        <span class="normal" data-bind="text: title"></span>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftFact">\r\n    <div class="fact" role="listitem">\r\n        <span class="key normal" data-bind="html: key"></span>\r\n        <span class="value normal" data-bind="html: value"></span>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftItem">\r\n    <span class="title" data-bind="html: title"></span>\r\n    <span class="price normal" data-bind="text: price"></span>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardVideo">\r\n    <div class="cardContent" data-bind="css: aspect">\r\n        <div class="videoCard">\r\n            <swx-video-player params="media: media.video, thumbnail: image.url, showLoadingInfo: true, autoplay: autostart, muted: true, autoloop: false, displayMuteButton: true, messageId: $parent.messageId, conversationId: $parent.conversationId, title: title, subtitle: subtitle"></swx-video-player>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardAudio">\r\n    <div class="cardContent">\r\n        <div class="audioCard">\r\n\r\n            \x3c!-- ko if: hasThumbnail() --\x3e\r\n            <img class="thumbnail" data-bind="attr: { src: image.url, alt: image.alt, width: image.uiSize().width, height: image.uiSize().height },\r\n                style: { left: image.leftAlignment(), bottom: image.bottomAlignment(), right: image.rightAlignment() }" />\r\n            \x3c!-- /ko --\x3e\r\n\r\n            <div class="audio-message" data-bind="css: {thumbnail: hasThumbnail()}">\r\n                <div class="media-holder">\r\n                    <div class="media-content">\r\n                        <div class="audioIcon">\r\n                            <span class="iconfont audiomail"></span>\r\n                        </div>\r\n                        <swx-audio-player params="media: media.audio, autoplay: autostart, showLoadingInfo: true, messageId: $parent.messageId, conversationId: $parent.conversationId"></swx-audio-player>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="swiftCardAnimation">\r\n    <div class="cardContent">\r\n        <div class="animationCard">\r\n            <swx-gif-player params="media: media.animation"></swx-gif-player>\r\n        </div>\r\n        <div data-bind="template: \'mediaCardSection\', data: $data"></div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="mediaCardSection">\r\n    \x3c!-- ko if: hasTextInfo() --\x3e\r\n    <div class="section">\r\n        <div class="textContent">\r\n            \x3c!-- ko if: title --\x3e\r\n            <h1 data-bind="text: title, attr: { title: title }"></h1>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: subtitle --\x3e\r\n            <h2 data-bind="text: subtitle, attr: { title: subtitle }"></h2>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: mediaSourceDomain --\x3e\r\n            <h3 data-bind="text: mediaSourceDomain, attr: { title: mediaSourceDomain }"></h3>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    <div class="buttons" data-bind="foreach: { data: buttons, as: \'button\' }, css: { multiLine: areButtonsMultiLine}">\r\n        \x3c!-- ko template: { name: \'swiftButton\', data: button } --\x3e\x3c!-- /ko --\x3e\r\n    </div>\r\n<\/script>\r\n'})),define("ui/telemetry/actions/actionSources",{contactRequestIncomingActivityItem:"ContactRequestIncomingActivityItem",unblockActivityItem:"UnblockActivityItem",recentItem:"recentItem",searchItem:{addressBook:"addressBookSearchItem",skypeDirectory:"skypeDirectorySearchItem"},callScreen:{participantMenu:"callScreenParticipantMenu"},contactsPage:{contact:"contactsPageContact"},discoverAgentsPage:{agent:"discoverAgentsPageAgent"},contextMenuItem:{block:"blockContactMenuItem",callSkype:"callSkypeMenuItem",deleteItem:"deleteContactMenuItem",removeMessage:"removeMessageMenuItem",startPSTNCall:"startPSTNCallMenuItem",unblock:"unblockContactMenuItem",addContactToFavorites:"addContactToFavoritesMenuItem",removeContactFromFavorites:"removeContactFromFavoritesMenuItem",videoCall:"videoCallMenuItem",quoteMessage:"quoteMessageMenuItem",copyMessage:"copyMessageMenuItem",copySelection:"copySelectionMenuItem",copySelectionText:"copySelectionTextMenuItem"},contactProfile:"contactProfile",search:{reset:{resetXButton:"resetXButton",content:"experienceContent",openConversation:"openConversation",escapeKey:"escapeKey",emptyQuery:"emptyQuery",queryChanged:"queryChanged",directoryActivated:"directoryActivated"}},conversation:{conversationItem:"conversationItem",messageItem:"messageItem",groupRoster:"groupRoster",header:{button:"conversationHeaderButton"}},invitesShareButtons:{header:"header",newConversation:"new_conversation_area",groupInformationPanel:"group_information_panel"},skypeOutPage:{skypeOutHeader:"skypeOutHeader"},me:{area:"me_area",avatar:"me_avatarFilePicker"},selectionCopyKeyboard:"selectionCopyKeyboard"}),define("ui/viewModels/experience/content",["require","vendor/knockout","swx-constants","swx-service-locator-instance","ui/telemetry/actions/actionSources","usertiming"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("ui/telemetry/actions/actionSources"),o=e("usertiming"),a=n.events,s=n.telemetry.performanceMarks
	return function(){var e=this,c=i.resolve(n.serviceLocator.PUBSUB)
	e.showOverlay=t.observable(!1),e.init=function(){c.subscribe(a.narrowMode.SIDEBAR_STATE_CHANGED,e.showOverlay),o.mark(s.EXPERIENCE.CONTENT_INIT)},e.dispose=function(){c.unsubscribe(a.narrowMode.SIDEBAR_STATE_CHANGED,e.showOverlay)},e.hideOverlay=function(){var t={source:r.search.reset.content}
	e.showOverlay(!1),c.publish(a.search.RESET,t)}}})),define("ui/controls/experience/content",["require","exports","module","vendor/knockout","text!views/experience/content.html","ui/viewModels/experience/content","utils/common/styleModeHelper","swx-browser-detect","swx-constants","swx-enums","swx-service-locator-instance","swx-cafe-application-instance"],(function(e,t){var n=e("vendor/knockout"),i=e("text!views/experience/content.html"),r=e("ui/viewModels/experience/content"),o=e("utils/common/styleModeHelper"),a=e("swx-browser-detect").default,s=e("swx-constants").COMMON,c=e("swx-enums"),l=e("swx-service-locator-instance").default,u=e("swx-cafe-application-instance"),d=0
	t.name="content",t.render=function(e,t){l.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.DARK_THEME_ENABLED)&&u.get()._flagsServiceProvider.build(c.skypeFlagsApiMappings.DARK_THEME).read().then((function(e){e&&!o.get().isIntegratedProperty()&&document.body.classList.add("dark")}))
	var p=document.createElement("div"),f=new r
	d++,p.id="swxContent"+d,p.className="swxContent",p.innerHTML=i,o.get().isIntegratedProperty()&&"SkypeShell"!==a.getBrowserInfo().browserName&&(p.className+=" "+o.get().host()),f.init(),n.applyBindings(f,p),t(p),o.get().addContainer(p)}})),define("ui/contextMenu/menuItemGroup",[],(function(){return function(e,t){this.type=e,this.items=t}})),define("utils/common/eventHelper",["require","exports","module","swx-constants"],(function(e,t){var n=e("swx-constants").KEYS,i={96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"}
	function r(){}function o(e){return e.which||e.keyCode}function a(e){var t=o(e)
	return t>=n.NUMPAD_0&&t<=n.NUMPAD_9}r.prototype.emit=function(){},r.prototype.done=function(){},t.swallow=function(e){e.preventDefault()},t.getKeyCode=o,t.getNumpadKey=function(e){return!!a(e)&&i[o(e)]},t.isActivation=function(e){var t=o(e)
	return t===n.ENTER||t===n.SPACE},t.isAlphaNumericKey=function(e){var t=o(e)
	return t>=n.NUMBER_0&&t<=n.NUMBER_9||t>=n.A&&t<=n.Z},t.isNumPadKey=a,t.emptyEmitter=new r,t.isDeactivation=function(e){return o(e)===n.ESCAPE}})),define("ui/contextMenu/contextMenu",["require","exports","module","vendor/knockout","lodash-compat","constants/cssClasses","swx-constants","swx-service-locator-instance","browser/window","browser/dom","utils/common/accessibility","swx-focus-handler","swx-utils-common","ui/telemetry/actions/actionNames","browser/document","ui/contextMenu/menuItemGroup","swx-constants","utils/common/eventHelper","swx-enums"],(function(e,t){var n,i,r,o=e("vendor/knockout"),a=e("lodash-compat"),s=e("constants/cssClasses"),c=e("swx-constants").COMMON,l=e("swx-service-locator-instance").default,u=e("browser/window"),d=e("browser/dom"),p=e("utils/common/accessibility"),f=e("swx-focus-handler"),m=e("swx-utils-common").async,h=e("ui/telemetry/actions/actionNames"),v=e("browser/document"),g=e("ui/contextMenu/menuItemGroup"),y=e("swx-constants").KEYS,b=e("utils/common/eventHelper"),_=e("swx-enums"),E={itemActions:[],onMouseMove:function(e,t){t.currentTarget&&f.get().addFocusRequestToQueue(t.currentTarget,f.Priorities.Immediate)}},w=null,S=null,x=0
	function C(e){return!!d.getParentWithClass(e,s.contextMenu.CONTEXT_MENU)}function T(e){var t,n
	for(t=0;t<e.length;t++)if(M(n=e[t])&&T(n.items)||!M(n)&&n.isEnabled())return!0
	return!1}function I(e){return 0===e}function A(e,t){return t<e.length-1}function M(e){return e instanceof g}function O(e,t){return!I(t)&&M(e[t-1])}function k(e){return M(e)&&T(e.items)}function N(e){e.forEach((function(e){e.isEnabled()&&P(e)}))}function P(e){var n=d.createElement("li"),i=d.createElement("span")
	d.addClass(n,s.LIST_SELECTABLE),e.cssClass&&d.addClass(n,e.cssClass),i.textContent=e.label,n.appendChild(i),n.addEventListener(c.events.browser.CLICK,e.action,!0),E.itemActions.push((function(){e.action(),t.hide()})),n.setAttribute("data-bind","event:{mousemove: onMouseMove}, enterKey: itemActions["+(E.itemActions.length-1)+"]"),n.setAttribute("role","option"),w.appendChild(n)}function R(){var e=d.createElement("li")
	d.addClass(e,"separator"),w.appendChild(e)}function L(e){b.getKeyCode(e)===y.ESCAPE&&t.hide(e)}function D(e){e.preventDefault(),e.stopPropagation()}t.MENU_BORDER_WIDTH=1,t.ARROW_WIDTH=40,t.ARROW_HEIGHT=11,t.isVisible=o.observable(!1),t.show=function(e,a,f,g){var y=l.resolve(c.serviceLocator.ACTION_TELEMETRY)
	if(t.hide(null,g),r=v.activeElement,i=e,f=f||{},T(e)){if(g)l.resolve(c.serviceLocator.PUBSUB).publish(c.events.contextMenu.MENU_SHOWN)
	x=Date.now(),S=a.target,function(e){(w=d.createElement("ul")).classList.add(s.contextMenu.CONTEXT_MENU),w.setAttribute("role","listbox"),w.setAttribute("aria-expanded","true"),(n=d.createElement("div")).className="arrow",n.setAttribute("aria-hidden","true"),w.appendChild(n),function(e){var t,n
	for(t=0;t<e.length;t++)n=e[t],I(t)||!k(n)||O(e,t)||R(),M(n)?N(n.items):n.isEnabled()&&P(n),k(n)&&A(e,t)&&R()}(e),p.initFocusRing(w),w.setAttribute("data-bind",'focusHandler: { priority: 1 }, keyboardNavigation: { itemSelector: ".'+s.LIST_SELECTABLE+'" }'),o.applyBindings(E,w),v.body.appendChild(w)}(e),function(e){void 0===e.clientX&&(e.clientX=0)
	void 0===e.clientY&&(e.clientY=0)
	var i=function(e){var t=e.customClientOptions||{}
	if(!t.offsetElement)return{left:e.clientX,top:e.clientY,bottom:e.clientY}
	var n=t.offsetElement,i=d.getElementOffset(n),r=n.offsetWidth/2
	return{left:i.offsetLeft+r,top:i.offsetTop,bottom:i.offsetTop+n.offsetHeight}}(e),r=e.customClientOptions||{};(function(e){var i,r=e.left,o=w.offsetWidth/2,a=r+o
	i=window.innerWidth-a>0?r-o>t.MENU_BORDER_WIDTH?r-o:t.MENU_BORDER_WIDTH:window.innerWidth-w.offsetWidth-t.MENU_BORDER_WIDTH
	w.style.left=i+"px",function(e,i){var r=e.left,o=r-i,a=o-t.ARROW_WIDTH/2,s=t.MENU_BORDER_WIDTH,c=w.offsetWidth-t.MENU_BORDER_WIDTH-t.ARROW_WIDTH
	a=Math.max(s,Math.min(a,c)),n.style.left=a+"px"}(e,i)})(i),function(e,n){var i,r=n.position||_.contextMenuPosition.Bottom,o=n.offset||0
	e.top<window.innerHeight/2&&r===_.contextMenuPosition.Bottom?i=e.bottom+t.ARROW_HEIGHT+o:(i=e.top-t.ARROW_HEIGHT-w.offsetHeight-o,d.addClass(w,s.contextMenu.FLIPPED))
	w.style.top=i+"px"}(i,r)}(a),function(){var e=l.resolve(c.serviceLocator.PUBSUB)
	m.execute((function(){v.addEventListener(c.events.browser.CLICK,t.hide),v.addEventListener(c.events.browser.KEYDOWN,L),u.addEventListener(c.events.browser.RESIZE,t.hide),e.subscribe(c.events.interaction.SCROLL_START,t.hide),w.addEventListener(c.events.browser.CONTEXTMENU,D)}))}(),t.isVisible(!0),y.recordAction(h.contextMenu.shown,f)}},t.hide=function(e,o){e&&3===e.which||function(){var t
	if(!w)return!1
	if(t=Date.now()-x,e&&e.type===c.events.browser.SCROLL)return function(e,t){for(;e;){if(e===t)return!0
	e=e.parentNode}return!1}(S,e.target)
	return!e||e.type===c.events.browser.RESIZE||t>200}()&&(l.resolve(c.serviceLocator.PUBSUB).publish(c.events.contextMenu.MENU_HIDDEN,function(){if(e&&e.type===c.events.browser.SCROLL)return!0
	if(e&&e.target)return C(e.target)
	return o||!1}()),function(e){if(e&&!function(e){return C(e.target)}(e)){l.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(h.contextMenu.hidden)}}(e),function(){var e=l.resolve(c.serviceLocator.PUBSUB)
	v.removeEventListener(c.events.browser.CLICK,t.hide),v.removeEventListener(c.events.browser.KEYDOWN,L),u.removeEventListener(c.events.browser.RESIZE,t.hide),e.unsubscribe(c.events.interaction.SCROLL_START,t.hide),w.removeEventListener(c.events.browser.CONTEXTMENU,D)}(),i&&a.forEach(i,(function(e){e.dispose&&e.dispose()})),n=null,S=null,w.parentElement.removeChild(w),w=null,x=0,E.itemActions=[],e&&b.getKeyCode(e)===y.ESCAPE&&f.get().addFocusRequestToQueue(r),r=null,t.isVisible(!1))},t.isShowing=function(){return null!==w}})),define("ui/viewModels/buttons/button",["require","vendor/knockout","swx-i18n","ui/contextMenu/contextMenu"],(function(e){var t=e("vendor/knockout"),n=e("swx-i18n").localization,i=e("ui/contextMenu/contextMenu")
	return function(e){var r=this;(function(e){if(e.text)throw new Error("You have to provide i18n enabled textKey param value or set already localized value to i18nText instead of text")
	if(e.title)throw new Error("You have to provide i18n enabled titleKey param value or set already localized value to i18nTitle instead of using title property")
	if(!e.textKey&&!e.i18nText)throw new Error("You have to set either textKey or i18nText parameters")
	e.cssClass=e.cssClass||[]})(e),r.ariaLabel=e.ariaLabel,r.title=e.title,r.disabled=function(e){if("function"==typeof e)return e
	if(null==e)return t.observable(!1)
	return t.observable(e)}(e.disabled),r.tabindex=t.observable(e.tabindex),r.buttonCssClass=t.computed((function(){var t="btn "
	r.disabled()&&(t+="disabled ")
	"function"==typeof e.cssClass?t+=e.cssClass():t+=e.cssClass
	return t}),r),r.spanCssClass=t.computed((function(){var n=t.utils.unwrapObservable(e.icon)
	if(!n)return{}
	if((n=n.split(" ")).length)return n.unshift("iconfont"),n.join(" ")
	return{}}),r),r.hasMenuOptions=e.hasMenuOptions?e.hasMenuOptions:t.observable(!1),r.showMenuOptions=e.showMenuOptions?e.showMenuOptions:t.computed((function(){return!r.disabled()&&r.hasMenuOptions()}),r),r.menuOptions=e.menuOptions?e.menuOptions:t.observable([]),r.ariaHasPopup=t.observable(!1),r.hasFocus=e.hasFocus?e.hasFocus:t.observable(!1),r.dispose=function(){r.buttonCssClass.dispose(),r.spanCssClass.dispose(),r.showMenuOptions.dispose&&r.showMenuOptions.dispose()},r.onClickHandler=function(t,n){r.hasMenuOptions()?i.isShowing()?function(e){i.hide(e)}(n):function(e){var t=r.menuOptions(),n={source:"button",isGroupConversation:!1}
	e.customClientOptions={offsetElement:e.target},i.show(t,e,n)}(n):e.action(n)},e.textKey?r.text=n.fetch({key:e.textKey}):r.text=e.i18nText,e.titleKey?r.title=n.fetch({key:e.titleKey}):e.i18nTitle&&(r.title=e.i18nTitle),e.ariaLabelKey&&(r.ariaLabel=n.fetch({key:e.ariaLabelKey})),e.ariaHasPopup&&r.ariaHasPopup(!0)}})),define("text!views/common/buttons/regular.html",[],(function(){return'<button data-bind="click: onClickHandler, disable: disabled, attr: { class: buttonCssClass, title: title, \'aria-label\': ariaLabel, \'aria-haspopup\': ariaHasPopup }, hasFocus: hasFocus" type="button" role="button">\r\n    <span data-bind="css: spanCssClass, text: text"></span>\r\n    \x3c!-- ko if: showMenuOptions --\x3e\r\n    <div class="buttonMenuOptionsIcon">\r\n        <span class="iconfont chevronDown"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</button>\r\n'})),define("ui/components/experience/button",["require","exports","module","constants/components","ui/viewModels/buttons/button","text!views/common/buttons/regular.html"],(function(e,t){t.name=e("constants/components").experience.BUTTON,t.viewModel=e("ui/viewModels/buttons/button"),t.template=e("text!views/common/buttons/regular.html")})),define("text!views/common/spinner.html",[],(function(){return'<div class="circle one">\r\n    <div class="rotate">\r\n        <div class="position">\r\n            <div class="scale">\r\n                <div class="shape"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="circle two">\r\n    <div class="rotate">\r\n        <div class="position">\r\n            <div class="scale">\r\n                <div class="shape"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="circle three">\r\n    <div class="rotate">\r\n        <div class="position">\r\n            <div class="scale">\r\n                <div class="shape"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="circle four">\r\n    <div class="rotate">\r\n        <div class="position">\r\n            <div class="scale">\r\n                <div class="shape"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/experience/loadingAnimation",["require","exports","module","constants/components","text!views/common/spinner.html"],(function(e,t){t.name=e("constants/components").experience.LOADING_ANIMATION,t.template=e("text!views/common/spinner.html")})),define("ui/viewModels/experience/radioButton",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout")
	return function(e){var n=this
	n.id=e.id,n.value=e.value?e.value:"",n.name=e.name?e.name:"",n.ariaLabel=e.ariaLabel?e.ariaLabel:"",n.labelKey=e.labelKey?e.labelKey:"",n.checked=e.checked,n.isInputChecked=t.pureComputed((function(){return n.checked()===n.value?"checked":""}),n)}})),define("text!views/common/buttons/radioButton.html",[],(function(){return'<label class="RadioButton" data-bind="attr: {for: id}">\r\n    <div class="RadioButton-element">\r\n        <input class="RadioButton-input" type="radio" data-bind="checked: checked, attr: { id: id, name: name, value: value, \'aria-label\': ariaLabel}" />\r\n        <div class="RadioButton-outerCircle" data-bind="css: {RadioButton-outerCircle--checked : isInputChecked}">\r\n            <div class="RadioButton-innerCircle"></div>\r\n        </div>\r\n    </div>\r\n    <span class="text RadioButton-label" data-bind="l10n: {key: labelKey}"></span>\r\n</label>\r\n'})),define("ui/components/experience/radioButton",["require","exports","module","ui/viewModels/experience/radioButton","constants/components","text!views/common/buttons/radioButton.html"],(function(e,t){var n=e("ui/viewModels/experience/radioButton")
	t.name=e("constants/components").experience.RADIO_BUTTON,t.template=e("text!views/common/buttons/radioButton.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),define("ui/telemetry/people/contactTelemetryHelper",["require","exports","module","lodash-compat","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("lodash-compat"),i=e("experience/settings"),r=e("ui/telemetry/telemetryClient")
	t.setStart=function(e,t){r.get().traceStart(e,t)},t.getTrace=function(e){return r.get().traceDump(e)||{}},t.addIfDefined=function(e,t,i){(n.isNumber(i)||n.isString(i)||n.isBoolean(i))&&(e[t]=i)},t.send=function(e,t){n.isEmpty(e)||r.get().sendEvent(i.telemetry.uiTenantToken,t,e)}})),define("ui/telemetry/people/contactSearch",["require","exports","module","ui/telemetry/people/contactTelemetryHelper","swx-enums","swx-constants"],(function(e,t){var n=e("ui/telemetry/people/contactTelemetryHelper"),i=e("swx-enums"),r=e("swx-constants").COMMON,o=r.telemetry.performanceMarks.CONTACTS,a=r.telemetry.contactsV2.contactSearch
	t.onContactSearchStart=function(){n.setStart(o.SEARCH_CONTACT)},t.onContactSearchEnd=function(e){var t=function(e){var t=n.getTrace(o.SEARCH_CONTACT),r={}
	if(!function(e){return e&&e.startTime&&e.duration}(t)||!function(e){return e&&e.searchScope&&void 0!==e.success}(e))return
	if(r[a.fields.NAME]=function(e){if(e===i.searchScope.AddressBook)return a.names.SEARCH_ADDRESSBOOK
	if(e===i.searchScope.SkypeDirectory)return a.names.SEARCH_DIRECTORY
	if(e===i.searchScope.Groups)return a.names.SEARCH_GROUPS
	return e}(e.searchScope),r[a.fields.SUCCESS]=e.success,!r[a.fields.NAME])return
	return n.addIfDefined(r,a.fields.BEGIN_TIMESTAMP,t.startTime),n.addIfDefined(r,a.fields.ELAPSED,t.duration),n.addIfDefined(r,a.fields.QUERY_ID,e.queryId),n.addIfDefined(r,a.fields.RESULT_COUNT,e.resultCount),n.addIfDefined(r,a.fields.CLICK_POSITION,e.clickPosition),n.addIfDefined(r,a.fields.SOURCE,e.source),r}(e)
	n.send(t,a.TYPE)}})),define("ui/telemetry/people/contactSearchSession",["require","exports","module","ui/telemetry/people/contactTelemetryHelper","swx-constants"],(function(e,t){var n=e("ui/telemetry/people/contactTelemetryHelper"),i=e("swx-constants").COMMON,r=i.telemetry.performanceMarks.CONTACTS,o=i.telemetry.contactsV2.searchSession
	t.onSearchSessionStart=function(){n.setStart(r.SESSION_SEARCH)},t.onSearchSessionEnd=function(e){var t=function(e,t){var i=n.getTrace(r.SESSION_SEARCH),a={}
	if(!function(e){return e&&e.startTime&&e.duration}(i)||!function(e){return e&&e.successCriteria&&void 0!==e.success}(e))return
	return a[o.fields.NAME]=t,a[o.fields.SUCCESS]=e.success,n.addIfDefined(a,o.fields.BEGIN_TIMESTAMP,i.startTime),n.addIfDefined(a,o.fields.ELAPSED,i.duration),n.addIfDefined(a,o.fields.SESSION_ID,e.sessionId),n.addIfDefined(a,o.fields.QUERY_COUNT,e.queryCount),n.addIfDefined(a,o.fields.SUCCESS_CRITERIA,e.successCriteria),n.addIfDefined(a,o.fields.SOURCE,e.source),a}(e,o.names.SEARCH_SESSION)
	n.send(t,o.TYPE)}})),define("ui/viewModels/search/input",["require","vendor/knockout","swx-constants","swx-service-locator-instance","swx-constants","utils/common/eventHelper","swx-i18n","swx-enums","browser/window","utils/common/applicationFocusManager","ui/telemetry/actions/actionSources","ui/telemetry/people/contactSearch","ui/telemetry/people/contactSearchSession","utils/common/accessibility"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("swx-constants").KEYS,o=e("utils/common/eventHelper"),a=e("swx-i18n").localization,s=e("swx-enums"),c=e("browser/window"),l=e("utils/common/applicationFocusManager"),u=e("ui/telemetry/actions/actionSources"),d=e("ui/telemetry/people/contactSearch"),p=e("ui/telemetry/people/contactSearchSession"),f=e("utils/common/accessibility").narrator,m=n.events.search,h=n.apiUIEvents,v=n.events.narrowMode,g=18e5
	return function(){var e,y,b,_,E=this,w=i.resolve(n.serviceLocator.PUBSUB),S={inputFocus:null,inputValue:null,showSpinner:null,searchResults:null},x={people:null,groups:null,SkypeDirectory:null},C={searchTimeoutHandle:null,queryCount:null},T=[r.UP,r.DOWN,r.PAGE_UP,r.PAGE_DOWN,r.ENTER,r.F10]
	function I(){E.isEnabled(!0)}function A(){E.isEnabled(!1),E.resetQuery()}function M(t){return e?t+"_4b":t}function O(e){E.query()&&e&&E.showMoreResultsAvailableMessage(y&&e.moreResultsAvailable)}function k(e){0===e.length&&(E.directorySearchActive=!1)}function N(){var e=E.query(),t={source:""===e?u.search.reset.emptyQuery:u.search.reset.queryChanged},n=function(e){var t={searchScope:E.directorySearchActive?s.searchScope.SkypeDirectory:s.searchScope.AddressBook,resultCount:E.directorySearchActive?x.SkypeDirectory:x.people,source:e}
	return t.success=null!==t.resultCount,t}(t.source);(function(e){d.onContactSearchEnd(e),_&&c.clearTimeout(_)})(n),""===e?(w.publish(m.RESET,t),E.directorySearchActive=!1):(C.queryCount=null===C?1:C.queryCount+1,function(e){d.onContactSearchStart(),_=c.setTimeout((function(){d.onContactSearchEnd(e),_=null}),g)}(n),C.searchTimeoutHandle||(p.onSearchSessionStart(),C.searchTimeoutHandle=c.setTimeout((function(){p.onSearchSessionEnd({success:!1,queryCount:C.queryCount}),C.queryCount=null,C.searchTimeoutHandle=null}),g)),w.publish(m.QUERY_CHANGED,e)),E.showSpinner(E.directorySearchActive),x={people:null,groups:null,SkypeDirectory:null}}function P(e){e?w.publish(m.INPUT_FOCUS):w.publish(m.INPUT_BLUR,E.query().length)}function R(e){e||E.hasFocus(!1)}function L(){E.hasFocus(!0)}function D(){var e=""
	E.directorySearchActive?0===x.people&&0===x.groups&&0===x.SkypeDirectory?e=a.fetch({key:"accessibility_totalSearchNoResults"}):null!==x.SkypeDirectory&&(e=a.fetch({key:"accessibility_totalSearchUpdated",params:{totalSearchResults:x.people+x.groups+x.SkypeDirectory,peopleSearchResults:x.people,groupsSearchResults:x.groups,SkypeDirectorySearchResults:x.SkypeDirectory},count:x.people+x.groups+x.SkypeDirectory})):0!==x.people||0!==x.groups||b?0===x.people&&0===x.groups&&b?e=a.fetch({key:M("accessibility_localSearchNoResults")})+a.fetch({key:"accessibility_searchSkypeDirectory"}):null!==x.people&&null!==x.groups&&(e=a.fetch({key:M("accessibility_localSearchUpdated"),params:{totalSearchResults:x.people+x.groups,peopleSearchResults:x.people,groupsSearchResults:x.groups},count:x.people+x.groups})):e=a.fetch({key:M("accessibility_localSearchNoResults")}),""!==e&&f.announce(e)}function U(e){x.people=e,D()}function F(e){x.groups=e,D()}function B(e){e&&f.announce({key:"accessibility_searching"})}function V(e){null!==C.queryCount&&(p.onSearchSessionEnd({success:!0,queryCount:C.queryCount,successCriteria:e.successCriteria,source:e.source}),c.clearTimeout(C.searchTimeoutHandle),C.queryCount=null,C.searchTimeoutHandle=null)}E.inputAriaLabel=t.observable(""),E.hasFocus=t.observable(!1),E.isEnabled=t.observable(!1),E.showSpinner=t.observable(!1),E.directorySearchActive=!1,E.query=t.observable("").extend({rateLimit:{method:"notifyWhenChangesStop",timeout:500}}),E.init=function(){var r=i.resolve(n.serviceLocator.FEATURE_FLAGS)
	y=r.isFeatureOn(n.featureFlags.SHOW_SEARCH_QUERY_MORE_RESULTS_AVAILABLE),b=r.isFeatureOn(n.featureFlags.SKYPE_DIRECTORY_SEARCH),e=r.isFeatureOn(n.featureFlags.USE_BUSINESS_WORDING),w.subscribe(m.DIRECTORY_SEARCH_ACTIVATED,E.onDirectorySearchActivated),w.subscribe(m.DIRECTORY_SEARCH_RESULTS,E.onDirectorySearchResults),w.subscribe(m.GROUPS_SEARCH_RESULTS,F),w.subscribe(m.LOCAL_SEARCH_RESULTS,U),w.subscribe(m.RESET,E.onReset),w.subscribe(v.SIDEBAR_STATE_CHANGED,R),w.subscribe(m.QUERY_EXECUTED,O),w.subscribe(h.SWX_TIMELINE_LOADED,I),w.subscribe(h.SWX_ON_SIGN_OUT,A),w.subscribe(m.SESSION_SUCCESS,V),w.subscribe(n.events.navigation.NAVIGATE_TO_SEARCH_INPUT,L),S.inputFocus=E.hasFocus.subscribe(P),S.inputValue=E.query.subscribe(N),S.searchResults=E.query.subscribe(k),S.showSpinner=E.showSpinner.subscribe(B),E.showMoreResultsAvailableMessage=t.observable(!1),E.inputAriaLabel(a.fetch({key:M("input_searchSkype_ariaLabel")}))},E.dispose=function(){w.unsubscribe(m.DIRECTORY_SEARCH_ACTIVATED,E.onDirectorySearchActivated),w.unsubscribe(m.DIRECTORY_SEARCH_RESULTS,E.onDirectorySearchResults),w.unsubscribe(m.GROUPS_SEARCH_RESULTS,F),w.unsubscribe(m.LOCAL_SEARCH_RESULTS,U),w.unsubscribe(m.RESET,E.onReset),w.unsubscribe(v.SIDEBAR_STATE_CHANGED,R),w.unsubscribe(m.QUERY_EXECUTED,O),w.unsubscribe(h.SWX_TIMELINE_LOADED,I),w.unsubscribe(h.SWX_ON_SIGN_OUT,A),w.unsubscribe(m.SESSION_SUCCESS,V),S.inputFocus.dispose(),S.inputValue.dispose(),S.searchResults.dispose(),S.showSpinner.dispose()},E.onDirectorySearchActivated=function(){E.directorySearchActive=!0,x.people&&(d.onContactSearchEnd({searchScope:s.searchScope.AddressBook,resultCount:x.people,success:!0,source:u.search.reset.directoryActivated}),d.onContactSearchStart()),B(E.directorySearchActive)},E.onDirectorySearchResults=function(e){x.SkypeDirectory=e,E.hasFocus(!0),E.showSpinner(!1),D()},E.activateDirectorySearch=function(){w.publish(m.ACTIVATE_DIRECTORY_SEARCH)},E.onKeyDown=function(e,t){var n=o.getKeyCode(t)
	if(n===r.ESCAPE){if(E.query()){var i={source:u.search.reset.escapeKey}
	return w.publish(m.RESET,i),E.hasFocus(!0),void t.stopPropagation()}return E.hasFocus(!1),t.stopPropagation(),l.removeLastFocusedElement(),void l.tryRestoreFocus()}if(T.indexOf(n)>-1){if(n===r.ENTER&&(null===x.people||null===x.groups))return!1
	n!==r.UP&&n!==r.DOWN&&n!==r.ENTER||o.swallow(t)}return!0},E.resetQuery=function(e,t){var n={source:u.search.reset.resetXButton}
	E.hasFocus(!0),w.publish(m.RESET,n),t&&t.preventDefault()},E.onReset=function(){E.query(""),E.showMoreResultsAvailableMessage(!1)},E.setFocus=E.hasFocus.bind(null,!0)}})),define("text!views/search/input.html",[],(function(){return'<div class="input" data-bind="css: { active: hasFocus() }, click: setFocus">\r\n    <div class="icon" data-bind="css: { showSpinner: showSpinner }">\r\n        <div class="iconfont search"></div>\r\n        <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n    </div>\r\n\t<input role="search" type="text" data-bind="visible: isEnabled, hasFocus: hasFocus, textInput: query, event: { keydown: onKeyDown }, enterKey: activateDirectorySearch, l10n_attr: { \'placeholder\': \'input_placeholder_searchSkype\'}, attr: { \'aria-label\': inputAriaLabel}" maxlength="250" value="" name="query" class="inputField fontSize-h4"/>\r\n\t<button data-bind="visible: query().length, click: resetQuery, l10n_attr: { \'aria-label\': \'clear_search_input_label\'}" type="button" class="btn primary circle small transparent searchReset">\r\n        <span class="iconfont cross"></span>\r\n    </button>\r\n</div>\r\n\x3c!-- ko if: showMoreResultsAvailableMessage() --\x3e\r\n<div class="moreSearchResults">\r\n    <p class="strong" data-bind="l10n: {key: \'message_more_search_results_available\'}"></p>\r\n</div>\r\n\x3c!-- /ko--\x3e\r\n'})),define("ui/components/experience/searchInput",["require","exports","module","ui/viewModels/search/input","constants/components","text!views/search/input.html"],(function(e,t){var n=e("ui/viewModels/search/input")
	t.name=e("constants/components").experience.SEARCH_INPUT,t.template=e("text!views/search/input.html"),t.viewModel={createViewModel:function(){var e=new n
	return e.init(),e}}})),define("utils/common/scroll",[],(function(){var e="px",t="ltroverride",n="neutraloverride"
	function i(i){if(!i)throw new Error("Container must not be null")
	var r,o,a,s,c,l,u,d,p,f,m,h,v,g,y=this,b=!1,_=!1,E=!1
	function w(e){e.preventDefault()}function S(){y.update()}function x(e){E?v.scrollLeft=(e.pageX-f)*u:v.scrollTop=(e.pageY-f)*u}function C(e){b||(window.addEventListener("mouseup",T),window.addEventListener("mousemove",x),i.classList.add("scrolling"),f=E?e.pageX-h.offsetLeft:e.pageY-h.offsetTop,b=!0),w(e)}function T(){i.classList.remove("scrolling"),window.removeEventListener("mouseup",T),window.removeEventListener("mousemove",x),b=!1}function I(e){E?v.scrollLeft=M(e)+v.scrollLeft:v.scrollTop=M(e)+v.scrollTop}function A(e){E?v.scrollLeft=(e.pageX-p)*u:v.scrollTop=(e.pageY-p)*u,w(e)}function M(e){return null!=e.deltaY?e.deltaY>0?100:-100:e.originalEvent&&e.originalEvent.wheelDelta?e.originalEvent.wheelDelta:void 0}y.resize=function(){if(a=r,s=o,E){if(r=i.offsetWidth,o=v.scrollWidth,s===o&&a===r)return
	p=v.getBoundingClientRect().left}else{if(r=i.offsetHeight,o=v.scrollHeight,s===o&&a===r)return
	p=v.getBoundingClientRect().top}if((d=r*(l=r/o))<15)return l=(c=r-15+d)/o,void(u=o/c)
	u=o/r},y.update=function(){y.resize(),o>r?(y.show(),E?(h.style.width=d+e,h.style.left=v.scrollLeft*l+e):(h.style.height=d+e,h.style.top=v.scrollTop*l+e)):y.hide()},y.connect=function(e,t){!g&&window.MutationObserver&&(g=new MutationObserver(t)).observe(e,{childList:!0,subtree:!0})},y.disconnect=function(){g&&(g.disconnect(),g=null)},y.show=function(){_||(i.classList.add("active"),h.addEventListener("mousedown",C),m.addEventListener("wheel",I),E&&v.addEventListener("wheel",I),m.addEventListener("mousedown",A),_=!0)},y.hide=function(){_&&(i.classList.remove("active"),h.removeEventListener("mousedown",C),m.removeEventListener("wheel",I),m.removeEventListener("mousedown",A),E&&v.removeEventListener("wheel",I),_=!1)},y.scrollToBottom=function(){E||(v.scrollTop=v.scrollHeight)},y.scrollToElement=function(e){e.offsetTop&&(v.scrollTop=e.offsetTop)},y.adjustToRTLLayout=function(){var e=document.createElement("div")
	e.style.cssText="position: absolute; overflow-y: scroll; width: 30px; visibility: hidden;",e.innerHTML='<div class="probe"></div>',e.classList.add("adjustWebkitScrollBarsLegacy"),i.appendChild(e)
	var r=e.querySelector(".probe"),o=e.getBoundingClientRect(),a=r.getBoundingClientRect(),s=Math.abs(o.left-a.left)<1,c=Math.abs(o.right-a.right)<1,l=s&&c
	i.classList.remove(n),i.classList.remove(t),l?i.classList.add(n):s&&i.classList.add(t),e.innerHTML="",i.removeChild(e)},y.init=function(e){var t;(e=e||{}).connect&&y.connect(i,y.update),e.horizontal&&(E=!0),y.adjustToRTLLayout(),t="rail",(m=document.createElement("div")).className=t+" "+(E?"railH":"railV"),m.innerHTML='<div class="slider"></div>',i.appendChild(m),i.classList.add("hyperscroll",E?"hyperscrollH":"hyperscrollV"),v=i.querySelector(".scrollViewport"),h=i.querySelector(".rail .slider"),y.show(),y.update(),i.addEventListener("mouseenter",y.update),v.addEventListener("scroll",S)},y.dispose=function(){T(),i.removeEventListener("mouseenter",y.update),v.removeEventListener("scroll",S),y.disconnect(),y.hide(),m.innerHTML="",i.removeChild(m)}}return{build:function(e){return new i(e)}}})),define("ui/viewModels/search/results",["require","lodash-compat","vendor/knockout","swx-i18n","swx-constants","swx-service-locator-instance","ui/telemetry/actions/actionSources","utils/common/scroll"],(function(e){var t,n=e("lodash-compat"),i=e("vendor/knockout"),r=e("swx-i18n").localization,o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("ui/telemetry/actions/actionSources"),c=e("utils/common/scroll"),l=o.events,u="hide",d=l.search,p=l.navigation
	return function(){var e=this,f=a.resolve(o.serviceLocator.PUBSUB),m=a.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.SKYPE_DIRECTORY_SEARCH)
	function h(t){m?e.showDirectoryButton(t):e.showDirectoryButton(!1)}function v(){e.showSpinner(!1)}e.cssClass=i.observable(u),e.showSpinner=i.observable(!1),e.showDirectoryButton=i.observable(m),e.directoryButtonText=r.fetch({key:"button_text_searchDirectory"}),e.directorySearchActive=!1,e.selectedItem=i.observable(""),e.init=function(n){f.subscribe(d.QUERY_CHANGED,e.onQueryChanged),f.subscribe(d.DIRECTORY_SEARCH_RESULTS,e.onDirectorySearchResults),f.subscribe(d.LOCAL_SEARCH_RESULTS,v),f.subscribe(d.RESET,e.hideView),f.subscribe(d.ACTIVATE_DIRECTORY_SEARCH,e.activateDirectorySearch),f.subscribe(p.OPEN_CONVERSATION,e.onOpenConversation),(t=c.build(n)).init()},e.dispose=function(){f.unsubscribe(d.QUERY_CHANGED,e.onQueryChanged),f.unsubscribe(d.DIRECTORY_SEARCH_RESULTS,e.onDirectorySearchResults),f.unsubscribe(d.LOCAL_SEARCH_RESULTS,v),f.unsubscribe(d.RESET,e.hideView),f.unsubscribe(d.ACTIVATE_DIRECTORY_SEARCH,e.activateDirectorySearch),f.unsubscribe(p.OPEN_CONVERSATION,e.onOpenConversation),t.dispose()},e.onScroll=n.debounce((function(){f.publish(l.interaction.SCROLL_START)}),1e3,{leading:!0,trailing:!1}),e.onQueryChanged=function(t){""!==t&&e.showView()},e.onOpenConversation=function(){if(""===e.cssClass()){var t={source:s.search.reset.openConversation}
	f.publish(d.RESET,t)}},e.onDirectorySearchResults=function(){e.showSpinner(!1),h(!1)},e.activateDirectorySearch=function(){m&&(e.showSpinner(!0),h(!1),e.directorySearchActive=!0,f.publish(d.DIRECTORY_SEARCH_ACTIVATED,e.showSpinner()))},e.deactivateDirectorySearch=function(){e.showSpinner(!1),h(!0),e.directorySearchActive=!1,f.publish(d.DIRECTORY_SEARCH_DEACTIVATED,e.showSpinner())},e.hideView=function(){e.selectedItem(""),e.cssClass(u),e.deactivateDirectorySearch()},e.showView=function(){e.cssClass(""),e.showSpinner(!0),h(!e.directorySearchActive)}}})),define("text!views/search/results.html",[],(function(){return'<div class="results scrollable scrollViewport scrollViewportV fixSmall hide" data-bind="css: cssClass, event: { scroll: onScroll }" tabindex="-1">\r\n    <div class="scrollViewport-inner">\r\n        <div class="offScreen" role="tooltip" aria-live="polite" data-bind="text: selectedItem"></div>\r\n        <swx-messages-search></swx-messages-search>\r\n        <swx-people-search></swx-people-search>\r\n        <swx-group-search></swx-group-search>\r\n        \x3c!-- ko if: showSpinner --\x3e\r\n        <div class="grid container">\r\n            <swx-loading-animation data-bind="visible: showSpinner" class="spinner fog"></swx-loading-animation>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: showDirectoryButton --\x3e\r\n        <div class="grid container">\r\n            <div class="button row">\r\n                <button data-bind="click: activateDirectorySearch, l10n_attr: { \'aria-label\': \'input_searchSkypeDirectory_ariaLabel\', \'data-title\': \'input_searchSkypeDirectory_ariaLabel\' }" class="btn primary searchDirectory list-selectable" type="button">\r\n                    <span>\x3c!-- ko text: directoryButtonText --\x3e&nbsp;\x3c!-- /ko --\x3e</span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        <swx-directory-search></swx-directory-search>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/experience/searchResults",["require","exports","module","ui/viewModels/search/results","constants/components","text!views/search/results.html"],(function(e,t){var n=e("ui/viewModels/search/results")
	t.name=e("constants/components").experience.SEARCH_RESULTS,t.template=e("text!views/search/results.html"),t.viewModel={createViewModel:function(e,t){var i=new n
	return i.init(t.element),i}}})),define("ui/viewModels/experience/selectBox",["require","exports","module","lodash-compat","swx-utils-common","swx-constants","browser/dom","utils/common/eventHelper","utils/common/eventMixin","swx-focus-handler","swx-i18n","swx-constants","vendor/knockout","utils/common/scroll","utils/common/accessibility","swx-utils-common"],(function(e,t){var n=e("lodash-compat"),i=e("swx-utils-common").async,r=e("swx-constants").COMMON,o=e("browser/dom"),a=e("utils/common/eventHelper"),s=e("utils/common/eventMixin"),c=e("swx-focus-handler"),l=e("swx-i18n").localization,u=e("swx-constants").KEYS,d=e("vendor/knockout"),p=e("utils/common/scroll"),f=e("utils/common/accessibility").narrator,m=e("swx-utils-common").stringUtils
	function h(e){var t,n,s,h,v,g=this,y=!0,b=[],_="",E=e.autoFocusAfterSelection||!1
	function w(e){function t(t){return new RegExp("^"+e,"i").test(m.normalize(t.name))}window.clearTimeout(v),e===_?h=h<b.length-1?h+1:0:(h=0,y?b=g.selectOptions().filter(t):(e=_+e,b=b.filter(t))),y=!1,_=e,v=window.setTimeout((function(){y=!0}),700)}function S(){g.selectBoxOpened(!1),f.announce({key:"accessibility_selectBox_collapsed"}),x(),_="",y=!0,window.clearTimeout(v),E&&c.get().addFocusRequestToQueue(n,c.Priorities.High)}function x(){document.removeEventListener(r.events.browser.CLICK,S),window.removeEventListener(r.events.browser.RESIZE,S)}g.selectOptions=e.selectOptions?e.selectOptions:[],g.selectedOption=e.selectedOption?e.selectedOption:d.observable(),g.showArrow=!e.showArrow||e.showArrow,g.selectBoxOpened=d.observable(!1),g.tabindex=e.tabindex?e.tabindex:null,g.disabled=e.disabled?e.disabled:d.observable(!1),g.selectBoxId=e.selectBoxId||null,e.placeholderKey?d.isObservable(e.placeholderKey)?g.placeholder=d.pureComputed((function(){return l.fetch({key:e.placeholderKey()})})):g.placeholder=l.fetch({key:e.placeholderKey}):e.placeholder?g.placeholder=e.placeholder:g.placeholder="",g.selectValue=function(e){g.selectedOption(e),S()},g.toggleSelectBox=function(){if(g.disabled())return!1
	g.selectBoxOpened()?S():(g.selectBoxOpened(!0),f.announce({key:"accessibility_selectBox_expanded"}),i.execute((function(){document.addEventListener(r.events.browser.CLICK,S),window.addEventListener(r.events.browser.RESIZE,S)})))},g.dispose=function(){g.placeholder.dispose&&g.placeholder.dispose(),t.dispose(),x()},g.init=function(e){n=o.getElement(".SelectBox-header",e),s=o.getElement(".SelectBox-scrollWrapper",e),(t=p.build(s)).init(),g.registerEvent(r.events.selectBox.TOGGLE,g.toggleSelectBox)},g.listKeyDown=function(e,t){var n=a.getKeyCode(t)
	return n===u.TAB&&g.selectBoxOpened()?(S(),void t.stopPropagation()):(a.isNumPadKey(t)&&(w(a.getNumpadKey(t)),t.stopPropagation()),a.isAlphaNumericKey(t)&&(w(String.fromCharCode(n)),t.stopPropagation()),!0)},g.onKeyDown=function(e,t){var n=a.getKeyCode(t)
	return n===u.TAB&&t.shiftKey&&g.selectBoxOpened()&&S(),n!==u.ENTER&&n!==u.SPACE||g.toggleSelectBox(),!0},g.onBoxClick=function(e,t){t.stopPropagation()}}n.assign(h.prototype,s),t.build=function(e){return new h(e)}}))
	define("text!views/common/selectBox.html",[],(function(){return'<div class="SelectBox-header" data-bind="\r\n        click: toggleSelectBox,\r\n        event: { keydown: onKeyDown },\r\n        attr: { \'aria-label\': selectedOption() ? selectedOption().name : placeholder }"\r\n        tabindex="0" role="combobox">\r\n    <span class="SelectBox-selectedName" data-bind="text: selectedOption() ? selectedOption().name : placeholder, attr: {title: selectedOption() ? selectedOption().name : placeholder}"></span>\r\n    <span class="SelectBox-selectedDescription" data-bind="text: selectedOption() ? selectedOption().description : \'\'"></span>\r\n    <span class="SelectBox-arrowIcon iconfont chevronDown" data-bind="visible: showArrow"></span>\r\n</div>\r\n<div class="SelectBox-options" data-bind="visible: selectBoxOpened, click:onBoxClick">\r\n    <div class="SelectBox-arrow"></div>\r\n    <div class="SelectBox-scrollWrapper" data-bind="keyboardNavigation: { itemSelector: \'.list-selectable\' }">\r\n        <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n            <ul role="listbox" data-bind="foreach: selectOptions">\r\n                <li role="option" class="SelectBox-option list-selectable" data-option\r\n                    data-bind="click: $parent.selectValue,\r\n                        enterKey: $parent.selectValue,\r\n                        css: {selected: $parent.selectedOption() === $data },\r\n                        attr: {title: name, \'data-value\': value},\r\n                        event: {keydown: $parent.listKeyDown}">\r\n                    <span class="SelectBox-optionName" data-bind="text: name"></span>\r\n                    <span class="SelectBox-optionDescription"data-bind="text: description"></span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/experience/selectBox",["require","exports","module","vendor/knockout","ui/viewModels/experience/selectBox","constants/components","text!views/common/selectBox.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/experience/selectBox")
	t.name=e("constants/components").experience.SELECT_BOX,t.template=e("text!views/common/selectBox.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e),o=t.element,a=n.dataFor(o)
	return r.setContext(a),r.init(o),r}}})),define("ui/viewModels/buttons/toggle",[],(function(){function e(e){this.checked=e.checked,this.ariaLabel=e.ariaLabel,this.labelledById=e.labelledById,this.onClick=e.click||function(){},this.disabled=e.disabled}return e.build=function(t){return new e(t)},e})),define("text!views/common/buttons/toggleButton.html",[],(function(){return'<button class="ToggleButton" type="button" role="checkbox" aria-relevant="all"\r\n        data-bind="disable: disabled, css: { \'ToggleButton--checked\': checked }, click: onClick, attr: {\'aria-label\': ariaLabel, \'aria-checked\': checked, \'aria-labelledby\': labelledById }">\r\n</button>\r\n'})),define("ui/components/experience/toggleButton",["require","exports","module","constants/components","ui/viewModels/buttons/toggle","text!views/common/buttons/toggleButton.html"],(function(e,t){t.name=e("constants/components").experience.TOGGLE_BUTTON,t.viewModel=e("ui/viewModels/buttons/toggle"),t.template=e("text!views/common/buttons/toggleButton.html")})),define("notifications/settings",["require","exports","module","lodash-compat","vendor/knockout","swx-constants","swx-service-locator-instance","swx-cafe-application-instance"],(function(e,t){var n,i=e("lodash-compat"),r=e("vendor/knockout"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("swx-cafe-application-instance"),c=new p,l=new p,u=new p,d=new p
	function p(){var e,t=this
	t.value=r.observable(!1),t.init=function(r){n&&(e=function(e){var t,n,r
	return t=s.get().personsAndGroupsManager.mePerson,n=t.preferences(),r=i.find(n,{description:{id:e}}),void 0===r?void 0:r.value()}(r),t.value(function(e){return void 0!==e&&!e}(e)))}}t.init=function(){var e=a.resolve(o.serviceLocator.FEATURE_FLAGS),t=o.userSettings.preferences
	n=e.isFeatureOn(o.featureFlags.NOTIFICATIONS_SETTINGS_ENABLED),c.init(t.NOTIFICATIONS),l.init(t.NOTIFICATIONS_SOUND),u.init(t.CHAT_NOTIFICATIONS_SOUND),d.init(t.CALL_NOTIFICATIONS)},t.chatNotificationsMuted=c.value,t.notificationsSoundMuted=l.value,t.chatNotificationsSoundMuted=u.value,t.callNotificationsMuted=d.value})),define("telemetry/notifications/notificationActions",["require","exports","module","ui/telemetry/telemetryClient","experience/settings","swx-constants"],(function(e,t){var n=e("ui/telemetry/telemetryClient"),i=e("experience/settings"),r=e("swx-constants").COMMON
	function o(){return{send:function(e){var t=r.telemetry.notificationActionsEvent.TYPE,o={}
	o.type=e.type,o.action=e.action,n.get().sendEvent(i.telemetry.uiTenantToken,t,o)}}}t.build=function(){return new o}})),define("notifications/common/notification",["require","vendor/knockout","lodash-compat","ui/controls/calling/sounds","swx-constants","notifications/settings","swx-utils-common","telemetry/notifications/notificationActions"],(function(e){var t=e("vendor/knockout"),n=e("lodash-compat"),i=e("ui/controls/calling/sounds"),r=e("swx-constants").COMMON,o=r.telemetry.notificationActionsEvent,a=e("notifications/settings"),s=e("swx-utils-common").url,c=e("telemetry/notifications/notificationActions")
	return function(e,l,u,d){var p,f=this,m=b(d)?d.key:i.KEYS.MESSAGE_RECEIVED_1,h=!!b(d)&&d.loop,v=c.build(),g={type:e}
	function y(){return{isDelayedNotification:!!f.wasDelayed,displayType:f.displayType}}function b(e){return e&&e.key}this.type=e,this.sender=function(e){return e=function(e){if(e.avatar){var n="function"==typeof e.avatar?e.avatar():e.avatar
	n.indexOf("returnDefaultImage=false")>-1&&(n=s.removeQueryParameter(n,"returnDefaultImage")),e.avatar="function"==typeof e.avatar?t.observable(n):n}return e}(e),e}(n.clone(l)||{}),u=u||{},this.title=t.observable(""),this.description=t.observable(""),this.active=t.observable(),this.canPlaySound=function(){if(a.notificationsSoundMuted())return!1
	if(a.chatNotificationsSoundMuted()&&(e===r.notifications.CHAT||e===r.notifications.UNREAD_MESSAGE))return!1
	return!0}(),this.accept=function(){g.action=o.action.accept,f.active()&&u.accept&&(f.isUnreadMessage&&(arguments[0]=y()),u.accept.apply(null,arguments),v.send(g)),f.active(!1)},this.decline=function(){g.action=o.action.decline,f.active()&&u.decline&&(u.decline(y()),v.send(g)),f.active(!1)},this.open=function(){g.action=o.action.open,f.active()&&u.open&&(u.open(y()),v.send(g)),f.active(!1)},this.sound={play:function(){f.active()&&f.canPlaySound&&(h?i.playLoop(m):i.playOnce(m),p=f.active.subscribe((function(e){p.dispose(),e||f.sound.stop()})))},stop:function(){i.stop(m)}}}})),define("notifications/common/sender",["require","exports","module","swx-utils-chat","utils/common/cafeObservable","vendor/knockout","lodash-compat","swx-utils-common","swx-enums","swx-i18n","experience/settings","swx-constants","swx-utils-common","swx-service-locator-instance"],(function(e,t){var n=e("swx-utils-chat").messageSanitizer,i=e("utils/common/cafeObservable"),r=e("vendor/knockout"),o=e("lodash-compat"),a=e("swx-utils-common").guid,s=e("swx-enums").onlineStatus,c=e("swx-i18n").localization,l=e("experience/settings"),u=e("swx-constants").COMMON,d=e("swx-utils-common").url,p=e("swx-service-locator-instance").default
	function f(e){var t,i=c.fetch({key:"notification_text_group_conversation_from"})
	if(e.topic())t=n.getSanitizedTopic(e.topic())
	else{var a=e.participants(0)
	t=a?i+" "+a.person.displayName():i}return r.observable(o.unescape(t))}function m(e){return{uri:i.newObservableProperty(e.id),status:i.newObservableProperty(e.status),displayName:r.observable(o.unescape(e.displayName())),avatar:h(e.avatarUrl,l.assetsBaseUrl+"/images/avatars/default-avatar-contact.png")}}function h(e,t){var n=t
	return!p.resolve(u.serviceLocator.FEATURE_FLAGS).isFeatureOn(u.featureFlags.SHOW_DEFAULT_AVATAR_IN_NOTIFICATIONS)&&e()&&(n=d.removeQueryParameter(e(),"returnDefaultImage")),r.observable(n)}t.fromConversation=function(e){return e.isGroupConversation()?{uri:r.observable("local:"+a.create()),status:r.observable(s.Unknown),displayName:f(e),avatar:h(e.avatarUrl,l.assetsBaseUrl+"/images/avatars/default-avatar-group.png")}:m(e.participants(0).person)},t.fromPerson=m})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("jskype-settings-instance/lib/index",["require","exports","swx-log-tracer"],e)}((function(e,t){var n=e("swx-log-tracer").getLogger("[jskype-settings]")
	t.settings={flagsApiUrl:"",featureFlags:{},userOptionsService:{host:"",optionsEndpoint:""},contactsProxyService:{},stratusService:{host:"",avatarUrl:"",retry:null},abchUserWebService:{host:"",appId:"",settingsEndpoint:""},profileService:{appId:"",profileEndpoint:""},avatarService:{host:"",contactAvatarEndpoint:"",publicAvatarEndpoint:""},serviceQosReporter:{iterationCountBeforeFlushingQoSMetrics:0},telemetry:{jSkypeTenantToken:"",chatTenantToken:"",trouterTenantToken:"",mdscToken:"",skypeConcoreToken:"",issueReportUrl:""},sessionId:"",platformId:"",ecsClientCobrandTag:"",environment:""},t.isFeatureOn=function(e){return t.settings.featureFlags?Boolean(t.settings.featureFlags[e]):(n.warn("No feature flags set on settings, checking feature "+e),!1)}})),define("jskype-settings-instance",["jskype-settings-instance/lib/index"],(function(e){return e})),define("notifications/ringingDeferrer/ringingDeferrerSetting",["require","swx-enums"],(function(e){var t=e("swx-enums").ringingDeferrerOptions
	return function(e,n){this.option=e||t.Unset,this.untilTimestamp=n||0}})),define("notifications/ringingDeferrer/ringingDeferrerUtil",["require","exports","module","lodash-compat","ui/telemetry/actions/actionNames","swx-cafe-application-instance","jskype-settings-instance","swx-constants","swx-enums","notifications/ringingDeferrer/ringingDeferrerSetting","swx-service-locator-instance"],(function(e,t){var n=e("lodash-compat"),i=e("ui/telemetry/actions/actionNames"),r=e("swx-cafe-application-instance"),o=e("jskype-settings-instance"),a=e("swx-constants").COMMON,s=e("swx-enums"),c=e("notifications/ringingDeferrer/ringingDeferrerSetting"),l=e("swx-service-locator-instance").default
	function u(){if(t.isFeatureEnabled())return r.get().personsAndGroupsManager.mePerson.preferences(a.userSettings.preferences.DEFER_RINGING_SOUND)}t.isFeatureEnabled=function(){return o.isFeatureOn(a.featureFlags.RINGING_DEFERRING)},t.getCurrentSetting=function(){var e=u()
	if(e){var t=e.value()
	if(n.has(t,"option")&&n.has(t,"untilTimestamp"))return t}},t.areRingingSoundsDeferred=function(){return(new Date).getTime()<((e=t.getCurrentSetting())&&e.option!==s.ringingDeferrerOptions.Unset?e.untilTimestamp:0)
	var e},t.applyOption=function(e){var t=u()
	if(!t)return Promise.reject()
	var n=t.value()
	if(e===s.ringingDeferrerOptions.Unset&&n&&n.option===e)return Promise.resolve()
	return n=new c(e,function(e){return e?(new Date).getTime()+36e5*e:0}(e)),function(e){l.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(i.notificationsSettings.changeRingingDeferrerSetting,{option:e})}(e),t.value.set(n)}})),define("notifications/types/incomingCall",["require","ui/telemetry/actions/actionNames","swx-browser-detect","ui/viewModels/calling/helpers/callingFacade","swx-constants","notifications/common/notification","swx-pubsub-instance","notifications/common/sender","swx-service-locator-instance","ui/controls/calling/sounds","notifications/ringingDeferrer/ringingDeferrerUtil","swx-cafe-application-instance"],(function(e){var t=e("ui/telemetry/actions/actionNames"),n=e("swx-browser-detect").default,i=e("ui/viewModels/calling/helpers/callingFacade"),r=e("swx-constants").COMMON,o=e("notifications/common/notification"),a=e("swx-pubsub-instance").default,s=e("notifications/common/sender"),c=e("swx-service-locator-instance").default,l=e("ui/controls/calling/sounds"),u=e("notifications/ringingDeferrer/ringingDeferrerUtil"),d=e("swx-cafe-application-instance")
	return{build:function(e,p){var f=c.resolve(r.serviceLocator.FEATURE_FLAGS),m=function(){var e=n.getBrowserInfo().browserName===n.BROWSERS.CHROME,t=n.getSystemInfo().osName===n.OPERATING_SYSTEMS.LINUX,i=f.isFeatureOn(r.featureFlags.PLUGINLESS_VIDEO_CALLING_CHROME_LINUX),o=f.isFeatureOn(r.featureFlags.CAN_NOTIFY_WITHOUT_VIDEO)
	if(e&&t&&!i&&o)return r.notifications.AUDIO_WITHOUT_VIDEO
	return r.notifications.AUDIO}(),h={key:l.KEYS.CALL_INCOMING,loop:!0},v={accept:function(t){t!==r.modalityType.AUDIO&&t?t===r.modalityType.VIDEO?g(p,!0):t===r.modalityType.CHAT&&(y(),a.publish(r.events.navigation.OPEN_CONVERSATION,{model:e})):g(p,!1)},decline:y}
	function g(n,o){var a=o?t.audioVideo.acceptWithVideo:t.audioVideo.acceptWithAudio
	c.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(a),n?i.acceptCall(e,o):i.installPlugin("incoming",e,!1,o)}function y(){c.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(t.audioVideo.reject),i.rejectCall(e)}var b=new o(m,s.fromConversation(e),v,h)
	return b.canPlaySound&&(u.areRingingSoundsDeferred()||function(){if(!f.isFeatureOn(r.featureFlags.CALL_NOTIFICATIONS_SOUND_SETTINGS_ENABLED))return!1
	var e=d.get().personsAndGroupsManager.mePerson.preferences(r.userSettings.preferences.CALL_NOTIFICATIONS_SOUND)
	return!!e&&!e.value()}())&&(b.canPlaySound=!1),b}}})),define("notifications/types/hardware",["require","notifications/common/notification"],(function(e){var t=e("notifications/common/notification")
	return{build:function(e,n){var i=new t(e)
	return i.title(n),i}}})),define("notifications/types/avatar",["require","notifications/common/notification"],(function(e){var t=e("notifications/common/notification")
	return{build:function(e,n){var i=new t(e)
	return i.title(n),i}}})),define("notifications/types/callingNotSupported",["require","notifications/common/notification","swx-constants","swx-utils-people","constants/calling.resources","swx-i18n"],(function(e){var t=e("notifications/common/notification"),n=e("swx-constants").COMMON,i=e("swx-utils-people").userDataProcessor,r=e("constants/calling.resources").notifications.incomingCall,o=e("swx-i18n").localization
	return{build:function(e,a){var s,c,l,u,d,p,f,m
	s=e?o.fetch({key:"notification_text_osNotSupported"}):o.fetch({key:"notification_text_browserNotSupported"}),l=s,u=a.topic(),d=r.linkTemplate,p=o.fetch({key:"notification_text_learnMore"}),f=i.stripAnchors(u),m=i.sanitizeXml(f),c=l.replace("{callerName}",m)+" "+d.replace("{notification_text_learnMore}",p)
	var h=new t(n.notifications.WARNING)
	return h.title(c),h}}})),define("notifications/telemetry/browserToastTelemetry",["require","swx-constants","experience/settings","ui/telemetry/telemetryClient","services/telemetry/common/telemetryContext","utils/common/appVisibilityProvider","swx-browser-globals","swx-cafe-application-instance"],(function(e){var t=e("swx-constants").COMMON,n=t.telemetry.browserToast,i=e("experience/settings"),r=e("ui/telemetry/telemetryClient"),o=e("services/telemetry/common/telemetryContext"),a=e("utils/common/appVisibilityProvider"),s=e("swx-browser-globals"),c=e("swx-cafe-application-instance")
	function l(e){var l=t.telemetry.NOT_AVAILABLE,u=c.get().conversationsManager
	function d(e,i){var r,c={isGroupConversation:l,hasAvatar:l,activeEndpointsCount:l,currentUnreadMessageCount:l,timeInStale:l,isMau:l,isSeen:l,toastType:l,pastUnreadMessages:l,activeUnreadMessages:l,unreadState:l,DauCandidate:l,MauCandidate:l,isDelayedNotification:l,notificationQueueLength:l,notificationDisplayType:l,unreadConversationsCount:l,isDecline:l},d=s.getWindow().localStorage.getItem(t.telemetry.idleUsersAnalytics.localKeys.sidebarActivity)
	return d&&(r=JSON.parse(d)),e.historyService&&(c.isGroupConversation=e.isGroupConversation(),c.hasAvatar=!!e.avatarUrl()&&e.avatarUrl().length>0,c.currentUnreadMessageCount=e.historyService.unreadActivityItemsCount(),c.timeInStale=function(){if(!e.historyService)return
	var t=e.historyService.activityItems().filter((function(e){return!e.isRead()})).sort((function(e,t){return e.timestamp()>t.timestamp()}))
	if(0===t.length)return l
	return p(t[0].timestamp())}()),c.activeEndpointsCount=o.get().activeEndpoints.length,c.isSeen=a.hasFocus(),c.isMau=function(){if(!r)return l
	if(r.sidebar&&r.sidebar.lastTimeOpened)return p(new Date(r.sidebar.lastTimeOpened))<=30
	return!1}(),c.MauCandidate=function(){if(!r)return l
	if(r.sidebar&&r.sidebar.lastTimeOpened)return p(new Date(r.sidebar.lastTimeOpened))>30
	return!1}(),c.DauCandidate=function(){if(!r)return l
	if(r.sidebar&&r.sidebar.lastTimeOpened){var e=p(new Date(r.sidebar.lastTimeOpened))
	return e>1&&e<=30}return!1}(),c.toastType=n.toastType.INDIVIDUAL,void 0!==i.isDelayedNotification&&(c.isDelayedNotification=!!i.isDelayedNotification),void 0!==i.notificationQueueLength&&(c.notificationQueueLength=i.notificationQueueLength),void 0!==i.displayType&&(c.notificationDisplayType=i.displayType),void 0!==i.displayNameResolved&&(c.displayNameResolved=i.displayNameResolved),void 0!==i.isDecline&&(c.isDecline=i.isDecline),c.unreadConversationsCount=function(){if(!u._unreadConversationsCount)return l
	return u._unreadConversationsCount()}(),c
	function p(e){return Math.round(Math.abs((Date.now()-e)/864e5))}}this.publish=function(t,o,a){if(t&&e){var s,c=d(t,o);(s=c,u._unreadCounversationsCounters?u._unreadCounversationsCounters().then((function(e){var t=e[0]||0,i=e[1]||0,r=l
	return 0===t&&0===i?r=n.unreadState.NONE:t>0&&0===i?r=n.unreadState.PASSIVE:0===t&&i>0?r=n.unreadState.ACTIVE:t>0&&i>0&&(r=n.unreadState.BOTH),s.pastUnreadMessages=t,s.activeUnreadMessages=i,s.unreadState=r,s})):Promise.reject(s)).then(p,p)}function p(t){var n=function(e){for(var t in e)e.hasOwnProperty(t)&&!("string"==typeof e[t]||e[t]instanceof String)&&(e[t]=e[t]+"")
	return e}(t)
	r.get().sendEvent(i.telemetry.chatTenantToken,e,n),a&&a()}}}return l.build=function(e){if(e)return new l(e)},l})),define("notifications/types/unreadMessage",["require","notifications/common/notification","notifications/common/sender","swx-pubsub-instance","swx-constants","swx-i18n","swx-cafe-application-instance","swx-service-locator-instance","notifications/telemetry/browserToastTelemetry"],(function(e){var t=e("notifications/common/notification"),n=e("notifications/common/sender"),i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=e("swx-i18n").localization,a=e("swx-cafe-application-instance"),s=e("swx-service-locator-instance").default,c=e("notifications/telemetry/browserToastTelemetry")
	return{build:function(e){var l=c.build(r.telemetry.browserToast.EVENTS.CLICKED)
	function u(){if(_&&g){var t,n,i,r=e.summary.unreadConversations||[h],a="",s=o.fetch({key:"label_text_agent_profile_capabilities_join_char"})
	return r.forEach((function(e){e.isGroupConversation()?a+=""===a?e.topic():s+e.topic():(t=e.participants&&e.participants()[0],n=t.person.firstName(),a+=""===a?n:s+n)})),i={key:"newSummaryOwaToast",params:{name:a}},o.fetch(i)}return e.likeAdded?v?o.fetch({key:"hearts_notification_messageGroup",params:{participantName:m.person.displayName(),messageText:m.text()}}):o.fetch({key:"hearts_notification_messageConv",params:{messageText:m.text()}}):m.text()}var d,p,f,m=e.message,h=e.conversation,v=h.isGroupConversation(),g=e.summary&&e.summary.show,y=function(t){if(e.likeAdded)return t?n.fromConversation(h):n.fromPerson(m.person)
	var i=e.summary||{},r=i.secondTopicGoesFirst
	if(t&&!r)return n.fromConversation(h)
	var o=r?i.secondConversation.participants()[0].person:m.person||m.sender
	return n.fromPerson(o)}(v),b=s.resolve(r.serviceLocator.FEATURE_FLAGS),_=b.isFeatureOn(r.featureFlags.CHAT_MESSAGE_TYPE_NOTIFICATION_ENABLED),E=b.isFeatureOn(r.featureFlags.MENTIONS_ENABLED),w=!e.likeAdded&&r.mentions.meIdentifier.test(m.html()),S=E&&a.get().personsAndGroupsManager.mePerson.preferences(r.userSettings.preferences.MENTIONS).value()
	function x(t){d={model:h,origin:r.telemetry.historyLoadOrigin.NOTIFICATION_CONV},E&&w&&(d.origin=r.telemetry.historyLoadOrigin.MENTION_ME),e.likeAdded&&(d.messageId=m.id),i.publish(r.events.navigation.OPEN_CONVERSATION,d),l.publish(h,t||{})}_?(p=r.notifications.CHAT,f={accept:x,decline:function(e){(e=e||{}).isDecline=!0,l.publish(h,e)}},g&&y.displayName(u())):(p=r.notifications.UNREAD_MESSAGE,f={open:x})
	var C=new t(p,y,f)
	return _&&(C.autoDeactivation=!0),C.description(g?"":u()),w&&E&&S&&C.title(o.fetch({key:"mention_notification_title",params:{participant:y.displayName(),chat:h.topic()}})),C}}})),define("notifications/types/unreadMessageReminder",["require","notifications/common/notification","swx-constants","swx-i18n","experience/settings","vendor/knockout","swx-service-locator-instance","notifications/telemetry/browserToastTelemetry","utils/common/localStorage"],(function(e){var t=e("notifications/common/notification"),n=e("swx-constants").COMMON,i=e("swx-i18n").localization,r=e("experience/settings"),o=e("vendor/knockout"),a=e("swx-service-locator-instance").default,s=e("notifications/telemetry/browserToastTelemetry"),c=e("utils/common/localStorage"),l=n.telemetry.browserToast
	return{build:function(e){function u(t,n){var i=s.build(t)
	n?n.displayNameResolved="n/a":n={displayNameResolved:"n/a"},i.publish(e[0],n)}var d,p,f,m,h,v,g=a.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.CHAT_MESSAGE_TYPE_NOTIFICATION_ENABLED),y=(m=e.length&&(f=e[0])&&!/^19:/.test(f.id)?e[0].id.replace(/^\d+:/,""):void 0,h=m?encodeURIComponent(m):"thread",v=r.avatarService.host+r.avatarService.publicAvatarEndpoint.replace("${contactId}",h),{description:i.fetch({key:"newChatsSessionOwaToast",count:e.length}),avatar:v.replace("returnDefaultImage=false","returnDefaultImage=true")}),b=function(e,t){return{uri:o.observable(""),status:o.observable(""),displayName:o.observable(t?y.description:""),avatar:o.observable(e)}}(y.avatar,g)
	g?(d=n.notifications.CHAT,p={accept:function(e){u(l.EVENTS.CLICKED,e||{})},decline:function(e){c.set(l.ignore.TIMEOUT_KEY,Date.now()+l.ignore.TIMEOUT),(e=e||{}).isDecline=!0,u(l.EVENTS.CLICKED,e)}}):(d=n.notifications.UNREAD_MESSAGE,p={open:function(e){u(l.EVENTS.CLICKED,e||{})}})
	var _=new t(d,b,p)
	return g||_.description(y.description),_.displayType=l.displayType.REMINDER,_.publishUnreadMessageTelemetry=u.bind(null,l.EVENTS.SHOWN),_.isUnreadMessage=!0,_}}})),define("notifications/types/contactRequest",["require","swx-cafe-application-instance","notifications/common/notification","swx-pubsub-instance","swx-constants","swx-enums"],(function(e){var t=e("swx-cafe-application-instance"),n=e("notifications/common/notification"),i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=e("swx-enums")
	return{build:function(e){var a,s,c=e.conversation,l=e.activityItem,u=r.notifications.CONTACT_REQUEST
	function d(){i.publish(r.events.navigation.OPEN_CONVERSATION,{model:c,origin:r.telemetry.historyLoadOrigin.NOTIFICATION_CONV})}return s={uri:l.sender.id,status:l.sender.status,displayName:l.sender.displayName,avatar:l.sender.avatarUrl,capabilities:l.sender.capabilities},(a=new n(u,s,{accept:function(){var e=l.sender
	t.get().personsAndGroupsManager.all.persons.add(e,e.id(),void 0,o.activityType.ContactRequestIncoming),d()},decline:function(){t.get().conversationsManager.conversations.remove(c,o.activityType.ContactRequestIncoming)},open:d})).description(l.greeting()),a.title(l.sender.title()),a}}})),define("notifications/types/chatRequest",["require","swx-cafe-application-instance","swx-constants","swx-pubsub-instance","notifications/common/notification","notifications/common/sender","swx-enums"],(function(e){var t=e("swx-cafe-application-instance"),n=e("swx-constants").COMMON,i=e("swx-pubsub-instance").default,r=e("notifications/common/notification"),o=e("notifications/common/sender"),a=e("swx-enums")
	return{build:function(e){var s,c=e.conversation,l={accept:function(){c.chatService.accept.enabled()?c.chatService.accept():c.chatService.start.enabled()&&c.chatService.start(),i.publish(n.events.navigation.OPEN_CONVERSATION,{model:c}),i.publish(n.events.narrowMode.SHOW_SIDEBAR)},decline:function(){c.chatService.reject.enabled()&&c.chatService.reject(),c.isGroupConversation()&&t.get().conversationsManager.conversations.remove(c)}}
	return s=new r(n.notifications.CHAT,o.fromConversation(c),l),c.historyService.activityItems.filter((function(e){e.type()===a.activityType.TextMessage&&(s.description(e.text()),s.title(e.sender.title()))})),s}}})),define("notifications/types/education",["require","notifications/common/notification","swx-constants","experience/settings","vendor/knockout"],(function(e){var t=e("notifications/common/notification"),n=e("swx-constants").COMMON,i=e("experience/settings"),r=e("vendor/knockout")
	return{build:function(e){if(e&&e.educationalMessage){var o=n.notifications.UNREAD_MESSAGE,a=i.assetsBaseUrl+"/images/icons/skypeLogo.png",s={avatar:r.observable(e.iconUrl||a),uri:r.observable(""),displayName:r.observable("")},c=e.clickAction?{open:e.clickAction}:void 0,l=new t(o,s,c)
	return l.description(e.educationalMessage),e.showAction&&(l.onshow=e.showAction),l}}}})),define("notifications/factory",["require","swx-constants","swx-i18n","notifications/types/incomingCall","notifications/types/hardware","notifications/types/avatar","notifications/types/callingNotSupported","notifications/types/unreadMessage","notifications/types/unreadMessageReminder","notifications/types/contactRequest","notifications/types/chatRequest","notifications/types/education"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-i18n").localization,i=e("notifications/types/incomingCall"),r=e("notifications/types/hardware"),o=e("notifications/types/avatar"),a=e("notifications/types/callingNotSupported"),s=e("notifications/types/unreadMessage"),c=e("notifications/types/unreadMessageReminder"),l=e("notifications/types/contactRequest"),u=e("notifications/types/chatRequest"),d=e("notifications/types/education")
	return{build:function(e,p){var f=t.notifications
	switch(e){case f.INCOMING_CALL:return i.build(p.conversation,!0)
	case f.INCOMING_CALL_WITH_NO_PLUGIN:return i.build(p.conversation,!1)
	case f.DEVICE_MISSING_CAMERA:return r.build(f.WARNING,n.fetch({key:"notification_text_hardware_camera"}))
	case f.DEVICE_MISSING_MICROPHONE:return r.build(f.WARNING,n.fetch({key:"notification_text_hardware_mic"}))
	case f.DEVICE_MISSING_SPEAKER:return r.build(f.ERROR,n.fetch({key:"notification_text_hardware_speaker"}))
	case f.INCOMING_CALL_BROWSER_NOT_SUPPORTED:return a.build(!1,p.conversation)
	case f.INCOMING_CALL_OS_NOT_SUPPORTED:return a.build(!0,p.conversation)
	case f.UNREAD_MESSAGE:return p.isReminderToast?c.build(p.unreadConversations):p.educationalMessage?d.build(p):s.build(p)
	case f.CONTACT_REQUEST:return l.build(p)
	case f.CHAT:return u.build(p)
	case f.AVATAR_NOT_SUPPORTED_IMAGE_TYPE:return o.build(f.ERROR,n.fetch({key:"notification_text_avatar_not_supported_image_type"}))
	case f.AVATAR_TOO_LARGE:return o.build(f.ERROR,n.fetch({key:"notification_text_avatar_too_large"}))
	case f.AVATAR_UPLOAD_ERROR:return o.build(f.ERROR,n.fetch({key:"notification_text_avatar_upload_error"}))}}}})),define("ui/viewModels/experience/avatarFilePicker",["require","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","vendor/knockout","swx-constants","swx-cafe-application-instance","swx-i18n","notifications/factory","notifications/common/notificationHub","swx-service-locator-instance","browser/dom"],(function(e){var t=e("ui/telemetry/actions/actionNames"),n=e("ui/telemetry/actions/actionSources"),i=e("vendor/knockout"),r=e("swx-constants").COMMON,o=e("swx-cafe-application-instance"),a=e("swx-i18n").localization,s=e("notifications/factory"),c=e("notifications/common/notificationHub"),l=e("swx-service-locator-instance").default,u=e("browser/dom")
	function d(e,d){var p=this,f=o.get().personsAndGroupsManager.mePerson,m={source:n.me.avatar},h=l.resolve(r.serviceLocator.ACTION_TELEMETRY),v=u.getElement(".avatarFilePickerInput",d)
	function g(e){var t=new window.FileReader;(function(e){if(null===e)return!1
	if(t=e.type,!(["image/gif","image/png","image/jpeg"].indexOf(t)>-1))return c.notify(s.build(r.notifications.AVATAR_NOT_SUPPORTED_IMAGE_TYPE)),!1
	var t
	if(n=e.size,!(n/1048576<2))return c.notify(s.build(r.notifications.AVATAR_TOO_LARGE)),!1
	var n
	return!0})(e)&&(t.onload=function(){(function(e,t){var n=new window.Image
	n.addEventListener("load",(function(){var e,i=document.createElement("canvas"),r=i.getContext("2d"),o=n.height,a=n.width,s=256
	i.width=s,i.height=s,a===o?r.drawImage(n,0,0,s,s):a>o?(a=Math.floor(s*a/o),o=s,e=Math.floor((a-s)/2),r.drawImage(n,-e,0,a,o)):a<o&&(o=Math.floor(s*o/a),a=s,e=Math.floor((o-s)/2),r.drawImage(n,0,-e,a,o)),i.toBlob(t,"image/jpeg",1)}),!1),n.setAttribute("src",e)})(t.result,(function(e){p.conversation&&p.conversation.isGroupConversation()&&p.conversation._setGroupAvatar?function(e){p.avatarUploadDisabled(!0),p.conversation._setGroupAvatar(e).then((function(){p.avatarUploadDisabled(!1)}),(function(){c.notify(s.build(r.notifications.AVATAR_UPLOAD_ERROR)),p.avatarUploadDisabled(!1)}))}(e):function(e){var t=new window.FileReader,n=e.type
	t.onload=function(t){var i=t.target.result
	p.avatarUploadDisabled(!0),f.updateAvatar(i,n).then((function(){var t=new window.FileReader
	t.onload=function(e){f.updateAvatarUrl(e.target.result)},t.readAsDataURL(e),p.avatarUploadDisabled(!1)}),(function(){c.notify(s.build(r.notifications.AVATAR_UPLOAD_ERROR)),p.avatarUploadDisabled(!1)}))},t.readAsArrayBuffer(e)}(e)}))},t.readAsDataURL(e))}p.conversation=e?e.conversationModel:null,p.avatarUploadSupported=!!window.FormData&&!!window.FileReader,p.avatarUploadDisabled=i.observable(!p.avatarUploadSupported),p.uploadProfilePictureText=p.conversation&&p.conversation.isGroupConversation()?a.fetch({key:"group_avatar_uploadProfilePictureText"}):a.fetch({key:"me_avatar_uploadProfilePictureText"}),p.uploadProfilePictureAriaLabel=a.fetch({key:"me_avatar_uploadProfilePictureAriaLabel"}),p.openFilePickerInput=function(){v.click()},p.checkUploadEnabled=function(e,n){return h.recordAction(t.me.avatarFilePickerClicked,m),n.stopPropagation(),!p.avatarUploadDisabled()},p.processFiles=function(e,t){g(t.target.files[0]),t.target.value=null}}return d.build=function(e,t){return new d(e,t)},d})),define("text!views/experience/avatarFilePicker.html",[],(function(){return'<div data-bind="visible: avatarUploadSupported">\r\n    <input type="file" accept="image/*" class="avatarFilePickerInput"\r\n        data-bind="event: {click: checkUploadEnabled,\r\n                change: processFiles}"/>\r\n    <button class="avatarOpenFilePickerInput" data-bind="click: openFilePickerInput,\r\n            attr: {\r\n                title: uploadProfilePictureText,\r\n                \'aria-label\': uploadProfilePictureAriaLabel\r\n            }"></button>\r\n    <span class="avatarFilePickerButton">\r\n        <span class="btn primary circle protected picturePickerBtn">\r\n            <span class="iconfont picturePicker picture"></span>\r\n        </span>\r\n    </span>\r\n</div>\r\n'})),define("ui/components/experience/avatarFilePicker",["require","exports","module","ui/viewModels/experience/avatarFilePicker","constants/components","text!views/experience/avatarFilePicker.html"],(function(e,t){var n=e("ui/viewModels/experience/avatarFilePicker")
	t.name=e("constants/components").experience.AVATAR_FILE_PICKER,t.template=e("text!views/experience/avatarFilePicker.html"),t.viewModel={createViewModel:function(e,t){return n.build(e,t.element)}}})),define("ui/viewModels/experience/eduCarousel",["require","exports","module","vendor/knockout","swx-service-locator-instance","swx-constants","experience/settings","swx-i18n","utils/common/localStorage","ui/telemetry/telemetryClient"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("experience/settings"),a=e("swx-i18n").localization,s=e("utils/common/localStorage"),c=e("ui/telemetry/telemetryClient"),l=r.telemetry.eduCarouselEvents
	function u(){var e,t=this,u=i.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.SHOW_EDU_CAROUSEL),d=i.resolve(r.serviceLocator.PUBSUB),p=[{id:"1",name:"conversation",header:a.fetch({key:"splashScreen_eduCarousel_conversation_header"}),text:a.fetch({key:"splashScreen_eduCarousel_conversation_text"})},{id:"2",name:"findFriends",header:a.fetch({key:"splashScreen_eduCarousel_find_friends_header"}),text:a.fetch({key:"splashScreen_eduCarousel_find_friends_text"})}],f="eduCarouselLastSeenId"
	function m(e,t){c.get().sendEvent(o.telemetry.uiTenantToken,e,t||{})}t.isVisible=n.observable(!1),t.itemName=n.observable(),t.itemHeader=n.observable(),t.itemText=n.observable(),t.init=function(){if(u){var e,n,i,r=(e=s.get(f),n=parseInt(e,10),null===e||isNaN(n)?null:n)
	t.showItem(p[null===(i=r)||i===p.length?0:i]),d.subscribe(l.action.HIDE,t.hideCarousel)}},t.showItem=function(n){n&&(t.itemName(n.name),t.itemHeader(n.header),t.itemText(n.text),t.isVisible(!0),e=new Date,m(l.telemetry.START,{displayed:n.name}),s.set(f,n.id))},t.hideCarousel=function(n){t.isVisible(!1),d.unsubscribe(l.action.HIDE,t.hideCarousel),e&&(m(l.telemetry.FINISH,{displayedTimeSeconds:Math.round((new Date-e)/1e3),origin:n}),e=null)},t.dispose=function(){t.isVisible(!1)}}t.build=function(){return new u}})),define("text!views/experience/eduCarousel.html",[],(function(){return'<div data-bind="css: \'EduCarousel-item \' + itemName(), visible: isVisible()">\r\n    <div class="EduCarousel-overlay">\r\n        <div class="EduCarousel-overlay--infoMessage">\r\n            <h1 data-bind="text: itemHeader()"></h1>\r\n            <p data-bind="text: itemText()"></p>\r\n            <div class="spinnerHolder">\r\n                <swx-loading-animation class="spinner white"></swx-loading-animation>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/experience/eduCarousel",["require","exports","module","ui/viewModels/experience/eduCarousel","constants/components","text!views/experience/eduCarousel.html"],(function(e,t){var n=e("ui/viewModels/experience/eduCarousel")
	t.name=e("constants/components").experience.EDUCATIONAL_CAROUSEL,t.template=e("text!views/experience/eduCarousel.html"),t.viewModel={createViewModel:function(){var e=n.build()
	return e.init(),e}}}))
	define("ui/viewModels/experience/teamsAlert",["require","exports","module","experience/settings","swx-constants","swx-service-locator-instance","ui/telemetry/telemetryClient","swx-i18n"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON,r=e("swx-service-locator-instance").default,o=e("ui/telemetry/telemetryClient"),a=e("swx-i18n").localization,s=i.telemetry
	function c(e){var t=this,c=r.resolve(i.serviceLocator.LOCAL_STORAGE)
	if(t.teamsAlertUrl=n.s4bTeamsAlert.notificationUrl,t.closeIconUrl=n.appBaseUrl+"/assets/images/components/teamsMigrated/x.svg",l())switch(t.actionString=a.fetch({key:"owa_default_client_notification_action"}),e.teamsAsDefaultClient()){case i.teamsAsDefaultClient.CHAT_AND_CALLING:t.alertMessage=a.fetch({key:"owa_default_chat_and_calling_client_message"})
	break
	case i.teamsAsDefaultClient.CALLING:t.alertMessage=a.fetch({key:"owa_default_calling_client_message"})
	break
	case i.teamsAsDefaultClient.CHAT:t.alertMessage=a.fetch({key:"owa_default_chat_client_message"})
	break
	default:t.actionString=a.fetch({key:"owa_deprecation_notification_action"}),t.alertMessage=a.fetch({key:"owa_deprecation_notification_message"})}else t.actionString=a.fetch({key:"owa_deprecation_notification_action"}),t.alertMessage=a.fetch({key:"owa_deprecation_notification_message"})
	function l(){return e.teamsAsDefaultClient&&(e.teamsAsDefaultClient()===i.teamsAsDefaultClient.CHAT||e.teamsAsDefaultClient()===i.teamsAsDefaultClient.CALLING||e.teamsAsDefaultClient()===i.teamsAsDefaultClient.CHAT_AND_CALLING)}function u(t,i){var r=i?{action:i}:{},a=s.teamsMigration.EVENT_NAME,c=s.teamsMigration.eventType[t]
	l()&&(a=s.teamsAsDefaultClient.EVENT_NAME,c=s.teamsAsDefaultClient.eventType[t],r.teamsAsDefaultClient=e.teamsAsDefaultClient()),r.type=c,o.get().sendEvent(n.telemetry.uiTenantToken,a,r)}function d(t,n,r,o){var a=+new Date+t
	n&&o.preventDefault(),c.setItem(i.teamsMigration.LOCAL_STORAGE_KEY,a),u("ALERT_CLOSED",r),function(){e.showTeamsAlert&&e.showTeamsAlert(!1)
	e.canShowInformationalMessage&&e.showInformationalMessage&&e.showInformationalMessage(!0)
	e.teamsAsDefaultClient&&e.teamsAsDefaultClient(i.teamsAsDefaultClient.NONE)}()}t.init=function(e){(function(e){var t=e.querySelector(i.teamsMigration.TEAMS_ALERT_ACTION_CLASS),n=e.querySelector(i.teamsMigration.TEAMS_ALERT_HIDE_NOTIFICATION_CLASS)
	t.addEventListener("click",d.bind(null,i.teamsMigration.EXPIRATION_MULTIPLIER_NEVER,!1,s.teamsMigration.eventAction.CLICK_CTA)),n.addEventListener("click",d.bind(n,i.teamsMigration.EXPIRATION_MULTIPLIER_24H,!0,s.teamsMigration.eventAction.CLOSE_ALERT))})(e),u("ALERT_DISPLAYED")}}t.build=function(e){return new c(e)}})),define("text!views/experience/teamsAlert.html",[],(function(){return'<a href="" class="TeamsAlert-hide">\r\n    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">\r\n        <title>2_out</title>\r\n        <path d="M19.64,5.063a.768.768,0,0,1-.211.527l-6.363,6.363,6.363,6.363a.768.768,0,0,1,.211.527.76.76,0,0,1-.75.75.768.768,0,0,1-.527-.211L12,13.02,5.636,19.384a.768.768,0,0,1-.527.211.76.76,0,0,1-.75-.75.768.768,0,0,1,.211-.527l6.363-6.363L4.57,5.591a.768.768,0,0,1-.211-.527.76.76,0,0,1,.75-.75.768.768,0,0,1,.527.211L12,10.887l6.363-6.363a.768.768,0,0,1,.527-.211.76.76,0,0,1,.75.75Z"/>\r\n    </svg>\r\n</a>\r\n<div class="TeamsAlert-messageContainer">\r\n    <span class="TeamsAlert-message" data-bind="text: alertMessage"></span>\r\n    <a target="_blank" class="TeamsAlert-action" data-bind="attr: { href: teamsAlertUrl }, text: actionString"></a>\r\n</div>'})),define("ui/components/experience/teamsAlert",["require","exports","module","ui/viewModels/experience/teamsAlert","constants/components","text!views/experience/teamsAlert.html"],(function(e,t){var n=e("ui/viewModels/experience/teamsAlert")
	t.name=e("constants/components").experience.TEAMS_ALERT,t.template=e("text!views/experience/teamsAlert.html"),t.viewModel={createViewModel:function(e,t){var i=n.build(e)
	return i.init(t.element),i}}})),define("ui/viewModels/experience/teamsMigrated",["require","exports","module","experience/settings","swx-constants","ui/telemetry/telemetryClient"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON,r=e("ui/telemetry/telemetryClient"),o=i.telemetry
	function a(){var e=this
	e.teamsMigratedUrl=n.s4bTeamsAlert.migartedUrl,e.init=function(){r.get().sendEvent(n.telemetry.uiTenantToken,o.teamsMigration.EVENT_NAME,{type:o.teamsMigration.eventType.MIGRATION_UI_SHOWN})},e.clickCta=function(){return r.get().sendEvent(n.telemetry.uiTenantToken,o.teamsMigration.EVENT_NAME,{type:o.teamsMigration.eventType.MIGRATION_UI_ACTION_INVOKED}),!0}}t.build=function(e){return new a(e)}})),define("text!views/experience/teamsMigrated.html",[],(function(){return'<span class="TeamsMigrated-message" data-bind="l10n: { \'key\': \'owa_deprecation_header\' }"></span>\r\n<div class="TeamsMigrated-image"></div>\r\n<span class="TeamsMigrated-body" data-bind="l10n: { \'key\': \'owa_deprecation_body\' }"></span>\r\n<a target="_blank" class="TeamsMigrated-action" data-bind="click: clickCta, attr: { href: teamsMigratedUrl }, l10n: { \'key\': \'owa_deprecation_action\' }"></a>\r\n'})),define("ui/components/experience/teamsMigrated",["require","exports","module","ui/viewModels/experience/teamsMigrated","constants/components","text!views/experience/teamsMigrated.html"],(function(e,t){var n=e("ui/viewModels/experience/teamsMigrated")
	t.name=e("constants/components").experience.TEAMS_MIGRATED,t.template=e("text!views/experience/teamsMigrated.html"),t.viewModel={createViewModel:function(){var e=n.build()
	return e.init(),e}}})),define("ui/components/experience/index",["require","ui/components/experience/button","ui/components/experience/loadingAnimation","ui/components/experience/radioButton","ui/components/experience/searchInput","ui/components/experience/searchResults","ui/components/experience/selectBox","ui/components/experience/toggleButton","ui/components/experience/avatarFilePicker","ui/components/experience/eduCarousel","ui/components/experience/teamsAlert","ui/components/experience/teamsMigrated"],(function(e){return[e("ui/components/experience/button"),e("ui/components/experience/loadingAnimation"),e("ui/components/experience/radioButton"),e("ui/components/experience/searchInput"),e("ui/components/experience/searchResults"),e("ui/components/experience/selectBox"),e("ui/components/experience/toggleButton"),e("ui/components/experience/avatarFilePicker"),e("ui/components/experience/eduCarousel"),e("ui/components/experience/teamsAlert"),e("ui/components/experience/teamsMigrated")]})),define("ui/components/registrar",["require","exports","module","vendor/knockout"],(function(e,t){var n=e("vendor/knockout")
	t.register=function(e){e.forEach((function(e){n.components.isRegistered(e.name)||n.components.register(e.name,e)}))}})),define("experience/components/experience",["require","exports","module","swx-constants","swx-service-locator-instance","ui/controls/experience/sidebar","ui/controls/experience/content","ui/components/experience/index","ui/components/registrar"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("ui/controls/experience/sidebar"),o=e("ui/controls/experience/content"),a=e("ui/components/experience/index"),s=e("ui/components/registrar")
	t.init=function(e){var t=i.resolve(n.serviceLocator.CONTROLS_BUILDER)
	t.register(o),t.register(r),s.register(a),e()}})),define("text!views/people/avatar.html",[],(function(){return'<div role="button" class="Avatar" data-bind="css: containerClass, attr: {tabindex: tabindex}">\r\n    <img class="Avatar-image" data-bind="fallBackOnDefaultAvatarOnError: avatarUrl, isPstn: isPstn, isGroupAvatar: isGroupAvatar, displayName: displayName, useDefaultAvatar: useDefaultAvatar" alt="" aria-hidden="true" role="presentation">\r\n</div>\r\n'})),define("utils/common/ko",["require","exports","module","vendor/knockout","lodash-compat","swx-utils-common"],(function(e,t){var n=e("vendor/knockout"),i=e("lodash-compat"),r=e("swx-utils-common").array
	function o(e,t){return t(e()),e.subscribe(t)}function a(e,t,n){var r=i.isFunction(t)?t:function(e){return e===t},a=!1,s={dispose:function(){a=!0}}
	return s=o(e,(function(e){r(e)&&n.call(s,e)})),a&&s.dispose(),s}t.disposeAndClearArray=function(e){var t=e()
	t.forEach((function(e){e.dispose&&e.dispose()})),t.splice(0)},t.wrapObservable=function(e){return null===e||i.isUndefined(e)?n.observable():n.isObservable(e)?e:n.observable(e)},t.changed=o,t.when=a,t.once=function(e,t,n){return a(e,t,(function(e){this.dispose(),n(e)}))},t.handleArrayChanges=function(e,t,n,i){var o,a,s,c,l=0,u=[]
	function d(t){var i
	t.moved>=0?(i=t.value,a=u.filter((function(e){return e.key===i}))[0],r.insertAt(e,t.index,a?a.value:e[t.moved+l])):n(t.index,t.value),l++}n=n||r.insertAt.bind(null,e),i=i||r.removeFrom.bind(null,e)
	for(var p=0;p<t.length;p++)"added"===(o=t[p]).status?d(o):(c=void 0,c=(s=o).index+l,s.moved>=0&&u.push({key:s.value,value:e[c]}),i(c,s.value),l--)}})),define("ui/viewModels/people/avatar",["require","vendor/knockout","utils/common/ko","lodash-compat","swx-constants","constants/cssClasses","swx-service-locator-instance","swx-utils-common","swx-utils-common"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/ko"),i=e("lodash-compat"),r=e("swx-constants").COMMON,o=e("constants/cssClasses").avatar,a=e("swx-service-locator-instance").default,s=e("swx-utils-common").stringUtils,c=e("swx-utils-common").url
	return function(e){var l=this,u=t.utils.unwrapObservable(e.isAgent),d=e.status||i.noop,p=e.isSelected||i.noop,f=e.isFullSize||!1,m=e.size,h=a.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.AVATAR_SERVICE_SUPPORTS_SIZE_PARAMETER)
	function v(e){return o.AVATAR_PRESENCE+" "+o.AVATAR+"--"+e}l.isPstn=n.wrapObservable(e.isPstn),l.isGroupAvatar=n.wrapObservable(e.isGroupAvatar),l._avatar=n.wrapObservable(e.avatar),l.avatarUrl=t.computed((function(){var t,n=l._avatar()||""
	"number"!=typeof e.size&&(e.size=s.tryParseInt(e.size,0))
	if(n&&h)return t=e.isFullSize?"l":function(e){var t="s"
	e>=256?t="l":e>96&&(t="m")
	return t}(e.size),c.appendQueryParameter(n,"size",t)
	return n})),l.tabindex=e.tabindex||"",l.displayName=n.wrapObservable(e.displayName),l.useDefaultAvatar=n.wrapObservable(void 0!==e.useDefaultAvatar&&e.useDefaultAvatar),l.useAbsolutePosition=n.wrapObservable(e.useAbsolutePosition),l.containerClass=t.computed((function(){return i.filter([m&&o.AVATAR_SIZE+m,l.isGroupAvatar()&&o.AVATAR_GROUP,u&&o.AVATAR_AGENT,f&&o.AVATAR_FULL_SIZE,l.isPstn()&&o.AVATAR_PSTN,d()&&v(d()),p()&&o.AVATAR_SELECTED,l.useDefaultAvatar()&&o.AVATAR_USE_DEFAULT,l.useAbsolutePosition()&&o.AVATAR_ABSOLUTE],i.isString).join(" ")})),l.dispose=function(){l.containerClass.dispose(),l.avatarUrl.dispose()}}})),define("ui/components/people/avatar",["require","exports","module","constants/components","text!views/people/avatar.html","ui/viewModels/people/avatar"],(function(e,t){t.name=e("constants/components").people.AVATAR,t.template=e("text!views/people/avatar.html"),t.viewModel=e("ui/viewModels/people/avatar")})),define("text!views/people/avatarDeprecated.html",[],(function(){return'<span class="tile" data-bind="css: containerClass">\r\n    <span role=\'button\' class="tileAvatar circle" data-bind="css: presenceClass">\r\n        <span class="tileImage" data-bind="css: {agent: isAgent, pstn: isPstn}">\r\n            <img data-bind="fallBackOnDefaultAvatarOnError: avatarUrl, isPstn: isPstn, isGroupAvatar: isGroupAvatar, displayName: displayName" alt="" aria-hidden="true" role="presentation">\r\n        </span>\r\n    </span>\r\n</span>\r\n'})),define("ui/viewModels/people/avatarDeprecated",["require","vendor/knockout","utils/common/ko","lodash-compat","constants/cssClasses"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/ko"),i=e("lodash-compat"),r=e("constants/cssClasses").avatarDeprecated
	function o(e){return i.isFunction(e)&&!t.isObservable(e)}return function(e){var i=this
	if(o(e.isGroupAvatar)||o(e.status))throw new Error("[AvatarDeprecated] Passing incorrect parameter, did you used property instead of ko observable ?")
	i.isPstn=n.wrapObservable(e.isPstn),i.isGroupAvatar=n.wrapObservable(e.isGroupAvatar),i.isAgent=e.isAgent,i.avatarUrl=n.wrapObservable(e.avatar),i.containerClass=t.computed((function(){var n=(o=e.status,o?t.utils.unwrapObservable(o):"")
	var o
	return i.isGroupAvatar()?r.GROUP_AVATAR:n})),i.presenceClass=t.computed((function(){return i.isGroupAvatar()||e.isCalling?"":r.SHOW_PRESENCE})),i.tabindex=e.tabindex||"",i.displayName=n.wrapObservable(e.displayName),this.dispose=function(){i.containerClass.dispose(),i.presenceClass.dispose()}}})),define("ui/components/people/avatarDeprecated",["require","exports","module","constants/components","text!views/people/avatarDeprecated.html","ui/viewModels/people/avatarDeprecated"],(function(e,t){t.name=e("constants/components").people.AVATAR_DEPRECATED,t.template=e("text!views/people/avatarDeprecated.html"),t.viewModel=e("ui/viewModels/people/avatarDeprecated")})),define("text!views/people/contactListMenuItem.html",[],(function(){return'<p>\r\n\t<a href="#" class="strong MenuItem-link" data-bind="text: text, click: onClick, css: { \'MenuItem-link--selected\': selected }"></a>\r\n</p>'})),define("ui/components/people/contactListMenuItem",["require","exports","module","text!views/people/contactListMenuItem.html","constants/components"],(function(e,t){var n=e("text!views/people/contactListMenuItem.html"),i=e("constants/components")
	t.name=i.people.CONTACT_LIST_MENU_ITEM,t.viewModel={createViewModel:function(e){return e.viewModel}},t.template=n})),define("services/telemetry/common/afterRenderHandler",[],(function(){return function(e,t){var n=0
	return function(){++n===e&&(t(),n=0)}}})),define("ui/viewModels/people/contactListHelper",["require","exports","module","lodash-compat","swx-utils-people","ui/viewModels/people/contactBuilder","ui/modelHelpers/personHelper"],(function(e,t){var n=e("lodash-compat"),i=e("swx-utils-people").organizePersons,r=e("ui/viewModels/people/contactBuilder"),o=e("ui/modelHelpers/personHelper")
	function a(e,t,n){var r=i.getBucketName(t)
	n.contactGroups().some((function(n){if(n.name===r)return n.contacts().some((function(n){if(n.id()===t.id())return n.isActive(e),!0})),!0}))}t.deselectContactFromDefaultList=function(e,t){a(!1,e,t)},t.selectContactFromDefaultList=function(e,t){a(!0,e,t)},t.filterSearchResults=function(e,n){return e.reduce((function(e,i){var o=i.result
	return t.shouldPersonBeIncluded(o,n)?e.concat([r.build(o)]):e}),[])},t.organizeByAlphabet=function(e){return e=e||[],i.byAlphabet(e)},t.setObservablePropertyOnContacts=function(e,i,r){function o(n){t.setObservablePropertyOnContact(e,i,n)}n.isArray(r)&&r.length>0&&(n.isFunction(r[0].contacts)?r.forEach((function(e){e.contacts().forEach(o)})):r.forEach(o))},t.setObservablePropertyOnContact=function(e,t,i){i.hasOwnProperty(e)&&(n.isFunction(t)&&t.bind(i),i[e](t))},t.personExistsInCollection=function(e,t){return!!t&&Boolean(t.filter((function(t){return e.id()===t.id()})).length)},t.shouldPersonBeIncluded=function(e,n){var i=t.personExistsInCollection(e,n),r=o.isEchoContact(e)
	return!i&&!function(e){return e.isBlocked()}(e)&&!r}})),define("ui/contextMenu/menuItem",[],(function(){function e(){}return function(t,n,i){this.type=t,this.label=n,this.action=i||e,this.isEnabled=function(){return!0}}})),define("ui/modelHelpers/groupHelper",["require","exports","module","lodash-compat","swx-cafe-application-instance","ui/modelHelpers/personHelper"],(function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("ui/modelHelpers/personHelper")
	function o(e){return!r.isEchoContact(e)}function a(e){return!r.isAgent(e)}function s(e){return i.get().personsAndGroupsManager.all.uri()===e?i.get().personsAndGroupsManager.all:i.get().personsAndGroupsManager.all.groups(e)}t.getPersonsOtherThanEcho=function(){var e=i.get().personsAndGroupsManager.all.persons()
	return n.filter(e,o)},t.getPersonsOtherThanEchoAndAgents=function(){return n.filter(t.getPersonsOtherThanEcho(),a)},t.getPersonsFromGroup=function(e){var t=s(e)
	return t&&n.isFunction(t.persons)?t.persons():[]},t.isPersonInGroup=function(e,t){var i=s(e)
	return!(!i||!n.isFunction(i.persons))&&!!i.persons(t.id())},t.addPersonToGroup=function(e,t){var i=s(e)
	return i&&n.isFunction(i.persons)?i.persons.add(t,t.id()):Promise.resolve()},t.removePersonFromGroup=function(e,t){var i=s(e)
	return i&&n.isFunction(i.persons)?i.persons.remove(t):Promise.resolve()},t.subscribeToGroup=function(e,t){var i=s(e)
	return i&&n.isFunction(i.persons)?i.persons.changed(t):Promise.resolve()},t.unsubscribeFromGroup=function(e,t){var n=s(e)
	n&&n.persons.changed.off(t)}})),define("ui/telemetry/people/contactInvitation",["require","exports","module","ui/telemetry/people/contactTelemetryHelper","swx-constants"],(function(e,t){var n=e("ui/telemetry/people/contactTelemetryHelper"),i=e("swx-constants").COMMON,r=i.telemetry.performanceMarks.CONTACTS,o=i.telemetry.contactsV2.invitation
	function a(e,t,i){var r=n.getTrace(e),a=(i=i||{},{})
	return a[o.fields.NAME]=t,a[o.fields.SUCCESS]=i.success,n.addIfDefined(a,o.fields.BEGIN_TIMESTAMP,r.startTime),n.addIfDefined(a,o.fields.ELAPSED,r.duration),n.addIfDefined(a,o.fields.RESEND,i.resend),n.addIfDefined(a,o.fields.SOURCE,i.source),a}t.onSendContactRequestStart=function(){n.setStart(r.SEND_REQUEST)},t.onSendContactRequestEnd=function(e){var t=a(r.SEND_REQUEST,o.names.SEND_CONTACT_REQUEST,e)
	n.send(t,o.TYPE)},t.onAcceptContactRequestStart=function(){n.setStart(r.ACCEPT_REQUEST)},t.onAcceptContactRequestEnd=function(e){var t=a(r.ACCEPT_REQUEST,o.names.ACCEPT_CONTACT_REQUEST,e)
	n.send(t,o.TYPE)},t.onDeclineContactRequestStart=function(){n.setStart(r.DECLINE_REQUEST)},t.onDeclineContactRequestEnd=function(e){var t=a(r.DECLINE_REQUEST,o.names.DECLINE_CONTACT_REQUEST,e)
	n.send(t,o.TYPE)}})),define("ui/telemetry/people/contactManagement",["require","exports","module","ui/telemetry/people/contactTelemetryHelper","swx-constants"],(function(e,t){var n=e("ui/telemetry/people/contactTelemetryHelper"),i=e("swx-constants").COMMON,r=i.telemetry.performanceMarks.CONTACTS,o=i.telemetry.contactsV2.contactManagement
	function a(e,t,i){var r=n.getTrace(e),a=(i=i||{},{})
	return a[o.fields.NAME]=t,a[o.fields.SUCCESS]=i.success,n.addIfDefined(a,o.fields.BEGIN_TIMESTAMP,r.startTime),n.addIfDefined(a,o.fields.ELAPSED,r.duration),n.addIfDefined(a,o.fields.CONTACT_TYPE,i.contactType),n.addIfDefined(a,o.fields.SOURCE,i.source),a}t.onRemoveContactStart=function(){n.setStart(r.REMOVE_CONTACT)},t.onRemoveContactEnd=function(e){var t=a(r.REMOVE_CONTACT,o.names.REMOVE_CONTACT,e)
	n.send(t,o.TYPE)},t.onAddContactStart=function(){n.setStart(r.ADD_CONTACT)},t.onAddContactEnd=function(e){var t=a(r.ADD_CONTACT,o.names.ADD_CONTACT,e)
	n.send(t,o.TYPE)}})),define("ui/telemetry/people/contactActions",["require","exports","module","ui/telemetry/people/contactTelemetryHelper","swx-constants"],(function(e,t){var n=e("ui/telemetry/people/contactTelemetryHelper"),i=e("swx-constants").COMMON,r=i.telemetry.performanceMarks.CONTACTS,o=i.telemetry.contactsV2.contactAction
	function a(e,t,i){var r=n.getTrace(e),a=(i=i||{},{})
	return a[o.fields.NAME]=t,a[o.fields.SUCCESS]=i.success,n.addIfDefined(a,o.fields.BEGIN_TIMESTAMP,r.startTime),n.addIfDefined(a,o.fields.ELAPSED,r.duration),n.addIfDefined(a,o.fields.CONTACT_TYPE,i.contactType),n.addIfDefined(a,o.fields.REASON,i.reason),n.addIfDefined(a,o.fields.REPORT_ABUSE,i.reportAbuse),n.addIfDefined(a,o.fields.SOURCE,i.source),a}t.onBlockContactStart=function(){n.setStart(r.BLOCK_CONTACT)},t.onBlockContactEnd=function(e){var t=a(r.BLOCK_CONTACT,o.names.BLOCK_CONTACT,e)
	n.send(t,o.TYPE)},t.onUnblockContactStart=function(){n.setStart(r.UNBLOCK_CONTACT)},t.onUnblockContactEnd=function(e){var t=a(r.UNBLOCK_CONTACT,o.names.UNBLOCK_CONTACT,e)
	n.send(t,o.TYPE)},t.onAddToFavoritesStart=function(){n.setStart(r.ADD_TO_FAVORITES)},t.onAddToFavoritesEnd=function(e){var t=a(r.ADD_TO_FAVORITES,o.names.ADD_TO_FAVORITES,e)
	n.send(t,o.TYPE)},t.onRemoveFromFavoritesStart=function(){n.setStart(r.REMOVE_FROM_FAVORITES)},t.onRemoveFromFavoritesEnd=function(e){var t=a(r.REMOVE_FROM_FAVORITES,o.names.REMOVE_FROM_FAVORITES,e)
	n.send(t,o.TYPE)}})),define("ui/modelHelpers/personActionsHelper",["require","exports","module","lodash-compat","swx-cafe-application-instance","swx-service-locator-instance","swx-constants","swx-enums","utils/common/accessibility","ui/modelHelpers/groupHelper","ui/telemetry/people/contactInvitation","ui/telemetry/people/contactManagement","ui/telemetry/people/contactActions","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("swx-enums"),s=e("utils/common/accessibility").narrator,c=e("ui/modelHelpers/groupHelper"),l=e("ui/telemetry/people/contactInvitation"),u=e("ui/telemetry/people/contactManagement"),d=e("ui/telemetry/people/contactActions"),p=e("experience/settings")
	function f(e){return n.isFunction(e._type)?e._type():void 0}function m(e){return n.isString(e)?e={source:e}:e||(e=e||{}),e}t.blockPerson=function(e,t,i,a,c){var l,u=f(e),p=r.resolve(o.serviceLocator.FEATURE_FLAGS)
	return t=t||{},i=m(i),e.isBlocked.set.enabled()?(d.onBlockContactStart(),(l=p.isFeatureOn(o.featureFlags.USE_BUSINESS_WORDING)?e.isBlocked.set(!0,t.value):e.isBlocked.set(!0,t)).then((function(){s.announce({key:"accessibility_contact_blocked_success"}),n.isFunction(a)&&a()
	d.onBlockContactEnd({success:!0,contactType:u,reason:t.reason,reportAbuse:t.value,source:i.source})}),(function(){s.announce({key:"accessibility_contact_blocked_failure"}),n.isFunction(c)&&c()
	d.onBlockContactEnd({success:!1,contactType:u,reason:t.reason,reportAbuse:t.value,source:i.source})}))):l=Promise.resolve(!0),l},t.unblockPerson=function(e,t,i,r){var o,a=f(e)
	return t=m(t),e.isBlocked.set.enabled()?(d.onUnblockContactStart(),(o=e.isBlocked.set(!1)).then((function(){s.announce({key:"accessibility_contact_unblocked_success"}),n.isFunction(i)&&i()
	d.onUnblockContactEnd({success:!0,source:t.source,contactType:a})}),(function(){s.announce({key:"accessibility_contact_unblocked_failure"}),n.isFunction(r)&&r()
	d.onUnblockContactEnd({success:!1,source:t.source,contactType:a})}))):o=Promise.resolve(),o},t.removePerson=function(e,t,r,o){var a,c=f(e),l=i.get().personsAndGroupsManager.all
	return t=m(t),u.onRemoveContactStart(),(a=l.persons.remove(e.id())).then((function(){s.announce({key:"accessibility_contact_deleted_success"}),n.isFunction(r)&&r()
	u.onRemoveContactEnd({success:!0,source:t.source,contactType:c})}),(function(){s.announce({key:"accessibility_contact_deleted_failure"}),n.isFunction(o)&&o()
	u.onRemoveContactEnd({success:!1,source:t.source,contactType:c})})),a},t.addPerson=function(e,t,c,d,h,v){var g,y,b=f(e),_=!!b&&"8"===b,E=r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.ENABLE_BUSINESS_CONTACT_MANAGEMENT),w=!1
	switch(d=m(d),t){case a.activityType.ContactRequestOutgoingResend:w=!0
	case a.activityType.ContactRequestOutgoing:case a.activityType.ContactRequestOutgoingAgent:case a.activityType.ContactRequestOutgoingPSTN:case a.activityType.SuggestedContact:u.onAddContactStart(),_&&l.onSendContactRequestStart(),g=function(e){u.onAddContactEnd({success:e,contactType:b,source:d.source}),_&&l.onSendContactRequestEnd({success:e,resend:w,source:d.source})}
	break
	case a.activityType.ContactRequestIncoming:l.onAcceptContactRequestStart(),g=function(e){l.onAcceptContactRequestEnd({success:e,source:d.source})}}return y=E?function(e,t){var n,r,o=i.get().personsAndGroupsManager.all.groups
	return n=new Promise((function(t,n){o.get().then((function(i){(r=i.filter((function(e){return e.name()===p.defaultBusinessContactsGroup}))).length>0?c(r[0],e,t,n):s(e,t,n)}),n)})),n
	function s(e,t,n){var r
	function a(i){i.name()===p.defaultBusinessContactsGroup&&(o.added.off(a),c(i,e,t,n))}(r=i.get().personsAndGroupsManager.createGroup()).name.set(p.defaultBusinessContactsGroup),o.add(r).then((function(){o.added(a)}),n)}function c(e,n,i,r){e.persons.add(n.id()).then((function(){t&&(t.historyService.removeCustomActivityItem(a.activityType.ContactRequestOutgoing),t.historyService.removeCustomActivityItem(a.activityType.ContactRequestIsNowContact),t.historyService.addCustomActivityItem(a.activityType.ContactRequestIsNowContact,{sender:n})),i()}),r)}}(e,c):i.get().personsAndGroupsManager.all.persons.add(e,e.id(),void 0,t),y.then((function(){var i="accessibility_contact_request_sent_success"
	E||e.activity._set(void 0)
	t===a.activityType.ContactRequestIncoming&&(i="accessibility_contact_request_accepted_success")
	s.announce({key:i}),n.isFunction(h)&&h()
	n.isFunction(g)&&g(!0)}),(function(){var e="accessibility_contact_request_sent_failure"
	t===a.activityType.ContactRequestIncoming&&(e="accessibility_contact_request_accepted_failure")
	s.announce({key:e}),n.isFunction(v)&&v()
	n.isFunction(g)&&g(!1)})),y},t.declinePerson=function(e,t,r,o,c){var u,d=f(e)
	return r=m(r),l.onDeclineContactRequestStart(),(u=i.get().conversationsManager.conversations.remove(t,a.activityType.ContactRequestIncoming)).then((function(){s.announce({key:"accessibility_contact_request_declined_success"}),n.isFunction(o)&&o()
	l.onDeclineContactRequestEnd({success:!0,source:r.source,contactType:d})}),(function(){s.announce({key:"accessibility_contact_request_declined_failure"}),n.isFunction(c)&&c()
	l.onDeclineContactRequestEnd({success:!1,source:r.source,contactType:d})})),u},t.addFavorite=function(e,t,i,r){var o,l=f(e)
	return t=m(t),d.onAddToFavoritesStart(),(o=c.addPersonToGroup(a.groupType.Favorites,e)).then((function(){s.announce({key:"accessibility_contact_add_favorite_success"}),n.isFunction(i)&&i()
	d.onAddToFavoritesEnd({success:!0,source:t.source,contactType:l})}),(function(){s.announce({key:"accessibility_contact_add_favorite_failure"}),n.isFunction(r)&&r()
	d.onAddToFavoritesEnd({success:!1,source:t.source,contactType:l})})),o},t.removeFavorite=function(e,t,i,r){var o,l=f(e)
	return t=m(t),d.onRemoveFromFavoritesStart(),(o=c.removePersonFromGroup(a.groupType.Favorites,e.id())).then((function(){s.announce({key:"accessibility_contact_remove_favorite_success"}),n.isFunction(i)&&i()
	d.onRemoveFromFavoritesEnd({success:!0,source:t.source,contactType:l})}),(function(){s.announce({key:"accessibility_contact_remove_favorite_failure"}),n.isFunction(r)&&r()
	d.onRemoveFromFavoritesEnd({success:!1,source:t.source,contactType:l})})),o}})),define("ui/viewModels/people/blockContactModal",["require","lodash-compat","vendor/knockout","swx-i18n","utils/common/eventMixin","ui/modalDialog/modalDialog","swx-constants","ui/modelHelpers/personHelper","ui/viewModels/people/properties/displayNameText","ui/modelHelpers/personActionsHelper","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("utils/common/eventMixin"),o=e("ui/modalDialog/modalDialog"),a=e("swx-constants").COMMON,s=e("ui/modelHelpers/personHelper"),c=e("ui/viewModels/people/properties/displayNameText"),l=e("ui/modelHelpers/personActionsHelper"),u=e("swx-service-locator-instance").default,d="swx-overlayBlockContact"
	function p(e,t){var r=this,p=u.resolve(a.serviceLocator.FEATURE_FLAGS),f={value:"spam",name:i.fetch({key:"report_abuse_reason_option_spam"}),description:""},m=[f,{value:"pornography",name:i.fetch({key:"report_abuse_reason_option_pornography"}),description:""},{value:"child-exploitation",name:i.fetch({key:"report_abuse_reason_option_child_exploitation"}),description:""},{value:"harassment",name:i.fetch({key:"report_abuse_reason_option_harassment"}),description:""}]
	function h(){o.hide(d),r.actionsInProgress(!1)}function v(){r.actionsInProgress(!1)}t=t||{},r.isAgent=s.isAgent(e),r.displayName=c.format(e.id(),e.displayName()),r.avatar=e.avatarUrl(),r.reportAbuse=n.observable(!1),r.reportAbuseText=n.computed((function(){var e={key:r.isAgent?"modal_block_agent_text_reportAbuse":"modal_blockContact_text_reportAbuse"}
	return i.fetch(e)})),r.showReportAbuseReason=n.computed((function(){return!p.isFeatureOn(a.featureFlags.USE_BUSINESS_WORDING)&&r.reportAbuse()})),r.reason=n.observable(f),r.reasons=n.observableArray(m),r.actionsInProgress=n.observable(!1),r.cancel=function(){o.hide(d)},r.blockContact=function(){var n={value:r.reportAbuse()}
	return n.value&&(n.reason=r.reason().value),r.actionsInProgress(!0),l.blockPerson(e,n,t,h,v)},r.dispose=function(){r.reportAbuseText.dispose(),r.showReportAbuseReason.dispose()}}return p.ELEMENT_ID=d,t.assign(p.prototype,r),p})),define("text!views/people/blockContactModal.html",[],(function(){return'<div id="swx-overlayBlockContact" class="swx-overlayModal swx-hide" tabindex="-1">\r\n\r\n    <div class="overlayMain">\r\n        <div class="title">\r\n            <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'modal_blockContact_text_title\', params: { displayName: displayName } }"></h1>\r\n        </div>\r\n\r\n        <swx-avatar params="avatar: avatar, isAgent: isAgent, displayName: displayName, size: 160" class="avatar"></swx-avatar>\r\n\r\n        <p class="subtitle" data-bind="l10n: { \'key\': \'modal_blockContact_text_message\', params: { displayName: displayName } }" data-swx-testId="modalBlockContactText"></p>\r\n\r\n        <p class="subtitle ReportAbuse"><label><input type="checkbox" name="reportAbuse" data-bind="checked: reportAbuse"/><strong data-bind="text: reportAbuseText"></strong></label></p>\r\n        \x3c!-- ko if: showReportAbuseReason --\x3e\r\n        <p class="subtitle ReportAbuseReason"><swx-select-box class="SelectBox" params="selectOptions: reasons, selectedOption: reason, placeholderKey: \'select_placeholder_report_abuse_reason\'"></swx-select-box></p>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <div class="dual buttonRow">\r\n            <div class="column alignRight">\r\n                <button type="button" class="btn primary" data-swx-testId="modalBlockContact" data-bind="click: blockContact, disable: actionsInProgress, css: { \'in-progress\': actionsInProgress }, focusHandler: { priority: 1 }"><span data-bind="l10n: { key: \'action_button_block\' }"></span></button>\r\n            </div>\r\n            <div class="column alignLeft">\r\n                <button type="button" class="btn secondary cancel" data-bind="click: cancel, disable: actionsInProgress, css: { \'in-progress\': actionsInProgress }"><span data-bind="l10n: { key: \'action_button_cancel\' }" class="clickable"></span></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'})),define("ui/contextMenu/items/blockContact",["require","swx-i18n","ui/contextMenu/menuItem","ui/modalDialog/modalDialog","ui/viewModels/people/blockContactModal","text!views/people/blockContactModal.html","ui/telemetry/actions/actionSources","constants/cssClasses"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("ui/modalDialog/modalDialog"),r=e("ui/viewModels/people/blockContactModal"),o=e("text!views/people/blockContactModal.html"),a=e("ui/telemetry/actions/actionSources"),s=e("constants/cssClasses")
	function c(e,l){var u
	if(l=l||{source:a.contextMenuItem.block},!e)throw new Error("Parameter missing: contactVM is required")
	u=e.isAgent()?t.fetch({key:"label_text_block_agent"}):t.fetch({key:"label_text_blockContact"}),n.call(this,c.TYPE,u,(function(){var n=new r(e.getPerson(),l)
	i.build(r.ELEMENT_ID,n,o),i.show(r.ELEMENT_ID,e.isAgent()?t.fetch({key:"modal_block_agent_text_aria_label"}):t.fetch({key:"modal_blockContact_text_aria_label"}))})),this.cssClass=s.contextMenu.items.BLOCK_CONTACT,this.isEnabled=function(){return e.getPerson().isBlocked.set.enabled()&&!e.isBlocked()&&!e.isPstn()}}return c.prototype=Object.create(n.prototype),c.TYPE="BlockContactMenuItem",c})),define("ui/contextMenu/items/baseCallingMenuItem",["require","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-enums","ui/viewModels/calling/helpers/callingFacade","ui/modelHelpers/personHelper","swx-cafe-application-instance","ui/modelHelpers/conversationHelper"],(function(e){var t=e("ui/contextMenu/menuItem"),n=e("swx-service-locator-instance").default,i=e("swx-constants").COMMON,r=e("swx-enums"),o=e("ui/viewModels/calling/helpers/callingFacade"),a=e("ui/modelHelpers/personHelper"),s=e("swx-cafe-application-instance"),c=e("ui/modelHelpers/conversationHelper")
	function l(e,l,u,d,p,f){var m,h=this
	t.call(h,e,l,(function(){var e,t
	return function(){var e=n.resolve(i.serviceLocator.ACTION_TELEMETRY)
	f=f||{source:h.getDefaultTelemetrySource()},h.addTelemetryContextData(f),e.recordAction(h.getTelemetryActionName(),f)}(),h.sendFeatureTelemetry(),e=s.get().conversationsManager,t=e.getConversation(m),e.conversations.add(t),function(){return h.setCallingServiceEndpoint(t),o.placeCall(t,h.isVideoCall(),p,!0)}()})),m=d.getPerson(),h.cssClass=u,h.featuresAreEnabled=function(){return!1},h.mePersonHasCallingCapability=function(){return!1},h.conversationHasCallingCapability=function(e){return h.getCallingService(e).start.enabled()},h.personHasSkypeCallingCapability=function(){return!1},h.getCallingService=function(){},h.isVideoCall=function(){return!1},h.getDefaultTelemetrySource=function(){},h.getTelemetryActionName=function(){},h.addTelemetryContextData=function(){},h.sendFeatureTelemetry=function(){},h.setCallingServiceEndpoint=function(e){if(n.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.PSTN_ENABLED)){var t=e.participants(0)
	t.audio.endpoint(t.person.id())}},h.isEnabled=function(){var e,t=c.getExistingConversationWithPerson(m)
	return!(!h.featuresAreEnabled()||a.isGuest(s.get().personsAndGroupsManager.mePerson)||m.isBlocked()||!h.personHasSkypeCallingCapability(m)||n.resolve(i.serviceLocator.MODEL_UI_OBSERVER).conversationsCallStateObserver.activeCalls().length>0)&&(!t||(e=t,!h.getCallingService(e).start.enabled()&&h.getCallingService(e).start.enabled.reason===r.callingNotSupportedReasons.PluginNotInstalled)||h.conversationHasCallingCapability(t)&&h.mePersonHasCallingCapability())}}return l.prototype=Object.create(t.prototype),l}))
	define("ui/contextMenu/items/callSkype",["require","ui/contextMenu/items/baseCallingMenuItem","swx-i18n","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","constants/cssClasses","ui/modelHelpers/personHelper","swx-cafe-application-instance"],(function(e){var t=e("ui/contextMenu/items/baseCallingMenuItem"),n=e("swx-i18n").localization,i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("ui/telemetry/actions/actionSources"),s=e("constants/cssClasses"),c=e("ui/modelHelpers/personHelper"),l=e("swx-cafe-application-instance")
	function u(e,d,p){var f,m,h=this
	f=n.fetch({key:"label_text_call_skype_audio"}),m=s.contextMenu.items.CALL_SKYPE,t.call(h,u.TYPE,f,m,e,d,p),h.featuresAreEnabled=function(){return i.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.CALLING)},h.mePersonHasCallingCapability=function(){return l.get().personsAndGroupsManager.mePerson.capabilities.audio()},h.personHasSkypeCallingCapability=function(e){return!c.isPstn(e)&&e.capabilities.audio()},h.getCallingService=function(e){return e.audioService},h.getDefaultTelemetrySource=function(){return a.contextMenuItem.callSkype},h.getTelemetryActionName=function(){return o.audioVideo.audioCall}}return u.prototype=Object.create(t.prototype),u.TYPE="CallSkypeMenuItem",u})),define("ui/viewModels/people/deleteContactModal",["require","lodash-compat","utils/common/eventMixin","ui/modalDialog/modalDialog","ui/modelHelpers/personActionsHelper","vendor/knockout"],(function(e){var t=e("lodash-compat"),n=e("utils/common/eventMixin"),i=e("ui/modalDialog/modalDialog"),r=e("ui/modelHelpers/personActionsHelper"),o=e("vendor/knockout"),a="swx-overlayDeleteContact"
	function s(e,t){var n=this,s=e.getPerson()
	function c(){n.actionsInProgress(!1),i.hide(a)}function l(){n.actionsInProgress(!1)}t=t||{},n.displayName=e.displayName,n.avatar=e.avatar,n.isAgent=e.isAgent,n.isPstn=e.isPstn,n.actionsInProgress=o.observable(!1),n.cancel=function(){i.hide(a)},n.deleteContact=function(){return n.actionsInProgress(!0),r.removePerson(s,t,c,l)}}return s.ELEMENT_ID=a,t.assign(s.prototype,n),s})),define("text!views/people/deleteContactModal.html",[],(function(){return'<div id="swx-overlayDeleteContact" class="swx-overlayModal swx-hide" tabindex="-1">\r\n\r\n    <div class="overlayMain">\r\n        <div class="title">\r\n            <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'modal_deleteContact_text_title\', params: { displayName: displayName } }"></h1>\r\n        </div>\r\n\r\n        <swx-avatar params="avatar: avatar, isAgent: isAgent, displayName: displayName, isPstn: isPstn, size: 160" class="avatar"></swx-avatar>\r\n\r\n        <p data-bind="l10n: { \'key\': \'modal_deleteContact_text_message\', params: { displayName: displayName } }" data-swx-testId="modalDeleteContactText"></p>\r\n\r\n        <div class="dual buttonRow">\r\n            <div class="column alignRight">\r\n                <button type="button" class="btn primary" data-swx-testId="modalDeleteContact" data-bind="click: deleteContact, disable: actionsInProgress, css: { \'in-progress\': actionsInProgress }, focusHandler: { priority: 1 }"><span data-bind="l10n: { key: \'action_button_delete\' }"></span></button>\r\n            </div>\r\n            <div class="column alignLeft">\r\n                <button type="button" class="btn secondary cancel" data-bind="click: cancel, disable: actionsInProgress, css: { \'in-progress\': actionsInProgress }"><span data-bind="l10n: { key: \'action_button_cancel\' }" class="clickable"></span></button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</div>\r\n'})),define("ui/contextMenu/items/deleteContact",["require","swx-i18n","ui/contextMenu/menuItem","ui/modalDialog/modalDialog","ui/viewModels/people/deleteContactModal","text!views/people/deleteContactModal.html","ui/telemetry/actions/actionSources","constants/cssClasses","ui/modelHelpers/personHelper"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("ui/modalDialog/modalDialog"),r=e("ui/viewModels/people/deleteContactModal"),o=e("text!views/people/deleteContactModal.html"),a=e("ui/telemetry/actions/actionSources"),s=e("constants/cssClasses"),c=e("ui/modelHelpers/personHelper")
	function l(e,u){var d
	if(!e)throw new Error("Parameter missing: contactVM is required")
	u=u||{source:a.contextMenuItem.deleteItem},d=e.isAgent()?t.fetch({key:"label_text_delete_agent"}):t.fetch({key:"label_text_deleteContact"}),n.call(this,l.TYPE,d,(function(){var n=new r(e,u),a=e.isAgent()?t.fetch({key:"modal_delete_agent_text_aria_label"}):t.fetch({key:"modal_deleteContact_text_aria_label"})
	i.build(r.ELEMENT_ID,n,o),i.show(r.ELEMENT_ID,a)})),this.cssClass=s.contextMenu.items.DELETE_CONTACT,this.isEnabled=function(){var t=e.getPerson()
	return c.isKnownPerson(t)&&!c.isOrganizationContact(t)}}return l.prototype=Object.create(n.prototype),l.TYPE="DeleteContactMenuItem",l})),define("ui/contextMenu/items/editMessage",["require","swx-i18n","ui/contextMenu/menuItem","swx-enums","swx-constants"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-enums"),r=e("swx-constants").COMMON.events
	function o(e,a){if(!e||!a)throw new Error("Parameter missing: context and message are required")
	var s=t.fetch({key:"chatLogmenuItem_text_edit"})
	n.call(this,o.TYPE,s,(function(){e.dispatchEvent(r.message.EDIT,a,e.DIRECTION.PARENT)})),this.isEnabled=function(){var e=a.status()===i.activityStatus.Succeeded,t=a.html&&a.html.set.enabled()&&a.text&&a.type()!==i.activityType.SystemMessage,n=a._isSMS&&a._isSMS()
	return!!e&&!!t&&!n}}return o.prototype=Object.create(n.prototype),o.TYPE="EditMessageMenuItem",o})),define("text!views/ui/modalDialog/confirmationDialog.html",[],(function(){return'<div id="swx-overlayConfirmationDialog" class="swx-overlayModal swx-hide" tabindex="-1">\r\n     <div class="overlayMain">\r\n        <div class="title">\r\n            <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="text:title"></h1>\r\n        </div>\r\n\r\n        <div id="swx-overlayConfirmationDialog-content" class="content"></div>\r\n\r\n        <div class="dual buttonRow">\r\n            <div class="column alignRight">\r\n                <button type="button" class="btn primary" data-bind="click: _confirm, focusHandler: { priority: 1 }"><span data-bind="text:confirmButtonTitle"></span></button>\r\n            </div>\r\n            <div class="column alignLeft">\r\n                <button type="button" class="btn secondary cancel" data-bind="click: _cancel"><span data-bind="text:cancelButtonTitle" class="clickable"></span></button>\r\n            </div>\r\n        </div>\r\n     </div>\r\n</div>\r\n'})),define("ui/modalDialog/confirmationDialog",["require","lodash-compat","utils/common/eventMixin","ui/modalDialog/modalDialog","swx-i18n","swx-utils-chat","vendor/knockout","text!views/ui/modalDialog/confirmationDialog.html","browser/dom"],(function(e){var t=e("lodash-compat"),n=e("utils/common/eventMixin"),i=e("ui/modalDialog/modalDialog"),r=e("swx-i18n").localization,o=e("swx-utils-chat").messageSanitizer,a=e("vendor/knockout"),s=e("text!views/ui/modalDialog/confirmationDialog.html"),c=e("browser/dom"),l="swx-overlayConfirmationDialog"
	function u(e){var t=this,n=e.onConfirm,u=e.onCancel
	t.title=o.unboxHrefContent(e.title),t.text=e.text,t.content=e.content,t.contentViewModel=e.contentViewModel,t.avatar=e.avatar,t.confirmButtonTitle=e.confirmButtonTitle||r.fetch({key:"action_button_confirm"}),t.cancelButtonTitle=e.cancelButtonTitle||r.fetch({key:"action_button_cancel"}),t.isGroupConversation=a.observable(e.isGroupConversation||!1),t._cancel=function(){i.hide(l),u&&u()},t._confirm=function(){i.hide(l),n&&n()},t.show=function(){i.build(l,t,s),i.show(l,t.title)
	var e=c.getElementById("swx-overlayConfirmationDialog-content")
	e.innerHTML=t.content,t.contentViewModel&&(a.cleanNode(e),a.applyBindings(t.contentViewModel,e))}}return u.ELEMENT_ID=l,u.build=function(e){return new u(e)},t.assign(u.prototype,n),u})),define("services/telemetry/skypeData",["require","exports","module","swx-log-tracer","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-log-tracer").getLogger(),i=e("experience/settings"),r=e("ui/telemetry/telemetryClient")
	function o(e,t,n){var i="string"==typeof n?n:String(n)
	e[t]=i}function a(e,t,n,i){"object"==typeof i?Object.keys(i).forEach((function(r){a(e,t,n+"_"+r,i[r])})):o(e,n,i)}function s(e,t){var n=e.data||{},i={}
	Object.keys(n).forEach((function(e){a(t,i,e,n[e])}))}function c(e){var t={}
	return s(e,t),function(e,t){var n,i=/([A-Z])/g
	for(n in e.contextIds)e.contextIds.hasOwnProperty(n)&&o(t,n.replace(i,"_$1").toLowerCase(),e.contextIds[n])}(e,t),t}t.push=function(e,t){if(function(e){return e.type?!!e.data||(n.warn("Event "+e.type+" has an empty data payload. This is going to be ignored"),!1):(n.warn("An event was sent with no type defined. This is going to be ignored"),!1)}(e)){t||(t=i.telemetry.uiTenantToken)
	var o=c(e)
	r.get().sendEvent(t,e.type,o)}}})),define("telemetry/chat/leaveConversationTelemetry",["require","exports","module","swx-constants","experience/settings","services/telemetry/skypeData","services/telemetry/common/telemetryContext"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=n.telemetry.leaveConversation,o=e("services/telemetry/skypeData"),a=e("services/telemetry/common/telemetryContext")
	function s(e,t){var s,c,l=this,u=v(),d=n.telemetry.NOT_AVAILABLE,p=a.get()
	function f(){l.data={cta:e||d,action:d,participantsCount:t.participantsCount()||d,statusCode:d,tim:d,ttd:d,lmg:d}}function m(){var e={type:r.TYPE,data:l.data}
	o.push(e,i.telemetry.chatTenantToken),f()}function h(e,t){return t-e}function v(){return(new Date).getTime()}t.historyService._lastMessageFromServer&&(s=t.historyService._lastMessageFromServer.timestamp()),l.started=function(){c=v()},l.canceled=function(){var e=v()
	l.data.action=r.action.CANCELED,l.data.tim=h(u,v()),s&&(l.data.lmg=h(s,e)),m()},l.completed=function(){l.data.action=r.action.CONFIRMED
	var e=v()
	l.data.statusCode=p.statusCode,l.data.tim=h(u,e),s&&(l.data.lmg=h(s,e)),c&&(l.data.ttd=h(c,e)),m()},f()}t.build=function(e,t){return new s(e,t)}})),define("text!views/chat/leaveConversationDialogContent.html",[],(function(){return'<swx-avatar params="avatar: avatar, isAgent: isAgentConversation, isGroupAvatar: isGroupConversation, size: 160" class="avatar"></swx-avatar>\r\n<p data-bind="text:text"></p>\r\n'})),define("ui/modalDialog/leaveConversationDialog",["require","exports","module","swx-i18n","ui/modalDialog/confirmationDialog","swx-constants","swx-service-locator-instance","telemetry/chat/leaveConversationTelemetry","swx-utils-chat","ui/modelHelpers/conversationHelper","text!views/chat/leaveConversationDialogContent.html"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/modalDialog/confirmationDialog"),r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a=e("telemetry/chat/leaveConversationTelemetry"),s=e("swx-utils-chat").messageSanitizer,c=e("ui/modelHelpers/conversationHelper"),l=e("text!views/chat/leaveConversationDialogContent.html")
	function u(e){this.text=function(){var e="leave_conversation_confirmation_text"
	if(p())return n.fetch({key:f(e)})
	return n.fetch({key:e})}(),this.avatar=e.avatarUrl(),this.isGroupConversation=e.isGroupConversation(),this.isAgentConversation=c.isOneToOneConversationWithAgent(e)}function d(e){var t="leave_conversation_confirmation_title",i=n.fetch({key:"conversation_header_topic_untitled_conversation"}),r=e.topic()?s.getSanitizedTopic(e.topic()):i
	return p()?n.fetch({key:f(t)}):n.fetch({key:t,params:{topic:r}})}function p(){return o.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.USE_BUSINESS_WORDING)}function f(e){return e+"_4b"}t.start=function(e,t){var o,s
	o=a.build(function(e){return e||r.telemetry.NOT_AVAILABLE}(t),e),s={title:d(e),content:l,contentViewModel:new u(e),confirmButtonTitle:n.fetch({key:"action_button_leave"}),onConfirm:function(){e.leave.enabled()&&(o.started(),e.leave().finally((function(){o.completed()})))},onCancel:function(){o.canceled()}},i.build(s).show()},t.canLeaveConversation=function(e){return!o.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.DISABLE_LEAVE_CONVERSATION)&&e.leave.enabled()}})),define("ui/contextMenu/items/leaveConversation",["require","swx-i18n","ui/contextMenu/menuItem","ui/modalDialog/leaveConversationDialog","swx-constants"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("ui/modalDialog/leaveConversationDialog"),r=e("swx-constants").COMMON.telemetry.removeConversationHistory.cta
	function o(e){if(!e)throw new Error("Parameter missing: conversation is required")
	var a=t.fetch({key:"recentItemMenuItem_text_leave"})
	n.call(this,o.TYPE,a,(function(){i.start(e,r.TIMELINE_MENU)})),this.isEnabled=function(){return i.canLeaveConversation(e)}}return o.prototype=Object.create(n.prototype),o.TYPE="LeaveConversationMenuItem",o})),define("ui/contextMenu/items/markConversationAsRead",["require","swx-constants","ui/contextMenu/menuItem","swx-i18n","swx-service-locator-instance","experience/settings","ui/telemetry/telemetryClient"],(function(e){var t=e("swx-constants").COMMON,n=e("ui/contextMenu/menuItem"),i=e("swx-i18n").localization,r=e("swx-service-locator-instance").default,o=e("experience/settings"),a=e("ui/telemetry/telemetryClient")
	function s(e){var c=i.fetch({key:"recentItemMenuItem_text_markRead"}),l=e.historyService,u=r.resolve(t.serviceLocator.FEATURE_FLAGS)
	n.call(this,s.TYPE,c,(function(){var n={unreadCount:l.unreadActivityItemsCount(),participantsCount:e.participantsCount()}
	l.markAllAsRead(),function(e){var n=t.telemetry.markConversationAsRead.TYPE
	a.get().sendEvent(o.telemetry.uiTenantToken,n,e)}(n)})),this.isEnabled=function(){return u.isFeatureOn(t.featureFlags.CONTEXT_MENU_MARK_AS_READ_ENABLED)&&l.unreadActivityItemsCount()>0}}return s.prototype=Object.create(n.prototype),s.TYPE="MarkConversationAsReadMenuItem",s})),define("ui/contextMenu/items/markAllConversationsAsRead",["require","swx-constants","ui/contextMenu/menuItem","swx-i18n","swx-cafe-application-instance","swx-service-locator-instance","experience/settings","ui/telemetry/telemetryClient"],(function(e){var t=e("swx-constants").COMMON,n=e("ui/contextMenu/menuItem"),i=e("swx-i18n").localization,r=e("swx-cafe-application-instance"),o=e("swx-service-locator-instance").default,a=e("experience/settings"),s=e("ui/telemetry/telemetryClient")
	function c(e){var l=i.fetch({key:"recentItemMenuItem_text_markAllConversationsRead"}),u=o.resolve(t.serviceLocator.FEATURE_FLAGS),d=r.get().conversationsManager
	n.call(this,c.TYPE,l,(function(){var e={unreadConversationsCount:d._allUnreadConversationsCount()}
	d._allUnreadConversations().map((function(e){return e.id})).forEach((function(e){d._getOrCreateConversation(e).historyService.markAllAsRead()})),function(e){var n=t.telemetry.markAllConversationsAsRead.TYPE
	s.get().sendEvent(a.telemetry.uiTenantToken,n,e)}(e)})),this.isEnabled=function(){return u.isFeatureOn(t.featureFlags.CONTEXT_MENU_MARK_AS_READ_ENABLED)&&d._allUnreadConversationsCount()>0&&(0===e.historyService.unreadActivityItemsCount()||d._allUnreadConversationsCount()>1)}}return c.prototype=Object.create(n.prototype),c.TYPE="MarkAllConversationsAsReadMenuItem",c})),define("ui/contextMenu/items/mutingConversation",["require","exports","module","ui/telemetry/actions/actionNames","swx-constants","ui/contextMenu/menuItem","swx-i18n","swx-service-locator-instance"],(function(e,t){var n=e("ui/telemetry/actions/actionNames"),i=e("swx-constants").COMMON,r=e("ui/contextMenu/menuItem"),o=e("swx-i18n").localization,a=e("swx-service-locator-instance").default
	function s(e){return function(t){this.prototype=Object.create(r.prototype),this.TYPE=e?"MuteConversationMenuItem":"UnmuteConversationMenuItem"
	var s=o.fetch({key:e?"recentItemMenuItem_text_muteConversation":"recentItemMenuItem_text_unmuteConversation"}),c=a.resolve(i.serviceLocator.FEATURE_FLAGS)
	r.call(this,this.TYPE,s,(function(){t.chatService._updateNotificationSettings(!e),a.resolve(i.serviceLocator.ACTION_TELEMETRY).recordAction(e?n.contextMenu.recents.notificationsMuted:n.contextMenu.recents.notificationsUnmuted)})),this.isEnabled=function(){return c.isFeatureOn(i.featureFlags.MUTE_SPECIFIC_CONVERSATIONS_ENABLED)&&t._notificationsEnabled()===e}}}t.MuteConversationMenuItem=s(!0),t.UnmuteConversationMenuItem=s(!1)})),define("ui/contextMenu/items/openConversation",["require","swx-i18n","ui/contextMenu/menuItem","swx-pubsub-instance","swx-constants"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=r.events.navigation
	function a(e){var s=t.fetch({key:"label_text_headerMenuInstantMessage"})
	n.call(this,a.TYPE,s,(function(){i.publish(o.OPEN_CONVERSATION,{model:e,origin:r.telemetry.historyLoadOrigin.ROSTER})}))}return a.prototype=Object.create(n.prototype),a.TYPE="OpenConversationMenuItem",a})),define("ui/contextMenu/items/openConversationWithPerson",["require","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-cafe-application-instance"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("swx-cafe-application-instance")
	function a(e,s){var c=t.fetch({key:"label_text_headerMenuInstantMessage"})
	n.call(this,a.TYPE,c,(function(){var t=i.resolve(r.serviceLocator.PUBSUB),n=o.get().conversationsManager.getConversation(e),a={model:n,origin:s||r.telemetry.historyLoadOrigin.ROSTER}
	t.publish(r.events.navigation.OPEN_CONVERSATION,a),o.get().conversationsManager.conversations.add(n)}))}return a.prototype=Object.create(n.prototype),a.TYPE="OpenConversationWithPersonMenuItem",a})),define("ui/contextMenu/items/viewPersonProfile",["require","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-cafe-application-instance","ui/modelHelpers/personHelper"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("swx-cafe-application-instance"),a=e("ui/modelHelpers/personHelper")
	function s(e,c,l){var u=t.fetch({key:"label_text_view_profile_menu_item"})
	n.call(this,s.TYPE,u,(function(){var t=i.resolve(r.serviceLocator.PUBSUB),n=o.get().conversationsManager.getConversation(e),a={model:n,origin:c,target:{expandProfile:!0},telemetryContext:l}
	t.publish(r.events.navigation.OPEN_CONVERSATION,a),o.get().conversationsManager.conversations.add(n)})),this.isEnabled=function(){return!a.isWelcomeAgent(e)}}return s.prototype=Object.create(n.prototype),s.TYPE="ViewPersonProfileMenuItem",s})),define("telemetry/chat/quoteMessageEvent",["require","experience/settings","ui/telemetry/telemetryClient","swx-log-tracer","swx-constants"],(function(e){var t=e("experience/settings"),n=e("ui/telemetry/telemetryClient"),i=e("swx-log-tracer").getLogger(),r=e("swx-constants").COMMON
	return new function(){var e
	this.publish=function(o,a,s){e=r.events.actions.messageQuoted
	try{var c={source:a,timeInStale:Math.round(((new Date).getTime()-(o&&o.timestamp().getTime()))/1e3),lengthOfQuote:o&&o.text().length,actionSuccess:s}
	n.get().sendEvent(t.telemetry.chatTenantToken,e,c)}catch(l){i.error("Unable to send quote action telemetry: "),i.error(l)}}}})),define("ui/contextMenu/items/quoteMessage",["require","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-enums","telemetry/chat/quoteMessageEvent","ui/telemetry/actions/actionSources"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("swx-enums"),a=e("telemetry/chat/quoteMessageEvent"),s=e("ui/telemetry/actions/actionSources")
	function c(e,l){if(!e||!l)throw new Error("Parameter missing: context and message are required")
	var u=t.fetch({key:"chatLogmenuItem_text_quote"}),d=i.resolve(r.serviceLocator.FEATURE_FLAGS)
	n.call(this,c.TYPE,u,(function(){e.dispatchEvent(r.events.message.QUOTE,l,e.DIRECTION.PARENT),t=s.contextMenuItem.quoteMessage,a.publish(l,t)
	var t})),this.isEnabled=function(){return d.isFeatureOn(r.featureFlags.CONTEXT_MENU_QUOTE_MESSAGES_ENABLED)&&!!l.text&&!l.isDeleted()&&l.type()!==o.activityType.SystemMessage}}return c.prototype=Object.create(n.prototype),c.TYPE="QuoteMessageMenuItem",c})),define("telemetry/translator/translatorTelemetry",["require","exports","module","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("experience/settings"),i=e("ui/telemetry/telemetryClient")
	function r(){this.send=function(e,t){var r=t||{}
	i.get().sendEvent(n.telemetry.chatTenantToken,e,r)}}t.build=function(){return new r}})),define("utils/chat/translatorHelper",["require","exports","module","swx-cafe-application-instance","swx-constants","swx-utils-chat","ui/modelHelpers/personHelper","telemetry/translator/translatorTelemetry","lodash-compat"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-constants").COMMON,r=e("swx-utils-chat").messageSanitizer,o=e("ui/modelHelpers/personHelper"),a=i.telemetry.translator,s=e("telemetry/translator/translatorTelemetry"),c=e("lodash-compat")
	t.extractLanguageKey=function(e){if(e){var t=/original./,n=t.test(e),i=e.replace(t,"")
	return n?i.substring(0,i.lastIndexOf(".")):e}},t.isMatchingMyLanguage=function(e,n){var i=n&&n.isEnabled&&n.meLanguage?n.meLanguage.code:null
	return t.extractLanguageKey(e)===i},t.findMatchingTranslation=function(e,n){var i,r
	return e&&e().length?(c.some(e(),(function(e){return!!(t.isMatchingMyLanguage(e.key,n)&&e.users&&e.users[0]&&e.users[0].value)&&(i=e.users[0].value,!0)})),i||(r=function(e){var t,n=e&&e().length
	if(!n)return null
	return t=c.filter(e(),(function(e){return e.users&&e.users[0]&&o.isMePersonId(e.users[0].mri)})),t.length?t[0]:null}(e),i=r?r.users[0].value:i),i):i},t.requestTranslation=function(e,t,o,c){var l,u,d=n.get(),p=d.translatorService,f=d.personsAndGroupsManager.mePerson.id(),m=s.build(),h=t===i.chat.messageType.OUTGOING,v=h?a.eventType.OUTGOING:a.eventType.INCOMING,g=e,y=h?r.processOutgoingTextMessageForTranslation(e,o):r.processIncomingSanitizedTextMessageForTranslation(e)
	function b(e){"function"==typeof c&&c(e)}h?(u=o._translatorSettings.meLanguage.code,l=o._translatorSettings.participantLanguage.code):l=o._translatorSettings.meLanguage.code,p.translateMessage(u,l,y).then((function(t){var n=r.removeNoTranslateTags(t),i=h?u:l,s=h?r.processOutgoingTextMessage(g,o):n,c={message:h?n:g,translation:{key:i,users:[{value:s,mri:f}]}}
	m.send(v,{action:a.action.TRANSLATE,success:!0,language:l}),b(e!==n?c:{message:g})}),(function(e){var t=e&&e.statusText||"Translator service failed"
	m.send(v,{action:a.action.TRANSLATE,error:t,language:l}),b({message:g})}))}})),define("utils/common/clipboard",[],(function(){var e,t={copyText:n,isCopySupportedByBrowser:function(){var e=!1
	try{e=document.queryCommandSupported("copy")}catch(t){}return e},_reset:function(){t.copyText=n}}
	function n(n){(e=document.createElement("input")).readOnly=!0,e.style.display="none"
	var r=document.getElementById("swxContent1")
	return r?r.appendChild(e):document.body.appendChild(e),t.copyText=i,t.copyText(n)}function i(t){e.style.display="",e.value=t,e.focus(),e.setSelectionRange(0,t.length)
	var n=!1
	try{n=document.execCommand("copy")}catch(i){}return e.style.display="none",n}return t})),define("utils/chat/quoteMessageUtils",["require","exports","module","swx-cafe-application-instance","lodash-compat","swx-encoder","swx-encoder","swx-encoder","swx-utils-chat","swx-utils-chat","utils/chat/translatorHelper","swx-service-locator-instance","swx-constants","utils/common/clipboard"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("lodash-compat"),r=e("swx-encoder"),o=e("swx-encoder").QuoteEncoder,a=e("swx-encoder").QuoteDecoder,s=e("swx-utils-chat").dateTime,c=e("swx-utils-chat").messageSanitizer,l=e("utils/chat/translatorHelper"),u=e("swx-service-locator-instance"),d=e("swx-constants").COMMON,p=e("utils/common/clipboard")
	t.getContentToQuote=function(e){var t=function(e){var t=c.unboxHrefContent(e.text()),n=e.getOriginalContent(),r=c.quotesPresentInXML(n)
	if(""===r)return t
	try{var o=r.replace(/<<</g,"&lt;&lt;&lt;"),a=(new DOMParser).parseFromString(o,"text/xml")
	if(0!==a.getElementsByTagName("parsererror").length)throw new Error("ParserError")
	var s=a.documentElement.getElementsByTagName("legacyquote")
	if(i.isUndefined(s)||2!==s.length||1!==a.childNodes.length||3!==a.childNodes[0].childNodes.length)throw new Error("Bad quotes format error")
	var l=s[0].textContent+a.childNodes[0].childNodes[1].textContent+s[1].textContent
	return l+=n.replace(r,"")}catch(u){return t}}(e),n=l.findMatchingTranslation(e.translations,e.conversation._translatorSettings)
	return u.default.resolve(d.serviceLocator.FEATURE_FLAGS).isFeatureOn(d.featureFlags.TRANSLATOR_SENDING_ENABLED)&&n?c.extractMessageTextContent(n):t},t.getQuotedXmlString=function(e,t,i,a,s){var c=o.build(),l=r.URLDomTransformer.build(),u={author:e,authorName:t,quoteMessage:i,conversationId:a,timestamp:s}
	return r.build(n,{domTransformers:[c,l]}).encode(_stringify(u))},t.getQuotesDisplay=function(e){return r.build(n,{domDecoders:[a.build(s.formatTimestamp)]}).decode(e)},t.copySelectionAsQuote=function(e,t,n){var i=p.copyText(t)
	return n._setMessageCopiedToCache({sourceMessage:e,selectedText:t}),i},t.copyMessageAsQuote=function(e,t){var n=this.getContentToQuote(e),i=p.copyText(n)
	return t._setMessageCopiedToCache({sourceMessage:e}),i}})),define("ui/contextMenu/items/copyMessageMenuItem",["require","swx-constants","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","telemetry/chat/quoteMessageEvent","ui/telemetry/actions/actionSources","swx-enums","utils/chat/quoteMessageUtils","swx-cafe-application-instance","utils/common/clipboard"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("telemetry/chat/quoteMessageEvent"),a=e("ui/telemetry/actions/actionSources"),s=e("swx-enums"),c=e("utils/chat/quoteMessageUtils"),l=e("swx-cafe-application-instance"),u=e("utils/common/clipboard")
	function d(e,p){if(!e||!p)throw new Error("Parameter missing: context and message are required")
	var f=n.fetch({key:"chatLogmenuItem_text_copy"}),m=r.resolve(t.serviceLocator.FEATURE_FLAGS),h=l.get().conversationsManager
	i.call(this,d.TYPE,f,(function(){(function(e){var t=a.contextMenuItem.copyMessage
	o.publish(p,t,e)})(c.copyMessageAsQuote(p,h))})),this.isEnabled=function(){var e=m.isFeatureOn(t.featureFlags.CONTEXT_MENU_COPY_MESSAGES_ENABLED)
	return u.isCopySupportedByBrowser()&&e&&!!p.text&&!p.isDeleted()&&p.type()!==s.activityType.SystemMessage}}return d.prototype=Object.create(i.prototype),d.TYPE="CopyMessageMenuItem",d})),define("ui/contextMenu/items/copySelectionMenuItem",["require","swx-constants","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","telemetry/chat/quoteMessageEvent","ui/telemetry/actions/actionSources","swx-enums","utils/chat/quoteMessageUtils","swx-cafe-application-instance","utils/common/clipboard"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("telemetry/chat/quoteMessageEvent"),a=e("ui/telemetry/actions/actionSources"),s=e("swx-enums"),c=e("utils/chat/quoteMessageUtils"),l=e("swx-cafe-application-instance"),u=e("utils/common/clipboard")
	function d(e,p,f){if(!e||!p||!f)throw new Error("Parameter missing: context, message and textSelection are required")
	var m=n.fetch({key:"chatLogmenuItem_text_copySelection"}),h=r.resolve(t.serviceLocator.FEATURE_FLAGS),v=l.get().conversationsManager
	i.call(this,d.TYPE,m,(function(){(function(e){var t=a.contextMenuItem.copySelection
	o.publish(p,t,e)})(c.copySelectionAsQuote(p,f,v))})),this.isEnabled=function(){var e=h.isFeatureOn(t.featureFlags.CONTEXT_MENU_COPY_MESSAGES_ENABLED)
	return u.isCopySupportedByBrowser()&&e&&!!p.text&&!p.isDeleted()&&p.type()!==s.activityType.SystemMessage}}return d.prototype=Object.create(i.prototype),d.TYPE="CopySelectionMenuItem",d})),define("ui/contextMenu/items/copySelectionTextMenuItem",["require","swx-constants","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","telemetry/chat/quoteMessageEvent","ui/telemetry/actions/actionSources","swx-enums","utils/common/clipboard","swx-cafe-application-instance"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("telemetry/chat/quoteMessageEvent"),a=e("ui/telemetry/actions/actionSources"),s=e("swx-enums"),c=e("utils/common/clipboard"),l=e("swx-cafe-application-instance")
	function u(e,d,p){if(!e||!d||!p)throw new Error("Parameter missing: context, message and textSelection are required")
	var f=n.fetch({key:"chatLogmenuItem_text_copyText"}),m=r.resolve(t.serviceLocator.FEATURE_FLAGS),h=l.get().conversationsManager
	i.call(this,u.TYPE,f,(function(){var e=c.copyText(p)
	h._setMessageCopiedToCache(void 0),function(e){var t=a.contextMenuItem.copySelectionText
	o.publish(d,t,e)}(e)})),this.isEnabled=function(){var e=m.isFeatureOn(t.featureFlags.CONTEXT_MENU_COPY_MESSAGES_ENABLED)
	return c.isCopySupportedByBrowser()&&e&&!!d.text&&!d.isDeleted()&&d.type()!==s.activityType.SystemMessage}}return u.prototype=Object.create(i.prototype),u.TYPE="CopySelectionTextMenuItem",u})),define("telemetry/chat/removeConversationHistoryTelemetry",["require","exports","module","swx-constants","experience/settings","services/telemetry/skypeData","services/telemetry/common/telemetryContext"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=n.telemetry.removeConversationHistory,o=e("services/telemetry/skypeData"),a=e("services/telemetry/common/telemetryContext")
	function s(e,t){var s,c,l=this,u=v(),d=n.telemetry.NOT_AVAILABLE,p=a.get()
	function f(){l.data={cta:e||d,action:d,participantsCount:t.participantsCount()||d,statusCode:d,tim:d,ttd:d,lmg:d}}function m(){var e={type:r.TYPE,data:l.data}
	o.push(e,i.telemetry.chatTenantToken),f()}function h(e,t){return t-e}function v(){return(new Date).getTime()}t.historyService._lastMessageFromServer&&(s=t.historyService._lastMessageFromServer.timestamp()),l.started=function(){c=v()},l.canceled=function(){var e=v()
	l.data.action=r.action.CANCELED,l.data.tim=h(u,e),s&&(l.data.lmg=h(s,e)),m()},l.completed=function(){l.data.action=r.action.CONFIRMED
	var e=v()
	l.data.statusCode=p.statusCode,l.data.tim=h(u,e),s&&(l.data.lmg=h(s,e)),c&&(l.data.ttd=h(c,e)),m()},f()}t.build=function(e,t){return new s(e,t)}})),define("text!views/chat/removeConversationHistoryDialogContent.html",[],(function(){return'<div id="removeConversationHistoryDialogContent">\r\n    <swx-avatar params="avatar: avatar, isAgent: isAgentConversation, isGroupAvatar: isGroupConversation, displayName: topic, size:160" class="avatar"></swx-avatar>\r\n    <p data-bind="text:text"></p>\r\n</div>\r\n'})),define("ui/modalDialog/removeConversationHistoryDialog",["require","exports","module","swx-cafe-application-instance","swx-i18n","ui/modalDialog/confirmationDialog","swx-service-locator-instance","swx-constants","telemetry/chat/removeConversationHistoryTelemetry","text!views/chat/removeConversationHistoryDialogContent.html","ui/modelHelpers/conversationHelper","utils/common/accessibility"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-i18n").localization,r=e("ui/modalDialog/confirmationDialog"),o=e("swx-service-locator-instance").default,a=e("swx-constants").COMMON,s=e("telemetry/chat/removeConversationHistoryTelemetry"),c=e("text!views/chat/removeConversationHistoryDialogContent.html"),l=e("ui/modelHelpers/conversationHelper"),u=e("utils/common/accessibility").narrator
	function d(e){this.text=function(){var e="remove_conversation_confirmation_text"
	if(p())return i.fetch({key:f(e)})
	return i.fetch({key:e})}(),this.avatar=e.avatarUrl(),this.isGroupConversation=e.isGroupConversation(),this.isAgentConversation=l.isOneToOneConversationWithAgent(e),this.topic=e.topic()}function p(){return o.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.USE_BUSINESS_WORDING)}function f(e){return e+"_4b"}function m(){var e="action_button_delete"
	return p()?i.fetch({key:f(e)}):i.fetch({key:e})}t.start=function(e,t){var l,h,v,g,y=n.get().conversationsManager
	function b(){e.historyService.removeAll.enabled()&&(l.started(),u.announce({key:"accessibility_remove_conversation_confirmation"}),e.historyService.removeAll().then((function(){y.conversations.remove(e).finally((function(){l.completed()
	var t={model:e,page:"swx-conversation"}
	h.publish(a.events.navigation.FRAGMENT_REMOVE,t)}))})))}h=o.resolve(a.serviceLocator.PUBSUB),v=o.resolve(a.serviceLocator.FEATURE_FLAGS),l=s.build(t,e),v.isFeatureOn(a.featureFlags.DISABLE_REMOVE_CONVERSATION_CONFIRMATION)?b():r.build({title:(g="remove_conversation_confirmation_title",p()?i.fetch({key:f(g)}):i.fetch({key:g})),content:c,contentViewModel:new d(e),avatar:e.avatarUrl(),onConfirm:b,onCancel:function(){l.canceled()},confirmButtonTitle:m()}).show()},t.canDeleteConversation=function(e){return o.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.REMOVE_CONVERSATION_HISTORY)&&e.historyService.removeAll.enabled()}}))
	define("ui/contextMenu/items/removeConversationHistory",["require","swx-i18n","ui/contextMenu/menuItem","ui/modalDialog/removeConversationHistoryDialog","swx-service-locator-instance","swx-constants"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("ui/modalDialog/removeConversationHistoryDialog"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON
	function a(e){return e+"_4b"}function s(){var e="recentItemMenuItem_text_remove"
	return r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.USE_BUSINESS_WORDING)?t.fetch({key:a(e)}):t.fetch({key:e})}function c(e){if(!e)throw new Error("Parameter missing: conversation is required")
	n.call(this,c.TYPE,s(),(function(){i.start(e,o.telemetry.leaveConversation.cta.TIMELINE_MENU)})),this.isEnabled=function(){return i.canDeleteConversation(e)}}return c.prototype=Object.create(n.prototype),c.TYPE="RemoveConversationHistoryMenuItem",c})),define("ui/contextMenu/items/addGroupConversationToFavorites",["require","experience/settings","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-telemetry-buckets","ui/telemetry/telemetryClient"],(function(e){var t=e("experience/settings"),n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("swx-telemetry-buckets"),s=e("ui/telemetry/telemetryClient")
	function c(e,l){if(!e)throw new Error("Parameter missing: conversation is required")
	i.call(this,c.TYPE,n.fetch({key:"favorites_add_to_favorite"}),(function(){e._isFavorited&&e._isFavorited(!0)
	n="favorite_added",i=e.participantsCount(),r={origin:l||o.telemetry.NOT_AVAILABLE,isGroup:!0,participantCount:i,participantCountGroup:a.getParticipantCountGroup(i)},s.get().sendEvent(t.telemetry.uiTenantToken,n,r)
	var n,i,r})),this.isEnabled=function(){var t=r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.FAVORITES_CONVERSATION_ENABLED),n=!!e._isFavorited&&!e._isFavorited(),i=e.leave.enabled()
	return t&&n&&i}}return c.prototype=Object.create(i.prototype),c.TYPE="AddToFavoritesMenuItem",c})),define("ui/contextMenu/items/addContactToFavorites",["require","lodash-compat","experience/settings","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-telemetry-buckets","ui/modelHelpers/personActionsHelper","ui/modelHelpers/groupHelper","swx-enums","ui/telemetry/telemetryClient"],(function(e){var t=e("lodash-compat"),n=e("experience/settings"),i=e("swx-i18n").localization,r=e("ui/contextMenu/menuItem"),o=e("swx-service-locator-instance").default,a=e("swx-constants").COMMON,s=e("swx-telemetry-buckets"),c=e("ui/modelHelpers/personActionsHelper"),l=e("ui/modelHelpers/groupHelper"),u=e("swx-enums"),d=e("ui/telemetry/telemetryClient")
	function p(e,f){var m
	if(!e)throw new Error("Parameter missing: contact is required")
	m=t.isFunction(e.getPerson)?e.getPerson():e,r.call(this,p.TYPE,i.fetch({key:"favorites_add_to_favorite"}),(function(){c.addFavorite(m),e="favorite_added",t={origin:f||a.telemetry.NOT_AVAILABLE,isGroup:!1,participantCount:1,participantCountGroup:s.getParticipantCountGroup(1)},d.get().sendEvent(n.telemetry.uiTenantToken,e,t)
	var e,t})),this.isEnabled=function(){var e=o.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.FAVORITE_CONTACTS_ENABLED),t=l.isPersonInGroup(u.groupType.Favorites,m),n=l.isPersonInGroup(u.groupType.Root,m)
	return e&&!t&&n}}return p.prototype=Object.create(r.prototype),p.TYPE="AddToFavoritesMenuItem",p})),define("ui/contextMenu/items/removeGroupConversationFromFavorites",["require","experience/settings","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-telemetry-buckets","ui/telemetry/telemetryClient"],(function(e){var t=e("experience/settings"),n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("swx-telemetry-buckets"),s=e("ui/telemetry/telemetryClient")
	function c(e,l){if(!e)throw new Error("Parameter missing: conversation is required")
	i.call(this,c.TYPE,n.fetch({key:"favorites_remove_from_favorite"}),(function(){e._isFavorited&&e._isFavorited(!1)
	n="favorite_removed",i=e.participantsCount(),r={origin:l||o.telemetry.NOT_AVAILABLE,isGroup:!0,participantCount:i,participantCountGroup:a.getParticipantCountGroup(i)},s.get().sendEvent(t.telemetry.uiTenantToken,n,r)
	var n,i,r})),this.isEnabled=function(){var t=r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.FAVORITES_CONVERSATION_ENABLED),n=!!e._isFavorited&&e._isFavorited()
	return t&&n}}return c.prototype=Object.create(i.prototype),c.TYPE="RemoveFromFavoritesMenuItem",c})),define("ui/contextMenu/items/removeContactFromFavorites",["require","lodash-compat","experience/settings","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-telemetry-buckets","ui/modelHelpers/personActionsHelper","ui/modelHelpers/groupHelper","swx-enums","ui/telemetry/telemetryClient"],(function(e){var t=e("lodash-compat"),n=e("experience/settings"),i=e("swx-i18n").localization,r=e("ui/contextMenu/menuItem"),o=e("swx-service-locator-instance").default,a=e("swx-constants").COMMON,s=e("swx-telemetry-buckets"),c=e("ui/modelHelpers/personActionsHelper"),l=e("ui/modelHelpers/groupHelper"),u=e("swx-enums"),d=e("ui/telemetry/telemetryClient")
	function p(e,f){var m
	if(!e)throw new Error("Parameter missing: contact is required")
	m=t.isFunction(e.getPerson)?e.getPerson():e,r.call(this,p.TYPE,i.fetch({key:"favorites_remove_from_favorite"}),(function(){c.removeFavorite(m),e="favorite_removed",t={origin:f||a.telemetry.NOT_AVAILABLE,isGroup:!1,participantCount:1,participantCountGroup:s.getParticipantCountGroup(1)},d.get().sendEvent(n.telemetry.uiTenantToken,e,t)
	var e,t})),this.isEnabled=function(){var e=o.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.FAVORITE_CONTACTS_ENABLED),t=l.isPersonInGroup(u.groupType.Favorites,m),n=l.isPersonInGroup(u.groupType.Root,m)
	return e&&t&&n}}return p.prototype=Object.create(r.prototype),p.TYPE="RemoveFromFavoritesMenuItem",p})),define("ui/contextMenu/items/removeMessage",["require","swx-i18n","ui/contextMenu/menuItem","swx-enums","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","swx-telemetry-buckets","swx-pubsub-instance"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-enums"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=o.events,s=e("ui/telemetry/actions/actionNames"),c=e("ui/telemetry/actions/actionSources"),l=e("swx-telemetry-buckets"),u=e("swx-pubsub-instance").default
	function d(e,p){if(!e)throw new Error("Parameter missing: message is required")
	var f=t.fetch({key:"chatLogmenuItem_text_remove"})
	p=p||{source:c.contextMenuItem.removeMessage},n.call(this,d.TYPE,f,(function(){var t=e.model?e.clientmessageid:e.key()
	e.html(""),p.lifetime=new Date-e.timestamp(),p.timedelta=l.getMessageLifeDurationGroup(new Date-e.timestamp()),p.type=e.type(),r.resolve(o.serviceLocator.ACTION_TELEMETRY).recordAction(s.chat.removeMessage,p),u.publish(a.message.REMOVED,t)})),this.isEnabled=function(){var t=e.status()===i.activityStatus.Succeeded,n=e.html&&e.html.set.enabled()&&!e.isDeleted()&&e.type()!==i.activityType.SystemMessage,r=e._isSMS&&e._isSMS()
	return!!t&&!!n&&!r}}return d.prototype=Object.create(n.prototype),d.TYPE="RemoveMessageMenuItem",d})),define("ui/contextMenu/items/copyLink",["require","utils/common/clipboard","swx-constants","swx-telemetry-buckets","swx-i18n","ui/contextMenu/menuItem","experience/settings","ui/telemetry/telemetryClient","browser/window"],(function(e){var t=e("utils/common/clipboard"),n=e("swx-constants").COMMON,i=e("swx-telemetry-buckets"),r=e("swx-i18n").localization,o=e("ui/contextMenu/menuItem"),a=e("experience/settings"),s=e("ui/telemetry/telemetryClient"),c=e("browser/window")
	function l(e,u,d){if(!e||!u)throw new Error("Parameter missing: context and message are required")
	var p=r.fetch({key:"chatLogmenuItem_copy_link"})
	o.call(this,l.TYPE,p,(function(){t.copyText(f),r="message_urlpreview_copy_link",o=e.conversation.participantsCount(),l=(new c.Date).getTime()-u.timestamp.getTime(),d={tis:l,ttcGroup:i.getMessageLifeDurationGroup(l),participantCount:o,participantCountGroup:i.getParticipantCountGroup(o),contentType:u.copyLinkEnabled()?u.previews()[0].type():n.telemetry.NOT_AVAILABLE},s.get().sendEvent(a.telemetry.uiTenantToken,r,d)
	var r,o,l,d}))
	var f=u.copyLinkEnabled()?u.previews()[0].originalRequest:d&&d.target&&d.target.href
	this.isEnabled=function(){return t.isCopySupportedByBrowser()&&(u.copyLinkEnabled()||!!f)}}return l.prototype=Object.create(o.prototype),l.TYPE="CopyLinkMenuItem",l})),define("ui/contextMenu/items/openLink",["require","swx-constants","swx-telemetry-buckets","swx-focus-handler","swx-i18n","ui/contextMenu/menuItem","experience/settings","ui/telemetry/telemetryClient","browser/window"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-telemetry-buckets"),i=e("swx-focus-handler"),r=e("swx-i18n").localization,o=e("ui/contextMenu/menuItem"),a=e("experience/settings"),s=e("ui/telemetry/telemetryClient"),c=e("browser/window")
	function l(e,u,d){if(!e||!u)throw new Error("Parameter missing: context and message are required")
	var p=r.fetch({key:"chatLogmenuItem_open_link"})
	o.call(this,l.TYPE,p,(function(){var r=c.open(f,"_blank")
	i.get().addFocusRequestToQueue(r),o="message_urlpreview_open_link",l=e.conversation.participantsCount(),d=(new c.Date).getTime()-u.timestamp.getTime(),p={tis:d,ttcGroup:n.getMessageLifeDurationGroup(d),participantCount:l,participantCountGroup:n.getParticipantCountGroup(l),contentType:u.copyLinkEnabled()?u.previews()[0].type():t.telemetry.NOT_AVAILABLE},s.get().sendEvent(a.telemetry.uiTenantToken,o,p)
	var o,l,d,p}))
	var f=u.copyLinkEnabled()?u.previews()[0].originalRequest:d&&d.target&&d.target.href
	this.isEnabled=function(){return u.copyLinkEnabled()||!!f}}return l.prototype=Object.create(o.prototype),l.TYPE="OpenLinkMenuItem",l})),define("ui/contextMenu/items/removeParticipant",["require","swx-i18n","ui/contextMenu/menuItem"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem")
	function i(e,r){if(!e||!r)throw new Error("Parameter missing: conversation and participant are required")
	var o=t.fetch({key:"label_text_headerMenuRemoveGroup"})
	n.call(this,i.TYPE,o,(function(){e.participants.remove(r)})),this.isEnabled=function(){return e.participants.remove.enabled()}}return i.prototype=Object.create(n.prototype),i.TYPE="RemoveParticipantMenuItem",i})),define("ui/contextMenu/items/saveVideoMessage",["require","swx-i18n","browser/dom","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","swx-enums","ui/telemetry/actions/actionNames"],(function(e){var t=e("swx-i18n").localization,n=e("browser/dom"),i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("swx-enums"),s=e("ui/telemetry/actions/actionNames")
	function c(e){if(!e)throw new Error("Parameter missing: message is required")
	var l=t.fetch({key:"chatLogmenuItem_text_save"}),u=r.resolve(o.serviceLocator.FEATURE_FLAGS)
	i.call(this,c.TYPE,l,(function(){t=n.createElement("a"),t.href=e.mediaUrl(),t.click(),r.resolve(o.serviceLocator.ACTION_TELEMETRY).recordAction(s.chat.saveVideoMessage)
	var t})),this.isEnabled=function(){var t=u.isFeatureOn(o.featureFlags.CONTEXT_MENU_SAVE_VIDEO_MESSAGES_ENABLED),n=e.type()===a.activityType.VideoMessage
	return t&&n&&!e.isDeleted()}}return c.prototype=Object.create(i.prototype),c.TYPE="SaveVideoMessageMenuItem",c})),define("telemetry/calling/pstn/pstn",["require","experience/settings","ui/telemetry/telemetryClient","swx-constants"],(function(e){var t=e("experience/settings"),n=e("ui/telemetry/telemetryClient"),i=e("swx-constants").COMMON.telemetry.pstn
	return new function(){function e(e,i){var r={Entry_Point:i}
	n.get().sendEvent(t.telemetry.uiTenantToken,e,r)}this.initiatingPSTNCall=function(t){e(i.eventName.PSTN_CALL_INITIATED,t)},this.addingSubscription=function(t){e(i.eventName.ADD_SUBSCRIPTION,t)},this.addingCredit=function(t){e(i.eventName.ADD_CREDIT,t)},this.updatingCreditBalance=function(e){(function(e,i){var r={Credit_Update_Duration_Seconds:i}
	n.get().sendEvent(t.telemetry.uiTenantToken,e,r)})(i.eventName.CREDIT_BALANCE_UPDATE_CALL_END,e)}}})),define("ui/contextMenu/items/startPSTNCall",["require","ui/contextMenu/items/baseCallingMenuItem","swx-i18n","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","constants/cssClasses","swx-enums","swx-cafe-application-instance","telemetry/calling/pstn/pstn","swx-constants","swx-utils-common","lodash-compat"],(function(e){var t=e("ui/contextMenu/items/baseCallingMenuItem"),n=e("swx-i18n").localization,i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("ui/telemetry/actions/actionSources"),s=e("constants/cssClasses"),c=e("swx-enums"),l=e("swx-cafe-application-instance"),u=e("telemetry/calling/pstn/pstn"),d=e("swx-constants").COMMON.telemetry.pstn,p=e("swx-utils-common").stringUtils,f=e("lodash-compat")
	function m(e,h,v,g){var y,b,_=this
	y=function(e){var t=e.type(),i=p.forceLTREmbedding(e.displayString())
	if(t&&(r=t,o=!1,f.forOwn(c.phoneType,(function(e){e===r&&(o=!0)})),o)&&t!==c.phoneType.Other)return n.fetch({key:"label_text_call_phone_number_"+t.toLowerCase(),params:{phoneNumber:i}})
	var r,o
	return n.fetch({key:"label_text_call_phone_number",params:{phoneNumber:i}})}(h),b=s.contextMenu.items.START_PSTN_CALL,t.call(_,m.TYPE,y,b,e,v,g),_.featuresAreEnabled=function(){return i.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.PSTN_ENABLED)},_.mePersonHasCallingCapability=function(){return l.get().personsAndGroupsManager.mePerson.capabilities.audio()},_.personHasSkypeCallingCapability=function(){return!0},_.getCallingService=function(e){return e.audioService},_.getDefaultTelemetrySource=function(){return a.contextMenuItem.startPSTNCall},_.getTelemetryActionName=function(){return o.audioVideo.pstnCall},_.addTelemetryContextData=function(e){if(!e.phoneNumberType){var t=h.type()||c.phoneType.Other
	e.phoneNumberType=t}},_.setCallingServiceEndpoint=function(e){e.participants(0).audio.endpoint(h.telUri())},_.sendFeatureTelemetry=function(){var e
	g.parent===a.conversation.header.button?e=d.entryPoint.CONVERSATION:g.parent===a.contactsPage.contact?e=d.entryPoint.CONTACT_LIST:g.parent===a.recentItem?e=d.entryPoint.RECENTS:g.parent===a.searchItem.addressBook&&(e=d.entryPoint.SEARCH),u.initiatingPSTNCall(e)}}return m.prototype=Object.create(t.prototype),m.TYPE="StartPSTNCallMenuItem",m})),define("ui/contextMenu/items/unblockContact",["require","swx-i18n","ui/contextMenu/menuItem","swx-cafe-application-instance","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionSources","ui/modelHelpers/personActionsHelper","constants/cssClasses"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-cafe-application-instance"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("ui/telemetry/actions/actionSources"),s=e("ui/modelHelpers/personActionsHelper"),c=e("constants/cssClasses")
	function l(e,u){var d,p,f=r.resolve(o.serviceLocator.PUBSUB)
	if(!e)throw new Error("Parameter missing: contactVM is required")
	p=e.getPerson(),u=u||{source:a.contextMenuItem.unblock},d=e.isAgent()?t.fetch({key:"label_text_unblock_agent"}):t.fetch({key:"label_text_unblockContact"}),n.call(this,l.TYPE,d,(function(){return s.unblockPerson(p,u,(function(){f.publish(o.events.navigation.OPEN_CONVERSATION,{model:i.get().conversationsManager.getConversation(p),origin:o.telemetry.historyLoadOrigin.CONTACT_SEARCH})}))})),this.cssClass=c.contextMenu.items.UNBLOCK_CONTACT,this.isEnabled=function(){return p.isBlocked.set.enabled()&&e.isBlocked()&&!e.isPstn()}}return l.prototype=Object.create(n.prototype),l.TYPE="UnblockContactMenuItem",l})),define("ui/contextMenu/items/videoCall",["require","ui/contextMenu/items/baseCallingMenuItem","swx-i18n","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","constants/cssClasses","swx-cafe-application-instance"],(function(e){var t=e("ui/contextMenu/items/baseCallingMenuItem"),n=e("swx-i18n").localization,i=e("swx-service-locator-instance").default,r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("ui/telemetry/actions/actionSources"),s=e("constants/cssClasses"),c=e("swx-cafe-application-instance")
	function l(e,u,d){var p,f,m=this
	p=n.fetch({key:"label_text_call_skype_video"}),f=s.contextMenu.items.VIDEO_CALL,t.call(m,l.TYPE,p,f,e,u,d),m.featuresAreEnabled=function(){return i.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.CALLING)},m.mePersonHasCallingCapability=function(){return c.get().personsAndGroupsManager.mePerson.capabilities.video()},m.personHasSkypeCallingCapability=function(e){return e.capabilities.video()},m.getCallingService=function(e){return e.videoService},m.isVideoCall=function(){return!0},m.getDefaultTelemetrySource=function(){return a.contextMenuItem.videoCall},m.getTelemetryActionName=function(){return o.audioVideo.videoCall}}return l.prototype=Object.create(t.prototype),l.TYPE="VideoCallMenuItem",l})),define("ui/contextMenu/items/addParticipants",["require","exports","module","swx-i18n","ui/contextMenu/menuItem"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem")
	function r(e,r){var o=n.fetch({key:"actionsMenuItem_text_addParticipants"})
	i.call(this,t.TYPE,o,r),this.isEnabled=function(){return!e()}}r.prototype=Object.create(i.prototype),t.TYPE="AddParticipantsMenuItem",t.build=function(e,t){return new r(e,t)}})),define("ui/modelHelpers/meetingScheduler",["require","exports","module","swx-cafe-application-instance","swx-utils-chat","ui/viewModels/chat/conversationTopic","swx-i18n","swx-constants","experience/settings","swx-service-locator-instance"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-utils-chat").conversation,r=e("ui/viewModels/chat/conversationTopic"),o=e("swx-i18n").localization,a=e("swx-constants").COMMON,s=e("experience/settings"),c=e("swx-service-locator-instance").default
	function l(e){return u([],e)}function u(e,t){var r=n.get().conversationsManager,o=i.createConversation(e,r,!0),a=d(t)
	return o.topic.set.enabled.once(!0,(function(){o.topic.set(a)})),o}function d(e){var t,n
	return e&&0!==e.participants.size()?(n=(t=r.build(e)).topic(),t.dispose(),o.fetch({key:"schedule_call_subject_text",params:{topic:n}})):o.fetch({key:"schedule_call_new_conversation_topic"})}function p(e,t){return t+"\n"+e.uri()}function f(){var e=new Date
	return e.setUTCDate(e.getUTCDate()+7),e}function m(){var e=f()
	return e.setUTCHours(e.getUTCHours()+1),e}function h(e){return e.getUTCFullYear()+"-"+g(e.getUTCMonth()+1)+"-"+g(e.getUTCDate())+"T"+(g(e.getUTCHours())+":"+g(e.getUTCMinutes())+":"+g(e.getUTCSeconds()))}function v(e){var t=e.getUTCFullYear(),n=g(e.getUTCMonth()+1),i=g(e.getUTCDate()),r=g(e.getUTCHours()),o=g(e.getUTCMinutes()),a=g(e.getUTCSeconds()),s=r.toString()+o.toString()+a.toString()
	return t.toString()+n.toString()+i.toString()+"T"+s}function g(e){return("0"+e).slice(-2)}t.generateMeetingUri=function(e,t){var n=function(e){if(!e)return l()
	if(!e.isGroupConversation())return function(e){var t=function(e){var t,n=[]
	if(e)for(t=0;t<e.participants.size();++t)n.push(e.participants(t).person)
	return n}(e)
	return u(t,e)}(e)
	if(e.isJoiningEnabled())return e
	return l(e)}(e)
	return function(e){c.resolve(a.serviceLocator.PUBSUB).publish(a.events.navigation.OPEN_CONVERSATION,{model:e,origin:a.telemetry.historyLoadOrigin.CREATE_CONVERSATION_FOR_SCHEDULED_CALL})}(n),function(e){return new Promise((function(t){e.isJoiningEnabled.set.enabled.once(!0,(function(){e.isJoiningEnabled.set(!0).then((function(){e.uri.get().then(t)}))}))}))}(n).then((function(){return function(e,t,n){var i,r,o
	n?(o=s.legacyCalendarUrl,i=function(e,t){var n=d(t)
	return{summary:n,description:p(e,n),location:n,dtstart:v(f()),dtend:v(m())}}(e,t)):(o=s.calendarUrl,i=function(e,t){var n=d(t)
	return{subject:n,location:n,body:p(e,n),startdt:h(f()),enddt:h(m())}}(e,t))
	return r=Object.keys(i).map((function(e){return e+"="+encodeURIComponent(i[e])})),o+r.join("&")}(n,e,t)}))}})),define("ui/viewModels/chat/scheduleCallModal",["require","exports","module","lodash-compat","vendor/knockout","browser/window","swx-service-locator-instance","utils/common/eventMixin","ui/modalDialog/modalDialog","swx-constants","ui/telemetry/actions/actionNames","ui/modelHelpers/meetingScheduler"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("browser/window"),o=e("swx-service-locator-instance").default,a=e("utils/common/eventMixin"),s=e("ui/modalDialog/modalDialog"),c=e("swx-constants").COMMON,l=e("ui/telemetry/actions/actionNames"),u=e("ui/modelHelpers/meetingScheduler"),d="swx-overlayScheduleCall"
	function p(e){var t,n=this,a=i.observable()
	t=o.resolve(c.serviceLocator.FEATURE_FLAGS).isFeatureOn(c.featureFlags.USE_LEGACY_SCHEDULER_URI_FORMAT),u.generateMeetingUri(e,t).then(a),n.isGeneratingJoinUrl=i.computed((function(){return!a()})),n.goToCalendar=function(){r.open(a(),c.window.BLANK_NAME),o.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(l.scheduleCall.scheduleCallConfirmButton),n.close()},n.close=function(){s.hide(d)}}n.assign(p.prototype,a),t.ELEMENT_ID=d,t.build=function(e){return new p(e)}})),define("text!views/chat/scheduleCallModal.html",[],(function(){return'<div id="swx-overlayScheduleCall" class="overlayScheduleCall" tabindex="-1">\r\n    <div class="overlayControls">\r\n        <div class="right">\r\n            <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n                <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'modal_scheduleCall_close_button\' }"></span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n    <div class="overlayScheduleCallMain">\r\n        <span class="iconfont subscription"></span>\r\n\r\n        \x3c!-- ko if: isGeneratingJoinUrl() --\x3e\r\n        <p class="label" data-bind="l10n: { \'key\': \'modal_scheduleCall_getting_ready_label\' }"></p>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: !isGeneratingJoinUrl() --\x3e\r\n        <p class="label" data-bind="l10n: { \'key\': \'modal_scheduleCall_ready_label\' }"></p>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <div class="row">\r\n            \x3c!-- ko if: isGeneratingJoinUrl() --\x3e\r\n            <div class="swx-spinner blue">\r\n                <div class="circle one">\r\n                    <div class="rotate">\r\n                        <div class="position">\r\n                            <div class="scale">\r\n                                <div class="shape"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="circle two">\r\n                    <div class="rotate">\r\n                        <div class="position">\r\n                            <div class="scale">\r\n                                <div class="shape"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="circle three">\r\n                    <div class="rotate">\r\n                        <div class="position">\r\n                            <div class="scale">\r\n                                <div class="shape"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="circle four">\r\n                    <div class="rotate">\r\n                        <div class="position">\r\n                            <div class="scale">\r\n                                <div class="shape"></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: !isGeneratingJoinUrl() --\x3e\r\n            <button type="button" class="btn primary" data-bind="click: goToCalendar">\r\n                <span data-bind="l10n: { key: \'modal_scheduleCall_create_event_button\' }"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("services/flagsApi/flagsApiService",["require","exports","module","swx-cafe-application-instance","reqwest","experience/settings","browser/window"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("reqwest"),r=e("experience/settings"),o=e("browser/window")
	function a(){this.getAll=function(){return s().then((function(e){var t=c(e,"GET")
	return i.compat(t)}),(function(){return Promise.reject()}))},this.set=function(e){return s().then((function(n){var r=c(n,"PUT",e)
	return i.compat(r).then((function(e){return 201===e.status?Promise.resolve():t()}))})).catch(t)
	function t(){return Promise.reject()}}}function s(){return n.get().signInManager._skypeToken()}function c(e,t,n){var i={url:r.flagsApiUrl,dataType:"json",crossOrigin:!0,headers:{"X-Skypetoken":e}}
	return t&&(i.method=t),n&&(i.url+="/"+o.encodeURIComponent(n)),i}t.build=function(){return new a}})),define("services/flagsApi/flagsApiServiceBusiness",["require","exports","module","swx-constants","swx-pubsub-instance","experience/settings","swx-utils-common"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-pubsub-instance").default,r=e("experience/settings"),o=e("swx-utils-common").sessionStorage
	function a(){var e=[]
	this.getAll=function(){var t=[]
	if(null==r.flags)t=[-1]
	else if(r.flags)try{JSON.parse(r.flags).forEach((function(n){t.push(parseInt(n.split("-")[1])),e.push(n)}))}catch(n){console.warn(n)}else o.get("SkypeFirstRun")||""!==r.flags||(t=[-1])
	return Promise.resolve(t)},this.set=function(t){var a=""
	if(parseInt(t)){o.get("SkypeFirstRun")&&o.remove("SkypeFirstRun"),a=r.version+"/EducationBubble-"+t,e.push(a)
	try{i.publish(n.events.flags.SET_FLAG,_stringify(e))}catch(s){console.error(s)}}}}t.build=function(){return new a}})),define("services/flagsApi/flagsProvider",["require","exports","module","services/flagsApi/flagsApiService","services/flagsApi/flagsApiServiceBusiness"],(function(e,t){var n,i=e("services/flagsApi/flagsApiService"),r=e("services/flagsApi/flagsApiServiceBusiness")
	function o(e){var t,n=[],o=null
	t=e?r.build():i.build(),this.fetchFlags=function(){return o||(o=new Promise((function(e,i){function r(t){n=t,e()}t.getAll().then(r,i)}))),o},this.get=function(t){return function(t){return e?n.indexOf(t)>-1||-1===n[0]:n.indexOf(t)>-1}(t)},this.set=function(e){return n.push(e),t.set(e)}}t.getInstance=function(e){return n||(n=new o(e)),n},t.destroy=function(){n=null}})),define("text!views/ui/educationBubbles.html",[],(function(){return"<div class=\"EducationBubble swx\" data-bind=\"css: { 'EducationBubble--hidden': hidden, 'EducationBubble--orientTop': orientation() === 'TOP', 'EducationBubble--orientLeft': orientation() === 'LEFT', 'EducationBubble--orientRight': orientation() === 'RIGHT' }, attr: { 'data-swx-testId': 'education-bubble-' + id }\">\r\n    <div class=\"EducationBubble-arrow\" data-bind=\"style: { top: arrowTop, bottom: arrowBottom, left: arrowLeft, right: arrowRight }\"></div>\r\n    <div class=\"EducationBubble-content\" data-bind=\"style: { top: top, bottom: bottom, left: left, right: right, backgroundImage: 'url(' + iconUrl + ')' }\">\r\n        <p class=\"EducationBubble-text js-EducationBubble-text\" tabindex=\"-1\" data-bind=\"text: text\" role=\"alert\"></p>\r\n    </div>\r\n</div>\r\n"})),define("text!views/ui/educationBubblesBusiness.html",[],(function(){return'<div class="EducationBubbleBusiness swx" data-bind="css: { \'EducationBubbleBusiness--hidden\': hidden, \'EducationBubbleBusiness--orientTop\': orientation() === \'TOP\', \'EducationBubbleBusiness--orientLeft\': orientation() === \'LEFT\', \'EducationBubbleBusiness--orientRight\': orientation() === \'RIGHT\' }, attr: { \'data-swx-testId\': \'education-bubble-\' + id }">\r\n    <div class="EducationBubbleBusiness-arrow" data-bind="style: { top: arrowTop, bottom: arrowBottom, left: arrowLeft, right: arrowRight }"></div>\r\n    <div class="EducationBubbleBusiness-content" data-bind="style: { top: top, bottom: bottom, left: left, right: right }">\r\n        \x3c!-- ko if: title --\x3e\r\n        <p class="EducationBubbleBusiness-title" tabindex="-1" data-bind="text: title" aria-live="assertive"></p>\r\n        \x3c!-- /ko --\x3e\r\n        <p class="EducationBubbleBusiness-text js-EducationBubbleBusiness-text" tabindex="-1" data-bind="text: text" aria-live="assertive"></p>\r\n        \x3c!-- ko if: buttonText --\x3e\r\n        <button class="EducationBubbleBusiness-button" tabindex="-1" data-bind="click: hideBubble, text: buttonText"></button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</div>\r\n'})),define("utils/common/rtlChecker",["require","exports","module","browser/dom"],(function(e,t){var n=e("browser/dom"),i=null
	t.isRtl=function(e){return null===i&&function(e){e=e||n.getElement("div.swx"),console.assert(!n.isA(e,"ul"),"RTL checking cannot be performed on a ul. Provide element which allows appending div child.")
	var t=document.createElement("div")
	t.style.cssText="position: absolute; visibility: hidden; width: 10px;",t.innerHTML='<span class="probe" style="display: inline-block;"></span>',e.appendChild(t)
	var r=t.querySelector(".probe"),o=t.getBoundingClientRect(),a=r.getBoundingClientRect(),s=o.right===a.right
	t.innerHTML="",e.removeChild(t),i=s}(e),i},t.reset=function(){i=null}})),define("ui/viewModels/educationBubbles/educationBubbleViewModel",["require","exports","module","swx-service-locator-instance","swx-constants","browser/window","browser/document","browser/dom","vendor/knockout","lodash-compat","utils/common/rtlChecker"],(function(e,t){var n=e("swx-service-locator-instance").default,i=e("swx-constants").COMMON,r=e("browser/window"),o=e("browser/document"),a=e("browser/dom"),s=e("vendor/knockout"),c=e("lodash-compat"),l=e("utils/common/rtlChecker"),u="auto",d="px"
	function p(e,p,f,m,h,v){var g,y,b=t.DIMENSIONS_IN_PX,_=function(){return o.documentElement.clientWidth},E=this,w=n.resolve(i.serviceLocator.PUBSUB),S=c.debounce(C,100),x=function(){E.hidden(!0)}
	function C(){if(!E.hidden())switch(v.orientation){case i.educationBubbles.ORIENTATION.TOP:e=Math.ceil(f.getBoundingClientRect().bottom-p.getBoundingClientRect().top),E.bottom(e+b.ARROW_HEIGHT+d),E.arrowBottom(e+d),E.orientation(i.educationBubbles.ORIENTATION.TOP),N()
	break
	case i.educationBubbles.ORIENTATION.LEFT:I()?M():A()?O():T()
	break
	case i.educationBubbles.ORIENTATION.RIGHT:A()?O():I()?M():T()
	break
	default:T()}var e}function T(){var e
	e=Math.floor(p.getBoundingClientRect().bottom-f.getBoundingClientRect().top),E.top(e+b.ARROW_HEIGHT+d),E.arrowTop(e+d),E.orientation(i.educationBubbles.ORIENTATION.BOTTOM),N()}function I(){var e=b.BUBBLE_WIDTH+b.ARROW_HEIGHT
	return p.getBoundingClientRect().left-e>b.OUTER_SPACING}function A(){var e=b.BUBBLE_WIDTH+b.ARROW_HEIGHT
	return p.getBoundingClientRect().right+e<o.documentElement.clientWidth-b.OUTER_SPACING}function M(){var e,t
	k(),e=b.BUBBLE_WIDTH+b.ARROW_HEIGHT,t=p.getBoundingClientRect(),E.left(t.left-e+d),E.right(u),E.arrowLeft(Math.floor(t.left-b.ARROW_HEIGHT/2-b.ARROW_WIDTH/2)+d),E.arrowRight(u),E.orientation(i.educationBubbles.ORIENTATION.LEFT)}function O(){var e
	k(),e=p.getBoundingClientRect(),E.left(e.right+b.ARROW_HEIGHT+d),E.right(u),E.arrowLeft(Math.floor(e.right+b.ARROW_HEIGHT/2-b.ARROW_WIDTH/2)+d),E.arrowRight(u),E.orientation(i.educationBubbles.ORIENTATION.RIGHT)}function k(){var e=Math.floor(p.getBoundingClientRect().bottom-f.getBoundingClientRect().top-p.getBoundingClientRect().height/2)
	E.top(e-b.BUBBLE_MIN_HEIGHT/2+d),E.arrowTop(e+d)}function N(){var e=f.getBoundingClientRect(),t=p.getBoundingClientRect(),n=t.left-e.left+t.width/2,i=b.OUTER_SPACING,r=_(e)-b.BUBBLE_WIDTH-b.OUTER_SPACING,o=Math.max(Math.min(n-b.BUBBLE_WIDTH/2,r),i)
	E.left(Math.floor(o)+d),E.right(u),E.arrowLeft(Math.floor(n-b.ARROW_WIDTH/2)+d),E.arrowRight(u)}v=v||{},E.id=e,E.text=m,E.iconUrl=h,E.hidden=s.observable(!1),E.left=s.observable(),E.right=s.observable(),E.top=s.observable(),E.bottom=s.observable(),E.arrowLeft=s.observable(),E.arrowRight=s.observable(),E.arrowTop=s.observable(),E.arrowBottom=s.observable(),E.orientation=s.observable(),g=E.hidden.subscribe((function(){r.removeEventListener(i.events.browser.RESIZE,S),w.unsubscribe(i.events.narrowMode.SIDEBAR_STATE_CHANGED,x),g.dispose(),y&&y.dispose()})),v.isBusinessFlagService&&(_=function(e){return e.width},function(){E.title=v.title,v.buttonText&&(E.buttonText=v.buttonText,E.hideBubble=E.hidden.bind(null,!0))
	b.OUTER_SPACING=5,b.ARROW_WIDTH=25,b.ARROW_HEIGHT=9,b.BUBBLE_WIDTH=150}()),l.isRtl()&&(v.orientation===i.educationBubbles.ORIENTATION.LEFT?v.orientation=i.educationBubbles.ORIENTATION.RIGHT:v.orientation===i.educationBubbles.ORIENTATION.RIGHT&&(v.orientation=i.educationBubbles.ORIENTATION.LEFT)),C(),r.addEventListener(i.events.browser.RESIZE,S),w.subscribe(i.events.narrowMode.SIDEBAR_STATE_CHANGED,x),v.mutatingContainerElementQuery&&function(e){var t=o.querySelector(e)
	t&&(y=a.createDomObserverSubscription(t,C))}(v.mutatingContainerElementQuery)}t.DIMENSIONS_IN_PX={OUTER_SPACING:15,ARROW_WIDTH:35,ARROW_HEIGHT:9,BUBBLE_WIDTH:288,BUBBLE_MIN_HEIGHT:68},t.build=function(e,t,n,i,r,o){return new p(e,t,n,i,r,o)}})),define("ui/viewModels/experience/welcomeDialog",["require","exports","module","experience/settings"],(function(e,t){var n=e("experience/settings")
	function i(e){this.cookiesPrivacyUrl=n.cookiesPrivacyUrl,this.close=function(){e()}}t.ELEMENT_ID="swx-overlayWelcome",t.build=function(e){return new i(e)}})),define("text!views/experience/welcomeDialog.html",[],(function(){return'<div id="swx-overlayWelcome" class="swx-overlayModal swx-overlayWelcome">\r\n    <div class="title">\r\n        <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { key: \'welcomeDialog_header\' }"></h1>\r\n    </div>\r\n\r\n    <div class="subtitle">\r\n        <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { key: \'welcomeDialog_getInTouch\' }"></p>\r\n    </div>\r\n\r\n    <div class="featureTiles">\r\n        <div class="row">\r\n            <div class="column unit4">\r\n                <span class="iconfont message"></span>\r\n                <div class="text">\r\n                    <p class="fontSize-h3 fontSizeNarrow-p" data-bind="l10n: { key: \'welcomeDialog_sendIM\' }"></p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class="column unit4">\r\n                <span class="iconfont callStart"></span>\r\n                <div class="text">\r\n                    <p class="fontSize-h3 fontSizeNarrow-p" data-bind="l10n: { key: \'welcomeDialog_makeCalls\' }"></p>\r\n                </div>\r\n            </div>\r\n\r\n            <div class="column unit4">\r\n                <span class="iconfont video"></span>\r\n                <div class="text">\r\n                    <p class="fontSize-h3 fontSizeNarrow-p" data-bind="l10n: { key: \'welcomeDialog_makeVideoCalls\' }"></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="buttonRow">\r\n        <button type="btn" class="btn green narrow large close" data-bind="click: close">\r\n            <span data-bind="l10n: { key: \'welcomeDialog_getStarted_button\' }" tabindex="-1"></span>\r\n        </button>\r\n    </div>\r\n\r\n    <div class="legalNotices">\r\n        <div class="emergencyCalling">\r\n            <span class="iconfont callOff"></span>\r\n            <p data-bind="l10n: { key: \'welcomeDialog_notForEmergencyCalls\' }"></p>\r\n        </div>\r\n\r\n        <div class="cookiesNotice">\r\n            <p data-bind="l10n: { key: \'welcomeDialog_cookiesConsent\' }"></p>\r\n            <p><a data-bind="attr: { href: cookiesPrivacyUrl }, l10n: { key: \'welcomeDialog_readMore\' }" target=\'_blank\'></a></p>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/modalDialog/welcomeDialog",["require","exports","module","swx-i18n","swx-constants","swx-service-locator-instance","services/flagsApi/flagsProvider","ui/modalDialog/modalDialog","ui/viewModels/experience/welcomeDialog","text!views/experience/welcomeDialog.html"],(function(e,t){var n=e("swx-i18n").localization,i=e("swx-constants").COMMON,r=e("swx-service-locator-instance").default,o=e("services/flagsApi/flagsProvider"),a=e("ui/modalDialog/modalDialog"),s=e("ui/viewModels/experience/welcomeDialog"),c=e("text!views/experience/welcomeDialog.html")
	function l(){var e=o.getInstance()
	return e.fetchFlags().then((function(){var i,r
	e.get(t.WELCOME_DIALOG_FLAG_ID)||(i=s.build(u),r=n.fetch({key:"welcomeDialog_header"}),a.build(s.ELEMENT_ID,i,c),a.show(s.ELEMENT_ID,r))}))}function u(){var e=o.getInstance()
	a.hide(s.ELEMENT_ID),e.set(t.WELCOME_DIALOG_FLAG_ID)}t.WELCOME_DIALOG_FLAG_ID=1,t.init=function(){r.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.WELCOME_DIALOG)&&r.resolve(i.serviceLocator.PUBSUB).subscribe(i.apiUIEvents.SWX_TIMELINE_LOADED,l)}})),define("ui/educationBubbles/educationBubble",["require","exports","module","lodash-compat","browser/dom","browser/document","vendor/knockout","swx-i18n","swx-constants","constants/cssClasses","swx-constants","swx-utils-common","swx-g11n","swx-service-locator-instance","ui/telemetry/actions/actionNames","experience/settings","services/flagsApi/flagsProvider","text!views/ui/educationBubbles.html","text!views/ui/educationBubblesBusiness.html","ui/viewModels/educationBubbles/educationBubbleViewModel","ui/modalDialog/welcomeDialog"],(function(e,t){var n=e("lodash-compat"),i=e("browser/dom"),r=e("browser/document"),o=e("vendor/knockout"),a=e("swx-i18n").localization,s=e("swx-constants").COMMON,c=e("constants/cssClasses"),l=e("swx-constants").KEYS,u=e("swx-utils-common").async,d=e("swx-g11n").globalization,p=e("swx-service-locator-instance").default,f=e("ui/telemetry/actions/actionNames"),m=e("experience/settings"),h=e("services/flagsApi/flagsProvider"),v=e("text!views/ui/educationBubbles.html"),g=e("text!views/ui/educationBubblesBusiness.html"),y=e("ui/viewModels/educationBubbles/educationBubbleViewModel"),b=e("ui/modalDialog/welcomeDialog")
	function _(e,t,_,E,w){var S,x,C
	function T(e){var t=p.resolve(s.serviceLocator.CONTROLS_BUILDER),o=n.find(t.registeredElements,(function(t){return t.name===e})).element
	return i.isElement(o)||(o=r.querySelector(o)),o}w&&w.isBusinessFlagService?(x=g,S=h.getInstance(w.isBusinessFlagService)):(x=v,S=h.getInstance()),this.show=function(){return S.fetchFlags().then((function(){return!(S.get(e)||(v=p.resolve(s.serviceLocator.FEATURE_FLAGS),!S.get(b.WELCOME_DIALOG_FLAG_ID)&&v.isFeatureOn(s.featureFlags.WELCOME_DIALOG))||(h=w&&w.prerequisiteBubbleIds||[],!n.every(h,(function(e){return S.get(e)}))))&&function(e,t,n,h,v){var g=r.querySelector(t),b=function(e,t){return t&&t.i18nParams?a.fetch({key:e,params:t.i18nParams}):a.fetch({key:e})}(n,v),_=m.appBaseUrl+h
	if(!g)return!1
	return function(e,t,n,a,p){var f=function(e){var t=i.createElement("div"),n=(r=T(m.controls.content.toLowerCase()),o=T(m.controls.sidebar.toLowerCase()),i.findFirstCommonAncestor(r,o))
	var r,o
	t.innerHTML=x,t=t.firstChild,m.mode&&i.addClass(t,c.educationBubbles.PREFIX+m.mode)
	e&&e.size===s.educationBubbles.SIZE.LARGE&&i.addClass(t,c.educationBubbles.LARGE)
	return n.appendChild(t),t}(p),h=f.parentNode
	C=y.build(e,t,h,n,a,p),function(e){var t=function(){e.parentNode.removeChild(e),e.removeEventListener(s.events.browser.TRANSITIONEND,t)}
	e.addEventListener(s.events.browser.TRANSITIONEND,t)}(f),function(e,t){function n(o){i.getLastChildElement(e).contains(o.target)||(t.hidden(!0),r.removeEventListener(s.events.browser.CLICK,n))}u.execute((function(){r.addEventListener(s.events.browser.CLICK,n,!0)}))}(f,C),function(e,t){function n(e){e.keyCode===l.ESCAPE&&(t.hidden(!0),r.removeEventListener(s.events.browser.KEYDOWN,n))}r.addEventListener(s.events.browser.KEYDOWN,n)}(0,C),d.initLocaleDirection(f),o.applyBindings(C,f)}(e,g,b,_,function(e){e&&(e.i18nTitleKey&&(e.title=a.fetch({key:e.i18nTitleKey})),e.i18nButtonKey&&(e.buttonText=a.fetch({key:e.i18nButtonKey})))
	return e}(v)),S.set(e),function(e){p.resolve(s.serviceLocator.ACTION_TELEMETRY).recordAction(f.educationBubbles.educationBubbleShown,{educationBubbleId:e})}(e),!0}(e,t,_,E,w)
	var h,v}))},this.hide=function(){C&&C.hidden(!0)}}t.EDUCATION_BUBBLE_TEXT_ELEMENT_CLASS="js-EducationBubble-text",t.build=function(e,t,n,i,r){return new _(e,t,n,i,r)}})),define("ui/educationBubbles/educationBubbleInfo",["require","exports","module","lodash-compat","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON
	t.SEARCH_EDUCATION_BUBBLE={id:8,anchorElementQuery:".swx .icon .search",i18nKey:"education_bubble_search",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleSearch.svg"},t.SEARCH_EDUCATION_BUBBLE_BUSINESS={id:9,anchorElementQuery:".swx .icon .search",i18nKey:"education_bubble_search_4b",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleSearch.svg",options:{isBusinessFlagService:!0,i18nButtonKey:"education_bubble_gotit_button_4b",i18nTitleKey:"education_bubble_search_title_4b"}},t.CALL_EDUCATION_BUBBLE={id:6,anchorElementQuery:".fragment:not(.hide) .headerMain .headerControls .callButtons button",i18nKey:"education_bubble_call",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleCall.svg",options:{mutatingContainerElementQuery:".fragment:not(.hide) .headerMain"}},t.CHAT_EDUCATION_BUBBLE={id:10,anchorElementQuery:".ContactsPage-body .contactTile:not(.echo)",i18nKey:"education_bubble_chat",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleChat.svg",options:{orientation:i.educationBubbles.ORIENTATION.TOP}},t.CHAT_EDUCATION_BUBBLE_BUSINESS={id:11,anchorElementQuery:".ContactsPage-body .contactTile:not(.echo)",i18nKey:"education_bubble_chat_4b",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleChat.svg",options:{orientation:i.educationBubbles.ORIENTATION.TOP,isBusinessFlagService:!0,i18nButtonKey:"education_bubble_gotit_button_4b",i18nTitleKey:"education_bubble_chat_title_4b"}},t.SCHEDULE_CALL_EDUCATION_BUBBLE_1_GROUP={id:17,anchorElementQuery:".fragment:not(.hide) .headerMain .headerControls .moreActions button",i18nKey:"education_bubble_schedule_call_1_group",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleScheduleCall.svg",options:{prerequisiteBubbleIds:[6],mutatingContainerElementQuery:".fragment:not(.hide) .headerMain",size:i.educationBubbles.SIZE.LARGE}},t.SCHEDULE_CALL_EDUCATION_BUBBLE_1=n.extend({},t.SCHEDULE_CALL_EDUCATION_BUBBLE_1_GROUP,{i18nKey:"education_bubble_schedule_call_1"}),t.SCHEDULE_CALL_EDUCATION_BUBBLE_2_GROUP={id:18,anchorElementQuery:".swxContextMenu .scheduleCallMenuItem",i18nKey:"education_bubble_schedule_call_1_group",iconUrlPath:"/assets/images/components/educationBubbles/educationBubbleScheduleCall.svg",options:{prerequisiteBubbleIds:[17],orientation:i.educationBubbles.ORIENTATION.LEFT}},t.SCHEDULE_CALL_EDUCATION_BUBBLE_2=n.extend({},t.SCHEDULE_CALL_EDUCATION_BUBBLE_2_GROUP,{i18nKey:"education_bubble_schedule_call_1_group"})}))
	define("ui/contextMenu/items/scheduleCall",["require","exports","module","swx-i18n","ui/contextMenu/menuItem","swx-service-locator-instance","swx-constants","constants/cssClasses","ui/telemetry/actions/actionNames","ui/modalDialog/modalDialog","ui/viewModels/chat/scheduleCallModal","text!views/chat/scheduleCallModal.html","ui/educationBubbles/educationBubble","ui/educationBubbles/educationBubbleInfo"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("constants/cssClasses"),s=e("ui/telemetry/actions/actionNames"),c=e("ui/modalDialog/modalDialog"),l=e("ui/viewModels/chat/scheduleCallModal"),u=e("text!views/chat/scheduleCallModal.html"),d=e("ui/educationBubbles/educationBubble"),p=e("ui/educationBubbles/educationBubbleInfo")
	function f(e){var f,m,h=n.fetch({key:"actionsMenuItem_text_scheduleCall"})
	i.call(this,t.TYPE,h,(function(){t=l.build(e),i=n.fetch({key:"modal_scheduleCall_text_aria_label"}),c.build(l.ELEMENT_ID,t,u),c.show(l.ELEMENT_ID,i),r.resolve(o.serviceLocator.ACTION_TELEMETRY).recordAction(s.conversation.scheduleCallButton)
	var t,i})),m=p.SCHEDULE_CALL_EDUCATION_BUBBLE_2,r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.SCHEDULE_CALL_EDUCATION_BUBBLE_2)&&(f=d.build(m.id,m.anchorElementQuery,m.i18nKey,m.iconUrlPath,m.options)).show(),this.cssClass=a.contextMenu.items.SCHEDULE_CALL,this.dispose=function(){f&&f.hide()}}f.prototype=Object.create(i.prototype),t.TYPE="ScheduleCallMenuItem",t.build=function(e){return new f(e)}})),define("ui/contextMenu/items/shareScreen",["require","exports","module","swx-i18n","ui/contextMenu/menuItem"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem")
	function r(e,r,o){var a=n.fetch({key:"callscreen_text_shareScreens"}),s=n.fetch({key:"callscreen_text_stopSharingScreen"})
	i.call(this,t.TYPE,r?a:s,o),this.isEnabled=function(){return!e()}}r.prototype=Object.create(i.prototype),t.TYPE="ShareScreenMenuItem",t.build=function(e,t,n){return new r(e,t,n)}})),define("ui/contextMenu/items/avSettings",["require","exports","module","swx-i18n","ui/contextMenu/menuItem"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem")
	function r(e,r){i.call(this,t.TYPE,n.fetch({key:"callscreen_text_showAVSettings"}),r),this.isEnabled=function(){return!e()}}r.prototype=Object.create(i.prototype),t.TYPE="AVSettingsMenuItem",t.build=function(e,t){return new r(e,t)}})),define("ui/contextMenu/items/transferCall",["require","exports","module","swx-i18n","ui/contextMenu/menuItem"],(function(e,t){var n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem")
	function r(e,r){i.call(this,t.TYPE,n.fetch({key:"callscreen_text_transferCall"}),r),this.isEnabled=function(){return!e()}}r.prototype=Object.create(i.prototype),t.TYPE="AVSettingsMenuItem",t.build=function(e,t){return new r(e,t)}})),define("ui/contextMenu/items/unansweredCallWrap",["require","exports","module","ui/contextMenu/menuItem"],(function(e,t){var n=e("ui/contextMenu/menuItem")
	function i(e,i,r){var o=this
	o.wrappedMenuItem=e,o.actionBefore=r||function(){},n.call(this,t.TYPE,i,(function(){o.actionBefore(),e.action()}))}return i.prototype=Object.create(n.prototype),i.TYPE="UnansweredCallWrapMenuItem",i})),define("ui/contextMenu/items/goToDialPad",["require","swx-i18n","constants/components","swx-constants","ui/contextMenu/menuItem","swx-pubsub-instance"],(function(e){var t=e("swx-i18n").localization,n=e("constants/components"),i=e("swx-constants").COMMON,r=e("ui/contextMenu/menuItem"),o=e("swx-pubsub-instance").default
	function a(e){var s=this
	s.actionBefore=e
	var c=t.fetch({key:"unanswered_call_dial_number"})
	r.call(this,a.TYPE,c,(function(){s.actionBefore(),function(){function e(){return{page:n.calling.SKYPEOUT_PAGE,origin:i.telemetry.historyLoadOrigin.SKYPEOUT_PAGE}}o.publish(i.events.navigation.NAVIGATE,e())}()}))}return a.prototype=Object.create(r.prototype),a.TYPE="GoToDialPadMenuItem",a})),define("ui/contextMenu/items/callParticipant/chat",["require","swx-cafe-application-instance","swx-i18n","ui/contextMenu/menuItem","swx-constants","ui/telemetry/actions/actionNames","swx-service-locator-instance","swx-browser-detect"],(function(e){var t=e("swx-cafe-application-instance"),n=e("swx-i18n").localization,i=e("ui/contextMenu/menuItem"),r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("swx-service-locator-instance").default,s=e("swx-browser-detect").default
	function c(e){if(!e)throw new Error("Parameter missing: person is required")
	var l=n.fetch({key:"callscreen_participantMenu_chat"})
	i.call(this,c.TYPE,l,(function(){n=a.resolve(r.serviceLocator.PUBSUB),i={model:t.get().conversationsManager.getConversation(e)},n.publish(r.events.navigation.OPEN_CONVERSATION,i),n.publish(r.events.narrowMode.SHOW_SIDEBAR),a.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(o.audioVideo.participantMenu.chat)
	var n,i})),this.isEnabled=function(){var e=!a.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.DISABLE_CALLSCREEN_CHAT_OPTION)
	return!s.getBrowserInfo().isShellApp&&e}}return c.prototype=Object.create(i.prototype),c.TYPE="CallParticipantChatMenuItem",c})),define("ui/contextMenu/items/callParticipant/pin",["require","swx-i18n","ui/contextMenu/menuItem","swx-constants","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-constants").COMMON,r=e("ui/telemetry/actions/actionNames"),o=e("swx-service-locator-instance").default
	function a(e,s,c){var l=c?"callscreen_participantMenu_unpin":"callscreen_participantMenu_pin",u=t.fetch({key:l})
	n.call(this,a.TYPE,u,(function(){t=o.resolve(i.serviceLocator.PUBSUB),n={participant:e,isScreenSharing:s,shouldBePinned:!c},t.publish(i.events.callScreen.PINNED_PARTICIPANT_CHANGED,n),o.resolve(i.serviceLocator.ACTION_TELEMETRY).recordAction(r.audioVideo.participantMenu.pin)
	var t,n})),this.isEnabled=function(){return!0}}return a.prototype=Object.create(n.prototype),a.TYPE="CallParticipantPinMenuItem",a})),define("ui/contextMenu/items/callParticipant/zoom",["require","swx-i18n","ui/contextMenu/menuItem","swx-constants","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e){var t=e("swx-i18n").localization,n=e("ui/contextMenu/menuItem"),i=e("swx-constants").COMMON,r=e("ui/telemetry/actions/actionNames"),o=e("swx-service-locator-instance").default
	function a(e,s){var c=e()?"callscreen_participantMenu_zoomOut":"callscreen_participantMenu_zoomIn",l=t.fetch({key:c})
	n.call(this,a.TYPE,l,(function(){s()&&e(!e()),o.resolve(i.serviceLocator.ACTION_TELEMETRY).recordAction(r.audioVideo.participantMenu.zoom)})),this.isEnabled=function(){return!0}}return a.prototype=Object.create(n.prototype),a.TYPE="CallParticipantZoomMenuItem",a})),define("ui/contextMenu/items/all",["require","exports","module","ui/contextMenu/menuItemGroup","ui/contextMenu/items/blockContact","ui/contextMenu/items/callSkype","ui/contextMenu/items/deleteContact","ui/contextMenu/items/editMessage","ui/contextMenu/items/leaveConversation","ui/contextMenu/items/markConversationAsRead","ui/contextMenu/items/markAllConversationsAsRead","ui/contextMenu/items/mutingConversation","ui/contextMenu/items/mutingConversation","ui/contextMenu/items/openConversation","ui/contextMenu/items/openConversationWithPerson","ui/contextMenu/items/viewPersonProfile","ui/contextMenu/items/quoteMessage","ui/contextMenu/items/copyMessageMenuItem","ui/contextMenu/items/copySelectionMenuItem","ui/contextMenu/items/copySelectionTextMenuItem","ui/contextMenu/items/removeConversationHistory","ui/contextMenu/items/addGroupConversationToFavorites","ui/contextMenu/items/addContactToFavorites","ui/contextMenu/items/removeGroupConversationFromFavorites","ui/contextMenu/items/removeContactFromFavorites","ui/contextMenu/items/removeMessage","ui/contextMenu/items/copyLink","ui/contextMenu/items/openLink","ui/contextMenu/items/removeParticipant","ui/contextMenu/items/saveVideoMessage","ui/contextMenu/items/startPSTNCall","ui/contextMenu/items/unblockContact","ui/contextMenu/items/videoCall","ui/contextMenu/items/addParticipants","ui/contextMenu/items/scheduleCall","ui/contextMenu/items/shareScreen","ui/contextMenu/items/avSettings","ui/contextMenu/items/transferCall","ui/contextMenu/items/unansweredCallWrap","ui/contextMenu/items/goToDialPad","ui/contextMenu/items/callParticipant/chat","ui/contextMenu/items/callParticipant/pin","ui/contextMenu/items/callParticipant/zoom"],(function(e,t){t.MenuItemGroup=e("ui/contextMenu/menuItemGroup"),t.BlockContactMenuItem=e("ui/contextMenu/items/blockContact"),t.CallSkypeMenuItem=e("ui/contextMenu/items/callSkype"),t.DeleteContactMenuItem=e("ui/contextMenu/items/deleteContact"),t.EditMessageMenuItem=e("ui/contextMenu/items/editMessage"),t.LeaveConversationMenuItem=e("ui/contextMenu/items/leaveConversation"),t.MarkConversationAsReadMenuItem=e("ui/contextMenu/items/markConversationAsRead"),t.MarkAllConversationsAsReadMenuItem=e("ui/contextMenu/items/markAllConversationsAsRead"),t.MuteConversationMenuItem=e("ui/contextMenu/items/mutingConversation").MuteConversationMenuItem,t.UnmuteConversationMenuItem=e("ui/contextMenu/items/mutingConversation").UnmuteConversationMenuItem,t.OpenConversationMenuItem=e("ui/contextMenu/items/openConversation"),t.OpenConversationWithPersonMenuItem=e("ui/contextMenu/items/openConversationWithPerson"),t.ViewPersonProfileMenuItem=e("ui/contextMenu/items/viewPersonProfile"),t.QuoteMessageMenuItem=e("ui/contextMenu/items/quoteMessage"),t.CopyMessageMenuItem=e("ui/contextMenu/items/copyMessageMenuItem"),t.CopySelectionMenuItem=e("ui/contextMenu/items/copySelectionMenuItem"),t.CopySelectionTextMenuItem=e("ui/contextMenu/items/copySelectionTextMenuItem"),t.RemoveConversationMenuItem=e("ui/contextMenu/items/removeConversationHistory"),t.AddGroupConversationToFavoritesMenuItem=e("ui/contextMenu/items/addGroupConversationToFavorites"),t.AddContactToFavoritesMenuItem=e("ui/contextMenu/items/addContactToFavorites"),t.RemoveGroupConversationFromFavoritesMenuItem=e("ui/contextMenu/items/removeGroupConversationFromFavorites"),t.RemoveContactFromFavoritesMenuItem=e("ui/contextMenu/items/removeContactFromFavorites"),t.RemoveMessageMenuItem=e("ui/contextMenu/items/removeMessage"),t.CopyLinkMenuItem=e("ui/contextMenu/items/copyLink"),t.OpenLinkMenuItem=e("ui/contextMenu/items/openLink"),t.RemoveParticipantMenuItem=e("ui/contextMenu/items/removeParticipant"),t.SaveVideoMessageMenuItem=e("ui/contextMenu/items/saveVideoMessage"),t.StartPSTNCallMenuItem=e("ui/contextMenu/items/startPSTNCall"),t.UnblockContactMenuItem=e("ui/contextMenu/items/unblockContact"),t.VideoCallMenuItem=e("ui/contextMenu/items/videoCall")
	t.AddParticipantsMenuItem=e("ui/contextMenu/items/addParticipants"),t.ScheduleCallMenuItem=e("ui/contextMenu/items/scheduleCall"),t.ShareScreen=e("ui/contextMenu/items/shareScreen"),t.AVSettings=e("ui/contextMenu/items/avSettings"),t.TransferCall=e("ui/contextMenu/items/transferCall"),t.UnansweredCallWrapMenuItem=e("ui/contextMenu/items/unansweredCallWrap"),t.GoToDialPadMenuItem=e("ui/contextMenu/items/goToDialPad"),t.CallParticipantChatMenuItem=e("ui/contextMenu/items/callParticipant/chat"),t.CallParticipantPinMenuItem=e("ui/contextMenu/items/callParticipant/pin"),t.CallParticipantZoomMenuItem=e("ui/contextMenu/items/callParticipant/zoom"),t.itemOrderPriorities={},t.itemOrderPriorities[t.OpenConversationMenuItem.TYPE]={priority:0},t.itemOrderPriorities[t.OpenConversationWithPersonMenuItem.TYPE]={priority:0},t.itemOrderPriorities[t.CallSkypeMenuItem.TYPE]={priority:1},t.itemOrderPriorities[t.StartPSTNCallMenuItem.TYPE]={priority:2,subPriorities:{Cell:{priority:0},Home:{priority:1},Work:{priority:2},Other:{priority:3}}},t.itemOrderPriorities[t.VideoCallMenuItem.TYPE]={priority:3},t.itemOrderPriorities[t.ViewPersonProfileMenuItem.TYPE]={priority:4},t.itemOrderPriorities[t.MuteConversationMenuItem.TYPE]={priority:5},t.itemOrderPriorities[t.UnmuteConversationMenuItem.TYPE]={priority:5},t.itemOrderPriorities[t.BlockContactMenuItem.TYPE]={priority:6},t.itemOrderPriorities[t.UnblockContactMenuItem.TYPE]={priority:7},t.itemOrderPriorities[t.DeleteContactMenuItem.TYPE]={priority:8},t.itemOrderPriorities[t.LeaveConversationMenuItem.TYPE]={priority:9},t.itemOrderPriorities[t.RemoveConversationMenuItem.TYPE]={priority:10},t.itemOrderPriorities[t.MarkConversationAsReadMenuItem.TYPE]={priority:11},t.itemOrderPriorities[t.MarkAllConversationsAsReadMenuItem.TYPE]={priority:12},t.itemOrderPriorities[t.AddGroupConversationToFavoritesMenuItem.TYPE]={priority:13},t.itemOrderPriorities[t.RemoveGroupConversationFromFavoritesMenuItem.TYPE]={priority:14},t.itemOrderPriorities[t.AddContactToFavoritesMenuItem.TYPE]={priority:11},t.itemOrderPriorities[t.RemoveContactFromFavoritesMenuItem.TYPE]={priority:12}})),define("ui/viewModels/people/contactGroup",["require","vendor/knockout","utils/common/ko","ui/viewModels/people/contactBuilder"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/ko"),i=e("ui/viewModels/people/contactBuilder")
	function r(e){function n(e){return i.build(e)}(e=e||{}).contacts=e.contacts||[],this.name=e.name,this.contacts=t.observableArray([]),this.isHidden=t.computed((function(){return 0===this.contacts().length}),this),this.init=function(){var t=e.contacts.map(n)
	this.contacts(t)}}return r.prototype.dispose=function(){this.isHidden.dispose(),n.disposeAndClearArray(this.contacts)},r.build=function(e){return new r(e)},r})),define("ui/contextMenu/menuItemHelper",["require","exports","module","ui/telemetry/actions/actionSources","ui/contextMenu/items/all","lodash-compat","swx-enums"],(function(e,t){var n=e("ui/telemetry/actions/actionSources"),i=e("ui/contextMenu/items/all"),r=e("lodash-compat"),o=e("swx-enums")
	function a(e,t){return e.type()===t.type()?s(e.displayString(),t.displayString()):function(e,t){var n=e.type()||o.phoneType.Other,r=t.type()||o.phoneType.Other
	return i.itemOrderPriorities.StartPSTNCallMenuItem.subPriorities[n].priority-i.itemOrderPriorities.StartPSTNCallMenuItem.subPriorities[r].priority}(e,t)}function s(e,t){var n=e.trim().toLowerCase(),i=t.trim().toLowerCase()
	return n.localeCompare(i)}function c(e,t){return function(e,t){return e.type===t.type}(e,t.type)||function(e,t){var n=i.itemOrderPriorities[e.type],o=i.itemOrderPriorities[t.type]
	return a=n,s=o,r.isUndefined(a)&&r.isUndefined(s)||function(e,t){return!r.isUndefined(e)&&!r.isUndefined(t)}(n,o)&&n.priority===o.priority
	var a,s}(e,t)?s(e.label,t.label):r.isUndefined(i.itemOrderPriorities[t.type])?-1:r.isUndefined(i.itemOrderPriorities[e.type])?1:function(e,t){var n=i.itemOrderPriorities[e.type],r=i.itemOrderPriorities[t.type]
	return n.priority-r.priority}(e,t)}t.getMenuItemTelemetryContext=function(e,t){var n={source:e}
	return t&&t.source&&(n.parent=t.source),n},t.getConversationContextMenuItemGroup=function(e,n,r){var o=[],a=t.getCallPhoneContextMenuItems(e,n,r)
	return o.push(new i.CallSkypeMenuItem(e,n,r)),Array.prototype.push.apply(o,a),o.push(new i.VideoCallMenuItem(e,n,r)),o.push(new i.ViewPersonProfileMenuItem(e.getPerson(),n,r)),new i.MenuItemGroup(i.CallSkypeMenuItem.TYPE,o)},t.getCallPhoneContextMenuItems=function(e,o,s){var c=[],l=e.getPerson()
	if(l.phoneNumbers.size()){var u=l.phoneNumbers()
	u.sort(a),r.forEach(u,(function(r){c.push(new i.StartPSTNCallMenuItem(e,r,o,t.getMenuItemTelemetryContext(n.contextMenuItem.startPSTNCall,s)))}))}return c},t.sortMenuItems=function(e){e.sort(c)}})),define("ui/viewModels/people/baseContactList",["require","lodash-compat","vendor/knockout","swx-i18n","swx-cafe-application-instance","swx-constants","swx-enums","browser/dom","browser/window","utils/common/ko","utils/common/eventMixin","swx-constants","swx-service-locator-instance","ui/viewModels/people/contactListHelper","ui/contextMenu/contextMenu","ui/contextMenu/items/all","ui/telemetry/actions/actionSources","utils/common/scroll","ui/viewModels/people/contactGroup","ui/modelHelpers/groupHelper","ui/contextMenu/menuItemHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("swx-cafe-application-instance"),o=e("swx-constants").COMMON,a=e("swx-enums"),s=e("browser/dom"),c=e("browser/window"),l=e("utils/common/ko"),u=e("utils/common/eventMixin"),d=e("swx-constants").COMMON.serviceLocator,p=e("swx-service-locator-instance").default,f=e("ui/viewModels/people/contactListHelper"),m=e("ui/contextMenu/contextMenu"),h=e("ui/contextMenu/items/all"),v=e("ui/telemetry/actions/actionSources"),g=e("utils/common/scroll"),y=e("ui/viewModels/people/contactGroup"),b=e("ui/modelHelpers/groupHelper"),_=e("ui/contextMenu/menuItemHelper"),E=o.telemetry.historyLoadOrigin.CONTACTS_PAGE
	function w(){var e=this
	e.contactGroups=n.observableArray(),e.contactsCount=n.observable(0),e.batchTimers=[],e.exclusionList=[],e.subscriptions={},e.isSelectable=n.observable(!1),e.templateName=n.computed((function(){return e.isSelectable()?S("selectable"):S("default")}))}function S(e){return"contactList-"+e}return t.assign(w.prototype,u,{init:function(e,t){return this.isSelectable(Boolean(e.isSelectable)),this.scrollbar=g.build(function(e){return s.getElement("div.scrollinWrapper",e)}(t)),this.scrollbar.init(),this.contactGroupConstructor=e.contactGroupConstructor||y,this.populate(e,t)},populate:function(){var e=this,t=p.resolve(d.SUBSCRIPTION_PROVIDER),n=t.getPersonsObservable(),i=t.getFavoritesObservable()
	return e.subscriptions.persons=n.subscribe(r,null,"arrayChange"),e.subscriptions.favorites=i.subscribe(r,null,"arrayChange"),r(),Promise.resolve()
	function r(){e.populateGroups(n())}},populateGroups:function(e){var n,r=this,o=e.filter((function(e){return r.shouldPersonBeIncluded(e,r.exclusionList)})),s=function(e){var n=b.getPersonsFromGroup(a.groupType.Favorites),i=function(e,n){return t.some(e,(function(e){return e.id()===n.id()}))}.bind(null,n)
	return t.groupBy(e,(function(e){return i(e)?a.groupType.Favorites:a.groupType.None}))}(o),c=[].concat((n=s[a.groupType.Favorites],r.contactGroupConstructor.build({name:i.fetch({key:"favorites_recents_category_name"}),contacts:n})),function(e){return e?f.organizeByAlphabet(e).map(r.contactGroupConstructor.build):[]}(s[a.groupType.None]))
	r.contactsCount(o.length),r.setContactGroups(c)},dispose:function(){this.contactsCount(0),this.exclusionList=[],l.disposeAndClearArray(this.contactGroups),this.scrollbar.dispose(),this.templateName.dispose&&this.templateName.dispose(),this.subscriptions&&(this.subscriptions.persons&&this.subscriptions.persons.dispose(),this.subscriptions.favorites&&this.subscriptions.favorites.dispose()),this.batchTimers=this.batchTimers.reduce((function(e,t){return c.clearTimeout(t),e}),[])},afterRender:function(e){return e||t.noop},openConversation:function(e,n,i){var a=p.resolve(o.serviceLocator.PUBSUB),s={model:r.get().conversationsManager.getConversation(e.getPerson()),origin:E}
	t.assign(s,i),a.publish(o.events.navigation.OPEN_CONVERSATION,s)},setContactGroups:function(e){0===e.length?this.contactGroups(e):this.addNextGroup(e,[])},addNextGroup:function(e,t){var n,i
	e.length>0&&((i=e.shift()).init(),this.applyPropertyChangeToContacts(i.contacts()),t=t.concat(i),n=this.addNextGroup.bind(this,e,t),this.contactGroups(t),this.batchTimers.push(c.setTimeout(n,10)))},showContextMenu:function(e,t,n){var i=[]
	i.push(_.getConversationContextMenuItemGroup(e,E,n)),i.push(new h.BlockContactMenuItem(e,_.getMenuItemTelemetryContext(v.contextMenuItem.block,n))),i.push(new h.UnblockContactMenuItem(e,_.getMenuItemTelemetryContext(v.contextMenuItem.unblock,n))),i.push(new h.DeleteContactMenuItem(e,_.getMenuItemTelemetryContext(v.contextMenuItem.deleteItem,n))),i.push(new h.AddContactToFavoritesMenuItem(e,_.getMenuItemTelemetryContext(v.contextMenuItem.addContactToFavorites,n))),i.push(new h.RemoveContactFromFavoritesMenuItem(e,_.getMenuItemTelemetryContext(v.contextMenuItem.removeContactFromFavorites,n))),_.sortMenuItems(i),m.show(i,t,n)},shouldPersonBeIncluded:f.shouldPersonBeIncluded,applyPropertyChangeToContacts:t.noop}),w})),define("ui/viewModels/people/contactPicker",["require","vendor/knockout","usertiming","swx-cafe-application-instance","swx-i18n","experience/settings","swx-enums","utils/common/ko","swx-constants","swx-constants","swx-service-locator-instance","services/telemetry/common/afterRenderHandler","ui/viewModels/people/contactListHelper","ui/viewModels/people/baseContactList","ui/modelHelpers/personHelper","ui/telemetry/telemetryClient","utils/common/accessibility"],(function(e){var t=e("vendor/knockout"),n=e("usertiming"),i=e("swx-cafe-application-instance"),r=e("swx-i18n").localization,o=e("experience/settings"),a=e("swx-enums"),s=e("utils/common/ko"),c=e("swx-constants").COMMON,l=e("swx-constants").PEOPLE,u=e("swx-service-locator-instance").default,d=e("services/telemetry/common/afterRenderHandler"),p=e("ui/viewModels/people/contactListHelper"),f=e("ui/viewModels/people/baseContactList"),m=e("ui/modelHelpers/personHelper"),h=e("ui/telemetry/telemetryClient"),v=e("utils/common/accessibility").narrator,g=l.contactPicker.states,y=c.events.roster,b=c.telemetry.performanceMarks
	function _(){var e,_=this,S=t.observable(""),x=null,C=null,T=u.resolve(c.serviceLocator.FEATURE_FLAGS),I=null,A=null
	function M(e){var t
	return t=i.get().personsAndGroupsManager.all.persons().filter((function(t){return!m.isAuthorizedContact(t)||m.isAgent(t)&&function(e,t){if(!function(e){return"function"==typeof e.capabilities._groupChat&&e.capabilities._groupChat()}(e))return!0
	return function(e){return!!e.selfParticipant&&e.selfParticipant.audio.state()===a.callConnectionState.Connected}(t)&&!function(e){return"function"==typeof e.capabilities._gvc&&e.capabilities._gvc()&&e.capabilities.audio()}(e)}(t,e)})),t}function O(e){var t,n=M(e)
	t=x().map((function(e){return e.person})),_.exclusionList=t.concat(n)}f.call(_),_.searchResults=t.observableArray(),_.selectedContacts=t.observableArray(),_.state=t.observable(g.STATE_DEFAULT),_.hasSearchList=t.computed((function(){return _.state()===g.STATE_SEARCH})),_.hasDefaultList=t.computed((function(){return _.state()===g.STATE_DEFAULT})),_.isVisible=t.computed((function(){var e=_.hasSearchList()&&_.contactsCount()>0,t=_.hasDefaultList()&&_.contactGroups().length>0
	return e||t})),_.css=t.computed(S),_.spacesEnabled=T.isFeatureOn(c.featureFlags.SPACES),e=_.hasSearchList.subscribe((function(e){e&&v.announce({key:"input_placeholder_typeContactName"})})),_.init=function(e,n){return _.showJumpToConversation=e.showJumpToConversation,S(e.className),t.isObservable(e.conversation.participants)?_.exclusionList=M(e.conversation):(x=e.conversation.participants,I=x.subscribe(),A=O.bind(null,e.conversation),x.changed(A)),_.registerEvent(y.ROSTER_QUERY_CHANGED,(function(e){var t,n
	e&&Boolean(e.query)?_.search(e.query,(t=e.selectedContacts,n=_.exclusionList,(t||[]).concat(n))):(_.state(g.STATE_DEFAULT),_.contactsCount(0))})),_.registerEvent(y.ROSTER_SELECTION_REMOVED,(function(e){if(e&&e.person){var t=E(_.selectedContacts(),e.person.id())
	w(t),_.selectedContacts.remove(t),p.deselectContactFromDefaultList(t.getPerson(),_)}})),f.prototype.init.call(_,e,n)},_.dispose=function(){s.disposeAndClearArray(_.searchResults),s.disposeAndClearArray(_.selectedContacts),_.hasSearchList.dispose(),_.hasDefaultList.dispose(),_.isVisible.dispose(),_.css.dispose(),e.dispose(),null!==I&&(I.dispose(),I=null,x.changed.off(A),A=null,x=null),f.prototype.dispose.call(_)},_.afterRender=function(){var e=d(_.contactsCount(),(function(){u.resolve(c.serviceLocator.PUBSUB).publish(c.events.search.LOCAL_SEARCH_RESULTS_RENDERED,{resultCount:_.contactsCount()})}))
	return f.prototype.afterRender.call(_,e)},_.search=function(e,t){var u,d=i.get().personsAndGroupsManager.createPersonSearchQuery()
	if(n.mark(b.SEARCH.LOCAL.START),null!==C)try{C.cancel("Another search query triggered")}catch(f){h.get().sendEvent(o.telemetry.uiTenantToken,c.telemetry.promiseInvalidStateException.TYPE,{feature:c.telemetry.promiseInvalidStateException.feature.CONTACT_PICKER,exception:_stringify(f)})}return d.limit(l.searchLimit),d.sources(a.searchScope.AddressBook),d.text(e),u=d.getMore().then((function(){var e,i
	u===C&&(e=p.filterSearchResults(d.results(),t),C=null,_.state(g.STATE_SEARCH),n.mark(b.SEARCH.LOCAL.END),s.disposeAndClearArray(_.searchResults),_.contactsCount(e.length),_.searchResults(e),i=function(e){var t
	t=0===e?r.fetch({key:"accessibility_contactPickerNoResults"}):r.fetch({key:"accessibility_contactPickerUpdated",params:{totalSearchResults:e},count:e})
	return t}(e.length),v.announce(i),_.dispatchEvent(y.ROSTER_QUERY_EXECUTED,{moreResultsAvailable:d.moreResultsAvailable()}))})),C=u},_.onContactSelected=function(e,t){t.preventDefault(),w(e),e.isActive()?function(e,t){return Boolean(E(t,e.id()))}(e,_.selectedContacts())||(_.selectedContacts.push(e),_.dispatchEvent(y.PICKER_CONTACT_SELECTED,e.getPerson()),p.selectContactFromDefaultList(e.getPerson(),_)):(_.selectedContacts.remove(E(_.selectedContacts(),e.id())),_.dispatchEvent(y.PICKER_CONTACT_DESELECTED,e.getPerson()),p.deselectContactFromDefaultList(e.getPerson(),_)),_.state(g.STATE_DEFAULT)}}function E(e,n){return t.utils.arrayFirst(e,(function(e){return e.id()===n}))}function w(e){var t=e.isActive()
	e.isActive(!t)}return _.prototype=new f,_.prototype.constructor=_,_})),define("text!views/people/picker.html",[],(function(){return'<div data-bind="visible: isVisible, css: css, keyboardNavigation: { itemSelector: \'.contactList:not(.hidden) .searchItem\', persistSelection: false }" class="scrollinWrapper">\r\n    <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n        <div role="menu" class="scrollingPane peoplePicker themeWhite" data-bind="css: { all: hasDefaultList }">\r\n            \x3c!-- ko if: spacesEnabled && showJumpToConversation --\x3e\r\n            <swx-selected-participants-conversation params="contacts: selectedContacts"></swx-selected-participants-conversation>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            <div class="grid verticalGutter fixSmall contactList" data-bind="css: { hidden: hasSearchList, visible: hasDefaultList }">\r\n                <div class="row">\r\n                    <div class="separator peopleFilter">\r\n                        <p class="strong" data-bind="l10n: {key: \'message_title_allContacts\'}"></p>\r\n                    </div>\r\n                </div>\r\n\r\n                <ul class="row" data-bind="foreach: { data: contactGroups }">\r\n                    <div role="presentation" class="column" data-bind="css: { \'swx-hide\': $data.isHidden }">\r\n                        <div aria-hidden="true" class="separator">\r\n                            <p role="presentation" aria-hidden="true" class="strong" data-bind="text: $data.name"></p>\r\n                        </div>\r\n\r\n                        <div role="presentation" class="grid verticalGutter fixSmall row people">\r\n                            \x3c!-- ko foreach: { data: $data.contacts, as: \'contact\' } --\x3e\r\n                            <li role="menuitem" class="column searchItem Avatar-whiteThemeHover" data-bind="css: { active: contact.isActive }, attr: { \'data-title\': contact.textDetails, title: contact.displayName  }, enterKey: $parentContext.$parent.onContactSelected, event: { click: $parentContext.$parent.onContactSelected }">\r\n                                 <label>\r\n                                    <span class="icon">\r\n                                        <span class="iconfont tick"></span>\r\n                                    </span>\r\n                                    <swx-avatar class="Avatar--whiteTheme" params="status: contact.statusClassName, avatar: contact.avatar, isAgent: contact.isAgent, displayName: contact.displayNameUnescaped, isPstn: contact.isPstn, isSelected: contact.isActive"></swx-avatar>\r\n                                    <span class="text">\r\n                                        <span class="tileName">\r\n                                            <h4 data-bind="text: contact.displayNameUnescaped"></h4>\r\n                                        </span>\r\n                                        \x3c!-- ko if: $data.displayMessage --\x3e\r\n                                        <span class="message tile">\r\n                                            <p data-bind="html: contact.displayMessage" class="small"></p>\r\n                                        </span>\r\n                                        \x3c!-- /ko --\x3e\r\n                                    </span>\r\n                                </label>\r\n                            </li>\r\n                            \x3c!-- /ko --\x3e\r\n                        </div>\r\n                    </div>\r\n                </ul>\r\n            </div>\r\n\r\n            <div class="grid verticalGutter fixSmall contactList" data-bind="css: { hidden: hasDefaultList, visible: hasSearchList }">\r\n                <ul role="presentation" class="row people" data-bind="foreach: { data: searchResults, as: \'contact\', afterRender: afterRender() }">\r\n\r\n                    <li role="presentation" class="column" data-bind="attr: { \'data-title\': contact.textDetails, title: contact.displayName }">\r\n                        <div role="menuitem" data-bind="css: { searchItem: true, active: isActive }, enterKey: $parent.onContactSelected">\r\n                            <label>\r\n                                <input type="checkbox" tabindex="-1" name="sampleOne" data-bind="event: { change: $parent.onContactSelected }" />\r\n                                <span class="icon">\r\n                                    <span class="iconfont tick"></span>\r\n                                </span>\r\n                                <swx-avatar params="status: contact.statusClassName, avatar: contact.avatar, isAgent: contact.isAgent, displayName: contact.displayNameUnescaped, isPstn: contact.isPstn, isSelected: contact.isActive"></swx-avatar>\r\n                                <span class="text">\r\n                                    <span class="tileName">\r\n                                        <h4 data-bind="text: contact.displayNameUnescaped"></h4>\r\n                                    </span>\r\n                                    \x3c!-- ko if: $data.displayMessage --\x3e\r\n                                    <span class="message tile">\r\n                                        <p data-bind="html: contact.displayMessage" class="small"></p>\r\n                                    </span>\r\n                                    \x3c!-- /ko --\x3e\r\n                                </span>\r\n                            </label>\r\n                        </div>\r\n                    </li>\r\n\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/people/contactPicker",["require","exports","module","vendor/knockout","ui/viewModels/people/contactPicker","constants/components","text!views/people/picker.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/people/contactPicker")
	t.name=e("constants/components").people.CONTACT_PICKER,t.template=e("text!views/people/picker.html"),t.viewModel={createViewModel:function(e,t){var r=new i
	return e.isSelectable=!0,r.setContext(n.dataFor(t.element)),r.init(e,t.element),r}}})),define("ui/viewModels/people/contactProfile",["require","exports","module","lodash-compat","utils/common/eventMixin","swx-i18n","utils/common/cafeObservable","vendor/knockout","swx-service-locator-instance","swx-constants","ui/telemetry/actions/actionSources","ui/modalDialog/modalDialog","ui/viewModels/people/blockContactModal","text!views/people/blockContactModal.html","swx-cafe-application-instance","swx-enums","ui/viewModels/people/deleteContactModal","text!views/people/deleteContactModal.html","ui/modelHelpers/personHelper","ui/modelHelpers/groupHelper","ui/modelHelpers/personActionsHelper"],(function(e,t){var n=e("lodash-compat"),i=e("utils/common/eventMixin"),r=e("swx-i18n").localization,o=e("utils/common/cafeObservable"),a=e("vendor/knockout"),s=e("swx-service-locator-instance").default,c=e("swx-constants").COMMON,l=e("ui/telemetry/actions/actionSources"),u=e("ui/modalDialog/modalDialog"),d=e("ui/viewModels/people/blockContactModal"),p=e("text!views/people/blockContactModal.html"),f=e("swx-cafe-application-instance"),m=e("swx-enums"),h=e("ui/viewModels/people/deleteContactModal"),v=e("text!views/people/deleteContactModal.html"),g=e("ui/modelHelpers/personHelper"),y=e("ui/modelHelpers/groupHelper"),b=e("ui/modelHelpers/personActionsHelper")
	function _(e,t){var i=this,_=e.conversationTile.contact().getPerson(),E=s.resolve(c.serviceLocator.FEATURE_FLAGS),w=s.resolve(c.serviceLocator.PUBSUB),S=e.conversationModel.participants(0).person,x=o.newObservableProperty(S.isBlocked),C=o.newObservableProperty(S.isBlocked.set.enabled),T=a.observable(F()),I={source:l.contactProfile}
	function A(){i.isInContacts(g.isKnownPerson(S))}function M(){T(F())}function O(){i.actionsInProgress(!1)}function k(){return E.isFeatureOn(c.featureFlags.SHOW_AGENT_RATING_ON_PROFILE)&&i.contact.isAgent()&&U("rating")}function N(){return i.contact.isAgent()&&U("author")}function P(){return i.contact.isAgent()&&U("description")}function R(){return i.contact.isAgent()&&U("website")}function L(){return i.contact.isAgent()&&U("privacyStatement")}function D(){return i.contact.isAgent()&&U("termsOfService")}function U(e){var t
	return!!function(e){return!!i.contact.agentDetails()&&"function"==typeof i.contact.agentDetails()[e]}(e)&&(null!=(t=i.contact.agentDetails()[e]())&&(""+t).trim().length>0)}function F(){return y.isPersonInGroup(m.groupType.Favorites,_)}i.closeLabel=r.fetch({key:"header_text_close"}),i.model=e.conversationModel,i.contact=e.conversationTile.contact(),i.avatar=o.newObservableProperty(e.conversationModel.avatarUrl),i.hasContactInfo=a.computed((function(){return!!i.contact.locationText()})),i.enableContactsManagement=function(){var e=E.isFeatureOn(c.featureFlags.USE_BUSINESS_WORDING),t=E.isFeatureOn(c.featureFlags.ENABLE_BUSINESS_CONTACT_MANAGEMENT)
	if(e&&!t)return!1
	return!0},i.actionsInProgress=a.observable(!1),i.canBlockContact=a.computed((function(){return C()&&!i.contact.isPstn()})),i.isInContacts=a.observable(!1),i.isOrganizationContact=g.isOrganizationContact(_),i.blockContactText=a.computed((function(){var e={key:"label_text_blockContact_with_name",params:{name:i.contact.displayNameUnescaped()}}
	x()&&(e.key="label_text_unblockContact_with_name")
	return r.fetch(e)})),i.favoriteContactText=a.computed((function(){var e={key:"favorites_add_to_favorite"}
	T()&&(e.key="favorites_remove_from_favorite")
	return r.fetch(e)})),i.deleteContactText=a.computed((function(){var e={key:g.isAgent(_)?"label_text_delete_agent":"label_text_deleteContact"}
	return r.fetch(e)})),i.showAgentId=E.isFeatureOn(c.featureFlags.SHOW_AGENT_ID_ON_PROFILE),i.favoritesFeatureEnabled=E.isFeatureOn(c.featureFlags.FAVORITE_CONTACTS_ENABLED),i.hasAgentRating=a.computed(k),i.hasAgentAuthor=a.computed(N),i.hasAgentDescription=a.computed(P),i.hasAgentWebsite=a.computed(R),i.hasAgentPrivacyStatement=a.computed(L),i.hasAgentTermsOfService=a.computed(D),i.hasAgentExtraInfo=a.computed((function(){return E.isFeatureOn(c.featureFlags.SHOW_AGENT_EXTRA_INFO_ON_PROFILE)&&i.contact.isAgent()&&U("extraInfo")})),i.hasAgentPrivacyLinks=a.computed((function(){return i.contact.isAgent()&&(L()||D())})),i.hasAgentCapabilitiesText=a.computed((function(){return i.contact.isAgent()&&U("capabilitiesText")})),i.hasAgentDetailsToShow=a.computed((function(){return N()||P()||i.showAgentId||k()||R()})),i.hasAgentCapabilityAutoPlay=a.computed((function(){var e=i.contact.agentDetails()
	if(!i.contact.isAgent())return!1
	return e&&e.capabilities&&"function"==typeof e.capabilities.media_autoplay&&!!e.capabilities.media_autoplay()})),i.addContact=function(){var t,n=i.contact.isAgent()?m.activityType.ContactRequestOutgoingAgent:i.contact.isPstn()?m.activityType.ContactRequestOutgoingPSTN:m.activityType.ContactRequestOutgoing
	return i.actionsInProgress(!0),f.get().conversationsManager.conversations.add(e.conversationModel),t=b.addPerson(_,n,e.conversationModel,I,(function(){i.dispatchEvent(c.events.conversation.CLOSE_PROFILE,void 0,i.DIRECTION.PARENT),O()}),O),i.dispatchEvent(c.events.message.ADD_CONTACT,I,i.DIRECTION.PARENT),t},i.toggleContactBlocked=function(){var e,t,n
	return i.actionsInProgress(!0),x()?e=b.unblockPerson(_,I):(t=new d(_,I),n=_.isAgent()?r.fetch({key:"modal_block_agent_text_aria_label"}):r.fetch({key:"modal_blockContact_text_aria_label"}),u.build(d.ELEMENT_ID,t,p),u.show(d.ELEMENT_ID,n),e=Promise.resolve()),e.then(O,O),e},i.deleteContact=function(){var e=new h(i.contact,I),t=g.isAgent(_)?r.fetch({key:"label_text_delete_agent"}):r.fetch({key:"modal_deleteContact_text_aria_label"})
	return u.build(h.ELEMENT_ID,e,v),u.show(h.ELEMENT_ID,t),Promise.resolve()},i.toggleFavoriteContact=function(){var e
	return i.actionsInProgress(!0),(e=T()?b.removeFavorite(_,I):b.addFavorite(_,I)).then(O,O),e}
	i.onScroll=n.debounce((function(e,t){w.publish(c.events.interaction.SCROLL_START,t)}),1e3,{leading:!0,trailing:!1}),i.init=function(){t.init()},i.dispose=function(){f.get().personsAndGroupsManager.all.persons.changed.off(A),y.unsubscribeFromGroup(m.groupType.Favorites,M),i.hasContactInfo.dispose(),i.hasAgentRating.dispose(),i.hasAgentAuthor.dispose(),i.hasAgentDescription.dispose(),i.hasAgentWebsite.dispose(),i.hasAgentPrivacyStatement.dispose(),i.hasAgentTermsOfService.dispose(),i.hasAgentExtraInfo.dispose(),i.hasAgentPrivacyLinks.dispose(),i.hasAgentCapabilitiesText.dispose(),i.hasAgentDetailsToShow.dispose(),i.hasAgentCapabilityAutoPlay.dispose(),i.canBlockContact.dispose(),i.blockContactText.dispose(),i.deleteContactText.dispose(),i.favoriteContactText.dispose(),t.dispose()},f.get().personsAndGroupsManager.all.persons.changed(A),y.subscribeToGroup(m.groupType.Favorites,M)}n.assign(_.prototype,i),t.classFunction=_,t.build=function(e,t){return new _(e,t)}})),define("text!views/people/contactProfile.html",[],(function(){return'<div class="ContactProfile fixSmall">\r\n    <div class="ContactProfile--avatar">\r\n        <swx-avatar params="avatar: avatar, isAgent: contact.isAgent, isPstn: contact.isPstn, size: 220, displayName: contact.displayNameUnescaped"></swx-avatar>\r\n    </div>\r\n\r\n    <div class="ContactProfile--main">\r\n        \x3c!-- ko if: enableContactsManagement() --\x3e\r\n        <div class="ContactProfile--actions" data-bind="css: { \'ContactProfile--actions-agent\': hasAgentPrivacyLinks }">\r\n            \x3c!-- ko if: !isInContacts() --\x3e\r\n            <div class="ContactProfile--action-item fontSize-p">\r\n                <span data-bind="css: { \'in-progress\': actionsInProgress }">\r\n                    <a href="#" role="button" data-bind="l10n: {key: \'contact_information_add_to_contacts\'}, click: addContact, css: { \'in-progress\': actionsInProgress }"></a>\r\n                </span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: isInContacts() && !isOrganizationContact --\x3e\r\n            <div class="ContactProfile--action-item fontSize-p">\r\n                <span data-bind="css: { \'in-progress\': actionsInProgress }">\r\n                    <a href="#" role="button" data-bind="text: deleteContactText, click: deleteContact, css: { \'in-progress\': actionsInProgress }"></a>\r\n                </span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: isInContacts() && favoritesFeatureEnabled --\x3e\r\n            <div class="ContactProfile--action-item fontSize-p">\r\n                <span data-bind="css: { \'in-progress\': actionsInProgress }">\r\n                    <a href="#" role="button" data-bind="text: favoriteContactText, click: toggleFavoriteContact, css: { \'in-progress\': actionsInProgress }"></a>\r\n                </span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: canBlockContact --\x3e\r\n            <div class="ContactProfile--action-item fontSize-p">\r\n                <span data-bind="css: { \'in-progress\': actionsInProgress }">\r\n                    <a href="#" role="button" data-bind="click: toggleContactBlocked, text: blockContactText, css: { \'in-progress\': actionsInProgress }"></a>\r\n                </span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: hasAgentPrivacyLinks --\x3e\r\n                <div class="ContactProfile--action-item-privacy">\r\n                    \x3c!-- ko if: hasAgentTermsOfService --\x3e\r\n                    <div class="ContactProfile--action-item fontSize-p">\r\n                        <a href="#" target="_blank" role="button" data-bind="l10n: {key: \'label_text_agent_profile_link_text_terms_of_service\'}, attr: { href: contact.agentDetails().termsOfService }"></a>\r\n                    </div>\r\n                    \x3c!-- /ko --\x3e\r\n                    \x3c!-- ko if: hasAgentPrivacyStatement --\x3e\r\n                    <div class="ContactProfile--action-item fontSize-p">\r\n                        <a href="#" target="_blank" role="button" data-bind="l10n: {key: \'label_text_agent_profile_link_text_privacy_statement\'}, attr: { href: contact.agentDetails().privacyStatement }"></a>\r\n                    </div>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <div class="ContactProfile--data scrollingContainer">\r\n            <div class="scrollViewport scrollViewportV" data-bind="event: { scroll: onScroll }" tabindex="-1">\r\n\r\n                \x3c!-- ko if: !contact.isAgent() --\x3e\r\n                <div class="ContactProfile--data-section ContactProfile--details fontSize-p">\r\n                    <h2 data-bind="l10n: {key: \'label_text_contact_profile_details\'}"></h2>\r\n                    <ul>\r\n                        \x3c!-- ko if: !contact.isPstn() --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_contact_profile_skype_name\'}"></span>\r\n                            <span data-swx-testId="contact-profile-contact-id" data-bind="text: contact.id"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n\r\n                        \x3c!-- ko foreach: contact.phoneNumbers --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <swx-contact-profile-phone-number params="phoneNumber: $data"></swx-contact-profile-phone-number>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                    </ul>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: !contact.isAgent() && hasContactInfo() --\x3e\r\n                <div class="ContactProfile--data-section ContactProfile--info fontSize-p">\r\n                    <h2 data-bind="l10n: {key: \'label_text_contact_profile_information\'}"></h2>\r\n                    <ul>\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_contact_profile_location\'}"></span>\r\n                            <span data-swx-testId="contact-profile-contact-location" data-bind="text: contact.locationText"></span>\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: contact.isAgent() --\x3e\r\n                <div class="ContactProfile--data-section ContactProfile--agent-details fontSize-p" data-bind="css: {hide: !hasAgentDetailsToShow()}">\r\n                    <ul>\r\n                        \x3c!-- ko if: hasAgentAuthor --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_author\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-author" data-bind="html: contact.agentDetails().author"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: hasAgentDescription --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_description\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-description" data-bind="html: contact.agentDetails().descriptionWithLinks"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: showAgentId --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_agentid\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-id" data-bind="text: contact.id"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: hasAgentRating --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_rating\'}"></span>\r\n                            <span class="ContactProfile--agent-rating-value">\r\n                                \x3c!-- ko foreach: { data: contact.agentDetails().ratingStars, as: \'star\' } --\x3e\r\n                                \x3c!-- ko if: star === 1 --\x3e\r\n                                <span class="ContactProfile--agent-rating-star ContactProfile--agent-rating-star-full iconfont favourite"></span>\r\n                                \x3c!-- /ko --\x3e\r\n                                \x3c!-- ko if: star !== 1 --\x3e\r\n                                <span class="ContactProfile--agent-rating-star ContactProfile--agent-rating-star-half iconfont favourite"></span>\r\n                                \x3c!-- /ko --\x3e\r\n                                \x3c!-- /ko --\x3e\r\n                                <span class="ContactProfile--agent-rating-number" data-swx-testId="contact-profile-agent-rating">\r\n                                    (<span data-swx-testId="contact-profile-agent-rating" data-bind="text: contact.agentDetails().rating"></span>)\r\n                                </span>\r\n                            </span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: hasAgentWebsite --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_website\'}"></span>\r\n                            <a data-swx-testId="contact-profile-agent-website" data-bind="attr: { href: contact.agentDetails().website }, text: contact.agentDetails().website" target="_blank"></a>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                    </ul>\r\n                </div>\r\n                <div class="ContactProfile--data-section ContactProfile--agent-details fontSize-p">\r\n                    <ul>\r\n                        \x3c!-- ko if: hasAgentCapabilitiesText --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_capabilities\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-capabilities" data-bind="html: contact.agentDetails().capabilitiesText"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: hasAgentExtraInfo --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_extra_info\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-extraInfo" data-bind="text: contact.agentDetails().extraInfoWithLinks"></span>\r\n                        </li>\r\n                        \x3c!-- /ko --\x3e\r\n                        <li class="ContactProfile--data-item">\r\n                            <span class="fontSize-h2" data-bind="l10n: {key: \'label_text_agent_profile_label_privacy\'}"></span>\r\n                            <span data-swx-testId="contact-profile-agent-privacy" data-bind="l10n: {key: \'label_text_agent_profile_value_privacy\'}"></span>\r\n                            \x3c!-- ko if: hasAgentCapabilityAutoPlay --\x3e\r\n                            <span data-swx-testId="contact-profile-agent-privacy_autoplay" data-bind="l10n: {key: \'label_text_agent_profile_value_privacy_autoplay\'}"></span>\r\n                            \x3c!-- /ko --\x3e\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n\r\n        <swx-mute-conversation-setting-item params="conversationModel: model, contactProfile: true"></swx-mute-conversation-setting-item>\r\n    </div>\r\n\r\n</div>\r\n'})),define("ui/components/people/contactProfile",["require","exports","module","ui/viewModels/people/contactProfile","browser/dom","utils/common/scroll","vendor/knockout","constants/components","text!views/people/contactProfile.html"],(function(e,t){var n=e("ui/viewModels/people/contactProfile"),i=e("browser/dom"),r=e("utils/common/scroll"),o=e("vendor/knockout")
	t.name=e("constants/components").people.CONTACT_PROFILE,t.template=e("text!views/people/contactProfile.html"),t.viewModel={createViewModel:function(e,t){var a=o.dataFor(t.element),s=i.getElement(".scrollingContainer",t.element),c=r.build(s),l=n.build(e,c)
	return l.setContext(a),l.init(),l}}})),define("ui/viewModels/people/phoneNumber",["require","exports","module","vendor/knockout","utils/common/cafeObservable","swx-utils-common","swx-i18n","swx-enums"],(function(e,t){var n=e("vendor/knockout"),i=e("utils/common/cafeObservable"),r=e("swx-utils-common").stringUtils,o=e("swx-i18n").localization,a=e("swx-enums")
	function s(e){var t=this
	t.phoneNumber=i.newObservableProperty(e.displayString),t.displayString=n.computed((function(){return r.forceLTREmbedding(t.phoneNumber())})),t.type=i.newObservableProperty(e.type),t.displayType=n.computed((function(){var e="label_text_phone_number_type_"+(t.type()||a.phoneType.Other).toLowerCase()
	return o.fetch({key:e})}))}s.prototype.dispose=function(){this.displayType.dispose(),this.displayString.dispose()},t.classFunction=s,t.build=function(e){return new s(e)}})),define("text!views/people/contactProfilePhoneNumber.html",[],(function(){return'<span data-bind="text: displayType" class="ContactProfile--phone-number-type fontSize-h2"></span>\r\n<span data-bind="text: displayString" class="ContactProfile--phone-number-value"></span>\r\n'})),define("ui/components/people/contactProfilePhoneNumber",["require","exports","module","ui/viewModels/people/phoneNumber","constants/components","text!views/people/contactProfilePhoneNumber.html"],(function(e,t){var n=e("ui/viewModels/people/phoneNumber")
	t.name=e("constants/components").people.CONTACT_PROFILE_PHONE_NUMBER,t.template=e("text!views/people/contactProfilePhoneNumber.html"),t.viewModel={createViewModel:function(e){return n.build(e.phoneNumber)}}})),define("ui/viewModels/people/contactListMenuItem",["require","exports","module","lodash-compat","vendor/knockout","usertiming","swx-constants","swx-service-locator-instance","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("usertiming"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("experience/settings").telemetry,c=e("ui/telemetry/telemetryClient")
	function l(e){var t=this,l=a.resolve(o.serviceLocator.ACTION_TELEMETRY)
	t.id=e.id?"menuItem-"+e.id:"",t.strategy=e.strategy,t.text=e.text||"",t.selected=i.observable(Boolean(e.selected)),t.onClick=function(t,i){return e.uiAction&&l.recordAction(e.uiAction),e.perfMarker&&r.mark(e.perfMarker),e.event&&c.get().sendEvent(s.uiTenantToken,e.event.name,e.event.data),n.isFunction(e.callback)&&e.callback(),i.preventDefault(),!0}}t.build=function(e){return e||(e={}),new l(e)}})),define("telemetry/shortCircuit/shortCircuit",["require","exports","module","ui/telemetry/telemetryClient","swx-constants","experience/settings"],(function(e,t){var n=e("ui/telemetry/telemetryClient"),i=e("swx-constants").COMMON.telemetry.contacts,r=e("experience/settings")
	function o(){this.sendStartEvent=function(e){n.get().sendEvent(r.telemetry.uiTenantToken,i.shortCircuit.START,e||{})},this.sendFinishedEvent=function(e){n.get().sendEvent(r.telemetry.uiTenantToken,i.shortCircuit.FINISHED,e||{})},this.sendAddressBookAddedEvent=function(e){n.get().sendEvent(r.telemetry.uiTenantToken,i.shortCircuit.ADDRESS_BOOK_ADDED,e||{})},this.sendVisibleEvent=function(e){n.get().sendEvent(r.telemetry.uiTenantToken,i.shortCircuit.VISIBLE,e||{})}}t.build=function(){return new o}})),define("ui/shortCircuit/shortCircuit",["require","exports","module","experience/settings","browser/window","browser/document","swx-constants","ui/session/localSession","swx-cafe-application-instance","swx-service-locator-instance","telemetry/shortCircuit/shortCircuit"],(function(e,t){var n=e("experience/settings"),i=e("browser/window"),r=e("browser/document"),o=e("swx-constants").COMMON,a=e("ui/session/localSession"),s=e("swx-cafe-application-instance"),c=e("swx-service-locator-instance").default,l=e("telemetry/shortCircuit/shortCircuit"),u="postmessage",d="signup",p="skype-white",f="afterlogin"
	function m(){var e=l.build()
	function t(e,t){return i.open(t||"",e,"width=720,height=472,scrollbars,status")}function m(e){return Date.now()-+e<864e5}this.open=function(o,c){var l,h,v,g=s.get(),y="Skype.ShortCircuit"+ +Date.now(),b=t(y),_=!1
	return h=b,v="message",(l=new Promise((function(e){var t=i.setInterval(o,1e3)
	function r(t){t.origin===n.pnvService.host.replace(/\/$/,"")&&(a(),e(JSON.parse(t.data)))}function o(){h.closed&&(a(),e({error:"windowClosed"}))}function a(){i.clearInterval(t),i.removeEventListener(v,r)}i.addEventListener(v,r)}))).then((function(t){var n=!(!t||!t.flow_complete),i={contactsCount:c?c():0,newUser:_}
	t.error&&(i.error=t.error),n?(i.flowCompleted=n,e.sendAddressBookAddedEvent(i)):e.sendFinishedEvent(i)})),g.signInManager._skypeToken().then((function(i){return g.personsAndGroupsManager.mePerson.registeredAt.get().then((function(s){return _=m(s),e.sendStartEvent({contactsCount:c?c():0,newUser:_}),t(y,function(e,t,i){return i=i||(m(t)?d:f),o()+s(i)+"#Skypetoken="+e
	function o(){return n.pnvService.host+n.pnvService.pnvEndpoint+"?"}function s(e){var t=[]
	return t.push("client_id="+n.pnvService.clientId),t.push("redirect_uri="+r.location.origin),t.push("response_type="+u),t.push("partner=999"),t.push("setlang="+n.initParams.locale),t.push("clientVersion="+n.uiVersion),t.push("scenario="+e),t.push("theme="+p),t.push("session_id="+a.getSessionId()),t.join("&")}}(i,s,o)),l}))})).catch((function(){return b.close(),l}))},this.isEnabled=function(){var t=s.get().personsAndGroupsManager.mePerson
	return c.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.SHORT_CIRCUIT)&&void 0!==t._isLinkedMsaAutoGenerated&&void 0!==t.registeredAt?t._isLinkedMsaAutoGenerated.get().then((function(t){return t||e.sendVisibleEvent(),!t})):Promise.resolve(!1)}}t.build=function(){return new m}})),define("ui/viewModels/people/contactPageContactGroup",["require","lodash-compat","vendor/knockout","utils/common/ko","ui/viewModels/people/contactBuilder"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/ko"),r=e("ui/viewModels/people/contactBuilder")
	function o(e){function i(e){return r.build(e,{hideable:!0})}(e=e||{}).contacts=e.contacts||[],this.name=e.name,this.contacts=n.observableArray([]),this._hiddenContacts=n.observableArray(),this._contactsSubscription=this.contacts.subscribe((function(){this._hiddenContacts(t.map(this.contacts(),"isHidden"))}),this,"arrayChange"),this.isHidden=n.computed((function(){return this._hiddenContacts().every((function(e){return e()}))}),this),this.init=function(){var t=e.contacts.map(i)
	this.contacts(t)}}return o.prototype.dispose=function(){this._contactsSubscription.dispose(),this.isHidden.dispose(),i.disposeAndClearArray(this.contacts)},o.build=function(e){return new o(e)},o})),define("ui/viewModels/people/contactsPage",["require","lodash-compat","swx-cafe-application-instance","vendor/knockout","swx-enums","usertiming","swx-constants","constants/components","swx-constants","browser/dom","ui/telemetry/actions/actionNames","experience/settings","ui/telemetry/telemetryClient","services/telemetry/common/afterRenderHandler","ui/viewModels/people/baseContactList","swx-service-locator-instance","ui/telemetry/actions/actionSources","ui/viewModels/people/contactListHelper","swx-i18n","ui/modelHelpers/personHelper","ui/modelHelpers/groupHelper","ui/viewModels/people/contactListMenuItem","ui/shortCircuit/shortCircuit","ui/educationBubbles/educationBubble","ui/viewModels/people/contactPageContactGroup","ui/educationBubbles/educationBubbleInfo","swx-pubsub-instance","swx-constants","utils/common/eventHelper","swx-focus-handler"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("vendor/knockout"),r=e("swx-enums"),o=e("usertiming"),a=e("swx-constants").COMMON,s=a.events.navigation,c=e("constants/components"),l=e("swx-constants").PEOPLE,u=e("browser/dom"),d=e("ui/telemetry/actions/actionNames"),p=e("experience/settings"),f=e("ui/telemetry/telemetryClient"),m=e("services/telemetry/common/afterRenderHandler"),h=e("ui/viewModels/people/baseContactList"),v=e("swx-service-locator-instance").default,g=e("ui/telemetry/actions/actionSources"),y=e("ui/viewModels/people/contactListHelper"),b=e("swx-i18n").localization,_=e("ui/modelHelpers/personHelper"),E=e("ui/modelHelpers/groupHelper"),w=e("ui/viewModels/people/contactListMenuItem"),S=e("ui/shortCircuit/shortCircuit"),x=e("ui/educationBubbles/educationBubble"),C=e("ui/viewModels/people/contactPageContactGroup"),T=e("ui/educationBubbles/educationBubbleInfo"),I=e("swx-pubsub-instance").default,A=e("swx-constants").KEYS,M=e("utils/common/eventHelper"),O=e("swx-focus-handler"),k=a.telemetry,N=k.performanceMarks.CONTACTS.PAGE,P=k.measurements.CONTACTS.PAGE,R=k.contacts.searchForFriends
	function L(e){I.publish(a.events.navigation.NAVIGATE_TO_SEARCH_INPUT),f.get().sendEvent(p.telemetry.chatTenantToken,e,{})}function D(){var e,t,r=p.initParams.locale?p.initParams.locale:"en"
	h.call(this),U().isFeatureOn(a.featureFlags.SHOW_CONTACTS_PAGE_HINT)?this.showHint=i.computed((function(){return this.contactsCount()>0}),this):this.showHint=function(){return!1},this.oneAccountHtml=(e=b.fetch({key:"one_account_link"}),t='<a href="'+p.oneAccountSupportUrl+'">',e.replace("{link_start}",t).replace("{link_end}","</a>")),this.showOneAccount=U().isFeatureOn(a.featureFlags.SHOW_ONE_ACCOUNT_LINK)&&_.isTechnicalAccount(n.get().personsAndGroupsManager.mePerson),this.menuItems=[],this.isShortCircuitEnabled=i.observable(!1),this.showNewBeePage=i.observable(!1),this.showFirstRunPage=i.observable(!1),this.isFirstRunPageFlagEnabled=U().isFeatureOn(a.featureFlags.SHOW_FIRST_RUN_LANDING_EXPERIENCE),this.onMouseDown=function(){L.call(this,R.event.CLICK)},this.onKeyDown=function(e,t){return t&&M.getKeyCode(t)!==A.TAB&&L.call(this,R.event.KEYDOWN),!0},this.learnMoreUrl=p.skypeFromOutlook.host+r+p.skypeFromOutlook.page}function U(){return v.resolve(a.serviceLocator.FEATURE_FLAGS)}function F(e,t){v.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(e,t)}function B(){return o.getEntriesByName(N.OPENED).length>0}function V(e){var t=this,i=n.get(),o=!!i.personsAndGroupsManager.mePerson._clientUpdatePolicy,s=!!i.personsAndGroupsManager.mePerson._teamsAsDefaultClient,c=i.signInManager.state
	function l(e){!e&&t.canShowInformationalMessage?(t.showInformationalMessage(!0),t.showTeamsAlert(!1)):e&&(t.showTeamsAlert(!0),t.showInformationalMessage(!1))}(!e||e<+new Date)&&(o||s)?c.when(r.loginState.SignedIn,(function(){o&&i.personsAndGroupsManager.mePerson._clientUpdatePolicy.changed((function(e){l(function(e){return e===a.teamsMigration.SHOW_NOTIFICATION}(e))})),s&&i.personsAndGroupsManager.mePerson._teamsAsDefaultClient.changed((function(e){e>a.teamsAsDefaultClient.NONE&&(l(function(e){return e===a.teamsAsDefaultClient.CHAT||e===a.teamsAsDefaultClient.CALLING||e===a.teamsAsDefaultClient.CHAT_AND_CALLING}(e)),t.teamsAsDefaultClient(e))}))})):l(!1)}function G(e){x.build(e.id,e.anchorElementQuery,e.i18nKey,e.iconUrlPath,e.options).show()}function H(){var e=[]
	function t(t){this.applyPropertyChangeToContacts=y.setObservablePropertyOnContacts.bind(this,"hideStrategy",t),this.applyPropertyChangeToContacts(this.contactGroups()),e.forEach((function(e){var n=e.strategy===t
	e.selected(n)}))}return e.push(w.build({id:l.contactPageTabIds.ALL_CONTACTS_TAB,strategy:l.showStrategies.ALL,text:b.fetch({key:"contactPage_text_tab_allContacts"}),callback:t.bind(this,l.showStrategies.ALL),selected:!0})),e.push(w.build({id:l.contactPageTabIds.AVAILABLE_TAB,strategy:l.showStrategies.AVAILABLE_ONLY,text:b.fetch({key:"contactPage_text_tab_available"}),callback:t.bind(this,l.showStrategies.AVAILABLE_ONLY)})),U().isFeatureOn(a.featureFlags.AGENTS_DISCOVERABLE)&&e.push(w.build({id:l.contactPageTabIds.AGENTS_TAB,strategy:l.showStrategies.AGENTS_ONLY,text:b.fetch({key:"contactPage_text_tab_agents"}),callback:t.bind(this,l.showStrategies.AGENTS_ONLY)})),e}function q(e){O.get().addFocusRequestToQueue(e),I.subscribe(s.FRAGMENT_LOADED,W.bind(null,e))}function W(e,t){t===c.people.CONTACTS_PAGE&&O.get().addFocusRequestToQueue(e)}return D.prototype=new h,D.prototype.constructor=D,D.prototype.init=function(e,t){var r,s,c=this,l=u.getElement(".ContactsPage",t)
	return B()&&(o.mark(N.INITIALIZED),o.measure(P.TTC,N.OPENED,N.INITIALIZED)),e.contactGroupConstructor=C,r=h.prototype.init.call(this,e,l),s=S.build().isEnabled().then((function(e){return e||(c.isFirstRunPageFlagEnabled?(c.showFirstRunPage(!0),q(u.getElement(".ContactsPage-FirstRunInput",t)),f.get().sendEvent(p.telemetry.chatTenantToken,R.event.SHOW,{})):c.showNewBeePage(!0)),c.isShortCircuitEnabled(e)})),Array.prototype.push.apply(this.menuItems,H.call(this)),c.showTeamsAlert=i.observable(!1),c.showInformationalMessage=i.observable(!1),c.teamsAsDefaultClient=i.observable(a.teamsAsDefaultClient.NONE),function(e){var t=U().isFeatureOn(a.featureFlags.SHOW_CONTACTS_PAGE_INFORMATIONAL_MESSAGE),n=v.resolve(a.serviceLocator.LOCAL_STORAGE),i=p.contactsPageInformationalMessage
	e.canShowInformationalMessage=t&&i&&i.key&&i.link,e.canShowInformationalMessage&&(e.contactsPageInformationalMessage=i)
	n.getItem(a.teamsMigration.LOCAL_STORAGE_KEY).then(V.bind(e))}(c),function(){var e={},t=U().isFeatureOn(a.featureFlags.SEARCH_EDUCATION_BUBBLE_BUSINESS),i=U().isFeatureOn(a.featureFlags.SEARCH_EDUCATION_BUBBLE),r=v.resolve(a.serviceLocator.SUBSCRIPTION_PROVIDER)
	if(t&&i)throw new Error("Search education bubble should not be set for business and consumer flavors in the same time.")
	t&&(e=T.SEARCH_EDUCATION_BUBBLE_BUSINESS)
	i&&(e=T.SEARCH_EDUCATION_BUBBLE);(i||t)&&r.getContacts().then((function(){var t=E.getPersonsOtherThanEchoAndAgents(),i=n.get().conversationsManager.conversations
	0===t.length&&0===i.size()&&G(e)}))}(),c.isFirstRunPageFlagEnabled||q(l),Promise.all([r,s])},D.prototype.dispose=function(){this.showHint.dispose&&this.showHint.dispose(),I.unsubscribe(s.FRAGMENT_LOADED,W),h.prototype.dispose.call(this)},D.prototype.afterRender=function(){var e=this,n=m(e.contactGroups().length,(function(){B()&&(o.mark(N.RENDERED),o.measure(P.TTR,N.OPENED,N.RENDERED),function(e){var t,n={ttc:o.getEntriesByName(P.TTC)[0],ttr:o.getEntriesByName(P.TTR)[0]}
	n.ttc&&n.ttr&&(t={name:k.contacts.name.CONTACTS_PAGE_PERFORMANCE,timeToComplete:n.ttc.duration.toString(),timeToRender:n.ttr.duration.toString(),contactsCount:e.toString()},f.get().sendEvent(p.telemetry.uiTenantToken,k.contacts.type.CONTACTS,t))
	o.clearMarks(N.OPENED),o.clearMarks(N.INITIALIZED),o.clearMarks(N.RENDERED),o.clearMeasures(P.TTC),o.clearMeasures(P.TTR)}(e.contactsCount()));(function(){var e=U().isFeatureOn(a.featureFlags.CHAT_EDUCATION_BUBBLE),n=U().isFeatureOn(a.featureFlags.CHAT_EDUCATION_BUBBLE_BUSINESS),i=v.resolve(a.serviceLocator.SUBSCRIPTION_PROVIDER)
	if(e&&n)throw new Error("Chat education bubble should not be set for business and consumer flavors in the same time.")
	e&&i.getContacts().then((function(){var e=E.getPersonsOtherThanEchoAndAgents(),n=e.length,i=t.filter(e,_.isSuggestedContact).length
	n>0&&i===n&&G(T.CHAT_EDUCATION_BUBBLE)}))
	n&&i.getContacts().then((function(){E.getPersonsOtherThanEchoAndAgents().length>0&&G(T.CHAT_EDUCATION_BUBBLE_BUSINESS)}))})()}))
	return h.prototype.afterRender.call(this,n)},D.prototype.openConversation=function(e,t){F(d.contacts.openConversation),h.prototype.openConversation.call(this,e,t)},D.prototype.showContextMenu=function(e,t){var n={source:g.contactsPage.contact}
	h.prototype.showContextMenu.call(this,e,t,n)},D.prototype.launchShortCircuit=function(){S.build().open(void 0,this.contactsCount),v.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(d.shortCircuit.contactsPageOpen)},D.prototype.openInformationalMessageLink=function(){F(d.contacts.informationButtonClicked,{link:this.contactsPageInformationalMessage.link}),window.open(this.contactsPageInformationalMessage.link,"_blank")},D.prototype.shouldPersonBeIncluded=function(e,t){return!y.personExistsInCollection(e,t)&&(!_.isEchoContact(e)||E.getPersonsOtherThanEcho().length>0)},D})),define("text!views/people/contactsPage.html",[],(function(){return'<div data-swx-testId="contactsPage" class="ContactsPage themeWhite" tabindex="-1" data-bind="l10n_attr: {\'aria-label\': \'contactPage_text_header\'}">\r\n    <div class="ContactsPage-header">\r\n        <h1 class="ContactsPage-heading" data-bind="l10n: { key: \'contactPage_text_header\' }"></h1>\r\n\r\n        \x3c!-- ko if: showHint() --\x3e\r\n        <p class="ContactsPage-hint" data-bind="l10n: { key: \'contactPage_text_hint_search\' }"></p>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: contactsCount() > 0 --\x3e\r\n        <ul role="tablist" class="ContactsPage-categories" data-bind="foreach: menuItems">\r\n            <li role="tab" class="ContactsPage-categoryItem" data-bind="attr: { \'aria-selected\': !!$data.selected() }">\r\n                <swx-contact-list-menu-item params="viewModel: $data"></swx-contact-list-menu-item>\r\n            </li>\r\n        </ul>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    <div data-swx-testId="contactsPageBody" class="scrollinWrapper ContactsPage-body">\r\n        <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n            <div class="scrollingPane themeWhite peoplePicker all">\r\n                \x3c!-- ko template: { name: templateName } --\x3e\x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: !contactsCount() --\x3e\r\n                    <div class="ContactsPage-cta">\r\n                        <div class="ContactsPage-ctaContent">\r\n                            \x3c!-- ko if: isShortCircuitEnabled() --\x3e\r\n                            <div class="ContactsPage-Image-addFriends"></div>\r\n                            <p class="ContactsPage-ctaText ContactsPage-ctaText--addFriends fontSize-h2" data-bind="l10n: {key: \'short_circuit_contacts_page_message_v2\'}"></p>\r\n                            <button type="button" class="ContactsPage-ctaButton btn primary cancel" data-bind="click: launchShortCircuit, l10n_attr: {\'aria-label\': \'short_circuit_contacts_page_message_v2\'}">\r\n                                <span class="clickable" data-bind="l10n: {key: \'short_circuit_contacts_page_cta\'}"></span>\r\n                            </button>\r\n                            \x3c!-- /ko --\x3e\r\n\r\n                            \x3c!-- ko if: showFirstRunPage() --\x3e\r\n                            <h1 class="ContactsPage-ctaHeading ContactsPage-ctaHeading--findFriends fontSize-h0" data-bind="l10n: {key: \'search_skype_for_friends_and_family_header\'}"></h1>\r\n                            <div class="ContactsPage-Image-findFriends"></div>\r\n                            <h3 class="ContactsPage-ctaText fontSize-h3 ContactsPage-ctaText--findFriends" data-bind="l10n: {key: \'search_skype_for_friends_and_family_message\'}"></h3>\r\n                            <input type="text" role="search" class="inputField ContactsPage-FirstRunInput fontSize-h4" data-bind="event: { mousedown: onMouseDown, keydown: onKeyDown }, l10n_attr: {\'placeholder\': \'search_skype_for_friends_and_family_searchDirectory\', \'aria-label\': \'input_placeholder_searchSkype\'}" />\r\n                            <p class="ContactsPage-ctaText smaller ContactsPage-ctaText--findFriends" data-bind="l10n: {key: \'search_skype_for_friends_and_family_tip\'}"></p>\r\n                            \x3c!-- /ko --\x3e\r\n\r\n                            \x3c!-- ko if: showNewBeePage() --\x3e\r\n                            <div class="ContactsPage-ctaCover"></div>\r\n                            <h1 class="ContactsPage-ctaHeading fontSize-h0" data-swx-testId="contactsPageCtaHeading" data-bind="l10n: {key: \'newbee_text_header\'}"></h1>\r\n                            <p class="ContactsPage-ctaText fontSize-h2" data-bind="businessAwareL10n: {key: \'newbee_text_cta\'}"></p>\r\n                            \x3c!-- /ko --\x3e\r\n                        </div>\r\n                    </div>\r\n                \x3c!-- /ko --\x3e\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n    \x3c!-- ko if: showOneAccount --\x3e\r\n    <p class="ContactsPage-oneAccount" data-bind="html: oneAccountHtml"></p>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: showInformationalMessage --\x3e\r\n    <div class="InformationalMessage">\r\n        <a href="#" role="button" data-bind="click: openInformationalMessageLink, l10n: {key: contactsPageInformationalMessage.key}"></a>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: showTeamsAlert --\x3e\r\n        <swx-teams-alert params="showTeamsAlert: $data.showTeamsAlert, teamsAsDefaultClient: $data.teamsAsDefaultClient, showInformationalMessage: $data.showInformationalMessage, canShowInformationalMessage: $data.canShowInformationalMessage" class="TeamsAlert"></swx-teams-alert>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n<script type="text/html" id="contactList-default">\r\n    <ul class="grid verticalGutter fixSmall" data-bind="foreach: { data: contactGroups, afterRender: afterRender() }, keyboardNavigation: { itemSelector: \'li.contactTile:not(.swx-hide)\', persistSelection: false }">\r\n        <div class="row separator" data-bind="css: { \'swx-hide\': $data.isHidden }">\r\n            <p role="presentation" aria-hidden="true" class="strong" data-bind="text: $data.name, css: { \'swx-hide\': $data.isHidden }"></p>\r\n            <div class="row people">\r\n                \x3c!-- ko foreach: { data: contacts } --\x3e\r\n                <li class="column contactTile searchItem Avatar-whiteThemeHover" data-bind="css: { \'swx-hide\': $data.isHidden, active: $data.isActive },  enterKey: $parentContext.$parent.openConversation,\r\n                event: { click: $parentContext.$parent.openConversation, contextmenu: $parentContext.$parent.showContextMenu }, attr: { \'aria-label\': $data.ariaLabel, title: $data.displayName }" tabindex="0">\r\n                        <swx-avatar params="status: $data.statusClassName, avatar: $data.avatar, isAgent: $data.isAgent, isPstn: $data.isPstn, displayName: $data.displayNameUnescaped"></swx-avatar>\r\n                        <span class="text">\r\n                            <span class="tile">\r\n                                <span class="tileName">\r\n                                    <h4>\r\n                                        <span class="topic" data-bind="text: $data.displayNameUnescaped, attr: {title: $data.displayName}"></span>\r\n                                        \x3c!-- ko if: $data.agentDetails() && $data.agentDetails().certification() --\x3e\r\n                                        <span class="iconfont avatarBotCertified"></span>\r\n                                        \x3c!-- /ko --\x3e\r\n                                    </h4>\r\n                                </span>\r\n                            </span>\r\n                            \x3c!-- ko if: $data.displayMessage --\x3e\r\n                            <span class="message tile">\r\n                                <p data-bind="html: $data.displayMessage" data-swx-testId="displayMessage" class="small"></p>\r\n                            </span>\r\n                            \x3c!-- /ko --\x3e\r\n                        </span>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n    </ul>\r\n<\/script>\r\n\r\n<script type="text/html" id="contactList-selectable">\r\n    <ol role="list" class="grid verticalGutter fixSmall" data-bind="foreach: { data: contactGroups }">\r\n        <li class="row separator" data-bind="css: { \'swx-hide\': $data.isHidden }">\r\n            <p role="presentation" aria-hidden="true" class="strong" data-bind="text: $data.name"></p>\r\n            <div class="row people">\r\n                <ul data-bind="foreach: { data: $data.contacts }">\r\n                    <li class="column contactTile">\r\n                        <div data-bind="css: { \'swx-hide\': $data.isHidden, active: $data.isActive }">\r\n                            <label>\r\n                                <input type="checkbox" name="sampleOne">\r\n                                <span class="icon">\r\n                                    <span class="iconfont tick"></span>\r\n                                </span>\r\n                                <swx-avatar params="status: $data.statusClassName, avatar: $data.avatar, isAgent: $data.isAgent, displayName: $data.displayNameUnescaped"></swx-avatar>\r\n                                <span class="text">\r\n                                    <span class="tileName">\r\n                                        <h4 data-bind="text: $data.displayNameUnescaped"></h4>\r\n                                    </span>\r\n                                    \x3c!-- ko if: $data.displayMessage --\x3e\r\n                                    <span class="message tile">\r\n                                        <p data-bind="html: $data.displayMessage" data-swx-testId="displayMessage" class="small"></p>\r\n                                    </span>\r\n                                    \x3c!-- /ko --\x3e\r\n                                </span>\r\n                            </label>\r\n                        </div>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </li>\r\n    </ol>\r\n<\/script>\r\n'})),define("ui/components/people/contactsPage",["require","exports","module","vendor/knockout","ui/viewModels/people/contactsPage","constants/components","text!views/people/contactsPage.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/people/contactsPage")
	t.name=e("constants/components").people.CONTACTS_PAGE,t.template=e("text!views/people/contactsPage.html"),t.viewModel={createViewModel:function(e,t){var r=new i
	return r.setContext(n.dataFor(t.element)),r.init({className:"ContactsPage",isSelectable:!1},t.element),r}}})),define("ui/viewModels/people/baseList",["require","lodash-compat","vendor/knockout","swx-cafe-application-instance","experience/settings","swx-i18n","swx-service-locator-instance","swx-constants","swx-constants","ui/viewModels/people/contactBuilder","ui/telemetry/telemetryClient","ui/telemetry/people/contactSearch","utils/common/statusMapper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-cafe-application-instance"),r=e("experience/settings"),o=e("swx-i18n").localization,a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("swx-constants").PEOPLE,l=e("ui/viewModels/people/contactBuilder"),u=e("ui/telemetry/telemetryClient"),d=e("ui/telemetry/people/contactSearch"),p=e("utils/common/statusMapper"),f=s.events.search
	function m(e){this.activeSearchPromise=null,this.listSource=n.observable(e),this.contacts=n.observableArray(),this.emptyListText=o.fetch({key:"message_text_emptySearchResults"}),this.showEmptyListText=n.observable(!1),this.showListTitle=n.observable(!1),this.listHasContacts=n.computed((function(){return this.contacts().length>0}),this),this.listRole=n.computed((function(){return this.contacts().length>0?"menubar":"group"}),this)}function h(){return a.resolve(s.serviceLocator.PUBSUB)}return m.prototype.init=function(){h().subscribe(f.QUERY_CHANGED,this.search)},m.prototype.dispose=function(){h().unsubscribe(f.QUERY_CHANGED,this.search)},m.prototype.reset=function(){this.showListTitle(!1),this.showEmptyListText(!1),this.contacts([])},m.prototype.search=function(e,t){var n,o,a=this
	if(e)return this.showEmptyListText(!1),function(e){if(e)try{e.cancel("Another search query triggered")}catch(t){u.get().sendEvent(r.telemetry.uiTenantToken,s.telemetry.promiseInvalidStateException.TYPE,{feature:s.telemetry.promiseInvalidStateException.feature.PEOPLE_SEARCH,exception:_stringify(t)})}}(a.activeSearchPromise),(n=i.get().personsAndGroupsManager.createPersonSearchQuery()).sources(a.listSource()),n.text(e),n.limit(c.searchLimit),o=n.getMore().then((function(){if(a.activeSearchPromise!==o)return
	p(),a.contacts(n.results().map((function(e){return l.build(e.result,{keepPresenceSubscription:!1,keepLastSeenAtSubscription:!1,keepActivitySubscription:!1,keepEndpointTypeSubscription:!1})}))),h().publish(f.QUERY_EXECUTED,{moreResultsAvailable:n.moreResultsAvailable()})}),(function(e){if(e&&"Canceled"===e.message)return
	if(a.activeSearchPromise!==o)return
	d.onContactSearchEnd({success:!1,searchScope:a.listSource()}),p()})),this.activeSearchPromise=o,o
	function p(){a.activeSearchPromise=null,a.totalSearchResults=n.results().length,a.latestSearchQueryResults=n.results(),h().publish(t.results,a.totalSearchResults),a.showListTitle(!0),a.showEmptyListText(!n.results().length)}},m.prototype.sendOpenConversationEvent=function(e){h().publish(s.events.navigation.OPEN_CONVERSATION,{model:e,origin:this.historyLoadOrigin})},m.prototype.getSearchItemDetails=function(e,t){var n=p.getAvailabilityText(e.status())
	return o.fetch({key:this.searchItemI18nKey,params:{contactName:e.displayName(),id:e.id(),status:null!==n?n:"",index:t+1,totalResults:this.totalSearchResults}})},m.prototype.indexOfSelectedContactInSearchResults=function(e){var n
	if(e&&t.isArray(this.latestSearchQueryResults))return-1!==(n=t.findIndex(this.latestSearchQueryResults,(function(t){return t.result.id()===e.id()})))?n+1:void 0},m}))
	define("ui/viewModels/people/directoryList",["require","ui/viewModels/people/baseList","swx-cafe-application-instance","swx-service-locator-instance","vendor/knockout","swx-constants","swx-i18n","swx-constants","swx-enums","lodash-compat","ui/telemetry/actions/actionSources","ui/contextMenu/contextMenu","ui/contextMenu/menuItemHelper","ui/contextMenu/items/all","ui/telemetry/people/contactSearch"],(function(e){var t=e("ui/viewModels/people/baseList"),n=e("swx-cafe-application-instance"),i=e("swx-service-locator-instance").default,r=e("vendor/knockout"),o=e("swx-constants").PEOPLE,a=e("swx-i18n").localization,s=e("swx-constants").COMMON,c=e("swx-enums"),l=e("lodash-compat"),u=e("ui/telemetry/actions/actionSources"),d=e("ui/contextMenu/contextMenu"),p=e("ui/contextMenu/menuItemHelper"),f=e("ui/contextMenu/items/all"),m=e("ui/telemetry/people/contactSearch"),h=s.events.search
	function v(){var e=this,l=t.prototype
	function v(){return i.resolve(s.serviceLocator.PUBSUB)}function g(e){return{source:e,parent:u.searchItem.skypeDirectory}}this.listClass=r.observable(o.contactList.className.DIRECTORY),this.listTitle=r.observable(a.fetch({key:"message_text_contactTitleDirectory"})),this.showListTitle=r.observable(!1),this.events={results:h.DIRECTORY_SEARCH_RESULTS,rendered:h.DIRECTORY_SEARCH_RESULTS_RENDERED},this.historyLoadOrigin=s.telemetry.historyLoadOrigin.DIRECTORY_SEARCH,this.searchItemI18nKey="accessibility_searchItem_directoryList",t.call(e,c.searchScope.SkypeDirectory),e.lastQuery="",e.isActive=!1,e.init=function(){v().subscribe(h.DIRECTORY_SEARCH_ACTIVATED,e.activate),v().subscribe(h.DIRECTORY_SEARCH_DEACTIVATED,e.deactivate),l.init.call(e)},e.dispose=function(){v().unsubscribe(h.DIRECTORY_SEARCH_ACTIVATED,e.activate),v().unsubscribe(h.DIRECTORY_SEARCH_DEACTIVATED,e.deactivate),l.dispose.call(e)},e.search=function(t){if(e.lastQuery=t,l.reset.call(e),e.isActive)return l.search.call(e,t,e.events)},e.openConversation=function(t){var i=n.get().conversationsManager.getConversation(t.getPerson())
	l.sendOpenConversationEvent.call(e,i),m.onContactSearchEnd({searchScope:c.searchScope.SkypeDirectory,success:!0,resultCount:e.totalSearchResults,clickPosition:l.indexOfSelectedContactInSearchResults.call(e,t),source:u.search.reset.openConversation})},e.showContextMenu=function(e,t){var n,i={source:u.searchItem.skypeDirectory},r=g(u.contextMenuItem.unblock),o=g(u.contextMenuItem.block)
	n=[new f.BlockContactMenuItem(e,o),new f.UnblockContactMenuItem(e,r)],p.sortMenuItems(n),d.show(n,t,i)},e.activate=function(){e.isActive=!0,e.search(e.lastQuery)},e.deactivate=function(){e.isActive=!1}}return v.prototype=l.create(t.prototype,{constructor:v}),v})),define("text!views/people/list.html",[],(function(){return'<ul data-bind="css: listClass, keyboardNavigation: { itemSelector: \'.searchItem\', persistSelection: false }, attr: {\'role\': listRole, \'aria-label\': listTitle }">\r\n    \x3c!-- ko if: showListTitle --\x3e\r\n    <div class="separator">\r\n        <p class="strong" data-bind="text: listTitle"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: showEmptyListText --\x3e\r\n    <li class="grid container">\r\n        <p data-bind="text: emptyListText"></p>\r\n    </li>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: listHasContacts --\x3e\r\n    \x3c!-- ko foreach: { data: contacts, as: \'contact\' } --\x3e\r\n    <li class="list-selectable searchItem clearfix Avatar-whiteThemeHover" role="menuitem" data-bind="attr: { \'data-title\': $parent.getSearchItemDetails(contact, $index()) },\r\n    event: { click: $parent.openConversation, contextmenu: $parent.showContextMenu }, enterKey: $parent.openConversation, css: { active: contact.isActive }">\r\n        <swx-avatar params="status: contact.statusClassName, avatar: contact.avatar, isAgent: contact.isAgent, displayName: contact.displayNameUnescaped, isPstn: contact.isPstn"></swx-avatar>\r\n        <span class="text">\r\n            <span class="arrow"></span>\r\n            <span class="tileName">\r\n                <h4 data-bind="text: contact.displayNameUnescaped"></h4>\r\n            </span>\r\n            \x3c!-- ko if: contact.displayMessage --\x3e\r\n            <span class="message">\r\n                <p class="small" data-bind="html: contact.displayMessage"></p>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n        </span>\r\n    </li>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</ul>\r\n'})),define("ui/components/people/directorySearch",["require","exports","module","ui/viewModels/people/directoryList","constants/components","text!views/people/list.html"],(function(e,t){var n=e("ui/viewModels/people/directoryList")
	t.name=e("constants/components").people.DIRECTORY_SEARCH,t.template=e("text!views/people/list.html"),t.viewModel={createViewModel:function(){var e=new n
	return e.init(),e}}})),define("ui/viewModels/people/discoverAgentsPage",["require","swx-cafe-application-instance","usertiming","swx-constants","ui/viewModels/chat/navigationHelper","constants/components","browser/dom","ui/telemetry/actions/actionNames","experience/settings","ui/telemetry/telemetryClient","services/telemetry/common/afterRenderHandler","ui/viewModels/people/baseContactList","swx-service-locator-instance","ui/telemetry/actions/actionSources","ui/viewModels/people/contactListHelper","constants/cssClasses","swx-enums","vendor/knockout","ui/contextMenu/items/all","ui/contextMenu/contextMenu","swx-pubsub-instance","swx-focus-handler"],(function(e){var t=e("swx-cafe-application-instance"),n=e("usertiming"),i=e("swx-constants").COMMON,r=e("ui/viewModels/chat/navigationHelper"),o=i.events.navigation,a=e("constants/components"),s=e("browser/dom"),c=e("ui/telemetry/actions/actionNames"),l=e("experience/settings"),u=e("ui/telemetry/telemetryClient"),d=e("services/telemetry/common/afterRenderHandler"),p=e("ui/viewModels/people/baseContactList"),f=e("swx-service-locator-instance").default,m=e("ui/telemetry/actions/actionSources"),h=e("ui/viewModels/people/contactListHelper"),v=e("constants/cssClasses"),g=e("swx-enums"),y=e("vendor/knockout"),b=e("ui/contextMenu/items/all"),_=e("ui/contextMenu/contextMenu"),E=e("swx-pubsub-instance").default,w=e("swx-focus-handler"),S=null,x=i.telemetry,C=x.performanceMarks.DISCOVER_AGENTS.PAGE,T=x.measurements.DISCOVER_AGENTS.PAGE,I=i.telemetry.historyLoadOrigin.DISCOVER_AGENTS_PAGE,A={source:m.discoverAgentsPage.agent}
	function M(){var e=this,t=f.resolve(i.serviceLocator.FEATURE_FLAGS)
	p.call(e),e.templateName="contactList-agents",e.agentsDiscoverable=t.isFeatureOn(i.featureFlags.AGENTS_DISCOVERABLE),e.menuItems=[],e.searchInProgress=y.observable(!1),e.hasResults=y.computed((function(){return!e.searchInProgress()&&!!e.contactGroups().length})),e.hasZeroResults=y.computed((function(){return!e.searchInProgress()&&0===e.contactGroups().length}))}function O(){return n.getEntriesByName(C.OPENED).length>0}function k(e){e===a.people.DISCOVER_AGENTS_PAGE&&w.get().addFocusRequestToQueue(S)}return M.prototype=new p,M.prototype.constructor=M,M.prototype.init=function(e,t){var i
	return this.agentsDiscoverable?(S=s.getElement("."+v.discoverAgents.PAGE,t),O()&&(n.mark(C.INITIALIZED),n.measure(T.TTC,C.OPENED,C.INITIALIZED)),i=p.prototype.init.call(this,e,S),function(e){w.get().addFocusRequestToQueue(e),E.subscribe(o.FRAGMENT_LOADED,k)}(S),i):(r.navigateToContactsPage(),Promise.resolve())},M.prototype.dispose=function(){S=null,this.hasResults.dispose(),this.hasZeroResults.dispose(),E.unsubscribe(o.FRAGMENT_LOADED,k),p.prototype.dispose.call(this)},M.prototype.afterRender=function(){var e=this,t=d(e.contactGroups().length,(function(){O()&&(n.mark(C.RENDERED),n.measure(T.TTR,C.OPENED,C.RENDERED),function(e){var t,r={ttc:n.getEntriesByName(T.TTC)[0],ttr:n.getEntriesByName(T.TTR)[0]}
	r.ttc&&r.ttr&&(t={name:i.telemetry.agents.name.DISCOVER_AGENTS_PAGE_PERFORMANCE,timeToComplete:r.ttc.duration.toString(),timeToRender:r.ttr.duration.toString(),contactsCount:e.toString()},u.get().sendEvent(l.telemetry.uiTenantToken,i.telemetry.agents.type.AGENTS,t))
	n.clearMarks(C.OPENED),n.clearMarks(C.INITIALIZED),n.clearMarks(C.RENDERED),n.clearMeasures(T.TTC),n.clearMeasures(T.TTR)}(e.contactsCount()))}))
	return p.prototype.afterRender.call(this,t)},M.prototype.openConversation=function(e,t){var n={origin:I,target:{expandProfile:!0},telemetryContext:A};(function(e){f.resolve(i.serviceLocator.ACTION_TELEMETRY).recordAction(e)})(c.discoverAgents.openConversation),p.prototype.openConversation.call(this,e,t,n)},M.prototype.showContextMenu=function(e,t){var n=[new b.ViewPersonProfileMenuItem(e.getPerson(),I,A)]
	_.show(n,t,A)},M.prototype.shouldPersonBeIncluded=function(e,t){return!h.personExistsInCollection(e,t)},M.prototype.populate=function(e){var n,r=this,o=t.get().personsAndGroupsManager.createPersonSearchQuery(),a=f.resolve(i.serviceLocator.SUBSCRIPTION_PROVIDER).getPersonsObservable()
	function s(){var t=o.results().map((function(e){return e.result}))
	r.populateGroups(t,e),r.searchInProgress(!1)}return r.searchInProgress(!0),r.exclusionList=a(),o.sources(g.searchScope.Agent),(n=o.getMore()).then(s),r.subscriptions.persons=a.subscribe((function(){r.exclusionList=a(),n.then(s)}),null,"arrayChange"),n},M})),define("text!views/people/discoverAgentsPage.html",[],(function(){return'\x3c!-- ko if: agentsDiscoverable --\x3e\r\n<div data-swx-testId="DiscoverAgentsPage" class="DiscoverAgentsPage themeWhite" tabindex="-1">\r\n    <div class="DiscoverAgentsPage--header">\r\n        <h1 class="DiscoverAgentsPage--heading" data-bind="l10n: { key: \'label_text_discover_agents_page_header\' }"></h1>\r\n        <p class="DiscoverAgentsPage--hint" data-bind="l10n: { key: \'label_text_discover_agents_page_hint\' }"></p>\r\n    </div>\r\n    <div data-swx-testId="discoverAgentsPageBody" class="scrollinWrapper DiscoverAgentsPage--body">\r\n        <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n            <div class="scrollingPane themeWhite peoplePicker all">\r\n                \x3c!-- ko if: searchInProgress --\x3e\r\n                <div class="DiscoverAgentsPage--spinner">\r\n                    <swx-loading-animation data-bind="visible: searchInProgress" class="spinner fog"></swx-loading-animation>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: hasResults --\x3e\r\n                \x3c!-- ko template: { name: templateName } --\x3e\x3c!-- /ko --\x3e\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: hasZeroResults --\x3e\r\n                <div class="DiscoverAgentsPage--zero-results">\r\n                    <p data-bind="l10n: { key: \'label_text_discover_agents_page_zero_results_text_part_1\' }"></p>\r\n                    <p data-bind="l10n: { key: \'label_text_discover_agents_page_zero_results_text_part_2\' }"></p>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="contactList-agents">\r\n    <ul class="grid verticalGutter fixSmall" data-bind="foreach: { data: contactGroups, afterRender: afterRender() },\r\n    keyboardNavigation: { itemSelector: \'li.contactTile:not(.swx-hide)\', persistSelection: false }, attr_l10n: {\'aria-label\': \'label_text_discover_agents_page_header\'}">\r\n        <div class="row separator" data-bind="css: { \'swx-hide\': $data.isHidden }">\r\n            <p role="presentation" aria-hidden="true" class="strong" data-bind="text: $data.name"></p>\r\n            <div class="row people">\r\n                \x3c!-- ko foreach: { data: contacts } --\x3e\r\n                <li class="column contactTile searchItem Avatar-whiteThemeHover" data-bind="css: { \'swx-hide\': $data.isHidden, active: $data.isActive },  enterKey: $parentContext.$parent.openConversation,\r\n                event: { click: $parentContext.$parent.openConversation, contextmenu: $parentContext.$parent.showContextMenu }, attr: { \'aria-label\': $data.ariaLabel }">\r\n                    <swx-avatar params="status: $data.statusClassName, avatar: $data.avatar, isAgent: $data.isAgent"></swx-avatar>\r\n                        <span class="text">\r\n                            <span class="tile">\r\n                                <span class="tileName">\r\n                                    <h4>\r\n                                        <span class="topic" data-bind="text: $data.displayName, attr: {title: $data.displayName}"></span>\r\n                                        \x3c!-- ko if: $data.agentDetails() && $data.agentDetails().certification() --\x3e\r\n                                        <span class="iconfont avatarBotCertified"></span>\r\n                                        \x3c!-- /ko --\x3e\r\n                                    </h4>\r\n                                </span>\r\n                            </span>\r\n                            \x3c!-- ko if: $data.displayMessage --\x3e\r\n                            <span class="message tile">\r\n                                <p data-bind="html: $data.displayMessage" data-swx-testId="displayMessage" class="small"></p>\r\n                            </span>\r\n                            \x3c!-- /ko --\x3e\r\n                        </span>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n        </div>\r\n    </ul>\r\n<\/script>\r\n\x3c!-- /ko --\x3e'})),define("ui/components/people/discoverAgentsPage",["require","exports","module","vendor/knockout","constants/cssClasses","ui/viewModels/people/discoverAgentsPage","constants/components","text!views/people/discoverAgentsPage.html"],(function(e,t){var n=e("vendor/knockout"),i=e("constants/cssClasses"),r=e("ui/viewModels/people/discoverAgentsPage")
	function o(){return{className:i.discoverAgents.PAGE,isSelectable:!1}}t.name=e("constants/components").people.DISCOVER_AGENTS_PAGE,t.template=e("text!views/people/discoverAgentsPage.html"),t.viewModel={createViewModel:function(e,t){var i=new r
	return i.setContext(n.dataFor(t.element)),i.init(o(),t.element),i}}})),define("ui/viewModels/people/name",["require","vendor/knockout","ui/viewModels/people/contact","ui/viewModels/people/contactBuilder"],(function(e){var t=e("vendor/knockout"),n=e("ui/viewModels/people/contact"),i=e("ui/viewModels/people/contactBuilder")
	function r(e){var r=this
	r.contact=function(e){if(e instanceof n)return e
	return e._isPartialPersonObject?e:i.build(e)}(e),r.headerImportance=t.observable(4),r.heading=t.computed((function(){return"<h{importance}>{displayName}</h{importance}>".replace(/\{importance\}/g,r.headerImportance()).replace("{displayName}",r.contact.displayName())}))}return r.prototype.dispose=function(){this.heading.dispose(),this.contact.dispose&&this.contact.dispose()},r})),define("text!views/people/name.html",[],(function(){return'<span class="tile" data-bind="css: contact.statusClassName">\r\n    <span class="tileName" data-bind="html: heading"></span>\r\n</span>\r\n'})),define("ui/components/people/name",["require","exports","module","ui/viewModels/people/name","ui/viewModels/people/contact","constants/components","text!views/people/name.html"],(function(e,t){var n=e("ui/viewModels/people/name"),i=e("ui/viewModels/people/contact")
	t.name=e("constants/components").people.NAME,t.template=e("text!views/people/name.html"),t.viewModel={createViewModel:function(e){var t
	if(e&&"object"==typeof e.person)return t=new n(function(e){return e.person instanceof i?e.person.getPerson():e.person}(e)),e.headerImportance&&t.headerImportance(e.headerImportance),t
	throw new Error('missing parameter: "person"')}}})),define("ui/viewModels/people/contactList",["require","lodash-compat","swx-constants","vendor/knockout","swx-constants","swx-i18n","swx-cafe-application-instance","swx-enums","swx-service-locator-instance","ui/contextMenu/contextMenu","ui/contextMenu/items/all","ui/contextMenu/menuItemHelper","ui/telemetry/actions/actionSources","ui/viewModels/people/baseList","ui/telemetry/people/contactSearch"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("vendor/knockout"),r=e("swx-constants").PEOPLE,o=e("swx-i18n").localization,a=e("swx-cafe-application-instance"),s=e("swx-enums"),c=e("swx-service-locator-instance").default,l=e("ui/contextMenu/contextMenu"),u=e("ui/contextMenu/items/all"),d=e("ui/contextMenu/menuItemHelper"),p=e("ui/telemetry/actions/actionSources"),f=e("ui/viewModels/people/baseList"),m=e("ui/telemetry/people/contactSearch"),h=n.events.search
	function v(){var e=this,t=f.prototype
	function v(e){return{source:e,parent:p.searchItem.addressBook}}this.listClass=i.observable(r.contactList.className.LOCAL),this.listTitle=i.observable(o.fetch({key:"message_text_contactTitleLocal"})),this.events={results:h.LOCAL_SEARCH_RESULTS,rendered:h.LOCAL_SEARCH_RESULTS_RENDERED},this.historyLoadOrigin=n.telemetry.historyLoadOrigin.CONTACT_SEARCH,this.searchItemI18nKey="accessibility_searchItem_oneToOne",f.call(e,s.searchScope.AddressBook),this.showListTitle(!0),e.search=function(n){e.contacts([]),t.search.call(e,n,e.events)},e.openConversation=function(i){var r=c.resolve(n.serviceLocator.PUBSUB),o=a.get().conversationsManager.getConversation(i.getPerson()),l={source:p.search.reset.openConversation}
	a.get().conversationsManager.conversations.add(o),r.publish(n.events.search.RESET,l),t.sendOpenConversationEvent.call(e,o),m.onContactSearchEnd({searchScope:s.searchScope.AddressBook,success:!0,resultCount:e.totalSearchResults,clickPosition:t.indexOfSelectedContactInSearchResults.call(e,i),source:p.search.reset.openConversation})},e.showContextMenu=function(e,t){var i={source:p.searchItem.addressBook},r=v(p.contextMenuItem.block),o=v(p.contextMenuItem.unblock),a=v(p.contextMenuItem.deleteItem),s=v(p.contextMenuItem.addContactToFavorites),c=v(p.contextMenuItem.removeContactFromFavorites),f=[]
	f.push(d.getConversationContextMenuItemGroup(e,n.telemetry.historyLoadOrigin.CONTACT_SEARCH,i)),f.push(new u.BlockContactMenuItem(e,r)),f.push(new u.UnblockContactMenuItem(e,o)),f.push(new u.DeleteContactMenuItem(e,a)),f.push(new u.AddContactToFavoritesMenuItem(e,s)),f.push(new u.RemoveContactFromFavoritesMenuItem(e,c)),d.sortMenuItems(f),l.show(f,t,i)}}return v.prototype=t.create(f.prototype,{constructor:v}),v})),define("ui/components/people/peopleSearch",["require","exports","module","ui/viewModels/people/contactList","constants/components","text!views/people/list.html"],(function(e,t){var n=e("ui/viewModels/people/contactList")
	t.name=e("constants/components").people.PEOPLE_SEARCH,t.template=e("text!views/people/list.html"),t.viewModel={createViewModel:function(){var e=new n
	return e.init(),e}}})),define("ui/components/people/index",["require","ui/components/people/avatar","ui/components/people/avatarDeprecated","ui/components/people/contactListMenuItem","ui/components/people/contactPicker","ui/components/people/contactProfile","ui/components/people/contactProfilePhoneNumber","ui/components/people/contactsPage","ui/components/people/directorySearch","ui/components/people/discoverAgentsPage","ui/components/people/name","ui/components/people/peopleSearch"],(function(e){return[e("ui/components/people/avatar"),e("ui/components/people/avatarDeprecated"),e("ui/components/people/contactListMenuItem"),e("ui/components/people/contactPicker"),e("ui/components/people/contactProfile"),e("ui/components/people/contactProfilePhoneNumber"),e("ui/components/people/contactsPage"),e("ui/components/people/directorySearch"),e("ui/components/people/discoverAgentsPage"),e("ui/components/people/name"),e("ui/components/people/peopleSearch")]})),define("experience/components/people",["require","exports","module","ui/components/people/index","ui/components/registrar"],(function(e,t){var n=e("ui/components/people/index"),i=e("ui/components/registrar")
	t.init=function(e){i.register(n),e()}})),define("services/telemetry/eventBus",["require","swx-pubsub-instance"],(function(e){var t=e("swx-pubsub-instance").default
	return{get:function(){return t}}})),define("services/telemetry/common/telemetry",["require","exports","module","services/telemetry/eventBus","services/telemetry/skypeData"],(function(e,t){var n=e("services/telemetry/eventBus"),i=e("services/telemetry/skypeData")
	t.instrumentEvent=function(e,t){n.get().subscribe(e,function(e){return function(t){var n=e?e(t):t
	i.push(n)}}(t))},t.instrumentAllEvents=function(e){Object.keys(e).forEach((function(n){t.instrumentEvent(n,e[n])}))}})),define("services/telemetry/common/instrumentation",["require","lodash-compat","swx-cafe-application-instance","swx-enums"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("swx-enums")
	function r(e){var t={}
	return Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[e.eventName]=function(e,t,n,i){return function(r){var c={type:t,data:{name:e},contextIds:{},isPluginInstalled:a(),mePersonId:s()}
	return o(r=r||{},n,c.data),o(r,i,c.contextIds),c}}(e.telemetryName,n,e.extensions,e.newContextIds)}))})),t}function o(e,n,i){if(n){if("function"==typeof n)return t.merge(i,n(e))
	n.forEach((function(t){null!==e[t]&&void 0!==e[t]&&(i[t]=e[t])}))}}function a(){return n.get().personsAndGroupsManager&&n.get().personsAndGroupsManager.mePerson?n.get().personsAndGroupsManager.mePerson.capabilities.audio.reason!==i.callingNotSupportedReasons.PluginNotInstalled:"unknown"}function s(){return n.get().personsAndGroupsManager&&n.get().personsAndGroupsManager.mePerson?n.get().personsAndGroupsManager.mePerson.id():"unknown"}return{create:function(e){return r(e)}}})),define("services/telemetry/calling.instrumentation.eventTypes",["require","swx-constants"],(function(e){var t=e("swx-constants").CALLING
	return{Calling:[{eventName:t.EVENTS.START_CALL,telemetryName:"AttemptCall",extensions:function(e){return{source:e.source,conversationType:n(e.conversation),modality:i(e.isVideo)}}},{eventName:t.EVENTS.ANSWER,telemetryName:"AcceptCall",extensions:function(e){return{conversationType:n(e.conversation),modality:i(e.isVideo)}}},{eventName:t.EVENTS.REJECT,telemetryName:"RejectCall",extensions:function(e){return{conversationType:n(e.conversation),modality:i(e.isVideo)}}}],TrouterInit:[{eventName:t.EVENTS.INCOMING_INIT_ERROR,telemetryName:"IncomingInitialisationError"},{eventName:t.EVENTS.INCOMING_INIT_SUCCESS,telemetryName:"IncomingInitialisationSuccess",extensions:["durationInMs"]}]}
	function n(e){return e.isGroupConversation()?"multiparty":"single"}function i(e){return e?"video":"audio"}})),define("text!views/calling/endCallButton.html",[],(function(){return'<button data-bind="click: endCall, enable: isCallControlEnabled(), css: { disabled: !isCallControlEnabled() }, l10n_attr: { \'title\': \'callscreen_text_endCall\' }" class="btn small red circle endCall" type="button">\r\n    <span class="iconfont callEnd" data-bind="l10n: { \'key\': \'callscreen_text_endCall\' }"></span>\r\n</button>\r\n'})),define("ui/viewModels/calling/baseCallControlViewModel",["require","vendor/knockout","utils/common/cafeObservable","swx-enums"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/cafeObservable"),i=e("swx-enums")
	return function(e,r){var o=n.newObservableProperty(e.selfParticipant.audio.state)
	this.isCallControlEnabled=t.computed((function(){return function(e){return e===i.callConnectionState.Connecting||e===i.callConnectionState.Ringing||e===i.callConnectionState.EarlyMedia||e===i.callConnectionState.Connected}(o())&&(!r||r())})),this.isCallConnected=t.computed((function(){return o()===i.callConnectionState.Connected})),this.dispose=function(){o.dispose(),this.isCallControlEnabled.dispose(),this.isCallConnected.dispose()}}})),define("ui/viewModels/calling/endCallControlViewModel",["require","ui/viewModels/calling/baseCallControlViewModel","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance","ui/calling/unansweredCallHandler"],(function(e){var t=e("ui/viewModels/calling/baseCallControlViewModel"),n=e("ui/telemetry/actions/actionNames"),i=e("swx-constants").COMMON,r=e("swx-service-locator-instance").default,o=e("ui/calling/unansweredCallHandler")
	function a(e,a){t.call(this,e),this.endCall=function(){var t,s
	e.audioService.stop(),o.callHungUpByCaller(),t=r.resolve(i.serviceLocator.ACTION_TELEMETRY),s=a?n.audioVideo.endCall:n.audioVideo.timeline.endCall,t.recordAction(s)}}return a.prototype=Object.create(t.prototype),a.prototype.constructor=a,{build:function(e,t){return new a(e,t)}}})),define("ui/controls/calling/endCallControl",["require","text!views/calling/endCallButton.html","vendor/knockout","swx-constants","ui/viewModels/calling/endCallControlViewModel"],(function(e){var t=e("text!views/calling/endCallButton.html"),n=e("vendor/knockout"),i=e("swx-constants").CALLING,r=e("ui/viewModels/calling/endCallControlViewModel")
	return{name:i.CONTROLS.END_CALL_CONTROL,render:function(e,i){var o,a=document.createElement("div"),s=e.conversation
	o=r.build(s),a.innerHTML=t,n.applyBindings(o,a),i(a.firstElementChild)}}})),define("text!views/calling/muteButton.html",[],(function(){return'<button data-bind="click: toggleMicrophone, css: { disabled: !isMicrophoneButtonEnabled() }, attr: { title: microphoneStateText(), \'aria-disabled\': isMicrophoneButtonEnabled() }" class="btn small primary circle toggleMic" type="button">\r\n    <span class="iconfont microphoneOn" data-bind="css: { microphoneOff: !isMicrophoneOn() }, text: microphoneStateText"></span>\r\n</button>\r\n'})),define("ui/viewModels/calling/micControlViewModel",["require","ui/viewModels/calling/baseCallControlViewModel","vendor/knockout","utils/common/cafeObservable","swx-i18n","swx-cafe-application-instance","utils/common/eventHelper","ui/telemetry/actions/actionNames","swx-constants","swx-service-locator-instance"],(function(e){var t=e("ui/viewModels/calling/baseCallControlViewModel"),n=e("vendor/knockout"),i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("swx-cafe-application-instance"),a=e("utils/common/eventHelper"),s=e("ui/telemetry/actions/actionNames"),c=e("swx-constants").COMMON,l=e("swx-service-locator-instance").default
	function u(e,u){var d=this,p=i.newObservableProperty(o.get().devicesManager.selectedMicrophone),f=i.newObservableProperty(e.selfParticipant.audio.isMuted),m=i.newObservableProperty(e.selfParticipant.audio.isMuted.set.enabled)
	t.call(d,e,m),d.isMicrophoneAvailable=n.computed((function(){return null!==p()})),d.isMicrophoneOn=n.computed((function(){return d.isMicrophoneAvailable()&&!f()})),d.microphoneStateText=n.computed((function(){return d.isMicrophoneOn()?r.fetch({key:"callscreen_text_microphoneOff"}):r.fetch({key:"callscreen_text_microphoneOn"})})),d.isMicrophoneButtonEnabled=n.computed((function(){return d.isMicrophoneAvailable()&&d.isCallControlEnabled()})),d.toggleMicrophone=function(t,n){var i,r
	d.isMicrophoneButtonEnabled()&&(e.selfParticipant.audio.isMuted(d.isMicrophoneOn()),i=l.resolve(c.serviceLocator.ACTION_TELEMETRY),r=u?s.audioVideo.toggleMute:s.audioVideo.timeline.toggleMute,i.recordAction(r)),a.swallow(n)},d.dispose=function(){p.dispose(),d.microphoneStateText.dispose(),f.dispose()}}return u.prototype=Object.create(t.prototype),u.prototype.constructor=u,{build:function(e,t){return new u(e,t)}}})),define("ui/controls/calling/micControl",["require","text!views/calling/muteButton.html","vendor/knockout","swx-constants","ui/viewModels/calling/micControlViewModel"],(function(e){var t=e("text!views/calling/muteButton.html"),n=e("vendor/knockout"),i=e("swx-constants").CALLING,r=e("ui/viewModels/calling/micControlViewModel")
	return{name:i.CONTROLS.MUTE_CONTROL,render:function(e,i){var o,a=document.createElement("div"),s=e.conversation
	o=r.build(s),a.innerHTML=t,n.applyBindings(o,a),i(a.firstElementChild)}}})),define("ui/viewModels/calling/callScreenViewModel/callState",["require","swx-constants","swx-enums","vendor/knockout"],(function(e){var t=e("swx-constants").CALLING.CALL_STATES,n=e("swx-enums"),i=e("vendor/knockout")
	function r(e){var r,o=this,a=[],s=[],c=[],l=null
	function u(){o.state()===t.ENDING?r=window.setTimeout(d,3500):window.clearTimeout(r)}function d(){o.state(t.ENDED)}function p(){o.state()!==t.ENDING&&o.state(t.CONNECTING)}function f(i,r){r&&r!==n.callConnectionState.Disconnected&&(e.selfParticipant.audio.state.reason!==n.callDisconnectionReason.CallEscalated?(o.totalCallDuration=o.getCurrentDuration(),o.state(t.ENDING)):o.state(t.ENDED))}function m(){o.state()!==t.EARLY_MEDIA&&o.state()!==t.ENDING&&o.state(t.CALLING)}function h(){o.state()!==t.ENDING&&(m(),o.state(t.EARLY_MEDIA))}function v(){o.state()!==t.ENDING&&(l=e.audioService.callConnected(),o.state(t.CONNECTED),g())}function g(){E(c),E(s)}function y(e){function t(t,n){var i=e.audio.state.when(t,n)
	i.participant=e,c.push(i)}t(n.callConnectionState.Ringing,m),t(n.callConnectionState.EarlyMedia,h),t(n.callConnectionState.Disconnected,_)}function b(e){for(var t=c.length;t--;){var n=c[t]
	n.participant===e&&(c.splice(t,1),n.dispose())}_()}function _(){var i=e.participants().some((function(e){return e.audio.state()===n.callConnectionState.EarlyMedia}))
	o.state()!==t.EARLY_MEDIA||i||o.state(t.CALLING)}function E(e){e.forEach((function(e){e.dispose()})),e.length=0}this.state=i.observable(t.CONNECTING),this.totalCallDuration=null,this.dispose=function(){E(a),g(),window.clearTimeout(r)},this.getCurrentDuration=function(){return null!==l?Date.now()-l:null},a.push(o.state.subscribe(u),e.selfParticipant.audio.state.when(n.callConnectionState.Connecting,p),e.selfParticipant.audio.state.when(n.callConnectionState.Connected,v),e.selfParticipant.audio.state.when(n.callConnectionState.Disconnecting,f),e.selfParticipant.audio.state.when(n.callConnectionState.Disconnected,f)),e.selfParticipant.audio.state()!==n.callConnectionState.Connected&&s.push(e.participants.added(y)),s.push(e.participants.removed(b))}return{build:function(e){return new r(e)}}})),define("telemetry/calling/devicesTracker",["require","exports","module","swx-cafe-application-instance","swx-constants","swx-util-calling-stack","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-constants").COMMON,r=e("swx-util-calling-stack"),o=e("experience/settings"),a=e("ui/telemetry/telemetryClient")
	t.reportCurrentDeviceCount=function(){var e=n.get().devicesManager
	if(r.get().isInBrowserCallingSupported()){var t={camerasCount:e.cameras().length,speakersCount:e.speakers().length,microphonesCount:e.microphones().length}
	a.get().sendEvent(o.telemetry.uiTenantToken,i.telemetry.calling.DEVICES,t)}}})),define("utils/common/elementQueryHelper",["require","exports","module","browser/window"],(function(e,t){var n=e("browser/window"),i={".swx .av":{"max-width":["680px","600px","420px","320px","305px"],"max-height":["600px","480px","420px"]}}
	t.initialiseSelectors=function(){n.elementQuery&&n.elementQuery(i)},t.refresh=function(){n.elementQuery&&n.elementQuery()}})),define("utils/common/focusRestrictor",["require","exports","module","lodash-compat"],(function(e,t){var n=e("lodash-compat")
	function i(e,t){var i={}
	this.restrict=function(){var r,o=[],a='[tabindex="0"], a, button, input, select, textarea'
	r=Array.prototype.slice.call(document.querySelectorAll(a)),t&&t.forEach((function(e){var t=document.querySelector(e)
	t&&(o=Array.prototype.concat.call(o,Array.prototype.slice.call(t.querySelectorAll(a))))})),n.difference(r,o).forEach((function(t){var n=t.getAttribute("tabindex"),r="-100"
	e.contains(t)||n===r||(i[Object.keys(i).length]={element:t,tabIndex:n},t.setAttribute("tabindex",r))}))},this.restore=function(){Object.keys(i).forEach((function(e){var t=i[e]
	t.tabIndex?t.element.setAttribute("tabindex",t.tabIndex):t.element.removeAttribute("tabindex")})),i={}}}t.build=function(e,t){return new i(e,t)}})),
	/*!
	* Sizzle CSS Selector Engine v@VERSION
	* http://sizzlejs.com/
	*
	* Copyright 2013 jQuery Foundation, Inc. and other contributors
	* Released under the MIT license
	* http://jquery.org/license
	*
	* Date: @DATE
	*/
	function(e,t){var n,i,r,o,a,s,c,l,u,d,p,f,m,h,v,g,y="sizzle"+-new Date,b=e.document,_={},E=0,w=0,S=oe(),x=oe(),C=oe(),T=!1,I=function(){return 0},A=typeof t,M=1<<31,O=_.hasOwnProperty,k=[],N=k.pop,P=k.push,R=k.push,L=k.slice,D=k.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(this[t]===e)return t
	return-1},U="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",F="[\\x20\\t\\r\\n\\f]",B="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",V=B.replace("w","w#"),G="\\["+F+"*("+B+")"+F+"*(?:([*^$|!~]?=)"+F+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+V+")|)|)"+F+"*\\]",H=":("+B+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+G.replace(3,8)+")*)|.*)\\)|)",q=new RegExp("^"+F+"+|((?:^|[^\\\\])(?:\\\\.)*)"+F+"+$","g"),W=new RegExp("^"+F+"*,"+F+"*"),j=new RegExp("^"+F+"*([>+~]|"+F+")"+F+"*"),z=new RegExp(F+"*[+~]"),K=new RegExp("="+F+"*([^\\]'\"]*)"+F+"*\\]","g"),Y=new RegExp(H),Q=new RegExp("^"+V+"$"),X={ID:new RegExp("^#("+B+")"),CLASS:new RegExp("^\\.("+B+")"),TAG:new RegExp("^("+B.replace("w","w*")+")"),ATTR:new RegExp("^"+G),PSEUDO:new RegExp("^"+H),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+F+"*(even|odd|(([+-]|)(\\d*)n|)"+F+"*(?:([+-]|)"+F+"*(\\d+)|))"+F+"*\\)|)","i"),bool:new RegExp("^(?:"+U+")$","i"),needsContext:new RegExp("^"+F+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+F+"*((?:-\\d)?\\d*)"+F+"*\\)|)(?=[^-]|$)","i")},$=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Z=/^(?:input|select|textarea|button)$/i,ee=/^h\d$/i,te=/'|\\/g,ne=/\\([\da-fA-F]{1,6}[\x20\t\r\n\f]?|.)/g,ie=function(e,t){var n="0x"+t-65536
	return n!=n?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)}
	try{R.apply(k=L.call(b.childNodes),b.childNodes),k[b.childNodes.length].nodeType}catch(Se){R={apply:k.length?function(e,t){P.apply(e,L.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}function re(e){return $.test(e+"")}function oe(){var e,t=[]
	return e=function(n,i){return t.push(n+=" ")>r.cacheLength&&delete e[t.shift()],e[n]=i}}function ae(e){return e[y]=!0,e}function se(e){var t=d.createElement("div")
	try{return!!e(t)}catch(Se){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function ce(e,t,n,i){var o,a,c,l,p,h,v,E,w,S
	if((t?t.ownerDocument||t:b)!==d&&u(t),n=n||[],!e||"string"!=typeof e)return n
	if(1!==(l=(t=t||d).nodeType)&&9!==l)return[]
	if(f&&!i){if(o=J.exec(e))if(c=o[1]){if(9===l){if(!(a=t.getElementById(c))||!a.parentNode)return n
	if(a.id===c)return n.push(a),n}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(c))&&g(t,a)&&a.id===c)return n.push(a),n}else{if(o[2])return R.apply(n,t.getElementsByTagName(e)),n
	if((c=o[3])&&_.getElementsByClassName&&t.getElementsByClassName)return R.apply(n,t.getElementsByClassName(c)),n}if(_.qsa&&(!m||!m.test(e))){if(E=v=y,w=t,S=9===l&&e,1===l&&"object"!==t.nodeName.toLowerCase()){for(h=he(e),(v=t.getAttribute("id"))?E=v.replace(te,"\\$&"):t.setAttribute("id",E),E="[id='"+E+"'] ",p=h.length;p--;)h[p]=E+ve(h[p])
	w=z.test(e)&&t.parentNode||t,S=h.join(",")}if(S)try{return R.apply(n,w.querySelectorAll(S)),n}catch(x){}finally{v||t.removeAttribute("id")}}}return function(e,t,n,i){var o,a,c,l,u,d=he(e)
	if(!i&&1===d.length){if((a=d[0]=d[0].slice(0)).length>2&&"ID"===(c=a[0]).type&&9===t.nodeType&&f&&r.relative[a[1].type]){if(!(t=(r.find.ID(c.matches[0].replace(ne,ie),t)||[])[0]))return n
	e=e.slice(a.shift().value.length)}for(o=X.needsContext.test(e)?0:a.length;o--&&(c=a[o],!r.relative[l=c.type]);)if((u=r.find[l])&&(i=u(c.matches[0].replace(ne,ie),z.test(a[0].type)&&t.parentNode||t))){if(a.splice(o,1),!(e=i.length&&ve(a)))return R.apply(n,i),n
	break}}return s(e,d)(i,t,!f,n,z.test(e)),n}(e.replace(q,"$1"),t,n,i)}function le(e,t){var n=t&&e,i=n&&(~t.sourceIndex||M)-(~e.sourceIndex||M)
	if(i)return i
	if(n)for(;n=n.nextSibling;)if(n===t)return-1
	return e?1:-1}function ue(e,n,i){var r
	return i?t:(r=e.getAttributeNode(n))&&r.specified?r.value:!0===e[n]?n.toLowerCase():null}function de(e,n,i){return i?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}function pe(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function fe(e){return function(t){var n=t.nodeName.toLowerCase()
	return("input"===n||"button"===n)&&t.type===e}}function me(e){return ae((function(t){return t=+t,ae((function(n,i){for(var r,o=e([],n.length,t),a=o.length;a--;)n[r=o[a]]&&(n[r]=!(i[r]=n[r]))}))}))}for(n in a=ce.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement
	return!!t&&"HTML"!==t.nodeName},u=ce.setDocument=function(e){var n=e?e.ownerDocument||e:b
	return n!==d&&9===n.nodeType&&n.documentElement?(d=n,p=n.documentElement,f=!a(n),_.getElementsByTagName=se((function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length})),_.attributes=se((function(e){return e.className="i",!e.getAttribute("className")})),_.getElementsByClassName=se((function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length})),_.sortDetached=se((function(e){return 1&e.compareDocumentPosition(d.createElement("div"))})),_.getById=se((function(e){return p.appendChild(e).id=y,!n.getElementsByName||!n.getElementsByName(y).length})),_.getById?(r.find.ID=function(e,t){if(typeof t.getElementById!==A&&f){var n=t.getElementById(e)
	return n&&n.parentNode?[n]:[]}},r.filter.ID=function(e){var t=e.replace(ne,ie)
	return function(e){return e.getAttribute("id")===t}}):(r.find.ID=function(e,n){if(typeof n.getElementById!==A&&f){var i=n.getElementById(e)
	return i?i.id===e||typeof i.getAttributeNode!==A&&i.getAttributeNode("id").value===e?[i]:t:[]}},r.filter.ID=function(e){var t=e.replace(ne,ie)
	return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id")
	return n&&n.value===t}}),r.find.TAG=_.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==A)return t.getElementsByTagName(e)}:function(e,t){var n,i=[],r=0,o=t.getElementsByTagName(e)
	if("*"===e){for(;n=o[r++];)1===n.nodeType&&i.push(n)
	return i}return o},r.find.CLASS=_.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==A&&f)return t.getElementsByClassName(e)},h=[],m=[],(_.qsa=re(n.querySelectorAll))&&(se((function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||m.push("\\["+F+"*(?:value|"+U+")"),e.querySelectorAll(":checked").length||m.push(":checked")})),se((function(e){var t=d.createElement("input")
	t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&m.push("[*^$]="+F+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")}))),(_.matchesSelector=re(v=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&se((function(e){_.disconnectedMatch=v.call(e,"div"),v.call(e,"[s!='']:x"),h.push("!=",H)})),m=m.length&&new RegExp(m.join("|")),h=h.length&&new RegExp(h.join("|")),g=re(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode
	return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0
	return!1},I=p.compareDocumentPosition?function(e,t){if(e===t)return T=!0,0
	var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t)
	return i?1&i||!_.sortDetached&&t.compareDocumentPosition(e)===i?e===n||g(b,e)?-1:t===n||g(b,t)?1:l?D.call(l,e)-D.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var i,r=0,o=e.parentNode,a=t.parentNode,s=[e],c=[t]
	if(e===t)return T=!0,0
	if(!o||!a)return e===n?-1:t===n?1:o?-1:a?1:l?D.call(l,e)-D.call(l,t):0
	if(o===a)return le(e,t)
	for(i=e;i=i.parentNode;)s.unshift(i)
	for(i=t;i=i.parentNode;)c.unshift(i)
	for(;s[r]===c[r];)r++
	return r?le(s[r],c[r]):s[r]===b?-1:c[r]===b?1:0},d):d},ce.matches=function(e,t){return ce(e,null,null,t)},ce.matchesSelector=function(e,t){if((e.ownerDocument||e)!==d&&u(e),t=t.replace(K,"='$1']"),_.matchesSelector&&f&&(!h||!h.test(t))&&(!m||!m.test(t)))try{var n=v.call(e,t)
	if(n||_.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(Se){}return ce(t,d,null,[e]).length>0},ce.contains=function(e,t){return(e.ownerDocument||e)!==d&&u(e),g(e,t)},ce.attr=function(e,n){(e.ownerDocument||e)!==d&&u(e)
	var i=r.attrHandle[n.toLowerCase()],o=i&&(O.call(r.attrHandle,n.toLowerCase())?i(e,n,!f):t)
	return o===t?_.attributes||!f?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ce.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},ce.uniqueSort=function(e){var t,n=[],i=0,r=0
	if(T=!_.detectDuplicates,l=!_.sortStable&&e.slice(0),e.sort(I),T){for(;t=e[r++];)t===e[r]&&(i=n.push(r))
	for(;i--;)e.splice(n[i],1)}return e},o=ce.getText=function(e){var t,n="",i=0,r=e.nodeType
	if(r){if(1===r||9===r||11===r){if("string"==typeof e.textContent)return e.textContent
	for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===r||4===r)return e.nodeValue}else for(;t=e[i];i++)n+=o(t)
	return n},r=ce.selectors={cacheLength:50,createPseudo:ae,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(ne,ie),e[3]=(e[4]||e[5]||"").replace(ne,ie),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ce.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ce.error(e[0]),e},PSEUDO:function(e){var t,n=!e[5]&&e[2]
	return X.CHILD.test(e[0])?null:(e[4]?e[2]=e[4]:n&&Y.test(n)&&(t=he(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(ne,ie).toLowerCase()
	return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=S[e+" "]
	return t||(t=new RegExp("(^|"+F+")"+e+"("+F+"|$)"))&&S(e,(function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")}))},ATTR:function(e,t,n){return function(i){var r=ce.attr(i,e)
	return null==r?"!="===t:!t||(r+="","="===t?r===n:"!="===t?r!==n:"^="===t?n&&0===r.indexOf(n):"*="===t?n&&r.indexOf(n)>-1:"$="===t?n&&r.slice(-n.length)===n:"~="===t?(" "+r+" ").indexOf(n)>-1:"|="===t&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,i,r){var o="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t
	return 1===i&&0===r?function(e){return!!e.parentNode}:function(t,n,c){var l,u,d,p,f,m,h=o!==a?"nextSibling":"previousSibling",v=t.parentNode,g=s&&t.nodeName.toLowerCase(),b=!c&&!s
	if(v){if(o){for(;h;){for(d=t;d=d[h];)if(s?d.nodeName.toLowerCase()===g:1===d.nodeType)return!1
	m=h="only"===e&&!m&&"nextSibling"}return!0}if(m=[a?v.firstChild:v.lastChild],a&&b){for(f=(l=(u=v[y]||(v[y]={}))[e]||[])[0]===E&&l[1],p=l[0]===E&&l[2],d=f&&v.childNodes[f];d=++f&&d&&d[h]||(p=f=0)||m.pop();)if(1===d.nodeType&&++p&&d===t){u[e]=[E,f,p]
	break}}else if(b&&(l=(t[y]||(t[y]={}))[e])&&l[0]===E)p=l[1]
	else for(;(d=++f&&d&&d[h]||(p=f=0)||m.pop())&&((s?d.nodeName.toLowerCase()!==g:1!==d.nodeType)||!++p||(b&&((d[y]||(d[y]={}))[e]=[E,p]),d!==t)););return(p-=r)===i||p%i==0&&p/i>=0}}},PSEUDO:function(e,t){var n,i=r.pseudos[e]||r.setFilters[e.toLowerCase()]||ce.error("unsupported pseudo: "+e)
	return i[y]?i(t):i.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ae((function(e,n){for(var r,o=i(e,t),a=o.length;a--;)e[r=D.call(e,o[a])]=!(n[r]=o[a])})):function(e){return i(e,0,n)}):i}},pseudos:{not:ae((function(e){var t=[],n=[],i=s(e.replace(q,"$1"))
	return i[y]?ae((function(e,t,n,r){for(var o,a=i(e,null,r,[]),s=e.length;s--;)(o=a[s])&&(e[s]=!(t[s]=o))})):function(e,r,o){return t[0]=e,i(t,null,o,n),!n.pop()}})),has:ae((function(e){return function(t){return ce(e,t).length>0}})),contains:ae((function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}})),lang:ae((function(e){return Q.test(e||"")||ce.error("unsupported lang: "+e),e=e.replace(ne,ie).toLowerCase(),function(t){var n
	do{if(n=f?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType)
	return!1}})),target:function(t){var n=e.location&&e.location.hash
	return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase()
	return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1
	return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return ee.test(e.nodeName)},input:function(e){return Z.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase()
	return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t
	return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:me((function(){return[0]})),last:me((function(e,t){return[t-1]})),eq:me((function(e,t,n){return[n<0?n+t:n]})),even:me((function(e,t){for(var n=0;n<t;n+=2)e.push(n)
	return e})),odd:me((function(e,t){for(var n=1;n<t;n+=2)e.push(n)
	return e})),lt:me((function(e,t,n){for(var i=n<0?n+t:n;--i>=0;)e.push(i)
	return e})),gt:me((function(e,t,n){for(var i=n<0?n+t:n;++i<t;)e.push(i)
	return e}))}},{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[n]=pe(n)
	for(n in{submit:!0,reset:!0})r.pseudos[n]=fe(n)
	function he(e,t){var n,i,o,a,s,c,l,u=x[e+" "]
	if(u)return t?0:u.slice(0)
	for(s=e,c=[],l=r.preFilter;s;){for(a in n&&!(i=W.exec(s))||(i&&(s=s.slice(i[0].length)||s),c.push(o=[])),n=!1,(i=j.exec(s))&&(n=i.shift(),o.push({value:n,type:i[0].replace(q," ")}),s=s.slice(n.length)),r.filter)!(i=X[a].exec(s))||l[a]&&!(i=l[a](i))||(n=i.shift(),o.push({value:n,type:a,matches:i}),s=s.slice(n.length))
	if(!n)break}return t?s.length:s?ce.error(e):x(e,c).slice(0)}function ve(e){for(var t=0,n=e.length,i="";t<n;t++)i+=e[t].value
	return i}function ge(e,t,n){var r=t.dir,o=n&&"parentNode"===r,a=w++
	return t.first?function(t,n,i){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,i)}:function(t,n,s){var c,l,u,d=E+" "+a
	if(s){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,s))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if((l=(u=t[y]||(t[y]={}))[r])&&l[0]===d){if(!0===(c=l[1])||c===i)return!0===c}else if((l=u[r]=[d])[1]=e(t,n,s)||i,!0===l[1])return!0}}function ye(e){return e.length>1?function(t,n,i){for(var r=e.length;r--;)if(!e[r](t,n,i))return!1
	return!0}:e[0]}function be(e,t,n,i,r){for(var o,a=[],s=0,c=e.length,l=null!=t;s<c;s++)(o=e[s])&&(n&&!n(o,i,r)||(a.push(o),l&&t.push(s)))
	return a}function _e(e,t,n,i,r,o){return i&&!i[y]&&(i=_e(i)),r&&!r[y]&&(r=_e(r,o)),ae((function(o,a,s,c){var l,u,d,p=[],f=[],m=a.length,h=o||function(e,t,n){for(var i=0,r=t.length;i<r;i++)ce(e,t[i],n)
	return n}(t||"*",s.nodeType?[s]:s,[]),v=!e||!o&&t?h:be(h,p,e,s,c),g=n?r||(o?e:m||i)?[]:a:v
	if(n&&n(v,g,s,c),i)for(l=be(g,f),i(l,[],s,c),u=l.length;u--;)(d=l[u])&&(g[f[u]]=!(v[f[u]]=d))
	if(o){if(r||e){if(r){for(l=[],u=g.length;u--;)(d=g[u])&&l.push(v[u]=d)
	r(null,g=[],l,c)}for(u=g.length;u--;)(d=g[u])&&(l=r?D.call(o,d):p[u])>-1&&(o[l]=!(a[l]=d))}}else g=be(g===a?g.splice(m,g.length):g),r?r(null,a,g,c):R.apply(a,g)}))}function Ee(e){for(var t,n,i,o=e.length,a=r.relative[e[0].type],s=a||r.relative[" "],l=a?1:0,u=ge((function(e){return e===t}),s,!0),d=ge((function(e){return D.call(t,e)>-1}),s,!0),p=[function(e,n,i){return!a&&(i||n!==c)||((t=n).nodeType?u(e,n,i):d(e,n,i))}];l<o;l++)if(n=r.relative[e[l].type])p=[ge(ye(p),n)]
	else{if((n=r.filter[e[l].type].apply(null,e[l].matches))[y]){for(i=++l;i<o&&!r.relative[e[i].type];i++);return _e(l>1&&ye(p),l>1&&ve(e.slice(0,l-1)).replace(q,"$1"),n,l<i&&Ee(e.slice(l,i)),i<o&&Ee(e=e.slice(i)),i<o&&ve(e))}p.push(n)}return ye(p)}function we(){}s=ce.compile=function(e,t){var n,o=[],a=[],s=C[e+" "]
	if(!s){for(t||(t=he(e)),n=t.length;n--;)(s=Ee(t[n]))[y]?o.push(s):a.push(s)
	s=C(e,function(e,t){var n=0,o=t.length>0,a=e.length>0,s=function(s,l,u,p,f){var m,h,v,g=[],y=0,b="0",_=s&&[],w=null!=f,S=c,x=s||a&&r.find.TAG("*",f&&l.parentNode||l),C=E+=null==S?1:Math.random()||.1
	for(w&&(c=l!==d&&l,i=n);null!=(m=x[b]);b++){if(a&&m){for(h=0;v=e[h++];)if(v(m,l,u)){p.push(m)
	break}w&&(E=C,i=++n)}o&&((m=!v&&m)&&y--,s&&_.push(m))}if(y+=b,o&&b!==y){for(h=0;v=t[h++];)v(_,g,l,u)
	if(s){if(y>0)for(;b--;)_[b]||g[b]||(g[b]=N.call(p))
	g=be(g)}R.apply(p,g),w&&!s&&g.length>0&&y+t.length>1&&ce.uniqueSort(p)}return w&&(E=C,c=S),_}
	return o?ae(s):s}(a,o))}return s},r.pseudos.nth=r.pseudos.eq,we.prototype=r.filters=r.pseudos,r.setFilters=new we,_.sortStable=y.split("").sort(I).join("")===y,u(),[0,0].sort(I),_.detectDuplicates=T,se((function(e){if(e.innerHTML="<a href='#'></a>","#"!==e.firstChild.getAttribute("href"))for(var t="type|href|height|width".split("|"),n=t.length;n--;)r.attrHandle[t[n]]=de})),se((function(e){if(null!=e.getAttribute("disabled"))for(var t=U.split("|"),n=t.length;n--;)r.attrHandle[t[n]]=ue})),e.Sizzle=ce}(window),define("sizzle",(function(){}))

	;/*! elementQuery | Author: Tyson Matanich (http://matanich.com), 2013 | License: MIT */
	(function(e,t,n){var i=e.Sizzle||jQuery.find,r={},o=null,a=function(e,t,o,a,s){var c
	""!=(e=l(e))&&(a||s||null!=(c=/^([0-9]*.?[0-9]+)(px|em)$/.exec(o))&&(a=Number(c[1]))+""!="NaN"&&(s=c[2]),s&&(i.compile&&i.compile(e),r[e]===n&&(r[e]={}),r[e][t]===n&&(r[e][t]={}),r[e][t][o]=[a,s]))},s=function(e){if(e){var t,i,r,o,s,c,l,u,d=/(\[(min\-width|max\-width|min\-height|max\-height)\~\=(\'|\")([0-9]*.?[0-9]+)(px|em)(\'|\")\])(\[(min\-width|max\-width|min\-height|max\-height)\~\=(\'|\")([0-9]*.?[0-9]+)(px|em)(\'|\")\])?/gi,p=e.split(",")
	for(t=0;t<p.length;t++)for(i=null,s=0,c=0;0==c||null!=r;)null!=(r=d.exec(p[t]))&&((o=Number(r[4]))+""!="NaN"&&(null==i&&(i=p[t].substring(s,r.index),(l=p[t].substring(r.index+r[1].length)).length>0&&0!=(u=l.indexOf(" "))&&(u>0&&(l=l.substring(0,u)),i+=l=l.replace(/(\[(min\-width|max\-width|min\-height|max\-height)\~\=(\'|\")([0-9]*.?[0-9]+)(px|em)(\'|\")\])/gi,""))),a(i,r[2],r[4]+r[5],o,r[5])),r[7]===n||""==r[7]?(s=r.index+r[1].length,i=null):d.lastIndex=r.index+r[1].length),c++}},c=function(e,i){null==o&&function(){if(t.styleSheets[0]){try{t.styleSheets[0].cssRules}catch(e){return}o=t.styleSheets[0].cssRules!==n?"cssRules":"rules"}}()
	try{e[o].length}catch(u){return}if(e[o]&&e[o].length>0){var r=e.ownerNode||e.owningElement
	if(i||null===r.getAttribute("data-elementquery-bypass")&&null===r.getAttribute("data-elementquery-processed")){var a,c,l
	for(a=0;a<e[o].length;a++)if((l=e[o][a])[o]&&l[o].length>0)for(c=0;c<l[o].length;c++)s(l[o][c].selectorText)
	else s(l.selectorText)
	r.setAttribute("data-elementquery-processed","")}}},l=function(e){if(null==e)return""
	var t="".trim
	return t&&!t.call("\ufeff ")?t.call(e):(e+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},u=function(e,t){var n=e.getAttribute(t)
	return n?(" "+n+" ").replace(/[\t\r\n]/g," "):" "},d=function(e,t,n){if(1===e.nodeType){var i=l(n)
	if(""!=i){var r=u(e,t)
	r.indexOf(" "+i+" ")<0&&e.setAttribute(t,l(r+i))}}},p=function(e,t,n){if(1===e.nodeType){var i=l(n)
	if(""!=i){for(var r=u(e,t),o=!1;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," "),o=!0
	o&&e.setAttribute(t,l(r))}}},f=function(){var e
	for(e=0;e<t.styleSheets.length;e++)c(t.styleSheets[e])
	m()},m=function(){var n,o,a,s,c,l,u
	for(n in r)if((c=i(n)).length>0)for(o=0;o<c.length;o++)for(a in l=c[o],r[n])for(s in r[n][a])u=r[n][a][s][0],"em"==r[n][a][s][1]&&(u*=e.getEmPixels?getEmPixels(l):16),"min-width"==a&&l.offsetWidth>=u||"max-width"==a&&l.offsetWidth<=u||"min-height"==a&&l.offsetHeight>=u||"max-height"==a&&l.offsetHeight<=u?d(l,a,s):p(l,a,s)
	if(!e.addEventListener&&e.attachEvent){var f=t.documentElement.className
	t.documentElement.className=" "+f,t.documentElement.className=f}}
	e.elementQuery=function(e,t){e&&"object"==typeof e?e.cssRules||e.rules?(c(e,!0),1==t&&m()):function(e,t){var n,i,r
	for(n in e)for(i in e[n])if("string"==typeof e[n][i])a(n,i,e[n][i])
	else if("object"==typeof e[n][i])for(r=0;r<e[n][i].length;r++)a(n,i,e[n][i][r])
	1==t&&m()}(e,t):e||t||m()},e.elementQuery.selectors=function(){var e,t,i,o={}
	for(e in r)for(t in r[e])for(i in r[e][t])o[e]===n&&(o[e]={}),o[e][t]===n&&(o[e][t]=[]),o[e][t][o[e][t].length]=i
	return o},e.addEventListener?(e.addEventListener("resize",m,!1),e.addEventListener("DOMContentLoaded",f,!1),e.addEventListener("load",f,!1)):e.attachEvent&&(e.attachEvent("onresize",m),e.attachEvent("onload",f))})(this,document,void 0),
	/*! getEmPixels  | Author: Tyson Matanich (http://matanich.com), 2013 | License: MIT */
	function(e,t){var n="!important;",i="position:absolute"+n+"visibility:hidden"+n+"width:1em"+n+"font-size:1em"+n+"padding:0"+n
	window.getEmPixels=function(r){var o
	r||(r=o=e.createElement("body"),o.style.cssText="font-size:1em"+n,t.insertBefore(o,e.body))
	var a=e.createElement("i")
	a.style.cssText=i,r.appendChild(a)
	var s=a.clientWidth
	return o?t.removeChild(o):r.removeChild(a),s}}(document,document.documentElement),define("elementQuery",["sizzle"],(function(){})),define("ui/viewModels/calling/callScreenViewModel/callScreenViewModel",["require","lodash-compat","utils/common/cafeObservable","swx-constants","ui/viewModels/calling/callScreenViewModel/callState","swx-constants","swx-constants","telemetry/calling/devicesTracker","utils/common/eventMixin","utils/common/elementQueryHelper","swx-i18n","vendor/knockout","browser/window","swx-pubsub-instance","browser/document","swx-utils-common","utils/common/styleModeHelper","swx-browser-detect","utils/common/focusRestrictor","swx-service-locator-instance","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic","swx-constants","elementQuery"],(function(e){var t=e("lodash-compat"),n=e("utils/common/cafeObservable"),i=e("swx-constants").CALLING.CALL_STATES,r=e("ui/viewModels/calling/callScreenViewModel/callState"),o=e("swx-constants").CALLING,a=e("swx-constants").COMMON,s=e("telemetry/calling/devicesTracker"),c=e("utils/common/eventMixin"),l=e("utils/common/elementQueryHelper"),u=e("swx-i18n").localization,d=e("vendor/knockout"),p=e("browser/window"),f=e("swx-pubsub-instance").default,m=e("browser/document"),h=e("swx-utils-common").async,v=e("utils/common/styleModeHelper"),g=e("swx-browser-detect").default,y=e("utils/common/focusRestrictor"),b=e("swx-service-locator-instance").default,_=e("ui/viewModels/chat/conversationTile"),E=e("ui/viewModels/chat/conversationTopic"),w=e("swx-constants").COMMON.serviceLocator
	e("elementQuery")
	var S,x=a.events.narrowMode
	function C(e,t){var c,C,T,I=this,A=r.build(e),M=A.state,O=!0,k=b.resolve(w.FEATURE_FLAGS),N=y.build(t,[".swxContextMenu"]),P=E.build(e),R=_.build(e)
	function L(e){switch(e){case o.CALL_SCREEN_DIALOG.NAME.ADD_PARTICIPANTS:I.isAddParticipantsVisible(!I.isAddParticipantsVisible())
	break
	case o.CALL_SCREEN_DIALOG.NAME.TRANSFER_CALL:I.isTransferCallVisible(!I.isTransferCallVisible())
	break
	case o.CALL_SCREEN_DIALOG.NAME.AV_SETTINGS:I.isAVSettingsVisible(!I.isAVSettingsVisible())
	break
	case o.CALL_SCREEN_DIALOG.NAME.SCREEN_SHARING_PREVIEW:I.isScreenSharingPreviewVisible(!I.isScreenSharingPreviewVisible())}}function D(){I.dispatchEvent(a.events.callScreen.SIDEBAR_TOGGLED,I.DIRECTION.CHILD),l.refresh()}function U(){I.handleShowHideControls()}function F(){I.isConversationVisible()&&(I.addClassToShowSidebar()?(f.publish(x.HIDE_SIDEBAR),I.addClassToShowSidebar(!1),I.addClassToHideSidebar(!0)):(f.publish(x.SHOW_SIDEBAR),I.addClassToShowSidebar(!0),I.addClassToHideSidebar(!1)),p.setTimeout(l.refresh,1e3))}function B(e){I.isContainerFullScreen(e),l.refresh()}function V(e){switch(e){case i.CALLING:case i.EARLY_MEDIA:F(),l.refresh()
	break
	case i.CONNECTED:s.reportCurrentDeviceCount(),I.isContainerFullScreen()&&I.isConversationVisible()&&p.setTimeout((function(){j(),W()}),200),I.handleShowHideControls()
	break
	case i.ENDING:I.isAddParticipantsVisible(!1),I.isTransferCallVisible(!1),I.isAVSettingsVisible(!1),I.isScreenSharingPreviewVisible(!1)
	break
	case i.ENDED:f.publish(x.SHOW_SIDEBAR),I.dispatchEvent(o.EVENTS.CALL_SCREEN_CLOSE,I.DIRECTION.PARENT),I.dispose()}}function G(e){I.isConversationVisible(e),e&&l.refresh()}function H(e){e?W():j()}function q(e){e&&I.dispatchEvent(a.events.callScreen.FOCUS_CALL_SCREEN,null,I.DIRECTION.CHILD)}function W(){I.isFocusRestricted()||(N.restrict(),I.isFocusRestricted(!0))}function j(){I.isFocusRestricted()&&(N.restore(),I.isFocusRestricted(!1))}function z(){O=!1,I.handleShowHideControls()}function K(){O=!0,I.handleShowHideControls()}I.callScreenStrings={CONNECTING:u.fetch({key:"callscreen_text_statusMessageConnecting"}),CALLING:u.fetch({key:"callscreen_text_statusMessageCalling"}),ENDED:u.fetch({key:"callscreen_text_terminationMessage"}),CONTROLS_ANIMATION_NAME:"av-controls-hide"},I.conversation=e,I.callingState=A,I.isContainerFullScreen=d.observable(!1),I.isFocusRestricted=d.observable(!1),I.bottomValueInPixels=d.observable("0%"),I.avatarUrl=n.newObservableProperty(e.avatarUrl),I.topic=P.topic,I.displayName=P.displayName,I.isPstn=R.isPstn,I.addClassToShowSidebar=d.observable(!0),I.addClassToHideSidebar=d.observable(!1),I.controlsVisible=d.observable(!0),I.isConversationVisible=d.observable(!0),I.isResizeVisible=k.isFeatureOn(o.FEATURE_FLAGS.RESIZE_CALL_AND_CHAT),I.footerButtonsWidth=d.observable(0),I.ADD_PARTICIPANTS_DIALOG_NAME=o.CALL_SCREEN_DIALOG.NAME.ADD_PARTICIPANTS,I.TRANSFER_CALL_DIALOG_NAME=o.CALL_SCREEN_DIALOG.NAME.TRANSFER_CALL,I.isAddParticipantsVisible=d.observable(!1),I.isTransferCallVisible=d.observable(!1),I.isAVSettingsVisible=d.observable(!1),I.isScreenSharingPreviewVisible=d.observable(!1),I.callStatusScreenReader=d.computed((function(){var t,n=M()
	return n===i.ENDING?(t=A.totalCallDuration)<6e4?u.fetch({key:"callscreen_text_statusMessageScreenReaderEnding_less_than_minute"}):u.fetch({key:"callscreen_text_statusMessageScreenReaderEnding_minutes",count:Math.floor(t/1e3/60)}):n===i.CONNECTING?u.fetch({key:"callscreen_text_statusMessageScreenReaderConnecting",params:{contactName:e.topic()}}):void 0})),I.mainClass=d.computed((function(){function t(){return e.autoCall&&e.autoCall()}return{connecting:M()===i.CONNECTING&&!t(),calling:t()&&M()===i.CONNECTING||M()===i.CALLING||M()===i.EARLY_MEDIA,connected:M()===i.CONNECTED,ended:M()===i.ENDED,ending:M()===i.ENDING,showControls:I.controlsVisible(),hideControls:!I.controlsVisible()}})),I.handleAnimationEnded=function(e,t){(t&&t.originalEvent&&t.originalEvent.animationName&&t.originalEvent.animationName.search(I.callScreenStrings.CONTROLS_ANIMATION_NAME)>-1||t&&t.animationName&&t.animationName.search(I.callScreenStrings.CONTROLS_ANIMATION_NAME)>-1)&&I.dispatchEvent(a.events.callScreen.CONTROLS_VISIBLE,!1,I.DIRECTION.CHILD)},I.init=function(){c=M.subscribe(V),C=I.isContainerFullScreen.subscribe((function(e){(function(){if(v.get().isIntegratedProperty()&&g.getBrowserInfo().browserName===g.BROWSERS.SAFARI){var e=m.querySelector("#FlexPane")
	e&&(e.style.overflow=I.isContainerFullScreen()?"visible":"")}})(),f.publish(o.EVENTS.FULLSCREEN_CHANGED,e),I.isConversationVisible()&&(H(e),q(e))})),T=I.isConversationVisible.subscribe((function(e){I.isContainerFullScreen()&&(H(e),q(e))})),I.registerEvent(a.events.callScreen.TOGGLE_MODAL_DIALOG,L),I.registerEvent(a.events.callScreen.BUTTONS_WIDTH_CHANGED,I.footerButtonsWidth.bind(I)),I.registerEvent(a.events.callScreen.TOGGLE_NARROW_MENU,F),I.registerEvent(a.events.callScreen.BUTTON_FOCUSED,U),I.registerEvent(a.events.callScreen.MORE_ACTION_MENU_VISIBLE,z),I.registerEvent(a.events.callScreen.MORE_ACTION_MENU_HIDDEN,K),I.registerEvent(a.events.callScreen.DIALPAD_VISIBLE,z),I.registerEvent(a.events.callScreen.DIALPAD_HIDDEN,K),I.registerEvent(a.events.callScreen.HIDE_CHAT,h.execute.bind(null,l.refresh)),I.forwardEvent(a.events.callScreen.TOGGLE_FULLSCREEN,I.DIRECTION.CHILD,B),I.forwardEvent(a.events.navigation.FRAGMENT_SHOW,I.DIRECTION.CHILD,G.bind(I,!0)),I.forwardEvent(a.events.navigation.FRAGMENT_BEFORE_HIDE,I.DIRECTION.CHILD,G.bind(I,!1)),I.forwardEvent(a.events.callScreen.PINNED_PARTICIPANT_CHANGED,I.DIRECTION.CHILD),I.forwardEvent(a.events.callScreen.TOGGLE_GRID_VIEW,I.DIRECTION.CHILD),I.forwardEvent(a.events.callScreen.SHOW_CHAT),I.forwardEvent(a.events.callScreen.HIDE_CHAT),l.refresh(),f.subscribe(x.SIDEBAR_TRANSITION_ENDED,D)},I.handleShowHideControls=function(){M()===i.CONNECTED&&(S&&(p.clearTimeout(S),S=null),I.controlsVisible()||(I.controlsVisible(!0),I.dispatchEvent(a.events.callScreen.CONTROLS_VISIBLE,!0,I.DIRECTION.CHILD)),O&&(S=p.setTimeout((function(){S=null,O&&I.controlsVisible(!1)}),2e3)))},I.handleMouseMove=I.handleShowHideControls,I.dispose=function(){H(!1),I.isContainerFullScreen(!1),c.dispose(),C.dispose(),T.dispose(),A.dispose(),I.mainClass.dispose(),I.callStatusScreenReader.dispose(),f.unsubscribe(x.SIDEBAR_TRANSITION_ENDED,D)}}return t.assign(C.prototype,c),{build:function(e,t){return new C(e,t)}}})),define("text!views/calling/callScreen.html",[],(function(){return'<div class="av themeDark" data-bind="\r\n    css: { fullscreen: isContainerFullScreen(), isHidden: !isConversationVisible(), showSidebar: addClassToShowSidebar(), hideSidebar: addClassToHideSidebar() },\r\n    style: { bottom: bottomValueInPixels() },\r\n    event: {\r\n        mousemove: handleMouseMove,\r\n        webkitAnimationEnd: handleAnimationEnded, animationend: handleAnimationEnded, oanimationend: handleAnimationEnded, MSAnimationEnd: handleAnimationEnded\r\n    }">\r\n\r\n    <div class="main animate" data-bind="css: mainClass">\r\n\r\n        <div class="top">\r\n            \x3c!-- ko component: { name: "swx-call-header", params: { state: callingState, conversation: conversation, callScreenStrings: callScreenStrings } } --\x3e\x3c!-- /ko --\x3e\r\n        </div>\r\n\r\n        \x3c!-- ko if: isAddParticipantsVisible() --\x3e\r\n        <swx-add-participants params="dialogName: ADD_PARTICIPANTS_DIALOG_NAME, conversation: conversation"></swx-add-participants>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isTransferCallVisible() --\x3e\r\n        <swx-add-participants params="dialogName: TRANSFER_CALL_DIALOG_NAME, conversation: conversation"></swx-add-participants>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isAVSettingsVisible() --\x3e\r\n        <swx-audio-video-settings-pane params="conversation: conversation"></swx-audio-video-settings-pane>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isScreenSharingPreviewVisible() --\x3e\r\n        <swx-screen-sharing-preview params="conversation: conversation"></swx-screen-sharing-preview>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <div class="table">\r\n            <div class="cell">\r\n                <swx-call-animation params="onAnimationIteration: function() {}, onAnimationEnded: function() {}, avatarUrl: $data.avatarUrl, isGroupConversation: conversation.isGroupConversation(), displayName: displayName, isPstn: isPstn"></swx-call-animation>\r\n                <swx-loading-animation class="spinner white"></swx-loading-animation>\r\n            </div>\r\n        </div>\r\n\r\n        <swx-call-content params="callState: callingState, conversation: conversation, footerButtonsWidth: footerButtonsWidth"></swx-call-content>\r\n\r\n\r\n        <div class="bottom">\r\n            <swx-call-footer params="conversation: conversation"></swx-call-footer>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="background">\r\n        <span class="connecting"></span>\r\n        <span class="connected"></span>\r\n    </div>\r\n\r\n    <div aria-live="polite" role="status" class="offScreen" data-bind="text: callStatusScreenReader"></div>\r\n</div>\r\n'})),define("ui/components/calling/callScreen",["require","exports","module","vendor/knockout","ui/viewModels/calling/callScreenViewModel/callScreenViewModel","constants/components","text!views/calling/callScreen.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/callScreenViewModel/callScreenViewModel")
	t.name=e("constants/components").calling.CALL_SCREEN,t.template=e("text!views/calling/callScreen.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e.conversation,t.element)
	return r.setContext(n.dataFor(t.element)),r.init(),r}}})),define("ui/viewModels/calling/callScreenViewModel/participantMenuViewModel",["require","lodash-compat","vendor/knockout","browser/dom","swx-enums","swx-constants","swx-constants","utils/common/eventMixin","swx-service-locator-instance","ui/contextMenu/contextMenu","ui/contextMenu/items/all","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","ui/viewModels/people/properties/displayNameText"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("browser/dom"),r=e("swx-enums"),o=e("swx-constants").COMMON,a=e("swx-constants").CALLING,s=e("utils/common/eventMixin"),c=e("swx-service-locator-instance").default,l=e("ui/contextMenu/contextMenu"),u=e("ui/contextMenu/items/all"),d=e("ui/telemetry/actions/actionNames"),p=e("ui/telemetry/actions/actionSources"),f=e("ui/viewModels/people/properties/displayNameText")
	function m(e,t){var s=this,m=4,h=e.layoutItemModel,v=h.participant,g=f.build(v.person),y=[]
	function b(e){e||s.isContextMenuVisible(e),s.dispatchEvent(o.events.callScreen.PARTICIPANT_MENU_VISIBILITY_CHANGED,{layoutItemModel:h,isVisible:e},s.DIRECTION.PARENT)}function _(e,n){var i={source:p.callScreen.participantMenu},a=[]
	h.isChatable()&&a.push(new u.CallParticipantChatMenuItem(v.person)),h.isPinable()&&a.push(new u.CallParticipantPinMenuItem(v,h.isScreenSharing,h.isPinned())),h.isZoomable()&&a.push(new u.CallParticipantZoomMenuItem(h.isZoomedIn,h.isZoomable)),a.length&&(n&&(e.customClientOptions={offsetElement:h.isInRoster()?t:e.target,offset:h.isInRoster()?m:E(),position:r.contextMenuPosition.Top}),l.show(a,e,i),c.resolve(o.serviceLocator.ACTION_TELEMETRY).recordAction(d.audioVideo.participantMenu.show),s.isContextMenuVisible(!0))}function E(){var e=i.getElement(a.PARTICIPANT_MENU.ANIMATION_ELEMENT_SELECTOR,t)
	return e?window.getComputedStyle(e).getPropertyValue("animation-name")===a.PARTICIPANT_MENU.ANIMATION_NAME?a.PARTICIPANT_MENU.DEFAULT_OFFSET+a.PARTICIPANT_MENU.ANIMATION_OFFSET:a.PARTICIPANT_MENU.DEFAULT_OFFSET:m}function w(){s.isContextMenuVisible()&&l.hide()}s.displayName=n.computed(g.compute),s.isPillVisible=h.isParticipantPillVisible,s.isContextMenuVisible=n.observable(!1),s.init=function(){y.push(g),y.push(s.displayName),y.push(l.isVisible.subscribe(b)),y.push(h.isInRoster.subscribe(w)),s.registerEvent(o.events.callScreen.PARTICIPANT_ITEM_CONTEXT_MENU,(function(e){e&&e.layoutItemModel===h&&_(e.event,!1)}))},s.dispose=function(){w(),y.forEach((function(e){e.dispose()})),y=[]},s.onParticipantPillClick=function(e,t){s.isContextMenuVisible()?w():_(t,!0)},s.onFocus=function(){s.dispatchEvent(o.events.callScreen.PARTICIPANT_MENU_FOCUSED,!0,s.DIRECTION.PARENT)},s.onBlur=function(){s.dispatchEvent(o.events.callScreen.PARTICIPANT_MENU_FOCUSED,!1,s.DIRECTION.PARENT)}}return t.assign(m.prototype,s),{build:function(e,t){return new m(e,t)}}})),define("text!views/calling/participantMenu.html",[],(function(){return'\x3c!-- ko if: isPillVisible --\x3e\r\n<div class="participantMenuPill">\r\n    <div class="participantNameWrapper" data-bind="click: onParticipantPillClick">\r\n        <div class="participantName">\r\n            <span data-bind="text: displayName, attr: { \'aria-label\': displayName, \'title\': displayName }, event: { focus: onFocus, blur: onBlur }" tabindex="0"></span>\r\n        </div>\r\n        <div class="participantMenuButton">\r\n            <button data-bind="event: { focus: onFocus, blur: onBlur }" class="btn small circle transparent" type="button">\r\n                <span class="iconfont chevronDown" data-bind="css: { chevronUp: isContextMenuVisible() }"></span>\r\n            </button>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/calling/participantMenu",["require","exports","module","vendor/knockout","ui/viewModels/calling/callScreenViewModel/participantMenuViewModel","constants/components","text!views/calling/participantMenu.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/callScreenViewModel/participantMenuViewModel")
	t.name=e("constants/components").calling.PARTICIPANT_MENU,t.template=e("text!views/calling/participantMenu.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e,t.element),o=n.dataFor(t.element)
	return r.setContext(o),r.init(),r}}})),define("jsviews/calling/roster",["require","swx-constants","browser/window"],(function(e){var t=e("swx-constants").COMMON,n=e("browser/window")
	function i(e){var i,r
	this.getRosterWidth=function(){return e.querySelector(".participants").offsetWidth+50},this.init=function(e){i=e,r=!1,n.addEventListener(t.events.browser.RESIZE,(function(){r||i()}))},this.dispose=function(){r=!0,n.removeEventListener(t.events.browser.RESIZE,i)}}return{build:function(e){return new i(e)}}})),define("ui/viewModels/calling/callScreenViewModel/rosterViewModel",["require","lodash-compat","vendor/knockout","swx-constants","swx-enums","browser/window","utils/common/eventMixin","swx-utils-common","utils/common/scroll"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-constants").COMMON,r=e("swx-enums"),o=e("browser/window"),a=e("utils/common/eventMixin"),s=e("swx-utils-common").async,c=e("utils/common/scroll")
	function l(e,t){var a,l,u,d,p,f=this
	function m(){s.execute((function(){f.dispatchEvent(i.events.callScreen.ROSTER_WIDTH_CHANGED,p.getRosterWidth(),f.DIRECTION.PARENT)}))}function h(){f.layoutItemModels().forEach((function(e){e.appendParticipantComponentToNewContainer(f.rosterParticipantsContainer)})),m()}f.layoutItemModels=e.layoutItemModels,f.selfLayoutItemModel=e.selfLayoutItemModel,f.isLocalVideoOn=f.selfLayoutItemModel.isVideoActive,f.conversation=e.conversation,f.rosterParticipantsContainer=n.observable(),f.init=function(e){(p=e).init(m),(a=c.build(t)).init({horizontal:!0}),l=f.layoutItemModels.subscribe(h),u=f.selfLayoutItemModel.isVideoActive.subscribe(m),d=f.selfLayoutItemModel.participant.audio.state.when(r.callConnectionState.Connected,m)},f.dispose=function(){p.dispose(),a.dispose(),l.dispose(),u.dispose(),d.dispose(),o.removeEventListener(i.events.browser.RESIZE,m)}}return t.assign(l.prototype,a),{build:function(e,t){return new l(e,t)}}})),define("text!views/calling/roster.html",[],(function(){return'<div class="roster">\r\n    <div class="participants">\r\n\r\n        <div class="scrollWrapper">\r\n            <div class="others scrollViewport scrollViewportH"\r\n                data-bind="visible: layoutItemModels().length,\r\n                           overflowClass: { right: \'partially-hidden\' },\r\n                           css: {videoActive: isLocalVideoOn()},\r\n                           getElement: rosterParticipantsContainer"\r\n                tabindex="-1"></div>\r\n        </div>\r\n\r\n        <div class="participant-wrapper localPipPlaceholder" data-bind="css: selfLayoutItemModel.aspectRatioClasses"></div>\r\n\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/roster",["require","exports","module","vendor/knockout","jsviews/calling/roster","ui/viewModels/calling/callScreenViewModel/rosterViewModel","constants/components","text!views/calling/roster.html"],(function(e,t){var n=e("vendor/knockout"),i=e("jsviews/calling/roster"),r=e("ui/viewModels/calling/callScreenViewModel/rosterViewModel")
	t.name=e("constants/components").calling.ROSTER,t.template=e("text!views/calling/roster.html"),t.viewModel={createViewModel:function(e,t){var o=t.element.getElementsByClassName("scrollWrapper")[0],a=r.build(e,o),s=n.dataFor(t.element),c=i.build(t.element)
	return a.setContext(s),a.init(c),a}}})),define("text!views/calling/callAnimation.html",[],(function(){return'<div class="animation" data-bind="event: { webkitAnimationIteration: onAnimationIteration, animationiteration: onAnimationIteration, oanimationiteration: onAnimationIteration, MSAnimationIteration: onAnimationIteration,\r\nwebkitAnimationEnd:onAnimationEnded, animationend:onAnimationEnded, oanimationend:onAnimationEnded, MSAnimationEnd:onAnimationEnded }">\r\n    <div class="radial one">\r\n        <span class="shape"></span>\r\n    </div>\r\n    <div class="radial two">\r\n        <span class="shape"></span>\r\n    </div>\r\n    <div class="radial three">\r\n        <span class="shape"></span>\r\n    </div>\r\n    <div class="circle small">\r\n        <div class="right">\r\n            <span class="shape"></span>\r\n        </div>\r\n        <div class="left">\r\n            <span class="shape"></span>\r\n        </div>\r\n    </div>\r\n    <div class="circle large inner">\r\n        <span class="shape"></span>\r\n    </div>\r\n    <div class="avatar">\r\n        <swx-avatar params="avatar: avatarUrl, isGroupAvatar: isGroupConversation, displayName: displayName, isPstn: isPstn, isFullSize: true"></swx-avatar>\r\n    </div>\r\n    <div class="circle large outer">\r\n        <span class="shape"></span>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/callAnimation",["require","exports","module","constants/components","text!views/calling/callAnimation.html"],(function(e,t){t.name=e("constants/components").calling.CALL_ANIMATION,t.template=e("text!views/calling/callAnimation.html")})),define("text!views/calling/endCall.html",[],(function(){return'<div class="avatar">\r\n    <swx-avatar params="avatar: avatarUrl, isGroupAvatar: isGroupConversation, displayName: displayName, isPstn: isPstn, isFullSize: true, size: 330"></swx-avatar>\r\n</div>\r\n<div class="text summary">\r\n    <p class="fontSize-h2" data-bind="l10n: {key: \'callscreen_text_terminationMessage\'}"></p>\r\n</div>\r\n<div class="text duration">\r\n    <p class="fontSize-h1 large" data-bind="text: duration"></p>\r\n</div>\r\n'})),define("ui/components/calling/endCall",["require","exports","module","constants/components","text!views/calling/endCall.html"],(function(e,t){t.name=e("constants/components").calling.END_CALL,t.template=e("text!views/calling/endCall.html")})),define("jsviews/calling/callScreenContent",["require","browser/window","swx-constants"],(function(e){var t=e("browser/window"),n=e("swx-constants").COMMON
	function i(e){var i
	this.getContentWidth=function(){return e.querySelector(".stage").offsetWidth},this.init=function(e){i=e,t.addEventListener(n.events.browser.RESIZE,i)},this.dispose=function(){t.removeEventListener(n.events.browser.RESIZE,i)}}return{build:function(e){return new i(e)}}})),define("services/calling/participantManager",["require","swx-enums","swx-constants"],(function(e){var t=e("swx-enums"),n=e("swx-constants").CALLING
	function i(e){var i=this,r=function(){},o={},a=r,s=r,c={},l={}
	function u(e){if(!c[e.person.id()]){var t=window.setTimeout(f.bind(i,e),n.PARTICIPANT_REMOVE_FROM_CALLSCREEN_TIMEOUT)
	c[e.person.id()]=t}}function d(e){var t=e.person.id()
	c[t]&&(window.clearTimeout(c[t]),delete c[t]),o[t]||(o[t]=!0,a(e))}function p(n){function i(i,r,o){o!==i&&(e.selfParticipant.audio.state()===t.callConnectionState.Connected&&(d(n),u(n)),function(e){return e===t.callConnectionState.Connecting||e===t.callConnectionState.Ringing||e===t.callConnectionState.Connected}(i)&&d(n),function(e,n){return n===t.callConnectionState.Disconnecting&&e===t.callConnectionState.Disconnected}(i,o)&&u(n))}n.person.id.get().then((function(){l[n.person.id()]=function(){n.audio.state.changed.off(i)},n.audio.state.changed(i)}))}function f(e){var t=e.person.id()
	delete c[t],delete o[t],s(e)}function m(e){var t=e.person.id()
	l[t]&&(l[t](),delete l[t]),c[t]&&(window.clearTimeout(c[t]),delete c[t]),delete o[t],s(e)}return i.onParticipantAddedToCall=function(e){a=e},i.onParticipantRemovedFromCall=function(e){s=e},i.dispose=function(){Object.keys(l).forEach((function(e){l[e]()})),l={},Object.keys(c).forEach((function(e){window.clearTimeout(c[e])})),c={},e.participants.added.off(p),e.participants.removed.off(m),a=r,s=r},i.init=function(){e.participants.added(p),e.participants.removed(m)},i}return{build:function(e){return new i(e)}}})),define("services/calling/screenSharingHandler",["require","swx-enums"],(function(e){var t=e("swx-enums")
	function n(e){var n=this,i=function(){},r=i,o=i,a={},s={}
	function c(e){return e===t.mediaStreamState.Started||e===t.mediaStreamState.Active||e===t.mediaStreamState.Inactive}function l(e){function n(n,i,s){c(n)&&function(e){var t=e.person.id()
	a[t]||(a[t]=!0,r(e))}(e),function(e,n){return c(n)&&e===t.mediaStreamState.Stopped}(n,s)&&function(e){var t=e.person.id()
	delete a[t],o(e)}(e)}s[e.person.id()]=function(){e.screenSharing.stream.state.changed.off(n)},e.screenSharing.stream.state.changed(n)}function u(e){var t=e.person.id()
	s[t]&&(s[t](),delete s[t]),a[t]&&(o(e),delete a[t])}n.init=function(){e.participants.added(l),e.participants.removed(u)},n.onScreenSharingStarted=function(e){r=e||i},n.onScreenSharingStopped=function(e){o=e||i},n.dispose=function(){Object.keys(s).forEach((function(e){s[e]()})),s={},e.participants.added.off(l),e.participants.removed.off(u),r=i,o=i}}return{build:function(e){return new n(e)}}})),define("ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper",["require","exports","module","lodash-compat","swx-browser-detect","swx-enums","utils/common/rtlChecker"],(function(e,t){var n,i,r=e("lodash-compat"),o=e("swx-browser-detect").default,a=e("swx-enums"),s=e("utils/common/rtlChecker"),c=["#1f1f1f","#2b2b2b","#252525","#313131"],l={1:[[{left:0,top:0,width:100,height:100,atTheBottom:6}]],2:[[{left:0,top:0,width:50,height:100,atTheBottom:4},{left:50,top:0,width:50,height:100,atTheBottom:2}],[{left:0,top:0,width:100,height:50},{left:0,top:50,width:100,height:50,atTheBottom:6}]],3:[[{left:0,top:0,width:50,height:50},{left:0,top:50,width:50,height:50,atTheBottom:4},{left:50,top:0,width:50,height:100,atTheBottom:2}],[{left:0,top:0,width:100,height:50},{left:0,top:50,width:50,height:50,atTheBottom:4},{left:50,top:50,width:50,height:50,atTheBottom:2}],[{left:0,top:0,width:100,height:100/3},{left:0,top:100/3,width:100,height:100/3},{left:0,top:200/3,width:100,height:100/3,atTheBottom:6}],[{left:0,top:0,width:100/3,height:100,atTheBottom:4},{left:100/3,top:0,width:100/3,height:100,atTheBottom:1},{left:200/3,top:0,width:100/3,height:100,atTheBottom:2}]],4:[[{left:0,top:0,width:50,height:50},{left:50,top:0,width:50,height:50},{left:0,top:50,width:50,height:50,atTheBottom:4},{left:50,top:50,width:50,height:50,atTheBottom:2}],[{left:0,top:0,width:100/3,height:100,atTheBottom:4},{left:100/3,top:0,width:100/3,height:50},{left:100/3,top:50,width:100/3,height:50,atTheBottom:1},{left:200/3,top:0,width:100/3,height:100,atTheBottom:2}],[{left:0,top:0,width:50,height:100,atTheBottom:4},{left:50,top:0,width:50,height:100/3},{left:50,top:100/3,width:50,height:100/3},{left:50,top:200/3,width:50,height:100/3,atTheBottom:2}],[{left:0,top:0,width:100,height:25},{left:0,top:25,width:100,height:25},{left:0,top:50,width:100,height:25},{left:0,top:75,width:100,height:25,atTheBottom:6}],[{left:0,top:0,width:25,height:100,atTheBottom:4},{left:25,top:0,width:25,height:100,atTheBottom:1},{left:50,top:0,width:25,height:100,atTheBottom:1},{left:75,top:0,width:25,height:100,atTheBottom:2}],[{left:0,top:0,width:100,height:50},{left:0,top:50,width:100/3,height:50,atTheBottom:4},{left:100/3,top:50,width:100/3,height:50,atTheBottom:1},{left:200/3,top:50,width:100/3,height:50,atTheBottom:2}]],5:[[{left:0,top:0,width:100/3,height:50},{left:0,top:50,width:50,height:50,atTheBottom:4},{left:100/3,top:0,width:100/3,height:50},{left:50,top:50,width:50,height:50,atTheBottom:2},{left:200/3,top:0,width:100/3,height:50}],[{left:0,top:0,width:50,height:100/3},{left:0,top:100/3,width:50,height:100/3},{left:0,top:200/3,width:50,height:100/3,atTheBottom:4},{left:50,top:0,width:50,height:50},{left:50,top:50,width:50,height:50,atTheBottom:2}],[{left:0,top:0,width:50,height:100/3},{left:50,top:0,width:50,height:100/3},{left:0,top:100/3,width:100,height:100/3},{left:0,top:200/3,width:50,height:100/3,atTheBottom:4},{left:50,top:200/3,width:50,height:100/3,atTheBottom:2}],[{left:0,top:0,width:100/3,height:50},{left:0,top:50,width:100/3,height:50,atTheBottom:4},{left:100/3,top:0,width:100/3,height:100,atTheBottom:1},{left:200/3,top:0,width:100/3,height:50},{left:200/3,top:50,width:100/3,height:50,atTheBottom:2}]],6:[[{left:0,top:0,width:100/3,height:50},{left:0,top:50,width:100/3,height:50,atTheBottom:4},{left:100/3,top:0,width:100/3,height:50},{left:100/3,top:50,width:100/3,height:50,atTheBottom:1},{left:200/3,top:0,width:100/3,height:50},{left:200/3,top:50,width:100/3,height:50,atTheBottom:2}],[{left:0,top:0,width:50,height:100/3},{left:50,top:0,width:50,height:100/3},{left:0,top:100/3,width:50,height:100/3},{left:50,top:100/3,width:50,height:100/3},{left:0,top:200/3,width:50,height:100/3,atTheBottom:4},{left:50,top:200/3,width:50,height:100/3,atTheBottom:2}]]},u=[]
	function d(e,t,n,i){var r
	return e.forEach((function(e){var o=function(e,t,n,i){var r,o
	return a(t,(function(t){var a=p(e,t,n,i);(!r||o>a)&&(r=t.slice(0),o=a)})),{cells:e,orderedParticipantItems:r,emptySpace:o}
	function a(e,t,n){n||(n=[])
	for(var i=0;i<e.length;i++){n.push(e[i])
	var r=e.slice(0,i)
	r.push.apply(r,e.slice(i+1)),a(r,t,n),n.pop()}e.length||t(n)}}(e,t,n,i);(!r||r.emptySpace>o.emptySpace)&&(r=o)})),r}function p(e,n,i,r){var o=0
	return n.forEach((function(n,a){var s,c,l,u=e[a],d=u.width*i/100,p=u.height*r/100
	n.isVideoActive()&&(c=(s=n.isScreenSharing?n.participant.screenSharing.stream:n.participant.video.channels(0).stream).width(),l=s.height()),n.isVideoActive()&&d&&p&&c&&l?n.isZoomable()&&t.canAutoZoom(c,l,d,p)||(o+=t.getEmptySpaceAroundVideo(c,l,d,p)):o+=d*p})),o}t.MAX_STAGE_SIZE=6,t.GRIDS=l,t.getGridConfiguration=function(e){var n=function(e,n,i,r,o){var a={self:r,localPipInRoster:!0},s=e&&e.width||0,c=e&&e.height||0
	if(a.stageWidth=s,a.stageHeight=c,i)return v(i)
	var u=g(n.length,o)
	if(!u)return v(n[0])
	var p=n.slice(0,o),f=n.slice(o,n.length),m=d(u,p,s,c)
	if(t.getObscuredByLocalPipPercentage(m,r,s,c)>30){if(!(u=g(n.length+1,o+1)))return v(n[0])
	var h=n.slice(0,o)
	h.push(r),a.localPipInRoster=!1,m=d(u,h,s,c)}return a.itemToPin=null,a.itemsForStage=p,a.itemsForRoster=f,a.grid=m,a
	function v(e){return a.itemToPin=e||null,a.itemsForStage=e?[e]:[],a.itemsForRoster=n.filter((function(t){return t!==e})),a.grid=d(g(1,1),a.itemsForStage,s,c),a}function g(e,t){return e>6?null:l[Math.min(e,t)]}}(e.stageDimensions,e.items,e.pinnedItem,e.selfParticipantLayoutItem,e.maxVideos||6)
	if(!t.isInActiveSpeakerMode(e.conversation)&&n&&i&&n.localPipInRoster===i.localPipInRoster&&n.itemsForStage&&i.itemsForStage&&n.itemsForRoster&&i.itemsForRoster&&r.isEqual(n.itemsForStage,i.itemsForStage)&&r.isEqual(n.itemsForRoster,i.itemsForRoster)){var o=i.grid,a=p(o.cells,o.orderedParticipantItems,n.stageWidth,n.stageHeight)
	if(100*Math.abs(a-n.grid.emptySpace)/a<5)return i.stageWidth=n.stageWidth,i.stageHeight=n.stageHeight,i}return i=n,n},t.arrangeGridItems=function(e,n){if(e&&e.grid&&e.stageWidth&&e.stageHeight){var i=e.grid.cells,r=t.getSmallestLayoutItemDimension(i,e.stageWidth,e.stageHeight),o=e.self
	n(r<210?r>110?"stage-avatar_size_100":"stage-avatar_size_50":""),e.localPipInRoster!==o.isInRoster()&&(o.isInRoster(e.localPipInRoster),e.localPipInRoster&&(o.isZoomedIn(!1),o.positionInGrid(""),o.isParticipantAtTheBottom(!1))),e.grid.orderedParticipantItems.forEach((function(e,t){var n=i[t]
	e.isParticipantAtTheBottom(!!n.atTheBottom),e.positionInGrid("left: "+n.left.toFixed(8)+"%; top: "+n.top.toFixed(8)+"%; width: "+n.width.toFixed(8)+"%; height: "+n.height.toFixed(8)+"%; display: block; background-color: "+(e.isSelfParticipant?"#000":c[t%c.length]))}))}},t.calculateVideoStyles=function(e,t,n,i,r,a){var s,c,l,u={}
	s=n/e,c=i/t,!r||o.supportsCssProperty(o.CSS_PROPERTIES.OBJECT_FIT)||o.getBrowserInfo().browserName!==o.BROWSERS.EDGE||a?r&&!a||(s>c?(l=(1-i/(t*s))/2*100)&&(u.width=100-l-l,u.left=l):(l=(1-n/(e*c))/2*100)&&(u.height=100-l-l,u.top=l)):s>c?(l=(t*s/i-1)/2*100)&&(u.height=100+l+l,u.top=-l):(l=(e*c/n-1)/2*100)&&(u.width=100+l+l,u.left=-l)
	var d=[]
	return Object.keys(u).forEach((function(e){d.push(e+": "+u[e].toFixed(8)+"%")})),d.join("; ")},t.canAutoZoom=function(e,n,i,r){return t.getCroppedVideoPercentage(e,n,i,r)<=40},t.executeInAnimationFrame=function(e){return function(){u.push({cb:e,args:arguments}),n||(n=window.requestAnimationFrame((function(){n=null
	for(var e=[],t=u.length;t--;){var i=u[t]
	i.cb.__processed||(e.unshift(i),i.cb.__processed=!0)}u=[],e.forEach((function(e){e.cb.apply(null,e.args),delete e.cb.__processed}))})))}},t.getEmptySpaceAroundVideo=function(e,t,n,i){var r,o,a=e/n,s=t/i
	return a>s?(r=n,o=t/a):(r=e/s,o=i),n*i-r*o},t.getCroppedVideoPercentage=function(e,t,n,i){var r,o,a=n/e,s=i/t
	return a>s?(r=n,o=i+i*(t*a/i-1)):(r=n+n*(e*s/n-1),o=i),100-n*i*100/(r*o)},t.getObscuredByLocalPipPercentage=function(e,t,n,i){if(!t.isVideoActive())return 0
	var r,o=s.isRtl()?4:2
	if(e.cells.some((function(e,t){return!!(e.atTheBottom&&e.atTheBottom&o)&&(r=t,!0)})),!e.orderedParticipantItems[r].isVideoActive())return 0
	if(t._rosterNode||(t._rosterNode=document.querySelector(".call-roster")),!t._rosterNode)return 0
	var a=t.participant.video.channels(0).stream,c=e.cells[r],l=c.width*n/100,u=c.height*i/100,d="1.8"===(a.width()/a.height()).toFixed(1)?16/9:4/3,p=t._rosterNode.offsetHeight
	return p*d*p*100/(l*u)},t.getSmallestLayoutItemDimension=function(e,t,n){return e.reduce((function(e,i){return Math.floor(Math.min(e,t*i.width/100,n*i.height/100))}),Math.floor(Math.min(t,n)))},t.isInActiveSpeakerMode=function(e){return e.videoService.videoMode()===a.videoMode.ActiveSpeaker&&e.isGroupConversation()}})),define("ui/viewModels/calling/callScreenViewModel/participantViewModel",["require","exports","module","lodash-compat","ui/telemetry/actions/actionNames","swx-constants","swx-util-calling-stack","swx-constants","swx-enums","utils/common/eventMixin","swx-constants","vendor/knockout","ui/modelHelpers/personHelper","swx-service-locator-instance","ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper"],(function(e,t){var n=e("lodash-compat"),i=e("ui/telemetry/actions/actionNames"),r=e("swx-constants").CALLING,o=e("swx-util-calling-stack"),a=e("swx-constants").COMMON,s=e("swx-enums"),c=e("utils/common/eventMixin"),l=e("swx-constants").KEYS,u=e("vendor/knockout"),d=e("ui/modelHelpers/personHelper"),p=e("swx-service-locator-instance").default,f=e("ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper"),m="zoomChanging"
	function h(e){var t,n,c,h,v,g,y,b,_,E,w=this,S=u.observable(r.CLASSES.ASPECT_RATIO_1BY1),x=u.observable(),C=[],T=f.executeInAnimationFrame(N),I=f.executeInAnimationFrame(Y),A=f.executeInAnimationFrame(Q),M=e.layoutItemModel
	function O(e){!M.isScreenSharing&&M.isGroupConversation()&&n&&H(n,!!e)}function k(e){e&&M.isZoomedIn()&&M.isZoomedIn(!1)}function N(){var e,n=w.videoElement(),i=w.participantElement()
	M.videoIsAllowed()&&n&&i&&t&&t.width()&&t.height()&&(e=f.calculateVideoStyles(t.width(),t.height(),i.offsetWidth,i.offsetHeight,M.isZoomedIn(),M.isScreenSharing))!==b&&(b=e,n.style.cssText=b)}function P(){M.isVideoAvailable(x()!==s.mediaStreamState.Stopped),M.videoIsAllowed()&&(I(w.videoElement()),A()),w.dispatchEvent(a.events.callScreen.VIDEO_STATE_CHANGED,null,w.DIRECTION.PARENT)}function R(e){I(e?w.videoElement():null)}function L(e){var t=e===s.callConnectionState.Connecting||e===s.callConnectionState.Ringing,n=e===s.callConnectionState.Disconnecting||e===s.callConnectionState.Disconnected
	w.isConnecting(t),w.isDisconnecting(n)}function D(e){e.audio.isSpeaking.changed(w.isSpeaking),e.audio.isMuted.changed(w.isMuted),e.audio.state.changed(L),e.video.channels.added(W),e.video.channels.removed(j),M.isScreenSharing&&z(e.screenSharing.stream),C.push(w.videoElement.subscribe(I))}function U(e){e&&(e.audio.state.changed.off(L),e.video.channels.added.off(W),e.video.channels.removed.off(j),e.audio.isSpeaking.changed.off(w.isSpeaking),e.audio.isMuted.changed.off(w.isMuted),t&&(t.state.changed.off(x),function(){c&&c.dispose()
	h&&h.dispose()}()))}function F(e){w.isParticipantMenuVisible(e)}function B(e){w.isParticipantMenuFocused(e)}function V(e,t,i){!0===e&&!1===i&&w.participant()&&(M.isScreenSharing||M.isSelfParticipant||!n||q(n))}function G(e,t){e.isStarted.set.enabled()&&(t?(M._dfdStopVideo?M._dfdStartVideo=M._dfdStopVideo.then((function(){return e.isStarted.set(!0)})):M._dfdStartVideo||(M._dfdStartVideo=e.isStarted.set(!0)),M._dfdStartVideo.finally((function(){M._dfdStartVideo=null}))):(M._dfdStartVideo?M._dfdStopVideo=M._dfdStartVideo.then((function(){return e.isStarted.set(!1)})):M._dfdStopVideo||(M._dfdStopVideo=e.isStarted.set(!1)),M._dfdStopVideo.finally((function(){M._dfdStopVideo=null}))))}function H(e,t){var n=M._dfdSetContainer||M._dfdRemoveContainer
	n?n.then((function(){G(e,t)})):G(e,t)}function q(e){var t=e.isVideoOn.subscribe(),n=e.isVideoOn.changed((function(t){t&&M.videoIsAllowed()?v?H(e,!0):g=!0:(H(e,!1),g=!1)}))
	C.push(t),C.push(n)}function W(e){M.isScreenSharing||(n=e,M.isSelfParticipant||q(e),z(n.stream))}function j(){w.dispose()}function z(e){t=e,I(w.videoElement()),function(e){var t=f.executeInAnimationFrame((function(){(function(e){if(e.width()&&e.height()){var t=(e.width()/e.height()).toFixed(1);(function(e){if("1.8"===e)S(r.CLASSES.ASPECT_RATIO_16BY9)
	else S(r.CLASSES.ASPECT_RATIO_4BY3)})(t),y!==t&&(y=t,A(),w.dispatchEvent(a.events.callScreen.VIDEO_STATE_CHANGED,null,w.DIRECTION.PARENT))}})(e)}))
	c=e.width.changed(t),h=e.height.changed(t)}(t),t.state.changed(x)}function K(e){if(t){var i=e||null
	i?(M._dfdRemoveContainer?M._dfdSetContainer=M._dfdRemoveContainer.then((function(){return t.source.sink.container.set(i)})):M._dfdSetContainer||(M._dfdSetContainer=t.source.sink.container.set(i)),M._dfdSetContainer.finally((function(){v=!0,M._dfdSetContainer=null,g&&(H(n,M.videoIsAllowed()),g=!1)}))):(M._dfdSetContainer?M._dfdRemoveContainer=M._dfdSetContainer.then((function(){return t.source.sink.container.set(null)})):M._dfdRemoveContainer||(M._dfdRemoveContainer=t.source.sink.container.set(null)),M._dfdRemoveContainer.finally((function(){v=!1,M._dfdRemoveContainer=null})))}}function Y(e){var t=M._dfdStartVideo||M._dfdStopVideo
	t?t.then((function(){K(e)})):K(e)}function Q(){t&&w.participantElement()&&t.width()&&t.height()&&w.isVideoActive()&&(M.isZoomedIn(f.canAutoZoom(t.width(),t.height(),w.participantElement().offsetWidth,w.participantElement().offsetHeight)),T())}function X(e){return e.keyCode||e.which}function $(){_&&(window.clearTimeout(_),_=null),Q(),w.inTransition(!1)}function J(){var e=w.videoElement()
	e&&(E&&window.clearTimeout(E),E=window.setTimeout((function(){E=null,Z()}),400),e.classList.add(m),T())}function Z(){var e=w.videoElement()
	e&&(E&&(window.clearTimeout(E),E=null),e.classList.remove(m),N())}w.layoutItemModel=e.layoutItemModel,w.participant=u.observable(),w.participantElement=u.observable(),w.videoElement=u.observable(),w.isSpeaking=u.observable(!1),w.isMuted=u.observable(!1),w.isFocused=u.observable(),w.isParticipantMenuVisible=u.observable(!1),w.isParticipantMenuFocused=u.observable(!1),w.isPstn=!1,w.inTransition=u.observable(!1),w.avatarVisible=u.computed((function(){return!!w.participant()&&(!M.videoIsAllowed()||x()===s.mediaStreamState.Stopped||w.inTransition())})),w.isVideoLoading=u.computed((function(){return!!w.participant()&&M.videoIsAllowed()&&(x()===s.mediaStreamState.Started||x()===s.mediaStreamState.Inactive)})),w.isVideoActive=u.computed((function(){var e=!!w.participant()&&M.videoIsAllowed()&&x()===s.mediaStreamState.Active
	return M.isVideoActive(e),e})),w.cssClasses=u.computed((function(){var e=[]
	return w.isVideoLoading()||w.isVideoActive()?M.aspectRatioClasses(r.CLASSES.VIDEO_ON+" "+S()):M.aspectRatioClasses(r.CLASSES.ASPECT_RATIO_1BY1),e.push(M.aspectRatioClasses()),o.get().isPluginlessEnabledInCurrentBrowser()&&e.push(r.CLASSES.PLUGINLESS),M.isScreenSharing&&e.push(r.CLASSES.SCREEN_SHARING),w.inTransition()&&e.push("inTransition"),M.isParticipantAtTheBottom()||e.push(r.CLASSES.SMALL_PREVIEW),e.join(" ")})),w.isConnecting=u.observable(!1),w.isDisconnecting=u.observable(!1),w.handleTransitionStart=function(){_&&window.clearTimeout(_),_=window.setTimeout((function(){_=null,$()}),700),w.inTransition(!0)},w.handleTransitionEnd=function(e){e.target.classList.contains("participant-wrapper")&&w.inTransition()?$():e.target.classList.contains("videoElement")&&Z()},w.init=function(){w.registerEvent(a.events.callScreen.VIDEO_CONTAINER_SIZE_CHANGED,A),w.registerEvent(a.events.callScreen.PARTICIPANT_MENU_VISIBILITY_CHANGED,F),w.registerEvent(a.events.callScreen.PARTICIPANT_MENU_FOCUSED,B),C.push(w.participant.subscribe(D)),C.push(w.participant.subscribe(U,this,"beforeChange")),C.push(M.isVisible.subscribe(R)),M.isGroupConversation.changed(V),C.push(x.subscribe(P)),w.participant(M.participant),C.push(M.positionInGrid.subscribe(w.handleTransitionStart)),C.push(M.isZoomedIn.subscribe(J)),w.avatarVisible.subscribe(k),w.participant()&&(w.isPstn=d.isPstn(w.participant().person)),C.push(M.videoIsAllowed.subscribe(O)),e.isVideoActive&&C.push(w.isVideoActive.subscribe((function(){e.isVideoActive(w.isVideoActive())})))},w.toggleZoom=function(){if(M.isZoomable()){var e=p.resolve(a.serviceLocator.ACTION_TELEMETRY)
	M.isZoomedIn(!M.isZoomedIn()),e.recordAction(i.audioVideo.zoomInOut)}},w.onZoomToggleKeyUp=function(e,t){return X(t)===l.TAB&&w.isFocused(!0),!0},w.onZoomToggleKeyDown=function(e,t){var n=X(t)
	return n!==l.ENTER&&n!==l.SPACE||w.toggleZoom(),n===l.TAB&&w.isFocused(!1),!0},w.onZoomToggleBlur=function(){w.isFocused(!1)},w.showContextMenu=function(e,t){if(t.altKey)return!0
	w.dispatchEvent(a.events.callScreen.PARTICIPANT_ITEM_CONTEXT_MENU,{layoutItemModel:M,event:t},w.DIRECTION.CHILD)},w.dispose=function(){P(s.mediaStreamState.Stopped),U(w.participant()),t&&(Y(null),t.state.changed.off(x),t=null),O(!1),n&&(H(n,!1),n=null),C.forEach((function(e){e.dispose&&e.dispose()})),C.length=0,M.isGroupConversation.changed.off(V),w.avatarVisible.dispose(),w.isVideoLoading.dispose(),v=!1,g=!1}}n.assign(h.prototype,c),t.build=function(e){return new h(e)}})),define("text!views/calling/participant.html",[],(function(){return'<div class="participant-wrapper" data-bind="css: cssClasses,\r\n                                            attr: { style: layoutItemModel.positionInGrid },\r\n                                            transitionEnd: handleTransitionEnd">\r\n\r\n    <div class="participant" data-bind="getElement: participantElement,\r\n                                        css: { self: layoutItemModel.isSelfParticipant,\r\n                                               participantMenuVisible: layoutItemModel.isContextMenuVisible,\r\n                                               participantMenuFocused: isParticipantMenuFocused,\r\n                                               participantAtTheBottom: layoutItemModel.isParticipantAtTheBottom },\r\n                                        event: { dblclick: toggleZoom, contextmenu: showContextMenu }">\r\n\r\n        <div class="videoElement" data-bind="getElement: videoElement, css: { videoActive: isVideoActive()}">\r\n            <a class="button" data-bind="event: { keyup: onZoomToggleKeyUp, keydown: onZoomToggleKeyDown, blur: onZoomToggleBlur }, visible: !avatarVisible(), css: { zoomedIn: layoutItemModel.isZoomedIn, focused: isFocused }, l10n_attr: { \'title\': \'callscreen_title_zoom\' }"></a>\r\n        </div>\r\n\r\n        <div class="avatar" data-bind="visible: avatarVisible()">\r\n            <swx-avatar params="avatar: participant().person.avatarUrl(), displayName: participant().person.displayName(), isFullSize: true, isPstn: isPstn"></swx-avatar>\r\n            <div class="overlay" data-bind="visible: isConnecting() || isDisconnecting() || isVideoLoading()"></div>\r\n        </div>\r\n\r\n        <swx-participant-menu params="layoutItemModel: layoutItemModel" data-bind="css: { participantMenuPillVisible: layoutItemModel.isParticipantPillVisible }"></swx-participant-menu>\r\n\r\n        \x3c!-- ko if: layoutItemModel.isGroupConversation() && !layoutItemModel.isSelfParticipant --\x3e\r\n        <div class="participantStateIcon" data-bind="visible: isConnecting() || isDisconnecting()">\r\n            <span class="iconfont callIn white" data-bind="css: { callIn: isConnecting(), callEnd: isDisconnecting() }"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <swx-loading-animation class="spinner white" data-bind="visible: isVideoLoading()"></swx-loading-animation>\r\n\r\n        \x3c!-- ko if: !layoutItemModel.isSelfParticipant && isMuted() --\x3e\r\n        <span class="Participant--isMuted iconfont microphoneOff"></span>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isSpeaking() && !layoutItemModel.isScreenSharing && !layoutItemModel.isSelfParticipant --\x3e\r\n        <div class="speakingIndicator"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n    </div>\r\n\r\n</div>\r\n'})),define("ui/viewModels/calling/callScreenViewModel/participantLayoutItem",["require","vendor/knockout","ui/viewModels/calling/callScreenViewModel/participantViewModel","text!views/calling/participant.html"],(function(e){var t=e("vendor/knockout"),n=e("ui/viewModels/calling/callScreenViewModel/participantViewModel"),i=e("text!views/calling/participant.html"),r=0
	function o(e){var o,a,s,c,l,u,d=this,p=e.conversation
	function f(){d.participantComponent&&(d.participantComponent.element.parentNode&&d.participantComponent.element.parentNode.removeChild(d.participantComponent.element),d.participantComponent.viewModel.dispose(),t.cleanNode(d.participantComponent.element),d.participantComponent=null)}function m(){var e=c(),r=l()
	e||o?r||a?(h(),s=window.setTimeout((function(){s=null
	var o=p._callHandler&&p._callHandler.isPluginless(),a=!d.participantComponent||d.participantComponent.element.parentNode!==r
	!o&&a&&f(),d.participantComponent||function(e){if(d.participantComponent)return
	var r=document.createElement("div"),o=n.build({layoutItemModel:d}),a=t.contextFor(e).$component
	o.setContext(a),o.init(),d.isSelfParticipant&&(r.className="localPip")
	r.innerHTML=i,t.applyBindings(o,r),d.participantComponent={element:r,viewModel:o}}(e),a&&r.appendChild(d.participantComponent.element)}),0)):a=l.subscribe(m):o=c.subscribe(m)}function h(){o&&(o.dispose(),o=null),a&&(a.dispose(),a=null)}function v(){s&&(clearTimeout(s),s=null)}d.participant=e.participant,d.isSelfParticipant=e.isSelfParticipant,d.isScreenSharing=e.isScreenSharing,d.isGroupConversation=e.isGroupConversation,d.isVisible=e.isVisible,d.isInRoster=t.observable(),d.videoIsAllowed=t.observable(e.isSelfParticipant),d.isVideoActive=t.observable(!1),d.isVideoAvailable=t.observable(!1),d.aspectRatioClasses=t.observable(),d.isPinable=t.observable(!1),d.isZoomable=t.computed((function(){return d.isVideoActive()&&!d.isInRoster()&&!d.isScreenSharing})),d.isChatable=t.computed((function(){return e.isGroupConversation()&&!d.isSelfParticipant})),d.isPinned=t.observable(!1),d.isZoomedIn=t.observable(!1),d.isParticipantPillVisible=t.computed((function(){return d.isPinable()||d.isChatable()})),d.isParticipantAtTheBottom=t.observable(!1),d.positionInGrid=t.observable(""),d.importance=e.importance,d.order=++r,d.appendParticipantComponentToNewContainer=function(t){u||(v(),h(),c=e.contextElement,l=t,m())},d.removeParticipantComponent=function(){v(),h(),f()},d.dispose=function(){u=!0,d.removeParticipantComponent()}}return{build:function(e){return new o(e)}}})),define("ui/viewModels/calling/helpers/textFormatter",[],(function(){function e(e){return(e=e.toString()).length>1?e:"0"+e}return{getFormattedDuration:function(t,n){var i=[],r=Math.floor(t/1e3/60/60)
	t-=1e3*r*60*60
	var o=Math.floor(t/1e3/60)
	t-=1e3*o*60
	var a=Math.floor(t/1e3)
	return r&&i.push(e(r)),i.push(e(o)),n&&r||i.push(e(a)),i.join(":")}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("jcafe-property-model/lib/propertyModel",["require","exports"],e)}((function(e,t){var n=null
	try{n=window}catch(Ee){}!n&&global&&(global.window=global)
	var i=window.ttt?ttt.window:window,r=i.setTimeout,o=i.clearTimeout,a=i.Date,s=i.Math,c=i.console,l=i.performance&&i.performance.now?function(){return performance.now()}:function(){return a.now()}
	i=null
	var u="undefined"!=typeof SkypeWebTests,d=function(e){return u?e:e+":"+C()}("async"),p=function(e,t,n){void 0===n&&(n=null)
	var i,r=n||window,o=e.split(".")
	for(i=0;i<o.length;i++)r=r[o[i]]||(r[o[i]]={})
	for(i in t)i in r?c&&c.warn&&c.warn("Namespace extension: "+e+"."+i+" already exists"):r[i]=t[i]
	return r}("Skype.Web.Utils",{replacePrototype:!0})
	function f(e,t){return t=x({code:e},t),x(Error(this||e),t)}function m(e,t){var n="Invalid state: "+e+" (expected "+t+")"
	return f.call(n,"InvalidState",{actual:e,expected:t})}function h(e,t,n){if(!e)throw f(t||"AssertionFailed",n)}function v(e,t,n){if(!e)throw f(t||"RuntimeCheckFailed",n)}function g(e,t){p.replacePrototype?e.__proto__?e.__proto__=t:Object.setPrototypeOf?Object.setPrototypeOf(e,t):x(e,t):x(e,t)}(function(e){function t(n,i){if(i instanceof RegExp)e(i.test(n),"DoesNotMatchPattern",{value:n,pattern:i})
	else if(i&&!t(n,i))throw function(e,t){var n=e+" is not a "+t
	return f.call(n,"WrongType",{value:e})}(n,i)}e.is=t,e.args=function(e,n){T(n,(function(n,i){var r=e&&e[i]
	if(!t(r,n))throw function(e,t,n){var i="`"+e+"` = "+t+" is not a "+n
	return f.call(i,"WrongArgType",{arg:e,value:t})}(i,r,n)}))}})(h||(h={})),function(e){e.equals=function(e,t){if(e!=t)throw r=(n=e)+" != "+(i=t),f.call(r,"DoesNotEqual",{lhs:n,rhs:i})
	var n,i,r},e.state=function(e,t){if(N(t)){if(-1==E(t,e))throw m(e,t)}else if(e!=t)throw m(e,t)},e.belongs=function(e,t){if(!(e in t))throw function(e,t){var n="the `"+e+"` property is missing"
	return f.call(n,"KeyMissing",{key:e,object:t})}(e,t)}}(v||(v={}))
	var y=function(){var e=[],t=16,n=!1
	function i(e,t){r(e,0)}function o(){n=!0
	try{(function(){for(var n=l();e.length;){e.shift()()
	var i=l()-n
	if(i>=t||i<0)return}})()}finally{n=!1,e.length&&i(o)}}return function(t){e.push(t),n||e.length>1||i(o)}}()
	function b(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	e=e.bind.apply(e,[this].concat(t)),u?e():y(e)}function _(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	var i=this
	return e.bind?e.bind.apply(e,[i].concat(t)):function(){return e.apply(i,t.concat([].slice.call(arguments,0)))}}function E(e,t){var n
	if(e.indexOf)return e.indexOf(t)
	for(n=0;n<e.length;n++)if(e[n]==t)return n
	return-1}function w(e,t){e.splice(t,1)}function S(e,t,n){e.splice(t,0,n)}function x(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n]
	var i,r,o,a=t[t.length-1]
	for(e=e||{},a=P(a)?a:"",r=0;r<t.length;r++)if((i=t[r]||{})!==a)for(o in i)"append"==a&&o in e||(e[o]=i[o])
	return e}function C(){return s.random().toString(16).slice(2)}function T(e,t){var n,i
	if(h(N(e)||k(e)),h(L(t)),N(e))for(n=0;n<e.length;++n)t(e[n],n)
	else for(i in e)h(void 0===t(e[i],i))}function I(e,t,n){var i,r
	if(N(e))for(i=[],r=0;r<e.length;r++)i.push(t.call(n,e[r],r,e))
	else if(k(e))for(r in i={},e)i[r]=t.call(n,e[r],r,e)
	return i}function A(e,t,n){var i,r={}
	for(i in e=e||{},t=t||{})i in e&&"append"==n||(r[i]={value:t[i],writable:!0,enumerable:!0,configurable:!0})
	return Object.create(e,r)}function M(e){return e&&JSON.parse(_stringify(e))}function O(e){return e&&"[object Object]"==Object.prototype.toString.call(e)}function k(e){return O(e)}function N(e){return"[object Array]"==Object.prototype.toString.call(e)}function P(e){return"[object String]"==Object.prototype.toString.call(e)}function R(e){return"[object Number]"==Object.prototype.toString.call(e)}function L(e){return"[object Function]"==Object.prototype.toString.call(e)}function D(e){return"[object Boolean]"==Object.prototype.toString.call(e)}function U(e){return P(e)&&e.length>0}function F(e){return null==e}function B(e){return R(e)&&(0|e)==e}function V(e,t,n){return R(n)&&n>=e&&n<=t}function G(e){return e instanceof $}function H(e){return e&&e.constructor===ue}function q(e,t){var n,i=t.split("|")
	for(n=0;n<i.length;n++)if(i[n]in q.types&&q.types[i[n]](e))return!0
	return!1}function W(e){return e&&L(e.then)}function j(e,t){var n,i=typeof e
	if(e===t)return!0
	if(i!==typeof t||"object"!==i&&"function"!==i)return!1
	if(null===e||null===t)return e===t
	if(e instanceof a&&t instanceof a)return+e==+t
	for(n in e)if(!(n in t)||e[n]!==t[n])return!1
	for(n in t)if(!(n in e)||e[n]!==t[n])return!1
	return!0}function z(e){return e.replace(/&(#?\w+);/gm,(function(e,t){return"#"==t.charAt(0)?String.fromCharCode(+t.slice(1)):z.entities[t]}))}function K(e,t){var n=e[d]?e:function(){try{return X.wait(e.apply(this,arguments),t)}catch(n){return X().reject(n).promise}}
	return function(e,t,n,i){try{Object.defineProperty(e,t,{value:n,enumerable:!1,writable:!i})}catch(r){e[t]=n}}(n,d,!0),n}t.isPromise=G,t.isCollection=function(e){return e&&e.constructor===be},t.isProperty=function(e){return e&&e.constructor===he},t.isCommand=H,function(e){e.types={String:P,NotEmptyString:U,Function:L,Dictionary:k,Object:O,Array:N,Boolean:D,Void:F,Number:R}}(q||(q={})),function(e){e.entities={lt:"<",gt:">",amp:"&",nbsp:" ",quot:'"'}}(z||(z={})),t.async=K
	var Y=function e(t){var n,i=function(e,t){return i.on(e,t),L(t)&&t(this),new Q(i,e)}
	return this instanceof e?(x(n=this,t||{}),n._listeners=[],n._modes=[],n._locked=!1,n.observer=i,g(i,e.prototype.observer),i._event=n,n):new e(t)}
	function Q(e,t){this.event=e,this.listener=t}function X(e,t){if(!(this instanceof X))return new X(e,t)
	P(e)||(t=e,e=void 0),t=t||{}
	var n={leafs:[],state:"pending"}
	n.status=he({value:e}),t.mode&&(n.mode=t.mode),t.cancel&&(n.fnCancel=t.cancel),n.promise=new X.Promise(this),x(this,{_:n,status:n.status,promise:n.promise})}function $(e){var t=X()
	try{e((function(e){t.resolve(e)}),(function(e){t.reject(e)}),t.status)}catch(n){"pending"==t.promise.state()&&t.reject(n)}return t.promise}function J(e){return A(J.prototype,{exec:function(t,n){var i=e(t,n||0)
	return 2==arguments.length?i:i&&i.pos==t.length?i.res:null}})}function Z(e){return J((function(t,n){if(t.slice(n,n+e.length)==e)return{res:e,pos:n+e.length}}))}function ee(e){return J((function(t,n){var i=e.exec(t.slice(n))
	if(i&&0==i.index)return{res:i[0],pos:n+i[0].length}}))}function te(e,t){return J((function(n,i){return e.exec(n,i)||{res:t,pos:i}}))}function ne(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return J((function(t,n){var i,r,o=[]
	for(i=0;i<e.length;i++){if(!(r=e[i].exec(t,n)))return
	o.push(r.res),n=r.pos}return{res:o,pos:n}}))}function ie(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]
	return J((function(t,n){var i,r
	for(i=0;i<e.length&&!r;i++)r=e[i].exec(t,n)
	return r}))}function re(e){return J((function(t,n){for(var i,r=[];i=e.exec(t,n);)r.push(i.res),n=i.pos
	return{res:r,pos:n}}))}function oe(e,t){var n=ne(t,e).select(1)
	return te(ne(e,re(n)).then((function(e){return[e[0]].concat(e[1])})),[])}function ae(e,t){var n,i
	return ne(e,re(ie(ee(/\\./).then((function(e){return e.slice(1)})),(n=ee(/./),i=t,J((function(e,t){return!i.exec(e,t)&&n.exec(e,t)}))))),t).select(1).merge()}function se(e){var t=se.pattern.exec(e)
	if(!t)throw new SyntaxError("Invalid data URL: "+e)
	return t.base64=!!t.attributes.base64,t}t.event=Y,x(Q.prototype,{dispose:function(){this.event.off(this.listener)}}),Y.prototype=function(){},x(Y.prototype,{constructor:Y,fire:function(){var e=this
	e._enqueue(e,e._fire,arguments)||(e._fire.apply(e,arguments),e._dequeue())},_fire:function(){var e,t=this
	for(e=0;e<t._listeners.length;e++)t._invoke(t._listeners[e],arguments,t._modes[e])},_invoke:function(e,t,n){var i=this
	if("async"!=n||u)try{e.apply(null,t)}catch(r){r!==i._ie&&c&&c.log&&(c.log(r&&r.stack||r),c.log(Error().stack))}else b.call(i,i.invoke,e,t,"sync")},_enqueue:function(e,t,n){var i=this
	return i._locked?(i._queue=i._queue||[],i._queue.push([e,t,n])):i._locked=!0,i._queue&&i._queue.length>0},_dequeue:function(){var e,t=this
	if(t._queue){for(;e=t._queue.shift();)e[1].apply(e[0],e[2])
	t._queue=null}t._locked=!1},observed:function(){return this._listeners.length>0},observer:{toString:function(){var e=this._event._listeners.length
	return"[Event"+(e?": "+e+" listener"+(1==e?"":"s"):"")+"]"},on:function(e,t){var n=this._event
	n._enqueue(this,this._addListener,[e,t])||(this._addListener(e,t),n._dequeue())},_addListener:function(e,t){var n=this._event
	h(L(e)),n.adding&&n.adding.call(n.context,e),n._listeners.push(e),n._modes.push(t),n.added&&n.added.call(n.context,e),1==n._listeners.length&&n.subscribed&&n.subscribed.call(n.context)},off:function(e){var t=this._event
	t._enqueue(this,this._removeListener,[e])||(this._removeListener(e),t._dequeue())},_removeListener:function(e){var t=this._event,n=E(t._listeners,e)
	n>=0&&(t._listeners.splice(n,1),t._modes.splice(n,1),0==t._listeners.length&&t.unsubscribed&&t.unsubscribed.call(t.context))}}}),t.task=X,x(X.prototype,{resolve:function(e){var t=this._
	return v.state(t.state,"pending"),t.value=e,t.state="resolved",t.$state&&t.$state._set(t.state),t.promise.result=e,this._complete()},reject:function(e){var t=this._
	return v.state(t.state,"pending"),t.value=e,t.state="rejected",t.$state&&t.$state._set(t.state),t.promise.error=e,this._complete()},_complete:function(){var e=this._
	e.status(null)
	for(var t=0;t<e.leafs.length;t++)e.leafs[t]()
	return e.fnCancel=null,this}}),function(e){e.Promise=function(e){this.task=e,Object.defineProperty(this,"state",{get:this._getState}),Object.defineProperty(this,"status",{get:this._getStatus})}}(X||(X={})),t.task=X,X.Promise.prototype=A($.prototype,{_getState:function(){var e=this.task._
	return e.$state||(e.$state=he({value:e.state,readOnly:!0})),e.$state},_getStatus:function(){return this.task._.status.asReadOnly()},from:function(e){var t=this.task,n=t._
	this.locked?this.target.from(e):(n.source=e,n.source.then((function(e){t.resolve(e)}),(function(e){t.reject(e)}),n.status),n.fnCancel=function(e){n.source.cancel(e)},n.source.locked&&(n.source.target=this))},cancel:function(e){var t=this.task,n=t._
	v.state(n.state,"pending"),n.fnCancel?n.fnCancel(e):t.reject(e)},then:function(e,t,n){var i,r=this.task._,o=X({cancel:function(e){if(r.leafs.length<2)r.promise.cancel(e)
	else{w(r.leafs,E(r.leafs,a)),r.status.changed.off(l)
	try{L(t)?o.promise.from(X.wait(t(e))):o.reject(e)}catch(n){o.reject(n)}}}}),a="sync"==r.mode?s:_(b,s)
	function s(){r.status.changed.off(l)
	try{if("resolved"==r.state)i=L(e)?e(r.value):r.value
	else{if(!L(t))return void o.reject(r.value)
	i=t(r.value)}}catch(n){return c.error(n&&n.stack||n),void o.reject(n)}W(i)?o.promise.from(X.wait(i)):o.resolve(i)}function l(e,t){"pending"==r.state&&(o.status(e,t),L(n)&&n(e,t))}return"pending"==r.state?(r.status.changed(l),r.leafs.push(a)):a(),o.promise}}),function(e){e.waitAny=function(t){var n=t.length,i=e({cancel:o}),r=i.promise
	function o(e){T(t,(function(t){try{t.cancel(e)}catch(n){}}))}return 1==n?r=e.wait(t[0]):0==n?i.reject(Error()):T(t,(function(e){e.then((function(e){n--,i&&(i.resolve(e),i=null,o(f("CompetingTaskResolved")))}),(function(e){--n||(i.reject(e),i=null)}),(function(){var e=I(t,(function(e,t){return e.status()||"#"+t}))
	i.status(e.join(" || "))}))})),r},e.waitAll=function(t){var n=t.length,i=[],r=e({cancel:s}),o=r.promise,a={}
	function s(e){for(var n=0;n<t.length;n++)try{"pending"==t[n].state()&&t[n].cancel(e)}catch(i){}}function c(){var e=I(a,(function(e,t){return e.status()||"#"+t}))
	r.status(function(e){h(k(e))
	var t=[]
	return T(e,(function(e){t.push(e)})),t}(e).join(" && "))}return i.length=t.length,0==n?r.resolve([]):1==n?o=e.wait(t[0]).then((function(e){return[e]})):(T(t,(function(n,i){a[i]=t[i]=e.wait(n)})),c(),T(t,(function(e,t){e.then((function(e){i[t]=e,delete a[t],c(),--n||(r.resolve(i),r=null)}),(function(e){delete a[t],n--,r&&(r.reject(e),r=null,s(e))}),c)}))),o}}(X||(X={})),t.task=X,X.wait=function(e,t){return G(e)?e:W(e)?$(_.call(e,e.then)):X({mode:t}).resolve(e).promise},t.promise=$,x($.prototype,{catch:function(e){return this.then(null,e||function(){})},finally:function(e){return this.then((function(t){return X.wait(e()).then((function(){return t}))}),(function(t){return X.wait(e()).then((function(){throw t}))}))}}),x(J.prototype,{then:function(e){var t=this.exec
	return J((function(n,i){var r=t(n,i)
	return r&&{res:e(r.res),pos:r.pos}}))},select:function(e){return this.then((function(t){return t[e]}))},merge:function(e){return this.then((function(t){return t.join(e||"")}))},join:function(e,t){return this.then((function(n){var i,r={}
	for(i=0;i<n.length;i++)r[n[i][e]]=n[i][t]
	return r}))},as:function(e){return this.then((function(t){var n,i={}
	for(n in e)i[n]=t[e[n]]
	return i}))}}),function(e){var t,n,i,r,o,a
	e.encodeData=function(e){return encodeURIComponent(e).replace(/%20/gm,"+")},e.decodeData=function(e){return decodeURIComponent(e.replace(/\+/gm," "))},e.pattern=(t=ee(/[^()<>@,;:\\\x22/\[\]?=\s]+/),n=ne(t,Z("/"),t).merge(),i=ee(/[^\uffff]*/).then(e.decodeData),r=ae(Z('"'),Z('"')),o=ne(ee(/\s*=\s*/),ie(r,t)).select(1),a=ne(ee(/\s*;\s*/),t,te(o,!0)),ne(Z("data:"),te(n),re(a).join(1,2),ee(/\s*,\s*/),i).as({mime:1,attributes:2,data:4}))}(se||(se={}))
	var ce=function(){function e(t){if(!(P(t)||t&&t.ast))throw new Error("Invalid argument: "+t)
	if(!(this instanceof e))return new e(t)
	var n,i
	try{if(!(n=t.ast||e.pattern.exec(t)))throw void 0}catch(s){throw(i=new SyntaxError("Invalid XML: "+t)).reason=s,i}var r=n.attrs||{},o=(n.nodes||[]).map((function(t){return new e({ast:P(t)?{text:t}:t})})),a=function(e,t){return e+t.text()}
	this.attrs=r,this.nodes=o,this.name=function(){return n.name},this.text=function(){return n.text||o.reduce(a,"")}}return e.prototype.toString=function(){return"[object XmlNode]"},e.prototype.attr=function(e){return h(e in this.attrs,"Attribute does not exist: "+this.name()+"."+e),this.attrs[e]},e.prototype.selectOne=function(e,t){var n=function(e,t){var n
	return h(N(e)||k(e)),h(L(t)),N(e)?(n=[],T(e,(function(e,i){t(e,i)&&n.push(e)}))):(n={},T(e,(function(e,i){t(e,i)&&(n[i]=e)}))),n}(this.nodes,L(e)?e:function(n){var i,r
	if(t)for(i in t)if(r=i.toLowerCase(),t[r]!=n.attrs[r])return!1
	return n.name()==e.toLowerCase()})
	return h(1==n.length,"Single node expected: "+e),n[0]},e}()
	function le(e){var t=le.pattern.exec(e||"")
	if(t)return t
	throw new SyntaxError("Invalid WWW-Authenticate header:\n"+e)}function ue(e,t){var n=function(){var t
	if(!n.enabled()){if(t=f("CommandDisabled",{reason:n.enabled.reason}),(i=e)&&i[d])return X().reject(t).promise
	throw t}var i
	return e.apply(this,arguments)}
	return x(n,{constructor:ue,enabled:t&&t.asReadOnly(),bind:function(e){return ue((function(){return n.apply(e,arguments)}),n.enabled)},toString:function(){return"[Command: enabled = "+n.enabled()+"]"}})}function de(e){return x(e,{constructor:ue,toString:function(){return"[Command: enabled = true]"},enabled:ve(!0)})}function pe(e){return void 0!==e?ue((function(){}),ve(!1,e)):(pe.instance||(pe.instance=ue((function(){}),ve(!1))),pe.instance)}function fe(e){return void 0!==e?ue(K((function(){})),ve(!1,e)):(fe.instance||(fe.instance=ue(K((function(){})),ve(!1))),fe.instance)}function me(e,t){var n=0
	return function(){var i=!1
	return 1==++n&&e&&e(),{dispose:function(){if(i)throw f("AlreadyDisposed")
	i=!0,0==--n&&t&&t()}}}}function he(e){var t=function(e,n){return 0==arguments.length?t._value:(t._write(e,n),this)},n=e&&e.get,i=e&&e.set,r=e&&e.readOnly
	return e&&void 0!==e.value&&(t._value=e.value),e&&void 0!==e.reason&&(t.reason=e.reason),e&&e.check&&(t._check=e.check),n&&(t._getter=K(n)),r&&(t._ro=t),i&&(t._setter=K(i,"sync")),e&&e.subscribed&&(t._subscribed=e.subscribed),e&&e.unsubscribed&&(t._unsubscribed=e.unsubscribed),g(t,he.prototype),x(t,{get:H(n)?ue(t._getAsync,n.enabled):de(t._getAsync),set:r?fe():H(i)?ue(t._setAsync,i.enabled):de(t._setAsync)}),Object.defineProperty(t,"changed",{get:t._getChanged,set:function(e){t._getChanged(),t._changed.observer=e}}),t}function ve(e,t){if(void 0===t){if(null===e)return he.null
	if(!0===e)return he.true
	if(!1===e)return he.false}return he({value:e,reason:t,readOnly:!0})}ce.pattern=function(){var e,t=ee(/[\x00-\x20]*/),n=ie(ee(/\x22[^\x22]*\x22/).then((function(e){return e.slice(1,-1)})),ee(/[^\s<>\x22]+/)).then(z),i=ee(/[^<]+/m).then(z),r=ee(/[\w\d:-]+/).then((function(e){return e.toLowerCase()})),o=oe(ne(r,te(ne(t,Z("="),t,n).select(3))),t).join(0,1),a=ne(Z("<"),t,r,t,o,t,Z(">")).as({name:2,attrs:4}),s=ne(Z("<"),t,r,t,o,t,Z("/>")).as({name:2,attrs:4}),c=ne(Z("</"),t,r,t,Z(">")).select(2),l=ne(a,re(ie(J((function(t,n){return e.exec(t,n)})),i)),c).then((function(e){if(e[0].name==e[2])return{name:e[2],nodes:e[1],attrs:e[0].attrs}
	throw new SyntaxError("</"+e[2]+"> does not match <"+e[0].name+">")}))
	return e=ie(l,s)}(),function(e){e.pattern=function(){var e=ee(/[\s,]*/),t=ee(/[^\s,=]+/),n=ae(Z('"'),Z('"')),i=oe(ne(t,ee(/\s*=\s*/),n),e).join(0,2)
	return oe(ne(t,e,i),e).join(0,2)}()}(le||(le={})),t.command=ue,t.enabledCommand=de,t.disabledCommand=pe,pe||(pe={}),t.disabledCommand=pe,t.disabledAsyncCommand=fe,fe||(fe={}),t.disabledAsyncCommand=fe,t.property=he,function(e){e.sUpdated={}}(he||(he={})),t.property=he,he.prototype=function(){},x(he.prototype,{constructor:he,toString:function(){return"[Property: value = "+this()+"]"},map:function(e){var t,n=this,i=he({get:ue((function(){return n.get().then(e)}),n.get.enabled),subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return n.changed((function(t,n){i(e(t),n)})),i.asReadOnly()},when:function(e,t){var n=this.changed,i={dispose:function(){n.off(o)}},r=L(e)?e:function(t){return t===e}
	function o(e,n,o){r(e)&&t.call(i,n,o)}return n(o),i},once:function(e,t){return this.when(e,(function(){this.dispose(),t.apply(null,arguments)}))},equals:function(e){return this.map((function(t){return t==e}))},equalsAny:function(){var e=[].slice.call(arguments)
	return this.map((function(t){return function(e,t){var n
	if(h(N(e)||k(e)),h(L(t)),N(e)){for(n=0;n<e.length;++n)if(t(e[n],n))return!0}else for(n in e)if(t(e[n],n))return!0
	return!1}(e,(function(e){return e==t}))}))},fork:function(e){var t,n=this,i=e.enabled||ve(!0),r=i===ve(!1),o=he({value:n(),reason:n.reason,readOnly:r,set:!r&&ue((function(t,i){return K(e)(t,i).then((function(e){return n.set(e,i)}))}),i),get:n.get.bind(n),subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return(n._forks=n._forks||[]).push(o),o},asReadOnly:function(){var e=this
	return e._ro||(e._ro=e.fork(fe())),e._ro},observed:function(){var e=this._changed
	return e&&e.observed()},subscribe:function(){var e=this
	return e.subscribe=me(e._subscribed,e._unsubscribed),e.subscribe()}}),x(he.prototype,{_set:function(e,t){var n,i=this,r=i._value,o=i._forks,a=i._changed
	if((!j(e,r)||!j(t,i.reason))&&(i._value=e,i.reason=t,a&&a.fire(e,t,r),o))for(n=0;n<o.length;n++)o[n]._set(e,t)
	return e},_getChanged:function(){var e=this
	return e._changed||(e._changed=new Y({context:e,added:e._listenerAdded})),e._changed.observer},_listenerAdded:function(e){var t=this._value,n=this.reason
	void 0!==t&&e(t,n)},_getAsync:K((function(){var e=this,t=e._getter,n=e._value
	return t?t.call(e,n,e.reason).then((function(t){return e._set(t,e.reason),e._value})):n})),_setAsync:K((function(e,t){var n=this,i=n._check,r=n._setter
	return h(arguments.length>0),i&&i(e),r?r.call(n,e,t).then((function(e){return n._set(e,t)})):n._set(e,t)}),"sync"),_write:function(e,t){var n=this,i=n._check,r=n._setter
	if(i&&i(e),!n.set.enabled())throw Error("This is a read-only property.")
	r&&t!==he.sUpdated?r.call(n,e,t).then((function(e){n._set(e,t)})):n._set(e,t)}}),t.constProperty=ve
	var ge=he
	function ye(e,t){var n=he()
	return n(e,t),n.inc=function(){n(n()+1)},n.dec=function(){n(n()-1)},n}function be(e){var t=function(e){return 0==arguments.length?t._asArray():N(e)?(t.empty(),t._addArray(e),this):t._getFromCache(e)},n=t._=x({},e)
	return e&&e.get&&(n.get=K(e.get)),n.vals=[],n.keys=[],n.idxs={},g(t,be.prototype),t._init(),t}ge.true=he({value:!0,readOnly:!0}),ge.false=he({value:!1,readOnly:!0}),ge.true.get.enabled=ge.true,ge.true.set.enabled=ge.false,ge.false.get.enabled=ge.true,ge.false.set.enabled=ge.false,fe.instance.enabled=ge.false,ge.null=he({value:null,readOnly:!0}),t.numProperty=ye,t.boolProperty=function(e,t){var n=he()
	return n(e,t),n},t.collection=be,be.prototype=function(){},x(be.prototype,{_init:function(){var e=this
	Object.defineProperties(e,{added:{enumerable:!0,get:e._initAddedEvent,set:function(t){e._initAddedEvent(),e._.added.observer=t}},removed:{enumerable:!0,get:e._initRemovedEvent,set:function(t){e._initRemovedEvent(),e._.removed.observer=t}},changed:{enumerable:!0,get:e._initChangedEvent,set:function(t){e._initChangedEvent(),e._.changed.observer=t}},size:{enumerable:!0,get:e._initSizeProperty,set:function(t){e._initSizeProperty(),e._.size.observer=t}}})},_initAddedEvent:function(){var e=this,t=e._,n="added"
	return t[n]=t[n]||new Y({context:e,adding:e._addedListenerAdding}),t[n].observer},_addedListenerAdding:function(e){var t=this._
	T(t.vals,(function(n,i){e(n,t.keys[i],i)}))},_initRemovedEvent:function(){var e=this._,t="removed"
	return e[t]=e[t]||new Y,e[t].observer},_initChangedEvent:function(){var e=this._,t="changed"
	return e[t]=e[t]||new Y({added:this._changedListenerAdded}),e[t].observer},_changedListenerAdded:function(e){e()},_initSizeProperty:function(){var e=this._,t="size"
	return e[t]=e[t]||ye(e.vals.length),e[t].asReadOnly()},subscribe:function(){var e=this,t=e._
	return e.subscribe=me(t.subscribed,t.unsubscribed),e.subscribe()},observed:function(){var e=this._,t=e.added,n=e.removed,i=e.changed
	return t&&t.observed()||n&&n.observed()||i&&i.observed()},_insert:function(e,t,n){var i,r=this._,o=r.vals.length
	for(i=n;i<o;i++)r.idxs[r.keys[i]]++
	S(r.vals,n,e),S(r.keys,n,t),r.idxs[t]=n},add:function(e,t,n){var i=this._,r=i.vals.length
	if((t=t||(i.key||C)(e))in i.idxs)throw f("AlreadyExists",{item:t})
	return(n=B(n)?n:r)<0&&(n=0),n>r&&(n=r),this._insert(e,t,n),i.size&&i.size.inc(),i.added&&i.added.fire(e,t,n),i.changed&&i.changed.fire(),t},remove:function(e){var t,n,i,r=this._
	if(B(e)?(t=e,e=r.keys[t]):t=r.idxs[e],n=r.vals[t],t>=0&&t<r.vals.length){for(i=t+1;i<r.keys.length;i++)r.idxs[r.keys[i]]--
	w(r.vals,t),w(r.keys,t),delete r.idxs[e],r.size&&r.size.dec(),r.removed&&r.removed.fire(n,e,t),r.changed&&r.changed.fire()}},_getFromCache:function(e){var t=this._
	return P(e)?t.vals[t.idxs[e]]:t.vals[e]},get:function(e){var t=this,n=t._.get,i=n&&n().then((function(e){return t._setNewItems(e)}))
	return X.wait(i).then((function(){return F(e)?t._asArray():t._getFromCache(e)}))},index:function(e){return this._.idxs[e]},key:function(e){return this._.keys[e]},_setNewItems:function(e){var t,n=this,i=n._
	if(k(e)){for(t in i.idxs)t in e&&i.vals[i.idxs[t]]===e[t]||n.remove(t)
	for(t in e)t in i.idxs||n.add(e[t],t)}},empty:function(){var e,t=this._
	if(t.removed)for(e=0;e<t.vals.length;e++)t.removed.fire(t.vals[e],t.keys[e])
	t.vals=[],t.keys=[],t.idxs={},t.size&&t.size(0),t.changed&&t.changed.fire()},_addArray:function(e){for(var t=0;t<e.length;t++)this.add(e[t])},_asArray:function(){return this._.vals.slice(0)},asReadOnly:function(){var e=function(e){return 0==arguments.length?t._asArray():t._getFromCache(e)},t=this
	return g(e,t),e._init(),e.add=null,e.remove=null,e.empty=null,e},fork:function(e){var t=function(e){return 0==arguments.length?n():n(e)},n=this
	function i(e){return H(e)?ue(K(e),e.enabled):L(e)?de(K(e)):fe(f("NotSupported",{reason:t}))
	var t}return g(t,n),x(t,{add:i(e.add),remove:i(e.remove)}),t._init(),t},asWritable:function(e){return this.fork(e)}}),x(be.prototype,{constructor:be,toString:function(){return"[Collection: "+this.size()+" items]"},each:function(e){return this.added(e),this.added.off(e),this},contains:function(e){var t=!1
	return this.each((function(n){e(n)&&(t=!0)})),t},observe:function(e){var t,n=this,i={},a={}
	function s(e,t){i[t]=e,delete a[t],l()}function c(e,t){a[t]=e,delete i[t],l()}function l(){t||(t=r((function(){var n=i,r=a
	i={},a={},t=null,e(n,r)}),0))}return n.added(s),n.removed(c),{dispose:function(){t&&(o(t),t=null),n.added.off(s),n.removed.off(c)}}},map:function(e){var t,n=this,i=be({get:function(e){return n.get().then((function(){return i(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return n.added((function(t,n,r){i.add(e(t),n,r)})),n.removed((function(e,t){i.remove(t)})),i.asReadOnly()},filter:function(e){var t,n=this,i=be({get:function(e){return n.get().then((function(){return i(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	return n.added((function(t,r,o){var a,s,c
	if(e(t)){for(a=o+1,s=n.size();a<s&&!e(n(a));)a++
	c=a<s?i.index(n.key(a)):i.size(),i.add(t,r,c)}})),n.removed((function(e,t){i.remove(t)})),i.asReadOnly()},sort:function(e){var t,n=this,i=be({get:function(e){return n.get().then((function(){return i(e)}))},subscribed:function(){t=n.subscribe()},unsubscribed:function(){t.dispose()}})
	function r(t,n){return e(t,n)||!e(n,t)}return n.added((function(e,t,o){for(var a=i.size(),s=0;s<a&&!r(e,i(s));)s++
	for(;s<a&&r(i(s),e)&&n.index(i.key(s))<o;)s++
	i.add(e,t,s)})),n.removed((function(e,t){i.remove(t)})),i.asReadOnly()}}),function(e){e.empty=e().asReadOnly()}(be||(be={})),t.collection=be
	var _e=function(){function e(t){var n
	if(!(this instanceof e))return new e(t)
	if(!(n=e.pattern.exec((t||"")+"")))throw new SyntaxError("Invalid URI: "+t)
	function i(e){var t=function(t){return 0==arguments.length?(n[e]||"")+"":(n[e]=(t||"")+"",this)}
	return t.toString=function(){return t()},t}this.scheme=i("scheme"),this.user=i("user"),this.host=i("host"),this.port=i("port"),this.path=i("path"),this.query=i("query"),this.hash=i("hash")}return e.prototype.toString=function(){function e(e,t){return t?e+t:""}var t=(this.user()?this.user()+"@":"")+(this.host()||"")+e(":",this.port())
	return(this.scheme()?this.scheme()+":":"")+e("//",t)+this.path()+e("?",this.query())+e("#",this.hash())},e}()
	_e.pattern={regexp:/^(?:([a-zA-Z][\w+-.]*):)?(?:\/\/(?:([^/@]*)@)?([^:/?#]*)(?:\:(\d*))?)?([^?#]*)(?:\?([^#]*))?(?:#(.*))?$/,exec:function(e){var t=this.regexp.exec(e)
	return t&&{scheme:t[1],user:t[2],host:t[3],port:t[4],path:t[5],query:t[6],hash:t[7]}}},function(e){var t=function(){function t(t){if(!(this instanceof e.Query))return new e.Query(t)
	var n=this
	P(t)?T(t.split("&"),(function(e){var t,i,r=e.indexOf("=")
	r<0?(t=e,i=""):(t=e.slice(0,r),i=e.slice(r+1)),t&&(n[decodeURIComponent(t)]=decodeURIComponent(i))})):t&&T(M(t),(function(e,t){n[t]=e+""}))}return t.prototype.toString=function(){var e=[]
	return T(M(this),(function(t,n){e.push(t?encodeURIComponent(n)+"="+encodeURIComponent(t):encodeURIComponent(n))})),e.join("&")},t}()
	e.Query=t}(_e||(_e={}))
	_(V,100,199),_(V,200,299),_(V,300,399),_(V,400,499),_(V,500,599),_(V,400,599)})),define("jcafe-property-model",["jcafe-property-model/lib/propertyModel"],(function(e){return e})),define("ui/viewModels/calling/callScreenViewModel/renderer",["require","lodash-compat","vendor/knockout","jcafe-property-model","ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper","ui/viewModels/calling/callScreenViewModel/participantLayoutItem"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("jcafe-property-model"),r=e("ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper"),o=e("ui/viewModels/calling/callScreenViewModel/participantLayoutItem")
	function a(){var e=this
	e.getGrid=function(e){return r.getGridConfiguration(e)},e.update=function(e){if(!t.isEqual(e.participantsInStage(),e.grid.itemsForStage)||!t.isEqual(e.participantsInRoster(),e.grid.itemsForRoster)){e.participantsInStage.removeAll(),e.participantsInRoster.removeAll()
	var n=e.grid.itemsForStage.length+e.grid.itemsForRoster.length>1
	e.grid.itemsForRoster.forEach((function(t){t.isInRoster(!0),t.videoIsAllowed(t.isScreenSharing||t.participant===e.screenSharingParticipant),t.isPinable(n),t.isZoomedIn(!1),t.positionInGrid(""),t.isParticipantAtTheBottom(!1)})),e.grid.itemsForStage.forEach((function(e){e.isInRoster(!1),e.videoIsAllowed(!0),e.isPinable(n)})),c(e.participantsInStage,e.grid.itemsForStage),c(e.participantsInRoster,e.grid.itemsForRoster)}},e.setUpdateLayoutCallback=t.noop}function s(e,a){var s=this,l=[],u=t.noop,d=o.build({conversation:e,participant:{audio:{isSpeaking:i.property(),isMuted:i.property(),state:i.property()},video:{channels:i.collection()},person:{type:i.property({value:"proxy"}),phoneNumbers:i.collection(),avatarUrl:i.property(),displayName:i.property({value:"Participant Proxy"}),id:i.property({value:"personProxy"})}},isSelfParticipant:!1,isScreenSharing:!1,isGroupConversation:e.isGroupConversation,isVisible:n.observable(!0),importance:0,contextElement:a}),p=e.videoService.activeSpeaker
	function f(e){return e.participant!==p.participant()||(e.removeParticipantComponent(),!1)}d.participant.video.channels.add(p.channel),p.participant.changed((function(e){var t
	if(function(){l.forEach((function(e){e.dispose&&e.dispose()})),l=[]}(),!e)return
	d.participant.person.displayName(e.person.displayName()),d.participant.person.id(e.person.id()),(t=function(e){for(var t=[];null!=e;e=Object.getPrototypeOf(e))Array.prototype.push.apply(t,Object.getOwnPropertyNames(e))
	return t.filter((function(e){return e.match("href_")}))}(Object.getPrototypeOf(e.person))[0])&&(d.participant.person[t]=e.person[t])
	l.push(e.audio.isSpeaking.changed(d.participant.audio.isSpeaking)),l.push(e.audio.isMuted.changed(d.participant.audio.isMuted)),l.push(e.audio.state.changed(d.participant.audio.state)),u()})),s.getGrid=function(t){var n
	return t.pinnedItem=null,p.participant()&&p.participant()!==e.selfParticipant&&(t.pinnedItem=d),(n=r.getGridConfiguration(t)).itemsForRoster=n.itemsForRoster.filter(f),n},s.update=function(e){t.isEqual(e.participantsInStage(),e.grid.itemsForStage)||(e.participantsInStage.removeAll(),e.grid.itemsForStage.forEach((function(e){e.isInRoster(!1),e.videoIsAllowed(!0),e.isPinable(!1)})),c(e.participantsInStage,e.grid.itemsForStage)),t.isEqual(e.participantsInRoster(),e.grid.itemsForRoster)||(e.participantsInRoster.removeAll(),e.grid.itemsForRoster.forEach((function(e){e.isInRoster(!0),e.videoIsAllowed(!1),e.isPinable(!1),e.isZoomedIn(!1),e.positionInGrid(""),e.isParticipantAtTheBottom(!1)})),c(e.participantsInRoster,e.grid.itemsForRoster))},s.setUpdateLayoutCallback=function(e){u=e}}function c(e,t){var n=e()
	e.valueWillMutate(),n.push.apply(n,t),e.valueHasMutated()}return{getRenderer:function(e,t){return r.isInActiveSpeakerMode(e)?new s(e,t):new a}}})),define("ui/viewModels/calling/callScreenViewModel/callScreenContentViewModel",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-enums","utils/common/cafeObservable","swx-constants","services/calling/participantManager","services/calling/screenSharingHandler","ui/viewModels/calling/callScreenViewModel/participantLayoutItem","ui/viewModels/calling/helpers/textFormatter","swx-constants","swx-i18n","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic","ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper","ui/viewModels/calling/callScreenViewModel/renderer","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-enums"),o=e("utils/common/cafeObservable"),a=e("swx-constants").CALLING,s=e("services/calling/participantManager"),c=e("services/calling/screenSharingHandler"),l=e("ui/viewModels/calling/callScreenViewModel/participantLayoutItem"),u=e("ui/viewModels/calling/helpers/textFormatter"),d=e("swx-constants").COMMON,p=e("swx-i18n").localization,f=e("ui/viewModels/chat/conversationTile"),m=e("ui/viewModels/chat/conversationTopic"),h=e("ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper"),v=e("ui/viewModels/calling/callScreenViewModel/renderer"),g=e("swx-service-locator-instance").default
	function y(e){var t,i,y,b,_,E,w=this,S=[],x=m.build(e),C=f.build(e),T=[],I=n.observable(),A=h.executeInAnimationFrame((function(){var e=w.stageParticipantsContainer()
	e?((!(t=I())||t&&(t.width!==e.offsetWidth||t.height!==e.offsetHeight))&&I({width:e.offsetWidth,height:e.offsetHeight}),w.updateLayout(),w.updateContentWidth(),w.dispatchEvent(d.events.callScreen.VIDEO_CONTAINER_SIZE_CHANGED,null,w.DIRECTION.CHILD)):I(null)
	var t})),M=g.resolve(d.serviceLocator.PUBSUB),O=n.observable(),k=v.getRenderer(e,O)
	function N(e){S.push(e.stream.state.changed((function(e){w.isLocalVideoOn(e!==r.mediaStreamState.Stopped)})))}function P(e,t){y.state()===a.CALL_STATES.CONNECTED&&w.participantNotification(p.fetch({key:e,params:{name:t}}))}function R(e,t){var n=L(e,t)
	T.push(n),t?z(n,!0):w.updateLayout()}function L(t,n){var i=e.selfParticipant===t
	return l.build({conversation:e,participant:t,isSelfParticipant:i,isScreenSharing:n,isGroupConversation:e.isGroupConversation,isVisible:w.isVisible,importance:t.audio.importance,contextElement:w.stageElement})}function D(e,t){var n,i
	T=T.filter((function(r){return r.participant!==e||r.isScreenSharing!==t||(_===r?i=!0:n=!0,r.dispose(),!1)})),i&&z(null),n&&(E&&!_.isScreenSharing?z(null):w.updateLayout())}function U(e){R(e,!1),P("callscreen_text_participant_joined_notification",e.person.displayName())}function F(e){R(e,!0),P("callscreen_text_participant_screen_shared_notification",e.person.displayName())}function B(e){D(e,!1),D(e,!0),P("callscreen_text_participant_left_notification",e.person.displayName())}function V(e){D(e,!0),P("callscreen_text_participant_screen_unshared_notification",e.person.displayName())}function G(){var t=e.autoCall&&e.autoCall()?p.fetch({key:"callscreen_text_autoCallConnectingMessage"}):""
	w.callScreenMessageText(t)}function H(){e.autoCall&&!e.autoCall()?e.autoCall.reason===r.callDisconnectionReason.AutoCallFailed?w.callScreenMessageText(p.fetch({key:"callscreen_text_autoCallFailedMessage"})):e.autoCall.reason===r.callDisconnectionReason.AutoCallTimeout&&w.callScreenMessageText(p.fetch({key:"callscreen_text_autoCallTimeoutMessage"})):w.callScreenMessageText("")}function q(e){switch(e){case a.CALL_STATES.CONNECTING:w.isCallConnected(!1),G()
	break
	case a.CALL_STATES.ENDING:w.isCallConnected(!1),H(),y.totalCallDuration&&w.duration(u.getFormattedDuration(y.totalCallDuration))
	break
	case a.CALL_STATES.CONNECTED:w.isCallConnected(!0),A(),w.callScreenMessageText("")}}function W(){w.isVisible(!0),A()}function j(){var t=_
	T.sort((function(e,n){return e===t?-1:n===t?1:e.isScreenSharing&&!n.isScreenSharing?-1:!e.isScreenSharing&&n.isScreenSharing?1:e.isVideoAvailable()&&!n.isVideoAvailable()?-1:!e.isVideoAvailable()&&n.isVideoAvailable()?1:e.importance&&n.importance?n.importance-e.importance:e.order<n.order?1:e.order>n.order?-1:0}))
	var n,i=T.slice(0)
	i.some((function(e){return!!e.isScreenSharing&&(n=e.participant,!0)}))
	var r=k.getGrid({stageDimensions:I(),items:i,pinnedItem:t,selfParticipantLayoutItem:w.selfParticipantLayoutItem,conversation:e,maxVideos:e.videoService.maxVideos()})
	t!==r.itemToPin&&z(r.itemToPin,!0,!1),k.update({participantsInStage:w.participantsInStage,participantsInRoster:w.participantsInRoster,grid:r,screenSharingParticipant:n}),w.participantsInStage().forEach((function(e){e.appendParticipantComponentToNewContainer(w.stageParticipantsContainer)})),h.arrangeGridItems(r,w.avatarSizeClass)}function z(e,t,n){e||(e=null),void 0===n&&(n=!0),_!==e&&(_&&_.isPinned(!1),e&&e.isPinned(!0),_=e,E=!!e&&!!t,n&&w.updateLayout(),w.dispatchEvent(d.events.callScreen.PINNED_PARTICIPANT_CHANGED,e?e.participant:null,w.DIRECTION.PARENT))}function K(e){var t=(e=e||{}).shouldBePinned?e.participant:null
	w.setPinnedParticipant(t,e.isScreenSharing)}function Y(){var t=e.videoService.videoMode()
	return(t===r.videoMode.ActiveSpeaker||t===r.videoMode.Both)&&e.isGroupConversation()}function Q(e){var t=_&&E&&!_.isScreenSharing
	if(e&&Y()&&t){var n
	if(T.some((function(t){return!t.isScreenSharing&&t.participant===e&&(n=t,!0)})),!n)return
	z(n,!0)}}function X(){w.updateLayout()}w.conversation=e,w.participantsInStage=n.observableArray(),w.participantsInRoster=n.observableArray(),w.stageElement=O,w.stageParticipantsContainer=n.observable(),w.isCallConnected=n.observable(!1),w.showEndCall=n.observable(!1),w.avatarUrl=o.newObservableProperty(e.avatarUrl),w.topic=x.topic,w.displayName=x.displayName,w.isPstn=C.isPstn,w.callScreenMessageText=n.observable(""),w.duration=n.observable(""),w.participantNotification=n.observable(""),w.isVisible=n.observable(!0),w.selfParticipantLayoutItem=L(e.selfParticipant,!1),w.selfParticipantLayoutItem.isInRoster(!0),w.isLocalVideoOn=w.selfParticipantLayoutItem.isVideoActive,w.isLocalVideoAllowed=w.selfParticipantLayoutItem.videoIsAllowed,w.canFit=n.observable(!1),w.avatarSizeClass=n.observable(""),w.mainClass=n.computed((function(){var e=[]
	w.canFit()&&e.push("fit")
	w.avatarSizeClass()&&e.push(w.avatarSizeClass())
	w.selfParticipantLayoutItem.isInRoster()&&e.push(a.CLASSES.LOCAL_PIP_IN_ROSTER)
	return e.join(" ")})),w.rosterWidth=n.observable(50),w.init=function(n,r,o){(b=n).init(A),y=r,w.footerButtonsWidth=o,e.selfParticipant.video.channels.added(N),S.push(w.stageParticipantsContainer.subscribe(A)),w.selfParticipantLayoutItem.appendParticipantComponentToNewContainer(w.stageElement),(t=s.build(e)).onParticipantAddedToCall(U),t.onParticipantRemovedFromCall(B),t.init(),(i=c.build(e)).onScreenSharingStarted(F),i.onScreenSharingStopped(V),i.init(),w.forwardEvent(d.events.callScreen.TOGGLE_FULLSCREEN,w.DIRECTION.CHILD,A),w.registerEvent(d.events.callScreen.SHOW_CHAT,A),w.registerEvent(d.events.callScreen.HIDE_CHAT,A),w.registerEvent(d.events.navigation.FRAGMENT_SHOW,W),w.registerEvent(d.events.navigation.FRAGMENT_BEFORE_HIDE,w.isVisible.bind(w,!1)),w.registerEvent(d.events.callScreen.SIDEBAR_TOGGLED,A),w.registerEvent(d.events.callScreen.VIDEO_STATE_CHANGED,A),w.registerEvent(d.events.callScreen.TOGGLE_NARROW_MENU,A),w.registerEvent(d.events.callScreen.ROSTER_WIDTH_CHANGED,w.rosterWidth.bind(w)),w.registerEvent(d.events.callScreen.TOGGLE_GRID_VIEW,K.bind(w,null)),S.push(y.state.subscribe(q)),q(y.state()),S.push(o.subscribe(w.updateContentWidth)),S.push(w.rosterWidth.subscribe(w.updateContentWidth)),S.push(w.participantsInStage.subscribe((function(){A()}))),M.subscribe(d.events.callScreen.PINNED_PARTICIPANT_CHANGED,K),Y()&&S.push(w.conversation.videoService.activeSpeaker.participant.changed(Q)),S.push(w.conversation.videoService.maxVideos.changed(X)),w.updateContentWidth(),k.setUpdateLayoutCallback(w.updateLayout)},w.updateLayout=function(){y.state()===a.CALL_STATES.CONNECTED&&h.executeInAnimationFrame(j)()},w.updateContentWidth=h.executeInAnimationFrame((function(){var e=(b.getContentWidth()-w.footerButtonsWidth())/2
	w.canFit(e>w.rosterWidth())})),w.setPinnedParticipant=function(e,t){var n
	e&&(n=T.filter((function(n){return n.participant===e&&n.isScreenSharing===!!t}))[0]),z(n)},w.dispose=function(){e.selfParticipant.video.channels.added.off(N),b.dispose(),S.forEach((function(e){e.dispose()})),S=[],M.unsubscribe(d.events.callScreen.PINNED_PARTICIPANT_CHANGED,K),t&&t.dispose(),T.forEach((function(e){e.dispose()})),w.selfParticipantLayoutItem.dispose()}}return t.assign(y.prototype,i),{build:function(e){return new y(e)}}})),define("text!views/calling/callScreenContent.html",[],(function(){return'<div class="stage" data-bind="css: mainClass, getVisibility: isVisible, getElement: stageElement">\r\n    <div class="stage-inner">\r\n        <div class="participantsInStage" data-bind="getElement: stageParticipantsContainer"></div>\r\n\r\n        \x3c!-- ko if: callScreenMessageText --\x3e\r\n        <div class="callScreenMessage fontSize-h2" data-bind="text: callScreenMessageText"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <swx-end-call class="end-call"\r\n                params="avatarUrl: avatarUrl,\r\n                        duration: duration,\r\n                        isGroupConversation: $parent.conversation.isGroupConversation(),\r\n                        displayName: displayName,\r\n                        isPstn: isPstn">\r\n        </swx-end-call>\r\n\r\n        <swx-call-roster class="call-roster"\r\n                        data-bind="css: { hasBorder: isLocalVideoOn() || (isCallConnected() && participantsInRoster().length > 0)}"\r\n                        params="layoutItemModels: participantsInRoster,\r\n                                selfLayoutItemModel: selfParticipantLayoutItem,\r\n                                conversation: $parent.conversation">\r\n        </swx-call-roster>\r\n\r\n        <div aria-live="polite" role="status" class="offScreen" data-bind="text: participantNotification"></div>\r\n    </div>\r\n</div>\r\n'}))
	define("ui/components/calling/callScreenContent",["require","exports","module","vendor/knockout","jsviews/calling/callScreenContent","ui/viewModels/calling/callScreenViewModel/callScreenContentViewModel","constants/components","text!views/calling/callScreenContent.html"],(function(e,t){var n=e("vendor/knockout"),i=e("jsviews/calling/callScreenContent"),r=e("ui/viewModels/calling/callScreenViewModel/callScreenContentViewModel")
	t.name=e("constants/components").calling.CONTENT,t.template=e("text!views/calling/callScreenContent.html"),t.viewModel={createViewModel:function(e,t){var o=r.build(e.conversation),a=i.build(t.element),s=n.dataFor(t.element)
	return o.setContext(s),o.init(a,e.callState,e.footerButtonsWidth),o}}})),define("ui/viewModels/calling/helpers/fullScreenModeTracker",["require","exports","module"],(function(e,t){var n=null
	function i(){var e=!0
	this.modeChanged=function(t){e=t},this.getLastMode=function(){return e}}t.get=function(){return null===n&&(n=new i),n},t.dispose=function(){null!==n&&(n=null)}})),define("ui/viewModels/calling/callScreenViewModel/callScreenHeaderViewModel",["require","lodash-compat","vendor/knockout","swx-browser-detect","swx-i18n","utils/common/eventMixin","ui/viewModels/calling/helpers/textFormatter","swx-constants","swx-constants","swx-pubsub-instance","ui/telemetry/actions/actionNames","swx-service-locator-instance","swx-enums","experience/settings","utils/common/styleModeHelper","ui/viewModels/calling/helpers/fullScreenModeTracker","ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper","ui/viewModels/chat/conversationTopic"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-browser-detect").default,r=e("swx-i18n").localization,o=e("utils/common/eventMixin"),a=e("ui/viewModels/calling/helpers/textFormatter"),s=e("swx-constants").CALLING.CALL_STATES,c=e("swx-constants").COMMON,l=e("swx-pubsub-instance").default,u=e("ui/telemetry/actions/actionNames"),d=e("swx-service-locator-instance").default,p=e("swx-enums"),f=e("experience/settings"),m=e("utils/common/styleModeHelper"),h=e("ui/viewModels/calling/helpers/fullScreenModeTracker"),v=e("ui/viewModels/calling/callScreenViewModel/callScreenLayoutHelper"),g=e("ui/viewModels/chat/conversationTopic")
	function y(e,t,o){var y,b,_,E=e.state,w=d.resolve(c.serviceLocator.FEATURE_FLAGS).isFeatureOn(c.featureFlags.CALLING_FULL_SCREEN_ENABLED),S=!1,x=this
	function C(e){if(S)return x.dispatchEvent(c.events.callScreen.HIDE_CHAT,null,x.DIRECTION.PARENT),void(S=!1)
	x.isContainerFullScreen(e),x.dispatchEvent(c.events.callScreen.TOGGLE_FULLSCREEN,e,x.DIRECTION.PARENT),l.publish(c.apiUIEvents.SWX_CALLSCREEN_MAXIMIZE,e),h.get().modeChanged(e)}function T(e){E()===s.CONNECTED&&x.watermarkCanBeShown(!e)}function I(e){switch(e){case s.CALLING:case s.EARLY_MEDIA:x.callStatusDisplay(o.CALLING)
	break
	case s.CONNECTED:m.get().isIntegratedProperty()&&w&&C(!0),A(),y=window.setInterval(A,1e3)
	break
	case s.ENDING:y?(A(),window.clearInterval(y)):x.callStatusDisplay(o.ENDED),S=!1}}function A(){x.callStatusDisplay(a.getFormattedDuration(e.getCurrentDuration()))}function M(e){var n=!!e
	x.isGridViewControlVisible(n&&!v.isInActiveSpeakerMode(t))}x.callStatusDisplay=n.observable(o.CONNECTING),x.watermarkCanBeShown=n.observable(!1),x.isContainerFullScreen=n.observable(!1),x.isSidebarExpanded=n.observable(!1),x.sidebarButtonText=n.computed((function(){return x.isSidebarExpanded()?r.fetch({key:"callscreen_text_hideSidebar"}):r.fetch({key:"callscreen_text_showSidebar"})})),x.showToggleSidebarIcon=2!==f.API.version,x.isInShellApp=n.observable(!1),x.fullscreenText=n.computed((function(){return x.isContainerFullScreen()?r.fetch({key:"callscreen_text_exitFullscreen"}):r.fetch({key:"callscreen_text_enterFullscreen"})})),x.isWatermarkVisible=n.computed((function(){return(E()===s.CONNECTED||E()===s.ENDING)&&x.watermarkCanBeShown()})),x.isGridViewControlVisible=n.observable(!1),x.onButtonFocused=function(){x.dispatchEvent(c.events.callScreen.BUTTON_FOCUSED,!0,x.DIRECTION.PARENT)},x.onButtonBlurred=function(){x.dispatchEvent(c.events.callScreen.BUTTON_FOCUSED,!1,x.DIRECTION.PARENT)},x.toggleContainerFullScreen=function(){var e=d.resolve(c.serviceLocator.ACTION_TELEMETRY)
	C(!x.isContainerFullScreen()),e.recordAction(u.audioVideo.toggleFullScreen)},x.toggleNarrowMenu=function(){var e=d.resolve(c.serviceLocator.ACTION_TELEMETRY)
	x.isSidebarExpanded(!x.isSidebarExpanded()),x.dispatchEvent(c.events.callScreen.TOGGLE_NARROW_MENU,null,x.DIRECTION.PARENT),e.recordAction(u.audioVideo.toggleNarrowMenu)},x.toggleGridView=function(){var e=d.resolve(c.serviceLocator.ACTION_TELEMETRY)
	x.dispatchEvent(c.events.callScreen.TOGGLE_GRID_VIEW,null,x.DIRECTION.PARENT),e.recordAction(u.audioVideo.toggleGridView)},x.init=function(){_=g.build(t),x.conversationTopic=_.topic,x.registerEvent(c.events.callScreen.CONTROLS_VISIBLE,T),x.registerEvent(c.events.callScreen.PINNED_PARTICIPANT_CHANGED,M),x.registerEvent(c.events.callScreen.SHOW_CHAT,(function(){C(!1),S=!0})),b=E.subscribe(I),I(E()),C(function(){if(i.getBrowserInfo().browserName===i.BROWSERS.SKYPE_SHELL)return!0
	if(t.autoCall&&t.autoCall())return!0
	if(t.selfParticipant.audio.state.reason===p.callDisconnectionReason.CallEscalated)return h.get().getLastMode()
	if(m.get().isIntegratedProperty()&&w)return!1
	return w}()),i.getBrowserInfo().browserName===i.BROWSERS.SKYPE_SHELL&&x.isInShellApp(!0)},x.dispose=function(){b.dispose(),x.fullscreenText.dispose(),x.sidebarButtonText.dispose(),x.isWatermarkVisible.dispose(),y&&window.clearInterval(y),_.dispose()}}return t.assign(y.prototype,o),{build:function(e,t,n){return new y(e,t,n)}}})),define("text!views/calling/callScreenHeader.html",[],(function(){return'<div class="header">\r\n    <div class="controls">\r\n        <button class="calling btn circle small" data-bind="click: toggleGridView, css: { hide: !isGridViewControlVisible() }, l10n_attr: { \'title\': \'callscreen_text_enterGvcGrid\' }, event: { focus: onButtonFocused, blur: onButtonBlurred }" type="button">\r\n                <span class="iconfont gvcGrid" data-bind="l10n: {\'key\': \'callscreen_text_enterGvcGrid\' }"></span>\r\n        </button>\r\n        <button class="calling btn circle small" data-bind="click: toggleContainerFullScreen, css: { hide: isInShellApp() }, attr: { title: fullscreenText }, event: { focus: onButtonFocused, blur: onButtonBlurred }" type="button">\r\n            <span class="iconfont fullscreenOn" data-bind="css: { fullscreenOff: isContainerFullScreen() }, text: fullscreenText"></span>\r\n        </button>\r\n        <button class="calling btn circle small menuButton" data-bind="visible: showToggleSidebarIcon, click: toggleNarrowMenu, event: { focus: onButtonFocused, blur: onButtonBlurred }, attr: { title: sidebarButtonText }" type="button">\r\n            <span class="iconfont menu" data-bind="text: sidebarButtonText"></span>\r\n        </button>\r\n    </div>\r\n    <div class="title">\r\n        <h3 class="conversationTopic" data-bind="text: conversationTopic"></h3>\r\n        <h3 class="info callStatus" data-bind="text: callStatusDisplay"></h3>\r\n    </div>\r\n</div>\r\n<div class="watermark" data-bind="visible: isWatermarkVisible()"></div>\r\n'})),define("ui/components/calling/callScreenHeader",["require","exports","module","vendor/knockout","ui/viewModels/calling/callScreenViewModel/callScreenHeaderViewModel","constants/components","text!views/calling/callScreenHeader.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/callScreenViewModel/callScreenHeaderViewModel")
	t.name=e("constants/components").calling.HEADER,t.template=e("text!views/calling/callScreenHeader.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e.state,e.conversation,e.callScreenStrings),o=n.dataFor(t.element)
	return r.setContext(o),r.init(),r}}})),define("jsviews/calling/callScreenFooter",["require","swx-constants","browser/window"],(function(e){var t=e("swx-constants").COMMON,n=e("browser/window")
	function i(e){var i,r
	this.getButtonsWidth=function(){return e.querySelector(".button.row.center").offsetWidth},this.init=function(e){i=e,r=!1,n.addEventListener(t.events.browser.RESIZE,(function(){r||i()}))},this.dispose=function(){r=!0,n.removeEventListener(t.events.browser.RESIZE,i)}}return{build:function(e){return new i(e)}}})),define("ui/viewModels/calling/moreActionsControlViewModel",["require","lodash-compat","utils/common/eventMixin","vendor/knockout","ui/viewModels/calling/baseCallControlViewModel","ui/telemetry/actions/actionNames","swx-constants","swx-constants","swx-service-locator-instance","ui/contextMenu/items/all","ui/contextMenu/contextMenu","ui/telemetry/actions/actionSources","utils/common/cafeObservable","swx-enums","swx-i18n"],(function(e){var t=e("lodash-compat"),n=e("utils/common/eventMixin"),i=e("vendor/knockout"),r=e("ui/viewModels/calling/baseCallControlViewModel"),o=e("ui/telemetry/actions/actionNames"),a=e("swx-constants").COMMON,s=e("swx-constants").CALLING,c=e("swx-service-locator-instance").default,l=e("ui/contextMenu/items/all"),u=e("ui/contextMenu/contextMenu"),d=e("ui/telemetry/actions/actionSources"),p=e("utils/common/cafeObservable"),f=e("swx-enums"),m=e("swx-i18n").localization
	function h(e){var t,n,h,v,g=this,y=c.resolve(a.serviceLocator.FEATURE_FLAGS),b=i.observable(!0),_=p.newObservableProperty(e.selfParticipant.audio.state),E=p.newObservableProperty(e.participants.add.enabled),w=p.newObservableProperty(e.screenSharingService.start.enabled),S=p.newObservableProperty(e.screenSharingService.stop.enabled),x=m.fetch({key:"callscreen_text_shareScreens"}),C=m.fetch({key:"callscreen_text_stopSharingScreen"})
	r.call(g,e,b),g.addParticipantText=m.fetch({key:"callscreen_text_addParticipants"}),g.moreActionsText=m.fetch({key:"callscreen_text_plusButton"}),g.screenShareText=i.pureComputed((function(){return w()||!S()?x:C})),g.avSettingsText=m.fetch({key:"callscreen_text_showAVSettings"}),g.isAddingParticipantsAllowed=i.pureComputed((function(){return E()&&_()===f.callConnectionState.Connected})),g.isScreenSharingAllowed=i.pureComputed((function(){return y.isFeatureOn(a.featureFlags.OUTGOING_SCREEN_SHARING)&&(w()||S())})),g.isMoreActionsButtonEnabled=i.pureComputed((function(){return(g.isAddingParticipantsAllowed()||g.isScreenSharingAllowed()||I())&&g.isCallControlEnabled()})),g.showMoreActionsMenu=function(t,n){var i=[l.AddParticipantsMenuItem.build((function(){return!g.isAddingParticipantsAllowed()}),g.addParticipants),l.ShareScreen.build((function(){return!g.isScreenSharingAllowed()}),w(),g.shareScreen),l.AVSettings.build((function(){return!I()}),g.avSettings),l.TransferCall.build((function(){return!y.isFeatureOn(a.featureFlags.TRANSFER_CALL)}),g.transferCall)],r={source:d.recentItem,isGroupConversation:e.isGroupConversation()}
	n.customClientOptions={offsetElement:n.target,position:f.contextMenuPosition.Top,offset:5},u.show(i,n,r),A(o.audioVideo.moreActions)},g.addParticipants=function(){g.dispatchEvent(a.events.callScreen.TOGGLE_MODAL_DIALOG,s.CALL_SCREEN_DIALOG.NAME.ADD_PARTICIPANTS,g.DIRECTION.PARENT),A(o.audioVideo.addParticipants)},g.shareScreen=function(){w()?y.isFeatureOn(a.featureFlags.OUTGOING_SCREEN_SHARING_PREVIEW)?(g.dispatchEvent(a.events.callScreen.TOGGLE_MODAL_DIALOG,s.CALL_SCREEN_DIALOG.NAME.SCREEN_SHARING_PREVIEW,g.DIRECTION.PARENT),A(o.audioVideo.shareScreenPreview)):(e.screenSharingService.start(),A(o.audioVideo.shareScreen)):S()&&(e.screenSharingService.stop(),A(o.audioVideo.stopSharingScreen))},g.avSettings=function(){g.dispatchEvent(a.events.callScreen.TOGGLE_MODAL_DIALOG,s.CALL_SCREEN_DIALOG.NAME.AV_SETTINGS,g.DIRECTION.PARENT)},g.transferCall=function(){g.dispatchEvent(a.events.callScreen.TOGGLE_MODAL_DIALOG,s.CALL_SCREEN_DIALOG.NAME.TRANSFER_CALL,g.DIRECTION.PARENT)},t=E.subscribe(M),n=w.subscribe(M),h=S.subscribe(M),v=u.isVisible.subscribe((function(e){e?g.dispatchEvent(a.events.callScreen.MORE_ACTION_MENU_VISIBLE,null,g.DIRECTION.PARENT):g.dispatchEvent(a.events.callScreen.MORE_ACTION_MENU_HIDDEN,null,g.DIRECTION.PARENT)}))
	var T=g.dispose
	function I(){return y.isFeatureOn(a.featureFlags.AUDIO_VIDEO_SETTINGS_SUPPORT)}function A(e){c.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(e)}function M(){u.hide()}g.dispose=function(){t&&t.dispose(),n&&n.dispose(),h&&h.dispose(),_.dispose(),E.dispose(),w.dispose(),S.dispose(),v.dispose(),T.call(g)}}return h.prototype=Object.create(r.prototype),h.prototype.constructor=h,t.assign(h.prototype,n),{build:function(e){return new h(e)}}})),define("ui/viewModels/calling/videoControlViewModel",["require","ui/viewModels/calling/baseCallControlViewModel","vendor/knockout","swx-enums","utils/common/cafeObservable","swx-i18n","swx-cafe-application-instance","ui/telemetry/actions/actionNames","swx-constants","ui/modelHelpers/personHelper","swx-service-locator-instance"],(function(e){var t=e("ui/viewModels/calling/baseCallControlViewModel"),n=e("vendor/knockout"),i=e("swx-enums"),r=e("utils/common/cafeObservable"),o=e("swx-i18n").localization,a=e("swx-cafe-application-instance"),s=e("ui/telemetry/actions/actionNames"),c=e("swx-constants").COMMON,l=e("ui/modelHelpers/personHelper"),u=e("swx-service-locator-instance").default
	function d(e){var d=this,p=n.observable(!1),f=n.observable(),m=r.newObservableProperty(a.get().devicesManager.selectedCamera),h=n.observable(!1),v=!1
	function g(e){e.stream.state.changed(f),e.isStarted.set.enabled.changed((function(e){v=e,y()}))}function y(){p(e.videoService.start.enabled()||v)}function b(){var t=e.participants()
	h(1===t.length&&l.isEchoContact(t[0].person))}function _(t){e.selfParticipant.video.channels(0).isStarted(t)}e.videoService.start.enabled.changed(y),e.participants.changed(b),t.call(d,e,p),d.isLocalVideoAvailable=n.computed((function(){return null!==m()})),d.isLocalVideoOn=n.computed((function(){return f&&d.isLocalVideoAvailable()&&!!f()&&f()!==i.mediaStreamState.Stopped})),d.isLocalVideoButtonEnabled=n.computed((function(){return d.isLocalVideoAvailable()&&d.isCallControlEnabled()&&!h()})),d.videoStateText=n.computed((function(){return d.isLocalVideoOn()?o.fetch({key:"callscreen_text_videoOff"}):o.fetch({key:"callscreen_text_videoOn"})})),d.toggleVideo=function(){d.isLocalVideoButtonEnabled()&&(u.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(s.audioVideo.toggleVideo),d.isLocalVideoOn()?_(!1):e.selfParticipant.video.state()===i.callConnectionState.Disconnected&&e.videoService.start.enabled()?e.videoService.start().then((function(){_(!0)})):_(!0))},d.dispose=function(){m.dispose(),d.videoStateText.dispose(),e.selfParticipant.video.channels.added.off(g),e.participants.changed.off(b),e.videoService.start.enabled.changed.off(y)},e.selfParticipant.video.channels.added(g)}return d.prototype=Object.create(t.prototype),d.prototype.constructor=d,{build:function(e){return new d(e)}}})),define("ui/viewModels/calling/messageControlViewModel",["require","ui/viewModels/calling/baseCallControlViewModel","lodash-compat","vendor/knockout","swx-enums","swx-i18n","swx-constants","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e){var t=e("ui/viewModels/calling/baseCallControlViewModel"),n=e("lodash-compat"),i=e("vendor/knockout"),r=e("swx-enums"),o=e("swx-i18n").localization,a=e("swx-constants").COMMON,s=e("ui/telemetry/actions/actionNames"),c=e("swx-service-locator-instance").default
	function l(e,l){var u=this,d=i.observable(!1)
	function p(e){e&&e.direction&&e.type&&e.direction()===a.chat.messageType.INCOMING&&e.type()===r.activityType.TextMessage&&u.hasMessage(!0)}l=l||n.noop,t.call(u,e,d),u.buttonText=o.fetch({key:"callscreen_text_showChat"}),u.showChat=function(){c.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(s.audioVideo.showChat),u.hasMessage(!1),l()},u.hasMessage=i.observable(!1),u.dispose=function(){e.historyService.activityItems.added.off(p)},e.historyService.activityItems.added(p)}return l.prototype=Object.create(t.prototype),l.prototype.constructor=l,{build:function(e,t){return new l(e,t)}}})),define("utils/common/outsideClickHandler",["require","exports","module","lodash-compat","browser/dom","browser/document","swx-constants","constants/cssClasses","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("browser/dom"),r=e("browser/document"),o=e("swx-constants").COMMON,a=e("constants/cssClasses"),s=e("swx-constants").KEYS,c=null
	function l(e){c&&c.forEach((function(t){i.getParentWithClass(e.target,t.name)||t.callback()}))}function u(e){var t=e.which||e.keyCode
	c&&t===s.ESCAPE&&!i.getElement("."+a.contextMenu.CONTEXT_MENU)&&(c.forEach((function(e){e.callback()})),e.stopPropagation())}function d(e){n.remove(c,(function(t){return t.name===e}))}t.add=function(e,t){if(!e)throw new Error("className is mandatory")
	if(!t)throw new Error("handler is not provided")
	c=c||[],d(e),0===c.length&&(r.body.addEventListener(o.events.browser.CLICK,l,!0),r.body.addEventListener(o.events.browser.KEYDOWN,u,!0)),c.push({name:e,callback:t})},t.remove=function(e){if(!e)throw new Error("className is mandatory")
	d(e),null===c||c.length>0||(c=null,r.body.removeEventListener(o.events.browser.CLICK,l,!0),r.body.removeEventListener(o.events.browser.KEYDOWN,u,!0))},t._getListenters=function(){return c},t._dispose=function(){c=null,r.body.removeEventListener(o.events.browser.CLICK,l,!0),r.body.removeEventListener(o.events.browser.KEYDOWN,u,!0)}})),define("ui/viewModels/calling/callScreenDialpadViewModel",["require","ui/viewModels/calling/baseCallControlViewModel","vendor/knockout","swx-utils-common","swx-i18n","utils/common/eventHelper","ui/telemetry/actions/actionNames","lodash-compat","swx-utils-common","swx-constants","utils/common/eventMixin","swx-service-locator-instance","utils/common/outsideClickHandler"],(function(e){var t=e("ui/viewModels/calling/baseCallControlViewModel"),n=e("vendor/knockout"),i=e("swx-utils-common").async,r=e("swx-i18n").localization,o=e("utils/common/eventHelper"),a=e("ui/telemetry/actions/actionNames"),s=e("lodash-compat"),c=e("swx-utils-common").stringUtils,l=e("swx-constants").COMMON,u=e("utils/common/eventMixin"),d=e("swx-service-locator-instance").default,p=e("utils/common/outsideClickHandler"),f="DialPadController"
	function m(e){var s,u=this
	u.isDialpadOn=n.observable(!1),u.dialpadText=n.observable(""),t.call(u,e),u.init=function(e){s=e,u.registerEvent(l.events.skypeOut.DIAL_BUTTON_CLICKED,u.sendDtmf)},u.sendDtmf=function(t){return e.audioService.sendDtmf(t.text).then((function(e){(function(e){var t=u.dialpadText(),n=c.inject(t,e,t.length)
	u.dialpadText(n),i.execute((function(){var e
	e=n.length,s.selectionStart=e,s.selectionEnd=e}))})(e)}))},u.toggleDialpad=function(e,t){if(u.isDialpadButtonEnabled()){var n=u.isDialpadOn()
	n?p.remove(f):p.add(f,u.toggleDialpad),u.isDialpadOn(!n),r=d.resolve(l.serviceLocator.ACTION_TELEMETRY),s=a.audioVideo.toggleDialpad,r.recordAction(s),u.isDialpadOn()?i.execute((function(){u.dispatchEvent(l.events.callScreen.DIALPAD_VISIBLE,null,u.DIRECTION.PARENT)})):u.dispatchEvent(l.events.callScreen.DIALPAD_HIDDEN,null,u.DIRECTION.PARENT)}var r,s
	t&&o.swallow(t)},u.isDialpadButtonEnabled=n.computed((function(){return u.isCallConnected()})),u.displayDialpad=n.computed((function(){return u.isDialpadButtonEnabled()&&u.isDialpadOn()})),u.dialpadStateText=n.computed((function(){return u.isDialpadOn()?r.fetch({key:"callscreen_text_dialpadOff"}):r.fetch({key:"callscreen_text_dialpadOn"})})),u.dispose=function(){p.remove(f),u.dialpadStateText.dispose(),u.displayDialpad.dispose(),u.isDialpadButtonEnabled.dispose(),u.isDialpadOn(!1),u.dialpadText("")}}return m.prototype=Object.create(t.prototype),m.prototype.constructor=m,s.assign(m.prototype,u),{build:function(e){return new m(e)}}})),define("ui/calling/callingCapabilityHelper",["require","exports","module","swx-cafe-application-instance","swx-browser-detect","swx-service-locator-instance","swx-constants","ui/modelHelpers/conversationHelper","vendor/knockout"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-browser-detect").default,r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("ui/modelHelpers/conversationHelper"),s=e("vendor/knockout")
	t.getVideoCapabilityObservable=function(e){var t,c=n.get().personsAndGroupsManager.mePerson.capabilities.video,l=r.resolve(o.serviceLocator.FEATURE_FLAGS),u=a.isConversationWithPstn(e),d=s.observable(!1)
	return t=c.changed((function(t){t?e.isGroupConversation()&&i.getBrowserInfo().isChromeOnLinux?d(l.isFeatureOn(o.featureFlags.PLUGINLESS_GROUP_VIDEO_CALLING_CHROME_LINUX)):e.isGroupConversation()?d(!0):d(!u):d(!1)})),d.dispose=t.dispose.bind(t),d}})),define("ui/viewModels/calling/callScreenViewModel/callScreenFooterViewModel",["require","lodash-compat","vendor/knockout","browser/dom","swx-util-calling-stack","swx-constants","swx-service-locator-instance","utils/common/eventMixin","ui/modelHelpers/conversationHelper","ui/viewModels/calling/endCallControlViewModel","ui/viewModels/calling/moreActionsControlViewModel","ui/viewModels/calling/micControlViewModel","ui/viewModels/calling/videoControlViewModel","ui/viewModels/calling/messageControlViewModel","ui/viewModels/calling/callScreenDialpadViewModel","swx-focus-handler","swx-utils-common","ui/calling/callingCapabilityHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("browser/dom"),r=e("swx-util-calling-stack"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("utils/common/eventMixin"),c=e("ui/modelHelpers/conversationHelper"),l=e("ui/viewModels/calling/endCallControlViewModel"),u=e("ui/viewModels/calling/moreActionsControlViewModel"),d=e("ui/viewModels/calling/micControlViewModel"),p=e("ui/viewModels/calling/videoControlViewModel"),f=e("ui/viewModels/calling/messageControlViewModel"),m=e("ui/viewModels/calling/callScreenDialpadViewModel"),h=e("swx-focus-handler"),v=e("swx-utils-common").async,g=e("ui/calling/callingCapabilityHelper")
	function y(e,t){var s,y,b=this,_=a.resolve(o.serviceLocator.FEATURE_FLAGS),E=_.isFeatureOn(o.featureFlags.PSTN_ENABLED),w=c.isConversationWithPstn(e),S=E&&w,x=g.getVideoCapabilityObservable(e)
	function C(){v.execute((function(){b.dispatchEvent(o.events.callScreen.BUTTONS_WIDTH_CHANGED,b.view.getButtonsWidth(),b.DIRECTION.PARENT)}))}function T(e){!b.showDialpadControl()&&c.isPstnParticipant(e)&&(A(),b.showDialpadControl(!0),M())}function I(t){b.showDialpadControl()&&c.isPstnParticipant(t)&&(c.isConversationWithPstn(e)||b.showDialpadControl(!1))}function A(){b.dialpadControl||(b.dialpadControl=m.build(e,t),b.dialpadControl.setContext(b))}function M(){b.dialpadControl.init(i.getElement(".DialPadController-input",t))}function O(){var e=b.showVideoControl()?".toggleVideo":".toggleMic",n=i.getElement(e,t)
	n&&v.execute((function(){h.get().addFocusRequestToQueue(n,h.Priorities.Immediate)}))}b.endCallControl=l.build(e,!0),b.micControl=d.build(e,!0),b.videoControl=p.build(e,!0),b.moreActionsControl=u.build(e),b.moreActionsControl.setContext(b),b.showDialpadControl=n.observable(S),b.showVideoControl=x,b.showMessageControl=_.isFeatureOn(o.featureFlags.CALLSCREEN_MINMAX),b.messageControl=f.build(e,(function(){b.dispatchEvent(o.events.callScreen.SHOW_CHAT,null,b.DIRECTION.PARENT)})),b.isLocalEscalationEnabled=function(){if(e.selfParticipant.isAnonymous())return!1
	return r.get().isPluginlessCallingSupported()?_.isFeatureOn(o.featureFlags.PLUGINLESS_LOCAL_ESCALATION):_.isFeatureOn(o.featureFlags.GVC_LOCAL_ESCALATION)}(),b.isScreenSharingEnabled=_.isFeatureOn(o.featureFlags.OUTGOING_SCREEN_SHARING),b.isAVSettingsEnabled=_.isFeatureOn(o.featureFlags.AUDIO_VIDEO_SETTINGS_SUPPORT),b.hasMoreThanOneMoreAction=b.isLocalEscalationEnabled&&b.isScreenSharingEnabled||b.isLocalEscalationEnabled&&b.isAVSettingsEnabled||b.isAVSettingsEnabled&&b.isScreenSharingEnabled,S&&A(),b.view=null,b.onButtonFocused=function(){b.dispatchEvent(o.events.callScreen.BUTTON_FOCUSED,!0,b.DIRECTION.PARENT)},b.onButtonBlurred=function(){b.dispatchEvent(o.events.callScreen.BUTTON_FOCUSED,!1,b.DIRECTION.PARENT)},b.init=function(t){b.view=t,b.view.init(C),b.dialpadControl&&M(),b.forwardEvent(o.events.callScreen.TOGGLE_MODAL_DIALOG,b.DIRECTION.PARENT),b.forwardEvent(o.events.callScreen.MORE_ACTION_MENU_VISIBLE,b.DIRECTION.PARENT),b.forwardEvent(o.events.callScreen.MORE_ACTION_MENU_HIDDEN,b.DIRECTION.PARENT),b.forwardEvent(o.events.callScreen.DIALPAD_VISIBLE,b.DIRECTION.PARENT),b.forwardEvent(o.events.callScreen.DIALPAD_HIDDEN,b.DIRECTION.PARENT),b.registerEvent(o.events.callScreen.FOCUS_CALL_SCREEN,O),b.registerEvent(o.events.callScreen.HIDE_CHAT,b.messageControl.hasMessage.bind(b,!1)),e.isGroupConversation()&&E&&(s=e.participants.added(T),y=e.participants.removed(I)),C(),O()},b.dispose=function(){b.view&&b.view.dispose(),x.dispose(),b.endCallControl.dispose(),b.micControl.dispose(),b.videoControl.dispose(),b.moreActionsControl.dispose(),b.messageControl.dispose(),b.dialpadControl&&b.dialpadControl.dispose(),s&&s.dispose(),y&&y.dispose()}}return t.assign(y.prototype,s),{build:function(e,t){return new y(e,t)}}})),define("text!views/calling/callScreenFooter.html",[],(function(){return'<div class="controls">\r\n    <div class="button row center">\r\n        \x3c!-- ko if: showMessageControl --\x3e\r\n            \x3c!-- ko with: messageControl --\x3e\r\n            <button data-bind="visible: isCallConnected, click: showChat, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, attr: { title: buttonText}" class="calling btn primary circle large toggleMessage protected" type="button">\r\n                <span class="iconfont" data-bind="css: { message: !hasMessage(), messageWithBadge: hasMessage}, text: buttonText"></span>\r\n                <span class="toggleMessage-unread" data-bind="visible: hasMessage"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: showVideoControl --\x3e\r\n            \x3c!-- ko with: videoControl --\x3e\r\n            <button data-bind="click: toggleVideo, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, enable: isLocalVideoAvailable(), css: { selected: isLocalVideoOn(), disabled: !isLocalVideoButtonEnabled() }, attr: { title: videoStateText, \'aria-disabled\': !isLocalVideoButtonEnabled() }" class="calling btn primary circle large toggleVideo protected" type="button">\r\n                <span class="iconfont videoOn" data-bind="css: { videoOffStatus: !isLocalVideoOn() }, text: videoStateText"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko with: micControl --\x3e\r\n        <button data-bind="click: toggleMicrophone, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, enable: isMicrophoneAvailable(), css: { selected: isMicrophoneOn(), disabled: !isMicrophoneButtonEnabled() }, attr: { title: microphoneStateText, \'aria-disabled\': !isMicrophoneButtonEnabled() }" class="calling btn primary circle large toggleMic protected" type="button">\r\n            <span class="iconfont microphoneOn" data-bind="css: { microphoneOffStatus: !isMicrophoneOn() }, text: microphoneStateText"></span>\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: showDialpadControl --\x3e\r\n            \x3c!-- ko with: dialpadControl --\x3e\r\n            <div class="DialPadController">\r\n                <div class="DialPadController-container popup arrow down" data-bind="css: { \'DialPadController-container--active\': displayDialpad() }">\r\n                    <div class="DialPadController-inputContainer">\r\n                        <input type="text" name="dialPadController-input" class="DialPadController-input" data-bind="textInput: dialpadText" readonly="true" disabled />\r\n                    </div>\r\n                    <swx-dialpad class="DialPad DialPad--themeDark"></swx-dialpad>\r\n                </div>\r\n                <button data-bind="click: toggleDialpad, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, enable: isDialpadButtonEnabled(), css: { disabled: !isDialpadButtonEnabled() }, attr: { title: dialpadStateText, \'aria-disabled\': !isDialpadButtonEnabled() }" class="calling btn primary circle large toggleDialpad protected" type="button">\r\n                    <span class="iconfont dialpad" data-bind="css: { dialpadOff: !isDialpadButtonEnabled() }, text: dialpadStateText"></span>\r\n                </button>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: hasMoreThanOneMoreAction --\x3e\r\n            \x3c!-- ko with: moreActionsControl --\x3e\r\n            <button data-bind="click: showMoreActionsMenu, enable: isMoreActionsButtonEnabled(), css: { disabled: !isMoreActionsButtonEnabled() }, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, attr: { title: moreActionsText, \'aria-disabled\': !isMoreActionsButtonEnabled() }" class="calling btn primary circle large plus protected" type="button">\r\n                <span class="iconfont plus"></span>\r\n            </button>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko ifnot: hasMoreThanOneMoreAction --\x3e\r\n            \x3c!-- ko if: isLocalEscalationEnabled --\x3e\r\n                \x3c!-- ko with: moreActionsControl --\x3e\r\n                <button data-bind="click: addParticipants, enable: isAddingParticipantsAllowed(), css: { disabled: !isAddingParticipantsAllowed() }, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, attr: { title: addParticipantText, \'aria-disabled\': !isAddingParticipantsAllowed() }" class="calling btn primary circle large toggleAdd protected" type="button">\r\n                    <span class="iconfont contactAdd"></span>\r\n                </button>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: isScreenSharingEnabled --\x3e\r\n                \x3c!-- ko with: moreActionsControl --\x3e\r\n                <button data-bind="click: shareScreen, enable: isScreenSharingAllowed(), css: { disabled: !isScreenSharingAllowed() }, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, attr: { title: screenShareText, \'aria-disabled\': !isScreenSharingAllowed() }" class="calling btn primary circle large screenshare protected" type="button">\r\n                    <span class="iconfont screenshare"></span>\r\n                </button>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: isAVSettingsEnabled --\x3e\r\n                \x3c!-- ko with: moreActionsControl --\x3e\r\n                <button data-bind="click: avSettings, enable: true, css: { disabled: false }, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, attr: { title: avSettingsText }" class="calling btn primary circle large toggleAdd protected" type="button">\r\n                    <span class="iconfont settings"></span>\r\n                </button>\r\n                \x3c!-- /ko --\x3e\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko with: endCallControl --\x3e\r\n        <button data-bind="click: endCall, event: {focus: $parent.onButtonFocused, blur: $parent.onButtonBlurred}, enable: isCallControlEnabled(), css: { disabled: !isCallControlEnabled() }, l10n_attr: { \'title\': \'callscreen_text_endCall\' }" class="calling btn primary circle large red endCall protected" type="button">\r\n            <span class="iconfont callEnd" data-bind="l10n: { \'key\': \'callscreen_text_endCall\' }"></span>\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/callScreenFooter",["require","exports","module","vendor/knockout","jsviews/calling/callScreenFooter","ui/viewModels/calling/callScreenViewModel/callScreenFooterViewModel","constants/components","text!views/calling/callScreenFooter.html"],(function(e,t){var n=e("vendor/knockout"),i=e("jsviews/calling/callScreenFooter"),r=e("ui/viewModels/calling/callScreenViewModel/callScreenFooterViewModel")
	t.name=e("constants/components").calling.FOOTER,t.template=e("text!views/calling/callScreenFooter.html"),t.viewModel={createViewModel:function(e,t){var o=r.build(e.conversation,t.element),a=i.build(t.element),s=n.dataFor(t.element)
	return o.setContext(s),o.init(a),o}}})),define("ui/modelObservers/calling/activeCallObserver",["require","exports","module","swx-constants","swx-service-locator-instance","vendor/knockout"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("vendor/knockout")
	function o(){var e,t,o,a=this
	t=i.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.DISABLE_CONCURRENT_ACTIVE_CALLS),o=i.resolve(n.serviceLocator.MODEL_UI_OBSERVER).conversationsCallStateObserver,a.isCallActive=r.observable(t&&o.activeCalls().length>0),a.dispose=function(){t&&e.dispose()},t&&(e=o.activeCalls.subscribe((function(e){a.isCallActive(e.length>0)})))}t.build=function(){return new o}})),define("ui/viewModels/chat/conversationActivity",["require","exports","module","vendor/knockout","swx-enums","browser/window","ui/modelObservers/calling/activeCallObserver"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-enums"),r=e("browser/window"),o=e("ui/modelObservers/calling/activeCallObserver")
	function a(e){var t,a,s=this,c=1e3,l=-1,u=o.build()
	function d(){var t=!!e.activeModalities.audio(),n=e.selfParticipant.audio.state()===i.callConnectionState.Disconnected||e.selfParticipant.audio.state()===i.callConnectionState.Notified,r=e.isGroupConversation()
	u.isCallActive()?s.canJoinCall(!1):s.canJoinCall(r&&t&&n)}function p(n){switch(function(e){s.isOnCall(e===i.callConnectionState.Connected)}(n),d(),n){case i.callConnectionState.Connected:t||(s.callDuration(l),a=e.audioService.callConnected(),t=r.setInterval(h,c))
	break
	case i.callConnectionState.Disconnected:t&&(r.clearInterval(t),t=null,s.callDuration(l))}}function f(e,t){var n=!e,r=t!==i.callingNotSupportedReasons.PluginNotInstalled
	s.isCallingDisabled(n&&r)}function m(e,t){var n=!e,r=t!==i.callingNotSupportedReasons.PluginNotInstalled
	s.isVideoCallingDisabled(n&&r)}function h(){var e=new Date-a
	s.callDuration(e)}s.callDuration=n.observable(l),s.isOnCall=n.observable(!1),s.isCallingDisabled=n.observable(!0),s.isVideoCallingDisabled=n.observable(!0),s.canJoinCall=n.observable(!1),s.isJoinCallDisabled=n.computed((function(){return s.isCallingDisabled()||!s.canJoinCall()})),s.isJoinCallWithVideoDisabled=n.computed((function(){return s.isVideoCallingDisabled()||!s.canJoinCall()})),e.selfParticipant.audio.state.changed(p),e.activeModalities.audio.changed(d),e.audioService.start.enabled.changed(f),e.videoService.start.enabled.changed(m),s.dispose=function(){u.dispose(),s.isJoinCallDisabled.dispose(),s.isJoinCallWithVideoDisabled.dispose(),e.selfParticipant.audio.state.changed.off(p),e.activeModalities.audio.changed.off(d),e.audioService.start.enabled.changed.off(f),e.videoService.start.enabled.changed.off(m),t&&(r.clearInterval(t),t=null)}}t.classFunction=a,t.build=function(e){return new a(e)}})),define("ui/viewModels/calling/joinCallButtonViewModel",["require","lodash-compat","utils/common/eventMixin","swx-i18n","swx-cafe-application-instance","ui/telemetry/actions/actionNames","ui/viewModels/calling/helpers/callingFacade","ui/viewModels/chat/conversationActivity","swx-constants","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("utils/common/eventMixin"),i=e("swx-i18n").localization,r=e("swx-cafe-application-instance"),o=e("ui/telemetry/actions/actionNames"),a=e("ui/viewModels/calling/helpers/callingFacade"),s=e("ui/viewModels/chat/conversationActivity"),c=e("swx-constants").COMMON,l=e("swx-service-locator-instance").default
	function u(e){var t,n=this,u=e.conversationModel
	t=s.build(u),n.icon=e.showIcon?e.withVideo?"video":"callStart":"",n.cssClass=e.cssClass,n.tabIndex=e.tabIndex,n.isOnCall=t.isOnCall,n.isJoinCallDisabled=e.withVideo?t.isJoinCallWithVideoDisabled:t.isJoinCallDisabled,n.joinCallTitle=e.withVideo?i.fetch({key:"button_text_joinCallWithVideo"}):i.fetch({key:"button_text_joinCall"}),n.joinCallTextKey=e.withVideo?"button_text_joinCallWithVideo":"button_text_joinCall",n.joinCall=function(){var t,n,i=l.resolve(c.serviceLocator.ACTION_TELEMETRY),s=e.withVideo?o.audioVideo.joinCallWithVideo:o.audioVideo.joinCall
	i.recordAction(s),t=e.withVideo,n=(t=!!t)?"joinCallWithVideoButton":"joinCallButton",r.get().conversationsManager.conversations.add(u),a.placeCall(u,t,n)},n.dispose=function(){t.dispose()}}return t.assign(u.prototype,n),u})),define("text!views/calling/joinCallButton.html",[],(function(){return' <swx-button params="icon: icon,\r\n                        cssClass: cssClass,\r\n                        disabled: isJoinCallDisabled,\r\n                        action: joinCall,\r\n                        withVideo: false,\r\n                        titleKey: joinCallTextKey,\r\n                        textKey: joinCallTextKey,\r\n                        i18nTitle: joinCallTitle,\r\n                        ariaLabelKey: joinCallTextKey"></swx-button>\r\n'})),define("ui/components/calling/joinCallButton",["require","exports","module","vendor/knockout","ui/viewModels/calling/joinCallButtonViewModel","constants/components","text!views/calling/joinCallButton.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/joinCallButtonViewModel")
	t.name=e("constants/components").calling.JOINCALL_BUTTON,t.template=e("text!views/calling/joinCallButton.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e)
	return r.setContext(n.dataFor(t.element)),r}}})),define("ui/viewModels/calling/startCallButtonViewModel",["require","exports","module","lodash-compat","utils/common/eventMixin","vendor/knockout","swx-constants","swx-service-locator-instance","ui/contextMenu/menuItemHelper","ui/contextMenu/items/all","ui/modelHelpers/personHelper"],(function(e,t){var n=e("lodash-compat"),i=e("utils/common/eventMixin"),r=e("vendor/knockout"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default,s=e("ui/contextMenu/menuItemHelper"),c=e("ui/contextMenu/items/all"),l=e("ui/modelHelpers/personHelper")
	function u(e){var t,n=this,i=e.historyOrigin,u=e.telemetryContext
	function d(){t&&t.phoneNumbers.changed.off(f)}function p(){d(),n.callButtonViewModel.isOneToOneConversation()&&(t=n.callButtonViewModel.participantPerson()).phoneNumbers.changed(f)}function f(){n.phoneNumbers(t.phoneNumbers())}n.callButtonViewModel=e.callButtonViewModel,n.phoneNumbers=r.observable([]),n.callButtonViewModel.conversationModel.participants.changed(p),n.getMenuOptions=function(){var e,t=[],r={getPerson:n.callButtonViewModel.participantPerson}
	return a.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.PSTN_ENABLED)&&(l.isPstn(n.callButtonViewModel.participantPerson())||t.push(new c.CallSkypeMenuItem(r,i,u)),(e=s.getCallPhoneContextMenuItems(r,i,u))&&e.length&&Array.prototype.push.apply(t,e)),t},n.hasMenuOptions=function(){return n.callButtonViewModel.isOneToOneConversation()&&!!n.phoneNumbers().length&&n.getMenuOptions().filter((function(e){return e.isEnabled()})).length>1},n.dispose=function(){d(),n.callButtonViewModel.conversationModel.participants.changed.off(p),t=null}}n.assign(u.prototype,i),t.classFunction=u,t.build=function(e){return new u(e)}})),define("text!views/calling/startCallButton.html",[],(function(){return"<swx-button params=\"icon: 'callStart',\r\n                cssClass: 'primary circle',\r\n                disabled: callButtonViewModel.isAudioDisabled,\r\n                textKey: 'button_text_audioCall',\r\n                i18nTitle: callButtonViewModel.buttonCallTitle,\r\n                action: callButtonViewModel.startCallWithAudio,\r\n                ariaLabel: callButtonViewModel.buttonCallAriaLabel\"></swx-button>\r\n"})),define("ui/components/calling/startCallButton",["require","exports","module","vendor/knockout","ui/viewModels/calling/startCallButtonViewModel","constants/components","text!views/calling/startCallButton.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/startCallButtonViewModel")
	t.name=e("constants/components").calling.START_CALL_BUTTON,t.template=e("text!views/calling/startCallButton.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e)
	return r.setContext(n.dataFor(t.element)),r}}})),define("ui/calling/telemetry/cqfActions",["require","exports","module","swx-constants","swx-log-tracer","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n,i=e("swx-constants").COMMON.telemetry.callQualityFeedback,r=e("swx-log-tracer").getLogger(),o=e("experience/settings"),a=e("ui/telemetry/telemetryClient")
	function s(){function e(e){var n={call_id:e.callId,call_mos_score_questionary_id:e.questionaryId,call_mos_score:e.score,call_mos_score_tracking_reason:e.reason,call_mos_score_problem_tokens:t(e)}
	e.nodeId&&(n.node_id=e.nodeId),e.ngcEndpointId&&(n.endpoint_id=e.ngcEndpointId),e.ngcParticipantId&&(n.participant_id=e.ngcParticipantId),r.log("[CQF Telemetry] event",i.MASTER_EVENT,"data",n),a.get().sendEvent(o.telemetry.uiTenantToken,i.MASTER_EVENT,n)}function t(e){var t=i.PROBLEM_TOKEN_PREFIX,n=e.tokensSelected||[],r=e.othersSelected||[]
	return t+=n.concat(r).map((function(e){return e.token})).join("%20"),r.forEach((function(e){e.token&&e.value&&(t+="&"+e.token+"="+encodeURIComponent(e.value).replace(/'/g,escape))})),t}this.submit=function(t){if("number"!=typeof t.score)return this.cancel(t)
	t.reason=i.reason.RANDOM,e(t)},this.cancel=function(t){t.score="",t.reason=i.reason.CANCEL,t.problemTokens=i.PROBLEM_TOKEN_PREFIX,t.tokensSelected=[],t.othersSelected=[],e(t)}}t.get=function(){return n||(n=new s),n}})),define("services/cqf/questionnaire",[],(function(){return[{qid:104},{category:"q",token:101,uri:"skype:?cqg&target=audio.nolocal&ui_entrypoint=cqf",text:"cqf_audio_nolocal"},{category:"q",token:102,uri:"skype:?cqg&target=audio.noremote&ui_entrypoint=cqf",text:"cqf_audio_noremote"},{category:"q",token:103,uri:"skype:?cqg&target=audio.quality.echo&ui_entrypoint=cqf",text:"cqf_audio_quality_echo"},{category:"q",token:104,uri:"skype:?cqg&target=audio.quality.noise&ui_entrypoint=cqf",text:"cqf_audio_quality_noise"},{category:"q",token:105,uri:"skype:?cqg&target=audio.quality.volume&ui_entrypoint=cqf",text:"cqf_audio_quality_volume"},{category:"q",token:106,uri:"skype:?cqg&target=audio.dropped&ui_entrypoint=cqf",text:"cqf_audio_dropped"},{category:"q",token:107,uri:"skype:?cqg&target=audio.quality.distorted&ui_entrypoint=cqf",text:"cqf_audio_quality_distorted"},{category:"q",token:108,uri:"skype:?cqg&target=audio.quality.delay&ui_entrypoint=cqf",text:"cqf_audio_quality_delay"},{category:"pq",token:301,uri:"skype:?cqg&target=audio.quality.dialpad&ui_entrypoint=cqf",text:"cqf_audio_quality_dialpad"},{category:"qe",token:109,uri:"skype:?cqg&target=audio.other&ui_entrypoint=cqf",text:"cqf_audio_other",editlength:100},{category:"vq",token:201,uri:"skype:?cqg&target=video.nolocal&ui_entrypoint=cqf",text:"cqf_video_nolocal"},{category:"vq",token:202,uri:"skype:?cqg&target=video.noremote&ui_entrypoint=cqf",text:"cqf_video_noremote"},{category:"vq",token:203,uri:"skype:?cqg&target=video.quality.poor&ui_entrypoint=cqf",text:"cqf_video_quality_poor"},{category:"vq",token:204,uri:"skype:?cqg&target=video.quality.freezing&ui_entrypoint=cqf",text:"cqf_video_quality_freezing"},{category:"vq",token:205,uri:"skype:?cqg&target=video.dropped&ui_entrypoint=cqf",text:"cqf_video_dropped"},{category:"vq",token:206,uri:"skype:?cqg&target=video.quality.dark&ui_entrypoint=cqf",text:"cqf_video_quality_dark"},{category:"vq",token:207,uri:"skype:?cqg&target=video.quality.sync&ui_entrypoint=cqf",text:"cqf_video_quality_sync"},{category:"vqe",token:208,uri:"skype:?cqg&target=video.other&ui_entrypoint=cqf",text:"cqf_video_other",editlength:100}]})),define("ui/viewModels/calling/cqfViewModel",["require","lodash-compat","swx-constants","ui/calling/telemetry/cqfActions","utils/common/eventMixin","swx-i18n","vendor/knockout","services/cqf/questionnaire","utils/common/scroll","experience/settings","browser/window","utils/common/accessibility"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").CALLING,i=e("ui/calling/telemetry/cqfActions"),r=e("utils/common/eventMixin"),o=e("swx-i18n").localization,a=e("vendor/knockout"),s=e("services/cqf/questionnaire"),c=e("utils/common/scroll"),l=e("experience/settings"),u=e("browser/window"),d=e("utils/common/accessibility").narrator
	function p(){var e,t,r=this
	r.currentStep=a.observable(n.CQF.STEPS.INTRO),r.selectedStar=a.observable(-1),r.canBeSubmitted=a.observable(!1),r.audioQuestions=[],r.videoQuestions=[]
	var p=r.selectedStar.subscribe((function(){r.canBeSubmitted(!0),f()}))
	function f(){t&&(u.clearTimeout(t),t=null)}function m(){-1===r.selectedStar()?r.close():r.submitWithoutTokens()}function h(){r.callData.score=r.selectedStar()}function v(){d.announce(o.fetch({key:"cqf_thanks_title"})),r.currentStep(n.CQF.STEPS.THANKS),u.setTimeout((function(){r.dispatchEvent(n.EVENTS.CQF_SCREEN_CLOSE,r.DIRECTION.PARENT)}),n.CQF.THANKS_TIMEOUT)}r.init=function(i,d){r.isVideoCall=i.callData.isVideo,r.isPSTN=i.callData.isPSTN,r.callData=i.callData,r.questionsTitle=a.computed((function(){return r.isVideoCall?o.fetch({key:"cqf_video_title"}):o.fetch({key:"cqf_audio_title"})})),(e=c.build(d)).init(),s.forEach((function(e){e.checked=a.observable(!1),e.comment=a.observable(),e.qid&&(r.callData.questionaryId=e.qid),function(e){return"q"===e.category||"qe"===e.category}(e)&&r.audioQuestions.push(e),function(e){return"pq"===e.category}(e)&&r.isPSTN&&r.audioQuestions.push(e),function(e){return"vq"===e.category||"vqe"===e.category}(e)&&r.isVideoCall&&r.videoQuestions.push(e)})),t=u.setTimeout(r.close,l.cqf.inactivityTimeout),r.registerEvent(n.EVENTS.CQF_CANCEL,m)},r.close=function(){f(),i.get().cancel(r.callData),r.selectedStar(0),r.dispatchEvent(n.EVENTS.CQF_SCREEN_CLOSE,r.DIRECTION.PARENT)},r.handleStarRating=function(){4===r.selectedStar()?r.submitWithoutTokens():r.currentStep(n.CQF.STEPS.QUESTIONNAIRE)},r.submitWithoutTokens=function(){h(),i.get().submit(r.callData),v()},r.submit=function(){h(),r.callData.tokensSelected=[],r.callData.othersSelected=[],r.audioQuestions.concat(r.videoQuestions).forEach((function(e){e.checked()&&r.callData.tokensSelected.push({token:e.token}),e.comment()&&e.comment().trim().length>0&&r.callData.othersSelected.push({token:e.token,value:e.comment()})})),i.get().submit(r.callData),v()},r.dispose=function(){e.dispose(),p.dispose()}}return t.assign(p.prototype,r),{build:function(){return new p}}})),define("text!views/calling/cqf.html",[],(function(){return'<div class="CallQualityFeedback">\r\n    <div class="CallQualityFeedback-content">\r\n    \t\x3c!-- ko if: currentStep() === \'intro\' --\x3e\r\n    \t<div class="CallQualityFeedback-step1" role="dialog" aria-labelledby="cqf-step1-title">\r\n    \t\t<div>\r\n\t\t\t\t<h1 id="cqf-step1-title" data-bind="l10n: {key: \'cqf_title\'}"></h1>\r\n                <swx-star-rating params="selectedStar: selectedStar"></swx-star-rating>\r\n\r\n\t\t\t\t\x3c!-- ko if: !canBeSubmitted() --\x3e\r\n\t\t\t\t<button class="btn secondary circle stroke" data-bind="click: close, l10n_attr: {\'aria-label\': \'cqf_accessibility_cancel_btn\', \'title\': \'cqf_accessibility_cancel_btn\'}" type="button">\r\n\t\t\t\t\t<span class="iconfont cancel"></span>\r\n\t\t\t\t</button>\r\n\t\t\t\t\x3c!-- /ko --\x3e\r\n\r\n\t\t\t\t\x3c!-- ko if: canBeSubmitted() --\x3e\r\n\t\t\t\t<button class="btn secondary circle stroke" data-bind="click: handleStarRating, l10n_attr: {\'aria-label\': \'cqf_accessibility_submit_btn\', \'title\': \'cqf_accessibility_submit_btn\'}" type="button">\r\n\t\t\t\t\t<span class="iconfont ok"></span>\r\n\t\t\t\t</button>\r\n\t\t\t\t\x3c!-- /ko --\x3e\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\x3c!-- /ko --\x3e\r\n\r\n\t\t\x3c!-- ko if: currentStep() === \'questionnaire\' --\x3e\r\n\t\t<div class="CallQualityFeedback-QuestionsWrapper CallQualityFeedback-step2" data-bind="css: {\'CallQualityFeedback-QuestionWrapper--withVideo\': isVideoCall}" role="dialog" aria-labelledby="cqf-step2-title" tabindex="-1">\r\n\t\t\t <div class="scrollWrapper">\r\n\t\t\t\t<div class="scrollViewport scrollViewportV">\r\n\t\t\t\t\t<h2 id="cqf-step2-title" data-bind="text: questionsTitle" role="heading"></h2>\r\n\r\n\t\t\t\t\t<div class="CallQualityFeedback-Questions">\r\n\t\t\t\t\t\t<div class="CallQualityFeedback-audioQuestions">\r\n\t\t\t\t\t\t\t<h3 data-bind="l10n: {key: \'cqf_audio_tokens_title\'}"></h3>\r\n\t\t\t\t\t\t\t\x3c!-- ko foreach: audioQuestions --\x3e\r\n\t\t\t\t\t\t\t<swx-cqf-question params="question: $data"></swx-cqf-question>\r\n\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t\x3c!-- ko if: isVideoCall --\x3e\r\n\t\t\t\t\t\t<div class="CallQualityFeedback-videoQuestions">\r\n\t\t\t\t\t\t\t<h3 data-bind="l10n: {key: \'cqf_video_tokens_title\'}"></h3>\r\n\t\t\t\t\t\t\t\x3c!-- ko foreach: videoQuestions --\x3e\r\n\t\t\t\t\t\t\t<swx-cqf-question params="question: $data"></swx-cqf-question>\r\n\t\t\t\t\t\t\t\x3c!-- /ko --\x3e\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\x3c!-- /ko --\x3e\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t<div class="CallQualityFeedback-Actions">\r\n\t\t\t\t\t<div class="CallQualityFeedback-ActionsWrapper">\r\n\t\t\t\t\t\t<button class="btn secondary circle stroke" data-bind="click: submitWithoutTokens, l10n_attr: {\'aria-label\': \'cqf_accessibility_cancel_btn\', \'title\': \'cqf_accessibility_cancel_btn\'}" type="button">\r\n\t\t\t\t\t\t\t<span class="iconfont cancel"></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button class="btn secondary circle stroke" data-bind="click: submit, l10n_attr: {\'aria-label\': \'cqf_accessibility_submit_btn\', \'title\': \'cqf_accessibility_submit_btn\'}" type="button">\r\n\t\t\t\t\t\t\t<span class="iconfont ok"></span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\x3c!-- /ko --\x3e\r\n\r\n\t\t\x3c!-- ko if: currentStep() === \'thanks\' --\x3e\r\n    \t<div class="CallQualityFeedback-step3" aria-labelledby="cqf-step3-title">\r\n    \t\t<div>\r\n\t\t\t\t<h1 id="cqf-step3-title" data-bind="l10n: {key: \'cqf_thanks_title\'}"></h1>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t\x3c!-- /ko --\x3e\r\n\r\n\t</div>\r\n</div>\r\n'})),define("ui/components/calling/cqf",["require","exports","module","vendor/knockout","ui/viewModels/calling/cqfViewModel","constants/components","text!views/calling/cqf.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/cqfViewModel")
	t.name=e("constants/components").calling.CQF,t.template=e("text!views/calling/cqf.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(),o=t.element.getElementsByClassName("scrollWrapper")[0]
	return r.setContext(n.dataFor(t.element)),r.init(e,o),r}}})),define("ui/viewModels/calling/cqfStarRatingViewModel",["require","browser/document"],(function(e){var t=e("browser/document")
	function n(e){var n=this,i=t.querySelectorAll(".CallQualityFeedbackStarRating .btn"),r="btn",o="selected",a="favouriteOn",s="favouriteOff"
	function c(){var e=t.querySelector(".CallQualityFeedbackStarRating .selected")
	if(e)return e}function l(e){e.firstElementChild.classList.remove(s),e.firstElementChild.classList.add(a)}function u(e){e.firstElementChild.classList.remove(a),e.firstElementChild.classList.add(s)}function d(e){for(var t=e.previousElementSibling;t&&t.classList.contains(r);)l(t),t=t.previousElementSibling}function p(){var e=c();(function(){var e
	for(e=0;e<i.length;++e)u(i[e])})(),e&&(l(e),d(e))}n.selectedStar=e.selectedStar,n.mouseoverHandler=function(e,t){var n=t.currentTarget
	l(n),d(n)},n.mouseoutHandler=function(){p()},n.clickHandler=function(e,t){var i=t.currentTarget,r=c()
	r&&r.classList.remove(o),n.selectedStar(parseInt(i.getAttribute("data-value"))),i.classList.add(o),p()}}return{build:function(e){return new n(e)}}})),define("text!views/calling/cqfStarRating.html",[],(function(){return'<div class="CallQualityFeedbackStarRating">\r\n    <button class="btn transparent" type="button" data-bind="event: {mouseover: mouseoverHandler, mouseout: mouseoutHandler}, click: clickHandler, attr: {\'aria-selected\': selectedStar() === 0 ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': \'cqf_accessibility_oneStar_ariaLabel\'}, focusHandler: { priority: 1 }" data-value="0">\r\n        <span class="iconfont favouriteOff"></span>\r\n    </button>\r\n    <button class="btn transparent" type="button" data-bind="event: {mouseover: mouseoverHandler, mouseout: mouseoutHandler}, click: clickHandler, attr: {\'aria-selected\': selectedStar() === 1 ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': \'cqf_accessibility_twoStars_ariaLabel\'}" data-value="1">\r\n        <span class="iconfont favouriteOff"></span>\r\n    </button>\r\n    <button class="btn transparent" type="button" data-bind="event: {mouseover: mouseoverHandler, mouseout: mouseoutHandler}, click: clickHandler, attr: {\'aria-selected\': selectedStar() === 2 ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': \'cqf_accessibility_threeStars_ariaLabel\'}" data-value="2">\r\n        <span class="iconfont favouriteOff"></span>\r\n    </button>\r\n    <button class="btn transparent" type="button" data-bind="event: {mouseover: mouseoverHandler, mouseout: mouseoutHandler}, click: clickHandler, attr: {\'aria-selected\': selectedStar() === 3 ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': \'cqf_accessibility_fourStars_ariaLabel\'}" data-value="3">\r\n        <span class="iconfont favouriteOff"></span>\r\n    </button>\r\n    <button class="btn transparent" type="button" data-bind="event: {mouseover: mouseoverHandler, mouseout: mouseoutHandler}, click: clickHandler, attr: {\'aria-selected\': selectedStar() === 4 ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': \'cqf_accessibility_fiveStars_ariaLabel\'}" data-value="4">\r\n        <span class="iconfont favouriteOff"></span>\r\n    </button>\r\n</div>\r\n'}))
	define("ui/components/calling/cqfStarRating",["require","exports","module","ui/viewModels/calling/cqfStarRatingViewModel","constants/components","text!views/calling/cqfStarRating.html"],(function(e,t){var n=e("ui/viewModels/calling/cqfStarRatingViewModel")
	t.name=e("constants/components").calling.CQF_STAR_RATING,t.template=e("text!views/calling/cqfStarRating.html"),t.viewModel={createViewModel:function(e){return n.build(e)}}})),define("ui/viewModels/calling/cqfQuestionViewModel",[],(function(){function e(e){var t=this
	t.text=e.question.text,t.checked=e.question.checked,t.comment=e.question.comment,t.editlength=e.question.editlength,t.isWithTextarea=!!e.question.editlength,t.category=e.question.category,t.isAudio=function(){return"vq"!==t.category&&"vqe"!==t.category},t.clickAction=function(){t.isWithTextarea||t.checked(!t.checked())},t.checkCommentLength=function(){t.comment()&&t.comment().length>t.editlength&&t.comment(t.comment().substring(0,t.editlength))}}return{build:function(t){return new e(t)}}})),define("text!views/calling/cqfQuestion.html",[],(function(){return'<div class="CallQualityFeedbackQuestion" data-bind="click: clickAction, css: {\'CallQualityFeedbackQuestion--withTextarea\': editlength}">\r\n\t<div class="CallQualityFeedbackQuestion-text" data-bind="l10n: {key: text}" aria-hidden="true"></div>\r\n\r\n\t\x3c!-- ko if: !isWithTextarea --\x3e\r\n    <div class="CallQualityFeedbackQuestion-checkbox" role="checkbox" tabindex="0"\r\n         data-bind="hasFocus: $index() === 0 && isAudio(), css: {\'CallQualityFeedbackQuestion-checkbox--checked\': checked()}, attr: {\'aria-checked\': checked() ? \'true\' : \'false\'}, l10n_attr: {\'aria-label\': text}, enterKey: clickAction">\r\n        <div></div>\r\n    </div>\r\n\t\x3c!-- /ko --\x3e\r\n\r\n\t\x3c!-- ko if: isWithTextarea --\x3e\r\n\t<textarea class="CallQualityFeedbackQuestion-textarea"\r\n              data-bind="textInput: comment, valueUpdate: \'afterkeydown\', event: {\'keyup\': checkCommentLength }, attr: {maxlength: editlength}, l10n_attr: {\'aria-label\': text}"></textarea>\r\n\t\x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/calling/cqfQuestion",["require","exports","module","ui/viewModels/calling/cqfQuestionViewModel","constants/components","text!views/calling/cqfQuestion.html"],(function(e,t){var n=e("ui/viewModels/calling/cqfQuestionViewModel")
	t.name=e("constants/components").calling.CQF_QUESTION,t.template=e("text!views/calling/cqfQuestion.html"),t.viewModel={createViewModel:function(e){return n.build(e)}}})),define("ui/viewModels/calling/skypeOutViewModel",["require","exports","module","lodash-compat","swx-constants","browser/dom","utils/common/scroll","utils/common/eventMixin","swx-service-locator-instance"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("browser/dom"),o=e("utils/common/scroll"),a=e("utils/common/eventMixin"),s=e("swx-service-locator-instance").default
	function c(){var e,t,n=this
	n.init=function(a){n.forwardEvent(i.events.skypeOut.DIAL_BUTTON_CLICKED,n.DIRECTION.CHILD),t=r.getElement("#SkypeOutBody-scrollWrapper",a),(e=o.build(t)).init()},n.dispose=function(){e.dispose()},n.isBusinessMode=s.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.USE_BUSINESS_WORDING)}n.assign(c.prototype,a),t.build=function(){return new c}})),define("text!views/calling/skypeOut.html",[],(function(){return'<div class="SkypeOutPage themeWhite" data-swx-testId="skypeOutPage">\r\n    <swx-skype-out-header class="SkypeOutHeader"></swx-skype-out-header>\r\n\r\n    <div class="SkypeOutPage-body" id="SkypeOutBody-scrollWrapper">\r\n        <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n            <div class="SkypeOutBody-scrollContent scrollViewport-inner">\r\n                <div class="SkypeOutPage-content">\r\n                    <swx-dialpad role="list" class="DialPad" data-bind="keyboardNavigation: { itemSelector: \'.DialPad-key\' }" data-swx-testId="skypeOut-dialpad"></swx-dialpad>                    \r\n                    \r\n                    <div class="SkypeOutOffers"  data-bind="if: !isBusinessMode">\r\n                        <swx-credit-balance class="SkypeOutOffer SkypeOutOffer--creditBalance"></swx-credit-balance>\r\n                        <swx-subscription-entitlement class="SkypeOutOffer SkypeOutOffer--subscriptionEntitlement"></swx-subscription-entitlement>\r\n                        <div class="SkypeOutOffer SkypeOutOffer--pstnNotice">\r\n                            <div class="SkypeOutOffer-body">\r\n                                <span class="iconfont callDisabledStatus SkypeOutOffer-icon SkypeOutOffer-icon--callDisabledStatus"></span>\r\n                                <div class="SkypeOutOffer-content">\r\n                                    <p class="SkypeOutOffer-text" data-bind="l10n: { key: \'pstn_emergency_notice_text\' }">Skype for Web (Beta) is not a replacement for your telephone and can\'t be used for emergency calling.</p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/skypeOut",["require","exports","module","vendor/knockout","ui/viewModels/calling/skypeOutViewModel","constants/components","text!views/calling/skypeOut.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/skypeOutViewModel")
	t.name=e("constants/components").calling.SKYPEOUT_PAGE,t.template=e("text!views/calling/skypeOut.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(),o=n.dataFor(t.element)
	return r.setContext(o),r.init(t.element),r}}})),define("ui/viewModels/calling/skypeOut/skypeOutHeaderViewModel",["require","exports","module","lodash-compat","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","swx-cafe-application-instance","ui/viewModels/calling/helpers/callingFacade","swx-constants","swx-constants","swx-enums","utils/common/eventHelper","utils/common/eventMixin","utils/common/localStorage","swx-constants","vendor/knockout","telemetry/calling/pstn/pstn","swx-service-locator-instance","swx-utils-common","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("ui/telemetry/actions/actionNames"),r=e("ui/telemetry/actions/actionSources"),o=e("swx-cafe-application-instance"),a=e("ui/viewModels/calling/helpers/callingFacade"),s=e("swx-constants").COMMON,c=e("swx-constants").PEOPLE,l=e("swx-enums"),u=e("utils/common/eventHelper"),d=e("utils/common/eventMixin"),p=e("utils/common/localStorage"),f=e("swx-constants").KEYS,m=e("vendor/knockout"),h=e("telemetry/calling/pstn/pstn"),v=e("swx-service-locator-instance").default,g=e("swx-utils-common").stringUtils,y=e("swx-constants").COMMON.telemetry.pstn,b=c.contactTypes.PSTN+":",_=/^(\+?[\s\d\-\(\)\.)]*$)/
	function E(){var e,t,n,c,d=this,E=v.resolve(s.serviceLocator.PUBSUB),w=v.resolve(s.serviceLocator.MODEL_UI_OBSERVER).conversationsCallStateObserver,S=null,x=""
	function C(){d.hasFocus(!0)}function T(e){S=e}function I(e){e&&(S=null)}function A(t){t!==x&&(_.test(t)?(x=t,function(t){var n,i
	if(n=t.substr(0,2),"00"===n)return i="+"+t.substr(2),d.skypeOutInput(i),d.hasFocus()?(r=1,e.selectionStart=r,e.selectionEnd=r):T(1),!0
	var r
	return!1}(t)||d.dispatchEvent(s.events.skypeOut.INPUT_CHANGED,d.skypeOutInput(),d.DIRECTION.CHILD)):(d.skypeOutInput(x),I(!0)))}function M(){return null!==S}function O(){M()||C()}d.hasFocus=m.observable(!0),d.skypeOutInput=m.observable(""),d.isCallButtonDisabled=m.computed((function(){return w.activeCalls().length>0||!((e=(e=d.skypeOutInput()).replace(/\D/g,"")).length>=10&&e.length<=15)
	var e})),d.selectedCountry=m.observable(),d.init=function(i){e=i,d.registerEvent(s.events.skypeOut.DIAL_BUTTON_CLICKED,d.insertAtCursor),E.subscribe(s.events.navigation.FRAGMENT_LOADED,C),t=d.skypeOutInput.subscribe(A),n=d.selectedCountry.subscribe(O),c=d.hasFocus.subscribe(I)},d.insertAtCursor=function(t){var n=M()?S:e.selectionStart,i=M()?S:e.selectionEnd,r=d.skypeOutInput(),o=g.inject(r,t.text,n,i)
	T(n+t.text.length),d.skypeOutInput(o)},d.onKeyDown=function(e,t){var n=u.getKeyCode(t)
	return n===f.ESCAPE?(d.skypeOutInput()?(d.resetSkypeOutInput(),C()):d.hasFocus(!1),void t.stopPropagation()):n!==f.ENTER||(d.skypeOutInput()&&!d.isCallButtonDisabled()&&d.callPSTN(),void t.stopPropagation())},d.callPSTN=function(){var e,t,n,c,u,f=d.skypeOutInput().replace(/\s+/g,"")
	function m(){return t.audioService.start.enabled()||t.audioService.start.enabled.reason===l.callingNotSupportedReasons.PluginNotInstalled?(function(e){var n=t.participants(0),i=n.person.phoneNumbers(0)?n.person.phoneNumbers(0).telUri():e
	n.audio.endpoint&&n.audio.endpoint(i)}(f),p.set(s.storageKeys.RECENT_COUNTRY,_stringify(d.selectedCountry())),a.placeCall(t,!1,s.telemetry.historyLoadOrigin.SKYPEOUT_PAGE,!0)):Promise.reject(Error("Audio service disabled: "+t.audioService.start.enabled.reason))}return"+"!==f.charAt(0)?(d.dispatchEvent(s.events.selectBox.TOGGLE,d.DIRECTION.CHILD),Promise.reject()):(f="+"+f.replace(/\D+/g,""),n=v.resolve(s.serviceLocator.ACTION_TELEMETRY),c={source:r.skypeOutPage.skypeOutHeader,phoneNumberType:l.phoneType.Other},n.recordAction(i.audioVideo.pstnCall,c),h.initiatingPSTNCall(y.entryPoint.SKYPE_OUT_PAGE),e=o.get().conversationsManager,v.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.USE_BUSINESS_WORDING)?((u=o.get().personsAndGroupsManager.createPersonSearchQuery()).sources(l.searchScope.All),u.text(f),u.getMore().then((function(){var n=u.results().length?u.results(0).result:void 0
	if(n)return t=e.getConversation(n),m()}))):(t=e.getConversationByUri(b+f),m()))},d.resetSkypeOutInput=function(){d.skypeOutInput("")},d.dispose=function(){E.unsubscribe(s.events.navigation.FRAGMENT_LOADED,C),d.isCallButtonDisabled.dispose(),t.dispose(),n.dispose(),c.dispose()},d.resetSkypeOutInputViaKey=function(e,t){return u.getKeyCode(t)===f.ENTER&&(d.resetSkypeOutInput(),d.hasFocus(!0),t.stopPropagation()),!0}}n.assign(E.prototype,d),t.build=function(){return new E}})),define("text!views/calling/skypeOut/skypeOutHeader.html",[],(function(){return'<div class="SkypeOutHeader-main" data-swx-testId="skypeOut-header">\r\n    <div class="SkypeOutHeader-inner">\r\n        <input type="text" name="skypeOutInput" class="SkypeOutHeader-input" data-bind="hasFocus: hasFocus,\r\n           event: { keydown: onKeyDown },\r\n           l10n_attr: {\'placeholder\': \'input_text_skypeOut_short\'},\r\n           textInput: skypeOutInput" />\r\n        <swx-countrypicker params="selectedCountry: selectedCountry, skypeOutInput: skypeOutInput"></swx-countrypicker>\r\n    </div>\r\n    <div class="SkypeOutHeader-clrBtn">\r\n        <button data-bind="visible: skypeOutInput().length,\r\n            event: { mousedown: resetSkypeOutInput, keypress: resetSkypeOutInputViaKey },\r\n            l10n_attr: { \'aria-label\': \'clear_phonenumber_input_label\', title: \'clear_phonenumber_input_label\' }"\r\n            type="button" class="btn primary circle small transparent">\r\n            <span class="iconfont cross"></span>\r\n        </button>\r\n    </div>\r\n</div>\r\n<div class="SkypeOutHeader-controls">\r\n    <div class="buttonRow">\r\n        <swx-button class="callButtons" params="icon: \'callStart\', cssClass: \'primary circle\', disabled: isCallButtonDisabled, action: callPSTN, titleKey: \'startCall_tooltip\', textKey: \'startCall_tooltip\',\r\n                        ariaLabelKey: \'accessibility_startCall_ariaLabel\'"></swx-button>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/skypeOut/skypeOutHeader",["require","exports","module","browser/dom","vendor/knockout","ui/viewModels/calling/skypeOut/skypeOutHeaderViewModel","constants/components","text!views/calling/skypeOut/skypeOutHeader.html"],(function(e,t){var n=e("browser/dom"),i=e("vendor/knockout"),r=e("ui/viewModels/calling/skypeOut/skypeOutHeaderViewModel")
	t.name=e("constants/components").calling.SKYPEOUT_HEADER,t.template=e("text!views/calling/skypeOut/skypeOutHeader.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=n.getElement(".SkypeOutHeader-input",o),s=r.build(),c=i.dataFor(o)
	return s.setContext(c),s.init(a),s}}})),define("ui/viewModels/calling/skypeOut/skypeOutDialpadViewModel",["require","lodash-compat","swx-constants","utils/common/eventMixin","utils/common/eventHelper","swx-constants"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("utils/common/eventMixin"),r=e("utils/common/eventHelper"),o=e("swx-constants").KEYS
	function a(){var e,t,i=this
	function a(r,o){var a
	return!!e&&(!(!o||!t)&&o-t>600&&(a=e.attributes.getNamedItem("data-secondary")),a||(a=e.attributes.getNamedItem("data-key")),a&&i.dispatchEvent(n.events.skypeOut.DIAL_BUTTON_CLICKED,{text:a.value,inputType:r}),e=null,t=null,!1)}i.onMouseDown=function(n,i){return e=i.currentTarget,t=i.timeStamp,!0},i.onTouchStart=function(n,i){return e=i.currentTarget,t=i.timeStamp,!1},i.onKeyDown=function(n,i){return r.getKeyCode(i)!==o.SPACE||(e||(e=i.currentTarget,t=i.timeStamp),!1)},i.onKeyUp=function(e,t){return a(n.events.skypeOut.INPUT_TYPE_KEYBOARD,t.timeStamp),!0},i.onTouchEnd=function(e,t){a(n.events.skypeOut.INPUT_TYPE_TOUCH,t.timeStamp)},i.onMouseUp=function(e,t){a(n.events.skypeOut.INPUT_TYPE_MOUSE,t.timeStamp)}}return t.assign(a.prototype,i),a})),define("text!views/calling/skypeOut/dialpad.html",[],(function(){return'<div class="DialPad-row">\r\n    <div role="listitem" class="DialPad-key" data-key="1" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd,  mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">1</div>\r\n        <div class="title"></div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="2" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">2</div>\r\n        <div class="title">ABC</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="3" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">3</div>\r\n        <div class="title">DEF</div>\r\n    </div>\r\n</div>\r\n<div class="DialPad-row">\r\n    <div role="listitem" class="DialPad-key" data-key="4" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">4</div>\r\n        <div class="title">GHI</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="5" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">5</div>\r\n        <div class="title">JKL</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="6" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">6</div>\r\n        <div class="title">MNO</div>\r\n    </div>\r\n</div>\r\n<div class="DialPad-row">\r\n    <div role="listitem" class="DialPad-key" data-key="7" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">7</div>\r\n        <div class="title">PQRS</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="8" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">8</div>\r\n        <div class="title">TUV</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="9" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">9</div>\r\n        <div class="title">WXYZ</div>\r\n    </div>\r\n\r\n</div>\r\n<div class="DialPad-row">\r\n    <div role="listitem" class="DialPad-key" data-key="*" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd, touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">*</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="0" data-secondary="+" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchcancel: onTouchEnd, touchend: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">0</div>\r\n        <div class="title">+</div>\r\n    </div>\r\n    <div role="listitem" class="DialPad-key" data-key="#" data-bind="event: {mousedown: onMouseDown, touchstart: onTouchStart, touchend: onTouchEnd,touchcancel: onTouchEnd, mouseup: onMouseUp, keyup: onKeyUp, keydown: onKeyDown }, enterKey: onMouseDown" tabindex="0">\r\n        <div class="icon">#</div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/calling/skypeOut/dialpad",["require","exports","module","vendor/knockout","ui/viewModels/calling/skypeOut/skypeOutDialpadViewModel","constants/components","text!views/calling/skypeOut/dialpad.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/calling/skypeOut/skypeOutDialpadViewModel")
	t.name=e("constants/components").calling.SKYPEOUT_DIALPAD,t.template=e("text!views/calling/skypeOut/dialpad.html"),t.viewModel={createViewModel:function(e,t){var r=n.dataFor(t.element),o=new i
	return o.setContext(r),o}}})),define("ui/viewModels/calling/skypeOut/countryPickerViewModel",["require","exports","module","lodash-compat","swx-constants","utils/common/eventMixin","vendor/knockout","swx-i18n","utils/common/localStorage","swx-service-locator-instance","experience/settings","swx-utils-common","browser/window"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("utils/common/eventMixin"),o=e("vendor/knockout"),a=e("swx-i18n").localization,s=e("utils/common/localStorage"),c=e("swx-service-locator-instance").default,l=e("experience/settings"),u=e("swx-utils-common").stringUtils,d=e("browser/window")
	function p(e){var t,n,r,p,f=this,m=!1,h=c.resolve(i.serviceLocator.PUBSUB),v={value:"",name:a.fetch({key:"splashScreen_text_loading"}),description:""}
	if(g(e.skypeOutInput)||g(e.selectedCountry))throw new Error("[CountryPicker] Passing incorrect parameter, expecting ko.obervables.")
	function g(e){return!o.isObservable(e)}function y(e){var t=b(e.substring(0,6))
	t!==n&&(n=t,f.selectedCountry(n))}function b(e){return 0===e.length?null:e in f.countriesMap?f.countriesMap[e]:b(e.substring(0,e.length-1))}function _(e){var t
	t=e?e.value:"",e!==n&&(n?r(r().replace(n.value,t)):""!==t&&r(t+" "+r())),n=e}function E(e){var t,n,i,r,o=JSON.parse(e).destinations,a=[]
	for(r=0;r<o.length;r++)t=o[r],n="+"+t.countryPrefix,!t.countryPrefix||a.length>0&&a[a.length-1].value===n||(i={value:n,name:t.name,description:u.forceLTREmbedding(n)},f.countriesMap[n]=i,a.push(i))
	a.sort((function(e,t){return e.name.localeCompare(t.name,l.initParams.locale)})),f.countries(a),p&&function(e){var t
	for(t=0;t<e.length;t++)if(e[t].name===p.name&&e[t].value===p.value&&e[t].description===p.description)return f.selectedCountry(e[t]),void(p=e[t])
	f.selectedCountry(null)}(a)}function w(){var e=new XMLHttpRequest,t="?language="+l.initParams.locale+"&currency=USD&expand=country-prefix&host="+d.location.hostname+"&client="+l.version
	e.addEventListener("readystatechange",(function(){4===this.readyState&&(200===this.status?E(this.responseText):m||(m=!0,w()))})),e.open("GET",l.assetsServiceHost+t),e.send()}function S(){p&&""===r()&&f.selectedCountry(p)}f.countriesMap={},f.countries=o.observableArray(),f.selectedCountry=e.selectedCountry,r=e.skypeOutInput,f.init=function(){p=JSON.parse(s.get(i.storageKeys.RECENT_COUNTRY)),w(),f.registerEvent(i.events.skypeOut.INPUT_CHANGED,y),f.forwardEvent(i.events.selectBox.TOGGLE,f.DIRECTION.CHILD),t=f.selectedCountry.subscribe(_),p?(f.countries().push(p),f.selectedCountry(p)):f.countries().push(v),h.subscribe(i.events.navigation.FRAGMENT_LOADED,S)},f.dispose=function(){t.dispose(),h.unsubscribe(i.events.navigation.FRAGMENT_LOADED,S)}}n.assign(p.prototype,r),t.build=function(e){return new p(e)}})),define("text!views/calling/skypeOut/countryPicker.html",[],(function(){return'<div class="SkypeOutHeader-countryPicker" data-swx-testId="skypeOut-countryPicker">\r\n    <swx-select-box class="SelectBox" params="selectOptions: countries, selectedOption: selectedCountry, placeholderKey: \'select_placeholder_skypeOut\'"></swx-select-box>\r\n</div>\r\n'})),define("ui/components/calling/skypeOut/countryPicker",["require","exports","module","ui/viewModels/calling/skypeOut/countryPickerViewModel","vendor/knockout","constants/components","text!views/calling/skypeOut/countryPicker.html"],(function(e,t){var n=e("ui/viewModels/calling/skypeOut/countryPickerViewModel"),i=e("vendor/knockout")
	t.name=e("constants/components").calling.SKYPEOUT_COUNTRY_PICKER,t.template=e("text!views/calling/skypeOut/countryPicker.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e),o=t.element,a=i.dataFor(o)
	return r.setContext(a),r.init(),r}}})),define("ui/viewModels/calling/screenSharingPreviewViewModel",["require","lodash-compat","swx-utils-common","swx-constants","swx-constants","utils/common/eventMixin","swx-i18n","vendor/knockout","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("swx-constants").CALLING,r=e("swx-constants").COMMON,o=e("utils/common/eventMixin"),a=e("swx-i18n").localization,s=e("vendor/knockout"),c=e("ui/telemetry/actions/actionNames"),l=e("swx-service-locator-instance").default
	function u(e){var t=this
	t.DIALOG_NAME=i.CALL_SCREEN_DIALOG.NAME.SCREEN_SHARING_PREVIEW,t.cancelButtonHasFocus=s.observable(!1),t.previewImage=s.observable(null),t.cancelTitle=a.fetch({key:"action_button_cancel"}),t.shareScreenTitle=a.fetch({key:"callscreen_text_shareScreen"}),t.closePreview=function(){t.dispatchEvent(r.events.callScreen.TOGGLE_MODAL_DIALOG,t.DIALOG_NAME,t.DIRECTION.PARENT)},t.shareScreen=function(){e.screenSharingService.start(),t.closePreview(),l.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(c.audioVideo.shareScreen)},t.init=function(){t.forwardEvent(r.events.callScreen.TOGGLE_MODAL_DIALOG,t.DIRECTION.PARENT),e.screenSharingService.shareableResources.get(0).then((function(e){e._getPreviewImage(400).then((function(e){var n=new Image
	n.onload=function(){t.previewImage(n.src)},n.onerror=t.closePreview,n.src="data:image/png;base64,"+e.data,t.cancelButtonHasFocus(!0)}),t.closePreview)}),t.closePreview)}}return t.assign(u,n),t.assign(u.prototype,o),u})),define("text!views/calling/screenSharingPreview.html",[],(function(){return'\x3c!-- ko if: previewImage() --\x3e\r\n<swx-call-screen-modal params="name: DIALOG_NAME">\r\n    <img class="ssPreviewImage" data-bind="attr: { src: previewImage() }">\r\n    <div class="actions">\r\n        <swx-button params="cssClass: \'secondary circle\', textKey: \'action_button_cancel\', i18nTitle: cancelTitle, action: closePreview, hasFocus: cancelButtonHasFocus"></swx-button>\r\n        <swx-button params="cssClass: \'primary circle\', textKey: \'callscreen_text_shareScreen\', i18nTitle: shareScreenTitle, action: shareScreen"></swx-button>\r\n    </div>\r\n</swx-call-screen-modal>\r\n\x3c!-- /ko --\x3e'})),define("ui/components/calling/screenSharingPreview",["require","exports","module","ui/viewModels/calling/screenSharingPreviewViewModel","vendor/knockout","constants/components","text!views/calling/screenSharingPreview.html"],(function(e,t){var n=e("ui/viewModels/calling/screenSharingPreviewViewModel"),i=e("vendor/knockout")
	t.name=e("constants/components").calling.SCREEN_SHARING_PREVIEW,t.template=e("text!views/calling/screenSharingPreview.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e.conversation,t.element)
	return r.setContext(i.dataFor(t.element)),r.init(),r}}})),define("ui/viewModels/calling/unansweredCallViewModel",["require","lodash-compat","ui/viewModels/calling/helpers/callingFacade","swx-constants","swx-constants","ui/viewModels/people/contactBuilder","ui/contextMenu/contextMenu","ui/viewModels/chat/conversationTopic","browser/dom","swx-enums","utils/common/eventMixin","swx-focus-handler","swx-i18n","vendor/knockout","swx-log-tracer","ui/contextMenu/menuItemHelper","ui/contextMenu/items/all","swx-service-locator-instance","experience/settings","ui/telemetry/telemetryClient"],(function(e){var t=e("lodash-compat"),n=e("ui/viewModels/calling/helpers/callingFacade"),i=e("swx-constants").CALLING,r=e("swx-constants").COMMON,o=e("ui/viewModels/people/contactBuilder"),a=e("ui/contextMenu/contextMenu"),s=e("ui/viewModels/chat/conversationTopic"),c=e("browser/dom"),l=e("swx-enums"),u=e("utils/common/eventMixin"),d=e("swx-focus-handler"),p=e("swx-i18n").localization,f=e("vendor/knockout"),m=e("swx-log-tracer").getLogger(),h=e("ui/contextMenu/menuItemHelper"),v=e("ui/contextMenu/items/all"),g=e("swx-service-locator-instance").default,y=e("experience/settings"),b=e("ui/telemetry/telemetryClient")
	function _(e,u){var _,E=this,w=e.payload,S=w.reason,x=w.wasVideoCall,C=w.ecsConfig,T=!1,I=s.build(w.conversation)
	function A(){return!E.isGroupConversation&&g.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.PSTN_ENABLED)}function M(e){var n=function(){var e,n=w.conversation.participants(0).person,a=o.build(n),s=[]
	function c(){k(i.UNANSWERED_CALL_ACTIONS.RETRY,i.UNANSWERED_CALL_RETRY_ACTIONS.SKYPE),E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,null,E.DIRECTION.PARENT)}function l(){k(i.UNANSWERED_CALL_ACTIONS.RETRY,i.UNANSWERED_CALL_RETRY_ACTIONS.PSTN),E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,null,E.DIRECTION.PARENT)}function u(){k(i.UNANSWERED_CALL_ACTIONS.RETRY,i.UNANSWERED_CALL_RETRY_ACTIONS.DIAL_PAD),E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,null,E.DIRECTION.PARENT)}e=x()?new v.VideoCallMenuItem(a,r.telemetry.historyLoadOrigin.UNANSWERED_CALL_UI):new v.CallSkypeMenuItem(a,r.telemetry.historyLoadOrigin.UNANSWERED_CALL_UI)
	s.push(new v.UnansweredCallWrapMenuItem(e,e.label,c))
	var d=h.getCallPhoneContextMenuItems(a)
	d&&d.length&&t.forEach(d,(function(e){s.push(new v.UnansweredCallWrapMenuItem(e,e.label,l))}))
	return s.push(new v.GoToDialPadMenuItem(u)),s}()
	e.customClientOptions={offsetElement:e.target,position:l.contextMenuPosition.Top,offset:5},a.show(n,e)}function O(){E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,{prefillTextarea:!1,focusTextarea:!0},E.DIRECTION.PARENT)}function k(e,t){if(!T){var n={Action:e,Leave_Reason:S()}
	t&&(n.Retry_Action=t),m.log("[Unanswered Call UI Telemetry] event",r.telemetry.unansweredCallUI.MASTER_EVENT,"data",n),b.get().sendEvent(y.telemetry.uiTenantToken,r.telemetry.unansweredCallUI.MASTER_EVENT,n),T=!0}}E.avatar=w.conversation.avatarUrl(),E.isGroupConversation=w.conversation.isGroupConversation(),E.topic=I.topic,E.title=f.pureComputed((function(){return S()===i.UNANSWERED_CALL_REASONS.BUSY?p.fetch({key:"unanswered_call_title_busy"}):S()===i.UNANSWERED_CALL_REASONS.MISSED?p.fetch({key:"unanswered_call_title_noanswer"}):p.fetch({key:"unanswered_call_title_unavailable"})})),E.titleDescription=f.pureComputed((function(){return S()===i.UNANSWERED_CALL_REASONS.BUSY?p.fetch({key:"unanswered_call_accessibility_title_busy"}):S()===i.UNANSWERED_CALL_REASONS.MISSED?p.fetch({key:"unanswered_call_accessibility_title_noanswer"}):p.fetch({key:"unanswered_call_accessibility_title_unavailable"})})),E.isButtonGreen=(_=C())?{chatButton:_.UnansweredCallUIChatButton_Green,retryButton:_.UnansweredCallUIRetryButton_Green}:y.unansweredUI.defaultGreenButtons,E.sendMessage=function(){var e={prefillTextarea:!E.isGroupConversation,focusTextarea:!0}
	k(i.UNANSWERED_CALL_ACTIONS.CHAT),E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,e,E.DIRECTION.PARENT)},E.retryCall=function(e){A()?M(e):(k(i.UNANSWERED_CALL_ACTIONS.RETRY,i.UNANSWERED_CALL_RETRY_ACTIONS.SKYPE),E.dispatchEvent(i.EVENTS.UNANSWERED_CALL_CLOSE,null,E.DIRECTION.PARENT),n.placeCall(w.conversation,x()))},E.goToChat=function(){k(i.UNANSWERED_CALL_ACTIONS.OTHER_DISMISS),O()},E.cancel=function(){k(i.UNANSWERED_CALL_ACTIONS.CANCEL),O()},setTimeout((function(){u.restrict()
	var e=c.getElement(".swx .UnansweredCall .UnansweredCall-greenButton .btn")
	e||(e=c.getElement(".swx .UnansweredCall .UnansweredCall-chatButton .btn"))
	e&&d.get().addFocusRequestToQueue(e,d.Priorities.Immediate)}),0),E.dispose=function(){u.restore(),I.dispose(),k(i.UNANSWERED_CALL_ACTIONS.OTHER_DISMISS)}}return t.assign(_.prototype,u),{build:function(e,t){return new _(e,t)}}})),define("text!views/calling/unansweredCall.html",[],(function(){return"<div class=\"UnansweredCall\" role=\"dialog\" data-bind=\"attr: {'aria-label': titleDescription}\" tabindex=\"-1\">\r\n\r\n    <div class=\"UnansweredCall-topContainer\">\r\n        <div class=\"UnansweredCall-titleBar\">\r\n            <span class=\"UnansweredCall-topic\" data-bind=\"text: topic\"></span>\r\n            <swx-button class=\"UnansweredCall-titleBarButton UnansweredCall-goToChatButton\"\r\n                        params=\"icon: 'message',\r\n                                cssClass: 'circle',\r\n                                action: goToChat,\r\n                                titleKey: 'unanswered_call_button_showchat', textKey: 'unanswered_call_button_showchat',\r\n                                ariaLabelKey: 'unanswered_call_accessibility_button_showchat'\">\r\n            </swx-button>\r\n        </div>\r\n\r\n        <swx-button class=\"UnansweredCall-closeButton\"\r\n                    params=\"icon: 'cross',\r\n                            cssClass: 'circle',\r\n                            action: cancel,\r\n                            titleKey: 'unanswered_call_button_close', textKey: 'unanswered_call_button_close',\r\n                            ariaLabelKey: 'unanswered_call_accessibility_button_close'\">\r\n        </swx-button>\r\n    </div>\r\n\r\n    <div class=\"UnansweredCall-middleContainer\">\r\n        <div class=\"UnansweredCall-avatarReasonContainer\">\r\n        \t<swx-avatar class=\"UnansweredCall-avatar\" params=\"avatar: avatar, isGroupAvatar: isGroupConversation, displayName: topic, isPstn: false, size: 195\"></swx-avatar>\r\n\r\n        \t<p class=\"UnansweredCall-reason fontSize-h2\" data-bind=\"text: title\"></p>\r\n        </div>\r\n\r\n    \t<div class=\"UnansweredCall-buttons\">\r\n    \t\t<div class=\"UnansweredCall-buttonContainer\">\r\n    \t\t    <swx-button class=\"UnansweredCall-button UnansweredCall-chatButton\"\r\n                            data-bind=\"css: { 'UnansweredCall-greenButton': isButtonGreen['chatButton'],\r\n                                              'UnansweredCall-nonGreenButton': !isButtonGreen['chatButton'] }\"\r\n    \t\t    \t\t\tparams=\"icon: 'message',\r\n    \t\t    \t\t\t\t\tcssClass: isButtonGreen['chatButton'] ? 'circle' : 'secondary circle stroke',\r\n    \t\t    \t\t\t\t\taction: sendMessage,\r\n    \t\t    \t\t\t\t\ttitleKey: 'unanswered_call_button_chat', textKey: 'unanswered_call_button_chat',\r\n    \t\t                        ariaLabelKey: 'unanswered_call_accessibility_button_chat'\">\r\n    \t\t\t</swx-button>\r\n    \t\t\t<p class=\"UnansweredCall-buttonLabel\" data-bind=\"l10n: {'key': 'unanswered_call_button_chat'}\"></p>\r\n    \t\t</div>\r\n\r\n    \t\t<div class=\"UnansweredCall-buttonContainer\">\r\n    \t\t    <swx-button class=\"UnansweredCall-button UnansweredCall-retryButton\"\r\n                            data-bind=\"css: { 'UnansweredCall-greenButton': isButtonGreen['retryButton'],\r\n                                              'UnansweredCall-nonGreenButton': !isButtonGreen['retryButton'] }\"\r\n    \t\t    \t\t\tparams=\"icon: 'reload',\r\n    \t\t    \t\t\t\t\tcssClass: isButtonGreen['retryButton'] ? 'circle' : 'secondary circle stroke',\r\n    \t\t    \t\t\t\t\taction: retryCall,\r\n    \t\t    \t\t\t\t\ttitleKey: 'unanswered_call_button_retry', textKey: 'unanswered_call_button_retry',\r\n    \t\t                        ariaLabelKey: 'unanswered_call_accessibility_button_retry'\">\r\n    \t\t\t</swx-button>\r\n    \t\t\t<p class=\"UnansweredCall-buttonLabel\" data-bind=\"l10n: {'key': 'unanswered_call_button_retry'}\"></p>\r\n    \t\t</div>\r\n    \t</div>\r\n    </div>\r\n\r\n</div>\r\n"})),define("ui/components/calling/unansweredCall",["require","exports","module","utils/common/focusRestrictor","vendor/knockout","ui/viewModels/calling/unansweredCallViewModel","constants/components","text!views/calling/unansweredCall.html"],(function(e,t){var n=e("utils/common/focusRestrictor"),i=e("vendor/knockout"),r=e("ui/viewModels/calling/unansweredCallViewModel")
	t.name=e("constants/components").calling.UNANSWERED_CALL,t.template=e("text!views/calling/unansweredCall.html"),t.viewModel={createViewModel:function(e,t){var o=n.build(t.element,[".Me",".toasts",".footer",".notifications","swx-sidebar"]),a=r.build(e,o)
	return a.setContext(i.dataFor(t.element)),a}}})),define("ui/viewModels/calling/callScreenModalViewModel",["require","lodash-compat","swx-utils-common","swx-constants","swx-constants","utils/common/eventMixin","utils/common/focusRestrictor","utils/common/outsideClickHandler"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("swx-constants").COMMON,r=e("swx-constants").CALLING,o=e("utils/common/eventMixin"),a=e("utils/common/focusRestrictor"),s=e("utils/common/outsideClickHandler"),c="call-screen-modal-content"
	function l(e,t){var n=this,o=a.build(t,r.CALL_SCREEN_DIALOG.ALLOWED_FOCUS_SELECTORS)
	return n.close=function(){n.dispatchEvent(i.events.callScreen.TOGGLE_MODAL_DIALOG,e,n.DIRECTION.PARENT)},n.init=function(){s.add(c,n.close),o.restrict()},n.dispose=function(){s.remove(c),o.restore()},n}return t.assign(l,n),t.assign(l.prototype,o),l})),define("text!views/calling/callScreenModal.html",[],(function(){return'<div class="call-screen-modal-content">\x3c!-- ko template: { nodes: $componentTemplateNodes, data: $parent } --\x3e\x3c!-- /ko --\x3e</div>'})),define("ui/components/calling/callScreenModal",["require","exports","module","ui/viewModels/calling/callScreenModalViewModel","vendor/knockout","constants/components","text!views/calling/callScreenModal.html"],(function(e,t){var n=e("ui/viewModels/calling/callScreenModalViewModel"),i=e("vendor/knockout")
	t.name=e("constants/components").calling.CALL_SCREEN_MODAL,t.template=e("text!views/calling/callScreenModal.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e.name,t.element)
	return r.setContext(i.dataFor(t.element)),r.init(),r}}})),define("ui/viewModels/calling/addParticipantsViewModel",["require","lodash-compat","swx-utils-common","swx-constants","swx-constants","swx-utils-chat","utils/common/eventMixin","swx-i18n","vendor/knockout","ui/telemetry/actions/actionNames","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("swx-constants").CALLING,r=e("swx-constants").COMMON,o=e("swx-utils-chat").conversation,a=e("utils/common/eventMixin"),s=e("swx-i18n").localization,c=e("vendor/knockout"),l=e("ui/telemetry/actions/actionNames"),u=e("swx-service-locator-instance").default
	function d(e,n){var a,d=this
	function p(e){d.closeAddParticipantsDialog(),n.audioService.transfer(e.id())}d.DIALOG_NAME=e,d.conversation=n,d.addParticipantsTitle=s.fetch({key:"button_text_addParticipants"}),d.cancelAddParticipantsTitle=s.fetch({key:"button_text_cancelAddParticipants"}),d.selectedParticipantsCount=c.observable(0),d.setParticipantProvider=function(e){(a=e).selectedContacts.subscribe((function(){a&&d.DIALOG_NAME===i.CALL_SCREEN_DIALOG.NAME.ADD_PARTICIPANTS&&d.selectedParticipantsCount(a.selectedContacts().length)}))},d.submitSelectedParticipants=function(){var e,t,i,s=a.selectedContacts
	s().length>0&&(e=n.isGroupConversation(),t=u.resolve(r.serviceLocator.ACTION_TELEMETRY),i=e?l.audioVideo.submitParticipantsInGroup:l.audioVideo.submitParticipantsIn1to1,t.recordAction(i),o.addPersonsToConversation(s(),n)),d.closeAddParticipantsDialog()},d.closeAddParticipantsDialog=function(){d.dispatchEvent(r.events.callScreen.TOGGLE_MODAL_DIALOG,d.DIALOG_NAME,d.DIRECTION.PARENT)},d.init=function(){if(e===i.CALL_SCREEN_DIALOG.NAME.TRANSFER_CALL){var n=t.once(p)
	d.registerEvent(r.events.roster.PICKER_CONTACT_SELECTED,n)}d.forwardEvent(r.events.callScreen.TOGGLE_MODAL_DIALOG,d.DIRECTION.PARENT),d.forwardEvent(r.events.roster.ROSTER_QUERY_CHANGED,d.DIRECTION.CHILD),d.forwardEvent(r.events.roster.ROSTER_QUERY_EXECUTED,d.DIRECTION.CHILD),d.forwardEvent(r.events.roster.ROSTER_SELECTION_REMOVED,d.DIRECTION.CHILD),d.forwardEvent(r.events.roster.PICKER_CONTACT_SELECTED,d.DIRECTION.CHILD),d.forwardEvent(r.events.roster.PICKER_CONTACT_DESELECTED,d.DIRECTION.CHILD)},d.dispose=function(){a=null}}return t.assign(d,n),t.assign(d.prototype,a),d})),define("text!views/calling/addParticipants.html",[],(function(){return'<swx-call-screen-modal params="name: DIALOG_NAME">\r\n    <div class="headerAdd">\r\n        <swx-contact-picker-input params="setParticipantProvider: setParticipantProvider"></swx-contact-picker-input>\r\n    </div>\r\n    <swx-contact-picker params="conversation: conversation, className: \'addToCallPicker\'"></swx-contact-picker>\r\n    <div class="actions">\r\n        <swx-button params="cssClass: \'secondary circle\', textKey: \'button_text_cancelAddParticipants\', i18nTitle: cancelAddParticipantsTitle, action: closeAddParticipantsDialog"></swx-button>\r\n        \x3c!-- ko if: selectedParticipantsCount() > 0 --\x3e\r\n            <swx-button params="cssClass: \'primary circle\', textKey: \'button_text_addParticipants\', i18nTitle: addParticipantsTitle, action: submitSelectedParticipants"></swx-button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</swx-call-screen-modal>'})),define("ui/components/calling/addParticipants",["require","exports","module","ui/viewModels/calling/addParticipantsViewModel","vendor/knockout","constants/components","text!views/calling/addParticipants.html"],(function(e,t){var n=e("ui/viewModels/calling/addParticipantsViewModel"),i=e("vendor/knockout")
	t.name=e("constants/components").calling.ADD_PARTICIPANTS,t.template=e("text!views/calling/addParticipants.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e.dialogName,e.conversation,t.element)
	return r.setContext(i.dataFor(t.element)),r.init(),r}}})),define("ui/components/calling/index",["require","ui/components/calling/callScreen","ui/components/calling/participantMenu","ui/components/calling/roster","ui/components/calling/callAnimation","ui/components/calling/endCall","ui/components/calling/callScreenContent","ui/components/calling/callScreenHeader","ui/components/calling/callScreenFooter","ui/components/calling/joinCallButton","ui/components/calling/startCallButton","ui/components/calling/cqf","ui/components/calling/cqfStarRating","ui/components/calling/cqfQuestion","ui/components/calling/skypeOut","ui/components/calling/skypeOut/skypeOutHeader","ui/components/calling/skypeOut/dialpad","ui/components/calling/skypeOut/countryPicker","ui/components/calling/screenSharingPreview","ui/components/calling/unansweredCall","ui/components/calling/callScreenModal","ui/components/calling/addParticipants"],(function(e){return[e("ui/components/calling/callScreen"),e("ui/components/calling/participantMenu"),e("ui/components/calling/roster"),e("ui/components/calling/callAnimation"),e("ui/components/calling/endCall"),e("ui/components/calling/callScreenContent"),e("ui/components/calling/callScreenHeader"),e("ui/components/calling/callScreenFooter"),e("ui/components/calling/joinCallButton"),e("ui/components/calling/startCallButton"),e("ui/components/calling/cqf"),e("ui/components/calling/cqfStarRating"),e("ui/components/calling/cqfQuestion"),e("ui/components/calling/skypeOut"),e("ui/components/calling/skypeOut/skypeOutHeader"),e("ui/components/calling/skypeOut/dialpad"),e("ui/components/calling/skypeOut/countryPicker"),e("ui/components/calling/screenSharingPreview"),e("ui/components/calling/unansweredCall"),e("ui/components/calling/callScreenModal"),e("ui/components/calling/addParticipants")]})),define("experience/components/calling",["require","exports","module","services/telemetry/common/telemetry","services/telemetry/common/instrumentation","services/telemetry/calling.instrumentation.eventTypes","swx-constants","swx-constants","swx-service-locator-instance","ui/controls/calling/endCallControl","ui/controls/calling/micControl","ui/components/calling/index","ui/components/registrar"],(function(e,t){var n=e("services/telemetry/common/telemetry"),i=e("services/telemetry/common/instrumentation"),r=e("services/telemetry/calling.instrumentation.eventTypes"),o=e("swx-constants").COMMON,a=e("swx-constants").CALLING,s=e("swx-service-locator-instance").default,c=e("ui/controls/calling/endCallControl"),l=e("ui/controls/calling/micControl"),u=e("ui/components/calling/index"),d=e("ui/components/registrar")
	t.init=function(e){var t,p=s.resolve(o.serviceLocator.FEATURE_FLAGS),f=s.resolve(o.serviceLocator.CONTROLS_BUILDER)
	f.register(c),f.register(l),d.register(u),p.isFeatureOn(a.FEATURE_FLAGS.CALLING)&&(t=i.create(r),n.instrumentAllEvents(t)),e()}}))
	define("ui/players/mediaPlayerController",["require","swx-constants","lodash-compat","browser/document","swx-pubsub-instance","swx-service-locator-instance","swx-cafe-application-instance","browser/window"],(function(e){var t=e("swx-constants").COMMON,n=e("lodash-compat"),i=e("browser/document"),r=e("swx-pubsub-instance").default,o=e("swx-service-locator-instance").default,a=e("swx-cafe-application-instance"),s=e("browser/window")
	return new function(){var e,c,l,u=this,d=[],p={},f=function(){}
	function m(e){if(e)return n.find(d,(function(t){return t.id===e}))}function h(e){if(!e){var t=v()
	t&&t.pause()}}function v(){return n.find(d,(function(e){return e.isPlaying()||e.isQueuedForPlaying()}))}function g(t){if(!(t.target&&(t.target.id&&"yt_msg_"===t.target.id.substring(0,7)||t.target.activeElement&&t.target.activeElement.id&&"yt_msg_"===t.target.activeElement.id.substring(0,7)))){var n=!!(i.fullscreenElement||i.mozFullScreenElement||i.webkitFullscreenElement),r=m(e)
	r&&r.isInFullscreen(n),n||u.onLeavingFullscreen()}}u.pauseAllInConversation=function(e){var i,r
	r=e,i=n.filter(d,(function(e){return e.conversationId===r})),n.forEach(i,(function(e){e.pause(),e.type===t.chat.messageType.VIDEO&&e.mute(!0)}))},u.registerPlayer=function(e){var t={id:e.id,conversationId:e.conversationId,isInFullscreen:e.isInFullscreen||f,pause:e.pause,play:e.play,mute:e.mute||f,type:e.mediaType,isPlaying:e.isPlaying,autoplay:e.autoplay,isQueuedForPlaying:e.isQueuedForPlaying,triggeredByUser:e.triggeredByUser||function(){return!0}}
	p[e.conversationId]=!0,d.push(t)},u.removePlayer=function(e){var t=m(e)
	d.splice(d.indexOf(t),1)
	var n=d.filter((function(e){return e.conversationId===t.conversationId}))
	p[t.conversationId]=n.length>0},u.onEnteringFullscreen=function(n){r.publish(t.events.videoPlayer.FULLSCREEN_ON),e=n},u.onLeavingFullscreen=function(){e&&(r.publish(t.events.videoPlayer.FULLSCREEN_OFF,e),e=null)},u.onVisibleViewPortChanged=function(e,i){if(function(){if(n.isUndefined(l)){var e=o.resolve(t.serviceLocator.FEATURE_FLAGS);(l=e.isFeatureOn(t.featureFlags.VIDEO_AUTOPLAY_SETTINGS_ENABLED))&&a.get().personsAndGroupsManager.mePerson.preferences(t.userSettings.preferences.VIDEO_AUTOPLAY).value.get().then(h)}return l&&a.get().personsAndGroupsManager.mePerson.preferences(t.userSettings.preferences.VIDEO_AUTOPLAY).value()}()){var r,s=v()
	if((!s||s.conversationId===e&&!s.triggeredByUser())&&p.hasOwnProperty(e)){i.sort((function(e,t){return e-t}))
	for(var c=i.length-1;c>=0;c--){var u=m(i[c])
	if(u&&u.type===t.chat.messageType.VIDEO&&u.autoplay){r=u
	break}}r&&r===s||(s&&s.pause(),r&&(r.mute(!0),r.play()))}}},i.addEventListener("webkitfullscreenchange",g),i.addEventListener("mozfullscreenchange",g),i.addEventListener("MSFullscreenChange",g),i.addEventListener("fullscreenchange",g),s.addEventListener(t.events.browser.BLUR,(function(){var e=v()
	e&&!e.triggeredByUser()&&(e.pause(),c=e)})),s.addEventListener(t.events.browser.FOCUS,(function(){c&&(c.play(),c=null)}))}})),define("ui/viewModels/chat/chatLog",["require","lodash-compat","browser/document","vendor/knockout","utils/common/ko","swx-utils-common","utils/common/cafeObservable","swx-constants","swx-constants","utils/common/eventMixin","ui/contextMenu/contextMenu","ui/contextMenu/items/all","swx-utils-chat","swx-utils-common","swx-service-locator-instance","utils/common/appVisibilityProvider","swx-i18n","ui/telemetry/actions/actionSources","swx-utils-chat","experience/settings","swx-cafe-application-instance","utils/common/accessibility","swx-enums","ui/modelHelpers/personHelper","swx-log-tracer","browser/dom","ui/players/mediaPlayerController"],(function(e){var t=e("lodash-compat"),n=e("browser/document"),i=e("vendor/knockout"),r=e("utils/common/ko"),o=e("swx-utils-common").array,a=e("utils/common/cafeObservable"),s=e("swx-constants").COMMON,c=e("swx-constants").COMMON.events,l=e("utils/common/eventMixin"),u=e("ui/contextMenu/contextMenu"),d=e("ui/contextMenu/items/all"),p=e("swx-utils-chat").conversationCache,f=e("swx-utils-common").async,m=e("swx-service-locator-instance").default,h=e("utils/common/appVisibilityProvider"),v=e("swx-i18n").localization,g=e("ui/telemetry/actions/actionSources"),y=e("swx-utils-chat").messageSanitizer,b=e("experience/settings"),_=e("swx-cafe-application-instance"),E=e("utils/common/accessibility").narrator,w=e("swx-enums"),S=e("ui/modelHelpers/personHelper"),x=e("swx-log-tracer").getLogger(),C=e("browser/dom"),T=e("ui/players/mediaPlayerController")
	function I(e,l){var I,A,M,O,k,N,P,R,L,D,U,F,B,V,G=this,H={},q=!0,W=m.resolve(s.serviceLocator.PUBSUB),j=t.debounce((function(e){W.publish(c.interaction.SCROLL_START,e)}),1e3,{leading:!0,trailing:!1}),z=m.resolve(s.serviceLocator.FEATURE_FLAGS),K=z.isFeatureOn(s.featureFlags.HEARTS_ENABLED),Y=z.isFeatureOn(s.featureFlags.MARK_READ_MESSAGES_V2_ENABLED),Q=null
	function X(t){var n=new e
	return n.setContext(l),n.init(t,G.conversation),H[n.clientmessageid]=n,n}function $(e,t){t.text&&!Ee(t.text())||o.insertAt(G.collection(),e,X(t))}function J(e,t){var n=o.removeFrom(G.collection(),e)
	delete H[n.clientmessageid],n.clientmessageid!==t.key()&&x.warn("Removing wrong element ! There was de-synchronization between model activityItems and viewmodel messages ! Crash !")}function Z(){var e={},t=G.collection()
	t.forEach((function(t){e=I.processMessage(t,e)})),I.processMyLastMessageIfAny(t),G.collection.valueHasMutated()}function ee(e){r.handleArrayChanges(G.collection(),e,$,J),Z()}function te(){A=k.subscribe(ee,null,"arrayChange")}function ne(){if(k){U.start(),P=O.activityItems.subscribe()
	var e,t=k()
	if(t.length<10&&f.execute(ce),0===t.length)return te(),void G.dispatchEvent(s.events.conversation.MESSAGES_LOADED,t,G.DIRECTION.PARENT)
	e=(e=t.filter((function(e){return!e.text||Ee(e.text())}))).map((function(e){return X(e)})),i.utils.arrayPushAll(G.collection(),e),Z(),te(),G.dispatchEvent(s.events.conversation.MESSAGES_LOADED,t,G.DIRECTION.PARENT)}}function ie(){var e=O.unreadActivityItemsCount(),n=G.collection(),i=function(e){return t.find(e,(function(e){return!e.model.isRead()}))}(n)
	e>n.length?ce():D.isVisible()&&e>0&&e<51&&i&&D.isScrolledToBottom()&&D.scrollToMessage(i)}function re(e){if(q&&D.isVisible()&&(e||h.hasFocus())&&!L){var n=[]
	Y&&(i=[],t.forEach(G.collection(),(function(e){D.isMessageVisible(e.clientmessageid)&&i.push(e.model)})),n=i),O.markAllAsRead(n)}var i}function oe(){D&&(le()||(G._updatingMessages=!0,D.showNewMessages(),Y&&ie(),G._updatingMessages=!1,B&&B(),I.processMyBeforeLastMessageIfAny(G.collection()),D.isScrollable()||N||f.execute(ce),U.registerSync()))}function ae(){U.registerSync(),N=!1,oe()}function se(){U.registerError()}function ce(){O.getMoreActivityItems.enabled()&&(N=!0,O.getMoreActivityItems(10).then(ae,se))}function le(){return G.collection&&G.collection().filter((function(e){return!e.isRendered})).length>0}function ue(){le()||f.execute(oe)}function de(){D.restoreScrollPosition()}function pe(){D.isScrollPositionStored()||D.storeScrollPosition()}function fe(e){if(q=!0,D.onShow(),!D.isScrollable())return ce(),void re()
	Y&&ie(),e&&e.messageId&&me(e.messageId)}function me(e){var t,n=G.collection()
	for(B=null,t=0;t<n.length;t++){var i=n[t]
	if(i.clientmessageid===e)return D.scrollToMessage(i),void(B=null)}B=me.bind(null,e),ce()}function he(){re(),q=!1,D.onHide()}function ve(e){L=e,e||re()}function ge(){O.isHistoryDisclosed()&&ce()}function ye(){F=!0}function be(e){F=!1,e&&me(e)}function _e(){var e=O._messagesWithUnseenHearts()
	0!==e.length&&t.forEach(e,(function(e){D.isMessageVisible(e.id)&&O._messagesWithUnseenHearts.remove(e.id)}))}function Ee(e){var n=b.messageFilters&&b.messageFilters.chatLogMessageFilter?b.messageFilters.chatLogMessageFilter:null
	return!t.isFunction(n)||n(e)}function we(e,t){G.conversation.historyService.removeCustomActivityItem(w.activityType.ContactRequestOutgoing),G.conversation.historyService.removeCustomActivityItem(w.activityType.ContactRequestIsNowContact),G.conversation.historyService.addCustomActivityItem(e,{sender:t})}function Se(e){var t=G.participants(0).person
	e.id()===t.id()&&we(w.activityType.ContactRequestOutgoing,t)}function xe(e){var t=G.participants(0).person
	e.id()===t.id()&&G.conversation.historyService.removeCustomActivityItem(w.activityType.ContactRequestOutgoing)}function Ce(){var e,t,n,i,r=G.collection()
	void 0===r||r.length<=0||(t=r[r.length-1]).model.type()!==w.activityType.UnblockContact&&t.model.type()!==w.activityType.ContactRequestOutgoing&&(t.authorName&&(e=t.authorName()),t.author&&t.author.displayName&&(e=t.author.displayName()),n=y.stripHTML(t.content()),e?E.announce({key:"accessibility_chatLog_newMessage",params:{author:e,content:n}},{key:t.clientmessageid}):E.announce({key:"accessibility_chatLog_newMessage_withoutAuthor",params:{content:n}},{key:t.clientmessageid}),(i=t)&&i.suggestedActions&&i.suggestedActions().length?(G.suggestedActions(i.suggestedActions()),G.suggestedActionsAuthor=i.author,G.showSuggestedActions(!0)):(G.suggestedActions([]),G.suggestedActionsAuthor={},G.showSuggestedActions(!1)))}function Te(e){var t=C.getElement('[data-id="'+e+'"]')
	t&&t.focus()}this.collection=i.observableArray(),this.participants=null,this.init=function(e,t,r,o){var l,u,d,g
	W.subscribe(s.events.narrowMode.SIDEBAR_STATE_CHANGED,ve),W.subscribe(s.events.videoPlayer.FULLSCREEN_ON,ye),W.subscribe(s.events.videoPlayer.FULLSCREEN_OFF,be),W.subscribe(s.events.message.REMOVED,Te),D=t,I=r,O=e.historyService,p.forModel(e),k=a.newObservableCollection(O.activityItems),G.conversation=e,G.participants=e.participants,G.isMouseOver=i.observable(),G.suggestedActionsEnabled=z.isFeatureOn(s.featureFlags.SUGGESTED_ACTIONS_ENABLED),G.showSuggestedActions=i.observable(!1),G.hasSuggestedActionOnLeft=i.observable(!1),G.hasSuggestedActionOnRight=i.observable(!1),G.suggestedActionsAuthor={},G.suggestedActions=i.observableArray([]),G.showBotDetails=i.pureComputed((function(){return e.isGroupConversation()&&G.showSuggestedActions()&&!(!G.suggestedActionsAuthor.displayName||!G.suggestedActionsAuthor.avatar)})),G.suggestionChanged=function(){var e=D?D.getArrowsPositions():null
	e&&(G.hasSuggestedActionOnLeft(e.left),G.hasSuggestedActionOnRight(e.right))},G.scrollLeft=function(){D.scrollSuggestedArea("left",G.suggestionChanged)},G.scrollRight=function(){D.scrollSuggestedArea("right",G.suggestionChanged)},D.init({onContextMenu:G.showContextMenu,onMessageVisibilityChange:G.messageVisibilityChange},e),M=h.hasFocus.subscribe(re),V=G.collection.subscribe(Ce),R=O.isHistoryDisclosed.changed(ge),this.registerEvent(c.message.RENDERED,ue),this.registerEvent(c.navigation.FRAGMENT_BEFORE_HIDE,he,this.DIRECTION.PARENT),this.forwardEvent(c.navigation.FRAGMENT_SHOW,this.DIRECTION.CHILD,fe,this.DIRECTION.PARENT),this.forwardEvent(c.navigation.FRAGMENT_BEFORE_HIDE,this.DIRECTION.CHILD,null)
	this.forwardEvent(c.conversation.OPEN_PROFILE,this.DIRECTION.PARENT,null,this.DIRECTION.CHILD),this.forwardEvent(c.message.ADD_CONTACT,this.DIRECTION.PARENT,null,this.DIRECTION.CHILD),this.registerEvent(c.conversation.MARK_AS_READ,re),this.registerEvent(c.message.BEFORE_EXPANDED,pe),this.registerEvent(c.message.AFTER_EXPANDED,de),this.registerEvent(s.events.videoPlayer.FULLSCREEN_ON,pe),this.registerEvent(s.events.videoPlayer.FULLSCREEN_OFF,de),K&&G.conversation.historyService._messagesWithUnseenHearts&&O._messagesWithUnseenHearts.changed(_e),U=o,f.execute(ne),z.isFeatureOn(s.featureFlags.ENABLE_BUSINESS_CONTACT_MANAGEMENT)&&m.resolve(s.serviceLocator.SUBSCRIPTION_PROVIDER).getContacts().then((function(){G.conversation.isGroupConversation()||1!==G.participants.size()||(l=G.participants(0).person,S.isKnownPerson(l)||S.isWelcomeAgent(l)||we(w.activityType.ContactRequestOutgoing,l),_.get().personsAndGroupsManager.all.persons.removed(Se),_.get().personsAndGroupsManager.all.persons.added(xe))})),G.showIntroText=z.isFeatureOn(s.featureFlags.SHOW_CHAT_INTRO_TEXT),G.showIntroText&&(G.introMessages=[],b.chatIntroText&&b.chatIntroText.key&&(u=b.chatIntroText.key),u&&(b.chatIntroText&&b.chatIntroText.delimiter&&(g=b.chatIntroText.delimiter),(d=v.fetch({key:u}))&&(g?d.split(g).forEach((function(e){G.introMessages.push({text:e.trim()})})):G.introMessages.push({text:d.trim()})))),G.suggestedActionsEnabled&&(n.addEventListener("resize",G.suggestionChanged),window.setTimeout((function(){G.suggestionChanged()}),100))},this.onMouseOver=function(){G.isMouseOver(!0)},this.onMouseOut=function(){G.isMouseOver(!1)},this.onScroll=function(e,t){D&&(j(t),D.onScroll(t,300),!D.isScrolledToTop()||G._updatingMessages||n.fullScreenElement&&null!==n.fullScreenElement||n.mozFullScreen||n.webkitIsFullScreen||F||ce(),Y?(clearTimeout(Q),Q=setTimeout((function(){re(G.isMouseOver())}),400)):re())},this.dispose=function(){D.dispose(),P&&P.dispose(),A&&A.dispose(),R&&R.dispose(),G.showBotDetails.dispose(),M.dispose(),V.dispose(),U.dispose(),W.unsubscribe(s.events.narrowMode.SIDEBAR_STATE_CHANGED,ve),W.unsubscribe(s.events.videoPlayer.FULLSCREEN_ON,ye),W.unsubscribe(s.events.videoPlayer.FULLSCREEN_OFF,be),W.unsubscribe(s.events.message.REMOVED,Te),A=null,G.collection=null,D=null,k=null,H=null,K&&O._messagesWithUnseenHearts&&O._messagesWithUnseenHearts.changed.off(_e),z.isFeatureOn(s.featureFlags.ENABLE_BUSINESS_CONTACT_MANAGEMENT)&&(_.get().personsAndGroupsManager.all.persons.removed.off(Se),_.get().personsAndGroupsManager.all.persons.added.off(xe)),G.suggestedActionsEnabled&&n.removeEventListener("resize",G.suggestionChanged)},this.showContextMenu=function(e,t,n){var i,r=H[e],o=r&&r.model,a=[],s={source:g.conversation.messageItem},c=G.conversation.chatService.sendMessage.enabled()
	if(o&&c)return n?(a.push(new d.CopySelectionMenuItem(G,o,n)),a.push(new d.CopySelectionTextMenuItem(G,o,n))):(i={source:g.contextMenuItem.removeMessage,parent:g.conversation.messageItem},a.push(new d.CopyMessageMenuItem(G,o)),a.push(new d.QuoteMessageMenuItem(G,o)),a.push(new d.EditMessageMenuItem(G,o)),a.push(new d.RemoveMessageMenuItem(o,i)),a.push(new d.CopyLinkMenuItem(G,r,t)),a.push(new d.OpenLinkMenuItem(G,r,t)),a.push(new d.SaveVideoMessageMenuItem(o))),u.show(a,t,s),u.isVisible()},this.messageVisibilityChange=function(e){if(q){var t=[]
	e.forEach((function(e){t.push(e.getAttribute("data-id"))})),T.onVisibleViewPortChanged(G.conversation.conversationId,t)}}}return t.assign(I.prototype,l),I})),define("jsviews/chat/chatLog",["require","browser/dom","lodash-compat","swx-utils-chat","swx-constants","utils/common/scroll"],(function(e){var t=e("browser/dom"),n=e("lodash-compat"),i=e("swx-utils-chat").conversationCache,r=e("swx-constants").COMMON,o=e("utils/common/scroll"),a="message",s="swx-in-viewport",c="animate",l="loading"
	return function(e,u){var d,p,f,m,h,v,g,y,b=null,_=null,E=null,w=!1
	function S(e){var n,i=document.getSelection().toString();(n=t.getParentWithClass(e.target,a))&&(i&&i.length>0?b.onContextMenu(n.getAttribute("data-id"),e,i)&&e.preventDefault():(b.onContextMenu(n.getAttribute("data-id"),e),e.preventDefault()))}function x(e){var n=1===e.length
	Array.prototype.forEach.call(e,(function(e){n&&function(e){return d.lastElementChild===e&&d.childElementCount>1}(e)&&function(e){t.addClass(e,c),setTimeout((function(){e&&t.removeClass(e,c)}),800)}(e),t.removeClass(e,l)}))}function C(){return!p||p.scrollHeight-p.scrollTop-e.clientHeight<150}function T(){return!!p&&p.scrollTop<100}function I(){p&&(w=!0,_.scrollHeight=p.scrollHeight,_.scrollBottom=_.scrollHeight-p.scrollTop)}function A(t){if(!p)return f.scrollTop=f.scrollHeight-e.clientHeight,m.scrollTop=f.scrollHeight-e.clientHeight,void(w=!1)
	var n=p.scrollHeight,i=n===_.scrollHeight||t?_.scrollBottom:0
	p.scrollTop=n-i,w=!1}function M(){N(),v.resize()}var O=[]
	function k(){var e=O.slice(),n=function(e,t,n){if(e&&n&&t){if(t.children.length<2)return e
	for(var i,r,o,a=n.getBoundingClientRect(),s=t.children,c=null,l=0,u=s.length-1;e;){if((c=e.getBoundingClientRect()).top>a.bottom)u=Array.prototype.indexOf.call(s,e)
	else{if(!(c.bottom<a.top))return e
	l=Array.prototype.indexOf.call(s,e)}if(r===(i=(o=l)+(u-o>>1)))break
	r=i,e=s[i]}}}(d.lastElementChild,d,m)
	n&&(O=function(e,t,n){var i=n.getBoundingClientRect(),r=[]
	function o(e){if(e&&1===e.nodeType)return!function(e,t){var n=e.getBoundingClientRect(),i=n.height/2
	return n.top+i<=t.bottom&&n.bottom-i>=t.top}(e,i)||(r.push(e),!1)}r.push(e)
	for(var a=e.nextSibling;a&&!o(a);)a=a.nextSibling
	for(a=e.previousSibling;a&&!o(a);)a=a.previousSibling
	return r}(n,0,m))
	for(var i=0;i<e.length;i++)O.indexOf(e[i])<0&&t.setClass(e[i],s,!1)
	O.forEach((function(e){t.setClass(e,s,!0)})),b.onMessageVisibilityChange(O)}function N(e){clearTimeout(E),E=setTimeout(k,e)}function P(e,t,n,i){var r="scrollLeft"===n?y.scrollLeft:y.scrollTop,o=(e-r)/t*10
	window.setTimeout((function(){var a=r+o
	"scrollLeft"===n?y.scrollLeft=a:y.scrollTop=a,t-=10,a===e||t<=0?i&&i():P(e,t,n,i)}),10)}this.init=function(n,a){b=n,d=t.getElement(".messageHistory",e),_=i.forModel(a),d.addEventListener("contextmenu",S),f=t.getElement(".scroller",e),m=t.getElement(".scrollable",e),window.addEventListener(r.events.browser.RESIZE,M),y=e.querySelector("#chatlog-suggestedActionsArea"),(h=o.build(e)).init(),v=new u(e)},this.dispose=function(){d.removeEventListener("contextmenu",S),window.removeEventListener(r.events.browser.RESIZE,M),b=null,_=null,h.dispose(),v.dispose(),clearTimeout(E)},this.showNewMessages=function(){var e=d.querySelectorAll("."+a+"."+l),t=function(e){return!!C()||!!T()&&!n.find(e,(function(e){return e.className.indexOf("unread")>-1}))}(e),i=C()
	t&&I(),x(e),t&&A(!i),h.update(),N()},this.scrollToMessage=function(e){h.scrollToElement(e.elementInfo.element)},this.restoreScrollPosition=function(){A(!g),h.update()},this.storeScrollPosition=function(){g=C(),I()},this.isScrolledToTop=function(){return T()},this.isScrolledToBottom=function(){return C()},this.scrollSuggestedArea=function(e,t){y&&P("left"===e?y.scrollLeft-y.clientWidth:y.scrollLeft+y.clientWidth,250,"scrollLeft",t)},this.getArrowsPositions=function(){return y?{left:0!==y.scrollLeft,right:y.scrollLeft!==y.scrollWidth-y.clientWidth}:null},this.isScrollable=function(){return e.clientHeight<d.clientHeight+60},this.isScrollPositionStored=function(){return w},this.isVisible=function(){return d.offsetHeight>0},this.isMessageVisible=function(e){return!!n.find(O,(function(t){return e===t.attributes["data-id"].value}))},this.onShow=function(){A()},this.onHide=function(){I()},this.onScroll=function(e,t){p=p||e.target,N(t)}.bind(this),this._setScroller=function(e){p=e}}})),define("telemetry/chat/contactInfoEvent",["require","exports","module","experience/settings","swx-constants","ui/telemetry/telemetryClient","swx-telemetry-buckets","ui/modelHelpers/personHelper"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON.telemetry.contactInfo,r=e("ui/telemetry/telemetryClient"),o=e("swx-telemetry-buckets"),a=e("ui/modelHelpers/personHelper")
	function s(e){return a.isKnownPerson(e)?"EXISTING":"NEW"}function c(e){return e.displayName()!==e.id()}function l(e){return a.isPstn(e)?"PSTN":"SKYPE"}function u(e){var t=i.TYPE,a=function(e){var t=e.person
	return{state:s(t),hasDisplayName:c(t),contactType:l(t),participantsCount:e.participantsCount,participantsCountGroup:o.getParticipantCountGroup(e.participantsCount),timeInStale:e.timeInStale,timeInStaleGroup:o.getMessageLifeDurationGroup(new Date-e.timeInStale),actionName:e.actionName}}(e)
	r.get().sendEvent(n.telemetry.chatTenantToken,t,a)}t.publishShowEvent=function(e){return e.actionName=i.action.SHOW,u(e)},t.publishActionEvent=function(e){return e.actionName=i.action.CLICK,u(e)}})),define("ui/contactInfoMessage/contactInfoMessage",["require","exports","module","vendor/knockout","utils/common/cafeObservable","swx-i18n","telemetry/chat/contactInfoEvent","ui/modelHelpers/personHelper"],(function(e,t){var n=e("vendor/knockout"),i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("telemetry/chat/contactInfoEvent"),a=e("ui/modelHelpers/personHelper")
	t.render=function(e,t,s){t.contacts=n.observableArray([]),e.contacts().forEach((function(e){(function(e){var o={}
	function s(e){return t.isMyself?r.fetch({key:"chat_contactSent_label"}):a.isKnownPerson(e)?r.fetch({key:"contact_information_already_contact"}):r.fetch({key:"contact_information_add_to_contacts"})}o.name=n.observable(e.id()),o.fullName=n.observable(e.displayName()),o.actionKey=n.observable(s(e)),o.titleKey=n.observable(r.fetch({key:"label_text_openConversation",params:{displayName:e.displayName()}})),o.avatar=i.newObservableProperty(e.avatarUrl,{keepAlive:!0}),t.contacts.push(o)})(e),o.publishShowEvent({participantsCount:s.participantsCount(),timeInStale:t.timestamp.getTime(),person:e})})),t.content=n.observable(function(e){return t.isMyself?r.fetch({key:"message_text_sentContacts"}):r.fetch({key:"message_text_receivedContacts",params:{from:e.sender.displayName()}})}(e))},t.handleContactAdded=function(e,t){t.contacts().forEach((function(t){t.name()===e&&t.actionKey(r.fetch({key:"contact_information_already_contact"}))}))}})),define("ui/viewModels/people/contactName",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","ui/viewModels/people/properties/displayNameText"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("ui/viewModels/people/properties/displayNameText")
	function o(e){var t=this,i=r.build(e)
	t.displayName=n.computed(i.compute),t.getPerson=function(){return e},t.dispose=function(){t.displayName.dispose(),i.dispose()}}return t.assign(o.prototype,i),o})),define("constants/contentTemplates",["require","exports","module","swx-enums","swx-constants"],(function(e,t){var n=e("swx-enums"),i=e("swx-constants").COMMON,r="MessageContentTemplate",o={}
	o[n.activityType.TextMessage]="text"+r,o[n.activityType.CallStarted]="calling"+r,o[n.activityType.CallEnded]="calling"+r,o[n.activityType.CallMissed]="calling"+r,o[n.activityType.PluginFreeFallbackScreenSharing]="pluginFree"+r,o[n.activityType.PluginFreeFallbackMicrophoneAccess]="pluginFree"+r,o[n.activityType.PluginFreeNoVideoCapability]="pluginFree"+r,o[n.activityType.PluginFreeVideoCompatibility]="pluginFree"+r,o[n.activityType.NgcUpgradeMessage]="ngcUpgrade"+r,o[n.activityType.PstnInsufficientFunds]="pstn"+r,o[n.activityType.PstnInvalidNumber]="pstn"+r,o[n.activityType.PstnForbiddenNumber]="pstn"+r,o[n.activityType.VideoMessage]="video"+r,o[n.activityType.AudioMessage]="audio"+r,o[n.activityType.PictureMessage]="picture"+r,o[n.activityType.FileTransfer]="fileTransfer"+r,o[n.activityType.ContactRequestIncoming]="contactRequestIncoming"+r,o[n.activityType.ContactRequestIncomingInviteFree]="contactRequestIncomingInviteFree"+r,o[n.activityType.ContactRequestOutgoing]="contactRequestOutgoing"+r,o[n.activityType.ContactRequestOutgoingResend]="contactRequestOutgoingResend"+r,o[n.activityType.ContactRequestOutgoingAgent]="contactRequestOutgoingAgent"+r,o[n.activityType.SuggestedContact]="suggestedContact"+r,o[n.activityType.MojiMessage]="moji"+r,o[n.activityType.PollMessage]="poll"+r,o[n.activityType.UnblockContact]="unblockContact"+r,o[n.activityType.ContactInfoMessage]="contactInfo"+r,o[i.customActivityItemTemplates.SPACES_WELCOME_MESSAGE]="spacesWelcome"+r,t.templates=o})),define("telemetry/chat/videoMessagePlayback",["require","experience/settings","swx-constants","ui/telemetry/telemetryClient"],(function(e){var t=e("experience/settings"),n=e("swx-constants").COMMON.telemetry,i=e("ui/telemetry/telemetryClient")
	return new function(){var e=this,r=n.chat.VIDEO_MESSAGE.TYPE,o={}
	function a(e){i.get().sendEvent(t.telemetry.chatTenantToken,r,e)}e.sendLoadedEvent=function(){o.action=n.chat.VIDEO_MESSAGE.eventName.LOADED,a(o)},e.sendFirstPlayAction=function(){o.action=n.chat.VIDEO_MESSAGE.action.FIRST_PLAY,a(o)},e.sendFullscreenAction=function(){o.action=n.chat.VIDEO_MESSAGE.action.FULLSCREEN,a(o)},e.sendSeekAction=function(){o.action=n.chat.VIDEO_MESSAGE.action.SEEK,a(o)},e.sendReplayAction=function(){o.action=n.chat.VIDEO_MESSAGE.action.REPLAY,a(o)}}})),define("telemetry/chat/audioMessagePlayback",["require","experience/settings","swx-constants","ui/telemetry/telemetryClient"],(function(e){var t=e("experience/settings"),n=e("swx-constants").COMMON.telemetry,i=e("ui/telemetry/telemetryClient")
	return new function(){var e=n.chat.AUDIO_MESSAGE.TYPE,r={}
	function o(n){i.get().sendEvent(t.telemetry.chatTenantToken,e,n)}this.sendFirstPlayAction=function(){r.action=n.chat.AUDIO_MESSAGE.action.VM_CHAT_PLAYBACK,o(r)},this.sendReplayAction=function(){r.action=n.chat.AUDIO_MESSAGE.action.VM_CHAT_REPLAY,o(r)}}})),define("ui/viewModels/chat/messageMediaTypesHandlers",["require","exports","module","swx-enums","utils/common/cafeObservable","swx-i18n","vendor/knockout","swx-service-locator-instance","swx-constants","browser/dom","telemetry/chat/videoMessagePlayback","telemetry/chat/audioMessagePlayback"],(function(e,t){var n=e("swx-enums"),i=e("utils/common/cafeObservable"),r=e("swx-i18n").localization,o=e("vendor/knockout"),a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("browser/dom"),l=e("telemetry/chat/videoMessagePlayback"),u=e("telemetry/chat/audioMessagePlayback"),d={}
	function p(){}d[n.activityType.VideoMessage]=function(e,t){var n
	function i(){var t=c.createElement("img")
	e.onBeforeExpanded(),t.addEventListener("load",(function(t){e.isLoaded(!0),t.target.width>t.target.height?e.orientationClass("landscape"):e.orientationClass("portrait"),e.onAfterExpanded()})),t.addEventListener("error",(function(){e.hasFailed(!0),e.onAfterExpanded()})),t.src=e.thumbnailUrl}n=t?r.fetch({key:"media_videosharing_group",params:{senderName:e.model.sender.displayName()}}):r.fetch({key:"media_videosharing_one"})
	e.thumbnailUrl=e.model.thumbnailPath(),e.mediaUrl=e.model.mediaUrl(),e.isLoaded=o.observable(!1),e.isPlaying=o.observable(!1),e.hasExpired=o.observable(!1),e.hasFailed=o.observable(!1),e.orientationClass=o.observable(),e.content=o.observable(n),e.play=function(){e.isPlaying(!0),l.sendFirstPlayAction()},e.model.isExpired.get().then((function(t){t?e.hasExpired(!0):e.isRendered?i():e.registerEvent(s.events.message.RENDERED,i)}))},d[n.activityType.AudioMessage]=function(e,t){var n
	n=t?r.fetch({key:"media_audiosharing_group",params:{senderName:e.model.sender.displayName()}}):r.fetch({key:"media_audiosharing_one"})
	e.mediaUrl=e.model.mediaUrl(),e.isLoaded=o.observable(!0),e.isPlaying=o.observable(!1),e.hasExpired=o.observable(!1),e.hasFailed=o.observable(!1),e.content=o.observable(n),e.voiceMessage=o.observable(r.fetch({key:"media_voice_message"})),e.play=function(){e.isPlaying(!0),u.sendFirstPlayAction()},e.model.isExpired.get().then((function(t){t&&e.hasExpired(!0)}))},d[n.activityType.PictureMessage]=function(e,t){var a
	a=t?r.fetch({key:"media_picturesharing_group",params:{senderName:e.model.sender.displayName()}}):r.fetch({key:"media_picturesharing_one"})
	e.hasFailed=o.pureComputed((function(){return e.status()===n.activityStatus.Failed})),e.isPending=o.pureComputed((function(){return e.status()===n.activityStatus.Pending})),e.status=i.newObservableProperty(e.model.status),e.progress=i.newObservableProperty(e.model.progress),e.thumbnailUrl=i.newObservableProperty(e.model.thumbnailUrl),e.pictureUrl=i.newObservableProperty(e.model.pictureUrl),e.content=o.observable(a),e.isPicture=o.observable(!0),e.open=function(){return!(e.isPending()||e.hasFailed())},e.progressIndicatorBG=o.pureComputed((function(){var t=e.progress(),n="#C4DAE3"
	return"linear-gradient("+(t<=50?-90:90)+"deg, transparent "+(0===t?0:50)+"%, "+(t<=50?"#E7F1F5":n)+" 50%),linear-gradient("+(Math.floor(3.6*t)+90)+"deg, "+n+" 50%, transparent 50%)"}))},d[n.activityType.MojiMessage]=function(e,t){var n,i=a.resolve(s.serviceLocator.PES_CONFIG_SERVICE)
	n=t?r.fetch({key:"media_mojisharing_group",params:{senderName:e.model.sender.displayName()}}):r.fetch({key:"media_mojisharing_one"})
	function c(t){(function(e,t){var n,i
	n=t._mojiURL,i=t._thumbnailURL,e.mojiUrl(n),e.mojiThumbnailUrl(i)})(e,t),e.mojiTitle(t.description),e.mojiLinkName(t.auxiliaryText),e.mojiLinkUrl(t.auxiliaryUrl),e.mojiCopyright(t.copyright),e.typeClasses("moji keyframe"),e.mojiErrorText(null)}function l(){e.typeClasses("moji mojifailed"),e.mojiErrorText(r.fetch({key:"pes_moji_error_text"}))}function u(){return i.fetchMetadata(e.model.mojiUrl()).then(c,l)}return e.typeClasses=o.observable("mojiloading"),e.mojiThumbnailUrl=o.observable(),e.mojiUrl=o.observable(),e.isSticker=o.observable(!0),e.isMoji=o.observable(!0),e.mojiTitle=o.observable(""),e.mojiLinkName=o.observable(""),e.mojiLinkUrl=o.observable(""),e.mojiCopyright=o.observable(""),e.mojiErrorText=o.observable(),e.isMojiPlaying=o.observable(!1),e.isMojiPlayed=o.observable(!1),i.on(s.events.personalExpression.CONFIG_INITIALIZED,u),e.autoDisposer.registerDisposable({dispose:function(){i.off(s.events.personalExpression.CONFIG_INITIALIZED,u)}}),e.stopMojiPlay=function(e,t){t.target.previousElementSibling.pause()},e.playMoji=function(t,n){var i=n.target.previousElementSibling.previousElementSibling
	function r(){e.isMojiPlayed(!0),e.isMojiPlaying(!1),i.removeEventListener("pause",r,!1),i.removeEventListener("ended",r,!1)}e.isMojiPlaying()?i.pause():(e.isMojiPlaying(!0),i.play(),i.addEventListener("ended",r,!1),i.addEventListener("pause",r,!1))},e.i18n=function(e){return r.fetch({key:e})},e.content=o.observable(n),u()},d[n.activityType.FileTransfer]=function(e){function t(e){if(!e||0===e)return"0 Bytes"
	var t=["Bytes","KB","MB","GB"],n=Math.floor(Math.log(e)/Math.log(1e3))
	return n>=t.length&&(n=t.length-1),Math.round(e/Math.pow(1e3,n)*10)/10+" "+t[n]}e.typeClasses={},e.typeClasses[e.model.fileType]=!0,e.fileName=e.model.fileName,e.fileType=e.model.fileType,e.fileThumbnailUri=i.newObservableProperty(e.model.fileThumbnailUri),e.fileSize=o.pureComputed((function(){var i=e.progress(),o=e.status()===n.activityStatus.Pending,a=Math.round(i*e.model.fileSize/100)
	return o?r.fetch({key:"file_transfer_upload_state",params:{size:t(e.model.fileSize),uploaded:t(a)}}):t(e.model.fileSize)})),e.fileUri=i.newObservableProperty(e.model.fileUri),e.status=i.newObservableProperty(e.model.status),e.progress=i.newObservableProperty(e.model.progress),e.shouldAbort=i.newObservableProperty(e.model.shouldAbort),e.iconClasses={},e.iconClasses[e.fileType]=!0,e.content=o.observable(r.fetch({key:"file_transfer_file_shared"})),e.isAborted=o.pureComputed((function(){var t=e.shouldAbort(),i=e.status()===n.activityStatus.Failed
	return t&&i})),e.abortUploading=function(){e.model.shouldAbort(!0)}},t.fetch=function(e){return d[e]||p}})),define("constants/activityTypeGroups",["require","exports","module","swx-enums"],(function(e,t){var n=e("swx-enums")
	t.CALL_MESSAGES=[n.activityType.CallStarted,n.activityType.CallEnded,n.activityType.CallMissed],t.PSTN_MESSAGES=[n.activityType.PstnInsufficientFunds,n.activityType.PstnInvalidNumber,n.activityType.PstnForbiddenNumber],t.PLUGIN_FREE_MESSAGES=[n.activityType.PluginFreeFallbackScreenSharing,n.activityType.PluginFreeFallbackMicrophoneAccess,n.activityType.PluginFreeNoVideoCapability,n.activityType.PluginFreeVideoCompatibility],t.NGC_UPGRADE_MESSAGES=[n.activityType.NgcUpgradeMessage],t.MEDIA_MESSAGES=[n.activityType.VideoMessage,n.activityType.PictureMessage,n.activityType.AudioMessage,n.activityType.MojiMessage,n.activityType.FileTransfer],t.PARTICIPANT_MESSAGES=[n.activityType.ParticipantJoined,n.activityType.ParticipantLeft,n.activityType.ParticipantJoinFailed,n.activityType.ParticipantRoleUpdate,n.activityType.ParticipantTopicUpdate,n.activityType.ParticipantPictureUpdate,n.activityType.ParticipantHistoryDisclosed,n.activityType.ParticipantJoiningEnabled,n.activityType.ParticipantLegacyMemberAdded,n.activityType.ParticipantLegacyMemberUpgraded],t.CONTACT_REQUEST_MESSAGES=[n.activityType.ContactRequestIncoming,n.activityType.ContactRequestIncomingInviteFree,n.activityType.ContactRequestOutgoing,n.activityType.ContactRequestOutgoingResend,n.activityType.ContactRequestIsNowContact,n.activityType.SuggestedContact,n.activityType.UnblockContact,n.activityType.ContactRequestOutgoingAgent],t.CONTACT_INFO_MESSAGES=[n.activityType.ContactInfoMessage],t.TRANSACTION_MESSAGES=[n.activityType.CreditTransaction],t.POLL_MESSAGES=[n.activityType.PollMessage],t.CUSTOM_MESSAGES=[n.activityType.CustomMessage],t.TRANSCRIPT_MESSAGES=[n.activityType.Transcript],t.SYSTEM_MESSAGES=[n.activityType.SystemMessage]})),define("utils/chat/message",["require","swx-enums","constants/activityTypeGroups","swx-constants","swx-browser-detect","constants/calling.resources","swx-i18n","swx-utils-chat","swx-service-locator-instance","swx-utils-chat","ui/viewModels/people/properties/displayNameText","ui/viewModels/people/properties/locationText","experience/settings","lodash-compat","ui/modelHelpers/personHelper"],(function(e){var t=e("swx-enums"),n=e("constants/activityTypeGroups"),i=e("swx-constants").COMMON,r=e("swx-browser-detect").default,o=e("constants/calling.resources").fallbackMessages,a=e("swx-i18n").localization,s=e("swx-utils-chat").dateTime,c=e("swx-service-locator-instance").default,l=e("swx-utils-chat").messageSanitizer,u=e("ui/viewModels/people/properties/displayNameText"),d=e("ui/viewModels/people/properties/locationText"),p=e("experience/settings"),f=e("lodash-compat"),m=e("ui/modelHelpers/personHelper")
	function h(e,t,n){var r,o="28:"+e,s=n._botsSettings,c=s?function(e,t){return e&&t[e]?t[e].messagingMode:i.chat.BOT_MESSAGING_MODE.UNDEFINED}(o,s):i.chat.BOT_MESSAGING_MODE.UNDEFINED
	switch(c){case i.chat.BOT_MESSAGING_MODE.ALL:r="message_text_addedBotGroupConversation_allMessagesMode"
	break
	case i.chat.BOT_MESSAGING_MODE.AT:case i.chat.BOT_MESSAGING_MODE.UNDEFINED:r="message_text_addedBotGroupConversation_privateMode"}return a.fetch({key:r,params:{botName:t}})}return{getMessageFromParticipantActivityItem:function(e,n,r,o,s,u){var d=c.resolve(i.serviceLocator.FEATURE_FLAGS),p=d.isFeatureOn(i.featureFlags.SINGLE_CONVERSATION_MODE),v=d.isFeatureOn(i.featureFlags.BOT_MESSAGES_MODE_V2_ENABLED),g=n.displayName,y=m.isMePerson(n)
	function b(){var e=""
	return r.forEach((function(t,n){e=0===n?e+t.displayName():e+", "+t.displayName()})),e}switch(e){case t.activityType.ParticipantJoined:return r.length>0?a.fetch({key:"message_text_wasAddedToConversation",params:{participant:g(),contact:b()}})+function(e){var t=""
	return f.some(e,(function(e){return m.isAgent(e.getPerson())}))?(e.forEach((function(e){var n=e.getPerson(),i=f.escape(n.displayName())
	m.isAgent(n)&&(t+=v?"\n"+h(n.id(),i,u):"\n"+a.fetch({key:"message_text_botWasAddedToConversation",params:{botName:i}}))})),t):""}(r):p&&y&&u?function(e){var t=[]
	if(e.participants().forEach((function(e){t.push(e.person.displayName())})),0!==t.length){if(1===t.length)return a.fetch({key:"message_text_meJoinedConversation_one",params:{participant:t[0]}})
	var n=t.pop()
	return a.fetch({key:"message_text_meJoinedConversation_more",params:{participants:t.join(", "),participant:n}})}}(u):a.fetch({key:"message_text_joinedConversation",params:{participant:g()}})
	case t.activityType.ParticipantJoinFailed:return a.fetch({key:"message_text_joinConversationFailed",params:{participant:g()}})
	case t.activityType.ParticipantLeft:return function(e,t){return!!c.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.SPACES)&&e()===t()}(g,o)?a.fetch({key:"message_text_guestRemovedBySystem",params:{participant:b()}}):r.length>0?a.fetch({key:"message_text_wasRemovedFromConversation",params:{participant:g(),removedParticipant:b()}}):s&&"Ejected"===s.subcode&&"You were removed from the meeting."===s.message?a.fetch({key:"message_text_youWereRemovedFromConversation"}):a.fetch({key:"message_text_hasLeftConversation",params:{participant:g()}})
	case t.activityType.ParticipantRoleUpdate:return a.fetch({key:"message_text_roleUpdated",params:{who:g(),whom:r[0]?r[0].displayName():g(),role:o()}})
	case t.activityType.ParticipantTopicUpdate:var _=o?l.escapeHTML(o()):""
	return a.fetch({key:"message_text_topicUpdated",params:{participant:g(),topic:_}})
	case t.activityType.ParticipantPictureUpdate:return a.fetch({key:"message_text_threadPictureUpdated",params:{participant:g()}})
	case t.activityType.ParticipantHistoryDisclosed:return a.fetch({key:o()?"message_text_historyDisclosed":"message_text_historyClosed",params:{participant:g()}})
	case t.activityType.ParticipantJoiningEnabled:return a.fetch({key:o()?"message_text_joiningEnabled":"message_text_joiningDisabled",params:{participant:g()}})
	case t.activityType.ParticipantLegacyMemberAdded:return a.fetch({key:"message_text_legacyMemberAdded",params:{participant:g()}})
	case t.activityType.ParticipantLegacyMemberUpgraded:return a.fetch({key:"message_text_legacyMemberUpgraded",params:{participant:g()}})}return""},getMessageFromCallActivityItem:function(e,n){var i=n?"GroupCall":"Call",r=!!e.duration(),o={callAction:"",duration:r?s.formatCallDuration(e.duration()):"",text:""}
	switch(e.type()){case t.activityType.CallStarted:o.callAction="callStart",o.text=a.fetch({key:"message_text_started"+i})
	break
	case t.activityType.CallEnded:o.callAction="callEnd",o.text=r?a.fetch({key:"message_text_ended"+i}):a.fetch({key:"message_text_outgoing"+i+"NoAnswer"})
	break
	case t.activityType.CallMissed:o.callAction="callMissed",o.text=a.fetch({key:"message_text_missed"+i})}return o},getMessageFromContactRequestActivityItem:function(e,n){var i
	switch(e){case t.activityType.ContactRequestIncoming:return a.fetch({key:"message_text_addingContactRequest",params:{id:n.id()}})
	case t.activityType.ContactRequestIsNowContact:return a.fetch({key:"message_text_contactRequestIsNowContact",params:{displayName:u.format(n.id(),n.displayName())}})
	case t.activityType.ContactRequestIncomingInviteFree:return(i=d.format(n.location))?a.fetch({key:"invite_free_message_received_location",params:{displayName:u.format(n.id(),n.displayName()),location:i}}):a.fetch({key:"invite_free_message_received",params:{displayName:u.format(n.id(),n.displayName())}})}return""},getMessageFromNgcUpgradeActivityItem:function(e){var t=e.participantNames()
	return 1===t.length?a.fetch({key:"message_text_ngcUpgradeMessage_one",params:{participant:t[0],link:o.ngcUpgradeLink}}):t.length>1?a.fetch({key:"message_text_ngcUpgradeMessage_many",params:{participantList:t.slice(0,t.length-1).join(", "),lastParticipant:t[t.length-1],link:o.ngcUpgradeLink}}):""},getMessageFromPluginFreeActivityItem:function(e){function n(){return a.fetch({key:"message_text_pluginFree_noVideoCapability"})}switch(e.type()){case t.activityType.PluginFreeFallbackScreenSharing:return a.fetch({key:"message_text_pluginFree_screenSharingFallback_line1"})+"\r\n"+a.fetch({key:"message_text_pluginFree_screenSharingFallback_line2",params:{upgrade_link:o.skypeUpgradeLink}})
	case t.activityType.PluginFreeFallbackMicrophoneAccess:return a.fetch({key:r.getBrowserInfo().isEdge?"message_text_pluginFree_microphoneAccess_edge":"message_text_pluginFree_microphoneAccess_others"})
	case t.activityType.PluginFreeNoVideoCapability:case t.activityType.PluginFreeVideoCompatibility:return n()}return""},getMessageFromPstnActivityItem:function(e){switch(e.type()){case t.activityType.PstnInsufficientFunds:return function(e){var t,n,r,o,s='<a href="{url}" target="_blank" class="{class}">{text}</a>',c=p.commerce.purchaseCreditUrl,l=p.commerce.purchaseSubscriptionUrl,u=i.telemetry.pstn.cssClasses.ADD_CREDIT,d=i.telemetry.pstn.cssClasses.ADD_SUBSCRIPTION
	return t=a.fetch({key:"pstn_insufficient_funds_credit"}),n=a.fetch({key:"pstn_insufficient_funds_subscription"}),r=s.replace("{url}",c).replace("{text}",t).replace("{class}",u),o=s.replace("{url}",l).replace("{text}",n).replace("{class}",d),e.isGroup()?e.participantName()===e.participantEndpoint()?a.fetch({key:"pstn_insufficient_funds_group",params:{phoneNumber:e.participantEndpoint(),credit:r,subscription:o}}):a.fetch({key:"pstn_insufficient_funds_group_name",params:{displayName:e.participantName(),phoneNumber:e.participantEndpoint(),credit:r,subscription:o}}):a.fetch({key:"pstn_insufficient_funds",params:{credit:r,subscription:o}})}(e)
	case t.activityType.PstnInvalidNumber:return function(e){return e.isGroup()?e.participantName()===e.participantEndpoint()?a.fetch({key:"pstn_invalid_number_group",params:{phoneNumber:e.participantEndpoint()}}):a.fetch({key:"pstn_invalid_number_group_name",params:{displayName:e.participantName(),phoneNumber:e.participantEndpoint()}}):a.fetch({key:"pstn_invalid_number"})}(e)
	case t.activityType.PstnForbiddenNumber:return function(e){return e.isGroup()?e.participantName()===e.participantEndpoint()?a.fetch({key:"pstn_forbidden_number_group",params:{phoneNumber:e.participantEndpoint()}}):a.fetch({key:"pstn_forbidden_number_group_name",params:{displayName:e.participantName(),phoneNumber:e.participantEndpoint()}}):a.fetch({key:"pstn_forbidden_number"})}(e)}return""},getActivityItemGroup:function(e){return-1!==n.PARTICIPANT_MESSAGES.indexOf(e)?i.activityItemGroups.PARTICIPANT:-1!==n.CALL_MESSAGES.indexOf(e)?i.activityItemGroups.CALL:-1!==n.NGC_UPGRADE_MESSAGES.indexOf(e)?i.activityItemGroups.NGC_UPGRADE:-1!==n.PLUGIN_FREE_MESSAGES.indexOf(e)?i.activityItemGroups.PLUGIN_FREE:-1!==n.MEDIA_MESSAGES.indexOf(e)?i.activityItemGroups.MEDIA:-1!==n.CONTACT_REQUEST_MESSAGES.indexOf(e)?i.activityItemGroups.CONTACT_REQUEST:-1!==n.POLL_MESSAGES.indexOf(e)?i.activityItemGroups.POLL:-1!==n.CONTACT_INFO_MESSAGES.indexOf(e)?i.activityItemGroups.CONTACT_INFO:-1!==n.TRANSACTION_MESSAGES.indexOf(e)?i.activityItemGroups.TRANSACTION:-1!==n.PSTN_MESSAGES.indexOf(e)?i.activityItemGroups.PSTN:-1!==n.CUSTOM_MESSAGES.indexOf(e)?i.activityItemGroups.CUSTOM:-1!==n.TRANSCRIPT_MESSAGES.indexOf(e)?i.activityItemGroups.TRANSCRIPT:-1!==n.SYSTEM_MESSAGES.indexOf(e)?i.activityItemGroups.SYSTEM:i.activityItemGroups.TEXT},getBotDisclosureMessage:h}})),define("telemetry/chat/poll",["require","experience/settings","swx-constants","ui/telemetry/telemetryClient","swx-service-locator-instance","utils/common/styleModeHelper"],(function(e){var t=e("experience/settings"),n=e("swx-constants").COMMON,i=e("ui/telemetry/telemetryClient"),r=e("swx-service-locator-instance").default,o=e("utils/common/styleModeHelper")
	return new function(){this.pollDesignerOpened=function(e){var a={}
	a[n.telemetry.poll.property.CONVERSATION_ID]=e,a.mediaBarV2Enabled=r.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.MEDIA_BAR_V2_ENABLED),a.styleMode=o.get().currentMode(),i.get().sendEvent(t.telemetry.chatTenantToken,n.telemetry.poll.eventName.DESIGNER_OPENED,a)},this.stickyMessageClicked=function(e){var r={}
	r[n.telemetry.poll.property.CONVERSATION_ID]=e.conversationId(),r[n.telemetry.poll.property.MESSAGE_ID]=e.key(),i.get().sendEvent(t.telemetry.chatTenantToken,n.telemetry.poll.eventName.STICKY_MESSAGE_CLICKED,r)},this.avatarElipsisClicked=function(e){var r={}
	r[n.telemetry.poll.property.CONVERSATION_ID]=e.conversationId(),r[n.telemetry.poll.property.MESSAGE_ID]=e.key(),i.get().sendEvent(t.telemetry.chatTenantToken,n.telemetry.poll.eventName.AVATAR_ELIPSIS_CLICKED,r)},this.activityVote=function(r){var o=e(r,n.telemetry.poll.activityType.VOTE)
	o[n.telemetry.poll.property.IS_NEW_VOTE]=!0,i.get().sendEvent(t.telemetry.chatTenantToken,n.telemetry.poll.eventName.ACTIVITY,o)}
	var e=function(e,t){var i={}
	return i[n.telemetry.poll.property.CONVERSATION_ID]=e.conversationId(),i[n.telemetry.poll.property.MESSAGE_ID]=e.key(),i[n.telemetry.poll.property.ACTIVITY_TYPE]=t,i[n.telemetry.poll.property.XMM_TYPE]=e.xmmType(),i[n.telemetry.poll.property.QUESTION_LENGTH]=e.pollQuestion().length,i[n.telemetry.poll.property.ANSWERS_COUNT]=e.pollAnswers().length,i[n.telemetry.poll.property.MULTI_VOTE]=e.multipleVotes(),i[n.telemetry.poll.property.TIME_SINCE_CREATION]=(new Date).getTime()-e.timestamp(),i}}})),define("ui/viewModels/chat/pollAvatars",["require","exports","module","vendor/knockout","swx-i18n","ui/viewModels/people/contactBuilder","telemetry/chat/poll"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("ui/viewModels/people/contactBuilder"),o=e("telemetry/chat/poll")
	function a(e,t){var a=this
	a.selectedEllipsis=n.observable(-1),a.model=e,a.users=n.observableArray(),a.isSelfPopup=function(e,t){return a.selectedEllipsis()===e&&"polls"===t.key},a.onEllipsisClick=function(e,n,i){o.avatarElipsisClicked(a.model),function(e){var t=a.model.pollAnswers()[e]
	a.selectedEllipsis(e),a.users.removeAll(),t.users.forEach((function(e){var t={}
	t.person=e.person,t.displayName=e.displayName,e.person&&(t.contact=r.build(e.person)),a.users.push(t)}))}(e),t({key:"polls",eventPageY:i.pageY})},a.votedByCount=function(e){return i.fetch({key:"poll_list_title",params:{count:e}})}}t.build=function(e,t){return new a(e,t)}})),define("ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry",["require","swx-constants","experience/settings","ui/telemetry/telemetryClient"],(function(e){var t=e("swx-constants").COMMON,n=t.telemetry.swiftCard,i=e("experience/settings"),r=e("ui/telemetry/telemetryClient")
	function o(){var e=this,o=t.telemetry.NOT_AVAILABLE
	function a(e,t){try{r.get().sendEvent(i.telemetry.uiTenantToken,e,function(e){for(var t in e)e.hasOwnProperty(t)&&!("string"==typeof e[t]||e[t]instanceof String)&&(e[t]=e[t]+"")
	return e}(t))}catch(n){}}function s(e,t,n){var i={}
	i.card_failure_reason=t||o,i.card_bot_id=n?"28:"+n:o,a(e,i)}e.publishCardAction=function(e,t,i){var r=function(e,t,n){var i={}
	return i.card_cta_type=e||o,i.card_cta_success=t?1:0,i.card_bot_id=n?"28:"+n:o,i}(e,t,i)
	a(n.swiftCardActionEventName,r)},e.publishInvalidCard=function(e,t){s(n.swiftCardInvalidEventName,e,t)},e.publishUnsupportedCard=function(e,t){s(n.swiftCardUnsupportedEventName,e,t)}}return o.build=function(){return new o},o})),define("ui/viewModels/chat/messageParsers/swift/utils",["require","lodash-compat","swx-constants","swx-cafe-application-instance","swx-encoder/lib/encoders/emoticonEncoder","swx-encoder","swx-utils-chat","swx-service-locator-instance","experience/settings"],(function(e){var t,n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("swx-cafe-application-instance"),o=e("swx-encoder/lib/encoders/emoticonEncoder"),a=e("swx-encoder"),s=e("swx-utils-chat").messageSanitizer,c=e("swx-service-locator-instance").default,l=e("experience/settings"),u={unknown:"Unknown",hero:"Hero",thumb:"Thumb",receipt:"Receipt",signIn:"SignIn",flex:"Flex",audio:"Audio",video:"Video",animation:"Animation"},d="invalidValue"
	function p(e,t){return n.isArray(e)?n.compact(e.map(t)):[]}return t=function(e){var n=o.build(),i=a.build(r,{domTransformers:[n]})
	return t=function(e){return i.decode(i.encode(e,!1))},t(e)},{ContentType:u,invalidValue:d,filterOutNotValidItems:function(e,t){var i=p(e,t)
	return i=n.filter(i,(function(e){return!e.isValid||e.isValid()}))},filterOutDisabledItems:function(e,t){var i=p(e,t)
	return i=n.filter(i,(function(e){return!e.isDisabled||!e.isDisabled()}))},normalizeDestination:function(e){return/^(skype|tel):/i.test(e)?s.getMessageSanitizedContent(e):d},normalizeEnum:function(e,t,n){return e=e&&e.toLowerCase(),t.hasOwnProperty(e)?t[e]:n},normalizeRichText:function(e){return e?t(s.getMessageSanitizedContent(s.unwebify(e))):null},normalizeText:function(e){return e?s.getMessageSanitizedContent(e):null},normalizeUrl:function(e,t){var n=e?s.getMessageSanitizedContent(e):d,i=l.swift.urlPrefixBlacklist
	switch(t){case"openUrl":case"payment":case"showImage":n=function(e){try{var t=document.createElement("a")
	return t.href=e,["https:","http:","skype:"].indexOf(t.protocol)>-1?e:d}catch(n){return d}}(n),n=function(e){var t=new RegExp(/^skype:[a-zA-Z0-9-_,\.\*@\?:]{6,256}/g),n=new RegExp(/^(https?:\/\/)?(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/g)
	return!!e.match(n)|!!e.match(t)?e:d}(n),n=function(e){for(var t=0;t<i.length;t++)if(new RegExp("^"+i[t]+":","i").test(e))return d
	return e}(n)
	break
	case"signIn":n=/^https/i.test(n)?n:d}return n=function(e){if(e===d)return d
	var t=new RegExp(/^[\s\S]*javascript:/gim)
	return e.match(t)?d:e}(n)},mapArray:p,getItemIfNotDisabled:function(e){return e.isDisabled&&e.isDisabled()?null:e},setSupportedSwiftCardTypes:function(){var e=c.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.SWIFT_CARD_RENDERING_MEDIA_CARDS)
	u["application/vnd.microsoft.card.hero"]=u.hero,u["application/vnd.microsoft.card.thumbnail"]=u.thumb,u["application/vnd.microsoft.card.receipt"]=u.receipt,u["application/vnd.microsoft.card.signin"]=u.signIn,u["application/vnd.microsoft.card.flex"]=u.flex,e&&(u["application/vnd.microsoft.card.video"]=u.video,u["application/vnd.microsoft.card.audio"]=u.audio,u["application/vnd.microsoft.card.animation"]=u.animation)}}})),define("ui/viewModels/chat/messageParsers/swift/action",["require","swx-cafe-application-instance","ui/viewModels/calling/helpers/callingFacade","swx-enums","swx-i18n","vendor/knockout","swx-encoder/lib/encoders/mentionsEncoder","swx-constants","swx-constants","ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry","ui/viewModels/chat/messageParsers/swift/utils","swx-pubsub-instance"],(function(e){var t=e("swx-cafe-application-instance"),n=e("ui/viewModels/calling/helpers/callingFacade"),i=e("swx-enums"),r=e("swx-i18n").localization,o=e("vendor/knockout"),a=e("swx-encoder/lib/encoders/mentionsEncoder"),s=e("swx-constants").PEOPLE,c=e("swx-constants").COMMON,l=c.telemetry.swiftCard,u=e("ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry"),d=e("ui/viewModels/chat/messageParsers/swift/utils"),p=c.events,f=e("swx-pubsub-instance").default
	function m(e,t,n){switch(this.type=e.type?d.normalizeEnum(e.type,m.Type,m.Type.unknown):null,this.title=d.normalizeRichText(e.title),this.value=e.value?e.value:null,this.fallbackUri=e.fallback&&e.fallback.uri?d.normalizeUrl(e.fallback.uri,m.Type.payment):null,this.isCalling=o.observable(!1),this.senderId=n.id(),this.tooltip=this.title,this.type){case m.Type.call:this.value=d.normalizeDestination(this.value)
	break
	case m.Type.imBack:var i
	if(t.isGroupConversation()){var s=a.build(t),c=s.getMentionUserData(this.senderId)
	i=c?s.createXmlElement(document,c).outerHTML:null}i&&(this.value=i+" "+this.value)
	break
	case m.Type.showImage:this.value&&(this.value=d.normalizeUrl(e.value,m.Type.showImage)),this.title||(this.title=r.fetch({key:"accessibility_swift_showImage"}))
	break
	case m.Type.openUrl:this.value=d.normalizeUrl(e.value,m.Type.openUrl),this.tooltip?this.tooltip+="\n\n"+this.value:this.tooltip=this.value
	break
	case m.Type.payment:this.value=this.fallbackUri?this.fallbackUri:d.normalizeUrl(e.value,m.Type.payment),this.tooltip?this.tooltip+="\n\n"+this.value:this.tooltip=this.value,this.title||(this.title=this.tooltip)
	break
	case m.Type.signIn:this.value=d.normalizeUrl(e.value,m.Type.signIn),this.title||(this.title=r.fetch({key:"message_text_swift_signInTitle"}))
	break
	case m.Type.unsupportedType:this.type=m.Type.openUrl,this.title||(this.title=r.fetch({key:"message_text_swift_unsupported_button"})),this.value||(this.value="https://www.skype.com/")}if(this.conversation=t,this.action=this.action.bind(this),!this.isValid()){var p=u.build()
	this.type?this.title?this.value||p.publishInvalidCard(l.invalidCardReasons.MissinActionValue,this.senderId):p.publishInvalidCard(l.invalidCardReasons.MissinActionTitle,this.senderId):p.publishInvalidCard(l.invalidCardReasons.MissingActionType,this.senderId)}}for(var h in m.Type={unknown:"unknown",unsupportedType:"unsupportedType",openUrl:"openUrl",imBack:"imBack",signIn:"signIn",call:"call",showImage:"showImage",payment:"payment",chat:"chat"},m.Type){var v=h.toLowerCase()
	m.Type.hasOwnProperty(h)&&!m.Type.hasOwnProperty(v)&&(m.Type[v]=m.Type[h])}return m.prototype.isValid=function(){return!(!this.type||!this.title||!this.value&&!this.fallbackUri)},m.prototype.isDisabled=function(){return!!this.value&&this.value===d.invalidValue},m.prototype.isSupported=function(){return!!this.type&&this.type!==m.Type.unknown},m.prototype.action=function(){var e=this
	return this.isValid()&&!this.isCalling()?this[this.type]().then((function(){t(e.type,!0,e.senderId)})).catch((function(){t(e.type,!1,e.senderId)})):(t(this.type,!1,this.senderId),Promise.resolve())
	function t(e,t,n){u.build().publishCardAction(e,t,n)}},m.prototype[m.Type.openUrl]=function(){var e
	return this.value.match(/^skype:.*\?chat$/)?this.chat():this.value.match(/^skype:/)?this.call():((e=window.open()).opener=null,e.location=this.value,Promise.resolve())},m.prototype[m.Type.payment]=function(){if(this.value){var e=window.open(this.value,"_blank","width=600, height=620, menubar=no, status=no, titlebar=no, toolbar=no, rel=noopener noreferrer")
	return e&&window.focus&&e.focus(),e.opener=null,Promise.resolve()}},m.prototype[m.Type.showImage]=m.prototype[m.Type.openUrl],m.prototype[m.Type.signIn]=m.prototype[m.Type.openUrl],m.prototype[m.Type.imBack]=function(){return this.conversation.chatService._sendMessageWithoutSanitization(this.value)},m.prototype[m.Type.call]=function(){var e=this.value.match(/^(skype|tel):(.*)$/),r=this,o="skype"===e[1],a=e[2]
	if(o){var c=t.get().personsAndGroupsManager.createPersonSearchQuery(),l=i.searchScope.All
	return c.sources(l).keywords.id=a,this.isCalling(!0),c.getMore().then((function(){var e=c.results().length?c.results(0).result:void 0
	if(r.isCalling(!1),e&&e.id()===a)return u(e._type()+":"+e.id())}))}return u(s.contactTypes.PSTN+":"+a)
	function u(e){var i=t.get().conversationsManager._getOrCreateConversation(e)
	if(!o){var r=i.participants(0),s=r&&r.person.phoneNumbers(0)?r.person.phoneNumbers(0).telUri():a
	r.audio.endpoint&&r.audio.endpoint(s)}return n.placeCall(i,!1,"swiftCardAction",!0)}},m.prototype[m.Type.chat]=function(){var e=this.value.match(/^(skype):(.*)\?chat$/),n=t.get(),r="skype"===e[1],o=null!==e[2].match(/^19:/),a=e[2]
	if(o){var s=n.conversationsManager.getConversationByUri(a)
	return new Promise((function(){return d(s)}))}if(r){var l=t.get().personsAndGroupsManager.createPersonSearchQuery(),u=i.searchScope.All
	return l.sources(u).keywords.id=a,l.getMore().then((function(){var e=l.results().length?l.results(0).result:void 0
	if(e&&e.id()===a){return d(n.conversationsManager.getConversation(e))}}))}function d(e){n.conversationsManager.conversations.add(e),f.publish(p.navigation.OPEN_CONVERSATION,{model:e,origin:c.telemetry.historyLoadOrigin.AUTHOR_SWITCH})}},{build:function(e,t,n){return new m(e,t,n)},Type:m.Type}})),define("ui/viewModels/chat/messageParsers/swift/fact",["require","ui/viewModels/chat/messageParsers/swift/utils"],(function(e){var t=e("ui/viewModels/chat/messageParsers/swift/utils")
	function n(e){this.key=t.normalizeRichText(e.key),this.value=t.normalizeRichText(e.value)}return n.prototype.isValid=function(){return!!this.key||!!this.value},{build:function(e){return new n(e)}}})),define("ui/viewModels/chat/messageParsers/swift/image",["require","ui/viewModels/chat/messageParsers/swift/action","vendor/knockout","swx-constants","utils/common/styleModeHelper","ui/viewModels/chat/messageParsers/swift/utils","swx-i18n","experience/settings","utils/common/rtlChecker"],(function(e){var t=e("ui/viewModels/chat/messageParsers/swift/action"),n=e("vendor/knockout"),i=e("swx-constants").COMMON.styleMode,r=e("utils/common/styleModeHelper"),o=e("ui/viewModels/chat/messageParsers/swift/utils"),a=o.ContentType,s=e("swx-i18n").localization,c=e("experience/settings"),l=e("utils/common/rtlChecker"),u={narrow:{},default:{},carouselDefault:{},carouselNarrow:{}},d="auto",p="px",f=[c.amdServiceHost,c.pesCDNAuthentication.cdnServiceHost]
	function m(e,i,r,a){this.contentType=a,this.alt=o.normalizeRichText(e.alt),this.url=function(e){var t,n,i,r=c.urlPServiceHost+"/v1/url/content?url="
	return e.url?(-1!==e.url.indexOf(f[0])||-1!==e.url.indexOf(f[1])?i=o.normalizeUrl(e.url):-1===e.url.indexOf(r)?i=r+encodeURIComponent(e.url):(t=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"),n=new RegExp(t,"g"),i=r+encodeURIComponent(e.url.replace(n,""))),i):null}(e),this.tap=null,e.tap&&(this.tap=o.getItemIfNotDisabled(t.build(e.tap,i,r)),this.tap&&this.tap.type===t.Type.showImage&&!this.tap.value&&(this.tap.value=this.url)),this.naturalSize=n.observable({height:0,width:0}),this.uiSize=n.pureComputed(this.getUiSize.bind(this)),this.bottomAlignment=n.observable(),this.leftAlignment=n.observable(),this.rightAlignment=n.observable(),this.isImageInCarousel=n.observable(!1),this.url&&this.loadImageSize()}return u.narrow[a.hero]={height:105,width:188},u.default[a.hero]={height:153,width:272},u.carouselDefault[a.hero]={height:145,width:256},u.carouselNarrow[a.hero]={height:105,width:188},u.narrow[a.thumb]={height:76,width:76},u.default[a.thumb]={height:112,width:112},u.carouselDefault[a.thumb]={height:112,width:112},u.carouselNarrow[a.thumb]={height:76,width:76},u.narrow[a.receipt]={height:76,width:76},u.default[a.receipt]={height:112,width:112},u.narrow[a.animation]={height:97,width:172},u.default[a.animation]={height:153,width:272},u.carouselDefault[a.animation]={height:153,width:272},u.carouselNarrow[a.animation]={height:97,width:172},u.narrow[a.audio]={height:97,width:172},u.default[a.audio]={height:153,width:272},u.carouselDefault[a.audio]={height:153,width:272},u.carouselNarrow[a.audio]={height:97,width:172},u.narrow[a.flex]={height:105,width:188},u.default[a.flex]={height:153,width:272},u.carouselDefault[a.flex]={height:145,width:256},u.carouselNarrow[a.flex]={height:105,width:188},m.prototype.isValid=function(){return!!this.url},m.prototype.loadImageSize=function(){var e=this,t=new Image
	t.onload=function(){e.naturalSize({height:t.naturalHeight,width:t.naturalWidth})},t.src=this.url},m.prototype.getUiSize=function(){var e=this,t=r.get().currentMode(),n=function(e,t,n){return(t!==i.NARROW?n?u.carouselDefault:u.default:n?u.carouselNarrow:u.narrow)[e]}(this.contentType,t,this.isImageInCarousel()),o=this.naturalSize(),s={height:0,width:0}
	if(0===o.height||0===o.width||0===n.height)return s
	var c=n.width/n.height,f=o.width/o.height
	function m(){var t=s.width/-2+p
	l.isRtl()?(e.leftAlignment(d),e.rightAlignment(t)):(e.leftAlignment(t),e.rightAlignment(d))}function h(){var t=(s.height-n.height)/2+p
	e.bottomAlignment(t)}switch(this.contentType){case a.hero:f<c?(s.width=n.width,s.height=o.height*n.width/o.width,h()):(s.height=n.height,s.width=o.width*n.height/o.height),m()
	break
	case a.animation:case a.audio:f<c?function(){if(o.height<o.width)s.width=n.width,s.height=o.height*n.width/o.width
	else{s.width=o.width*n.height/o.height,s.height=o.height*n.height/o.height
	var t=(n.width-s.width)/2+p
	l.isRtl()?e.rightAlignment(t):e.leftAlignment(t)}}():(s.height=n.height,s.width=o.width*n.height/o.height)
	break
	case a.thumb:f<c?(s.height=n.height,s.width=s.height*f):f===c?(s.height=n.height,s.width=o.width*n.height/o.height):(s.width=n.width,s.height=s.width/f),h(),m()
	break
	case a.receipt:f<c?(s.height=n.height,s.width=s.height*f):f===c?(s.height=n.height,s.width=o.width*n.height/o.height):(s.width=n.width,s.height=s.width/f),m()
	break
	case a.flex:f<=c?1===f?(s.height=n.height,s.width=n.height):(s.width=n.width,s.height=o.height*n.width/o.width,h(),m()):(s.height=n.height,s.width=o.width*n.height/o.height,m())}return s},m.prototype.getTitleByType=function(){var e=this
	switch(this.tap.type){case t.Type.call:case t.Type.imBack:return n()
	case t.Type.openUrl:return n()+"\n\n"+this.tap.value
	case t.Type.showImage:return(this.alt?this.alt+" ":"")+i(this.tap.title)}function n(){var t=s.fetch({key:"accessibility_swift_action_prefix",params:{swiftAction:i(e.tap.title)}})
	return(e.alt?e.alt+" ":"")+t}function i(e){return e[0].toLowerCase()+e.substring(1)}},{build:function(e,t,n,i){return new m(e,t,n,i)},_prototype:m.prototype}})),define("ui/viewModels/chat/messageParsers/swift/section",["require","ui/viewModels/chat/messageParsers/swift/action","swx-i18n","ui/viewModels/chat/messageParsers/swift/image","ui/viewModels/chat/messageParsers/swift/utils"],(function(e){var t=e("ui/viewModels/chat/messageParsers/swift/action"),n=e("swx-i18n").localization,i=e("ui/viewModels/chat/messageParsers/swift/image"),r=e("ui/viewModels/chat/messageParsers/swift/utils")
	function o(e,n,o,a){var s=i.build(e.image||{},n,o,a)
	this.title=r.normalizeRichText(e.title),this.subtitle=r.normalizeRichText(e.subtitle),this.text=r.normalizeRichText(e.text),this.price=r.normalizeRichText(e.price),this.images=r.filterOutNotValidItems(e.images,(function(e){return i.build(e,n,o,a)})),0===this.images.length&&s.isValid()&&this.images.push(s),this.tap=e.tap?r.getItemIfNotDisabled(t.build(e.tap,n,o)):null,this.expandedText=function(){return this.title&&this.subtitle?"":this.title||this.subtitle?"expandedTextOnce":"expandedTextTwice"}}return o.prototype.isValid=function(){return!!this.title||!!this.subtitle||!!this.text||0!==this.images.length},o.prototype.getTitleByType=function(){var e=this
	switch(this.tap.type){case t.Type.call:case t.Type.imBack:return i()
	case t.Type.openUrl:return i()+"\n\n"+this.tap.value}function i(){return n.fetch({key:"accessibility_swift_action_prefix",params:{swiftAction:(t=e.tap.title,t[0].toLowerCase()+t.substring(1))}})
	var t}},{build:function(e,t,n,i){return new o(e,t,n,i)}}})),define("ui/viewModels/chat/messageParsers/swift/content",["require","lodash-compat","ui/viewModels/chat/messageParsers/swift/action","ui/viewModels/chat/messageParsers/swift/fact","ui/viewModels/chat/messageParsers/swift/section","ui/viewModels/chat/messageParsers/swift/utils","vendor/knockout","swx-i18n","swx-constants","ui/viewModels/chat/messageParsers/swift/image","ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry","ui/modelHelpers/personHelper"],(function(e){var t=e("lodash-compat"),n=e("ui/viewModels/chat/messageParsers/swift/action"),i=e("ui/viewModels/chat/messageParsers/swift/fact"),r=e("ui/viewModels/chat/messageParsers/swift/section"),o=e("ui/viewModels/chat/messageParsers/swift/utils"),a=e("vendor/knockout"),s=e("swx-i18n").localization,c=e("swx-constants").COMMON.telemetry.swiftCard,l=e("ui/viewModels/chat/messageParsers/swift/image"),u=e("ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry"),d=e("ui/modelHelpers/personHelper"),p=o.ContentType,f="video",m="audio",h="animation"
	function v(e){switch(e.length){case 2:return!t.every(e,(function(e){return e.title.length<=11}))
	case 3:return!t.every(e,(function(e){return e.title.length<=5}))}return!0}function g(e,t,i,a){this.type=a,this.buttons=o.filterOutDisabledItems(e.buttons,(function(e){return n.build(e,t,i)})),this.tap=e.tap?o.getItemIfNotDisabled(n.build(e.tap,t,i)):null,this.mainSection=r.build(e,t,i,a)
	var s=this.computeButtonsLimit()
	this.buttons.length>s&&(this.buttons=this.buttons.slice(0,s)),this.areButtonsMultiLine=v(this.buttons)
	var l=u.build()
	this.isValid()||(this.mainSection.isValid()?l.publishInvalidCard(c.invalidCardReasons.InvalidButton,i.id()):l.publishInvalidCard(c.invalidCardReasons.MainSectionNotValid,i.id())),this.isSupported()||l.publishUnsupportedCard(c.unsupportedCardReasons.ContentUnsupportedButton,i.id())}function y(e,t,i,r){this.type=r,this.buttons=o.filterOutDisabledItems(e.buttons,(function(e){return n.build(e,t,i)})),this.title=e.title?o.normalizeRichText(e.title):null,this.subtitle=e.subtitle?o.normalizeRichText(e.subtitle):null,this.text=e.text?o.normalizeRichText(e.text):null,this.tap=e.tap?o.getItemIfNotDisabled(n.build(e.tap,t,i)):null,this.images=o.filterOutNotValidItems(e.images,(function(e){return l.build(e,t,i,r)}))
	var a=this.computeButtonsLimit()
	this.buttons.length>a&&(this.buttons=this.buttons.slice(0,a)),this.areButtonsMultiLine=v(this.buttons),this.expandedText=function(){return this.title&&this.subtitle?"":this.title||this.subtitle?"expandedTextOnce":"expandedTextTwice"}
	var s=u.build()
	this.isValid()||s.publishInvalidCard(c.invalidCardReasons.InvalidButton,i.id()),this.isSupported()||s.publishUnsupportedCard(c.unsupportedCardReasons.ContentUnsupportedButton,i.id())}function b(e,t,i,r){var a
	this.type=r,this.autoloop=e.autoloop,this.autostart=!(t.isGroupConversation()&&!d.isKnownPerson(i)||(a=i,!(d.isAgent(a)&&a.capabilities._mediaAutoplay&&a.capabilities._mediaAutoplay())))&&e.autostart,this.shareable=e.shareable,this.subtitle=e.subtitle?o.normalizeText(e.subtitle):null,this.title=e.title?o.normalizeText(e.title):null,this.image=l.build(e.image||{},t,i,r),this.aspect=e.aspect&&"9:16"===e.aspect?"portrait":"landscape",this.hasThumbnail=function(){return!!this.image&&!!this.image.url}
	var s={},g=e.media&&e.media.length&&e.media[0],y=g?o.normalizeUrl(g.url):null
	if(g)switch(r){case p.video:s[f]=y
	break
	case p.audio:s[m]=y
	break
	case p.animation:s[h]=l.build(g||{},t,i,r)}this.media=s,this.mediaSourceDomain=y?function(e){return e.replace(/^(https?:\/\/)?(w*\.)?/i,"").split("/")[0]}(y):null,this.buttons=o.filterOutDisabledItems(e.buttons,(function(e){return n.build(e,t,i)})),this.areButtonsMultiLine=v(this.buttons),this.hasTextInfo=function(){return!!this.title||!!this.subtitle}
	var b=u.build()
	this.isValid()||b.publishInvalidCard(c.invalidCardReasons.MediaCardMissingSrc,i.id())}function _(e,i,r){this.type=p.signIn,this.buttons=o.filterOutDisabledItems(e.buttons,(function(e){return n.build(e,i,r)}))
	var a=t.find(this.buttons,(function(e){return e.type===n.Type.signIn}))
	if(this.buttons=a?[a]:[],this.text=o.normalizeRichText(e.text),!this.isValid()){var s=u.build()
	0===this.buttons.length?s.publishInvalidCard(c.invalidCardReasons.SignInMissingButtons,r.id()):this.text||s.publishInvalidCard(c.invalidCardReasons.SignInMissingText,r.id())}}function E(e,t,l){var d=this,f=[]
	this.type=p.receipt,this.buttons=o.filterOutDisabledItems(e.buttons,(function(e){return n.build(e,t,l)})),this.buttons.length>3&&(this.buttons=this.buttons.slice(0,3)),this.areButtonsMultiLine=v(this.buttons),this.tap=e.tap?n.build(e.tap,t,l):null,this.title=o.normalizeRichText(e.title),this.total=o.normalizeText(e.total),this.tax=o.normalizeText(e.tax),this.vat=o.normalizeText(e.vat),this.facts=o.filterOutNotValidItems(e.facts,(function(e){return i.build(e,t)})),this.items=o.filterOutNotValidItems(e.items,(function(e){return r.build(e,t,l,p.thumb)})),this.displayedItems=a.observableArray(),this.showFoldButton=a.observable(!1),this.isCollapsed=a.observable(!1),this.foldButtonText=a.observable(),function(){for(var e=0,t=0;t<d.items.length;t++){if(e>=5)return
	f.push(d.items[t]),d.items[t].images.length>0?e+=3:e++}f=[]}(),f.length>0?(this.showFoldButton(!0),d.isCollapsed(!0),h()):this.displayedItems(this.items)
	var m=u.build()
	function h(){d.displayedItems(f),d.foldButtonText(s.fetch({key:"message_text_swift_showAll"}))}this.isValid()||(this.total?m.publishInvalidCard(c.invalidCardReasons.ReceiptInvalidButton,l.id()):m.publishInvalidCard(c.invalidCardReasons.ReceiptMissingTotal,l.id())),this.isSupported()||m.publishUnsupportedCard(c.unsupportedCardReasons.ReceiptUnsupportedButton,l.id()),this.triggerFoldAction=function(){d.isCollapsed(!d.isCollapsed()),d.isCollapsed()?h():(d.displayedItems(d.items),d.foldButtonText(s.fetch({key:"message_text_swift_showLess"})))}}return g.prototype.computeButtonsLimit=function(){if(this.type===p.thumb)return 3
	var e=3
	return 0===this.mainSection.images.length&&(e+=2),this.mainSection.text||(e++,this.mainSection.title||e++,this.mainSection.subtitle||e++),Math.min(e,6)},g.prototype.isValid=function(){return 0!==this.buttons.length?t.every(this.buttons,(function(e){return e.isValid()})):this.mainSection.isValid()},g.prototype.isSupported=function(){return(this.tap&&this.tap.isSupported()||!this.tap)&&t.every(this.buttons,(function(e){return e.isSupported()}))},y.prototype.isValid=function(){return!!this.title||!!this.subtitle||!!this.text||0!==this.images.length&&t.every(this.images,(function(e){return e.isValid()}))},y.prototype.isSupported=function(){return this.isValid()},y.prototype.computeButtonsLimit=function(){if(this.type===p.thumb)return 3
	var e=3
	return 0===this.images.length&&(e+=2),this.text||(e++,this.title||e++,this.subtitle||e++),Math.min(e,6)},b.prototype.isValid=function(){return!!(this.media&&(this.media.video||this.media.audio||this.media.animation&&this.media.animation.url))},b.prototype.isSupported=function(){return this.isValid()},_.prototype.isValid=function(){return 0!==this.buttons.length&&!!this.text},_.prototype.isSupported=function(){return this.isValid()},E.prototype.isValid=function(){return!!this.total&&t.every(this.buttons,(function(e){return e.isValid()}))},E.prototype.isSupported=function(){return(this.tap&&this.tap.isSupported()||!this.tap)&&t.every(this.buttons,(function(e){return e.isSupported()}))},{main:{build:function(e,t,n,i){return new g(e,t,n,i)}},receipt:{build:function(e,t,n){return new E(e,t,n)}},signIn:{build:function(e,t,n){return new _(e,t,n)}},media:{build:function(e,t,n,i){return new b(e,t,n,i)}},flex:{build:function(e,t,n,i){return new y(e,t,n,i)}}}})),define("ui/viewModels/chat/messageParsers/swift/card",["require","ui/viewModels/chat/messageParsers/swift/content","ui/viewModels/chat/messageParsers/swift/content","ui/viewModels/chat/messageParsers/swift/content","ui/viewModels/chat/messageParsers/swift/content","ui/viewModels/chat/messageParsers/swift/content","ui/viewModels/chat/messageParsers/swift/utils","swx-constants","ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry"],(function(e){var t=e("ui/viewModels/chat/messageParsers/swift/content").main,n=e("ui/viewModels/chat/messageParsers/swift/content").receipt,i=e("ui/viewModels/chat/messageParsers/swift/content").signIn,r=e("ui/viewModels/chat/messageParsers/swift/content").media,o=e("ui/viewModels/chat/messageParsers/swift/content").flex,a=e("ui/viewModels/chat/messageParsers/swift/utils"),s=e("swx-constants").COMMON.telemetry.swiftCard,c=e("ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry"),l=a.ContentType
	function u(e,u,d,p){this.contentType=a.normalizeEnum(e.contentType,l,l.unknown),this.messageId=d.clientmessageid,this.conversationId=u.conversationId,this.content=null
	var f=c.build()
	if(!e.content)return this.isValid()||f.publishInvalidCard(s.invalidCardReasons.CardMissingContent,p.id()),void(this.isSupported()||f.publishUnsupportedCard(s.unsupportedCardReasons.CardUnsupportedType,p.id()))
	switch(this.contentType){case l.hero:case l.thumb:this.content=t.build(e.content,u,p,this.contentType)
	break
	case l.signIn:this.content=i.build(e.content,u,p)
	break
	case l.receipt:this.content=n.build(e.content,u,p)
	break
	case l.audio:case l.video:case l.animation:this.content=r.build(e.content,u,p,this.contentType)
	break
	case l.flex:this.content=o.build(e.content,u,p,this.contentType)}this.isSupported()||this.contentType!==l.unknown||f.publishUnsupportedCard(s.unsupportedCardReasons.CardUnsupportedType,p.id())}return u.prototype.isValid=function(){return this.contentType!==l.unknown&&this.content&&this.content.isValid()||this.contentType===l.unknown},u.prototype.isSupported=function(){return this.contentType!==l.unknown&&(!this.content||this.content.isSupported())},{build:function(e,t,n,i){return new u(e,t,n,i)}}})),define("ui/viewModels/chat/messageParsers/swift/swift",["require","ui/viewModels/chat/messageParsers/swift/action","lodash-compat","ui/viewModels/chat/messageParsers/swift/card","vendor/knockout","ui/viewModels/chat/messageParsers/swift/utils","swx-constants","ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry","utils/common/styleModeHelper","ui/modelHelpers/personHelper","utils/common/rtlChecker"],(function(e){var t=e("ui/viewModels/chat/messageParsers/swift/action"),n=e("lodash-compat"),i=e("ui/viewModels/chat/messageParsers/swift/card"),r=e("vendor/knockout"),o=e("ui/viewModels/chat/messageParsers/swift/utils"),a=e("swx-constants").COMMON,s=a.telemetry.swiftCard,c=e("ui/viewModels/chat/messageParsers/swift/telemetry/swiftCardTelemetry"),l=e("utils/common/styleModeHelper"),u=e("ui/modelHelpers/personHelper"),d=e("utils/common/rtlChecker"),p="auto"
	function f(e,m,h,v){var g=c.build()
	if(this.summary=o.normalizeText(e.summary),this.type=e.type?o.normalizeEnum(e.type,f.Type,f.Type.unknown):null,this.cards=o.mapArray(e.attachments,(function(e){return i.build(e,m,h,v)})),this.isValid()){if(this.isSupported()||(this.button=t.build({type:t.Type.unsupportedType},m,v),this.type===f.Type.unknown&&g.publishUnsupportedCard(s.unsupportedCardReasons.SwiftUnknownType,v.id())),e.suggestedActions&&e.suggestedActions.actions){var y=!0,b=e.suggestedActions.to&&e.suggestedActions.to.length>0
	m.isGroupConversation()&&b&&(y=e.suggestedActions.to.some(u.isMePersonId)),y&&o.mapArray(e.suggestedActions.actions,(function(e){h.suggestedActions.push(t.build(e,m,v))}))}this.areButtonsMultiLine=!n.every(this.cards,(function(e){return e.content&&e.isValid()&&!1===e.content.areButtonsMultiLine})),this.isFirst=r.observable(!0),this.isLast=r.observable(1===this.cards.length),this.selectedCard=r.observable(0),this.isMultiple=r.observable(this.cards.length>1),this.isMultiple()&&n.each(this.cards,(function(e){e.isValid()&&e.content&&(e.content.mainSection?n.each(e.content.mainSection.images,(function(e){e.isImageInCarousel(!0)})):e.content.media&&e.content.media.animation&&e.content.media.animation.isImageInCarousel(!0))})),this.calculatePosition=function(){var e=288
	return l.get().currentMode()===a.styleMode.NARROW&&(e=188),this.isFirst()?"0px":this.isLast()?"calc("+this.selectedCard()*-e+"px + (100% - "+e+"px))":"calc("+this.selectedCard()*-e+"px + (100% - "+e+"px) / 2)"},this.carouselLeftPosition=function(){return d.isRtl()?p:this.calculatePosition()},this.carouselRightPosition=function(){return d.isRtl()?this.calculatePosition():p}}else this.type?0===this.cards.length&&g.publishInvalidCard(s.invalidCardReasons.SwiftMissingCards,v.id()):g.publishInvalidCard(s.invalidCardReasons.SwiftMissingType,v.id())}return f.prototype.isSupported=function(){return this.isValid()&&this.type!==f.Type.unknown&&n.every(this.cards,(function(e){return e.isSupported()}))},f.prototype.isValid=function(){return!!this.type&&0!==this.cards.length&&n.every(this.cards,(function(e){return e.isValid()}))},f.prototype.isCarousel=function(){return this.type===f.Type.carousel},f.prototype.nextCard=function(){this.moveTo(this.selectedCard()+1)},f.prototype.prevCard=function(){this.moveTo(this.selectedCard()-1)},f.prototype.moveTo=function(e){e<0||e>=this.cards.length||(this.selectedCard(e),this.isFirst(0===e),this.isLast(e===this.cards.length-1))},f.prototype.moveToCard=function(e){this.moveTo(this.cards.indexOf(e))},f.Type={unknown:"Unknown",card:"Card",carousel:"Carousel",signIn:"SignIn",receipt:"Receipt"},f.Type["message/card"]=f.Type.card,f.Type["message/card.carousel"]=f.Type.carousel,f.Type["message/card.signin"]=f.Type.signIn,f.Type["message/card.receipt"]=f.Type.receipt,{build:function(e,t,n,i){return new f(e,t,n,i)},Type:f.Type}})),define("ui/viewModels/chat/messageParsers/skypeSwiftProcessor",["require","exports","module","ui/viewModels/chat/messageParsers/swift/swift"],(function(e,t){var n=e("ui/viewModels/chat/messageParsers/swift/swift")
	function i(e,t){this.conversation=e,this.message=t}i.prototype.process=function(e,t){return n.build(e,this.conversation,this.message,t)},t.build=function(e,t){return new i(e,t)}})),define("ui/viewModels/chat/messageParsers/swiftCard",["require","exports","module","lodash-compat","vendor/knockout","ui/viewModels/chat/messageParsers/skypeSwiftProcessor","swx-utils-chat"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("ui/viewModels/chat/messageParsers/skypeSwiftProcessor"),o=e("swx-utils-chat").messageSanitizer
	t.parse=function(e,t,a){var s=/^<swiftcard/i.test(t._originalContent)?t._originalContent:t.html()
	if(/^<swiftcard/i.test(s)){var c,l,u,d,p=(new DOMParser).parseFromString(s,"text/xml")
	if(c=n.find(p.childNodes,(function(e){return"swiftcard"===e.nodeName.toLocaleLowerCase()}))){if(!(l=n.find(c.attributes,(function(e){return"swift"===e.nodeName.toLocaleLowerCase()}))))return i.observable(o.getMessageSanitizedContent(c.textContent))
	try{d=decodeURIComponent(l.textContent)}catch(m){if("URI malformed"!==m.message)return i.observable(o.getMessageSanitizedContent(c.textContent))
	d=l.textContent}try{u=JSON.parse(d)}catch(m){return i.observable(o.getMessageSanitizedContent(c.textContent))}var f=r.build(a,e).process(u,t.sender)
	return e.isDisjoined=!0,e.contentTemplate="swiftCardMessageContentTemplate",e.swift=f,e.customMessageClasses="swiftCard "+(f.isSupported()?f.type.toLowerCase():"unsupported")+(f.isValid()?"":" invalid"),n.isUndefined(f.cards)||(e.customMessageClasses+=1===f.cards.length?" single":"",e.customMessageClasses+=2===f.cards.length?" double":""),i.observable(o.getMessageSanitizedContent(c.textContent))}}}})),define("ui/viewModels/chat/translator/translationItem",["require","exports","module","swx-service-locator-instance","swx-constants","swx-i18n","vendor/knockout","swx-utils-chat","telemetry/translator/translatorTelemetry","ui/modelHelpers/personHelper","utils/chat/translatorHelper"],(function(e,t){var n=e("swx-service-locator-instance").default,i=e("swx-constants").COMMON,r=e("swx-i18n").localization,o=e("vendor/knockout"),a=e("swx-utils-chat").messageSanitizer,s=i.telemetry.translator,c=e("telemetry/translator/translatorTelemetry"),l=e("ui/modelHelpers/personHelper"),u=e("utils/chat/translatorHelper")
	function d(e,t){var d,p,f=this,m=n.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.TRANSLATOR_SENDING_ENABLED),h=r.fetch({key:"button_translations_see_original_message"}),v=r.fetch({key:"button_translations_see_translated_message"}),g=e.model.translations,y=e.model.direction&&e.model.direction()===i.chat.messageType.OUTGOING,b=t._translatorSettings,_=y?s.eventType.OUTGOING:s.eventType.INCOMING,E=c.build()
	function w(){return b&&b.isEnabled}function S(){return!y&&w()}function x(){if(!g().length)return f.isRemoved(!0),void f.visible(!1)
	g.each((function(e){var n=e.key,i=e.users&&e.users[0],r=i&&i.value,o=i&&i.mri,c=r===f.translationText()
	if(n&&r&&!c){if(a.isMessageWithEmoticonsOnly(r)||a.isMessageWithMentionOnly(r))return f.visible(!1),void f.translationText("")
	f.isRemoved(!1),y?function(e,t){var n=a.getMessageSanitizedContent(e)
	l.isMePersonId(t)&&(f.translationText(n),f.visible(!0),E.send(_,{action:s.action.SHOW,success:!0}))}(r,o):function(e,n){var i=u.extractLanguageKey(n)
	w()||f.translationText(e),u.isMatchingMyLanguage(i,t._translatorSettings)&&(f.translationText(e),f.visible(!0)),E.send(_,{action:s.action.SHOW,success:!0})}(r,n)}}))}f.init=function(){f.isRemoved=o.observable(!1),f.visible=o.observable(!1),f.translationText=o.observable(""),f.isEnabled=o.pureComputed((function(){return m&&!f.isRemoved()&&!!f.translationText()})),f.toggle=function(){var e=S()?f.visible()?s.action.CLICK_SEE_ORIGINAL:s.action.CLICK_SEE_TRANSLATION:f.visible()?s.action.CLICK_SEE_TRANSLATION:s.action.CLICK_SEE_ORIGINAL
	f.visible(!f.visible()),E.send(_,{action:e})},f.toggleText=o.pureComputed((function(){return S()?f.visible()?h:v:f.visible()?v:h})),m&&(g&&(p=g.observe(x)),e.model.isDeleted&&(d=e.model.isDeleted.changed((function(e){f.isRemoved(e),f.visible(!1)}))))},f.dispose=function(){d&&d.dispose(),p&&p.dispose()}}t.build=function(e,t){return new d(e,t)}})),define("services/pes/constants",["require","lodash-compat","swx-browser-detect"],(function(e){var t=e("lodash-compat"),n=e("swx-browser-detect").default
	return new function(){var e=t.once((function(){return n.getScreenInfo().pixelRatio>1}))
	this.CACHE_KEY="swx|pes",this.SAVED_DATA_VERSION="v1.0",this.FEATURED_IN_PREFIX="FeaturedIn-",this.itemTypes={typeKeyName:"type",tab:{id:"tab",ariaLabelLocKey:"expressionPicker_mruTab_ariaLabel",titleLocKey:"expressionPicker_mruTab_title"},emoticon:{id:"emoticon",ariaLabelLocKey:"expressionPicker_mruEmoticonPack_ariaLabel",titleLocKey:"expressionPicker_mruEmoticonPack_title",mruLimit:27},moji:{id:"flik",ariaLabelLocKey:"expressionPicker_mruMojiPack_ariaLabel",titleLocKey:"expressionPicker_mruMojiPack_title",mruLimit:10},image:{id:"image"},message:{id:"message"},sticker:{id:"sticker"}},this.isHighDpi=e,this.itemTypes.flik=this.itemTypes.moji,this.mru={TAB_ID:"mru",PACK_PREFIX:"mru:"},this.bingSearch={TAB_ID:"bing",PACK_PREFIX:"bing:"},this.giphyImageSearch={TAB_ID:"giphyImages",PACK_PREFIX:"giphy-imh:"},this.localSearch={TAB_ID:"localSearch",PACK_PREFIX:"local:",titleLocKey:"expressionPicker_localSearchPack_title",ariaLabelLocKey:"expressionPicker_localSearchPack_ariaLabel"},this.frameHeights={emoticons:{SMALL:20,LARGE:40,EXTRA_LARGE:80},moji:{THUMBNAIL:40,KEYFRAME:80},packs:{TAB:19}},this.profiles={emoticons:{getSmall:function(){return e()?"default_40":"default_20"},getLarge:function(){return e()?"default_80":"default_40"},getExtraLarge:function(){return e()?"default_160":"default_80"},getSmallAnimated:function(){return e()?"default_40_anim":"default_20_anim"},getLargeAnimated:function(){return e()?"default_80_anim":"default_40_anim"},getExtraLargeAnimated:function(){return e()?"default_160_anim":"default_80_anim"}},moji:{thumbnail:"thumbnail",content:"default"}}}})),define("ui/viewModels/chat/reactions",["require","exports","module","vendor/knockout","lodash-compat","swx-service-locator-instance","swx-constants","services/pes/constants","experience/settings","utils/common/cafeObservable"],(function(e,t){var n=e("vendor/knockout"),i=e("lodash-compat"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("services/pes/constants"),s=e("experience/settings"),c=e("utils/common/cafeObservable")
	function l(e){var t=this,l=r.resolve(o.serviceLocator.FEATURE_FLAGS),u="https://"+s.pesCDNAuthentication.cdnServiceHost+"/pes/v1/emoticons/",d=a.profiles.emoticons.getSmall()
	t.enabled=n.observable(l.isFeatureOn(o.featureFlags.REACTIONS_SUPPORT_ENABLED)),t.reactions=t.enabled()&&e.model.emotions?c.newObservableCollection(e.model.emotions):n.observableArray(),t.reactionsCount=n.computed((function(){return t.reactions().length})),t.dummyReaction="reactionsConsumptionHorizon",t.showHighDpiClass=a.isHighDpi(),t.getEmoticonUrl=function(e){return e?'url("'+(u+e+"/views/"+d+'")'):""},t.getUserListNames=function(e){var n="",r=i.find(t.reactions(),(function(t){return t.key===e})),o=[]
	return r&&r.users.forEach((function(e){e.person.displayName&&o.push(e.person.displayName())})),o.length>0&&(n=o.join("\n")),n},t.dispose=function(){t.reactionsCount.dispose()}}t.build=function(e){return new l(e)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/msrcrypto.aes",["require","exports"],e)}((function(){var e=e||function(){var e={register:function(t,n,i){e[t]||(e[t]={})
	var r=e[t]
	r[n]||(r[n]=i)},exists:function(t,n){return!!e[t]&&!!e[t][n]}},t=function(){if("undefined"!=typeof document)try{throw new Error}catch(t){if(t.stack){var e=/\w+:\/\/(.+?\/)*.+\.js/.exec(t.stack)
	return e&&e.length>0?e[0]:null}}else if("undefined"!=typeof self)return self.location.href
	return null}(),n="undefined"!=typeof Worker,i="undefined"!=typeof importScripts,r="undefined"!=typeof Uint8Array,o=function(){try{return Object.defineProperty({},"oncomplete",{}),!0}catch(e){return!1}}(),a=n,s=function(e,t,n,i,r){if(o){var a={}
	i&&(a.get=i),r&&(a.set=r),Object.defineProperty(e,t,a)}else e[t]=n},c={},l=function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t="undefined"!=typeof btoa
	function n(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4!=0;)t+="="
	var n,i,r,o,a,s,c,l=[]
	for(t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),c=0;c<t.length;c+=4)n=e.indexOf(t.charAt(c))<<2|(o=e.indexOf(t.charAt(c+1)))>>4,i=(15&o)<<4|(a=e.indexOf(t.charAt(c+2)))>>2,r=(3&a)<<6|(s=e.indexOf(t.charAt(c+3))),l.push(n),64!==a&&l.push(i),64!==s&&l.push(r)
	return l}function i(e){return Object.prototype.toString.call(e).slice(8,-1)}function r(e){return[e>>>24&255,e>>>16&255,e>>>8&255,255&e]}return{toBase64:function(n,i){var r,o,a,s,c,l,u,d,p=""
	if(i||(i=!1),(n.pop||n.subarray)&&(n=String.fromCharCode.apply(null,n)),t)p=btoa(n)
	else for(d=0;d<n.length;d+=3)s=(r=n.charCodeAt(d))>>2,c=(3&r)<<4|(o=n.charCodeAt(d+1))>>4,l=(15&o)<<2|(a=n.charCodeAt(d+2))>>6,u=63&a,isNaN(o)?l=u=64:isNaN(a)&&(u=64),p=p+e.charAt(s)+e.charAt(c)+e.charAt(l)+e.charAt(u)
	return i?p.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,""):p},base64ToString:function(e){if(t){for(e=e.replace(/-/g,"+").replace(/_/g,"/");e.length%4!=0;)e+="="
	return atob(e)}return String.fromCharCode.apply(null,n(e))},base64ToBytes:n,getObjectType:i,bytesToHexString:function(e,t){var n=""
	void 0===t&&(t=!1)
	for(var i=0;i<e.length;i++){t&&i%4==0&&0!==i&&(n+="-")
	var r=e[i].toString(16).toUpperCase()
	1===r.length&&(n+="0"),n+=r}return n},bytesToInt32:function(e,t){return e[t=t||0]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]},stringToBytes:function(e){for(var t=new Array(e.length),n=0;n<t.length;n++)t[n]=e.charCodeAt(n)
	return t},unpackData:function(e,t,i){var r,o=n(e),a=[]
	if(isNaN(t))return o
	for(r=0;r<o.length;r+=t)a.push(o.slice(r,r+t))
	if(i)for(r=0;r<a.length;r++)a[r]=(a[r][0]<<24)+(a[r][1]<<16)+(a[r][2]<<8)+a[r][3]
	return a},hexToBytesArray:function(e){e=e.replace(/\-/g,"")
	for(var t=[];e.length>=2;)t.push(parseInt(e.substring(0,2),16)),e=e.substring(2,e.length)
	return t},int32ToBytes:r,int32ArrayToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t=t.concat(r(e[n]))
	return t},toArray:function(e){return e.pop?e:1===e.length?[e[0]]:function(){var t=6e4,n=[],i=[]
	if(e.length<=t)return Array.apply(null,e)
	for(var r=0,o=e.length;r<o;r+=t)n.push(e.subarray(r,r+t))
	return n.forEach((function(e){i=i.concat(Array.apply(null,e))})),i}()},arraysEqual:function(e,t){var n=!0
	e.length!==t.length&&(n=!1)
	for(var i=0;i<e.length;i++)e[i]!==t[i]&&(n=!1)
	return n},clone:function(e){var t={}
	for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])
	return t},xorVectors:function(e,t){for(var n=Math.min(e.length,t.length),i=new Array(n),r=0;r<n;r+=1)i[r]=e[r]^t[r]
	return i},padEnd:function(e,t,n){for(;e.length<n;)e.push(t)
	return e},padFront:function(e,t,n){for(;e.length<n;)e.unshift(t)
	return e},getVector:function(e,t){t||(t=0)
	for(var n=new Array(e),i=0;i<e;i+=1)n[i]=t
	return n},verifyByteArray:function(e){if("Array"!==i(e))return!1
	for(var t,n=0;n<e.length;n++)if(t=e[n],isNaN(t)||t<0||t>255)return!1
	return!0}}}(),u=function(){function t(e){return i&&self.postMessage(e),e}return{jsCryptoRunner:function(n){var i,r=n.data.operationType
	if(!e.exists(r,n.data.algorithm.name))throw new Error("unregistered algorithm.")
	var o=e[r][n.data.algorithm.name],a=n.data
	return"process"===a.operationSubType?(o(a),i=t({type:"process"})):i=t(o(a)),i}}}()
	i&&(self.onmessage=function(e){if(e.data.prngSeed){var t=e.data.prngSeed
	N.init(t)}else u.jsCryptoRunner(e)})
	var d,p=(d=l,{keyToJwk:function(e,t){var n={}
	if(n.kty=function(e){var t=e.algorithm.name.slice(0,3).toLowerCase()
	return"rsa"===t?"RSA":"ecd"===t?"EC":"oct"}(e),n.extractable=e.extractable,t.pop)n.k=d.toBase64(t,!0)
	else for(var i in t)t[i].pop&&(n[i]=d.toBase64(t[i],!0))
	return e.algorithm.namedCurve&&(n.crv=e.algorithm.namedCurve),function(e){for(var t=[],n=0;n<e.length;n++)t[n]=e.charCodeAt(n)
	return 0===t[t.length-1]&&t.pop(),t}(_stringify(n,null,"\t"))},jwkToKey:function(e,t,n){for(var i=String.fromCharCode.apply(null,e),r=JSON.parse(i),o=0;o<n.length;o+=1){var a=r[n[o]]
	a&&(r[n[o]]=d.base64ToBytes(a))}return r}})
	var f=function(e,t,n,i,r,o,a){var s=l,c=n.slice(),u=new Array(r),d=[],p=0
	function f(e){for(var t=Math.floor(e.length/r),n=0;n<t;n++)o(e,n,c,i,u)
	return p+=t,e.slice(t*r)}function m(){if(0!==f(function(e){var t=r-e.length%r
	t<=r/8&&(t+=r)
	var n=s.getVector(t)
	n[0]=128
	var i=8*(e.length+p*r)
	return n[t-4]=i>>>24&255,n[t-3]=i>>>16&255,n[t-2]=i>>>8&255,n[t-1]=255&i,e.concat(n)}(d)).length)throw new Error("buffer.length !== 0")
	var e=function(){for(var e=[],t=0;t<c.length;t++)e=e.concat(s.int32ToBytes(c[t]))
	return e.length=a/8,e}()
	return d=[],c=n.slice(),p=0,e}return{name:e,computeHash:function(e){return d=f(e),m()},process:function(e){(d=d.concat(e)).length>=r&&(d=f(d))},finish:m,der:t,hashLen:a,maxMessageSize:4294967295}},m=function(){var e=l
	function t(t,n,i,r,o){var a,s,c,l,u,d=4294967295,p=i[0],f=i[1],m=i[2],h=i[3],v=i[4],g=i[5],y=i[6],b=i[7]
	for(s=0;s<16;s++)o[s]=e.bytesToInt32(t,64*n+4*s)
	for(a=16;a<64;a++)l=o[a-15],u=o[a-2],o[a]=((u>>>17|u<<15)^(u>>>19|u<<13)^u>>>10)+o[a-7]+((l>>>7|l<<25)^(l>>>18|l<<14)^l>>>3)+o[a-16],o[a]=o[a]&d
	for(s=0;s<64;s++)h+=c=b+((v>>>6|v<<26)^(v>>>11|v<<21)^(v>>>25|v<<7))+(v&g^~v&y)+r[s]+o[s],c+=((p>>>2|p<<30)^(p>>>13|p<<19)^(p>>>22|p<<10))+(p&(f^m)^f&m),b=y,y=g,g=v,v=h,h=m,m=f,f=p,p=c
	return i[0]+=p&d,i[1]+=f&d,i[2]+=m&d,i[3]+=h&d,i[4]+=v&d,i[5]+=g&d,i[6]+=y&d,i[7]+=b&d,i}var n,i,r,o,a,s=e.unpackData
	return i=s("wQWe2DZ81QcwcN0X9w5ZOf/ACzFoWBURZPmPp776T6Q",4,1),r=s("agnmZ7tnroU8bvNypU/1OlEOUn+bBWiMH4PZq1vgzRk",4,1),n=s("QoovmHE3RJG1wPvP6bXbpTlWwltZ8RHxkj+CpKscXtXYB6qYEoNbASQxhb5VDH3Dcr5ddIDesf6b3AanwZvxdOSbacHvvkeGD8GdxiQMocwt6SxvSnSEqlywqdx2+YjamD5RUqgxxm2wAyfIv1l/x8bgC/PVp5FHBspjURQpKWcntwqFLhshOE0sbfxTOA0TZQpzVHZqCruBwskuknIshaK/6KGoGmZLwkuLcMdsUaPRkugZ1pkGJPQONYUQaqBwGaTBFh43bAgnSHdMNLC8tTkcDLNO2KpKW5zKT2gub/N0j4LueKVjb4TIeBSMxwIIkL7/+qRQbOu++aP3xnF48g",4,1),o=s("MC0wDQYJYIZIAWUDBAIEBQAEHA"),a=s("MDEwDQYJYIZIAWUDBAIBBQAEIA"),{sha224:f("SHA-224",o,i,n,64,t,224),sha256:f("SHA-256",a,r,n,64,t,256)}}()
	void 0!==e&&(m.hash256=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?m.sha256.finish():m.sha256.computeHash(e.buffer)
	m.sha256.process(e.buffer)},m.hash224=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?m.sha224.finish():m.sha224.computeHash(e.buffer)
	m.sha224.process(e.buffer)},e.register("digest","sha-224",m.hash224),e.register("digest","sha-256",m.hash256)),c["sha-224"]=m.sha224,c["sha-256"]=m.sha256
	var h=function(){function e(e,t,n,i,r){var o=t+i|0,a=o>>>0<i>>>0
	r[0]=e+n+a|0,r[1]=o}function t(t,n,i,r,o){var a,s,c,l,u,d,p,f,m,h=[],v=[],g=[],y=i[0],b=i[1],_=i[2],E=i[3],w=i[4],S=i[5],x=i[6],C=i[7],T=i[8],I=i[9],A=i[10],M=i[11],O=i[12],k=i[13],N=i[14],P=i[15]
	for(a=0;a<32;a++)m=128*n+4*a,o[a]=t.slice(m,m+4),o[a]=o[a][0]<<24|o[a][1]<<16|o[a][2]<<8|o[a][3]
	for(a=32;a<160;a+=2)c=((p=o[a-30])>>>1|(f=o[a-29])<<31)^(p>>>8|f<<24)^p>>>7,l=(f>>>1|p<<31)^(f>>>8|p<<24)^(f>>>7|p<<25),e(u=((p=o[a-4])>>>19|(f=o[a-3])<<13)^(f>>>29|p<<3)^p>>>6,d=(f>>>19|p<<13)^(p>>>29|f<<3)^(f>>>6|p<<26),o[a-14],o[a-13],h),e(c,l,h[0],h[1],h),e(o[a-32],o[a-31],h[0],h[1],h),o[a]=h[0],o[a+1]=h[1]
	for(s=0;s<160;s+=2)u=T&A^O&~T,d=I&M^k&~I,e(N,P,c=(T>>>14|I<<18)^(T>>>18|I<<14)^(I>>>9|T<<23),l=(I>>>14|T<<18)^(I>>>18|T<<14)^(T>>>9|I<<23),h),e(u,d,r[s],r[s+1],v),e(h[0],h[1],o[s],o[s+1],g),e(v[0],v[1],g[0],g[1],g),e(g[0],g[1],x,C,h),x=h[0],C=h[1],d=b&(E^S)^E&S,u=y&(_^w)^_&w,e(g[0],g[1],c=(y>>>28|b<<4)^(b>>>2|y<<30)^(b>>>7|y<<25),l=(b>>>28|y<<4)^(y>>>2|b<<30)^(y>>>7|b<<25),h),e(u,d,c=h[0],l=h[1],h),N=O,P=k,O=A,k=M,A=T,M=I,T=x,I=C,x=w,C=S,w=_,S=E,_=y,E=b,y=c=h[0],b=l=h[1]
	return e(i[0],i[1],y,b,h),i[0]=h[0],i[1]=h[1],e(i[2],i[3],_,E,h),i[2]=h[0],i[3]=h[1],e(i[4],i[5],w,S,h),i[4]=h[0],i[5]=h[1],e(i[6],i[7],x,C,h),i[6]=h[0],i[7]=h[1],e(i[8],i[9],T,I,h),i[8]=h[0],i[9]=h[1],e(i[10],i[11],A,M,h),i[10]=h[0],i[11]=h[1],e(i[12],i[13],O,k,h),i[12]=h[0],i[13]=h[1],e(i[14],i[15],N,P,h),i[14]=h[0],i[15]=h[1],i}var n,i,r,o,a,s,c,u=l.unpackData
	return n=u("y7udXcEFnthimikqNnzVB5FZAVowcN0XFS/s2PcOWTlnMyZn/8ALMY60SodoWBUR2wwuDWT5j6dHtUgdvvpPpA==",4,1),i=u("agnmZ/O8yQi7Z66FhMqnOzxu83L+lPgrpU/1Ol8dNvFRDlJ/reaC0ZsFaIwrPmwfH4PZq/tBvWtb4M0ZE34heQ",4,1),r=u("QoovmNcoriJxN0SRI+9lzbXA+8/sTTsv6bXbpYGJ27w5VsJb80i1OFnxEfG2BdAZkj+CpK8ZT5urHF7V2m2BGNgHqpijAwJCEoNbAUVwb74kMYW+TuSyjFUMfcPV/7Ticr5ddPJ7iW+A3rH+OxaWsZvcBqclxxI1wZvxdM9pJpTkm2nBnvFK0u++R4Y4TyXjD8GdxouM1bUkDKHMd6ycZS3pLG9ZKwJ1SnSEqm6m5INcsKncvUH71Hb5iNqDEVO1mD5RUu5m36uoMcZtLbQyELADJ8iY+yE/v1l/x77vDuTG4AvzPaiPwtWnkUeTCqclBspjUeADgm8UKSlnCg5ucCe3CoVG0i/8LhshOFwmySZNLG38WsQq7VM4DROdlbPfZQpzVIuvY952agq7PHeyqIHCyS5H7a7mknIshRSCNTuiv+ihTPEDZKgaZku8QjABwkuLcND4l5HHbFGjBlS+MNGS6BnW71IY1pkGJFVlqRD0DjWFV3EgKhBqoHAyu9G4GaTBFrjS0MgeN2wIUUGrUydId0zfjuuZNLC8teGbSKg5HAyzxclaY07YqkrjQYrLW5zKT3dj43NoLm/z1rK4o3SPgu5d77L8eKVjb0MXL2CEyHgUofCrcozHAggaZDnskL7/+iNjHiikUGzr3oK96b75o/eyxnkVxnF48uNyUyvKJz7O6iZhnNGGuMchwMIH6tp91s3g6x71fU9/7m7ReAbwZ6pyF2+6CmN9xaLImKYRP5gEvvkNrhtxCzUTHEcbKNt39SMEfYQyyqt7QMckkzyevgoVyb68Qx1nxJwQDUxMxdS+yz5Ctll/KZz8ZX4qX8tvqzrW+uxsRBmMSkdYFw==",4,1),o=u("MEEwDQYJYIZIAWUDBAICBQAEMA"),a=u("MFEwDQYJYIZIAWUDBAIDBQAEQA"),s=u("MC0wDQYJYIZIAWUDBAIFBQAEHA"),c=u("MDEwDQYJYIZIAWUDBAIGBQAEIA"),{sha384:f("SHA-384",o,n,r,128,t,384),sha512:f("SHA-512",a,i,r,128,t,512),sha512_224:f("SHA-512.224",s,i,r,128,t,224),sha512_256:f("SHA-512.256",c,i,r,128,t,256)}}()
	void 0!==e&&(h.hash384=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?h.sha384.finish():h.sha384.computeHash(e.buffer)
	h.sha384.process(e.buffer)},h.hash512=function(e){if("process"!==e.operationSubType)return"finish"===e.operationSubType?h.sha512.finish():h.sha512.computeHash(e.buffer)
	h.sha512.process(e.buffer)},e.register("digest","sha-384",h.hash384),e.register("digest","sha-512",h.hash512)),c["sha-384"]=h.sha384,c["sha-512"]=h.sha512
	var v,g,y,b,_,E,w,S,x,C,T={aes:function(e){var t,n,i,r
	switch(v||(v=l.unpackData("AAIEBggKDA4QEhQWGBocHiAiJCYoKiwuMDI0Njg6PD5AQkRGSEpMTlBSVFZYWlxeYGJkZmhqbG5wcnR2eHp8foCChIaIioyOkJKUlpianJ6goqSmqKqsrrCytLa4ury+wMLExsjKzM7Q0tTW2Nrc3uDi5Obo6uzu8PL09vj6/P4bGR8dExEXFQsJDw0DAQcFOzk/PTMxNzUrKS8tIyEnJVtZX11TUVdVS0lPTUNBR0V7eX99c3F3dWtpb21jYWdlm5mfnZORl5WLiY+Ng4GHhbu5v72zsbe1q6mvraOhp6Xb2d/d09HX1cvJz83DwcfF+/n//fPx9/Xr6e/t4+Hn5QADBgUMDwoJGBseHRQXEhEwMzY1PD86OSgrLi0kJyIhYGNmZWxvaml4e359dHdycVBTVlVcX1pZSEtOTURHQkHAw8bFzM/Kydjb3t3U19LR8PP29fz/+vno6+7t5Ofi4aCjpqWsr6qpuLu+vbS3srGQk5aVnJ+amYiLjo2Eh4KBm5idnpeUkZKDgIWGj4yJiquora6npKGis7C1tr+8ubr7+P3+9/Tx8uPg5ebv7Onqy8jNzsfEwcLT0NXW39zZ2ltYXV5XVFFSQ0BFRk9MSUpraG1uZ2RhYnNwdXZ/fHl6Ozg9Pjc0MTIjICUmLywpKgsIDQ4HBAECExAVFh8cGRoADhwSODYkKnB+bGJIRlRa4O788tjWxMqQnoyCqKa0utvVx8nj7f/xq6W3uZOdj4E7NScpAw0fEUtFV1lzfW9hraOxv5WbiYfd08HP5ev5901DUV91e2lnPTMhLwULGRd2eGpkTkBSXAYIGhQ+MCIslpiKhK6gsrzm6Pr03tDCzEFPXVN5d2VrMT8tIwkHFRuhr72zmZeFi9HfzcPp5/X7mpSGiKKsvrDq5Pb40tzOwHp0ZmhCTF5QCgQWGDI8LiDs4vD+1NrIxpySgI6kqri2DAIQHjQ6KCZ8cmBuREpYVjc5KyUPARMdR0lbVX9xY23X2cvF7+Hz/aepu7WfkYONAA0aFzQ5LiNoZXJ/XFFGS9Ddysfk6f7zuLWir4yBlpu7tqGsj4KVmNPeycTn6v3wa2ZxfF9SRUgDDhkUNzotIG1gd3pZVENOBQgfEjE8Kya9sKeqiYSTntXYz8Lh7Pv21tvMweLv+PW+s6SpioeQnQYLHBEyPyglbmN0eVpXQE3a18DN7uP0+bK/qKWGi5yRCgcQHT4zJClib3h1VltMQWFse3ZVWE9CCQQTHj0wJyqxvKumhYifktnUw87t4Pf6t7qtoIOOmZTf0sXI6+bx/GdqfXBTXklEDwIVGDs2ISwMARYbODUiL2RpfnNQXUpH3NHGy+jl8v+0ua6jgI2alwALFh0sJzoxWFNORXR/Ymmwu6atnJeKgejj/vXEz9LZe3BtZldcQUojKDU+DwQZEsvA3dbn7PH6k5iFjr+0qaL2/eDr2tHMx66luLOCiZSfRk1QW2phfHceFQgDMjkkL42Gm5Chqre81d7DyPny7+Q9NisgERoHDGVuc3hJQl9U9/zh6tvQzcavpLmyg4iVnkdMUVprYH12HxQJAjM4JS6Mh5qRoKu2vdTfwsn48+7lPDcqIRAbBg1kb3J5SENeVQEKFxwtJjswWVJPRHV+Y2ixuqesnZaLgOni//TFztPYenFsZ1ZdQEsiKTQ/DgUYE8rB3Nfm7fD7kpmEj761qKMACRIbJC02P0hBWlNsZX53kJmCi7S9pq/Y0crD/PXu5zsyKSAfFg0Ec3phaFdeRUyrormwj4adlOPq8fjHztXcdn9kbVJbQEk+NywlGhMIAebv9P3Cy9DZrqe8tYqDmJFNRF9WaWB7cgUMFx4hKDM63dTPxvnw6+KVnIeOsbijquzl/vfIwdrTpK22v4CJkpt8dW5nWFFKQzQ9Ji8QGQIL197FzPP64eiflo2Eu7KpoEdOVVxjanF4DwYdFCsiOTCak4iBvrespdLbwMn2/+TtCgMYES4nPDVCS1BZZm90faGos7qFjJee6eD78s3E39YxOCMqFRwHDnlwa2JdVE9GY3x3e/Jrb8UwAWcr/terdsqCyX36WUfwrdSir5ykcsC3/ZMmNj/3zDSl5fFx2DEVBMcjwxiWBZoHEoDi6yeydQmDLBobblqgUjvWsynjL4RT0QDtIPyxW2rLvjlKTFjP0O+q+0NNM4VF+QJ/UDyfqFGjQI+SnTj1vLbaIRD/89LNDBPsX5dEF8Snfj1kXRlzYIFP3CIqkIhG7rgU3l4L2+AyOgpJBiRcwtOsYpGV5HnnyDdtjdVOqWxW9Opleq4IunglLhymtMbo3XQfS72LinA+tWZIA/YOYTVXuYbBHZ7h+JgRadmOlJseh+nOVSjfjKGJDb/mQmhBmS0PsFS7FlIJatUwNqU4v0CjnoHz1/t84zmCmy//hzSOQ0TE3unLVHuUMqbCIz3uTJULQvrDTgguoWYo2SSydluiSW2L0SVy+PZkhmiYFtSkXMxdZbaSbHBIUP3tudpeFUZXp42dhJDYqwCMvNMK9+RYBbizRQbQLB6Pyj8PAsGvvQMBE4prOpERQU9n3OqX8s/O8LTmc5asdCLnrTWF4vk36Bx1325H8RpxHSnFiW+3Yg6qGL4b/FY+S8bSeSCa28D+eM1a9B/dqDOIB8cxsRIQWSeA7F9gUX+pGbVKDS3lep+TyZzvoOA7Ta4q9bDI67s8g1OZYRcrBH66d9Ym4WkUY1UhDH2NAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuNAQIECBAgQIAbNmzYq02aL168Y8aXNWrUs33678WROXLk071hwp8lSpQzZsyDHTp06MuN",256,!1),g=v[0],y=v[1],b=v[2],_=v[3],E=v[4],w=v[5],S=v[6],x=v[7],C=v[8]),8*e.length){case 128:t=128,n=4,i=10
	break
	case 192:t=192,n=6,i=12
	break
	case 256:t=256,n=8,i=14
	break
	default:throw new Error("Unsupported keyLength")}var o=function(e){var t=e[1]
	e[1]=e[5],e[5]=e[9],e[9]=e[13],e[13]=t,t=e[2],e[2]=e[10],e[10]=t,t=e[6],e[6]=e[14],e[14]=t,t=e[15],e[15]=e[11],e[11]=e[7],e[7]=e[3],e[3]=t},a=function(e){var t=e[13]
	e[13]=e[9],e[9]=e[5],e[5]=e[1],e[1]=t,t=e[10],e[10]=e[2],e[2]=t,t=e[14],e[14]=e[6],e[6]=t,t=e[3],e[3]=e[7],e[7]=e[11],e[11]=e[15],e[15]=t},s=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8],u=e[9],d=e[10],p=e[11],f=e[12],m=e[13],h=e[14],v=e[15]
	e[0]=g[t]^y[n]^i^r,e[1]=t^g[n]^y[i]^r,e[2]=t^n^g[i]^y[r],e[3]=y[t]^n^i^g[r],e[4]=g[o]^y[a]^s^c,e[5]=o^g[a]^y[s]^c,e[6]=o^a^g[s]^y[c],e[7]=y[o]^a^s^g[c],e[8]=g[l]^y[u]^d^p,e[9]=l^g[u]^y[d]^p,e[10]=l^u^g[d]^y[p],e[11]=y[l]^u^d^g[p],e[12]=g[f]^y[m]^h^v,e[13]=f^g[m]^y[h]^v,e[14]=f^m^g[h]^y[v],e[15]=y[f]^m^h^g[v]},c=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],o=e[4],a=e[5],s=e[6],c=e[7],l=e[8],u=e[9],d=e[10],p=e[11],f=e[12],m=e[13],h=e[14],v=e[15]
	e[0]=b[t]^E[n]^_[i]^w[r],e[1]=w[t]^b[n]^E[i]^_[r],e[2]=_[t]^w[n]^b[i]^E[r],e[3]=E[t]^_[n]^w[i]^b[r],e[4]=b[o]^E[a]^_[s]^w[c],e[5]=w[o]^b[a]^E[s]^_[c],e[6]=_[o]^w[a]^b[s]^E[c],e[7]=E[o]^_[a]^w[s]^b[c],e[8]=b[l]^E[u]^_[d]^w[p],e[9]=w[l]^b[u]^E[d]^_[p],e[10]=_[l]^w[u]^b[d]^E[p],e[11]=E[l]^_[u]^w[d]^b[p],e[12]=b[f]^E[m]^_[h]^w[v],e[13]=w[f]^b[m]^E[h]^_[v],e[14]=_[f]^w[m]^b[h]^E[v],e[15]=E[f]^_[m]^w[h]^b[v]},u=function(e,t){return[e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]},d=function(e,t,n){for(var i=0;i<e.length;i+=1)e[i]^=t[i+n]},p=function(e){for(var t=0;t<e.length;t+=1)e[t]=S[e[t]]},f=function(e){for(var t=0;t<e.length;t+=1)e[t]=x[e[t]]},m=function(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}
	return r=function(e){for(var t,r,o,a,s,c,l,d=[],f=0;f<4*n;)d.push(e[f++])
	for(f=n;f<4*(i+1);){if(t=m(d,f-1),f%n==0){var h=[C[f/n],0,0,0]
	l=void 0,l=(c=t)[0],c[0]=c[1],c[1]=c[2],c[2]=c[3],c[3]=l,p(t),t=u(t,h)}else n>6&&f%n==4&&p(t)
	var v=u(m(d,f-n),t)
	o=v,s=0,(r=d)[4*(a=f)]=o[4*s],r[4*a+1]=o[4*s+1],r[4*a+2]=o[4*s+2],r[4*a+3]=o[4*s+3],f+=1}return d}(e),{encrypt:function(e){var t,n=e
	for(d(n,r,0),t=1;t<=i-1;t+=1)p(n),o(n),s(n),d(n,r,4*t*4)
	return p(n),o(n),d(n,r,4*i*4),n},decrypt:function(e){var t,n=e
	for(d(n,r,4*i*4),t=i-1;t>=1;t-=1)a(n),f(n),d(n,r,4*t*4),c(n)
	return a(n),f(n),d(n,r,0),n},clear:function(){},keyLength:t,blockSize:128}}},I=I||{}
	I.pkcsv7=function(e){return{pad:function(t){var n=t[t.length-1>=0?t.length-1:0],i=n.length
	if(i===e){var r,o=[]
	for(r=0;r<e;r+=1)o.push(e)
	t.push(o)}else for(var a=e-i&255;n.length!==e;)n.push(a)},unpad:function(t){var n=!0
	t.length%e!=0&&(n=!1)
	for(var i=t.slice(-e),r=i[i.length-1],o=0;o<e;o++){var a=e-o<=r,s=i[o]===r
	n=(!a||s)&&n}var c=n?r:0
	return t.length-=c,n}}}
	var A=function(e){var t=e.blockSize/8,n=I.pkcsv7(t),i=function(e){var t,n,i=[]
	for(t=0;t<e.length;t+=1){var r=e[t]
	for(n=0;n<r.length;n+=1)i.push(r[n])}return i}
	function r(e){var n=[]
	c=c.concat(e)
	for(var i=Math.floor(c.length/t),r=0;r<i;r++)n.push(c.slice(r*t,(r+1)*t))
	return c=c.slice(i*t),n}function o(t){for(var n,i=[],r=0;r<t.length;r++)n=l.xorVectors(s,t[r]),i.push(e.encrypt(n)),s=i[r]
	return i}function a(){c=[],u=[],s=null}var s,c=[],u=[]
	return{init:function(e){if(e.length!==t)throw new Error("Invalid iv size")
	s=e.slice()},encrypt:function(e){return this.processEncrypt(e),this.finishEncrypt()},processEncrypt:function(e){var t=o(r(e))
	u=u.concat(i(t))},finishEncrypt:function(){var e=1===c.length?[[c[0]]]:[c]
	n.pad(e)
	var t=u.concat(i(o(e)))
	return a(),t},decrypt:function(e){return this.processDecrypt(e),this.finishDecrypt()},processDecrypt:function(t){var n=function(t){for(var n,i,r=[],o=0;o<t.length;o+=1)n=t[o].slice(0,t[o].length),i=e.decrypt(n),r.push(l.xorVectors(s,i)),s=t[o]
	return r}(r(t))
	u=u.concat(i(n))},finishDecrypt:function(){var e=u
	n.unpad(e)
	return a(),e}}},M=null
	function O(){if(!(this instanceof O))throw new Error("create MsrcryptoPrng object with new keyword")
	var e,t,n,i,r=!1,o=1
	function a(e){var t
	for(t=e.length-1;t>=0&&(e[t]+=1,e[t]>=256&&(e[t]=0),!e[t]);t-=1);}function s(){e=l.getVector(32),t=l.getVector(16),n=32,i=48,o=1}function c(e,t){if((t=t||[0]).length>i)throw new Error("Incorrect entropy or additionalEntropy length")
	t=t.concat(l.getVector(i-t.length)),e=e.concat(l.getVector((i-e.length%i)%i))
	for(var n=0;n<e.length;n+=i){u(l.xorVectors(e.slice(n,n+i),t))}o=1}function u(r){for(var o=[],s=new T.aes(e);o.length<i;){a(t)
	var c=t.slice(0,16),u=s.encrypt(c)
	o=o.concat(u)}o=l.xorVectors(o,r),e=o.slice(0,n),t=o.slice(n)}function d(n,r){if(n>=65536)throw new Error("too much random requested")
	if(o>16777216)throw new Error("Reseeding is required")
	if(r&&r.length>0){for(;r.length<i;)r=r.concat(l.getVector(i-r.length))
	u(r)}else r=l.getVector(i)
	for(var s=[],c=new T.aes(e);s.length<n;){a(t)
	var d=t.slice(0,t.length),p=c.encrypt(d)
	s=s.concat(p)}return s=s.slice(0,n),u(r),o+=1,s}return s(),{reseed:c,init:function(e,t){if(e.length<i)throw new Error("Initial entropy length too short")
	s(),c(e,t),r=!0},getBytes:function(e,t){if(!r)throw new Error("can't get randomness before initialization")
	return d(e,t)},getNonZeroBytes:function(e,t){if(!r)throw new Error("can't get randomness before initialization")
	for(var n,i=[];i.length<e;){n=d(e,t)
	for(var o=0;o<n.length;o+=1)0!==n[o]&&i.push(n[o])}return i.slice(0,e)}}}void 0!==e&&(A.workerEncrypt=function(e){var t
	if(M||(M=A(T.aes(e.keyData))).init(e.algorithm.iv),"process"!==e.operationSubType)return"finish"===e.operationSubType?(t=M.finishEncrypt(),M=null,t):(t=M.encrypt(e.buffer),M=null,t)
	M.processEncrypt(e.buffer)},A.workerDecrypt=function(e){var t
	if(M||(M=A(T.aes(e.keyData))).init(e.algorithm.iv),"process"!==e.operationSubType)return"finish"===e.operationSubType?(t=M.finishDecrypt(),M=null,t):(t=M.decrypt(e.buffer),M=null,t)
	M.processDecrypt(e.buffer)},A.generateKey=function(e){if(e.algorithm.length%8!=0)throw new Error
	return{type:"keyGeneration",keyData:N.getBytes(Math.floor(e.algorithm.length/8)),keyHandle:{algorithm:e.algorithm,extractable:e.extractable,keyUsage:e.keyUsage,type:"secret"}}},A.importKey=function(e){var t=p.jwkToKey(e.keyData,e.algorithm,["k"])
	return{type:"keyImport",keyData:t.k,keyHandle:{algorithm:e.algorithm,extractable:e.extractable||t.extractable,keyUsage:e.keyUsage,type:"secret"}}},A.exportKey=function(e){return{type:"keyExport",keyHandle:p.keyToJwk(e.keyHandle,e.keyData)}},e.register("importKey","aes-cbc",A.importKey),e.register("exportKey","aes-cbc",A.exportKey),e.register("generateKey","aes-cbc",A.generateKey),e.register("encrypt","aes-cbc",A.workerEncrypt),e.register("decrypt","aes-cbc",A.workerDecrypt))
	var k,N=new O
	i||(k=function(){function i(){var e
	return{postMessage:function(t){try{e=u.jsCryptoRunner({data:t}),t.operationSubType&&"process"===t.operationSubType||this.onmessage({data:e})}catch(n){this.onerror({data:n.description,type:"error"})}},onmessage:null,onerror:null,terminate:function(){}}}function o(e){var t,n=null,i=null
	return s(t={dispatchEvent:function(t){"error"!==t.type?"process"!==t.type&&(this.result=e(t.data),this.oncomplete&&this.oncomplete({target:this})):this.onerror&&this.onerror(t)},addEventListener:function(e,t){},removeEventListener:function(e,t){},result:null},"oncomplete",null,(function(){return n}),(function(e){n=e,this.result&&n({target:this})})),s(t,"onerror",null,(function(){return i}),(function(e){i=e})),t}function c(e){return r&&e.pop?new Uint8Array(e).buffer:e}var d=[]
	d.add=function(e,t){d.push({keyHandle:e,keyData:t})},d.remove=function(e){for(var t=0;t<d.length;t++)if(d[t].keyHandle===e)return void(d=d.splice(t,1))},d.lookup=function(e){for(var t=0;t<d.length;t++)if(d[t].keyHandle===e)return d[t].keyData
	return null}
	var p=function(){var e=15,r=4,o=[],s=[],c=0
	function l(){(function(e){for(var t=o.length-1;t>=0;t-=1)o[t].isWebWorker===e&&(o[t].terminate(),o.splice(t,1))})(!a)
	for(var e=0;e<o.length;e++)if(!o[e].busy)return o[e]
	return null}function u(e){for(var t=0;t<o.length;t++)if(o[t]===e)return e.terminate(),void o.splice(t,1)}function d(e){for(var t=0;t<o.length;t++)if(o[t].operation===e)return o[t]
	return null}function p(e,t){s.push({operation:e,data:t,id:c++})}function f(e){if(e.busy=!1,e.operation=null,a)if(s.length>0){var t=s.shift()
	v(t.operation,t.data)}else(function(){for(var e=0,t=0;t<o.length;t++)o[t].busy||(e+=1)
	return e})()>r&&u(e)}function m(e){var n
	if(a)try{(n=new Worker(t)).postMessage({prngSeed:N.getBytes(48)}),n.isWebWorker=!0}catch(r){a=!1,y.forceSync=!0,(n=i()).isWebWorker=!1}else(n=i()).isWebWorker=!1
	return n.operation=e,n.busy=!1,n.onmessage=function(e){for(var t=n.operation,i=0;i<s.length;i++)if(s[i].operation===n.operation){var r=s[i]
	return s.splice(i,1),void g(n,r.data)}t&&"process"!==e.data.type&&(f(n),t.dispatchEvent(e))},n.onerror=function(e){var t=n.operation
	f(n),t.dispatchEvent(e)},function(e){o.push(e)}(n),n}function h(t,i){var r=null
	if(a=n&&!y.forceSync,r=l(),a&&null===r&&o.length>=e)p(t,i)
	else{if(null===r&&(r=m(t)),null===r)throw p(t,i),new Error("could not create new worker")
	r.operation=t,r.busy=!0,g(r,i)}}function v(e,t){var n=d(e)
	n?g(n,t):h(e,t)}function g(e,t){a?(e.data=t,e.postMessage(t)):setTimeout((function(){e.postMessage(t)}),0)}return{runJob:h,continueJob:v,abortJob:function(e){var t=d(e)
	t&&u(t)}}}(),f=l
	var m=[{name:"algorithm",type:"Object",required:!0},{name:"keyHandle",type:"Object",required:!0},{name:"buffer",type:"Array",required:!1},{name:"signature",type:"Array",required:!0},{name:"format",type:"String",required:!0},{name:"keyData",type:"Array",required:!0},{name:"extractable",type:"Boolean",required:!1},{name:"keyUsages",type:"Array",required:!1},{name:"derivedKeyType",type:"Object",required:!0},{name:"length",type:"Number",required:!1}],h={encrypt:[0,1,2],decrypt:[0,1,2],sign:[0,1,2],verify:[0,1,3,2],digest:[0,2],generateKey:[0,6,7],importKey:[4,5,0,6,7],exportKey:[0,4,1,6,7],deriveKey:[0,1,8,6,7],deriveBits:[0,1,9],wrapKey:[1,1,0],unwrapKey:[2,0,1,6,7]}
	function v(e){var t=d.lookup(e)
	if(!t)throw new Error("key not found")
	return t}function g(t,n,i){var r=function(e,t){for(var n={operationType:e},i=h[e],r=0;r<i.length;r+=1){var o=m[i[r]],a=t[r]
	if(a){if(a.subarray&&(a=f.toArray(a)),l.getObjectType(a)!==o.type)throw new Error(o.name)
	"algorithm"===o.name&&(a.name=a.name.toLowerCase(),a.iv&&(a.iv=f.toArray(a.iv)),a.salt&&(a.salt=f.toArray(a.salt)),a.additionalData&&(a.additionalData=f.toArray(a.additionalData)),a.hash&&!a.hash.name&&"String"===l.getObjectType(a.hash)&&(a.hash={name:a.hash})),n.hasOwnProperty(o.name)?n[o.name+"1"]=a:n[o.name]=a}else if(o.required)throw new Error(o.name)}return n}(t,n);(function(t,n){if(!e.exists(t,n))throw new Error("unsupported algorithm")})(t,r.algorithm.name),r.keyHandle&&(r.keyData=v(r.keyHandle)),r.keyHandle1&&(r.keyData1=v(r.keyHandle1)),r.algorithm&&r.algorithm.publicKey&&(r.additionalKeyData=v(r.algorithm.publicKey))
	var a=i?o((function(e){switch(e.type){case"keyGeneration":case"keyImport":case"keyDerive":return d.add(e.keyHandle,e.keyData),e.keyHandle
	case"keyExport":return c(e.keyHandle)
	case"keyPairGeneration":return d.add(e.keyPair.publicKey.keyHandle,e.keyPair.publicKey.keyData),d.add(e.keyPair.privateKey.keyHandle,e.keyPair.privateKey.keyData),{publicKey:e.keyPair.publicKey.keyHandle,privateKey:e.keyPair.privateKey.keyHandle}
	default:throw new Error("Unknown key operation")}})):function(e){var t=o((function(e){return c(e)}))
	return t.process=function(t){e.operationSubType="process",e.buffer=f.toArray(t),p.continueJob(this,f.clone(e))},t.finish=function(){e.operationSubType="finish",e.buffer=[],p.continueJob(this,f.clone(e))},t.abort=function(){p.abortJob(this)},t.onabort=null,t.onprogress=null,t.algorithm=e.algorithm||null,t.key=e.keyHandle||null,t}(r)
	return(i||r.buffer||"deriveBits"===t||"wrapKey"===t)&&p.runJob(a,r),a}var y={encrypt:function(e,t,n){return g("encrypt",arguments,0)},decrypt:function(e,t,n){return g("decrypt",arguments,0)},sign:function(e,t,n){return g("sign",arguments,0)},verify:function(e,t,n,i){return g("verify",arguments,0)},digest:function(e,t){return g("digest",arguments,0)},generateKey:function(e,t,n){return g("generateKey",arguments,1)},deriveKey:function(e,t,n,i,r){return g("deriveKey",arguments,1)},deriveBits:function(e,t,n){return g("deriveBits",arguments,0)},importKey:function(e,t,n,i,r){return g("importKey",arguments,1)},exportKey:function(e,t){return g("exportKey",[t.algorithm,e,t],1)},wrapKey:function(e,t,n){return g("wrapKey",arguments,0)},unwrapKey:function(e,t,n,i,r){return g("unwrapKey",arguments,1)}}
	return y}())
	var P,R={subtle:k,getRandomValues:function(e){var t,n=N.getBytes(e.length)
	for(t=0;t<e.length;t+=1)e[t]=n[t]
	return e},initPrng:function(e){var t=Object.prototype.toString.call(e)
	if("[object Array]"!==t&&"[object Uint8Array]"!==t)throw new Error("entropyData must be a Array or Uint8Array")
	P&&P.reseed(e),N.reseed(P.read(48)),!0},toBase64:function(e,t){return l.toBase64(e,!1)},base64ToString:function(e){return l.base64ToString(e)},utilities:l,sha256:m.sha256,sha512:h.sha512,url:t}
	if("undefined"!=typeof cryptoMath&&(R.cryptoMath=cryptoMath),"undefined"!=typeof testInterface&&(R.testInterface=testInterface),!i){(P=P||new function(){var e=[],t=new O,n=!1,i=!1,r=["Cookie","RedirectUri","ETag","x-ms-client-antiforgery-id","x-ms-client-request-id","x-ms-client-session-id","SubscriptionPool"]
	function o(){var o,a=[]
	for(o=0;o<48;o+=1)a[o]=Math.floor(256*Math.random())
	var c=window.crypto||window.msCrypto
	if(c&&"function"==typeof c.getRandomValues&&window.Uint8Array){var u=new window.Uint8Array(48)
	c.getRandomValues(u),a=a.concat(Array.apply(null,u)),i=!0}var d=new XMLHttpRequest
	for(o=0;o<r.length;o+=1)try{var p=d.getResponseHeader(r[o])
	if(p){var f=l.stringToBytes(p)
	a=a.concat(f)}}catch(m){}i||(a=a.concat(e.splice(0,e.length)),s.startCollectors()),n?t.reseed(a):t.init(a),n=!0}function a(t){for(var n=0;n<t.length;++n)e.push(t[n])
	e.length>=128&&s.stopCollectors()}var s={startCollectors:function(){if(!this.collectorsRegistered){if(window.addEventListener)window.addEventListener("mousemove",this.MouseEventCallBack,!0),window.addEventListener("load",this.LoadTimeCallBack,!0)
	else{if(!document.attachEvent)throw new Error("Can't attach events for entropy collection")
	document.attachEvent("onmousemove",this.MouseEventCallBack),document.attachEvent("onload",this.LoadTimeCallBack)}this.collectorsRegistered=1}},stopCollectors:function(){this.collectorsRegistered&&(window.removeEventListener?(window.removeEventListener("mousemove",this.MouseEventCallBack,1),window.removeEventListener("load",this.LoadTimeCallBack,1)):window.detachEvent&&(window.detachEvent("onmousemove",this.MouseEventCallBack),window.detachEvent("onload",this.LoadTimeCallBack)),this.collectorsRegistered=0)},MouseEventCallBack:function(e){var t=(new Date).valueOf(),n=e.x||e.clientX||e.offsetX||0,i=e.y||e.clientY||e.offsetY||0
	a([255&t,t>>8&255,t>>16&255,t>>24&255,255&n,n>>8&255,255&i,i>>8&255])},LoadTimeCallBack:function(){var e=(new Date).valueOf()
	a([255&e,e>>8&255,e>>16&255,e>>24&255])}}
	return{init:function(){if(o(),!i)try{s.startCollectors()}catch(e){}},reseed:function(e){t.reseed(e)},read:function(e){if(!n)throw new Error("Entropy pool is not initialized.")
	var i=t.getBytes(e)
	return o(),i}}}).init()
	var L=P.read(48)
	N.init(L)}return R}()
	return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/StringBuilder",["require","exports"],e)}((function(){return(e={}).StringBuilder=function(t){this._parts=e.isNullOrEmpty(t)?[]:[t.toString()],this._value={},this._len=0},e.StringBuilder.prototype={append:function(e){return this._parts.push(e),this},appendLine:function(e){return this._parts.push(null==e||""===e?"\r\n":e+"\r\n"),this},clear:function(){if(0!==arguments.length)throw new Error("InvalidParameterCount")
	this._parts=[],this._value={},this._len=0},isEmpty:function(){if(0!==arguments.length)throw new Error("InvalidParameterCount")
	return 0===this._parts.length||""===this.toString()},toString:function(e){e=e||""
	var t=this._parts
	this._len!==t.length&&(this._value={},this._len=t.length)
	var n=this._value
	if(void 0===n[e]){if(""!==e)for(var i=0;i<t.length;)void 0===t[i]||""===t[i]||null===t[i]?t.splice(i,1):i++
	n[e]=this._parts.join(e)}return n[e]}},e.isNullOrEmpty=function(e){return!e||!e.length},e
	var e}));(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/BigInt",["require","exports","./StringBuilder"],e)})((function(e){var t,n=e("./StringBuilder")
	return(t=function(e,t){this._elements=[],this._radix=e,this._elements.splice(0,0,t),this._length=1,this._normalize()}).hexRadix=16,t.decRadix=1e3,t._createDec=function(e){return new t(t.decRadix,e)},t._createHex=function(e){return new t(t.hexRadix,e)},t._computeHexNegative=function(e,n){var i,r=[]
	for(i=0;i<n;i++)r.splice(i,0,e[i])
	for(i=0;i<r.length;i++)r[i]>0&&(r[i]=t.hexRadix-r[i],i+1<r.length?r[i+1]=r[i+1]+1:r.length<16&&r.splice(i+1,0,1))
	return r},t.parseDecInt=function(e,n){switch(e){case t.decRadix:return t._parseDecIntToDecRadixBigInt(n)
	case t.hexRadix:return t._parseDecIntToHexRadixBigInt(n)
	default:return null}},t._parseDecIntToHexRadixBigInt=function(e){if(n.isNullOrEmpty(e))return null
	var i="-"===e.charAt(0)
	i&&(e=e.substr(1))
	for(var r=t._createHex(1e9),o=t._createHex(0),a=Math.ceil(e.length/9),s=t._createHex(1),c=e.length,l=0;l<a;l++){var u=c-9<0?0:c-9,d=parseInt(e.substr(u,c-u),10),p=t._createHex(d)
	p.multiply(s),o.add(p),s.multiply(r),c-=9}return o._isNegative=i,o},t._parseDecIntToDecRadixBigInt=function(e){if(0===e.length)return t._createDec(0)
	var n,i=!1,r=[]
	for("-"===e.charAt(0)&&(i=!0,e=e.substr(1,e.length-1)),n=0;3*(n+1)<=e.length;n++)r.splice(n,0,parseInt(e.substring(e.length-3*(n+1),e.length-3*n),10))
	0!=e.length%3&&r.splice(n++,0,parseInt(e.substring(0,e.length%3),10))
	var o=t._createDec(0)
	return o._elements=r,o._length=n,o._isNegative=i,o},t._getHexValues=function(e){for(var n=new Array(e.length),i=0;i<e.length;i++)if(n[i]=t._hexCharValue(e.charAt(i)),n[i]<0)return null
	return n},t._hexCharValue=function(e){if(e>="0"&&e<="9")return e-"0"
	switch(e){case"a":return 10
	case"b":return 11
	case"c":return 12
	case"d":return 13
	case"e":return 14
	case"f":return 15
	default:return-1}},t._toNegativeValues=function(e){for(var t=e.length-1;t>=0;t--)e[t]>0&&(e[t]=16-e[t],t>0&&(e[t-1]+=1))
	return e},t.prototype={_isNegative:!1,_length:0,_radix:0,_normalize:function(){var e
	for(e=this._length-1;e>=0&&0===this._elements[e];e--)this._length--
	for(var t=0;t<2;t++)if(0===this._length)this._isNegative=!1
	else{if(this._elements[this._length-1]<0){for(e=0;e<this._length;e++)this._elements[e]=-this._elements[e]
	this._isNegative=!this._isNegative}for(e=0;e<this._length-1;e++){var n
	this._elements[e]<0&&(n=Math.ceil(-this._elements[e]/this._radix),this._elements[e]=this._elements[e]+this._radix*n,this._elements[e+1]=this._elements[e+1]-n),this._elements[e]>=this._radix&&(n=Math.floor(this._elements[e]/this._radix),this._elements[e]=this._elements[e]%this._radix,this._elements[e+1]=this._elements[e+1]+n)}for(;this._elements[this._length-1]>=this._radix;)this._ensureCapacity(),this._elements[this._length]=Math.floor(this._elements[this._length-1]/this._radix),this._elements[this._length-1]=this._elements[this._length-1]%this._radix,this._length++
	if(!(this._elements[this._length-1]<0))break
	for(e=0;e<this._length;e++)this._elements[e]=-this._elements[e]
	this._isNegative=!this._isNegative}},_ensureCapacity:function(){this._length===this._elements.length&&this._elements.push(0)},add:function(e){var t
	for(t=0;t<this._length-e._length;t++)e._elements.splice(e._length+t,0,0)
	for(t=0;t<e._length-this._length;t++)this._elements.splice(this._length+t,0,0)
	if(this._length=Math.max(e._length,this._length),this._isNegative===e._isNegative)for(t=0;t<this._length;t++)this._elements[t]=this._elements[t]+e._elements[t]
	else for(t=0;t<this._length;t++)this._elements[t]=this._elements[t]-e._elements[t]
	this._normalize()},multiply:function(e){var n,i=new t(this._radix,0)
	for(n=0;n<e._length+this._length;n++)n<i._elements.length?i._elements[n]=0:i._elements.splice(n,0,0)
	for(n=0;n<e._length;n++){for(var r=0;r<this._length;r++)i._elements[n+r]=i._elements[n+r]+e._elements[n]*this._elements[r],0!==i._elements[n+r]&&(i._length=Math.max(i._length,n+r+1))
	i._normalize()}i._isNegative=e._isNegative!==this._isNegative,this._elements=i._elements,this._isNegative=i._isNegative,this._length=i._length},modulus:function(e){for(;0!==e._length&&0!==this._length;){var t=this._length-e._length
	if(t<0)break
	var n=this._elements[this._length-1],i=e._elements[e._length-1]
	if(n>=i){for(var r=Math.floor(n/i),o=0;o<e._length;o++)this._elements[o+t]=this._elements[o+t]-r*e._elements[o]
	this._normalize()}else{if(0===t)break
	this._elements[this._length-2]=this._elements[this._length-2]+this._radix*this._elements[this._length-1],this._length--}}this._isNegative&&(e._isNegative?(e._isNegative=!1,this.add(e),e._isNegative=!0):this.add(e)),this._normalize()},toString:function(){switch(this._radix){case t.hexRadix:return this._toHexString()
	case t.decRadix:return this._toDecString()
	default:return""}},_toHexString:function(){if(0===this._elements.length)return"0"
	var e=this._elements
	this._isNegative&&(e=t._computeHexNegative(e,this._length))
	for(var i=new n.StringBuilder,r=!1,o=e.length-1;o>=0;o--)r||0!==e[o]&&(r=!0),r&&i.append("0123456789abcdef".charAt(e[o]))
	return i.toString()},_toDecString:function(){if(0===this._length)return"0"
	for(var e="",t=0;t<this._length;t++)if(e=this._elements[t]+e,t<this._length-1)for(var n=10;n<this._radix;n*=10)this._elements[t]<n&&(e=0+e)
	return this._isNegative&&(e="-"+e),e}},t})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/ConvertHelper",["require","exports"],e)}((function(){return{tryParseInt:function(e){var t=parseInt(e,10)
	return isNaN(t)?-1:t},parseHexInt:function(e){var t=parseInt(e,16)
	return isNaN(t)?0:t}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/sha256Auth",["require","exports","./msrcrypto.aes","./StringBuilder","./BigInt","./ConvertHelper"],e)}((function(e){var t=e("./msrcrypto.aes"),n=e("./StringBuilder"),i=e("./BigInt"),r=e("./ConvertHelper")
	return function(e){var o=window.MSP||{}
	function a(e,t){var i,r=e.toString(2),o=t.toString(2),a=new n.StringBuilder,s=new n.StringBuilder,c=Math.abs(r.length-o.length)
	for(i=0;i<c;i++)s.append("0")
	for(r.length<o.length?(s.append(r),r=s.toString()):o.length<r.length&&(s.append(o),o=s.toString()),i=0;i<r.length;i++)a.append(r.charAt(i)===o.charAt(i)?"0":"1")
	return parseInt(a.toString(),2)}return o._sha256Auth=function(){},o._sha256Auth.prototype={_int32ToHexString:function(e){for(var t="0123456789abcdef",i=new n.StringBuilder,r=0;r<=3;r++)i.append(t.charAt(e>>8*r+4&15)),i.append(t.charAt(e>>8*r&15))
	return i.toString()},getMacHash:function(e,n,i){var o=e+n,s=8-o.length%8
	8!==s&&(o=function(e,t,n){if(e.length<t)return e+function(e,t){for(var n=e,i=1;i<t;i++)n+=e
	return n}(n=n||" ",t-e.length)
	return e.valueOf()}(o,o.length+s,"0"))
	var c,l,u=o.length/4,d=[]
	for(c=0,l=0;c<u;c++)d.splice(c,0,0),d[c]=d[c]+1*o.charCodeAt(l++),d[c]=d[c]+256*o.charCodeAt(l++),d[c]=d[c]+65536*o.charCodeAt(l++),d[c]=d[c]+16777216*o.charCodeAt(l++)
	var p,f,m,h=new Array(4),v=(p=e+i,f=t.utilities.stringToBytes(p),m=t.sha256.computeHash(f),t.utilities.bytesToHexString(m))
	for(c=0,l=0;c<h.length;c++)h[c]=0,h[c]+=1*r.parseHexInt(v.substr(l,2)),l+=2,h[c]+=256*r.parseHexInt(v.substr(l,2)),l+=2,h[c]+=65536*r.parseHexInt(v.substr(l,2)),l+=2,h[c]+=16777216*r.parseHexInt(v.substr(l,2)),l+=2
	var g=new Array(2)
	this._cS64_C(d,h,g)
	var y=a(h[0],g[0]),b=a(h[1],g[1]),_=a(h[2],g[0]),E=a(h[3],g[1])
	return this._int32ToHexString(y)+this._int32ToHexString(b)+this._int32ToHexString(_)+this._int32ToHexString(E)},_cS64_C:function(e,t,n){var r=2147483647
	if(e.length<2||1==(1&e.length))return!1
	for(var o=t[0]&r,a=t[1]&r,s=t[2]&r,c=t[3]&r,l=i.parseDecInt(i.decRadix,o.toString()),u=i.parseDecInt(i.decRadix,a.toString()),d=i.parseDecInt(i.decRadix,s.toString()),p=i.parseDecInt(i.decRadix,c.toString()),f=i.parseDecInt(i.decRadix,242854337..toString()),m=0,h=i.parseDecInt(i.decRadix,r.toString()),v=i.parseDecInt(i.decRadix,"0"),g=i.parseDecInt(i.decRadix,"0"),y=i.parseDecInt(i.decRadix,"0"),b=0;b<e.length/2;b++)(v=i.parseDecInt(i.decRadix,e[m++].toString())).multiply(f),v.modulus(h),g.add(v),g.multiply(l),g.add(u),g.modulus(h),y.add(g),g.add(i.parseDecInt(i.decRadix,e[m++].toString())),g.multiply(d),g.add(p),g.modulus(h),y.add(g)
	return g.add(u),g.modulus(h),y.add(p),y.modulus(h),n[0]=parseInt(g.toString(),10),n[1]=parseInt(y.toString(),10),!0}},o._sha256Auth}()})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("msr-crypto/lib/index",["require","exports","./msrcrypto.aes","./sha256Auth"],e)}((function(e,t){t.aes=e("./msrcrypto.aes"),t.sha256Auth=e("./sha256Auth")})),define("msr-crypto",["msr-crypto/lib/index"],(function(e){return e})),define("services/telemetry/hashingService",["require","msr-crypto"],(function(e){var t=e("msr-crypto").aes
	return new function(){this.getHash=function(e){var n=t.utilities.stringToBytes(e),i=t.sha256.computeHash(n)
	return t.utilities.bytesToHexString(i)}}})),define("telemetry/chat/urlPreviewShow",["require","exports","module","experience/settings","swx-constants","ui/telemetry/telemetryClient","swx-telemetry-buckets","services/telemetry/hashingService"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON,r=i.telemetry.urlPreviewShown,o=e("ui/telemetry/telemetryClient"),a=e("swx-telemetry-buckets"),s=e("services/telemetry/hashingService")
	function c(e){var t=this,c=d(),l=i.telemetry.NOT_AVAILABLE
	function u(){t.data.ttl=function(e,t){return t-e}(c,d()),t.data.ttlGroup=a.getSecondsDurationGroup(t.data.ttl)
	var e=r.TYPE,i=t.data
	o.get().sendEvent(n.telemetry.chatTenantToken,e,i)}function d(){return(new Date).getTime()}t.data={messageIdHash:s.getHash(e.contentId),urlCount:e.urlCount,hasThumbnail:!1,urlPosition:e.urlPosition,contentType:a.getUrlContentType(e.url),result:l,ttl:l,ttlGroup:l,participantCount:e.participantsCount,participantCountGroup:a.getParticipantCountGroup(e.participantsCount)},t.error=function(e){e&&(t.data.result=e),u()},t.succeeded=function(e,n){t.data.hasThumbnail=n,t.data.result=e,u()}}t.build=function(e){return new c(e)}})),define("telemetry/chat/youtubeShowEvent",["require","experience/settings","services/telemetry/hashingService","ui/telemetry/telemetryClient","swx-log-tracer"],(function(e){var t=e("experience/settings"),n=e("services/telemetry/hashingService"),i=e("ui/telemetry/telemetryClient"),r=e("swx-log-tracer").getLogger()
	return new function(){this.publish=function(e,o,a,s){try{var c={messageIdHash:n.getHash(e.contentId),videoId:e.youtubeId,participantsCount:s,meSender:e.isMyself,batchOrdinal:e.ordinal,videoLength:a,playerWidth:o.getIframe().clientWidth,playerHeight:o.getIframe().clientHeight,preferencesEnabled:e.ytEnabled}
	i.get().sendEvent(t.telemetry.chatTenantToken,"message_youtube_show",c)}catch(l){r.error("Unable to send YT show telemetry: "),r.error(l)}}}})),define("telemetry/chat/youtubeActionEvent",["require","experience/settings","services/telemetry/hashingService","ui/telemetry/telemetryClient","swx-log-tracer"],(function(e){var t=e("experience/settings"),n=e("services/telemetry/hashingService"),i=e("ui/telemetry/telemetryClient"),r=e("swx-log-tracer").getLogger()
	return new function(){this.publish=function(e,o,a,s){try{var c={messageIdHash:n.getHash(e.contentId),videoId:e.youtubeId,meSender:e.isMyself,batchOrdinal:e.ordinal,timeInStale:(s-e.messageTimestamp)/1e3,playerWidth:o.getIframe().clientWidth,playerHeight:o.getIframe().clientHeight,playerMode:!!o.inFullScreenMode,participantsCount:a.participantsCount,playerActionType:a.type,videoLength:a.videoLength,playerActionDuration:a.duration,preferencesEnabled:e.ytEnabled}
	a.startTime&&(c.startTime=a.startTime),i.get().sendEvent(t.telemetry.chatTenantToken,"message_youtube_action",c)}catch(l){r.error("Unable to send YT action telemetry: "),r.error(l)}}}})),define("ui/players/ytPlayer",["require","swx-constants","experience/settings","browser/window","browser/document","swx-log-tracer","telemetry/chat/youtubeShowEvent","telemetry/chat/youtubeActionEvent","swx-pubsub-instance"],(function(e){var t=e("swx-constants").COMMON,n=e("experience/settings"),i=e("browser/window"),r=e("browser/document"),o=e("swx-log-tracer").getLogger(),a=e("telemetry/chat/youtubeShowEvent"),s=e("telemetry/chat/youtubeActionEvent"),c=e("swx-pubsub-instance").default
	return new function(){var e,l=this
	function u(){try{l.testContext.removePlayer(this.playerId)}catch(e){o.error("Error in disposing the Player: "),o.error(e)}}function d(e){l.testContext.players[e]&&(l.testContext.players[e].destroy(),delete l.testContext.players[e]),l.testContext.previewItems[e]&&delete l.testContext.previewItems[e]}function p(e){return e.B?e.B.currentTime:e.F?e.F.currentTime:e.getCurrentTime?e.getCurrentTime():0}function f(e){return e.H&&e.H.duration?e.H.duration:e.F&&e.F.duration?e.F.duration:e.getDuration?e.getDuration():0}function m(e,t,n,i){var r=f(n)
	return{type:e,duration:t=(t/=1e3)>r?r:t,startTime:p(n),participantsCount:h(i),videoLength:r}}function h(e){return e&&e.conversation?e.conversation.participantsCount():t.telemetry.NOT_AVAILABLE}function v(e){e.previews().forEach((function(e){i&&i.YT&&i.YT.Player&&e.type()===t.urlPreviewType.YT&&e.playerId&&(l.testContext.players[e.playerId]||(l.testContext.players[e.playerId]=new i.YT.Player(e.playerId,{events:{onReady:l.testContext.onPlayerReady,onStateChange:l.testContext.onPlayerStateChange,onError:l.testContext.onPlayerError}})))}))}function g(e){return e.target.id||e.target.getIframe().id}l.testContext={players:{},previewItems:{},onPlayerReady:function(e){try{var t=g(e),n=l.testContext.previewItems[t],i=l.testContext.players[t]
	if(i.toDestroy)return void d(t)
	if(i.renderedAndReady=!0,!n)return
	a.publish(n,e.target,f(e.target),h(n))}catch(r){o.error("Error in onPlayerReady: "),o.error(r)}},onPlayerStateChange:function(e){try{var t=(new i.Date).getTime(),n=g(e),r=l.testContext.previewItems[n],a=l.testContext.players[n]
	switch(e.data){case i.YT.PlayerState.BUFFERING:case i.YT.PlayerState.CUED:case i.YT.PlayerState.UNSTARTED:return
	case i.YT.PlayerState.PLAYING:r.lastActionTimestamp=t,s.publish(r,a,m(l.actionType.PLAYING,0,a,r),t)
	break
	case i.YT.PlayerState.PAUSED:r.lastActionTimestamp=r.lastActionTimestamp||t,s.publish(r,a,m(l.actionType.PAUSED,t-r.lastActionTimestamp,a,r),{type:l.actionType.PAUSED,duration:t-r.lastActionTimestamp,participantsCount:h(r),videoLength:f(a)},t),r.lastActionTimestamp=null
	break
	case i.YT.PlayerState.ENDED:r.lastActionTimestamp=r.lastActionTimestamp||t,s.publish(r,a,m(l.actionType.ENDED,t-r.lastActionTimestamp,a,r),t),r.lastActionTimestamp=null}}catch(c){o.error("Error in onPlayerStateChange: "),o.error(c)}},removePlayer:function(e){try{var t=l.testContext.players[e]
	if(!t)return
	t.renderedAndReady?d(e):(i.setTimeout(d.bind(null,e),1e4),t.toDestroy=!0)}catch(n){o.error("Error in removePlayer: "),o.error(n)}},onFullscreenChangedHandler:function(n){var r,a
	if(n.target.id&&"yt_msg_"===n.target.id.substring(0,7)){e&&(o.error("[YOUTUBE] Trying to go to fullscreen twice! Message in a fullscreen: "+e),(a=l.testContext.players[e]||{}).inFullScreenMode=!1)
	try{e=g(n),r=l.testContext.previewItems[e],(a=l.testContext.players[e]).inFullScreenMode=!0,c.publish(t.events.videoPlayer.FULLSCREEN_ON,r?r.messageId:null),s.publish(r,a,{type:l.actionType.FULLSCREEN,duration:p(a),participantsCount:h(r),videoLength:f(a)},(new i.Date).getTime())}catch(u){o.error("Error in onFullscreenChangedHandler: "),o.error(u)}}else{try{r=l.testContext.previewItems[e],a=l.testContext.players[e],r&&c.publish(t.events.videoPlayer.FULLSCREEN_OFF,r.messageId)}catch(u){o.error("Error in onFullscreenChangedHandler: "),o.error(u)}a&&(a.inFullScreenMode=!1,e=null)}},onPlayerError:function(e){o.error("[YT ERROR]"),o.error(e)}},l.actionType={PLAYING:"play",PAUSED:"pause",FULLSCREEN:"fullscreen",ENDED:"end"},l.render=function(e,r,a,s){var c=e.originalRequest,d=/(?:youtube.com|youtu.be)\/(watch)?((?:.*)v=|v\/|embed\/)?([\w-]{11})/.exec(c)
	if(d){var p=d[3],f=!!s
	e.originalSize(!0),e.target(""),e.youtubeId=p,e.youtubeUri=function(e,t){var r="https://www.youtube.com/embed/"+e+"?showinfo=0&enablejsapi=1&modestbranding=1&disablekb=1&rel=0&iv_load_policy=3&hl="+n.initParams.locale+"&&origin="+function(e){return e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")}(i.location)
	t&&(r+="&autoplay=true")
	return r}(p,f),e.playerId=function(e,t){var n="yt_"+e+"_"+t
	if(l.randomIdEnabled)return n+"_"+Math.random().toString(36).substring(7)
	return n}(r.contentId,p),e.messageId=r.model.key(),e.contentId=r.contentId,e.isMyself=r.isMyself,e.messageTimestamp=r.timestamp,e.lastActionTimestamp=null,e.ytPlayer(!0),e.type(t.urlPreviewType.YT),e.dispose=u.bind(e),e.conversation=a,l.testContext.previewItems[e.playerId]=e,i.setTimeout(v.bind(null,r),n.youtubeWrapDelay)}else e.target("_blank"),o.error("Unmatched yt link: "+c)
	return!!d},l.parseYTLinks=function(e){var t=e.match(/(?:https?:\/\/|\/\/)?(?:www\.|m\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+?&v=))([\w-]{11})(?:[^\s.]*)/gi)
	return t||[]},l.isYT=function(e){return l.parseYTLinks(e).length>0},l.handleClick=function(e){var t=l.testContext.players[e.playerId]
	t?t.getPlayerState()===i.YT.PlayerState.PLAYING?t.pauseVideo():t.playVideo():o.error("Unable to find a player for "+e.playerId)},l.randomIdEnabled=!0,i.onYouTubeIframeAPIReady=function(){r.addEventListener("mozfullscreenchange",l.testContext.onFullscreenChangedHandler),r.addEventListener("webkitfullscreenchange",l.testContext.onFullscreenChangedHandler),r.addEventListener("fullscreenchange",l.testContext.onFullscreenChangedHandler),r.addEventListener("MSFullscreenChange",l.testContext.onFullscreenChangedHandler)}}})),define("ui/urlPreview/urlPreview",["require","exports","module","lodash-compat","swx-cafe-application-instance","swx-constants","browser/dom","swx-telemetry-buckets","utils/common/eventHelper","vendor/knockout","swx-utils-chat","swx-log-tracer","reqwest","swx-service-locator-instance","experience/settings","utils/common/styleModeHelper","telemetry/chat/urlPreviewShow","browser/window","swx-skypeuri-parser","ui/players/ytPlayer"],(function(e,t){var n=e("lodash-compat"),i=e("swx-cafe-application-instance"),r=e("swx-constants").COMMON,o=e("browser/dom"),a=e("swx-telemetry-buckets"),s=e("utils/common/eventHelper"),c=e("vendor/knockout"),l=e("swx-utils-chat").messageSanitizer,u=e("swx-log-tracer").getLogger(),d=e("reqwest"),p=e("swx-service-locator-instance").default,f=e("experience/settings"),m=e("utils/common/styleModeHelper"),h=a.enums.urlPositionBucket,v=e("telemetry/chat/urlPreviewShow"),g=e("browser/window"),y=e("swx-skypeuri-parser"),b=e("ui/players/ytPlayer"),_=.5,E=!1,w=!1,S=""
	function x(e,t){return 1!==t.length||e.replace(t[0],"")?n.endsWith(e,t[t.length-1])?h.TextEndingWithUrl:h.TextWithUrl:h.UrlOnly}function C(e){return e===h.UrlOnly}function T(){if(S)return S
	for(var e=f&&f.version?f.version.split(".",4):[];e.length<4;)e.push("0")
	return e[3]=e[2],e[2]="0",S=e.join(".")}t.render=function(e,t,a,h,S){var I=function(e,t,n){var i=/<a\s+(?:[^>]*?\s+)?href="((?!mailto:)[^"]*)".*?>(.*?)<\/a>/g,r=e.match(i)||[]
	if(t){var o=e.replace(i,"")
	r=r.concat(n.parseYTLinks(o))}if(!r)return
	return r=function(e){return e.filter((function(e,t,n){return t===n.indexOf(e)})).filter((function(e){return!y.containsSkypeUri(e)}))}(r),0===r.length?null:r}(e,h,b),A=p.resolve(r.serviceLocator.FEATURE_FLAGS)
	if(!I)return t.isUrlPreview(!1),t.copyLinkEnabled(!1),t.group(r.activityItemGroups.TEXT),t.contentTemplate("textMessageContentTemplate"),Promise.resolve()
	for(var M,O,k,N,P=function(n){return{urlCount:n.length,urlPosition:x(e,n),participantsCount:a.participantsCount(),contentId:t.contentId}}(I),R=C(P.urlPosition),L=0;L<I.length;L++)I[L]=l.unescapeHTML((M=I[L],O=void 0,(O=/^<a\s+(?:[^>]*?\s+)?href="([^"]*)".*<\/a>$/.exec(M))?O[1]:M))
	function D(e){return function(e,t,n){function r(e){return"200"===e.status_code&&(!!(e.title||e.site||e.description)&&!!e.thumbnail)}return i.get().signInManager._skypeToken().then((function(i){var o,a={url:f.urlPServiceHost+"/v1/url/info?url="+t,method:"GET",crossOrigin:!0,dataType:"json",headers:{Authorization:"skype_token "+i,"X-Client-Version":"908/"+T()}}
	function s(i){return i.urlPreviewShowTelemetryEvent=o,i.urlRequest=e,i.encodedRequest=t,r(i)?(o.succeeded(i.status_code,!!i.thumbnail),new Promise((function(e,t){var r=g.setTimeout(t,3e3),o=new g.Image
	o.onload=function(){g.clearTimeout(r),i.width=this.width,i.height=this.height,i.oneUrlOnly=C(n.urlPosition),e(i)},o.onerror=t.bind(null,i),o.src=i.thumbnail}))):(i.skip=!0,o.error(i.status_code),Promise.reject(i))}function c(e){return(e=e||{}).skip=!0,o.error(e.status_code?e.status_code:null),e}return n.url=e,o=v.build(n),Promise.resolve(d.compat(a)).then(s,c).catch(c)}))}(e,encodeURIComponent(e),P).catch((function(e){return(e=e||{}).skip=!0,e}))}function U(e){if(t._parentContext){t.onBeforeExpanded()
	var i,l,d=0
	e.forEach((function(e){e.skip||function(e,i){var o=c.utils.arrayFirst(t.previews(),(function(t){return t.encodedRequest===e.encodedRequest}))
	if(o)return
	var s,l=b.isYT(e.url),u=(f=e.content_type,"image/gif"===f),d=e.width/e.height,p=l?r.urlPreviewType.YT:u?r.urlPreviewType.GIF:r.urlPreviewType.WWW
	var f
	if(s=!l||!A.isFeatureOn(r.featureFlags.URL_PREVIEW_LOAD_YOUTUBE_PLAYER)||!!e.restrictions,o=function(e){return{description:c.observable(e.description),title:c.observable(e.title),site:c.observable(),url:c.observable(e.url),target:c.observable("_blank"),rel:c.observable("noreferrer noopener"),favicon:c.observable(e.favicon),thumbnail:c.observable(e.thumbnail),category:c.observable(e.category),type:c.observable(r.urlPreviewType.WWW),typeClasses:{youtube:c.observable(!1)},scaledByW:c.observable(!1),scaledByH:c.observable(!1),originalSize:c.observable(!1),tall:c.observable(!1),wide:c.observable(!1),isGif:c.observable(!1),ytPlayer:c.observable(!1),ordinal:0,originalRequest:e.urlRequest,encodedRequest:e.encodedRequest,restrictions:e.restrictions}}(e),o.target(s?"_blank":""),o.type(p),o.isGif(u),o.site(u?"":function(e){return e?n.escape(e):e}(e.site)),o.typeClasses.youtube(l),o.ytEnabled=w,o.ordinal=i,l&&w&&!e.restrictions&&b.render(o,t,a))return void t.previews.push(o)
	if(!E)return
	function h(e){return e>=_&&e<=2&&!m.get().isIntegratedProperty()}if(u||h(d))o.originalSize(!o.isGif()),o.scaledByW(!1),o.scaledByH(!1)
	else{var v=d<_
	o.scaledByW(v),o.scaledByH(!v),o.originalSize(!1)}o.tall(!u&&d<=1),o.wide(!u&&d>1),t.previews.push(o),t.isGif(u)}(e,d++)})),t.onAfterExpanded(),t.copyLinkEnabled(R&&1===t.previews().length),i=t.copyLinkEnabled(),(l=t.elementInfo.element).onkeydown=i?function(e){if(s.isActivation(e))try{var n=o.getElement(".thumbnail",l)
	n?n.click():b.handleClick(t.previews()[0])}catch(i){u.error(i)}}:null}}return t.previews?I=function(e,t){return t.previews.remove((function(t){var n=e.indexOf(t.originalRequest)
	return n>-1&&e.splice(n,1),-1===n})),e}(I,t):t.previews=c.observableArray([]),t.isUrlPreview(!0),t.group(r.activityItemGroups.MEDIA),t.contentTemplate("urlMessageContentTemplate"),(k=i.get().personsAndGroupsManager.mePerson,N=[],N.push(k.preferences(r.userSettings.preferences.URL_PREVIEWS)?k.preferences(r.userSettings.preferences.URL_PREVIEWS).value.get():Promise.resolve(!0)),N.push(k.preferences(r.userSettings.preferences.YOUTUBE_PLAYER)?k.preferences(r.userSettings.preferences.YOUTUBE_PLAYER).value.get():Promise.resolve(!1)),Promise.all(N).then((function(e){E=S&&e[0],w=h&&e[1]}))).then((function(){return E||w?Promise.all(I.map(D)).then(U):Promise.resolve()}))}})),define("telemetry/chat/urlPreviewAction",["require","exports","module","experience/settings","swx-constants","ui/telemetry/telemetryClient","swx-telemetry-buckets","browser/window","services/telemetry/hashingService"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON.telemetry.urlPreviewClicked,r=e("ui/telemetry/telemetryClient"),o=e("swx-telemetry-buckets"),a=e("browser/window"),s=e("services/telemetry/hashingService")
	t.publishActionEvent=function(e){var t,c
	t=e.timestamp,c=(new a.Date).getTime()-t,function(e){var t=i.TYPE,o=e
	r.get().sendEvent(n.telemetry.chatTenantToken,t,o)}({messageIdHash:s.getHash(e.contentId),contentType:o.getUrlContentType(e.url),ttc:c,ttcGroup:o.getMessageLifeDurationGroup(c),participantCount:e.participantCount,participantCountGroup:o.getParticipantCountGroup(e.participantCount)})}})),define("ui/viewModels/chat/message",["require","lodash-compat","ui/telemetry/actions/actionSources","swx-cafe-application-instance","swx-focus-handler","text!views/people/blockContactModal.html","ui/viewModels/people/blockContactModal","utils/common/cafeObservable","constants/components","swx-constants","ui/viewModels/people/contactBuilder","telemetry/chat/contactInfoEvent","ui/contactInfoMessage/contactInfoMessage","ui/viewModels/people/contactName","constants/contentTemplates","swx-encoder/lib/encoders/emoticonEncoder","ui/viewModels/calling/helpers/callingFacade","swx-enums","utils/common/eventMixin","swx-i18n","vendor/knockout","ui/viewModels/chat/messageMediaTypesHandlers","swx-utils-chat","swx-ui-navigation","utils/chat/message","ui/modalDialog/modalDialog","ui/modelHelpers/personHelper","ui/viewModels/chat/pollAvatars","telemetry/chat/poll","telemetry/calling/pstn/pstn","swx-pubsub-instance","swx-service-locator-instance","utils/common/styleModeHelper","ui/viewModels/chat/messageParsers/swiftCard","ui/viewModels/chat/translator/translationItem","ui/viewModels/chat/reactions","utils/chat/translatorHelper","utils/common/disposableMixin","ui/urlPreview/urlPreview","telemetry/chat/urlPreviewAction","ui/players/ytPlayer","ui/modelHelpers/personActionsHelper","swx-utils-chat","utils/chat/quoteMessageUtils","telemetry/chat/quoteMessageEvent","utils/common/clipboard"],(function(e){var t=e("lodash-compat"),n=e("ui/telemetry/actions/actionSources"),i=e("swx-cafe-application-instance"),r=e("swx-focus-handler"),o=e("text!views/people/blockContactModal.html"),a=e("ui/viewModels/people/blockContactModal"),s=e("utils/common/cafeObservable"),c=e("constants/components"),l=e("swx-constants").COMMON,u=e("ui/viewModels/people/contactBuilder"),d=e("telemetry/chat/contactInfoEvent"),p=e("ui/contactInfoMessage/contactInfoMessage"),f=e("ui/viewModels/people/contactName"),m=e("constants/contentTemplates"),h=e("swx-encoder/lib/encoders/emoticonEncoder"),v=e("ui/viewModels/calling/helpers/callingFacade"),g=e("swx-enums"),y=e("utils/common/eventMixin"),b=l.events,_=e("swx-i18n").localization,E=e("vendor/knockout"),w=e("ui/viewModels/chat/messageMediaTypesHandlers"),S=e("swx-utils-chat").messageSanitizer,x=e("swx-ui-navigation"),C=e("utils/chat/message"),T=e("ui/modalDialog/modalDialog"),I=e("ui/modelHelpers/personHelper"),A=e("ui/viewModels/chat/pollAvatars"),M=e("telemetry/chat/poll"),O=e("telemetry/calling/pstn/pstn"),k=e("swx-pubsub-instance").default,N=e("swx-service-locator-instance").default,P=e("utils/common/styleModeHelper"),R=e("ui/viewModels/chat/messageParsers/swiftCard"),L=e("ui/viewModels/chat/translator/translationItem"),D=e("ui/viewModels/chat/reactions"),U=e("utils/chat/translatorHelper"),F=e("utils/common/disposableMixin"),B=e("ui/urlPreview/urlPreview"),V=e("telemetry/chat/urlPreviewAction"),G=e("ui/players/ytPlayer"),H=e("ui/modelHelpers/personActionsHelper"),q=e("swx-utils-chat").conversation,W=e("utils/chat/quoteMessageUtils"),j=e("telemetry/chat/quoteMessageEvent"),z=e("utils/common/clipboard")
	function K(e){var y,K,Y,Q,X,$,J=this,Z=i.get(),ee=!1,te=!(e&&e.noUrlPreview),ne=e&&e.noTranslationItem,ie=N.resolve(l.serviceLocator.FEATURE_FLAGS),re=Z.translatorService&&Z.translatorService.state()===l.translatorServiceState.Authenticated,oe=h.build(),ae=t.assign({},F),se=E.observableArray(),ce=N.resolve(l.serviceLocator.FEATURE_FLAGS).isFeatureOn(l.featureFlags.MARK_READ_MESSAGES_V2_ENABLED)
	function le(e){return m.templates[e]||m.templates[g.activityType.TextMessage]}function ue(){var e,n={},i=J.isRead(),r=J.group()===l.activityItemGroups.TEXT||J.group()===l.activityItemGroups.MEDIA||J.group()===l.activityItemGroups.CONTACT_INFO||J.group()===l.activityItemGroups.POLL||J.group()===l.activityItemGroups.TRANSCRIPT
	return n.me=J.isMyself&&r,n.their=!n.me,n.first=J.isFirstMessage(),n.last=J.isLastMessage(),n.edited=J.isEdited,n.showTimestamp=J.showTimestamp,n.showBottomTimestamp=J.showBottomTimestamp,n.sticker=J.isSticker(),n.spacesWelcomeMessage=ee,n.deliveryFailed=J.deliveryFailed,n.urlPreview=J.isUrlPreview(),n.mojiItem=J.isMoji(),n.integrated=J.isIntegrated,n.picture=J.isPicture(),n.copyLink=J.copyLinkEnabled(),n.lastInBubble=J.isLastMessageInBubble(),n.sms=J.isSMS,n.meCommandMessage=J.isMeCommandMessage,J.isMeCommandMessage&&(n.edited=!1),ce&&(n.read=i,n.unread=!i),t.forIn(l.activityItemGroups,(function(t){(e=t&&t.toLowerCase())&&(n[e]=!1)})),J.group()===l.activityItemGroups.PSTN?n[l.activityItemGroups.CALL]=!0:n[J.group()]=!0,J.group()===l.activityItemGroups.CONTACT_REQUEST&&function(e){function n(){return t.includes([g.activityType.ContactRequestIncoming,g.activityType.ContactRequestOutgoing,g.activityType.ContactRequestOutgoingAgent,g.activityType.SuggestedContact,g.activityType.UnblockContact],J.model.type())}function i(){return t.includes([g.activityType.ContactRequestOutgoingResend,g.activityType.ContactRequestIsNowContact,g.activityType.ContactRequestIncomingInviteFree],J.model.type())}e.contactMessage=n(),e.their=!e.me&&!n(),e.participant=i()}(n),J.group()===l.activityItemGroups.CUSTOM&&(n.participant=!0),t.trim(t.reduce(n,(function(e,t,n){return E.unwrap(t)?e+" "+n:e}),J.customMessageClasses||""))}function de(e){var n,i=s.newObservableProperty(e.context),r=e.persons().filter((function(t){return e.author!==t}))
	if(e.reason&&(n=e.reason()),J.participantsWithoutAuthor=r.map(a),function(e){var t=e.type()===g.activityType.ParticipantJoined,n=e.persons()
	return!(!Y||!t)&&(ee=n.indexOf(Z.personsAndGroupsManager.mePerson)>=0)}(e)){var o=s.newObservableProperty(y.selfParticipant.role)
	J.participantsWithoutMyself=r.filter((function(e){return!I.isMePerson(e)})).map(a),J.contentTemplate(le(l.customActivityItemTemplates.SPACES_WELCOME_MESSAGE)),J.spaceLink=s.newObservableProperty(y.uri),J.isJoiningEnabled=s.newObservableProperty(y.isJoiningEnabled),J.conversation=y,J.showSpacesCTA=E.computed((function(){return o()===g.participantRole.Leader&&!q.isGuestHostConversation(y.conversationId)})),J.welcomeMessage=E.computed((function(){return _.fetch({key:J.isJoiningEnabled()?"spaces_welcomeMessage":"spaces_welcomeMessageWithoutLink"})})),J.agentsMessageContent=E.computed((function(){var e
	if(!y||!y.participants())return e
	return y.participants().forEach((function(n){if(I.isAgent(n.person)){var i=s.newObservableProperty(n.person.displayName),r=t.escape(i()),o=_.fetch({key:"message_text_joiningConversationWithBots",params:{botName:r}}),a=_.fetch({key:"message_text_joiningConversationWithBotsV2",params:{botName:r}})
	e?e+="\n":e="",se.push({subscription:i}),e+=$?a+C.getBotDisclosureMessage(n.person.id(),r,y):o}})),e})),J.editTopicAction=function(){J.dispatchEvent(b.conversation.OPEN_PROFILE,{editTopic:!0},J.DIRECTION.PARENT)},J.settingsAction=function(){J.dispatchEvent(b.conversation.OPEN_PROFILE,{editTopic:!1},J.DIRECTION.PARENT)},J.othersAddedMessageContent=E.computed((function(){if(J.participantsWithoutMyself.length>0)return C.getMessageFromParticipantActivityItem(e.type(),J.author,J.participantsWithoutMyself,i,n,y)}))}function a(e){return new f(e)}return E.computed((function(){return C.getMessageFromParticipantActivityItem(e.type(),J.author,J.participantsWithoutAuthor,i,n,y)}))}function pe(e){e.sender&&(J.author=u.build(e.sender),J.isMyself=I.isMePerson(e.sender),J.displayname=E.observable(J.isMyself?"me":J.author),J.renderAuthorInfo(!J.isMyself),J.showAuthorInfo(!J.isMyself),J.openConversationLabel=E.pureComputed((function(){return _.fetch({key:"label_text_openConversation",params:{displayName:e.sender.displayName()}})}))),J.direction=e.direction&&e.direction()}function fe(e,t){if(t.translation){var n={key:t.translation.key,value:t.translation.users[0].value,mri:t.translation.users[0].mri}
	e.translations.add(n)}}function me(e,n){switch(J.group()){case l.activityItemGroups.PARTICIPANT:J.author=u.build(e.author),J.content=de(e)
	break
	case l.activityItemGroups.CALL:var i=C.getMessageFromCallActivityItem(e,n)
	pe(e),J.content=E.observable(i.text),J.liveSessionDuration=i.duration,J.callAction=i.callAction,J.typeClasses={liveSessionText:!0,"fontSize-h4":!0}
	break
	case l.activityItemGroups.NGC_UPGRADE:J.content=E.observable(C.getMessageFromNgcUpgradeActivityItem(e))
	break
	case l.activityItemGroups.PLUGIN_FREE:J.content=E.observable(C.getMessageFromPluginFreeActivityItem(e))
	break
	case l.activityItemGroups.PSTN:J.content=E.observable(C.getMessageFromPstnActivityItem(e)),e.type()!==g.activityType.PstnInvalidNumber||e.isGroup()?(J.linkContent="",J.linkVisible=!1):(J.linkContent=_.fetch({key:"pstn_invalid_number_return_link"}),J.linkVisible=!0),pe(e),J.callAction="callError",J.typeClasses={liveSessionText:!0,"fontSize-h4":!0}
	break
	case l.activityItemGroups.TEXT:var r,o
	pe(e),r=s.newObservableProperty(e.html),ie.isFeatureOn(l.featureFlags.SWIFT_CARD_RENDERING)&&(o=R.parse(J,e,y)),J.content=void 0!==o?o:E.computed((function(){var t,n=r(),i=Q||!n.trim().length,o=ie.isFeatureOn(l.featureFlags.URL_PREVIEWS),a=ie.isFeatureOn(l.featureFlags.YOUTUBE_PLAYER_ENABLED),s=y._translatorSettings&&y._translatorSettings.isEnabled,c=e.direction&&e.direction()===l.chat.messageType.INCOMING,u=!ne&&re&&s&&c&&!e.isDeleted()
	if(i?n=S.transform(e.text(),"text/typed","text/html"):ie.isFeatureOn(l.featureFlags.ENABLE_RAW_EMOTICONS_RENDERING)&&(n=S.encodeEmoticonsRawRepresentation(n)),J.isMeCommandMessage)try{return t=new RegExp("^"+J.model.sender.displayName()+" "),n.replace(t,"<b>"+J.model.sender.displayName()+"</b> ")}catch(d){return n}return te&&(a||o)&&E.ignoreDependencies((function(){B.render(n,J,y,a,o)})),u&&U.requestTranslation(n,e.direction(),y,fe.bind(null,e)),J.isSticker(oe.hasLargeEmoticon(n)),n})),J.isEdited=s.newObservableProperty(e.isEdited),J.isDeleted=s.newObservableProperty(e.isDeleted),function(){X&&X.dispose()
	X=J.isDeleted.subscribe((function(e){e&&(X.dispose(),X=null,J.group(l.activityItemGroups.TEXT),J.contentTemplate("textMessageContentTemplate"),J.isUrlPreview(!1),J.previews&&(xe(J.previews()),J.previews([])))}))}()
	break
	case l.activityItemGroups.MEDIA:var a=w.fetch(e.type())
	pe(e),a(J,n)
	break
	case l.activityItemGroups.CONTACT_REQUEST:J.author=u.build(e.sender),J.content=E.computed((function(){return C.getMessageFromContactRequestActivityItem(e.type(),J.author.getPerson())})),J.actionInProgress=E.observable(!1),e.type()===g.activityType.ContactRequestIncoming&&(J.greeting=s.newObservableProperty(e.greeting)),!J.isBusinessContactMgmtEnabled||e.type()!==g.activityType.ContactRequestOutgoing&&e.type()!==g.activityType.ContactRequestIsNowContact||e.isRead(!0)
	break
	case l.activityItemGroups.POLL:pe(e),J.pollAvatarsVM=A.build(e,(function(e){J.dispatchEvent(b.userListPopup.POPUP_TOGGLE,e)})),J.isEdited=s.newObservableProperty(e.isEdited),J.isDeleted=s.newObservableProperty(e.isDeleted),J.content=E.observable(_.fetch({key:"poll_message_question_header",params:{pollQuestion:e.pollQuestion()}})),J.pollQuestion=s.newObservableProperty(e.pollQuestion),J.pollAnswers=s.newObservableCollection(e.pollAnswers),J.answerSent=s.newObservableProperty(e.meVoted),J.checkedAnswer=E.observable(),J.checkedAnswerSubscription=e.meCheckedAnswerPositions.changed((function(){J.checkedAnswer(t.isEmpty(e.meCheckedAnswerPositions())?-1:e.meCheckedAnswerPositions()[0])})),J.peopleVotedText=E.observable(),J.peopleVotedNumSubscription=e.peopleVotedNum.changed((function(e){J.peopleVotedText(_.fetch({key:"poll_message_people_voted",params:{count:e}}))})),J.onAnswerClick=function(t){return e.meVoted()?J.checkedAnswer(e.meCheckedAnswerPositions()[0]):(M.activityVote(J.model),J.model.addAnswer(t)),!0}
	break
	case l.activityItemGroups.CONTACT_INFO:pe(e),p.render(e,J,y)
	break
	case l.activityItemGroups.TRANSACTION:pe(e),J.content=E.observable("Unsupported transaction message"),J.group(l.activityItemGroups.TEXT)
	break
	case l.activityItemGroups.SYSTEM:case l.activityItemGroups.CUSTOM:J.content=E.observable(e.text())
	break
	case l.activityItemGroups.TRANSCRIPT:J.content=E.observable(e.text()),J.author=e.author(),J.isMyself=e.isMyself(),J.renderAuthorInfo(!J.isMyself),J.showAuthorInfo(!J.isMyself)}}function he(){J.showSpacesCTA&&J.showSpacesCTA.dispose(),J.welcomeMessage&&J.welcomeMessage.dispose(),J.othersAddedMessageContent&&J.othersAddedMessageContent.dispose(),J.participantsWithoutMyself&&t.forEach(J.participantsWithoutMyself,(function(e){e.dispose()})),J.participantsWithoutAuthor&&t.forEach(J.participantsWithoutAuthor,(function(e){e.dispose()}))}function ve(e){var t=J.model.type()===g.activityType.ParticipantJoinFailed,n="iconfont "
	switch(J.deliveryFailed(!1),e){case g.activityStatus.Failed:J.deliveryFailed(!t),J.statusText(_.fetch({key:"message_failed_status"})),n+="warning"
	break
	case g.activityStatus.Succeeded:J.statusText(_.fetch({key:"message_sent_status"})),n+="presenceOnlineStroke"
	break
	case g.activityStatus.Pending:J.statusText(_.fetch({key:"message_sending_status"})),n+="presenceStroke"
	break
	default:J.statusText("")}J.deliveryStatusIconCssClass(n)}function ge(e){if(y.selfParticipant.isAnonymous()||I.isGuest(e))return!1
	var t
	t=Z.conversationsManager.getConversation(e),Z.conversationsManager.conversations.add(t),k.publish(b.navigation.OPEN_CONVERSATION,{model:t,origin:l.telemetry.historyLoadOrigin.AUTHOR_SWITCH})}function ye(e){J.contacts&&!J.isMyself&&p.handleContactAdded(e.id(),J)}function be(e){var t
	return J.model.contacts().some((function(n){n.id()===e&&(t=n)})),t}function _e(e){e?J.model.status.changed(ve):J.messageDeliveryStatusEnabled&&J.model.status.changed.off(ve)}function Ee(){J.actionInProgress(!1)}function we(e){e&&e.giphyExpression?J.giphyMetadata("/giphy "+e.giphyExpression):J.giphyMetadata(!1)}function Se(){K&&K()}function xe(e){e.forEach((function(e){t.isFunction(e.dispose)&&(e.ytPlayer(!1),e.dispose.call(e))}))}this.autoDisposer=ae,this.init=function(e,t){var n=N.resolve(l.serviceLocator.FEATURE_FLAGS),i=e.key()
	Y=n.isFeatureOn(l.featureFlags.SPACES),Q=n.isFeatureOn(l.featureFlags.MESSAGE_ENFORCE_TEXT_FORMAT),$=ie.isFeatureOn(l.featureFlags.BOT_MESSAGES_MODE_V2_ENABLED),y=t,J.isEdited=E.observable(!1),J.messageDeliveryIndicatorEnabledSW4B=n.isFeatureOn(l.featureFlags.SHOW_MESSAGE_DELIVERY_INDICATOR_SW4B),J.messageDeliveryStatusEnabled=n.isFeatureOn(l.featureFlags.SHOW_MESSAGE_DELIVERY_STATUS)&&e.type()!==g.activityType.SystemMessage,J.timestampsInNarrowModeEnabled=n.isFeatureOn(l.featureFlags.SHOW_TIMESTAMPS_IN_NARROW_MODE),J.disableOpenConversationWithAuthor=n.isFeatureOn(l.featureFlags.DISABLE_OPEN_CONVERSATION_WITH_AUTHOR),J.isDeleted=E.observable(!1),J.isMyself=!1,J.clientmessageid=i,J.contentId=i?"msg_"+i:null,J.timestamp=e.timestamp(),J.setTimestamp=E.observable("00:00"),J.setBottomTimestamp=E.observable("00:00"),J.setLongTimestamp=E.observable("00:00"),J.showTimestamp=E.observable(!0),J.showBottomTimestamp=E.observable(!1),J.isRead=s.newObservableProperty(e.isRead),J.isFirstMessage=E.observable(!1),J.isLastMessage=E.observable(!1),J.isLastMessageInBubble=E.observable(!1),J.model=e,J.group=E.observable(C.getActivityItemGroup(e.type())),J.isGroupConversation=y.isGroupConversation(),J.conversationId=t.conversationId,J.renderAuthorInfo=E.observable(!1),J.showAuthorInfo=E.observable(!1),J.liveSessionDuration=!1
	J.isCallActivityItem=E.computed((function(){return J.group()===l.activityItemGroups.CALL||J.group()===l.activityItemGroups.PSTN})),J.isSticker=E.observable(),J.isMoji=E.observable(!1),J.isPicture=E.observable(!1),J.isUrlPreview=E.observable(!1),J.deliveryFailed=E.observable(!1),J.deliveryFailedMessage=E.computed((function(){return J.deliveryFailed()?_.fetch({key:"message_not_delivered_text"}):""})),J.statusText=E.observable(),J.deliveryStatusIconCssClass=E.observable(),J.isMyLastMessageInChat=E.observable(!1),J.isIntegrated=P.get().isIntegratedProperty(),J.copyLinkEnabled=E.observable(!1),J.giphyMetadata=E.observable(!1),J.isGif=E.observable(!1),J.isSMS=!!e._isSMS&&e._isSMS(),J.smsStatus=J.isSMS?s.newObservableProperty(e._smsInfo().status):{},J.suggestedActions=E.observableArray([]),J.reactionsVM=D.build(J),J.contentTemplate=E.observable(le(e.type())),J.focusImportance=N.resolve(l.serviceLocator.FEATURE_FLAGS).isFeatureOn(l.featureFlags.LOW_FOCUS_IMPORTANCE_CONTACT_REQUEST)?r.Priorities.Low:r.Priorities.High,J.typeClasses={},J.isMeCommandMessage=!!e._skypeemoteoffset,me(e,y.isGroupConversation()),J.cssClass=E.computed(ue,this),J.showGiphyMetadata=E.computed((function(){return J.isGif()&&!J.isDeleted()&&J.giphyMetadata()})),J.focusHandlerCallback=function(e){K=e},J.messageDeliveryIndicatorEnabledSW4B&&J.model.status.changed(ve),J.messageDeliveryStatusEnabled&&J.isMyLastMessageInChat.subscribe(_e),Z.personsAndGroupsManager.all.persons.added(ye),ne||(J.translationItem=L.build(J,y),J.translationItem.init())
	J.model._activityData&&J.model._activityData.changed(we),J.isCopySelectionAsQuoteEnabled=ie.isFeatureOn(l.featureFlags.COPY_SELECTION_AS_QUOTE_KEYBOARD)&&z.isCopySupportedByBrowser(),J.forwardEvent(b.videoPlayer.FULLSCREEN_ON,J.DIRECTION.PARENT,null,J.DIRECTION.CHILD),J.forwardEvent(b.videoPlayer.FULLSCREEN_OFF,J.DIRECTION.PARENT,null,J.DIRECTION.CHILD),J.registerEvent(b.navigation.FRAGMENT_SHOW,Se)},J.onCopy=function(e){var t=e.model,i=document.getSelection().toString(),r=W.copySelectionAsQuote(t,i,Z.conversationsManager),o=n.selectionCopyKeyboard
	j.publish(t,o,r)},this.dispose=function(){X&&X.dispose(),J.content&&J.content.dispose&&J.content.dispose(),J.deliveryFailedMessage&&J.deliveryFailedMessage.dispose(),J.cssClass&&J.cssClass.dispose(),J.author&&J.author.dispose&&J.author.dispose(),J.isCallActivityItem&&J.isCallActivityItem.dispose(),J.checkedAnswerSubscription&&J.checkedAnswerSubscription.dispose&&J.checkedAnswerSubscription.dispose(),J.peopleVotedNumSubscription&&J.peopleVotedNumSubscription.dispose&&J.peopleVotedNumSubscription.dispose(),J.isSMS&&J.model._smsInfo&&J.model._smsInfo().dispose(),he(),J.model&&(J.messageDeliveryIndicatorEnabledSW4B||J.messageDeliveryStatusEnabled)&&J.model.status.changed.off(ve),J.showGiphyMetadata&&J.showGiphyMetadata.dispose(),J.reactionsVM&&J.reactionsVM.dispose(),Z.personsAndGroupsManager.all.persons.added.off(ye),J.model&&J.model._activityData&&J.model._activityData.changed.off(we),J.translationItem&&J.translationItem.dispose(),J.previews&&(xe(J.previews()),J.previews([])),ae.dispose&&ae.dispose(),se().length&&se().forEach((function(e){e.subscription.dispose()}))},this.onRendered=function(){J.isRendered=!0,J.dispatchEvent(b.message.RENDERED)},this.onBeforeExpanded=function(){J.dispatchEvent(b.message.BEFORE_EXPANDED)},this.onAfterExpanded=function(){J.dispatchEvent(b.message.AFTER_EXPANDED)},this.openConversationWithAuthor=function(){ge(J.model.sender)},this.navigateToDialPad=function(){k.publish(l.events.navigation.NAVIGATE,{page:c.calling.SKYPEOUT_PAGE,origin:l.telemetry.historyLoadOrigin.SKYPEOUT_PAGE})},this.isBusinessContactMgmtEnabled=ie.isFeatureOn(l.featureFlags.ENABLE_BUSINESS_CONTACT_MANAGEMENT),this.sendContactRequest=function(){var e,t={source:n.conversation.messageItem},i=J.model.sender,r=J.model.type()
	return J.actionInProgress(!0),Z.conversationsManager.conversations.add(y),(e=H.addPerson(i,r,y,t)).then(Ee,Ee),J.dispatchEvent(b.message.ADD_CONTACT,{source:n.conversation.messageItem},J.DIRECTION.PARENT),e},this.acceptContactRequest=function(){var e={source:n.conversation.messageItem},t=J.model.sender
	return J.actionInProgress(!0),H.addPerson(t,g.activityType.ContactRequestIncoming,y,e,Ee,Ee)},this.declineContactRequest=function(){var e={source:n.conversation.messageItem},t=J.model.sender
	return J.actionInProgress(!0),H.declinePerson(t,y,e,Ee,Ee)},this.blockContactRequest=function(){var e={source:n.contactRequestIncomingActivityItem},t=new a(J.author.getPerson(),e),i=_.fetch({key:"modal_blockContact_text_aria_label"})
	return T.build(a.ELEMENT_ID,t,o),T.show(a.ELEMENT_ID,i),Promise.resolve()},this.unblockContact=function(){var e={source:n.contactRequestIncomingActivityItem},t=J.model.sender
	return J.actionInProgress(!0),H.unblockPerson(t,e,Ee,Ee)},this.openUrlPreview=function(e,t){var n=function(){if(!ie.isFeatureOn(l.featureFlags.URL_PREVIEW_LOAD_YOUTUBE_PLAYER))return!1
	var n=t||E.utils.arrayFirst(J.previews(),(function(t){return t.url()===e}))
	return n&&n.type()===l.urlPreviewType.YT&&!n.restrictions?n:null}(),i={url:e,timestamp:J.timestamp,participantCount:y.participantsCount(),contentId:J.contentId}
	if(V.publishActionEvent(i),n&&G.render(n,J,y,e))return!1
	var r=window.open()
	return r.opener=null,r.location=e,!1},this.isPSTNContactMessage=function(e){var t=be(e)
	return I.isPstn(t)},this.contactHasFullName=function(e){var t=be(e)
	return t.displayName()!==e||I.isPstn(t)},this.isMePersonContactMessage=function(e){return I.isMePersonId(e)},this.openConversationWithUser=function(e){var t=be(e)
	ge(t),d.publishActionEvent({person:t,participantsCount:y.participantsCount(),timeInStale:J.timestamp.getTime()})},this.addCreditTelemetry=function(e,t){var n=l.telemetry.pstn
	return t.target.className===n.cssClasses.ADD_CREDIT?O.addingCredit(n.entryPoint.NO_CREDIT_CALL_END):t.target.className===n.cssClasses.ADD_SUBSCRIPTION&&O.addingSubscription(n.entryPoint.NO_SUBSCRIPTION_CALL_END),!0},this.activateFirstLink=function(e,t){var n=e.elementInfo.element.querySelector(".content a")
	n&&"A"!==t.target.tagName&&(n.click(),t.preventDefault(),t.stopPropagation())},this.messageClicked=function(e,t){t.target&&t.target.href&&(x.navigate(t.target.href,v),t.preventDefault(),t.stopPropagation())}}return t.assign(K.prototype,y),K})),define("ui/viewModels/chat/conversationProcessor",["require","lodash-compat","swx-utils-chat","swx-constants"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-chat").dateTime,i=e("swx-constants").COMMON,r=function(e){return n.getMidnight(e)},o=function(e){if(e&&e.isMeCommandMessage)return!1
	if(e&&t.isFunction(e.group))switch(e.group()){case i.activityItemGroups.TEXT:case i.activityItemGroups.MEDIA:case i.activityItemGroups.CONTACT_INFO:case i.activityItemGroups.POLL:case i.activityItemGroups.TRANSCRIPT:case i.activityItemGroups.CALL:case i.activityItemGroups.PSTN:return!0}return!1},a=function(e){return!!(e&&e.messageDeliveryStatusEnabled&&e.deliveryFailed())},s=function(e){return!(!e||!(e.playerId||t.isFunction(e.group)&&e.group()===i.activityItemGroups.MEDIA))}
	return function(){this.processMessage=function(e,t){var c,l,u=e.group()===i.activityItemGroups.TEXT,d=e.group()===i.activityItemGroups.MEDIA,p=e.group()===i.activityItemGroups.CONTACT_INFO,f=e.group()===i.activityItemGroups.CALL,m=e.group()===i.activityItemGroups.POLL,h=e.group()===i.activityItemGroups.PSTN,v=e.group()===i.activityItemGroups.PARTICIPANT,g=e.group()===i.activityItemGroups.TRANSCRIPT,y=u||d||p||m||g,b=o(e),_=f||d||h,E=e.author&&e.author.id(),w=function(e,t){return void 0===t||e!==t}(t.previousAuthor,E),S=t.midnight||r((new Date).getTime()),x=(c=t.previousTimestamp,l=e.timestamp,r(l)!==r(c)),C=_||w||x||s(e)||function(e,t,n){return e>t&&e-n>=3e5}(e.timestamp,S,t.lastShowedTimestamp),T=w||x||v||s(t.previousMessage),I=!e.isMyself,A=y&&(w||!!t.suppressedLastAuthor),M=b&&(C||!!t.suppressedLastTimestamp),O=n.formatTimestamp(e.timestamp,S),k=n.formatTimestampLong(e.timestamp,S),N=n.formatTimestampForceLong(e.timestamp),P=t.previousMessage&&M&&!A&&!t.previousMessage.showTimestamp()||v,R=o(t.previousMessage)&&T&&!a(t.previousMessage)
	return e.isFirstMessage(y&&(e.isDisjoined||t.previousIsDisjoined||A)),e.isLastMessage(!0),e.showAuthorInfo(I&&e.isFirstMessage()),e.showTimestamp(M),e.setTimestamp(O),e.showBottomTimestamp(b&&!a(e)),e.setBottomTimestamp(k),e.setLongTimestamp(N),M&&(t.lastShowedTimestamp=e.timestamp),t.previousMessage&&(t.previousMessage.isLastMessageInBubble(P),t.previousMessage.showBottomTimestamp(R)),t.previousAuthor=E,t.previousTimestamp=e.timestamp,t.suppressedLastAuthor=!y,t.suppressedLastTimestamp=!b||d,t.midnight=S,t.previousIsDisjoined=e.isDisjoined,t.previousMessage=e,t},this.processMyLastMessageIfAny=function(e){var t
	if(!(e.length<=0))for(t=e.length-1;t>=0;t--)if(e[t].isMyself)return e[t].isMyLastMessageInChat(!0),void e[t].showBottomTimestamp(!e[t].messageDeliveryStatusEnabled&&e[t].showBottomTimestamp())},this.processMyBeforeLastMessageIfAny=function(e){var t,n=!1
	if(!(e.length<=1))for(t=e.length-1;t>=0;t--)if(e[t].isMyself&&e[t].isMyLastMessageInChat()){if(n)return void e[t].isMyLastMessageInChat(!1)
	n=!0}}}})),define("telemetry/utils/telemetryUtils",["require","exports","module","swx-constants"],(function(e,t){var n=e("swx-constants").COMMON.telemetry.NOT_AVAILABLE
	t.stringify=function(e){for(var t in e)e.hasOwnProperty(t)&&!("string"==typeof e[t]||e[t]instanceof String)&&(e[t]=e[t]+"")
	return e},t.getOriginDescription=function(e,t){for(var i in t)if(t.hasOwnProperty(i)&&t[i]===e)return i
	return n}})),define("telemetry/chat/activityItemHelper",["require","swx-constants","swx-encoder/lib/encoders/emoticonEncoder","swx-enums"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-encoder/lib/encoders/emoticonEncoder"),i=e("swx-enums"),r="Event/SkypeVideoMessage",o="RichText/UriObject",a="RichText/Location",s="Event/Call",c="RichText/Files",l="RichText",u="RichText/Contacts",d="Text"
	return new function(){function e(e,t){return 0!=(e&t)}function p(e){return e.originalContent||e.content}this.updateResult=function(n,i){switch(i){case t.telemetry.messageTypes.MEDIA_VIDEO:n.media.video++
	break
	case t.telemetry.messageTypes.MEDIA_PICTURE:n.media.picture++
	break
	case t.telemetry.messageTypes.MEDIA_LOCATION:n.media.location++
	break
	case t.telemetry.messageTypes.CALLING_OTHER:n.calling.total++
	break
	case t.telemetry.messageTypes.FILES_PICTURE:n.files.picture++
	break
	case t.telemetry.messageTypes.FILES_VIDEO:n.files.video++
	break
	case t.telemetry.messageTypes.FILES_OFFICE:n.files.office++
	break
	case t.telemetry.messageTypes.FILES_ARCHIVE:n.files.zip++
	break
	case t.telemetry.messageTypes.FILES_BINARY:n.files.binary++
	break
	case t.telemetry.messageTypes.FILES_PDF:n.files.pdf++
	break
	case t.telemetry.messageTypes.CONTACT_OTHER:n.contact.total++
	break
	case t.telemetry.messageTypes.TEXT_ME:n.text.me++
	break
	case t.telemetry.messageTypes.OTHER_TYPES:n.other++
	break
	default:if(!e(i,t.telemetry.messageTypes.FILES_MASK|t.telemetry.messageTypes.RICHTEXT_MASK|t.telemetry.messageTypes.TEXT_MASK))throw new Error("Not supported:"+i)}e(i,t.telemetry.messageTypes.FILES_MASK)&&n.files.total++,e(i,t.telemetry.messageTypes.RICHTEXT_MASK)&&function(n,i){e(i,t.telemetry.messageTypes.RICHTEXT_MASK)&&(e(i,t.telemetry.messageTypes.RICHTEXT_FORMAT)&&n.richtext.format++,e(i,t.telemetry.messageTypes.RICHTEXT_EMOTICONS)&&n.richtext.emoticons++,e(i,t.telemetry.messageTypes.RICHTEXT_ME)&&n.richtext.me++,n.richtext.total++)}(n,i),e(i,t.telemetry.messageTypes.TEXT_MASK)&&n.text.total++},this.getEmptyResult=function(){return{media:{picture:0,video:0,location:0},files:{total:0,picture:0,video:0,office:0,zip:0,binary:0,pdf:0},richtext:{total:0,format:0,emoticons:0,me:0},text:{total:0,me:0},contact:{total:0},calling:{total:0},other:0}},this.getTelemetryMessageType=function(e){switch(e.type()){case i.activityType.VideoMessage:return t.telemetry.messageTypes.MEDIA_VIDEO
	case i.activityType.PictureMessage:return t.telemetry.messageTypes.MEDIA_PICTURE
	case i.activityType.CallStarted:case i.activityType.CallEnded:case i.activityType.CallMissed:return t.telemetry.messageTypes.CALLING_OTHER
	case i.activityType.TextMessage:var r=0
	return e.html().indexOf("raw_pre")>-1&&(r|=t.telemetry.messageTypes.RICHTEXT_FORMAT),n.build().hasEmoticons(e.html())&&(r|=t.telemetry.messageTypes.RICHTEXT_EMOTICONS),0===r?t.telemetry.messageTypes.RICHTEXT_OTHER:r
	case i.activityType.CONTACTS:return t.telemetry.messageTypes.CONTACT_OTHER
	default:return t.telemetry.messageTypes.OTHER_TYPES}},this.getTelemetryMessageTypeObsolete=function(e){switch(e.messagetype){case r:return t.telemetry.messageTypes.MEDIA_VIDEO
	case o:return t.telemetry.messageTypes.MEDIA_PICTURE
	case a:return t.telemetry.messageTypes.MEDIA_LOCATION
	case s:return t.telemetry.messageTypes.CALLING_OTHER
	case c:switch(new RegExp(".([a-z0-9]{1,4})<","i").exec(p(e))[1]){case"png":case"jpg":case"gif":case"bmp":return t.telemetry.messageTypes.FILES_PICTURE
	case"avi":case"mp4":case"mkv":return t.telemetry.messageTypes.FILES_VIDEO
	case"xls":case"xlsx":case"doc":case"docx":case"ppt":case"pptx":return t.telemetry.messageTypes.FILES_OFFICE
	case"zip":case"rar":case"ace":case"7z":return t.telemetry.messageTypes.FILES_ARCHIVE
	case"exe":case"msi":case"iso":return t.telemetry.messageTypes.FILES_BINARY
	case"pdf":return t.telemetry.messageTypes.FILES_PDF
	default:return t.telemetry.messageTypes.FILES_OTHER}break
	case l:var n=0
	return p(e).indexOf("raw_pre")>-1&&(n|=t.telemetry.messageTypes.RICHTEXT_FORMAT),p(e).indexOf("<ss")>-1&&(n|=t.telemetry.messageTypes.RICHTEXT_EMOTICONS),e.skypeemoteoffset&&(n|=t.telemetry.messageTypes.RICHTEXT_ME),0===n?t.telemetry.messageTypes.RICHTEXT_OTHER:n
	case u:return t.telemetry.messageTypes.CONTACT_OTHER
	case d:return e.skypeemoteoffset?t.telemetry.messageTypes.TEXT_ME:t.telemetry.messageTypes.TEXT_OTHER
	default:return t.telemetry.messageTypes.OTHER_TYPES}},this.processConversation=function(e){var t,n=this.getEmptyResult(),i=e.historyService.activityItems()
	for(t=0;t<i.length;t++){var r=i[t],o=this.getTelemetryMessageType(r)
	this.updateResult(n,o)}return n}}})),define("telemetry/chat/conversationHistoryLoad",["require","swx-constants","experience/settings","services/telemetry/skypeData","services/telemetry/common/telemetryContext","telemetry/utils/telemetryUtils","swx-telemetry-buckets","telemetry/chat/activityItemHelper"],(function(e){var t=e("swx-constants").COMMON,n=e("experience/settings"),i=e("services/telemetry/skypeData"),r=e("services/telemetry/common/telemetryContext"),o=e("telemetry/utils/telemetryUtils"),a=e("swx-telemetry-buckets"),s=e("telemetry/chat/activityItemHelper"),c=t.telemetry.conversationHistoryLoadEvent
	return function(e){var l=this
	l._context={timer:null,startTime:null,syncEndTime:null,renderEndTime:null,SYNC_TIMEOUT:1e4,conversationLoaded:e,pageNumber:0,isUnread:0,hasError:!1,isCached:t.telemetry.NOT_AVAILABLE,timeInStale:t.telemetry.NOT_AVAILABLE},function(){var t=e.historyService.activityItems(),n=t[t.length-1]
	if(l._context.isUnread=!1,n&&(l._context.isUnread=!n.isRead(),l._context.timeInStale=0,l._context.isUnread)){var i=+new Date
	l._context.timeInStale=(i-n.timestamp())/1e3}}(),l.start=function(){l._context.startTime=(new Date).getTime(),l._context.timer=setTimeout(l.publish,l._context.SYNC_TIMEOUT)},l.registerSync=function(){l._context.timer||(l._context.pageNumber++,l.start()),l._context.syncEndTime=(new Date).getTime(),l._context.renderEndTime=l._context.syncEndTime},l.registerRender=function(){l._context.renderEndTime=(new Date).getTime()},l.registerError=function(){l._context.hasError=!0,l._context.syncEndTime=(new Date).getTime(),l.publish()},l.dispose=function(){l._context.conversationLoaded=null},l.publish=function(){l._context.timer&&(clearTimeout(l._context.timer),l._context.timer=null)
	var u,d=s.processConversation(e),p=r.get(),f=c.TYPE,m=p.chatHistoryLoadResult[e.conversationId]
	return d.participantsCount=e.participants().length,d.participantsCountGroup=a.getParticipantCountGroup(e.participants().length),d.isFavorite=!!e._isFavorited&&e._isFavorited(),d.ttl=l._context.syncEndTime-l._context.startTime,d.ttlDurationGroup=a.getSecondsDurationGroupFromMs(d.ttl),d.tis=l._context.timeInStale,d.isUnread=l._context.isUnread,d.pageNumber=l._context.pageNumber,d.responseCode=m,l._context.hasError?d.ttr=t.telemetry.NOT_AVAILABLE:d.ttr=l._context.renderEndTime-l._context.startTime,d.ttrDurationGroup=a.getSecondsDurationGroupFromMs(d.ttr),d.origin=p.historyLoadOrigin,d.originDescription=o.getOriginDescription(p.historyLoadOrigin,t.telemetry.historyLoadOrigin),d.t404=p.isChatHistoryLoad404,d.isError=a.isError(m),u={type:f,data:d},i.push(u,n.telemetry.uiTenantToken),l.dispose(),d}}})),define("text!views/chat/chatLog.html",[],(function(){return'<div class="conversation scrollable scrollViewport scrollViewportV" data-bind="event: { scroll: onScroll, mouseover: onMouseOver, mouseout: onMouseOut }" tabindex="-1">\r\n    <div class="history scrollViewport-inner">\r\n        <div class="scroller">\r\n            \x3c!-- ko if: showIntroText --\x3e\r\n            <div class="chatLogIntroText" data-bind="foreach: introMessages">\r\n                <p data-bind="text: $data.text" tabindex="-1"></p>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="messageHistory largeAllowed" role="list" data-swx-testId="messageHistory" data-bind="foreach: collection, css: { visible: collection().length > 0 }, keyboardNavigation: { itemSelector: \'swx-message, [tabindex=\\\'-1\\\']:not([disabled])\', selectLastItem: true }">\r\n                <swx-message role="listitem" params="viewModel: $data" data-bind="css: $data.cssClass, attr: { \'data-id\': $data.clientmessageid }, enterKey: activateFirstLink" class="message showName loading" tabindex="-1" aria-relevant="all"></swx-message>\r\n            </div>\r\n            <swx-typing-indicator class="typingIndicator" params="participants: participants"></swx-typing-indicator>\r\n            \x3c!-- ko if: suggestedActionsEnabled --\x3e\r\n            <div class="suggested-actions" data-bind="css: {\'show-suggested-actions\': showSuggestedActions()}">\r\n                <div class="navBtnWrapper" data-bind="click: scrollLeft, css: { disabled: !hasSuggestedActionOnLeft()}">\r\n                    <span class="button prev iconfont" role="button" tabindex="0"></span>\r\n                </div>\r\n                <div id="chatlog-suggestedActionsArea" class="actionItems" data-bind="scroll: suggestionsChanged">\r\n                    \x3c!-- ko if: showBotDetails --\x3e\r\n                    <swx-avatar class="avatar" params="isGroupAvatar: false, avatar: suggestedActionsAuthor.avatar, isAgent: suggestedActionsAuthor.isAgent, displayName: suggestedActionsAuthor.displayName, useAbsolutePosition: false"></swx-avatar>\r\n                    \x3c!-- /ko --\x3e\r\n                    \x3c!-- ko foreach: suggestedActions --\x3e\r\n                    <div class="actionItem" data-bind="click: action">\r\n                        \x3c!-- ko if: type === \'openUrl\' --\x3e\r\n                        <span class="iconfont screenshare icon"></span>\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: type === \'call\' --\x3e\r\n                        <span class="iconfont callStart icon"></span>\r\n                        \x3c!-- /ko --\x3e\r\n                        <span class="text" data-bind="html: title"></span>\r\n                    </div>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n                <div class="navBtnWrapper" data-bind="click: scrollRight, css: { disabled: !hasSuggestedActionOnRight()}">\r\n                    <span class="button next iconfont" role="button" tabindex="0"></span>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/chatLog",["require","exports","module","vendor/knockout","ui/viewModels/chat/chatLog","jsviews/chat/chatLog","ui/viewModels/chat/message","ui/viewModels/chat/conversationProcessor","utils/common/resizeHandler","telemetry/chat/conversationHistoryLoad","constants/components","text!views/chat/chatLog.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/chatLog"),r=e("jsviews/chat/chatLog"),o=e("ui/viewModels/chat/message"),a=e("ui/viewModels/chat/conversationProcessor"),s=e("utils/common/resizeHandler"),c=e("telemetry/chat/conversationHistoryLoad")
	t.name=e("constants/components").chat.CHAT_LOG,t.template=e("text!views/chat/chatLog.html"),t.viewModel={createViewModel:function(e,t){var l=new r(t.element,s),u=n.dataFor(t.element),d=new i(o,u),p=new a,f=new c(e.conversationModel)
	return d.setContext(u),d.init(e.conversationModel,l,p,f),d}}})),define("telemetry/chat/pes",["require","lodash-compat","swx-constants","swx-utils-common","experience/settings","ui/telemetry/telemetryClient","swx-service-locator-instance","utils/common/styleModeHelper"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("swx-utils-common").guid,r=e("experience/settings"),o=e("ui/telemetry/telemetryClient"),a=e("swx-service-locator-instance").default,s=e("utils/common/styleModeHelper")
	return new function(){function e(e){return e||n.telemetry.NOT_AVAILABLE}this.emoticonsSentInMessage=function(e,a){var s=i.create()
	e.forEach((function(e){var i,c,l,u=(i=e,c=a,(l=t.find(c,(function(e){return e.item.id===i})))?(c.splice(c.indexOf(l),1),l):{type:n.telemetry.pes.source.TYPED,section:n.telemetry.pes.UNKNOWN,tabName:n.telemetry.pes.UNKNOWN,tabIndex:n.telemetry.pes.UNKNOWN})
	o.get().sendEvent(r.telemetry.chatTenantToken,n.telemetry.pes.eventName.EMO_SENT,{message_id:s+"",emo_id:e+"",emo_source:u.type+"",emo_section:u.section+"",emo_tab_name:u.tabName+"",emo_tab_index:u.tabIndex+""})}))},this.mojiPlayed=function(e,t){o.get().sendEvent(r.telemetry.chatTenantToken,n.telemetry.pes.eventName.MOJI_PLAYED,{moji_id:e.id+"",moji_name:e.pickerTitle+"",cause:t+""})},this.mojiSent=function(e,t){o.get().sendEvent(r.telemetry.chatTenantToken,n.telemetry.pes.eventName.MOJI_SENT,{moji_id:e.id+"",moji_name:e.pickerTitle+"",moji_source:t.type+"",moji_section:t.section+"",moji_tab_name:t.tabName+"",moji_tab_index:t.tabIndex+""})},this.imageSent=function(t,i){o.get().sendEvent(r.telemetry.chatTenantToken,n.telemetry.pes.eventName.IMAGE_SENT,{image_id:t.id+"",image_query:e(i.query)+"",image_picker_index:t.pickerIndex+"",image_source:i.type+"",image_section:i.section+"",image_tab_name:i.tabName+"",image_tab_index:i.tabIndex+"",image_result_type:e(t.querySource)+""})},this.expressionPickerOpened=function(){var e={}
	e.mediaBarV2Enabled=a.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.MEDIA_BAR_V2_ENABLED),e.styleMode=s.get().currentMode(),o.get().sendEvent(r.telemetry.chatTenantToken,n.telemetry.pes.eventName.PICKER_OPENED,e)}}})),define("ui/modelObservers/agentAuthorizationObserver",["require","exports","module","vendor/knockout","swx-cafe-application-instance","ui/modelHelpers/conversationHelper","ui/modelHelpers/personHelper"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-cafe-application-instance"),r=e("ui/modelHelpers/conversationHelper"),o=e("ui/modelHelpers/personHelper")
	function a(e){var t=this
	function a(){var n=e.participants()[0].person,i=o.isKnownPerson(n)
	t.isConversationWithUnauthorizedAgent(!i)}t.isConversationWithUnauthorizedAgent=n.observable(!1),t.dispose=function(){i.get().personsAndGroupsManager.all.persons.changed.off(a)},r.isOneToOneConversationWithAgent(e)&&i.get().personsAndGroupsManager.all.persons.changed(a)}t.build=function(e){return new a(e)}})),define("ui/viewModels/chat/chatInput",["require","lodash-compat","vendor/knockout","swx-pubsub-instance","utils/common/cafeObservable","swx-constants","swx-constants","utils/common/eventMixin","swx-constants","swx-service-locator-instance","telemetry/chat/pes","ui/modelObservers/agentAuthorizationObserver","utils/common/styleModeHelper","ui/modelHelpers/conversationHelper","ui/modelHelpers/personHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-pubsub-instance").default,r=e("utils/common/cafeObservable"),o=e("swx-constants").COMMON.events,a=e("swx-constants").CALLING,s=e("utils/common/eventMixin"),c=e("swx-constants").COMMON,l=e("swx-service-locator-instance").default,u=e("telemetry/chat/pes"),d=e("ui/modelObservers/agentAuthorizationObserver"),p=e("utils/common/styleModeHelper"),f=e("ui/modelHelpers/conversationHelper"),m=e("ui/modelHelpers/personHelper"),h=c.styleMode
	function v(){var e,s,v,g=this,y=l.resolve(c.serviceLocator.FEATURE_FLAGS)
	function b(){return!!g.conversationModel}function _(e){y.isFeatureOn(c.featureFlags.GIPHY)&&(/^\/giphy\b/.test(e)?A("giphy"):A(null)),g.isSendDisabled(!e||0===e.length)}function E(e){if(b()&&e.conversation===g.conversationModel)switch(e.item.type){case"flik":g.conversationModel.chatService.sendMessage("/moji "+e.item.mojiId),function(e){var n=t.find(e.sourceTab.packs,(function(t){return t.items.some((function(t){return t===e.item}))})),i={type:"mru"===e.sourceTab.id?c.telemetry.pes.source.RECENTS:c.telemetry.pes.source.ROSTER,tabIndex:e.sourceTab._index||e.sourceTab.index,tabName:e.sourceTab.title,section:n&&n.isFeatured?c.telemetry.pes.section.FEATURED:c.telemetry.pes.section.REGULAR}
	u.mojiSent(e.item,i)}(e),l.resolve(c.serviceLocator.PES_MRU_SERVICE).addItemsToMru(e.item)
	break
	case"image":e.query?g.conversationModel.chatService.sendMessage(e.item.url,null,{activityData:_stringify({giphyExpression:e.query})}):g.conversationModel.chatService.sendMessage(e.item.url),function(e){var n=t.find(e.sourceTab.packs,(function(t){return t.items.some((function(t){return t.id===e.item.id}))})),i=t.findIndex(n.items,{id:e.item.id}),r={type:c.telemetry.pes.source.ROSTER,section:n&&n.id,query:e.sourceTab._currentQuery,tabName:e.sourceTab.id,tabIndex:e.sourceTab._index}
	u.mojiSent({id:e.item.id,type:e.item.type},r),u.imageSent({id:e.item.id,pickerIndex:i,querySource:e.item.querySource},r)}(e)}}function w(){if(y.isFeatureOn(c.featureFlags.SKIP_CHAT_CAPABILITY_CHECK))g.hasChatCapability(!0)
	else{for(var e,t=!1,n=g.conversationModel.participants().length,i=0;i<n&&!t;i++)t=g.conversationModel.participants()[i].person.capabilities.chat()
	e=0===n||t,g.hasChatCapability(e)}}function S(){e&&(x(),w()),e=[],g.conversationModel.participants().forEach((function(t){var n=t.person,i=n.capabilities.chat.subscribe(),r={person:n,subscription:i}
	n.capabilities.chat.get(),n.capabilities.chat.changed(w),e.push(r)}))}function x(){e&&(e.forEach((function(e){e.person.capabilities.chat.changed.off(w),e.subscription.dispose()})),e=void 0)}function C(){return g.isServiceEnabled()&&g.hasChatCapability()&&!s.isConversationWithUnauthorizedAgent()}function T(){return g.isServiceEnabled()&&!s.isConversationWithUnauthorizedAgent()&&(g.hasChatCapability()||I())}function I(){if(g.conversationModel&&!g.conversationModel.isGroupConversation()&&g.conversationModel.participants(0))return m.isPstn(g.conversationModel.participants(0).person)}function A(e){g.attribution(e),g.showTermsOfUse(!!e)}function M(){var e=[]
	return g.attribution()&&e.push(g.attribution()),g.isMediaBarV2Enabled()&&e.push("mediabarV2enabled"),g.shouldOptimizeAvailableSpace&&e.push("ChatInput--optimizeSpace"),e.join(" ")}function O(){return y.isFeatureOn(c.featureFlags.SMS_SUPPORT_ENABLED)&&g.isServiceEnabled()&&!g.conversationModel.isGroupConversation()&&!f.isOneToOneConversationWithAgent(g.conversationModel)&&T()}this.init=function(e,t){this.sendMessage=e.sendMessage,this.chatInputEl=t,this.attribution=n.observable(null),this.conversationModel=e.conversationModel,this.alwaysHideExpressionPicker=!!e.alwaysHideExpressionPicker,this.isServiceEnabled=b()?r.newObservableProperty(this.conversationModel.chatService.sendMessage.enabled):n.observable(!0),this.hasChatCapability=n.observable(!0),this.shouldOptimizeAvailableSpace=y.isFeatureOn(c.featureFlags.OPTIMIZE_SPACE_FOR_CC),b()&&this.conversationModel.participants.changed(S),s=d.build(e.conversationModel),this.isEnabled=n.computed(C),this.isChatAndSmsInputEnabled=n.computed(T),this.isPstnSmsOnly=!1,this.showTermsOfUse=n.observable(!1),this.isSendDisabled=n.observable(!0),this.isStyleModeWide=n.observable(p.get().currentMode()===h.WIDE),this.formHolderCssClasses=n.computed(M),this.forwardEvent(o.message.QUOTE,this.DIRECTION.CHILD),this.forwardEvent(o.message.EDIT,this.DIRECTION.CHILD),this.forwardEvent(o.message.COPY,this.DIRECTION.CHILD),this.forwardEvent(o.suggestionList.SHOWN,this.DIRECTION.CHILD),this.forwardEvent(o.suggestionList.HIDDEN,this.DIRECTION.CHILD),this.forwardEvent(o.suggestionList.ITEM_SELECTED,this.DIRECTION.CHILD),this.forwardEvent(a.EVENTS.CALL_SCREEN_CLOSE,this.DIRECTION.CHILD),this.forwardEvent(a.EVENTS.UNANSWERED_CALL_CLOSE,this.DIRECTION.CHILD),this.forwardEvent(o.navigation.FRAGMENT_SHOW,this.DIRECTION.CHILD),this.forwardEvent(o.emoticonPicker.EMOTICON_SELECTED,this.DIRECTION.CHILD),this.forwardEvent(o.emoticonPicker.CLOSE,this.DIRECTION.CHILD),this.registerEvent(o.textarea.CHANGED,_),this.registerEvent(o.textarea.SET_ATTRIBUTION,A)
	this.forwardEvent(o.textarea.MESSAGE_SENT,this.DIRECTION.PARENT),this.forwardEvent(o.textarea.UPDATE_SMS_FRAGMENTS,this.DIRECTION.CHILD),this.forwardEvent(o.textarea.UPDATE_SMS_DESTINATION,this.DIRECTION.CHILD),i.subscribe(o.expressionPicker.ITEM_SEND_REQUEST,E),this._parentContext&&(this.forwardEvent(o.textarea.INITIALIZATION_COMPLETE,this.DIRECTION.PARENT),this.dispatchEvent(o.chatInput.INITIALIZATION_COMPLETE,g,g.DIRECTION.PARENT)),v=p.get().currentMode.subscribe((function(e){g.isStyleModeWide(e===h.WIDE)})),this.destination=n.observable(function(){if(T()&&I())return g.isPstnSmsOnly=!0,c.messageDestination.SMS_NETWORK
	return c.messageDestination.SKYPE_NETWORK}()),this.canSendSms=n.pureComputed(O)},this.sendButtonClicked=function(){g.dispatchEvent(o.textarea.SUBMIT_AND_FOCUS,null,g.DIRECTION.CHILD)},this.dispose=function(){b()&&(g.isEnabled.dispose(),g.isServiceEnabled.dispose(),x(),g.conversationModel.participants.changed.off(S)),v.dispose(),s.dispose(),i.unsubscribe(o.expressionPicker.ITEM_SEND_REQUEST,E)},this.isExpressionPickerButtonVisible=function(){return!g.alwaysHideExpressionPicker&&!y.isFeatureOn(c.featureFlags.HIDE_EMOTICON_PICKER_BUTTON)},this.isPESEnabled=function(){return b()},this.isMediaBarEnabled=function(){return y.isFeatureOn(c.featureFlags.MEDIA_BAR_ENABLED)},this.isMediaBarV2Enabled=function(){return y.isFeatureOn(c.featureFlags.MEDIA_BAR_ENABLED)&&y.isFeatureOn(c.featureFlags.MEDIA_BAR_V2_ENABLED)},this.isFooterMediaBarVisible=function(){return this.isMediaBarV2Enabled()&&!this.isStyleModeWide()}}return t.assign(v.prototype,s),v})),define("text!views/chat/chatInput.html",[],(function(){return'<div class="tc" data-bind="css: {showTermsOfUse: showTermsOfUse}">\r\n    <div class="form-holder" data-bind="css: formHolderCssClasses">\r\n            \x3c!-- ko if: !shouldOptimizeAvailableSpace --\x3e\r\n            <div class=\'smsInfoHolder\'>\r\n            \x3c!-- ko if: canSendSms() --\x3e                \r\n                <div class=\'messageDestinationHolder\'>\r\n                        <swx-message-destination-picker params="destination:destination, conversation:conversationModel, isPstnSmsOnly:isPstnSmsOnly"></swx-message-destination-picker>\r\n                </div>\r\n                <div class=\'smsPriceHolder\'>\r\n                    <swx-sms-price params="destination:destination, conversation: conversationModel"></swx-sms-price>\r\n                </div>\r\n            \x3c!-- /ko --\x3e                \r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n\r\n        <div class="upper-row-form">\r\n            <div class="form">\r\n                <form id="textarea-bindings">\r\n                    <swx-textarea params="conversationModel: conversationModel, isEnabled: isChatAndSmsInputEnabled, isServiceEnabled: isServiceEnabled, sendMessage: sendMessage, chatInputEl: chatInputEl, hasChatCapability: hasChatCapability, destination:destination, isPstnSmsOnly:isPstnSmsOnly"></swx-textarea>\r\n                </form>\r\n            </div>\r\n\r\n            <div class="buttonRow">\r\n                \x3c!-- ko if: !isFooterMediaBarVisible() --\x3e\r\n                \x3c!-- ko if: isMediaBarEnabled() --\x3e\r\n                <swx-chat-input-action-picker params="isDisabled: !isEnabled(), conversationModel: conversationModel,\r\n                    isCollapsible: true"></swx-chat-input-action-picker>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: isExpressionPickerButtonVisible() --\x3e\r\n                    <swx-expression-picker params="isDisabled: !isEnabled()" class="expressionPicker"></swx-expression-picker>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- /ko --\x3e\r\n                <div class="send-button-holder">\r\n                    <swx-button params="icon: \'send\', cssClass: \'swx-chat-input-send-btn circle send-button large\', disabled: isSendDisabled,\r\n                        titleKey: \'action_button_send\', textKey: \'action_button_send\', action: sendButtonClicked,\r\n                        ariaLabelKey: \'action_button_send\'"></swx-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: isFooterMediaBarVisible() --\x3e\r\n        <div class="button-row-footer">\r\n            \x3c!-- ko if: isExpressionPickerButtonVisible() --\x3e\r\n            <swx-expression-picker params="isDisabled: !isEnabled()" class="expressionPicker"></swx-expression-picker>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: isMediaBarEnabled() --\x3e\r\n            <swx-chat-input-action-picker params="isDisabled: !isEnabled(), conversationModel: conversationModel,\r\n                isCollapsible: false"></swx-chat-input-action-picker>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- ko if: showTermsOfUse --\x3e\r\n    <div class="termsOfUse">\r\n        <a class="termsOfUseLink fontSize-p small" target="_blank" href="http://giphy.com/terms" data-bind="l10n: { \'key\': \'expressionPicker_giphyImgTab_terms\' }"></a>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/chatInput",["require","exports","module","vendor/knockout","ui/viewModels/chat/chatInput","constants/components","text!views/chat/chatInput.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/chatInput")
	t.name=e("constants/components").chat.CHAT_INPUT,t.template=e("text!views/chat/chatInput.html"),t.viewModel={createViewModel:function(e,t){var r=new i,o=n.dataFor(t.element)
	return r.init(e,t.element),r.setContext(o),r}}})),define("services/telemetry/common/analyticsInfo",["require","swx-cafe-application-instance","swx-constants","lodash-compat"],(function(e){var t,n=e("swx-cafe-application-instance"),i=e("swx-constants").COMMON,r=e("lodash-compat"),o=i.telemetry.NOT_AVAILABLE
	function a(){var e=function(e,t){var n,i,o,a=e.lastMessage,s=(n=e.id,r.isString(n)&&/^19:/.test(n))
	return a?(i=new Date(a.timestamp),o=new Date,i.setHours(0,0,0,0)===o.setHours(0,0,0,0)&&(s?t.thread1Count++:t.conversation1Count++),s?t.thread30Count++:t.conversation30Count++,a.isUnread&&t.unreadConversationsCount++,t):t},t={}
	function a(e){return e&&e!==o}function s(e){return{thread1Count:e,thread30Count:e,conversation1Count:e,conversation30Count:e,unreadConversationsCount:e}}return t.conversationsInfo=function(){var t,i,r,a=s(0)
	if(n.get().conversationsManager&&n.get().conversationsManager._allConversations)for(t=0,i=(r=n.get().conversationsManager._allConversations()).length;t<i;t++)a=e(r[t],a)
	else a=s(o)
	return a},t.contactsInfo=function(){return{totalContacts:n.get().personsAndGroupsManager.all.persons().length}},t.getPersonaId=function(){var e=t.contactsInfo().totalContacts,n=t.conversationsInfo()
	return a(n.thread30Count)||a(n.conversation30Count)?0===n.thread30Count?i.telemetry.persona.CLASSIC_IM:i.telemetry.persona.POWER_IM:0===e?i.telemetry.persona.NEWBEE:i.telemetry.persona.RETURNING},t}return a.get=function(){return t||(t=new a),t},a})),define("telemetry/chat/conversationUpdateFlow",["require","swx-constants","experience/settings","services/telemetry/common/analyticsInfo","services/telemetry/common/telemetryContext","services/telemetry/skypeData","usertiming"],(function(e){var t=e("swx-constants").COMMON,n=e("experience/settings"),i=t.telemetry.performanceMarks,r=t.telemetry.measurements,o=e("services/telemetry/common/analyticsInfo"),a=e("services/telemetry/common/telemetryContext"),s=e("services/telemetry/skypeData"),c=t.telemetry.stages,l=t.telemetry.conversationType,u=e("usertiming"),d=c.CONVERSATION_UPDATE
	return function(){var e=this
	function c(){e.cta=t.telemetry.NOT_AVAILABLE,e.failedParticipants=t.telemetry.NOT_AVAILABLE,e.addedParticipantsCount=0,e.ttc=t.telemetry.NOT_AVAILABLE,e.tts=t.telemetry.NOT_AVAILABLE,e.conversationType=l.UNKNOWN,e.isSuccess=!0,e.isCompleted=!1,e.isStarted=!1}function p(e,n,i){u.measure(e,n,i)
	var r=u.getEntriesByName(e)
	return r&&r.length>0?r[0]:t.telemetry.NOT_AVAILABLE}function f(){u.mark(i.CONVERSATION_UPDATE.SYNC_END)
	try{e.ttc=p(r.CONVERSATION_UPDATE.TTC,i.CONVERSATION_UPDATE.UPDATE_START,i.CONVERSATION_UPDATE.UPDATE_END),e.isCompleted&&(e.tts=p(r.CONVERSATION_UPDATE.TTS,i.CONVERSATION_UPDATE.UPDATE_END,i.CONVERSATION_UPDATE.SYNC_END)),function(){for(var e in i.CONVERSATION_UPDATE)i.CONVERSATION_UPDATE.hasOwnProperty(e)&&u.clearMarks(i.CONVERSATION_UPDATE[e])
	for(var t in r.CONVERSATION_UPDATE)r.CONVERSATION_UPDATE.hasOwnProperty(t)&&u.clearMeasures(r.CONVERSATION_UPDATE[t])}()}catch(o){console.log(o)}var t={type:"chat_conversation_update",data:{stage:e.stage,cta:e.cta,contactsCount:e.contactsCount,originalParticipantCount:e.originalParticipantCount,addedParticipantsCount:e.addedParticipantsCount,conversationType:e.conversationType,failedParticipants:e.failedParticipants,ttc:e.ttc,tts:e.tts,ttr:"n/a",isSuccess:e.isSuccess}}
	s.push(t,n.telemetry.chatTenantToken),e.isStarted=!1}function m(t,n){e.stage=t,u.mark(i.CONVERSATION_UPDATE.UPDATE_END),n&&f()}e.start=function(t,n){console.log("ConversationUpdateFlow: start"),c(),e.isStarted=!0
	var r=new o
	e.originalParticipantCount=t,e.contactsCount=r.contactsInfo().totalContacts,e.conversationType=n?l.GROUP:l.DIALOG,u.mark(i.CONVERSATION_UPDATE.UPDATE_START)},e.abandoned=function(){var t
	e.isStarted&&!e.isCompleted&&(t=a.get(),e.cta=t.historyLoadOrigin,m(d.ABANDONED,!0))},e.cancelled=function(){m(d.CANCELLED,!0)},e.completed=function(t){e.addedParticipantsCount=t,e.isCompleted=!0,m(d.COMPLETED,!1)},e.performed=function(t){e.isSuccess=t>0,e.failedParticipants=t,f()},c()}})),define("services/cqf/cqfSettings",["require","exports","module","services/ecs/configLoader","swx-enums","experience/settings"],(function(e,t){var n,i=e("services/ecs/configLoader"),r=e("swx-enums"),o=e("experience/settings")
	function a(){var e,t=!1
	return this.get=function(){return new Promise((function(n){(t&&e||(e=i.loadConfig(r.ecsClientNames.Skype,o.ecsCqfKey)),e).then((function(e){t=!0,n(function(e){return{minimumCallLength:1e3*e.Configurations.CQF_Trigger.MinCallDurationSecs,pstnCallPercentage:e.Configurations.CQF_Trigger.PSTN_Percent,groupCallPercentage:e.Configurations.CQF_Trigger.GroupCall_Percent,skypeCallPercentage:e.Configurations.CQF_Trigger.S2S_Percent}}(e))})).catch((function(){t=!1,n({minimumCallLength:1e3*o.cqf.minimumCallLengthSec,pstnCallPercentage:o.cqf.pstnCallPercentage,groupCallPercentage:o.cqf.groupCallPercentage,skypeCallPercentage:o.cqf.skypeCallPercentage})}))}))},this}t.build=function(){return n||(n=new a),n}})),define("services/cqf/trigger",["require","exports","module","msr-crypto","services/cqf/cqfSettings"],(function(e,t){var n=e("msr-crypto").aes,i=e("services/cqf/cqfSettings")
	t.validateCall=function(e){var t,r=i.build()
	return t=new Promise((function(t,i){r.get().then((function(r){if(!e.callId||e.callEscalated)i()
	else if(e.duration<r.minimumCallLength)i()
	else{var o=function(e){return e.hasPSTN?r.pstnCallPercentage:e.isGroupConversation?r.groupCallPercentage:r.skypeCallPercentage}(e);(a=e.callId,s=n.utilities.stringToBytes(a),c=n.sha256.computeHash(s),n.utilities.bytesToInt32(c)>>>0)%100<o?t():i()}var a,s,c}))})),t}})),define("services/cqf/CQFHandler",["require","exports","module","lodash-compat","swx-constants","ui/modelHelpers/conversationHelper","services/cqf/trigger","utils/common/disposableMixin","swx-enums","swx-service-locator-instance","browser/window"],(function(e,t){var n,i,r,o,a,s,c,l=e("lodash-compat"),u=e("swx-constants").COMMON,d=e("ui/modelHelpers/conversationHelper"),p=e("services/cqf/trigger"),f=e("utils/common/disposableMixin"),m=e("swx-enums"),h=e("swx-service-locator-instance").default,v=e("browser/window"),g={},y=!1,b=!1
	function _(){return h.resolve(u.serviceLocator.FEATURE_FLAGS).isFeatureOn(u.featureFlags.CQF_ENABLED)}function E(){y=!0,g._dmDisposeAll()}function w(e){if(e.video.channels(0)){var t=e.video.channels(0).stream.state.once(m.mediaStreamState.Started,E)
	g.registerDisposable(t)}}t.observe=function(e){if(_()){y=!1
	var t=e.participants.added(w)
	if(g.registerDisposable(t),e.selfParticipant.video.channels(0)){var n=e.selfParticipant.video.channels(0).stream.state.once(m.mediaStreamState.Started,E)
	g.registerDisposable(n)}}},t.updateCallData=function(e){_()&&(n=e.audioService.callId(),a=e._callData.nodeId(),s=e._callData.ngcEndpointId(),c=e._callData.ngcParticipantId(),i=e.audioService.callConnected()?v.Date.now()-e.audioService.callConnected():0,b=e.selfParticipant.audio.state.reason===m.callDisconnectionReason.CallEscalated,r=e.isGroupConversation(),o=d.isConversationWithPstn(e),b||g._dmDisposeAll())},t.setupCQF=function(){return _()?new Promise((function(e,t){var l={duration:i,callId:n,callEscalated:b,hasPSTN:o,isGroupConversation:r}
	p.validateCall(l).then((function(){e({isVideo:y,isPSTN:o,callId:n,nodeId:a,ngcEndpointId:s,ngcParticipantId:c})})).catch(t)})):Promise.reject()},l.extend(g,f)})),define("ui/calling/pstnEventsHandler",["require","exports","module","swx-enums","lodash-compat","ui/modelHelpers/personHelper"],(function(e,t){var n=e("swx-enums"),i=e("lodash-compat"),r=e("ui/modelHelpers/personHelper")
	function o(e){var t,o,a={}
	function s(e){e===n.callConnectionState.Disconnected?(o&&o.dispose(),t.participants().forEach(u)):e===n.callConnectionState.Connecting&&(o=t.participants.observe(c),t.participants().forEach(l))}function c(e,t){i.forIn(e,(function(e){l(e)})),i.forIn(t,(function(e){u(e)}))}function l(n){if(i=n.audio.endpoint(),/^(\+)?\d+$/.test(i)||r.isPstn(n.person)){var i,o=n.person.id()
	o in a||(a[o]=s,n.audio.state.changed(s))}function s(i){var r=n.audio.state.reason
	e.process(t,n,r,i)}}function u(e){var t,n;(n=e.person.id())in a&&(t=a[n],e.audio.state.changed.off(t),delete a[n])}this.subscribeToConversation=function(e){(t=e).selfParticipant.audio.state.changed(s)},this.dispose=function(){o&&o.dispose(),t.participants().forEach(u),a.length=0,t.selfParticipant.audio.state.changed.off(s)}}t.build=function(e){return new o(e)}}))
	define("ui/calling/invalidNumberRedirector",["require","exports","module","swx-enums","swx-constants","constants/components","swx-service-locator-instance","browser/window"],(function(e,t){var n=e("swx-enums"),i=e("swx-constants").COMMON,r=e("constants/components"),o=e("swx-service-locator-instance").default,a=e("browser/window")
	function s(){var e,t=o.resolve(i.serviceLocator.PUBSUB)
	function s(){e&&(a.clearTimeout(e),e=null,t.unsubscribe(i.events.navigation.NAVIGATE,s))}this.process=function(o,c,l,u){u===n.callConnectionState.Disconnected&&l===n.callDisconnectionReason.InvalidNumber&&(o.participants.size()>1||e||(t.subscribe(i.events.navigation.NAVIGATE,s),e=a.setTimeout((function(){t.publish(i.events.navigation.NAVIGATE,{page:r.calling.SKYPEOUT_PAGE,origin:i.telemetry.historyLoadOrigin.SKYPEOUT_PAGE})}),5e3)))},this.dispose=function(){s()}}t.build=function(){return new s}})),define("ui/viewModels/chat/conversation",["require","lodash-compat","swx-enums","utils/common/eventMixin","swx-constants","utils/common/elementQueryHelper","vendor/knockout","telemetry/chat/conversationUpdateFlow","ui/modelHelpers/conversationHelper","swx-cafe-application-instance","swx-constants","constants/components","swx-browser-detect","swx-service-locator-instance","services/cqf/CQFHandler","ui/calling/unansweredCallHandler","ui/calling/pstnEventsHandler","ui/calling/invalidNumberRedirector","telemetry/chat/conversationJoined"],(function(e){var t=e("lodash-compat"),n=e("swx-enums"),i=e("utils/common/eventMixin"),r=e("swx-constants").CALLING,o=e("utils/common/elementQueryHelper"),a=e("vendor/knockout"),s=e("telemetry/chat/conversationUpdateFlow"),c=e("ui/modelHelpers/conversationHelper"),l=e("swx-cafe-application-instance"),u=e("swx-constants").COMMON,d=e("constants/components"),p=e("swx-browser-detect").default,f=e("swx-service-locator-instance").default,m=e("services/cqf/CQFHandler"),h=e("ui/calling/unansweredCallHandler"),v=e("ui/calling/pstnEventsHandler"),g=e("ui/calling/invalidNumberRedirector"),y=e("telemetry/chat/conversationJoined")
	function b(e,i){var b,_,E,w,S,x,C,T,I,A,M,O,k=this,N=f.resolve(u.serviceLocator.PUBSUB),P=f.resolve(u.serviceLocator.FEATURE_FLAGS),R=P.isFeatureOn(u.featureFlags.PSTN_ENABLED)
	function L(){return k.minimizeCallScreen(!1),window.shellApp?D():U().catch(D)}function D(){return m.setupCQF().then((function(e){k.callData=e,k.isCQFVisible(!0),k.isInCall(!1)})).catch((function(){k.isInCall(!1),V()}))}function U(){return h.setup().then((function(e){k.unansweredCallPayload.reason(e.reason),k.unansweredCallPayload.wasVideoCall(e.wasVideoCall),k.unansweredCallPayload.ecsConfig(e.ecsConfig),k.isUnansweredCallVisible(!0)}))}function F(){k.isUnansweredCallVisible(!1)}function B(){k.isCQFVisible(!1),V()}function V(){window.shellApp&&k.isConversationVisible()&&!k.isInCall()&&e.selfParticipant.audio.state.reason!==n.callDisconnectionReason.CallEscalated&&(window.shellAppInfo.supportsPreloading?(window.shellApp.invoke(r.SHELL_APP_METHODS.HIDE_WINDOW),G(!1)):window.shellApp.invoke(r.SHELL_APP_METHODS.CLOSE_WINDOW),window.shellAppInfo.hidePromiseResolve&&window.shellAppInfo.hidePromiseResolve())}function G(e){var t=document.querySelector("#contentWrapper")
	t&&(t.style.display=e?"block":"none")}function H(e,n){var i={successCriteria:e}
	N.publish(u.events.search.SESSION_SUCCESS,t.merge(i,n))}function q(t){window.shellApp&&G(!0),k.isInCall()&&o.refresh(),k.isConversationVisible(!0),k.isInCall(c.isCallingActive(e)),k.isFullyOverlayed(k.showStartConversationOverlay()),E=e.acknowledge.enabled.when(!0,e.acknowledge),S=k.isInCall.subscribe((function(e){e&&(k.dispatchEvent(r.EVENTS.CQF_CANCEL,k.DIRECTION.CHILD),k.isCQFVisible(!1),k.isUnansweredCallVisible(!1))})),t&&t.model===k.conversationModel&&t.target&&t.target.expandProfile&&(k.dispatchEvent(u.events.conversation.OPEN_PROFILE,t.telemetryContext,k.DIRECTION.CHILD),I=!0,A=t.telemetryContext)}function W(){k.isUnansweredCallVisible(!1),k.isConversationVisible(!1),k.conversationUpdateFlow.abandoned(),C&&k.conversationModel.historyService._messagesWithUnseenHearts.size()>0&&k.conversationModel.historyService._messagesWithUnseenHearts.empty()}function j(e){e===d.chat.HEADER&&I&&k.dispatchEvent(u.events.conversation.OPEN_PROFILE,A,k.DIRECTION.CHILD)}function z(t){if(t===e){var n={model:t,page:"swx-conversation"}
	N.publish(u.events.navigation.FRAGMENT_REMOVE,n)}}function K(e){k.isEditRosterMode(e.isActive),k.isEditing(e.isEditMode)}function Y(){k.isFullyOverlayed(!1)}function Q(e){e.conversationModel.conversationId===k.conversationModel.conversationId&&(k.shareControlPayload(e),k.isSelectingContacts(!0))}function X(){k.isSelectingContacts(!1)}function $(e){e&&e.conversationId===k.conversationModel.conversationId&&k.isUnansweredCallVisible(!1)}function J(e){e&&e.conversationId===k.conversationModel.conversationId&&U().catch(t.noop)}k.init=function(){function n(e){return e.preventDefault(),e.stopPropagation(),p.getBrowserInfo().isIeEngine&&(e.returnValue=!1),!1}function o(e){return b&&function(e,t){var n=e.dataTransfer||e.originalEvent.dataTransfer
	return Array.prototype.some.call(n.types,(function(e){return e===t}))}(e,"Files")&&k.conversationModel.fileTransferService.send.enabled()}function c(e,t){var i=e.dataTransfer||e.originalEvent.dataTransfer
	return i&&(i.dropEffect=t?"copy":"none"),n(e)}b=P.isFeatureOn(u.featureFlags.FILE_DRAG_DROP_ENABLED),C=P.isFeatureOn(u.featureFlags.HEARTS_ENABLED),k.isSingleConversationMode=P.isFeatureOn(u.featureFlags.SINGLE_CONVERSATION_MODE),k.conversationModel=e,k.isEditRosterMode=a.observable(!1),k.isEditing=a.observable(!1),k.isFullyOverlayed=a.observable(!1),k.isSelectingContacts=a.observable(!1),k.showCover=a.pureComputed((function(){return!e.selfParticipant.isAnonymous()&&k.isEditRosterMode()||k.isSelectingContacts()})),k.isInCall=a.observable(!1),k.isUnansweredCallVisible=a.observable(!1),k.unansweredCallPayload={conversation:e,reason:a.observable(),wasVideoCall:a.observable(),ecsConfig:a.observable()},k.isCQFVisible=a.observable(!1),k.isConversationVisible=a.observable(!0),k.conversationUpdateFlow=new s,k.newConversationV2=a.observable(P.isFeatureOn(u.featureFlags.NEW_CONVERSATION_V2)),k.shareControlPayload=a.observable({}),k.isPollsFeatureEnabled=a.observable(!1),R&&!p.getBrowserInfo().isShellApp&&(T=g.build(),(x=v.build(T)).subscribeToConversation(e)),k.onDragEnter=function(e,t){var n=o(t)
	return c(t,n)},k.onDragOver=function(e,t){return c(t,o(t))},k.onDragLeave=function(){},k.onDrop=function(e,t){var i=[]
	if(o(t))return Array.prototype.forEach.call(t.dataTransfer.files,(function(e){i.push(e)})),i.length&&k.conversationModel.fileTransferService.send(i),n(t)},k.markAsRead=function(){return k.dispatchEvent(u.events.conversation.MARK_AS_READ),!0},k.minimizeCallScreen=a.observable(!1),k.maximizeCallScreen=a.computed((function(){return P.isFeatureOn(u.featureFlags.CALLSCREEN_MINMAX)&&k.isInCall()&&!k.minimizeCallScreen()})),k.conversationModel.sendPollMessage&&(w=k.conversationModel.sendPollMessage.enabled.changed((function(e){k.isPollsFeatureEnabled(e)}))),_=k.conversationModel.participants.subscribe(),k.forwardEvent(u.events.navigation.FRAGMENT_SHOW,k.DIRECTION.CHILD,q),k.forwardEvent(u.events.navigation.FRAGMENT_BEFORE_HIDE,k.DIRECTION.CHILD,W),k.forwardEvent(u.events.navigation.FRAGMENT_HIDE,k.DIRECTION.CHILD),k.forwardEvent(u.events.message.QUOTE,k.DIRECTION.CHILD),k.forwardEvent(u.events.message.EDIT,k.DIRECTION.CHILD),k.forwardEvent(u.events.message.COPY,k.DIRECTION.CHILD),k.forwardEvent(u.events.conversation.OPEN_PROFILE,k.DIRECTION.CHILD),k.forwardEvent(u.events.conversation.VIEWPORT_CHANGED,k.DIRECTION.CHILD),k.forwardEvent(u.events.conversation.MESSAGES_LOADED,k.DIRECTION.CHILD),k.forwardEvent(r.EVENTS.CALL_SCREEN_CLOSE,k.DIRECTION.CHILD,L),k.forwardEvent(r.EVENTS.UNANSWERED_CALL_CLOSE,k.DIRECTION.CHILD,F),k.registerEvent(u.events.roster.EDIT_ROSTER_MODE,K),k.registerEvent(u.events.conversation.OVERLAY_CLOSED,Y),k.registerEvent(u.events.navigation.COMPONENT_RENDERED,j),k.registerEvent(r.EVENTS.CQF_SCREEN_CLOSE,B),k.registerEvent(u.events.callScreen.SHOW_CHAT,k.minimizeCallScreen.bind(k,!0)),k.registerEvent(u.events.callScreen.HIDE_CHAT,k.minimizeCallScreen.bind(k,!1)),i!==u.telemetry.historyLoadOrigin.CONTACT_SEARCH&&i!==u.telemetry.historyLoadOrigin.DIRECTORY_SEARCH||(k.registerEvent(u.events.textarea.MESSAGE_SENT,t.partial(H,u.telemetry.contactsV2.searchSession.enums.success_criteria.IM_SENT)),k.registerEvent(u.events.message.ADD_CONTACT,t.partial(H,u.telemetry.contactsV2.searchSession.enums.success_criteria.CONTACT_ADDED)),k.registerEvent(u.events.actions.callMade,t.partial(H,u.telemetry.contactsV2.searchSession.enums.success_criteria.CALL_MADE))),N.subscribe(u.events.shareControl.SHARE_CONTROL_SHOW,Q),N.subscribe(u.events.shareControl.SHARE_CONTROL_HIDE,X),M=h.newCallStartedInShellApp.subscribe($),O=h.previousCallEndedInShellApp.subscribe(J),l.get().conversationsManager.conversations.removed(z)
	e.conversationId&&!y.get().isTriggeredFor(e.conversationId)||(e._updateThreadPropertiesSubscription?e._updateThreadPropertiesSubscription.add((function t(){e._updateThreadPropertiesSubscription.remove(t),y.get().onConversationJoined({participantsCount:e.participantsCount()})})):y.get().onConversationJoined({participantsCount:e.participantsCount()}))},k.dispose=function(){_.dispose(),k.maximizeCallScreen.dispose(),E&&E.dispose(),l.get().conversationsManager.conversations.removed.off(z),k.conversationUpdateFlow=null,w&&w.dispose(),x&&(x.dispose(),T.dispose()),S&&S.dispose(),N.unsubscribe(u.events.shareControl.SHARE_CONTROL_SHOW,Q),N.unsubscribe(u.events.shareControl.SHARE_CONTROL_HIDE,X),O&&O.dispose(),M&&M.dispose()},k.coverHeader=a.pureComputed((function(){return!e.selfParticipant.isAnonymous()&&k.isFullyOverlayed()})),k.coverChatLogAndInput=a.pureComputed((function(){return!e.selfParticipant.isAnonymous()&&(k.isFullyOverlayed()||k.isEditRosterMode())})),k.showStartConversationOverlay=a.pureComputed((function(){return P.isFeatureOn(u.featureFlags.INVITE_FREE)&&!k.conversationModel.isGroupConversation()&&0===k.conversationModel.historyService.activityItems().length}))}return t.assign(b.prototype,i),t.assign(b.prototype,{isInShellApp:function(){return p.getBrowserInfo().isShellApp}}),b})),define("text!views/chat/conversation.html",[],(function(){return'<div class="conversationControl chat themeLight allowTextSelection"\r\n     data-bind="click: markAsRead,\r\n      css: { editRosterMode: isEditRosterMode, group: conversationModel.isGroupConversation(), isInCall: (isInCall() && !minimizeCallScreen()) || isCQFVisible(), inShellApp: isInShellApp() },\r\n      event: {dragenter: onDragEnter, dragover: onDragOver, dragleave: onDragLeave, drop: onDrop }">\r\n\r\n    \x3c!-- ko ifnot: isInShellApp() --\x3e\r\n        \x3c!-- ko ifnot: isSingleConversationMode --\x3e\r\n        <swx-header class="conversationHeader" params="conversationModel: conversationModel, conversationUpdateFlow: conversationUpdateFlow" data-bind="css: { active: isEditRosterMode, newConversationV2: newConversationV2, editMode: isEditing, showCover: coverHeader}"></swx-header>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: isSingleConversationMode --\x3e\r\n        <swx-header-single-conversation class="conversationHeader overrideMinHeight" params="conversationModel: conversationModel"></swx-header-single-conversation>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isSelectingContacts --\x3e\r\n        <swx-share-control params="payload:shareControlPayload"></swx-share-control>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: isInCall --\x3e\r\n    <swx-call-screen class="callScreen" data-bind="css: { \'callScreen--maximizeCallScreen\': maximizeCallScreen, \'callScreen--minimized\': minimizeCallScreen }" params="conversation: conversationModel"></swx-call-screen>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: isCQFVisible --\x3e\r\n    <swx-cqf class="cqfScreen" params="callData: callData"></swx-cqf>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: isUnansweredCallVisible --\x3e\r\n    <swx-unanswered-call class="unansweredCall" params="payload: unansweredCallPayload"></swx-unanswered-call>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko ifnot: isInShellApp() || isCQFVisible --\x3e\r\n        \x3c!-- ko if: isPollsFeatureEnabled --\x3e\r\n        <swx-sticky-message params="conversationModel: conversationModel"></swx-sticky-message>\r\n        \x3c!-- /ko --\x3e\r\n        <swx-chat-log class="conversationHistory" data-bind="visible: !maximizeCallScreen(), css: { showCover: coverChatLogAndInput }" params="conversationModel: conversationModel"></swx-chat-log>\r\n        <label class="input swx-chat-input" data-bind="visible: !maximizeCallScreen(), component: {name:\'swx-chat-input\', params: {conversationModel: conversationModel}}, css: { showCover: coverChatLogAndInput, hide: isEditing }"></label>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\x3c!-- ko if: showStartConversationOverlay --\x3e\r\n<swx-start-conversation-overlay class="StartConversationOverlay" data-bind="css: { hide: !isFullyOverlayed() }" params="conversationModel: conversationModel"></swx-start-conversation-overlay>\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/chat/conversation",["require","exports","module","vendor/knockout","swx-constants","ui/viewModels/chat/conversation","constants/components","text!views/chat/conversation.html"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-constants").COMMON.events,r=e("ui/viewModels/chat/conversation")
	t.name=e("constants/components").chat.CONVERSATION,t.template=e("text!views/chat/conversation.html"),t.viewModel={createViewModel:function(e,t){var o,a=t.element,s=e.model,c=e.origin,l=n.dataFor(a)
	if(!s)return void console.error("No conversation provided")
	return(o=new r(s,c)).setContext(l),o.init(),o.dispatchEvent(i.navigation.COMPONENT_RENDERED),o}}})),define("ui/viewModels/chat/groupSearch",["require","lodash-compat","vendor/knockout","utils/common/ko","swx-utils-common","swx-utils-common","swx-cafe-application-instance","swx-pubsub-instance","swx-constants","ui/telemetry/telemetryClient","experience/settings","swx-constants","ui/telemetry/actions/actionSources","swx-enums","ui/telemetry/people/contactSearch"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/ko"),r=e("swx-utils-common").array,o=e("swx-utils-common").stringUtils,a=e("swx-cafe-application-instance"),s=e("swx-pubsub-instance").default,c=e("swx-constants").COMMON,l=e("ui/telemetry/telemetryClient"),u=e("experience/settings"),d=e("swx-constants").COMMON.events.search,p=e("ui/telemetry/actions/actionSources"),f=e("swx-enums"),m=e("ui/telemetry/people/contactSearch")
	return function(e,h){var v,g,y,b,_=this,E=n.observableArray()
	function w(e){var t,n
	if(e)return function(e){if(e)try{e.cancel("Another search triggered")}catch(t){l.get().sendEvent(u.telemetry.uiTenantToken,c.telemetry.promiseInvalidStateException.TYPE,{feature:c.telemetry.promiseInvalidStateException.feature.GROUP_SEARCH,exception:_stringify(t)})}}(b),t=o.removeNonWordCharacters(e).toLowerCase(),v=a.get().conversationsManager.createSearchQuery(),S("group",!0),S("topic",t),(n=v.getMore()).then((function(){if(b!==n)return
	b=null,E(v.results().map((function(e){return e.result})))}),(function(e){if(e&&"Canceled"===e.message)return
	if(_.activeSearchPromise!==n)return
	m.onContactSearchEnd({success:!1,searchScope:f.searchScope.Groups})})),b=n,n
	E([])}function S(e,t){v.supportedKeywords().indexOf(e)<0||(v.keywords[e]=t)}function x(t){var n=_.searchResults()
	i.handleArrayChanges(n,t,(function(t,i){var o=new e(h)
	o.init(i),o.groupSearchResults(y),r.insertAt(n,t,o)})),_.searchResults.valueHasMutated()}function C(e){var n,i=E()
	if(e&&0!==i.length)return-1!==(n=t.findIndex(i,(function(t){return t.conversationId===e.conversation.conversationId})))?n+1:void 0}E.subscribe((function(e){y=e.length,s.publish(d.GROUPS_SEARCH_RESULTS,y)})),this.searchResults=n.observableArray(),this.init=function(){s.subscribe(d.QUERY_CHANGED,w),g=E.subscribe(x,null,"arrayChange")},this.dispose=function(){s.unsubscribe(d.QUERY_CHANGED,w),g&&g.dispose()},this.openConversation=function(e){m.onContactSearchEnd({searchScope:f.searchScope.Groups,success:!0,resultCount:E().length,clickPosition:C.call(_,e),source:p.search.reset.openConversation})}}})),define("services/telemetry/logging/perf/usertimingTracer",["require","usertiming"],(function(e){var t=e("usertiming")
	function n(e){if("function"!=typeof t.getEntriesByName)return!1
	var n=t.getEntriesByName(e)
	return void 0!==n&&n.length>0}return function(e){this.logger=e,this.startTrace=function(e){n(e)||"function"==typeof t.mark&&t.mark(e)},this.stopTrace=function(e){n(e)&&"function"==typeof t.measure&&(t.measure(e+"_measure",e),t.clearMarks(e))},this.dumpMeasurements=function(){if("function"!=typeof t.getEntriesByType)return{}
	var e=t.getEntriesByType("measure")||{}
	return 0===e.length||(this.logger.perf(e),"function"==typeof t.clearMeasures&&t.clearMeasures()),e}}})),define("services/telemetry/logging/perf/dummyTracer",[],(function(){return function(){this.startTrace=function(){},this.stopTrace=function(){},this.dumpMeasurements=function(){}}})),define("services/telemetry/logging/perf/environments",["require","services/telemetry/logging/perf/usertimingTracer","services/telemetry/logging/perf/dummyTracer"],(function(e){var t=e("services/telemetry/logging/perf/usertimingTracer"),n=e("services/telemetry/logging/perf/dummyTracer"),i={live:t,mock:t,dev:t}
	return{fetch:function(e){return i[e]||n}}})),define("services/telemetry/logging/perf/main",["require","services/telemetry/logging/perf/environments"],(function(e){var t,n=e("services/telemetry/logging/perf/environments")
	return{getInstance:function(){return t||this.construct(),t},construct:function(e,i){var r=function(e){var t=e?e.environment:"default"
	return n.fetch(t)}(e)
	t=new r(i)},destroy:function(){t=void 0}}})),define("ui/viewModels/chat/recent",["require","lodash-compat","vendor/knockout","swx-i18n","swx-constants","swx-enums","swx-pubsub-instance","swx-service-locator-instance","services/telemetry/common/telemetryContext","services/telemetry/logging/perf/main","utils/common/cafeObservable","utils/common/ko","ui/contextMenu/contextMenu","ui/contextMenu/items/all","ui/contextMenu/menuItemHelper","ui/telemetry/actions/actionSources","ui/viewModels/calling/helpers/textFormatter","ui/viewModels/chat/conversationActivity","ui/viewModels/chat/conversationTile","ui/viewModels/chat/conversationTopic","utils/common/styleModeHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("swx-constants").COMMON,o=e("swx-enums"),a=e("swx-pubsub-instance").default,s=e("swx-service-locator-instance").default,c=e("services/telemetry/common/telemetryContext"),l=e("services/telemetry/logging/perf/main"),u=e("utils/common/cafeObservable"),d=e("utils/common/ko"),p=e("ui/contextMenu/contextMenu"),f=e("ui/contextMenu/items/all"),m=e("ui/contextMenu/menuItemHelper"),h=e("ui/telemetry/actions/actionSources"),v=e("ui/viewModels/calling/helpers/textFormatter"),g=e("ui/viewModels/chat/conversationActivity"),y=e("ui/viewModels/chat/conversationTile"),b=e("ui/viewModels/chat/conversationTopic"),_=e("utils/common/styleModeHelper"),E=r.events.navigation
	return function(e){var w,S,x,C,T,I,A,M,O,k,N,P,R,L,D=this,U=s.resolve(r.serviceLocator.FEATURE_FLAGS)
	function F(){D.hasUnseenHearts(x.historyService._messagesWithUnseenHearts.size()>0)}function B(e){var t=e()
	return t>=50?"50+":0===t?"":t}function V(){var e=I()
	return!!e&&e.direction===o.direction.Outgoing}function G(){return A.currentPlaceModel()===x}function H(){return 0===D.unreadCount()&&(!D.unreadWithKeywordsCount||0===D.unreadWithKeywordsCount())}function q(){var e,t=I()
	if(t)return t.model.type()===o.activityType.ContactRequestIsNowContact?i.fetch({key:"message_text_isNowAContact",params:{id:t.model.sender.id()}}):(e=t.content(),/<\/a>/i.test(e)&&(e=(e=e.replace(/ onclick="[^"]+"/i,"")).replace(/ title="[^"]+"/i,"")),e)}function W(){var n,i=C(),a=i[i.length-1]
	if(!a||t.isEmpty(a))return null
	if(w&&a.key()===w.clientmessageid)return w
	if((n=new e({noUrlPreview:!0,noTranslationItem:!0})).init(a,x),D.isLiveSession(n.group()===r.activityItemGroups.CALL),D.isInfoMessage(n.group()===r.activityItemGroups.CONTACT_REQUEST),D.isLiveSession.peek())D.callAction(n.callAction||""),T("live-session")
	else if(D.isInfoMessage.peek()){var s=function(e){if(e===o.activityType.ContactRequestIncoming)return"contactAdd"
	if(e===o.activityType.ContactRequestIsNowContact)return"contact"
	return""}(n.model.type())
	D.infoType(s),T("info")}else T("message")
	return w&&w.dispose(),w=n,n}function j(){var e,t=D.isRead()
	return e={message:t,"live-session":!1,"file-transfer":!1,info:!1,unknown:!1,contact:!1,media:!1},t||(e[T()]=!0),e.read=t,e.unread=!t,e.lightNotification=!(D.notificationEnabled()||D.unreadWithKeywordsCount&&0!==D.unreadWithKeywordsCount()),e.hide=D.isOnCall()||D.isBlocked()||D.canJoinCall(),e.active=D.isActive(),e.group=D.isGroupConversation(),e.unseenHeart=D.displayUnseenHeartsIcon(),e}function z(){var e=M.callDuration(),t=_.get().currentMode()===r.styleMode.NARROW
	return e<0?"":v.getFormattedDuration(e,t)}D.init=function(e){x=e,M=g.build(e),O=b.build(e),T=n.observable("message"),S=y.build(x),A=s.resolve(r.serviceLocator.NAVIGATION_CONTEXT),k=U.isFeatureOn(r.featureFlags.HEARTS_ENABLED),N=U.isFeatureOn(r.featureFlags.HEARTS_NOTIFICATION_ENABLED),P=U.isFeatureOn(r.featureFlags.FAVORITES_CONVERSATION_ENABLED),R=U.isFeatureOn(r.featureFlags.MUTE_SPECIFIC_CONVERSATIONS_ENABLED),D.displayMessage=S.displayMessage,D.isBlocked=S.isBlocked,D.topic=O.topic,D.displayName=O.displayName,D.isPstn=S.isPstn,D.unreadCount=u.newObservableProperty(x.historyService.unreadActivityItemsCount),C=u.newObservableCollection(x.historyService.activityItems),D.isLiveSession=n.observable(!1),D.callAction=n.observable(""),D.isOnCall=M.isOnCall,D.canJoinCall=M.canJoinCall,D.isFavorited=x._isFavorited?u.newObservableProperty(x._isFavorited):n.observable(!1),D.isInfoMessage=n.observable(!1),D.infoType=n.observable(""),D.isGroupConversation=u.newObservableProperty(x.isGroupConversation),D.avatarUrl=u.newObservableProperty(x.avatarUrl,{keepAlive:!0}),D.timestamp=u.newObservableProperty(x.lastModificationTimestamp),D.statusClassName=S.statusClassName,D.groupSearchResults=n.observable(0),D.ariaRole=n.computed((function(){return _.get().isIntegratedProperty()?"presentation":"menuitem"}))
	D.conversation=x,D.isAgent=S.isAgent,D.isCertifiedAgent=S.isCertifiedAgent,D.isPstn=S.isPstn,D.unreadActivityItemsCount=n.computed(B.bind(null,D.unreadCount)),x.historyService._unreadActivityItemsWithKeywordsCount?(D.unreadWithKeywordsCount=u.newObservableProperty(x.historyService._unreadActivityItemsWithKeywordsCount),D.unreadActivityItemsWithKeywordsCount=n.computed(B.bind(null,D.unreadWithKeywordsCount))):D.unreadActivityItemsWithKeywordsCount=n.observable(!1),D.notificationEnabled=n.observable(!0),D.displayNotificationsDisabledIndicator=n.computed((function(){return R&&!D.notificationEnabled()})),I=n.computed(W),D.lastMessageIsOutgoing=n.computed(V),D.content=n.computed(q),D.isActive=n.computed(G),D.isRead=n.computed(H).extend({rateLimit:300}),D.hasUnseenHearts=n.observable(!1),D.displayUnseenHeartsIcon=n.computed((function(){return N&&D.hasUnseenHearts()&&!D.isActive()})),k&&N&&x.historyService._messagesWithUnseenHearts.changed(F),D.cssClass=n.computed(j),D.callDuration=n.computed(z),x._notificationsEnabled&&(L=x._notificationsEnabled.changed((function(e){D.notificationEnabled(e)})))},D.dispose=function(){D.unreadActivityItemsCount.dispose(),I.dispose(),D.lastMessageIsOutgoing.dispose(),D.content.dispose(),D.isActive.dispose(),D.isRead.dispose(),D.cssClass.dispose(),O.dispose(),S.dispose(),w&&(w.dispose(),w=null),M.dispose(),k&&N&&x.historyService._messagesWithUnseenHearts.changed.off(F),D.displayUnseenHeartsIcon.dispose(),L&&L.dispose(),D.unreadActivityItemsWithKeywordsCount&&D.unreadActivityItemsWithKeywordsCount.dispose&&D.unreadActivityItemsWithKeywordsCount.dispose()},D.showContextMenu=function(e,n){if(!D.isOnCall()){var i=r.telemetry.historyLoadOrigin.TIMELINE_CLICK,o=[new f.LeaveConversationMenuItem(x),new f.RemoveConversationMenuItem(x),new f.MuteConversationMenuItem(x),new f.UnmuteConversationMenuItem(x),new f.MarkConversationAsReadMenuItem(x),new f.MarkAllConversationsAsReadMenuItem(x)],a={source:h.recentItem,isGroupConversation:!1};(function(){if(!P)return
	D.isFavorited()?D.isGroupConversation()?o.push(new f.RemoveGroupConversationFromFavoritesMenuItem(x,h.recentItem)):o.push(new f.RemoveContactFromFavoritesMenuItem(x.participants(0).person,h.recentItem)):D.isGroupConversation()?o.push(new f.AddGroupConversationToFavoritesMenuItem(x,h.recentItem)):o.push(new f.AddContactToFavoritesMenuItem(x.participants(0).person,h.recentItem))})(),D.isGroupConversation()?(a.isGroupConversation=!0,p.show(o,n,a,!0)):d.once(S.contact,t.isObject,(function(e){var t={source:h.contextMenuItem.block,parent:h.recentItem},r={source:h.contextMenuItem.deleteItem,parent:h.recentItem}
	o.push(m.getConversationContextMenuItemGroup(e,i,a)),o.push(new f.BlockContactMenuItem(e,t)),o.push(new f.DeleteContactMenuItem(e,r)),m.sortMenuItems(o),p.show(o,n,a,!0)}))}},D.handleClick=function(e,t){var n=r.telemetry.historyLoadOrigin.TIMELINE_CLICK;(l.getInstance().startTrace("navigateConversation"),t.preventDefault(),e.model.isActive())||c.get().timelineInSearchMode&&(n=r.telemetry.historyLoadOrigin.GROUP_SEARCH)
	a.publish(E.OPEN_CONVERSATION,{model:x,origin:n})},D.ariaLabel=n.pureComputed((function(){var e,t,n
	return e=D.unreadCount()>0,t=function(e,t){var n=!e
	if(e&&t)return"accessibility_recentItem_group_unread"
	if(e)return"accessibility_recentItem_group"
	if(n&&t)return"accessibility_recentItem_oneToOne_unread"
	if(n)return"accessibility_recentItem_oneToOne"}(D.isGroupConversation(),e),n=D.displayNotificationsDisabledIndicator()?i.fetch({key:"accessibility_recentItem_conversation_muted"}):"",i.fetch({key:t,count:D.unreadCount(),params:{topic:D.topic(),muted:n}})})),D.getSearchItemDetails=function(e){var t=""
	return D.isGroupConversation()?t=D.displayMessage()?i.fetch({key:"accessibility_searchItem_group_displayMessage",params:{groupName:D.topic(),displayMessage:D.displayMessage(),index:e+1,totalResults:D.groupSearchResults()}}):i.fetch({key:"accessibility_searchItem_group",params:{groupName:D.topic(),index:e+1,totalResults:D.groupSearchResults()}}):t}}})),define("text!views/chat/groupSearch.html",[],(function(){return'\x3c!-- ko if: searchResults().length > 0 --\x3e\r\n<ul class="groups" role="menubar" data-bind="foreach: { data: searchResults }, keyboardNavigation: { itemSelector: \'a.group\', persistSelection: false }">\r\n    \x3c!-- ko if: $index() === 0 --\x3e\r\n    <li class="separator">\r\n        <p class="strong" data-bind="l10n: {key: \'message_text_groupSearchResultsTitle\'}"></p>\r\n    </li>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <swx-recent-item params="model: $data, dispose: $data.dispose" class="list-selectable" data-bind="attr: { \'data-title\': $data.getSearchItemDetails($index()) }, event: { click: $parent.openConversation }, enterKey: $parent.openConversation"></swx-recent-item>\r\n</ul>\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/chat/groupSearch",["require","exports","module","ui/viewModels/chat/groupSearch","ui/viewModels/chat/message","ui/viewModels/chat/recent","constants/components","text!views/chat/groupSearch.html"],(function(e,t){var n=e("ui/viewModels/chat/groupSearch"),i=e("ui/viewModels/chat/message"),r=e("ui/viewModels/chat/recent")
	t.name=e("constants/components").chat.GROUP_SEARCH,t.template=e("text!views/chat/groupSearch.html"),t.viewModel={createViewModel:function(){var e=new n(r,i)
	return e.init(),e}}})),define("ui/viewModels/chat/messagesSearch",["require","vendor/knockout","swx-i18n","swx-pubsub-instance","swx-constants","swx-service-locator-instance","swx-cafe-application-instance","swx-constants"],(function(e){var t=e("vendor/knockout"),n=e("swx-i18n").localization,i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=e("swx-service-locator-instance").default,a=e("swx-cafe-application-instance"),s=e("swx-constants").COMMON.events.search
	return function(e){var c,l=this,u=[],d=o.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.CONTENT_SEARCH)
	function p(t){var n
	d&&(f(),l.hasAdditionalResults(!1),!t||t.length<4||(n=t.replace(/[^\w\s]/g,"").trim().toLowerCase(),c=n,a.get()._messagesSearchService.query(n,20).then((function(t){if(c===n){f(),l.hasAdditionalResults(!1)
	var i=0
	t.forEach((function(t){var n,r,o=(r=t,a.get().conversationsManager._getConversation(r.ConversationId))
	o&&((n=new e).init(t,o),i++<5?l.searchResults.push(n):(u.push(n),l.hasAdditionalResults(!0)))}))}}))))}function f(){u.forEach((function(e){e.dispose()})),u=[],l.searchResults().forEach((function(e){e.dispose()})),l.searchResults.removeAll()}this.searchResults=t.observableArray(),this.title=n.fetch({key:"content_search_header"}),this.displayAdditionResults=function(){u.forEach((function(e){l.searchResults.push(e)})),u=[],l.hasAdditionalResults(!1)},this.hasAdditionalResults=t.observable(!1),this.additionalResultsTitle=n.fetch({key:"content_search_additional_results"}),this.init=function(){d&&i.subscribe(s.QUERY_CHANGED,p)},this.dispose=function(){i.unsubscribe(s.QUERY_CHANGED,p),f()}}})),define("ui/viewModels/chat/messageSearchItem",["require","lodash-compat","vendor/knockout","swx-i18n","swx-constants","swx-utils-chat","swx-utils-chat","swx-cafe-application-instance","swx-pubsub-instance","services/telemetry/logging/perf/main","ui/viewModels/chat/conversationTile","ui/modelHelpers/personHelper","swx-enums"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("swx-constants").COMMON,o=e("swx-utils-chat").messageSanitizer,a=e("swx-utils-chat").dateTime,s=e("swx-cafe-application-instance"),c=e("swx-pubsub-instance").default,l=e("services/telemetry/logging/perf/main"),u=e("ui/viewModels/chat/conversationTile"),d=e("ui/modelHelpers/personHelper"),p=e("swx-enums"),f=r.events.navigation
	return function(){var e,m,h=this
	h.init=function(i,r){var c,l,f,v
	m=r,e=u.build(m),h.displayMessage=i.Content,h.messageId=i.ClientMessageId,h.isGroupConversation=!1,h.conversation=(c=i.CreationDate,l=m.topic(),f={key:"content_search_conversation_title",params:{conversationTitle:o.escapeIncomingHTML(l)}},v=new Date(c),a.getTimeSinceTimestamp(v,f)),h.userName=n.observable(""),h.avatarUrl=n.observable(""),function(e){var n,i,r=d.getId(e.From)
	function o(){return s.get().personsAndGroupsManager.mePerson.id()===r&&(n=s.get().personsAndGroupsManager.mePerson,h.avatarUrl(n.avatarUrl()),h.userName(n.displayName()),!0)}function a(){var e=m.participants(),i=t.findIndex(e,(function(e){return e.person.id()===r}))
	return-1!==i&&(n=e[i].person,h.avatarUrl(n.avatarUrl()),h.userName(n.displayName()),!0)}if(o()||a())return;(i=s.get().personsAndGroupsManager.createPersonSearchQuery()).sources(p.searchScope.All),i.text("id:"+r),i.getMore().then((function(){var e=i.results()
	n=e[0].result,h.avatarUrl(n.avatarUrl()),h.userName(n.displayName())}))}(i),h.statusClassName=e.statusClassName,h.isAgent=e.isAgent,h.isActive=!1},h.dispose=function(){e.dispose()},h.handleClick=function(e,t){var n=r.telemetry.historyLoadOrigin.TIMELINE_CLICK
	l.getInstance().startTrace("navigateConversation"),t.preventDefault(),c.publish(f.OPEN_CONVERSATION,{model:m,messageId:e.messageId+"",origin:n})},h.ariaLabel=n.pureComputed((function(){return i.fetch({key:"content_search_aria",count:0,params:{topic:m.topic()}})}))}})),define("text!views/chat/messagesList.html",[],(function(){return'\x3c!-- ko if: searchResults().length > 0 --\x3e\r\n<ul class="groups" data-bind="foreach: { data: searchResults }">\r\n    \x3c!-- ko if: $index() === 0 --\x3e\r\n    <li class="separator">\r\n        <p class="strong" data-bind="html: $parent.title" />\r\n    </li>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <li class="list-selectable">\r\n        <a role="button" data-bind="event: { click: handleClick }, attr: {\'aria-label\':ariaLabel }" class="recent unread">\r\n\r\n            <swx-avatar-deprecated params="isGroupAvatar: isGroupConversation, isAgent: isAgent, avatar: avatarUrl, displayName: topic" class="avatar"></swx-avatar-deprecated>\r\n\r\n            <div class="text">\r\n                <span class="arrow"></span>\r\n                <span class="tile">\r\n                    <span class="tileName">\r\n                        <h4>\r\n                            <span class="topic" data-bind="text: userName, attr: {title: userName}"></span>\r\n                        </h4>\r\n                    </span>\r\n                </span>\r\n\r\n                <div class="message">\r\n                    <p data-bind="html: displayMessage" class="small"></p>\r\n                </div>\r\n                <div class="message">\r\n                    <p class="small"><span data-bind="html: conversation" /></p>\r\n                </div>\r\n            </div>\r\n        </a>\r\n    </li>\r\n</ul>\r\n\x3c!-- ko if: hasAdditionalResults --\x3e \r\n<div class="additionalResults fontSize-p">\r\n    <span>\r\n        <a role="button" data-bind="event: {click: displayAdditionResults}, attr: {\'aria-label\':additionalResultsTitle}"><span data-bind="text: additionalResultsTitle"></span></a>\r\n    </span>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/chat/messagesSearch",["require","exports","module","ui/viewModels/chat/messagesSearch","ui/viewModels/chat/messageSearchItem","constants/components","text!views/chat/messagesList.html"],(function(e,t){var n=e("ui/viewModels/chat/messagesSearch"),i=e("ui/viewModels/chat/messageSearchItem")
	t.name=e("constants/components").chat.MESSAGES_SEARCH,t.template=e("text!views/chat/messagesList.html"),t.viewModel={createViewModel:function(){var e=new n(i)
	return e.init(),e}}})),define("utils/common/location",[],(function(){return{setHref:function(e){window.location.href=e}}})),define("ui/viewModels/chat/inviteLink",["require","exports","module","lodash-compat","vendor/knockout","browser/dom","browser/window","swx-utils-chat","swx-constants","utils/common/eventMixin","utils/common/cafeObservable","utils/common/location","swx-constants","ui/telemetry/actions/actionNames","ui/telemetry/actions/actionSources","swx-service-locator-instance","swx-i18n"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("browser/dom"),o=e("browser/window"),a=e("swx-utils-chat").spaceMail,s=e("swx-constants").COMMON.events,c=e("utils/common/eventMixin"),l=e("utils/common/cafeObservable"),u=e("utils/common/location"),d=e("swx-constants").COMMON,p=e("ui/telemetry/actions/actionNames"),f=e("ui/telemetry/actions/actionSources"),m=e("swx-service-locator-instance").default,h=e("swx-i18n").localization
	function v(e,t){var n=this,c=e.topic,v=e.uri,g=r.getElement(".copyArea",t.element),y=r.getElement("p.link",t.element),b=m.resolve(d.serviceLocator.ACTION_TELEMETRY)
	function _(){return n._parentContext.constructor.name}function E(t){var n=e.telemetryContext?e.telemetryContext:{source:f.invitesShareButtons.groupInformationPanel}
	b.recordAction(t,n)}n.init=function(){var t,r=function(){n.showCopiedIndicator(!1)}
	n.copyActive=i.observable(!1),n.topic=l.newObservableProperty(c),n.uri=l.newObservableProperty(v),n.showCopiedIndicator=i.observable(!1),n.copiedIndicatorText="",n.tabIndex=e.isMessageContent?-1:0,n.copy=function(){n.copyActive(!0),g.select(),E(p.invites.copyButton)
	try{var e=document.execCommand("copy")
	n.copyActive(!1),n.copiedIndicatorText=e?h.fetch({key:"header_text_copied"}):h.fetch({key:"header_text_cant_copy"}),n.showCopiedIndicator(!0),t&&o.clearTimeout(t),t=o.setTimeout(r,3e3),e||function(e){var t=document.createRange()
	t.selectNodeContents(e)
	var n=o.getSelection()
	n.removeAllRanges(),n.addRange(t)}(y)}catch(i){}n.dispatchEvent(s.conversation.COPY_LINK,{parent:_()},n.DIRECTION.PARENT)},n.send=function(){n.dispatchEvent(s.conversation.EMAIL_LINK,{parent:_()},n.DIRECTION.PARENT),E(p.invites.mailButton),u.setHref(n.mailtoLink())},n.cancel=function(){n.copyActive(!1)},n.mailtoLink=i.computed((function(){return a.createMailtoLink(n.topic(),n.uri())}))},n.dispose=function(){n.mailtoLink.dispose()}}n.assign(v.prototype,c),t.classFunction=v,t.build=function(e,t){return new v(e,t)}})),define("text!views/chat/inviteLink.html",[],(function(){return'<div class="inviteLink" data-bind="css: { active: copyActive }">\r\n    \x3c!-- ko ifnot: uri --\x3e\r\n    <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: uri --\x3e\r\n    <p class="link fontSize-p"><span data-bind="text: uri"></span></p>\r\n    \x3c!-- /ko --\x3e\r\n    <input class="copyArea fontSize-p" data-bind="value: uri" readonly />\r\n    <div class="menu fontSize-p small">\r\n        <div class="copyWrapper">\r\n            <a href="#" role="button" class="copy" data-bind="css: {copyHidden: showCopiedIndicator}, click: copy, attr: { tabindex: tabIndex }">\r\n                <span class="iconfont link" data-bind="l10n: {key: \'header_text_copyLink\'}"></span>\r\n            </a>\r\n            \x3c!-- ko if: showCopiedIndicator --\x3e\r\n            <div class="copiedIndicator" data-bind="css: {copiedIndicatorFadeIn: showCopiedIndicator}"><span class="iconfont link" data-bind="l10n: {key: \'header_text_copied\'}"></span></div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <a href="#" role="button" class="email" data-bind="click: send, attr: { tabindex: tabIndex }">\r\n            <span class="iconfont email" data-bind="l10n: {key: \'header_text_inviteViaEmail\'}"></span>\r\n        </a>\r\n        <a role="button" class="cancel" data-bind="click: cancel, l10n: {key: \'action_button_cancel\'}"></a>\r\n    </div>\r\n </div>\r\n'})),define("ui/components/chat/inviteLink",["require","exports","module","vendor/knockout","ui/viewModels/chat/inviteLink","constants/components","text!views/chat/inviteLink.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/inviteLink")
	t.name=e("constants/components").chat.INVITE_LINK,t.template=e("text!views/chat/inviteLink.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e,t),o=n.dataFor(t.element)
	return r.setContext(o),r.init(),r}}})),define("telemetry/chat/newConversationFlow",["require","swx-constants","experience/settings","services/telemetry/skypeData","services/telemetry/common/telemetryContext","services/telemetry/common/analyticsInfo","usertiming"],(function(e){var t=e("swx-constants").COMMON,n=e("experience/settings"),i=t.telemetry.performanceMarks,r=t.telemetry.stages.NEW_CONVERSATION,o=t.telemetry.measurements,a=e("services/telemetry/skypeData"),s=e("services/telemetry/common/telemetryContext"),c=e("services/telemetry/common/analyticsInfo"),l=e("usertiming")
	return function(){var e=r.STARTED,u=0,d=t.telemetry.NOT_AVAILABLE
	this.participantsCountUpdated=function(e){u=e},this.publish=function(){var p=s.get(),f=c.get().contactsInfo(),m=t.telemetry.NOT_AVAILABLE,h=t.telemetry.NOT_AVAILABLE,v=t.telemetry.NOT_AVAILABLE,g=[t.telemetry.historyLoadOrigin.NEW_CHAT_OPEN_EXISTING,t.telemetry.historyLoadOrigin.CALLING].indexOf(p.historyLoadOrigin)>-1,y=p.historyLoadOrigin===t.telemetry.historyLoadOrigin.NEW_CHAT_CREATION
	function b(){try{l.mark(i.NEW_CONVERSATION.RENDER_END),l.measure(o.NEW_CONVERSATION.TTC,i.NEW_CONVERSATION.FLOW_START,i.NEW_CONVERSATION.RENDER_END),l.measure(o.NEW_CONVERSATION.TTR,i.NEW_CONVERSATION.CREATION_START,i.NEW_CONVERSATION.RENDER_END)
	var e=l.getEntriesByName(o.NEW_CONVERSATION.TTC),t=l.getEntriesByName(o.NEW_CONVERSATION.TTR)
	e&&e.length>0&&(m=e[0].duration),t&&t.length>0&&(v=t[0].duration)}catch(n){console.error(n)}}if(g)e=r.REDIRECTED,b()
	else if(y){e=r.CREATED,b(),function(){try{if(l.getEntriesByName(i.NEW_CONVERSATION.CREATION_END_OK).length>0)return d=!0,void l.measure(o.NEW_CONVERSATION.TTS,i.NEW_CONVERSATION.CREATION_START,i.NEW_CONVERSATION.CREATION_END_OK)
	d=!1,l.measure(o.NEW_CONVERSATION.TTS,i.NEW_CONVERSATION.CREATION_START,i.NEW_CONVERSATION.CREATION_END_ERROR)}catch(e){console.error(e)}}(),h=t.telemetry.NOT_AVAILABLE
	var _=l.getEntriesByName(o.NEW_CONVERSATION.TTS)
	_&&_.length&&(h=_[0].duration)}else e=r.ABANDONED
	var E={type:"chat_conversation_new",data:{stage:e,contactsCount:f.totalContacts,participantsCount:u,CTA:p.historyLoadOrigin,TTC:m,TTS:h,TTR:v,success:d}};(function(){for(var e in i.NEW_CONVERSATION)i.NEW_CONVERSATION.hasOwnProperty(e)&&l.clearMarks(i.NEW_CONVERSATION[e])
	for(var t in o.NEW_CONVERSATION)o.NEW_CONVERSATION.hasOwnProperty(t)&&l.clearMeasures(o.NEW_CONVERSATION[t])})(),a.push(E,n.telemetry.chatTenantToken)}}})),define("ui/viewModels/chat/headerNewConversation",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-i18n","ui/modelHelpers/conversationHelper","swx-service-locator-instance","swx-constants","swx-constants","utils/common/eventHelper","ui/telemetry/actions/actionSources"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-i18n").localization,o=e("ui/modelHelpers/conversationHelper"),a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("swx-constants").KEYS,l=e("utils/common/eventHelper"),u=e("ui/telemetry/actions/actionSources"),d=s.events
	function p(e,t){var i,p,f=e.participantsProvider,m=this,h=n.observable(0),v=a.resolve(s.serviceLocator.FEATURE_FLAGS)
	function g(){h(f.selectedContacts().length),t.participantsCountUpdated(h())}e.conversationModel?m.conversationModel=e.conversationModel:m.conversationModel={isGroupConversation:n.observable(!0),topic:n.observable("DEFAULT_TOPIC"),participants:n.observableArray(),participantsCount:n.observable(0)},m.spacesEnabled=v.isFeatureOn(s.featureFlags.SPACES),m.telemetryContext={source:u.invitesShareButtons.newConversation},m.newConversationV2=n.observable(v.isFeatureOn(s.featureFlags.NEW_CONVERSATION_V2)),m.showMoreActions=function(){return v.isFeatureOn(s.featureFlags.SCHEDULE_CALL_FROM_CONVERSATION)&&!o.isOneToOneConversationWithAgent(m.conversationModel)&&!o.isOneToOneConversationWithEcho(m.conversationModel)},p=n.observable(m.spacesEnabled),m.participantCount=n.pureComputed((function(){var e=h()
	return v.isFeatureOn(s.featureFlags.INCLUDE_SELF_IN_PARTICIPANTS_COUNT)&&(e+=1),r.fetch({key:"label_text_participant",count:e})})),m.confirmButtonDisabled=n.pureComputed((function(){return 0===h()&&!p()})),m.topic=n.pureComputed((function(){return m.newConversationV2()?r.fetch({key:"conversation_header_topic_untitled_conversation"}):p()?o.createSpaceTopic():r.fetch({key:"conversation_header_topic_untitled_conversation"})})),m.setParticipantProvider=function(t){e.setParticipantProvider(t),i=(f=t).selectedContacts.subscribe(g)},m.confirm=function(){m.dispatchEvent(d.newConversation.CONFIRMED,p()),p(m.spacesEnabled),t.publish()},m.cancel=function(){m.dispatchEvent(d.newConversation.CANCELLED),p(m.spacesEnabled)},m.forwardEvent(d.roster.ROSTER_QUERY_CHANGED),m.forwardEvent(d.roster.ROSTER_QUERY_EXECUTED),m.forwardEvent(d.roster.ROSTER_SELECTION_REMOVED),m.forwardEvent(d.roster.PICKER_CONTACT_SELECTED),m.forwardEvent(d.roster.PICKER_CONTACT_DESELECTED),m.forwardEvent(d.conversation.SHARED),m.registerEvent(d.conversation.JOINING_ENABLED,p),m.dispose=function(){i&&i.dispose()},m.handleKeyDown=function(e,t){return l.getKeyCode(t)===c.ESCAPE&&(e.cancel(),t.stopPropagation()),!0}}return t.assign(p.prototype,i),p})),define("text!views/chat/headerNewConversation.html",[],(function(){return'<div class="headerMain">\r\n    <div class="roster">\r\n        <div class="grid">\r\n            <span class="tile conversationTopic">\r\n                <span class="tileText">\r\n                    <span class="tileName square">\r\n                        <h3 data-bind="html: topic"></h3>\r\n                    </span>\r\n                    <span class="tileMessage">\r\n                        <div class="message">\r\n                            <a class="participantCount">\r\n                                 <p data-bind="text: participantCount"></p>\r\n                            </a>\r\n                        </div>\r\n                    </span>\r\n                </span>\r\n            </span>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class="contactPickerWrapper" data-bind="event: { keydown: handleKeyDown }">\r\n    <div class="headerAdd">\r\n        <swx-contact-picker-input params="setParticipantProvider: setParticipantProvider"></swx-contact-picker-input>\r\n    </div>\r\n\r\n    <swx-contact-picker params="conversation: conversationModel, className: \'headerPicker\', showJumpToConversation: true"></swx-contact-picker>\r\n    \x3c!-- ko if: !newConversationV2() --\x3e\r\n        \x3c!-- ko if: spacesEnabled --\x3e\r\n            <swx-space-settings params="conversationModel: conversationModel, defaultVal: true"></swx-space-settings>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: newConversationV2 --\x3e\r\n    <div class="actions">\r\n        <div class="conversationButtons">\r\n            <div class="submitConversation">\r\n                <swx-button params="cssClass: \'secondary circle\', disabled: false, textKey: \'action_button_cancel\', titleKey: \'action_button_cancel\', ariaLabelKey: \'action_button_cancel\', action: cancel"></swx-button>\r\n                <swx-button params="cssClass: \'primary circle\', disabled: confirmButtonDisabled, textKey: \'action_button_confirm\', titleKey: \'action_button_confirm\', ariaLabelKey: \'action_button_confirm\', action: confirm"></swx-button>\r\n            </div>\r\n\r\n            \x3c!-- ko if: spacesEnabled --\x3e\r\n            <swx-conversation-share-link class="conversation-share-link-actions" params="conversationModel: conversationModel, telemetryContext: telemetryContext"></swx-conversation-share-link>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n<div class="headerControls" data-bind="css: { newConversationV2: newConversationV2 }">\r\n    \x3c!-- ko if: !newConversationV2() --\x3e\r\n    <div class="buttonRow">\r\n        <swx-button params="icon: \'tick\', cssClass: \'primary circle\', disabled: confirmButtonDisabled, textKey: \'action_button_confirm\', titleKey: \'action_button_confirm\', ariaLabelKey: \'action_button_confirm\', action: confirm"></swx-button>\r\n        <swx-button params="icon: \'cross\', cssClass: \'primary circle\', disabled: false, textKey: \'action_button_cancel\', titleKey: \'action_button_cancel\', ariaLabelKey: \'action_button_cancel\', action: cancel"></swx-button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: newConversationV2 --\x3e\r\n    <div class="buttonRow newConversationV2">\r\n        <swx-button class="callButtons" params="icon: \'videoOn\', cssClass: \'primary circle\', disabled: \'true\', textKey: \'button_text_videoCall\'"></swx-button>\r\n        <swx-button class="callButtons" params="icon: \'callStart\', cssClass: \'primary circle\', disabled: \'true\', textKey: \'button_text_audioCall\'"></swx-button>\r\n\r\n        \x3c!-- ko if: !showMoreActions() --\x3e\r\n        <swx-button data-swx-testId="addParticipantAction" params="icon: \'contactAdd\', cssClass: \'primary circle\', disabled: \'true\', textKey: \'button_text_addParticipants\'"></swx-button>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: showMoreActions() --\x3e\r\n        <swx-button params="icon: \'more\', cssClass: \'secondary circle stroke\', disabled: \'true\', textKey: \'button_text_moreActions\'"></swx-button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/headerNewConversation",["require","exports","module","vendor/knockout","telemetry/chat/newConversationFlow","ui/viewModels/chat/headerNewConversation","constants/components","text!views/chat/headerNewConversation.html"],(function(e,t){var n=e("vendor/knockout"),i=e("telemetry/chat/newConversationFlow"),r=e("ui/viewModels/chat/headerNewConversation")
	t.name=e("constants/components").chat.HEADER_NEW_CONVERSATION,t.template=e("text!views/chat/headerNewConversation.html"),t.viewModel={createViewModel:function(e,t){var o=new i,a=new r(e,o)
	return a.setContext(n.dataFor(t.element)),a}}})),define("text!views/chat/message.html",[],(function(){return'\x3c!-- ko ifnot: isMeCommandMessage --\x3e\r\n\x3c!-- ko if: showAuthorInfo --\x3e\r\n\x3c!-- ko if: isGroupConversation --\x3e\r\n\x3c!-- ko ifnot: disableOpenConversationWithAuthor --\x3e\r\n<a data-bind="click: openConversationWithAuthor, attr: {\'aria-label\': openConversationLabel, title: openConversationLabel}" role="button">\r\n    <swx-avatar params="isGroupAvatar: false, avatar: author.avatar, isAgent: author.isAgent, displayName: author.displayName, useAbsolutePosition: true" class="clickable"></swx-avatar>\r\n</a>\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- ko ifnot: isGroupConversation --\x3e\r\n<swx-avatar params="isGroupAvatar: false, avatar: author.avatar, isAgent: author.isAgent, displayName: author.displayName, useAbsolutePosition: true"></swx-avatar>\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n\r\n\x3c!-- ko if: isCallActivityItem --\x3e\r\n<div class="callAction">\r\n    <div class="iconfont" data-bind="css: callAction"></div>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n<div class="bubble">\r\n\r\n    \x3c!-- ko if: isSMS --\x3e\r\n    <div class="smsStatus">\r\n        \x3c!-- ko if:smsStatus() === \'Sending\' --\x3e\r\n        <div class="offScreen" data-bind="l10n: { \'key\': \'sms_status_sending\'}"></div>\r\n        <span class="iconfont mobile" data-bind="attr:{title: smsStatus}"></span>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if:smsStatus() === \'Delivered\' --\x3e\r\n        <div class="offScreen" data-bind="l10n: { \'key\': \'sms_status_delivered\'}"></div>\r\n        <span class="iconfont mobileOk" data-bind="attr:{title: smsStatus}"></span>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if:smsStatus() === \'Error\' --\x3e\r\n        <div class="offScreen" data-bind="l10n: { \'key\': \'sms_status_deliveringError\'}"></div>\r\n        <span class="iconfont mobileError" data-bind="attr:{title: smsStatus}"></span>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko ifnot: isMeCommandMessage --\x3e\r\n    \x3c!-- ko if: renderAuthorInfo --\x3e\r\n    <div class="offScreen" data-bind="l10n: { \'key\': \'label_text_from\' }"> </div>\r\n    \x3c!-- ko if: isGroupConversation --\x3e\r\n    \x3c!-- ko ifnot: disableOpenConversationWithAuthor --\x3e\r\n    <a data-bind="css: { offScreen: !showAuthorInfo() }, attr: {\'aria-label\': openConversationLabel}, click: openConversationWithAuthor" role="button">\r\n        <swx-name params="person: author"></swx-name>\r\n    </a>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: disableOpenConversationWithAuthor --\x3e\r\n    <swx-name params="person: author" data-bind="css: { offScreen: !showAuthorInfo() }"></swx-name>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko ifnot: isGroupConversation --\x3e\r\n    <swx-name params="person: author" data-bind="css: { offScreen: !showAuthorInfo() }"></swx-name>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="arrow" data-bind="css:{hide:showGiphyMetadata}"></div>\r\n\r\n    <div class="content" data-bind="template: { name: contentTemplate, data: $data }, attr: { id: $data.contentId }"></div>\r\n\r\n    <div class="timestamp" data-bind="css: { offScreen: !showTimestamp() }">\r\n        <div class="offScreen" data-bind="l10n: { \'key\': \'message_text_timeStampMessage\' }"></div>\r\n        <p data-bind="text: setTimestamp, attr: {id: \'time_\' + $data.clientmessageid, title: setLongTimestamp}" class="smaller"></p>\r\n    </div>\r\n\r\n    \x3c!-- ko ifnot: isMeCommandMessage --\x3e\r\n    \x3c!-- ko if: isEdited --\x3e\r\n    <div class="messageIcon">\r\n        \x3c!-- ko ifnot: isDeleted --\x3e\r\n        <div class="offScreen" data-bind="l10n: { \'key\': \'message_edited_text\' }"></div>\r\n        \x3c!-- /ko --\x3e\r\n        <span class="iconfont edit"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: isDeleted --\x3e\r\n    <div class="offScreen" data-bind="l10n: { \'key\': \'message_removed_success\' }"></div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: messageDeliveryIndicatorEnabledSW4B --\x3e\r\n    <div class="messageIcon" data-bind="css:{hide:!deliveryFailed()}, attr:{title:deliveryFailedMessage, \'aria-label\':deliveryFailedMessage}">\r\n        <span class="iconfont warning"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n\x3c!-- ko if: messageDeliveryStatusEnabled && !isMeCommandMessage --\x3e\r\n<div class="DeliveryStatus" data-bind="css:{hide: (!isMyLastMessageInChat() && !deliveryFailed())}">\r\n    <span data-bind="css: deliveryStatusIconCssClass"></span>\r\n    <span class="DeliveryStatus-status fontSize-p smaller" data-bind="text: statusText"></span>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n\x3c!-- ko if: timestampsInNarrowModeEnabled --\x3e\r\n<div class="bottomTimestamp">\r\n    <div class="offScreen" data-bind="l10n: { \'key\': \'message_text_timeStampMessage\' }"></div>\r\n    <p data-bind="text: setBottomTimestamp, attr: {id: \'time_\' + $data.clientmessageid}" class="smaller"></p>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/chat/message",["require","exports","module","vendor/knockout","constants/components","text!views/chat/message.html"],(function(e,t){var n=e("vendor/knockout")
	t.name=e("constants/components").chat.MESSAGE,t.template=e("text!views/chat/message.html"),t.viewModel={createViewModel:function(e,t){var i=e.viewModel,r=n.contextFor(t.element).$parent
	return i.setContext(r),i.onRendered(),i.elementInfo=t,i}}})),define("ui/viewModels/chat/fragment",["require","lodash-compat","vendor/knockout","swx-constants","utils/common/eventMixin"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-constants").COMMON.events.navigation,r=e("utils/common/eventMixin")
	function o(e){var t=this
	this.name=e.page,this.options=e,this.hidden=n.observable(!0),this.setVisible=function(e){this.dispatchEvent(e?i.FRAGMENT_BEFORE_SHOW:i.FRAGMENT_BEFORE_HIDE,this.options,this.DIRECTION.CHILD),this.hidden(!e),this.dispatchEvent(e?i.FRAGMENT_SHOW:i.FRAGMENT_HIDE,this.options,this.DIRECTION.CHILD)},this.registerEvent(i.COMPONENT_RENDERED,(function(){t.dispatchEvent(i.COMPONENT_RENDERED,{fragment:t},t.DIRECTION.PARENT)}))}return t.assign(o.prototype,r),o})),define("ui/viewModels/chat/navigation",["require","lodash-compat","vendor/knockout","swx-cafe-application-instance","swx-enums","swx-constants","constants/components","swx-pubsub-instance","swx-service-locator-instance","services/telemetry/common/telemetryContext","ui/viewModels/chat/navigationHelper","utils/common/eventMixin","ui/viewModels/chat/fragment","experience/settings"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-cafe-application-instance"),r=e("swx-enums"),o=e("swx-constants").COMMON,a=e("constants/components"),s=e("swx-pubsub-instance").default,c=e("swx-service-locator-instance").default,l=e("services/telemetry/common/telemetryContext"),u=e("ui/viewModels/chat/navigationHelper"),d=e("utils/common/eventMixin"),p=e("ui/viewModels/chat/fragment"),f=e("experience/settings"),m=o.events.navigation,h=o.events.narrowMode,v=[a.people.CONTACTS_PAGE,a.people.DISCOVER_AGENTS_PAGE,a.calling.SKYPEOUT_PAGE,a.userSettings.USER_SETTINGS_PAGE]
	function g(e){var t,d,g,y,b=this,_=i.get()
	function E(e){return b.fragments().filter(e)[0]}function w(){clearTimeout(b._cacheLimitOverflowCheckTimer),b._cacheLimitOverflowCheckTimer=setTimeout(C,2e4)}function S(e){var t=e.options.model
	return!t||t.selfParticipant&&t.selfParticipant.audio.state()===r.callConnectionState.Disconnected}function x(e){b.fragments.remove(e),e.dispose()}function C(){if(!(b.fragments().length<=1)){var e=E((function(e){return e.hidden()&&S(e)}))
	e&&x(e),w()}}function T(){return E((function(e){return!e.hidden()}))}function I(e){var n,i,r=T()
	r&&r!==e&&(r.setVisible(!1),((n=r.name)===a.chat.NEW_CONVERSATION||n===a.userSettings.USER_SETTINGS_PAGE)&&x(r)),e.setVisible(!0),i=e,g=d?d.options:null,d=i,y.currentPlaceModel(i.options.model),y.currentPlaceName(i.name),t.historyLoadOrigin=i.options.origin,s.publish(m.FRAGMENT_LOADED,i.name)}function A(e){I(e.fragment)}function M(e){var t=T(),n=k(e)
	n&&x(n),(g===e||g&&g.model&&e&&e.model&&g.model===e.model)&&(g=null),t&&t===n&&R()}function O(e,t){return t&&t.name===e.page&&t.options.model===e.model}function k(e){return E((function(t){return O(e,t)}))}function N(e){var t,n=k(e)
	n?(n.options=e,I(n)):(n=function(e){var t=new p(e)
	return t.setContext(b),b.fragments.push(t),t}(e),t=e.page,-1!==v.indexOf(t)&&I(n)),w()}function P(t){if(!t||!t.page)throw new TypeError("You need to specify where you navigate !")
	if(!t.contentElementId||t.contentElementId===e){if(O(t,d))return void function(e){var t=k(e)
	t.options=e,t.setVisible(!0)}(t)
	if(2===f.API.version&&t.origin===o.telemetry.historyLoadOrigin.CALLING)return
	N(t)}}function R(){var e,t=_.conversationsManager.conversations().length
	_.signInManager.state()===r.loginState.SignedIn&&(g&&t?s.publish(m.NAVIGATE,g):t?(e={page:a.chat.CONVERSATION,model:_.conversationsManager.conversations()[0]},s.publish(m.NAVIGATE,e)):u.navigateToContactsPage())}function L(t){t.contentElementId&&t.contentElementId!==e||(t.page=a.chat.CONVERSATION,s.publish(m.NAVIGATE,t))}function D(){b.shrinkContent(!1),b.expandContent(!0)}function U(){b.expandContent(!1),b.shrinkContent(!0)}function F(){[].concat(b.fragments()).forEach((function(e){e.hidden()&&S(e)&&x(e)}))}this.expandContent=n.observable(!1),this.shrinkContent=n.observable(!0),this.fragments=n.observableArray(),this.isInBackground=n.observable(!1),this.dispose=function(){s.unsubscribe(m.OPEN_CONVERSATION,L),s.unsubscribe(m.NAVIGATE,P),s.unsubscribe(h.SIDEBAR_STATE_CHANGED,this.isInBackground),s.unsubscribe(m.NAVIGATE_TO_PREVIOUS_PAGE,R),s.unsubscribe(h.SHOW_SIDEBAR,U),s.unsubscribe(h.HIDE_SIDEBAR,D),s.unsubscribe(m.FRAGMENT_REMOVE,M),s.unsubscribe(m.FRAGMENT_REMOVE_ALL_HIDDEN,F)},this.handleUserAction=function(){return _.isEndpointActive&&_.isEndpointActive.set(!0),!0},this.init=function(){var n=2===f.API.version
	s.subscribe(m.OPEN_CONVERSATION,L),s.subscribe(m.NAVIGATE,P),s.subscribe(h.SIDEBAR_STATE_CHANGED,this.isInBackground),s.subscribe(m.NAVIGATE_TO_PREVIOUS_PAGE,R),s.subscribe(h.SHOW_SIDEBAR,U),n||s.subscribe(h.HIDE_SIDEBAR,D),s.subscribe(m.FRAGMENT_REMOVE,M),s.subscribe(m.FRAGMENT_REMOVE_ALL_HIDDEN,F),this.registerEvent(m.COMPONENT_RENDERED,A),t=l.get(),y=c.resolve(o.serviceLocator.NAVIGATION_CONTEXT),s.publish(o.apiUIEvents.SWX_CONTENT_LOADED,{contentElementId:e}),_.signInManager.state.when(r.loginState.SignedOut,(function(){b.fragments.removeAll(),y.reset(),d=void 0,g=void 0}))}}return t.assign(g.prototype,d),{build:function(e){return new g(e)}}})),define("text!views/chat/navigation.html",[],(function(){return'<div class="fragmentsContainer" data-bind="foreach: fragments, css: { showContent: expandContent, hideContent: shrinkContent }, event: { mousemove: handleUserAction, click: handleUserAction, mousewheel: handleUserAction, keydown: handleUserAction }">\r\n    <div class="fragment hide" aria-hidden="true" data-bind="component: { name: $data.name, params: $data.options },css: { hide: hidden },attr: { \'aria-hidden\': hidden }"></div>\r\n</div>\r\n<swx-narrator></swx-narrator>\r\n'})),define("ui/components/chat/navigation",["require","exports","module","ui/viewModels/chat/navigation","browser/dom","constants/components","text!views/chat/navigation.html"],(function(e,t){var n=e("ui/viewModels/chat/navigation"),i=e("browser/dom")
	t.name=e("constants/components").chat.NAVIGATION,t.template=e("text!views/chat/navigation.html"),t.viewModel={createViewModel:function(e,t){var r=(a=t.element,s=i.getParentWithClass(a,"swxContent"),s?s.getAttribute("id"):null),o=n.build(r)
	var a,s
	return o.init(),o}}}))
	define("ui/viewModels/chat/newConversation",["require","lodash-compat","swx-constants","utils/common/eventMixin","swx-utils-chat","swx-utils-common","swx-cafe-application-instance","swx-pubsub-instance","swx-service-locator-instance","usertiming"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("utils/common/eventMixin"),r=e("swx-utils-chat").conversation,o=e("swx-utils-common").async,a=e("swx-cafe-application-instance"),s=n.telemetry.performanceMarks,c=e("swx-pubsub-instance").default,l=e("swx-service-locator-instance").default,u=e("usertiming")
	function d(){var e,t=this,i=l.resolve(n.serviceLocator.FEATURE_FLAGS)
	t.registerEvent(n.events.newConversation.CONFIRMED,(function(i){var l,d=a.get().conversationsManager
	t.conversation||(t.conversation=r.createConversation(e.selectedContacts(),d,i))
	t.conversation.isJoiningEnabled.set.enabled.once(!0,(function(){t.conversation.isJoiningEnabled.set(i)})),t.newConversationV2&&r.addPersonsToConversation(e.selectedContacts(),t.conversation)
	l=t.conversation.isGroupConversation()?n.telemetry.historyLoadOrigin.NEW_CHAT_CREATION:n.telemetry.historyLoadOrigin.NEW_CHAT_OPEN_EXISTING,t.conversation.isGroupConversation()||a.get().conversationsManager.conversations.add(t.conversation)
	o.execute((function(){u.mark(s.NEW_CONVERSATION.RENDER_END),c.publish(n.events.navigation.OPEN_CONVERSATION,{model:t.conversation,origin:l})}))})),t.registerEvent(n.events.newConversation.CANCELLED,(function(){u.mark(s.NEW_CONVERSATION.RENDER_END),c.publish(n.events.navigation.NAVIGATE_TO_PREVIOUS_PAGE)})),t.registerEvent(n.events.conversation.SHARED,(function(o){var s=a.get().conversationsManager,c=i.isFeatureOn(n.featureFlags.SPACES)
	t.conversation||(t.conversation=r.createConversation(e.selectedContacts(),s,c),t.conversation.isJoiningEnabled.set.enabled.once(!0,(function(){t.conversation.isJoiningEnabled.set(c)})))
	o(t.conversation)})),t.forwardEvent(n.events.navigation.FRAGMENT_SHOW,t.DIRECTION.CHILD,(function(){u.mark(s.NEW_CONVERSATION.FLOW_START)})),t.newConversationV2=i.isFeatureOn(n.featureFlags.NEW_CONVERSATION_V2),t.conversation=null,t.setParticipantProvider=function(t){e=t}}return t.assign(d.prototype,i),d})),define("text!views/chat/newConversation.html",[],(function(){return'<div class="conversationControl chat themeLight editRosterMode newConversation">\r\n    <swx-header-new-conversation class="conversationHeader active editMode" params="setParticipantProvider: setParticipantProvider, conversationModel: conversation" data-bind="css: { newConversationV2: newConversationV2 }"></swx-header-new-conversation>\r\n</div>\r\n\r\n'})),define("ui/components/chat/newConversation",["require","exports","module","vendor/knockout","swx-constants","ui/viewModels/chat/newConversation","constants/components","text!views/chat/newConversation.html"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-constants").COMMON.events,r=e("ui/viewModels/chat/newConversation")
	t.name=e("constants/components").chat.NEW_CONVERSATION,t.template=e("text!views/chat/newConversation.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=n.dataFor(o),s=new r
	return s.setContext(a),s.dispatchEvent(i.navigation.COMPONENT_RENDERED),s}}})),define("ui/viewModels/chat/contactPickerInput",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-i18n","swx-constants","swx-service-locator-instance","swx-constants","utils/common/eventHelper","swx-utils-common","browser/dom","utils/common/scroll","swx-focus-handler","utils/common/accessibility"],(function(e){var t,n=e("lodash-compat"),i=e("vendor/knockout"),r=e("utils/common/eventMixin"),o=e("swx-i18n").localization,a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default,c=e("swx-constants").KEYS,l=e("utils/common/eventHelper"),u=e("swx-utils-common").async,d=e("browser/dom"),p=e("utils/common/scroll"),f=e("swx-focus-handler"),m=e("utils/common/accessibility").narrator,h=a.events
	function v(){var e,n=this,r=null,v=null
	function g(e){i.utils.arrayFirst(n.selectedContacts(),(function(t){return e.id()===t.id()}))||(n.selectedContacts.push(e),m.announce({key:"contact_isSelected"}),S(),w())}function y(e){n.selectedContacts.remove((function(t){return e.id()===t.id()})),x(e.displayName())}function b(e){n.inputValue()&&e&&n.showMoreResultsAvailableMessage(t&&e.moreResultsAvailable),n.showSpinner(!1)}function _(e){e.length||n.showMoreResultsAvailableMessage(!1)
	var t={query:e,selectedContacts:n.selectedContacts().slice()}
	n.dispatchEvent(h.roster.ROSTER_QUERY_CHANGED,t),n.showSpinner(C(a.featureFlags.SHOW_PICKER_SPINNER)&&e.length>0)}function E(){var e
	0!==n.selectedContacts().length&&(e=n.selectedContacts.pop(),n.dispatchEvent(h.roster.ROSTER_SELECTION_REMOVED,{person:e}),x(e.displayName()))}function w(){f.get().addFocusRequestToQueue(r),u.execute(e.scrollToBottom)}function S(){n.inputValue(""),n.showMoreResultsAvailableMessage(!1)}function x(e){m.announce({key:"accessibility_contactPickerResultRemoved",params:{displayName:e}})}function C(e){return s.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(e)}n.showSpinner=i.observable(!1),n.selectedContacts=i.observableArray(),n.placeholder=i.computed((function(){return n.selectedContacts().length>0?o.fetch({key:"input_placeholder_addAnotherContact"}):o.fetch({key:"input_placeholder_typeContactName"})})),n.inputValue=i.observable("").extend({rateLimit:{timeout:500,method:"notifyWhenChangesStop"}}),n.init=function(o){v=o,t=C(a.featureFlags.SHOW_SEARCH_QUERY_MORE_RESULTS_AVAILABLE),n.showMoreResultsAvailableMessage=i.observable(!1),r=v.querySelector("input"),v.addEventListener(h.browser.CLICK,w),n.inputSubscription=n.inputValue.subscribe(_),n.registerEvent(h.roster.PICKER_CONTACT_SELECTED,g),n.registerEvent(h.roster.PICKER_CONTACT_DESELECTED,y),n.registerEvent(h.roster.ROSTER_QUERY_EXECUTED,b),(e=p.build(d.getElement("div.scrollinWrapper",v))).init(),w()},n.dispose=function(){v.removeEventListener(h.browser.CLICK,w),n.inputSubscription&&n.inputSubscription.dispose(),n.placeholder.dispose(),n.selectedContacts=null,e.dispose()},n.handleKeyDown=function(e,t){var n=l.getKeyCode(t)
	return n===c.BACKSPACE&&""===e.inputValue()?(E(),e.showMoreResultsAvailableMessage(!1)):n===c.ESCAPE&&""!==e.inputValue()&&(S(),t.stopPropagation()),!0}}return n.assign(v.prototype,r),v})),define("text!views/chat/contactPickerInput.html",[],(function(){return'<div class="contactPickerInput scrollinWrapper">\r\n    <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n        <div class="contacts">\r\n            \x3c!-- ko foreach: selectedContacts --\x3e\r\n            <swx-contact-pill params="person: $data" class="contact-pill"></swx-contact-pill>\r\n            \x3c!-- /ko --\x3e\r\n            \r\n            <input autocomplete="organization" type="text" class="fontSize-p" data-bind="attr: { placeholder: placeholder }, textInput: inputValue, valueUpdate: \'afterkeydown\', event: { keydown: handleKeyDown },\r\n            l10n_attr: {\'placeholder\': \'input_placeholder_typeContactName\'}">\r\n            <swx-loading-animation data-bind="css: { hide: !showSpinner() }" class="ContactPickerInput-spinner spinner blue"></swx-loading-animation>\r\n        </div>\r\n    </div>\r\n    \x3c!-- ko if: showMoreResultsAvailableMessage() --\x3e\r\n    <div class="moreSearchResults">\r\n        <p class="strong" data-bind="l10n: {key: \'message_more_search_results_available\'}"></p>\r\n    </div>\r\n    \x3c!-- /ko--\x3e\r\n</div>\r\n'})),define("ui/components/chat/contactPickerInput",["require","exports","module","vendor/knockout","ui/viewModels/chat/contactPickerInput","constants/components","text!views/chat/contactPickerInput.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/contactPickerInput")
	t.name=e("constants/components").chat.CONTACT_PICKER_INPUT,t.template=e("text!views/chat/contactPickerInput.html"),t.viewModel={createViewModel:function(e,t){var r=new i
	return r.setContext(n.dataFor(t.element)),r.init(t.element),e.setParticipantProvider(r),r}}})),define("ui/viewModels/chat/spaceSettings",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-i18n","swx-enums","swx-utils-chat","utils/common/cafeObservable","swx-constants","utils/common/eventHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-i18n").localization,o=e("swx-enums"),a=e("swx-utils-chat").spaceMail,s=e("utils/common/cafeObservable"),c=e("swx-constants").COMMON.events,l=e("utils/common/eventHelper")
	function u(e,t){var i=this
	function u(){i.joiningEnabled(!!t)}i.role=n.observable(o.participantRole.Leader),i.spaceLink=n.observable(),i.joiningEnabled=n.observable(!!t),i.registerEvent(c.newConversation.CANCELLED,u),i.registerEvent(c.newConversation.CONFIRMED,u),e.selfParticipant&&(i.role=s.newObservableProperty(e.selfParticipant.role),i.spaceLink=s.newObservableProperty(e.uri),i.joiningEnabled(e.isJoiningEnabled()),e.isJoiningEnabled.get((function(e){i.joiningEnabled(e),i.dispatchEvent(c.conversation.JOINING_ENABLED,e,i.DIRECTION.PARENT)}))),i.label=n.pureComputed((function(){return i.isAdmin()?r.fetch({key:"header_text_allowOthersToJoin"}):r.fetch({key:"header_text_othersCanJoin"})})),i.isAdmin=n.pureComputed((function(){return i.role()===o.participantRole.Leader||!e.isGroupConversation()})),i.mailtoLink=n.pureComputed((function(){return a.createMailtoLink(e.topic(),i.spaceLink())})),i.linkShown=n.pureComputed((function(){return!!i.spaceLink()&&!!i.joiningEnabled()})),i.hideSettings=n.pureComputed((function(){return!i.isAdmin()&&!i.linkShown()})),i.joiningEnabledHandler=function(){var e=i.joiningEnabled()
	i.joiningEnabled(!e),i.dispatchEvent(c.conversation.JOINING_ENABLED,!e,i.DIRECTION.PARENT)},i.onJoinEnablerKeydown=function(e,t){var n=l.isActivation(t)
	return n&&i.joiningEnabledHandler(),!n}}return t.assign(u.prototype,i),u})),define("text!views/chat/spaceSettings.html",[],(function(){return'<div class="hide spaceSettings" data-bind="css: { hide: hideSettings, admin: isAdmin, linkShown: linkShown } ">\r\n    <div class="spaces">\r\n        <span class="label fontSize-p" data-bind="text: label"></span>\r\n        <a href="#" class="fontSize-p link" data-bind="text: spaceLink, attr: { href: spaceLink }"></a>\r\n        <a href="#" class="fontSize-p smaller copySpaceLink" data-bind="l10n: {key: \'header_text_copyLink\'}"></a>\r\n        <a href="#" class="fontSize-p smaller sendSpaceLink" data-bind="attr: { href: mailtoLink }, l10n: {key: \'header_text_inviteViaEmail\'}"></a>\r\n    </div>\r\n    <button class="toggler" data-bind="click: joiningEnabledHandler, css: { checked: joiningEnabled }, event: { keydown: onJoinEnablerKeydown }, attr: { \'aria-checked\': joiningEnabled ? \'true\' : \'false\' }" type="button"><span class="on"></span><span class="off"></span></button>\r\n</div>\r\n'})),define("ui/components/chat/spaceSettings",["require","exports","module","vendor/knockout","ui/viewModels/chat/spaceSettings","constants/components","text!views/chat/spaceSettings.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/spaceSettings")
	t.name=e("constants/components").chat.SPACE_SETTINGS,t.template=e("text!views/chat/spaceSettings.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e.conversationModel,e.defaultVal)
	return r.setContext(n.dataFor(t.element)),r}}})),define("utils/common/feedback",["require","exports","module","experience/settings","swx-browser-detect","ui/session/localSession","swx-cafe-application-instance","swx-i18n"],(function(e,t){var n=e("experience/settings"),i=e("swx-browser-detect").default,r=e("ui/session/localSession"),o=e("swx-cafe-application-instance"),a=e("swx-i18n").localization
	t.getFeedbackPageUrl=function(){var e,t,s,c,l,u,d=n.platformId,p=n.version,f=n.initParams.locale,m=o.get().personsAndGroupsManager.mePerson.id(),h=n.biAppName,v=n.initParams.correlationIds.hostProperty
	return 0===n.feedbackPageUrl.indexOf("mailto:")?(l=i.getBrowserInfo(),c=String.fromCharCode(10),t=a.fetch({key:"giveFeedback_subject"}),s=a.fetch({key:"giveFeedback_body"}),s+=c+c,s+=c+"-------------------------------",s+=c+"Skype Version: "+p,s+=c+"Browser Name: "+l.browserName,s+=c+"Browser Version: "+l.browserMajorVersion,s+=c+"Language: "+f,s+=c+"Property: "+h,s+=c+"Session Id: "+(r.getSessionId()||""),s+=c+"Tab Session Id: "+(r.getTabSessionId()||""),s+=c+"Host Property: "+v,s+=c+"Host User Id: "+n.initParams.correlationIds.userId,s+=c+"Host Session Id: "+n.initParams.correlationIds.sessionId,u=n.feedbackPageUrl+"?subject="+encodeURIComponent(t)+"&body="+encodeURIComponent(s)):(e={userId:n.initParams.correlationIds.userId,sessionId:n.initParams.correlationIds.sessionId},u=n.feedbackPageUrl+"?p="+encodeURIComponent(d)+"&v="+encodeURIComponent(p)+"&lang="+encodeURIComponent(f)+"&e="+encodeURIComponent(h),m&&(u+="&u="+encodeURIComponent(m)),v&&(u+="&tag="+encodeURIComponent(v)),u+="&tcg="+encodeURIComponent(_stringify(e))),u},t.getFeedbackPageTarget=function(){return 0===n.feedbackPageUrl.indexOf("mailto:")?"_self":"_blank"}})),define("ui/viewModels/chat/recentList",["require","lodash-compat","vendor/knockout","swx-service-locator-instance","utils/common/cafeObservable","swx-enums","swx-constants","swx-cafe-application-instance","swx-utils-common","swx-pubsub-instance","swx-utils-chat","utils/common/ko","swx-utils-common","usertiming","swx-i18n","browser/window","ui/viewModels/chat/navigationHelper","utils/common/scroll","utils/common/feedback","experience/settings","utils/common/styleModeHelper"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-service-locator-instance").default,r=e("utils/common/cafeObservable"),o=e("swx-enums"),a=e("swx-constants").COMMON,s=a.events.navigation,c=e("swx-cafe-application-instance"),l=e("swx-utils-common").async,u=e("swx-pubsub-instance").default,d=e("swx-utils-chat").dateTime,p=e("utils/common/ko"),f=e("swx-utils-common").array,m=a.telemetry.performanceMarks,h=e("usertiming"),v=e("swx-i18n").localization,g=e("browser/window"),y=e("ui/viewModels/chat/navigationHelper"),b=e("utils/common/scroll"),_=e("utils/common/feedback"),E=e("experience/settings"),w=a.styleMode,S=e("utils/common/styleModeHelper")
	return function(e,x,C,T){var I,A,M,O,k,N,P,R,L,D,U=this,F=".timeline .history",B=!0,V=null,G=n.observable(),H=!1,q=!1,W=t.debounce((function(e,t){u.publish(a.events.interaction.SCROLL_START,t)}),1e3,{leading:!0,trailing:!1}),j=i.resolve(a.serviceLocator.FEATURE_FLAGS)
	function z(){return j.isFeatureOn(a.featureFlags.FAVORITES_CONVERSATION_ENABLED)}function K(){G(d.getDate().toDateString())}function Y(e){return e.isOnCall()}function Q(e){return e.canJoinCall()}function X(){return O().filter((function(e){var t=Y(e),n=Q(e)
	return P!==t&&(P=t),t||n}))}function $(e){return!Y(e)&&!Q(e)}function J(e,t){return e.isFavorited()||null!==e.timestamp()||e.conversation.lastModificationTimestamp._set(new Date),e.isFavorited()!==t.isFavorited()&&z()?e.isFavorited()?-1:1:t.timestamp()-e.timestamp()}function Z(e){return!e.isBlocked()}function ee(e){return!!z()||!(e.isFavorited()&&null===e.timestamp())}function te(e){return e.isFavorited()}function ne(){var e
	return function(e){if(!e)return
	l.execute((function(){(function(e,t){t&&t!==e&&t.isActive()&&t.lastMessageIsOutgoing()&&(document.querySelector(F).scrollTop=0)})(V,e),function(e){if(!B||!e)return
	B=!1,function(){return!N.currentPlaceName()}()&&u.publish(s.OPEN_CONVERSATION,{model:e.conversation,origin:a.telemetry.historyLoadOrigin.TIMELINE_INIT})}(e),R.update(),V=e}))}((e=O().filter(Z).filter($).filter(ee).sort(J))[0]),e}function ie(){h.mark(m.TIMELINE.SYNC_START),k.mePerson.displayName.get(),ce(),g.addEventListener("resize",ce)}function re(){g.removeEventListener("resize",ce),B=!0,q=!1}function oe(){q||(I.conversations().length>0?le():y.navigateToContactsPage(le))}function ae(e){H=e}function se(){ae(!1),ce()}function ce(){L.clientHeight<D.scrollHeight||!I.getMoreConversations.enabled()?oe():(ae(!0),I.getMoreConversations(5).then(se,oe))}function le(){h.mark(m.TIMELINE.SYNC_END_OK),(new T).publish(),u.publish(a.apiUIEvents.SWX_TIMELINE_LOADED,{}),q=!0}function ue(e,t){var i,r=new x(C)
	r.init(t),(i=r).separator=n.computed((function(){return z()&&i.isFavorited()?v.fetch({key:"favorites_recents_category_name"}):(G(),d.getDateGroup(i.timestamp()))})),f.insertAt(O(),e,r),R.update()}function de(e){var t=O()[e]
	t.separator.dispose(),t.separator=null,t.dispose(),f.removeFrom(O(),e),R.update()}function pe(e){p.handleArrayChanges(O(),e,ue,de),O.valueHasMutated(),R.update()}U.init=function(){K(),(R=b.build(document.querySelector(".swx .side .timeline .scrollingWrapper"))).init(),L=document.querySelector(".swx .side .timeline .scrollingWrapper .scrollable"),D=document.querySelector(".swx .side .timeline .scrollingWrapper .scrollable div"),I=c.get().conversationsManager,k=c.get().personsAndGroupsManager,O=n.observableArray(),U.recentConversations=n.computed(ne),U.currentCalls=n.pureComputed(X),U.hasCurrentCall=function(){return U.currentCalls().length>0},N=i.resolve(a.serviceLocator.NAVIGATION_CONTEXT),U.buttonsDisabled=e.buttonsDisabled,U.hasNotificationsToggle=j.isFeatureOn(a.featureFlags.NOTIFICATIONS_TOGGLE_ENABLED),U.hasButtonFullSize=j.isFeatureOn(a.featureFlags.FULL_SCREEN_MODE_FROM_SIDEPANE),U.hasBetaLabel=j.isFeatureOn(a.featureFlags.HAS_BETA_LABEL),U.hasFeedbackLink=j.isFeatureOn(a.featureFlags.HAS_FEEDBACK_LINK),U.hasFeedbackIcon=j.isFeatureOn(a.featureFlags.HAS_FEEDBACK_ICON),U.feedbackIconURL=E.appBaseUrl+"/assets/images/components/common/feedback.svg",P=!1,A=r.newObservableCollection(I.conversations),M=A.subscribe(pe,null,"arrayChange"),U.mePersonId=r.newObservableProperty(k.mePerson.id),c.get().signInManager.state.when(o.loginState.SignedIn,ie),c.get().signInManager.state.when(o.loginState.SignedOut,re),u.subscribe(a.events.system.DATE_CHANGED,K),A().forEach((function(e,t){ue(t,e)})),O.valueHasMutated()},U.dispose=function(){M.dispose(),R.dispose(),U.recentConversations.dispose(),U.mePersonId.dispose(),u.unsubscribe(a.events.system.DATE_CHANGED,K),g.removeEventListener("resize",ce)},U.showSeparatorIcon=function(e){var n=U.recentConversations(),i=S.get().currentMode()===w.NARROW,r=z()&&t.some(U.recentConversations(),te),o=0===e||n[e-1]&&n[e-1].isFavorited()&&!n[e].isFavorited()
	return i&&r&&U.showSeparator(e)&&o},U.separatorIconClass=function(e){var t={},n=z()&&U.recentConversations()[e].isFavorited()
	return t.favourite=n,t.clock=!n,t},U.separatorText=function(e){return z()&&U.recentConversations()[e].isFavorited()?"favorites_recents_category_name":"accessibility_recentItem_recent_group"},U.showSeparator=function(e){var t=U.recentConversations()
	return 0===e||t[e-1].separator()!==t[e].separator()},U.onScroll=function(e,t){(function(){if(H||!I.getMoreConversations.enabled())return
	L.scrollTop+L.clientHeight+100>D.scrollHeight&&(ae(!0),I.getMoreConversations(5).then((function(){ae(!1)})))})(),W(e,t)},U.feedbackLabelTitle=function(){return v.fetch({key:"giveFeedback_tooltip"})},U.feedbackPageUrl=n.pureComputed((function(){return _.getFeedbackPageUrl()})),U.feedbackPageTarget=function(){return _.getFeedbackPageTarget()},U.stopSidebarExpanding=function(e,t){t.stopPropagation()}}})),define("telemetry/chat/timelineLoad",["require","usertiming","swx-browser-detect","swx-constants","experience/settings","services/telemetry/common/analyticsInfo","services/telemetry/common/telemetryContext","swx-telemetry-buckets","telemetry/utils/telemetryUtils","ui/telemetry/telemetryClient"],(function(e){var t=e("usertiming"),n=e("swx-browser-detect").default,i=e("swx-constants").COMMON,r=e("experience/settings"),o=e("services/telemetry/common/analyticsInfo"),a=e("services/telemetry/common/telemetryContext"),s=e("swx-telemetry-buckets"),c=e("telemetry/utils/telemetryUtils"),l=e("ui/telemetry/telemetryClient"),u=i.telemetry.timelineLoadEvent,d=i.telemetry.performanceMarks,p=i.telemetry.measurements
	return function(){var e=i.telemetry.NOT_AVAILABLE,f=i.telemetry.NOT_AVAILABLE,m=i.telemetry.NOT_AVAILABLE
	this.publish=function(){var h=a.get(),v=o.get(),g=v.conversationsInfo(),y=v.contactsInfo()
	try{(function(){if(t.mark(d.TIMELINE.RENDER_END),t.getEntriesByName(d.TIMELINE.SYNC_END_OK).length>0){t.measure(p.TIMELINE.TTL,d.TIMELINE.SYNC_START,d.TIMELINE.SYNC_END_OK)
	var n=t.getEntriesByName(p.TIMELINE.TTL)
	n&&n.length>0&&(e=n[0].duration)}else{t.measure(p.TIMELINE.TTL,d.TIMELINE.SYNC_START,d.TIMELINE.SYNC_END_ERROR)
	var i=t.getEntriesByName(p.TIMELINE.TTL)
	i&&i.length>0&&(e=i[0].duration)}if(t.getEntriesByName(d.TIMELINE.SYNC_END_404).length>0){t.measure(p.TIMELINE.TTL404,d.TIMELINE.SYNC_START,d.TIMELINE.SYNC_END_404)
	var r=t.getEntriesByName(p.TIMELINE.TTR)
	r&&r.length&&(m=r[0].duration)}t.measure(p.TIMELINE.TTR,d.TIMELINE.SYNC_START,d.TIMELINE.RENDER_END)
	var o=t.getEntriesByName(p.TIMELINE.TTR)
	o&&o.length>0&&(f=o[0].duration)})()}catch(E){console.error(E)}var b=u.TYPE,_=c.stringify({contactsCount:y.totalContacts,conv1Count:g.conversation1Count,conv30Count:g.conversation30Count,thread1Count:g.thread1Count,threads30Count:g.thread30Count,unreadCount:g.unreadConversationsCount,origin:h.historyLoadOrigin,activeEndpoints:h.activeEndpoints,isPinned:n.getBrowserInfo().isPinnedSite,ttl:e,ttr:f,t404:m,responseCode:h.timelineLoadStatusCode,contactsCountGroup:s.getContactsGroup(y.totalContacts),conv1CountGroup:s.getConversationCountGroup(g.conversation1Count),conv30CountGroup:s.getConversationCountGroup(g.conversation30Count),thread1CountGroup:s.getConversationCountGroup(g.thread1Count),thread30CountGroup:s.getConversationCountGroup(g.thread30Count),unreadCountGroup:s.getMessageCountGroup(g.unreadConversationsCount),ttlDurationGroup:s.getSecondsDurationGroupFromMs(e),ttrDurationGroup:s.getSecondsDurationGroupFromMs(f),t404DurationGroup:s.getSecondsDurationGroupFromMs(m),originDescription:c.getOriginDescription(h.historyLoadOrigin,i.telemetry.timelineLoadOrigin),isError:s.isError(h.timelineLoadStatusCode)})
	l.get().sendEvent(r.telemetry.uiTenantToken,b,_)}}})),define("text!views/chat/recents.html",[],(function(){return'<div data-bind="css:{ hide:hasCurrentCall()==false }">\r\n    <div class="current">\r\n        <div class="separator">\r\n            <p class="strong" data-bind="l10n: { key: \'label_text_currentCallHeading\'}"></p>\r\n        </div>\r\n    </div>\r\n    \x3c!-- ko foreach: currentCalls --\x3e\r\n    <div class="current">\r\n        <swx-current-call params="model: $data"></swx-current-call>\r\n    </div>\r\n    \x3c!--/ko --\x3e\r\n</div>\r\n\r\n<div class="scrollingWrapper" data-bind="keyboardNavigation: { itemSelector: \'a\' }">\r\n    <div class="history scrollable scrollViewport scrollViewportV fixSmall" data-bind="event: { scroll: onScroll }" tabindex="-1">\r\n\r\n        <div class="recents scrollViewport-inner" role="menu" data-bind="template: { name: \'recent-template\', foreach: recentConversations, as: \'recent\' }"></div>\r\n\r\n        \x3c!-- ko if: recentConversations().length == 0 --\x3e\r\n        <div role="listitem" class="RecentsMessage">\r\n            <p class="RecentsMessage-emptyConversation" data-bind="l10n: { key:  \'label_text_conversationsLoadNone\'}"></p>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</div>\r\n\r\n\x3c!-- ko if: hasNotificationsToggle || hasButtonFullSize || hasBetaLabel || hasFeedbackIcon --\x3e\r\n<div class="recents-badge">\r\n\r\n    \x3c!-- ko if: hasButtonFullSize --\x3e\r\n    <a class="buttonFullSize" href="https://web.skype.com/en/?source=owa" target="_blank">Full size</a>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: hasNotificationsToggle --\x3e\r\n    <swx-notifications-toggle-button params="isDisabled: buttonsDisabled" data-bind=" event: { mouseover: stopSidebarExpanding }"></swx-notifications-toggle-button>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: hasFeedbackIcon --\x3e\r\n    <a data-bind="attr: { title: feedbackLabelTitle(), href: feedbackPageUrl(), target: feedbackPageTarget()}, event: { mouseover: stopSidebarExpanding }">\r\n        <p>\r\n            <img data-bind="attr: {src: feedbackIconURL, alt: feedbackLabelTitle()}" />\r\n        </p>\r\n    </a>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: hasBetaLabel --\x3e\r\n    \x3c!-- ko if: hasFeedbackLink --\x3e\r\n    <a data-bind="attr: { title: feedbackLabelTitle(), href: feedbackPageUrl(), target: feedbackPageTarget()}, event: { mouseover: stopSidebarExpanding }">\r\n        <p class="smaller badge">♥ BETA</p>\r\n    </a>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko ifnot: hasFeedbackLink --\x3e\r\n    <p class="smaller badge">♥ BETA</p>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n<script type="text/html" id="recent-template">\r\n    \x3c!-- ko if: $parent.showSeparatorIcon($index()) --\x3e\r\n    <div role="heading" class="splitter" data-bind="l10n_attr: {\'aria-label\': $parent.separatorText($index())}">\r\n        <span class="icon iconfont favourite" data-bind="css:$parent.separatorIconClass($index())"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: $parent.showSeparator($index())--\x3e\r\n    <div role="heading" class="separator">\r\n        <p data-bind="text: recent.separator(), attr: {\'aria-label\': recent.separator()}" class="strong"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <swx-recent-item role="group" params="model: recent" class="list-selectable"></swx-recent-item>\r\n<\/script>\r\n'})),define("ui/components/chat/recents",["require","exports","module","ui/viewModels/chat/recentList","ui/viewModels/chat/recent","ui/viewModels/chat/message","telemetry/chat/timelineLoad","constants/components","text!views/chat/recents.html"],(function(e,t){var n=e("ui/viewModels/chat/recentList"),i=e("ui/viewModels/chat/recent"),r=e("ui/viewModels/chat/message"),o=e("telemetry/chat/timelineLoad")
	t.name=e("constants/components").chat.RECENTS,t.template=e("text!views/chat/recents.html"),t.viewModel={createViewModel:function(e){var t=new n(e,i,r,o)
	return t.init(),t}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-jskype-main/lib/utils/chat/smsMessageBuilder",["require","exports","lodash-compat","swx-utils-common","jcafe-property-model","swx-enums"],e)}((function(e,t){var n=e("lodash-compat"),i=e("swx-utils-common"),r=e("jcafe-property-model"),o=e("swx-enums")
	function a(e){switch(e){case 3:case 4:case 5:return o.smsStatus.Sending
	case 1:case 2:case 6:return o.smsStatus.Delivered
	default:return o.smsStatus.Error}}function s(e){switch(e){case 8:case 7:case 9:case 16:return!1
	default:return!0}}function c(e,t){var n=e
	return t.forEach((function(e){e.users.sort((function(e,t){return e.time-t.time})),n=JSON.parse(e.users[e.users.length-1].value).status})),n}function l(e,t){return e?t?e.getAttribute(t):e.textContent:""}function u(e,t,n){return l(e.querySelector(t),n)}function d(e,t){var n=s(t)?o.activityStatus.Succeeded:o.activityStatus.Failed
	e.status._set(n)}t.getInfo=function(e,t){var n=(new DOMParser).parseFromString(e,"application/xml"),i=Number(u(n,"status")),o=u(n,"sms","alt"),p=function(e,t,n){var i=e.querySelectorAll(t)
	return[].slice.call(i).map((function(e){return l(e,n)}))}(n,"target"),f=u(n,"price"),m=u(n,"requestId"),h=r.boolProperty(!0),v=r.command(a.bind(this),h),g=r.property({set:v}),y=r.command(c.bind(this,i),h),b=r.property({set:y})
	b(t.smsdeliveryreports()),g(b()),d(t,b())
	var _=t.smsdeliveryreports.observe((function(e){var n=e
	if(!Array.isArray(e)){var i=e[m]
	if(!i)return
	n=[{key:i.key,users:i.users}]}b(n),g(b()),d(t,b())}))
	return{content:o,targets:p,price:f,requestId:m,status:g,isSuccessful:function(){return s(b())},dispose:function(){_&&_.dispose()}}}
	var p=function(){function e(e){this.content=e}return e.prototype.toString=function(){return this.content},e}(),f=n.escape,m=n.escape
	function h(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i]
	var r=t?[""].concat(Object.keys(t).map((function(e){return e+'="'+f(String(t[e]))+'"'}))).join(" "):""
	return new p("<"+e+r+">"+n.map((function(e){return e instanceof p?e.toString():m(e)})).join("")+"</"+e+">")}t.calculateSmsFragments=function(e){var t,n,i=e,r=!0,o=new Array,a=new Array,s=i.length,c=-1,l=[c,c,c,c,c,c,c,c,c," ",10,c,-10,13,c,c,16,c,18,19,20,21,22,23,24,25,26,c,c,c,c,c," ","!",'"',"#",2,"%","&","'","(",")","*","+",",","-",".","/","0","1","2","3","4","5","6","7","8","9",":",";","<","=",">","?",0,"A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z",-60,-47,-62,-20,17,c,"a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z",-40,-64,-41,-61,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c," ",64,c,1,36,3,c,95,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,c,96,c,c,c,c,91,14,28,9,c,31,c,c,c,c,c,c,c,93,c,c,c,c,92,c,11,c,c,c,94,c,c,30,127,c,c,c,123,15,29,c,4,5,c,c,7,c,c,c,c,125,8,c,c,c,124,c,12,6,c,c,126,c,c,c]
	return function(){for(var e=0;e<s;e++){var t=i.charCodeAt(e)
	if(!t)return
	o.push(t),t>256?r=!1:l[t]===c?r=!1:l[t]<-1?a.push(2):a.push(1)}}(),r?function(){if(_.sum(a)<=160)t=1
	else{t=1
	for(var e=0,n=0;e<a.length;)n+a[e]<=153?(n+=a[e],e+=1):(t+=1,n=0)}}():(n=o.length,t=n<=70?1:Math.floor(n/67)+(n%67?1:0)),t},t.createOutgoingXMLPayload=function(e,t){var n=t||[],r=[e],o=[e]
	return String(h("sms",{alt:e},h("type",null,String(2)),h("status",null,String(4)),h("failurereason",null,String(0)),h.apply(void 0,["targets",null].concat(n.map((function(e){return h("target",{status:3},e)})))),h.apply(void 0,["body",null].concat(r.map((function(e,t){return h("chunk",{id:t},e)})),[h("untilnext",null,"155")])),h("encoded_body",null,e),h("sendtimestamp",null,(new Date).getTime()+""),h("restApiVersion",null,"2"),h("defaults",null,h("skype",null,h("deliveryReportVersion",null,"chatservice")),h("control",null,h("flowId",null,"skype.client.sms.1way"),h("deliveryMethod",null,"reliable")),h("content",null,h("body",null,e))),h.apply(void 0,["bulkItems",null].concat(o.map((function(e,t){return h("bulkItem",null,h("requestId",null,i.guid.create()),h("recipient",null,h("address",null,n[0])))}))))))}})),define("telemetry/chat/sendSmsTelemetry",["require","exports","module","swx-constants","experience/settings","services/telemetry/skypeData","swx-jskype-main/lib/utils/chat/smsMessageBuilder"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=n.telemetry.sendSms,o=e("services/telemetry/skypeData"),a=e("swx-jskype-main/lib/utils/chat/smsMessageBuilder")
	function s(e,t,s){var c=this,l=n.telemetry.NOT_AVAILABLE
	function u(){c.data={size:l,count:l,numberOfDestinations:l,participantsCount:l,status:l}}c.publish=function(){c.data.size=e.length,c.data.count=a.calculateSmsFragments(e),c.data.numberOfDestinations=s?s.length:l,c.data.participantsCount=t.participantsCount()||l
	var n={type:r.TYPE,data:c.data}
	o.push(n,i.telemetry.chatTenantToken),u()},u()}t.build=function(e,t,n){return new s(e,t,n)}})),define("ui/viewModels/chat/textarea",["require","services/telemetry/logging/perf/main","swx-cafe-application-instance","lodash-compat","utils/common/eventMixin","swx-constants","experience/settings","swx-constants","swx-constants","swx-utils-chat","swx-browser-detect","swx-focus-handler","swx-utils-common","swx-utils-chat","vendor/knockout","swx-service-locator-instance","swx-utils-chat","utils/common/cafeObservable","swx-i18n","swx-pubsub-instance","services/pes/constants","ui/modelHelpers/personHelper","swx-utils-common","ui/viewModels/chat/conversationTopic","ui/telemetry/actions/actionNames","telemetry/chat/sendSmsTelemetry","browser/window","ui/telemetry/telemetryClient","telemetry/chat/pes","swx-telemetry-buckets","swx-enums","utils/chat/translatorHelper","utils/chat/quoteMessageUtils","utils/common/accessibility"],(function(e){var t=e("services/telemetry/logging/perf/main"),n=e("swx-cafe-application-instance"),i=e("lodash-compat"),r=e("utils/common/eventMixin"),o=e("swx-constants").COMMON,a=e("experience/settings"),s=e("swx-constants").KEYS,c=o.events,l=e("swx-constants").CALLING,u=e("swx-utils-chat").dateTime,d=e("swx-browser-detect").default,p=e("swx-focus-handler"),f=e("swx-utils-common").async,m=e("swx-utils-chat").messageSanitizer,h=e("vendor/knockout"),v=o.isTyping,g=e("swx-service-locator-instance").default,y=e("swx-utils-chat").conversationCache,b=e("utils/common/cafeObservable"),_=e("swx-i18n").localization,E=e("swx-pubsub-instance").default,w=e("services/pes/constants"),S=e("ui/modelHelpers/personHelper"),x=e("swx-utils-common").stringUtils,C=e("ui/viewModels/chat/conversationTopic"),T=e("ui/telemetry/actions/actionNames"),I=e("telemetry/chat/sendSmsTelemetry"),A=e("browser/window"),M=e("ui/telemetry/telemetryClient"),O=e("telemetry/chat/pes"),k=e("swx-telemetry-buckets"),N=e("swx-enums"),P=e("utils/chat/translatorHelper"),R=e("utils/chat/quoteMessageUtils"),L=e("utils/common/accessibility")
	function D(e,r){var D,U,F,B,V,G,H,q,W,j,z=this,K=r.conversationModel,Y=K&&K.chatService.sendMessage,Q=r.sendMessage||Y,X=n.get(),$=X.translatorService,J=-1,Z=null,ee=!1,te=ue()?b.newObservableProperty(r.conversationModel.participantsCount):h.observable(1),ne=ue()?b.newObservableCollection(r.conversationModel.historyService.activityItems):h.observableArray(),ie="active",re=[],oe=g.resolve(o.serviceLocator.FEATURE_FLAGS),ae=oe.isFeatureOn(o.featureFlags.TRANSLATOR_SENDING_ENABLED),se=oe.isFeatureOn(o.featureFlags.FORMAT_QUOTES_ENABLED),ce=oe.isFeatureOn(o.featureFlags.CONTEXT_MENU_COPY_MESSAGES_ENABLED),le=L.narrator
	function ue(){return!!r.conversationModel}function de(){var e,t
	ue()&&oe.isFeatureOn(o.featureFlags.TYPING_INDICATOR_ENABLED)&&(!(t=n.get().personsAndGroupsManager.mePerson.preferences(o.userSettings.preferences.TYPING_INDICATOR))||t.value())&&((e=r.conversationModel.chatService).sendIsTyping.enabled()&&X.personsAndGroupsManager.mePerson.status()!==N.onlineStatus.Hidden&&(ee=!0,D=A.setTimeout((function(){ee=!1}),v.THROTTLE),e.sendIsTyping()))}function pe(){J=z.messageBody().length,f.execute(e.updateSizing)}function fe(){Z&&(Z=null,e.editing(!1),Ce())}function me(t,n){var i=n.stopImmediatePropagation
	return n._stopImmediatePropagationCalled=!1,n.stopImmediatePropagation=function(){n._stopImmediatePropagationCalled=!0,i.apply(n,arguments)},z.dispatchEvent(t,{event:n,viewModel:z,view:e},z.DIRECTION.CHILD),n._stopImmediatePropagationCalled}function he(){return!!Q}function ve(e){var t=e.isEdited?o.telemetry.chat.UI_EDIT_MESSAGE:o.telemetry.chat.UI_SEND_MESSAGE,n={emoticonsCount:e.emoticonsCount||0,messageLength:e.messageLength,participantsCount:te()}
	ue()&&1===te()&&(n.user_to=[r.conversationModel.participants()[0].person.id(),A.skypeTelemetryManager.PIIType.Identity]),e.isEdited&&(n.timedelta=e.timedelta),M.get().sendEvent(a.telemetry.uiTenantToken,t,n)}function ge(){var e=K._translatorSettings&&K._translatorSettings.isEnabled
	return e&&(q=K._translatorSettings.meLanguage.code,W=K._translatorSettings.participantLanguage.code),$&&e&&q&&W&&q!==W}function ye(e){e.translation?Q(e.message,null,e):Q(e.message)}function be(){return z.destination()===o.messageDestination.SKYPE_NETWORK}function _e(){var e,n,r,s,l=be()?"RichText":"RichText/Sms"
	if(t.getInstance().startTrace("messagePostSuccess"),t.getInstance().startTrace("messagePost"),t.getInstance().startTrace("messageAdd"),he()){ge()&&(s=m.processOutgoingTextMessage(m.stripHTML(z.messageBody())),!m.isMessageWithEmoticonsOnly(s))?P.requestTranslation(z.messageBody(),o.chat.messageType.OUTGOING,K,ye):(e=a.messageFilters&&a.messageFilters.outgoingMessageFilter?a.messageFilters.outgoingMessageFilter:null,n=i.isFunction(e)?e(z.messageBody()):z.messageBody(),r={quotesPresent:Se(),quotedMessageXML:z.quotedMessageXML()},"RichText/Sms"===l&&(r.targets=[z.destination()]),Q(n,l,r),"RichText/Sms"===l&&I.build(n,z.conversationModel,r.targets).publish())
	var u=m.getEmoticonNamesFromMessage(m.processOutgoingTextMessage(z.messageBody()))
	g.resolve(o.serviceLocator.PES_MRU_SERVICE).addItemsToMru(i.map(u,(function(e){return{id:e,type:w.itemTypes.emoticon.id}}))),O.emoticonsSentInMessage(u,re),re=[],z.dispatchEvent(c.textarea.MESSAGE_SENT,{},z.DIRECTION.PARENT),ve({messageLength:z.messageBody().length,emoticonsCount:u.length})}}function Ee(e,t){var n=t.translation,r=i.filter(e.translations(),(function(e){return e.users&&e.users[0]&&S.isMePersonId(e.users[0].mri)})).length
	n&&(e.translations&&e.translations().length&&r?e.translations().forEach((function(e){S.isMePersonId(e.users[0].mri)&&(e.users[0].value=n.users[0].value)})):e._translationsArray.add(n)),e.html(t.message)}function we(){var e=m.getEmoticonNamesFromMessage(m.processOutgoingTextMessage(z.messageBody())),t=z.quotedMessageXML()+m.processOutgoingTextMessage(z.messageBody(),r.conversationModel),n=t.length,i=Z.timestamp(),a=P.findMatchingTranslation(Z.translations,K._translatorSettings),s=ge()&&(a&&a!==t||!a&&Z.html()!==t),c={messageLength:n,emoticonsCount:e.length,isEdited:!0,timedelta:k.getMessageLifeDurationGroup(new Date-i)}
	s?(P.requestTranslation(z.messageBody(),o.chat.messageType.OUTGOING,K,Ee.bind(null,Z)),ve(c),le.announce({key:"message_edited_success"})):Z.html()!==t&&(Z.translations&&Z.translations().length&&Z.translations.empty(),Z.html(t),ve(c),le.announce({key:"message_edited_success"})),fe()}function Se(){return z.quotedMessageXML().length>0}function xe(){z.quotedMessageHTML(""),z.quotedMessageXML(""),z.messageQuoted=void 0}function Ce(t){!t&&z.messageBody("").length&&z.messageBody(""),Se()&&xe(),J=-1,pe(),E.publish(c.textarea.HAS_INPUT,!1),z.dispatchEvent(c.textarea.INPUT,{viewModel:z,view:e},z.DIRECTION.CHILD)}function Te(e){var t=g.resolve(o.serviceLocator.ACTION_TELEMETRY),n=function(e){return"button"===e.type?e.isEditedMessage?T.chat.editMessageButton:T.chat.sendMessageButton:"enter"===e.type?e.isEditedMessage?T.chat.editMessageEnter:T.chat.sendMessageEnter:void 0}(e)
	t.recordAction(n)}function Ie(){(z.messageBody().trim()||z.quotedMessageHTML().trim())&&(Z||he())&&(Z?we():_e(),Z=null,Ce())}function Ae(){Te({type:"button",isEditedMessage:Z}),Ie(),Re()}function Me(e){(Z||he())&&(e.preventDefault(),Te({type:"enter",isEditedMessage:Z}),Ie())}function Oe(e){var t
	U.chatInput=e,z.dispatchEvent(c.textarea.CHANGED,e,z.DIRECTION.PARENT),E.publish(c.textarea.HAS_INPUT,!0),t=e,be()||z.dispatchEvent(c.textarea.UPDATE_SMS_FRAGMENTS,t,z.DIRECTION.PARENT)}function ke(e){U.quotedMessageXML=e,z.dispatchEvent(c.textarea.CHANGED,e,z.DIRECTION.PARENT)}function Ne(e){U.quotedMessageHTML=e,z.dispatchEvent(c.textarea.CHANGED,e,z.DIRECTION.PARENT),E.publish(c.textarea.HAS_INPUT,!0)}function Pe(e){z.dispatchEvent(c.textarea.UPDATE_SMS_DESTINATION,{destination:e,inputText:z.messageBody()},z.DIRECTION.PARENT)}function Re(){p.get().addFocusRequestToQueue(r.chatInputEl.querySelector("textarea"),p.Priorities.Low)}function Le(){z.hasChatCapability()&&Boolean(r.chatInputEl.offsetParent)&&Re()}function De(){var e=z.hasChatCapability()?"area_text_insertText":"area_text_agent_insertText"
	return function(){function e(){return i.find(ne(),(function(e){return e.type()===N.activityType.ContactRequestIncomingInviteFree}))}return e()&&oe.isFeatureOn(o.featureFlags.INVITE_FREE_IMPLICIT_INCOMING_CONTACT_REQUEST)}()&&(e="invite_free_respond_request"),z.destination()!==o.messageDestination.SKYPE_NETWORK&&oe.isFeatureOn(o.featureFlags.SMS_SUPPORT_ENABLED)&&(e="sms_input_text_message",!z.isEnabled()&&z.isPstnSmsOnly&&(e="sms_insufficient_balance")),_.fetch({key:e})}function Ue(t){t&&t.prefillTextarea&&!z.messageBody()&&(z.messageBody(_.fetch({key:"unanswered_call_chatinput_placeholder"})),e.setCaretToEnd()),t&&t.focusTextarea&&Re()}function Fe(e){return e===s.ESCAPE&&!Be()||!(e!==s.BACKSPACE||""!==z.messageBody()||!Se())}function Be(){return 0===z.messageBody().length&&!Se()}function Ve(e){return e.preventDefault(),e.stopPropagation(),d.getBrowserInfo().isIeEngine&&(e.returnValue=!1),!1}function Ge(){return se&&be()}z.init=function(){U=ue()?y.forModel(r.conversationModel):{chatInput:null,quotedMessageXML:null,quotedMessageHTML:null},j=n.get().conversationsManager,z.conversationModel=r.conversationModel,z.isEnabled=h.observable(r.isEnabled),z.isServiceEnabled=r.isServiceEnabled,z.hasChatCapability=r.hasChatCapability,z.getSelectionStart=e.getSelectionStart,z.setBlurAndFocus=Le,z.messageMaxLength=o.textarea.MAX_LENGTH,z.destination=r.destination||h.observable(o.messageDestination.SKYPE_NETWORK),z.isPstnSmsOnly=r.isPstnSmsOnly||!1,z.topicViewModel=C.build(r.conversationModel),H=z.isEnabled().subscribe((function(e){e&&f.execute(Le)})),z.messageBody=h.observable(),F=z.messageBody.subscribe(Oe),z.messageBody(U.chatInput||""),G=z.destination.subscribe(Pe),z.quotedMessageHTML=h.observable(U.quotedMessageHTML||""),z.quotedMessageXML=h.observable(U.quotedMessageXML||""),z.narratorTextForQuotes=h.observable(""),z.label=h.pureComputed((function(){return te()<2?_.fetch({key:"label_text_insertText_oneToOne",params:{displayName:z.topicViewModel.topic(),quotedText:""!==z.quotedMessageHTML()?z.narratorTextForQuotes():""}}):_.fetch({key:"label_text_insertText_group",params:{displayName:z.topicViewModel.topic(),participantsText:_.fetch({key:"label_text_participant",count:te()}),quotedText:""!==z.quotedMessageHTML()?z.narratorTextForQuotes():""}})})),z.placeholder=h.computed(De),z.selectedSuggestion=h.observable(),pe(),B=z.quotedMessageXML.subscribe(ke),V=z.quotedMessageHTML.subscribe(Ne),z.registerEvent(c.textarea.SUBMIT_AND_FOCUS,Ae),z.registerEvent(c.emoticonPicker.EMOTICON_SELECTED,z.insertAtCursor),z.registerEvent(l.EVENTS.CALL_SCREEN_CLOSE,Re),z.registerEvent(l.EVENTS.UNANSWERED_CALL_CLOSE,Ue)
	z.registerEvent(c.message.QUOTE,z.quoteMessageText),z.registerEvent(c.message.EDIT,z.requestEditMessageText),z.registerEvent(c.expressionPicker.CLOSE_REQUEST,Le),z.registerEvent(c.shareControl.SHARE_CONTROL_HIDE,Re),z.registerEvent(c.suggestionList.ITEM_SELECTED,z.selectedSuggestion),E.subscribe(c.textarea.UPDATE_SMS_DESTINATION,z.updateQuotedMessage),E.subscribe(c.newConversation.CANCELLED,Re),E.subscribe(c.navigation.FRAGMENT_LOADED,Le),E.subscribe(c.navigation.LEAVE_EDIT_MODE,Re),E.subscribe(c.expressionPicker.ITEM_SEND_REQUEST,z.insertAtCursor),E.subscribe(c.textarea.UPDATE_TEXTAREA_ENABLE,z.updateTextAreaEnable),z.dispatchEvent(c.textarea.INITIALIZATION_COMPLETE,z,z.DIRECTION.PARENT),Le()},z.dispose=function(){A.clearTimeout(D),E.unsubscribe(c.newConversation.CANCELLED,Re),E.unsubscribe(c.navigation.LEAVE_EDIT_MODE,Re),E.unsubscribe(c.navigation.FRAGMENT_LOADED,Le),E.unsubscribe(c.expressionPicker.ITEM_SEND_REQUEST,z.insertAtCursor),E.unsubscribe(c.textarea.UPDATE_SMS_DESTINATION,z.updateQuotedMessage),E.unsubscribe(c.textarea.UPDATE_TEXTAREA_ENABLE,z.updateTextAreaEnable),H.dispose(),F.dispose(),B.dispose(),V.dispose(),z.placeholder.dispose(),z.topicViewModel.dispose(),G.dispose()},z.updateTextAreaEnable=function(e){z.isPstnSmsOnly&&z.isEnabled(e)},z.insertAtCursor=function(t,n){var a,s,c,l,u=t.item
	"emoticon"===u.type&&t.conversation===r.conversationModel&&(function(e){var t=i.find(e.sourceTab.packs,(function(t){return t.items.some((function(t){return t===e.item}))}))
	re.push({item:e.item,type:"mru"===e.sourceTab.id?o.telemetry.pes.source.RECENTS:o.telemetry.pes.source.ROSTER,tabIndex:e.sourceTab.index,tabName:e.sourceTab.title,section:t&&t.isFeatured?o.telemetry.pes.section.FEATURED:o.telemetry.pes.section.REGULAR})}(t),a=n||e.getSelectionStart(),s=z.messageBody(),c=u.shortcut+" ",l=x.inject(s,c,a),z.messageBody(l),e.setCursorAt(a+c.length),Le())},z.handleKeyDown=function(t,n){if(me(c.textarea.KEY_DOWN,n))return!1
	var i=n.keyCode||n.which
	return i===s.UP&&""===t.messageBody()&&t.requestEditMessageText(),Fe(i)?(fe(),Ce(),n.stopPropagation(),le.announce({key:"label_text_clearedText"})):i===s.BACKSPACE&&Se()&&function(t){var n=e.getSelectionStart(),i=e.getSelectionEnd()
	0===n&&0===i&&(Ce(!0),t.stopPropagation(),le.announce({key:"label_text_clearedQuotes"}))}(n),!0},z.handleInput=function(){z.messageBody().length!==J&&pe(),Be()&&(E.publish(c.textarea.HAS_INPUT,!1),fe()),z.dispatchEvent(c.textarea.INPUT,{viewModel:z,view:e},z.DIRECTION.CHILD)},z.handleKeyPress=function(e,t){return!me(c.textarea.KEY_PRESS,t)&&((t.keyCode||t.which)!==s.ENTER||t.shiftKey?ee||de():Me(t),!0)},z.onFocus=function(){r.chatInputEl.addClass(ie)},z.onBlur=function(){r.chatInputEl.removeClass(ie),e.updateSizing()},z.onBeforePaste=function(e,t){return Ve(t)},z.onPaste=function(t,i){var r,a,s,c,l,u,d=i.clipboardData||A.clipboardData,p=[],m=!!A.clipboardData,h=oe.isFeatureOn(o.featureFlags.FILE_PASTE_ENABLED),v=z.conversationModel.fileTransferService.send.enabled(),g=h&&n.get().personsAndGroupsManager.mePerson.preferences(o.userSettings.preferences.FILE_PASTE).value(),y=h&&v&&g
	if(i.originalEvent&&(d=d||i.originalEvent.clipboardData),!(r=d.getData("Text"))&&y&&(m?Array.prototype.forEach.call(d.files,(function(e){b(e)})):Array.prototype.some.call(d.types,(function(e){return"Files"===e}))&&Array.prototype.forEach.call(d.items,(function(e){var t=e.getAsFile()
	t&&b(t)})),p.length))return z.conversationModel.fileTransferService.send(p),Ve(i)
	function b(e){e.name="fileFromClipboard",p.push(e)}r=d.getData("Text"),s="",c=z.messageBody(),l=e.getSelectionStart(),u=e.getSelectionEnd(),a=z.messageMaxLength-c.length+u-l,r=r.trim()
	for(var _=0;_<r.length&&a>0;_++)s+=r[_],a--
	return Ge()&&ce&&(function(){var e=j._getMessageCopiedToCache(),t=e&&e.sourceMessage
	if(!t)return!1
	var n=e.selectedText,i=n||R.getContentToQuote(t)
	return!(!i||i.replace(/\n/g,"")!==s||(z.quoteMessageText(t,n),s="",0))}()||j._setMessageCopiedToCache(void 0)),z.messageBody(x.inject(c,s,l,u)),f.execute((function(){e.setCursorAt(l+s.length)})),pe(),Ve(i)},z.quoteMessageText=function(t,n){var i=function(e,t){var n=e.sender.displayName(),i=n||e.sender.id(),r=u.formatTimestamp(e.timestamp()),o=t||R.getContentToQuote(e),a="["+r+"] "+n+": "+o+" \n \n <<< "
	if(z.narratorTextForQuotes(_.fetch({key:"label_quoted_message",params:{quotesContent:o,senderName:n,time:r}})),Ge()){var s=z.conversationModel&&z.conversationModel.conversationId?z.conversationModel.conversationId:""
	a=R.getQuotedXmlString(e.sender.id(),i,o,s,e.timestamp())}return a}(t,n)
	fe(),z.messageQuoted=t,Ge()?function(e){z.quotedMessageXML(e),z.quotedMessageHTML(R.getQuotesDisplay(z.quotedMessageXML()))}(i):z.messageBody(i+z.messageBody()),pe(),f.execute(e.setCaretToEnd)},z.updateQuotedMessage=function(){if(Se()&&!be()){var e=z.messageQuoted
	xe(),z.quoteMessageText(e)}},z.requestEditMessageText=function(t){var n,o
	if(ue()&&(r.conversationModel.historyService.activityItems().length&&(t=t||(n=r.conversationModel.historyService.activityItems().reverse(),o=X.personsAndGroupsManager.mePerson.id(),n.filter((function(e){var t=e._isSMS&&e._isSMS()
	return e.sender&&e.sender.id()===o&&!t}))[0]))&&t.type()!==N.activityType.SystemMessage&&t.html&&t.html.set.enabled()&&t.text)){Ce()
	var a=m.compactHtml(t.html()),s=P.findMatchingTranslation(t.translations,K._translatorSettings),c=ae&&s?s:a,l=m.quotesPresentInHTML(c)
	if(l){var u=m.quotesPresentInXML(t.getOriginalContent())
	z.quotedMessageHTML(l),z.quotedMessageXML(u),c=i.isUndefined(c)?"":c.replace(l,"")}t._skypeemoteoffset&&(c=c.substr(t._skypeemoteoffset)),c=m.extractMessageTextContent(c),z.messageBody(c),Z=t,pe(),f.execute(e.setCaretToEnd),e.editing(!0)}}}return i.assign(D.prototype,r),D})),define("jsviews/chat/textarea",["require","browser/dom","swx-focus-handler"],(function(e){var t=e("browser/dom"),n=e("swx-focus-handler"),i="EDITING"
	return function(e,r){var o=this,a=e,s=t.getElement("textarea",e),c=t.getElementById("chatInputContainer",e)
	r=t.getElement(r),o.updateSizing=function(){var e,n,i=t.getElementById("quoteContainer",a),r=c&&c.scrollTop
	s.style.height="30px",e=""===s.value?function(){try{var e=s.placeholder,t=window.getComputedStyle(s),n=document.createElement("canvas").getContext("2d")
	return n.font=t.fontSize+" "+t.fontFamily,n.measureText(e).width>parseInt(t.width)?2*parseInt(t.lineHeight):parseInt(t.lineHeight)}catch(i){return 0}}():s.scrollHeight,e=Math.max(30,e),s.style.height=e+"px",c&&((n=e+9+(i?i.scrollHeight:0))<180?c.style.height=n+"px":(c.style.height="180px",c.scrollTop=r))},o.setCaretToEnd=function(){if(n.get().addFocusRequestToQueue(s),"number"!=typeof s.selectionStart){if(void 0!==s.createTextRange){var e=s.createTextRange()
	e.collapse(!1),e.select()}}else s.selectionStart=s.selectionEnd=s.value.length},o.getSelectionStart=function(){return s.selectionStart},o.getSelectionEnd=function(){return s.selectionEnd},o.setCursorAt=function(e){s.selectionStart=e,s.selectionEnd=e},o.editing=function(e){e?r.addClass(i):r.removeClass(i)}}})),define("text!views/chat/textarea.html",[],(function(){return"<swx-suggestion-list></swx-suggestion-list>\r\n\r\n<div id='chatInputContainer' class = 'container'>\r\n\r\n\x3c!-- ko if: quotedMessageXML().length > 0 --\x3e\r\n<div id='quoteContainer' data-bind=\"html:quotedMessageHTML\" ></div>\r\n\x3c!-- /ko --\x3e\r\n\r\n<textarea id=\"chatInputAreaWithQuotes\" data-bind=\"value: messageBody, enable: isEnabled(), css: {hide: !isServiceEnabled()},\r\n        valueUpdate: ['afterkeydown','propertychange','input'],\r\n        event: {\r\n            keypress: handleKeyPress,\r\n            keydown: handleKeyDown,\r\n            input: handleInput,\r\n            focus: onFocus,\r\n            blur: onBlur,\r\n            paste: onPaste,\r\n            beforepaste: onBeforePaste },\r\n        focusHandler: { priority: 2 },\r\n        l10n_attr: {'placeholder': placeholder},\r\n        attr: {\r\n            'aria-label': label,\r\n            'maxlength': messageMaxLength,\r\n            'aria-activedescendant' : (selectedSuggestion()!= null) && ('suggestionList-item-'+selectedSuggestion()) }\"\r\n      name=\"messageInput\"\r\n      aria-live=\"polite\"\r\n      class=\"inputField fontSize-p\"\r\n      aria-autocomplete=\"list\"\r\n      aria-owns=\"suggestionList\"\r\n      role=\"combobox\"></textarea>\r\n</div>\r\n\r\n\r\n"})),define("ui/components/chat/textarea",["require","exports","module","vendor/knockout","ui/viewModels/chat/textarea","jsviews/chat/textarea","constants/components","text!views/chat/textarea.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/textarea"),r=e("jsviews/chat/textarea")
	t.name=e("constants/components").chat.TEXTAREA,t.template=e("text!views/chat/textarea.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=new r(o,e.chatInputEl),s=new i(a,e),c=n.dataFor(o)
	return s.setContext(c),s.init(),s}}})),define("telemetry/chat/menuItemTelemetry",["require","exports","module","swx-constants","experience/settings","utils/common/styleModeHelper","swx-service-locator-instance","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=n.telemetry.menuItemClicked,o=n.styleMode,a=e("utils/common/styleModeHelper"),s=e("swx-service-locator-instance").default,c=e("ui/telemetry/telemetryClient")
	function l(){var e=this,t=n.telemetry.NOT_AVAILABLE,l=s.resolve(n.serviceLocator.FEATURE_FLAGS)
	function u(){e.data={narrow:t,button:t,ordinal:t,navigationMenuIconsEnabled:t}}e.publish=function(s){e.data.narrow=a.get().currentMode()===o.NARROW,e.data.button=s.id||t,e.data.ordinal=s.ordinal||t,e.data.navigationMenuIconsEnabled=l.isFeatureOn(n.featureFlags.NAVIGATION_MENU_ICONS_ENABLED)
	var d=r.TYPE,p=function(e){for(var t in e)e.hasOwnProperty(t)&&!("string"==typeof e[t]||e[t]instanceof String)&&(e[t]=e[t]+"")
	return e}(e.data)
	c.get().sendEvent(i.telemetry.chatTenantToken,d,p),u()},u()}t.build=function(){return new l}})),define("ui/viewModels/chat/menuItem",["require","exports","module","lodash-compat","vendor/knockout","usertiming","utils/common/eventHelper","swx-constants","swx-service-locator-instance","experience/settings","ui/telemetry/telemetryClient","telemetry/chat/menuItemTelemetry"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("usertiming"),o=e("utils/common/eventHelper"),a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default,c=e("experience/settings").telemetry,l=e("ui/telemetry/telemetryClient"),u=e("telemetry/chat/menuItemTelemetry")
	function d(e){var t=this,d=function(e){var t=""
	return n.merge({id:t,icon:t,text:t,navigation:{page:t,origin:t},telemetry:{uiAction:t,perfMarker:t,event:t}},e)}(e),p=u.build(),f=s.resolve(a.serviceLocator.FEATURE_FLAGS)
	t.id=d.id?"menuItem-"+d.id:d.id,t.icon=d.icon,t.text=d.text,t.page=d.navigation.page,t.isActive=i.observable(!1),t.isDisabled=d.isDisabled?d.isDisabled:i.observable(!1),t.isNavigationMenuIconsEnabled=f.isFeatureOn(a.featureFlags.NAVIGATION_MENU_ICONS_ENABLED),t.onKeyDown=function(e,n){var i=o.isActivation(n)
	return i&&t.onClick(),!i},t.onClick=function(){var n=d.telemetry,i=s.resolve(a.serviceLocator.PUBSUB),o=s.resolve(a.serviceLocator.ACTION_TELEMETRY)
	n.uiAction&&o.recordAction(n.uiAction),n.perfMarker&&r.mark(n.perfMarker),n.event&&l.get().sendEvent(c.uiTenantToken,n.event.name,n.event.data),e.ordinal=t.ordinal,p.publish(e),t.isActive(!0),i.publish(a.events.navigation.NAVIGATE,e.navigation)},t.getTitleText=function(){if(t.isNavigationMenuIconsEnabled)return t.text}}t.build=function(e){return new d(e)}})),define("ui/viewModels/chat/sidebar",["require","lodash-compat","vendor/knockout","swx-i18n","constants/components","swx-constants","swx-cafe-application-instance","ui/telemetry/actions/actionNames","swx-service-locator-instance","ui/viewModels/chat/menuItem","ui/telemetry/actions/actionSources"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("constants/components"),o=e("swx-constants").COMMON,a=e("swx-cafe-application-instance"),s=e("ui/telemetry/actions/actionNames"),c=e("swx-service-locator-instance").default,l=e("ui/viewModels/chat/menuItem"),u=e("ui/telemetry/actions/actionSources"),d=o.telemetry.historyLoadOrigin,p=o.events
	return function(){var e=this,f=c.resolve(o.serviceLocator.FEATURE_FLAGS),m=f.isFeatureOn(o.featureFlags.PSTN_ENABLED),h=f.isFeatureOn(o.featureFlags.AGENTS_DISCOVERABLE),v=f.isFeatureOn(o.featureFlags.ALTERNATIVE_SETTINGS_POSITION),g=c.resolve(o.serviceLocator.PUBSUB),y=t.once((function(){var n=t.clone(e.items()),i=v?n.length-2:n.length-1
	e.items.removeAll(),n.splice(i,0,l.build(M())),n.forEach((function(t){e.items.push(t)}))}))
	function b(){e.itemsDisabled(!1)}function _(){e.itemsDisabled(!0)}function E(t){e.isNotificationsCenterActive(t),t&&e.isSearchActive(!1)}function w(t){var n={source:u.search.reset.content},i=e.userSettingsMenuItem()
	e.items().forEach((function(e){e.isActive(e.page===t.page),g.publish(p.search.RESET,n)})),i.page!==t.page&&i.isActive(!1)}function S(){e.isSearchActive(!1)}function x(t){""!==t&&e.isSearchActive(!0)}function C(){return{navigation:{page:r.chat.NEW_CONVERSATION,origin:d.NEW_CHAT_DUMMY},id:"newChat",icon:"add",text:i.fetch({key:"button_text_newChat"}),isDisabled:e.itemsDisabled}}function T(){return{navigation:{page:r.people.CONTACTS_PAGE,origin:d.CONTACTS_PAGE},telemetry:{uiAction:s.contacts.openPage,perfMarker:o.telemetry.performanceMarks.CONTACTS.PAGE.OPENED},id:"contacts",icon:"skypeAddressBook",text:i.fetch({key:"contactPage_text_menuLink"}),isDisabled:e.itemsDisabled}}function I(){return{navigation:{page:r.people.DISCOVER_AGENTS_PAGE,origin:d.DISCOVER_AGENTS_PAGE},telemetry:{uiAction:s.discoverAgents.openPage,perfMarker:o.telemetry.performanceMarks.DISCOVER_AGENTS.PAGE.OPENED},id:"discoverAgents",icon:"botAdd",text:i.fetch({key:"button_text_discover_agents"}),isDisabled:e.itemsDisabled}}function A(){return{navigation:{page:r.calling.SKYPEOUT_PAGE,origin:d.SKYPEOUT_PAGE},telemetry:{uiAction:s.skypeOut.openPage,perfMarker:o.telemetry.performanceMarks.SKYPEOUT.PAGE.OPENED,event:{name:o.telemetry.pstn.eventName.PSTN_BUTTON_CLICKED,data:{}}},id:"dialpad",icon:"dialpad",text:i.fetch({key:"button_text_dialpad"}),isDisabled:e.itemsDisabled}}function M(){return{navigation:{page:r.userSettings.USER_SETTINGS_PAGE,origin:d.SKYPEOUT_PAGE},telemetry:{uiAction:s.userSettings.openPage,perfMarker:o.telemetry.performanceMarks.USER_SETTINGS.PAGE.OPENED},id:"userSettings",icon:"settings",text:i.fetch({key:"settings_page_text_header"}),isDisabled:e.itemsDisabled}}e.items=n.observableArray(),e.itemsDisabled=n.observable(!0),e.userSettingsMenuItem=n.observable(),e.isSearchActive=n.observable(!1),e.isNotificationsCenterActive=n.observable(!1),e.isNavigationMenuIconsEnabled=f.isFeatureOn(o.featureFlags.NAVIGATION_MENU_ICONS_ENABLED),e.isNotificationsCenterEnabled=f.isFeatureOn(o.featureFlags.NOTIFICATIONS_CENTER),e.isSidebarInAlternativeLayout=f.isFeatureOn(o.featureFlags.ALTERNATIVE_SIDEBAR_LAYOUT_ENABLED),e.isUserSettingsEnabled=n.observable(!1),e.hideRecents=n.computed((function(){return e.isSearchActive()||e.isNotificationsCenterActive()})),e.init=function(){var t
	function n(){var n=a.get().personsAndGroupsManager.mePerson.preferences(),i=f.isFeatureOn(o.featureFlags.USER_SETTINGS_ENABLED)
	e.isUserSettingsEnabled(i&&!!n.length),e.isNavigationMenuIconsEnabled&&e.isUserSettingsEnabled()&&y(),t&&(t.dispose(),t=null)}g.subscribe(p.search.RESET,S),g.subscribe(p.search.QUERY_CHANGED,x),g.subscribe(p.navigation.NAVIGATE,w),g.subscribe(p.navigation.NOTIFICATIONS_CENTER,E),g.subscribe(o.apiUIEvents.SWX_TIMELINE_LOADED,b),g.subscribe(o.apiUIEvents.SWX_ON_SIGN_OUT,_),function(){var t=[]
	e.isNavigationMenuIconsEnabled?(t.push(l.build(T())),h&&t.push(l.build(I())),m&&t.push(l.build(A())),e.isUserSettingsEnabled()&&t.push(l.build(M())),t.push(l.build(C()))):e.isSidebarInAlternativeLayout?(t=[l.build(C()),l.build(T())],h&&t.push(l.build(I())),m&&t.push(l.build(A()))):(t=[l.build(T())],h&&t.push(l.build(I())),t.push(l.build(C())),m&&t.push(l.build(A())))
	return t.forEach((function(e,t){e.ordinal=t+1})),t}().forEach((function(t){e.items.push(t)})),e.userSettingsMenuItem(l.build(M())),a.get().personsAndGroupsManager.mePerson.preferences().length?n():t=a.get().personsAndGroupsManager.mePerson.preferences.changed(n)},e.dispose=function(){g.unsubscribe(p.search.RESET,S),g.unsubscribe(p.search.QUERY_CHANGED,x),g.unsubscribe(p.navigation.NAVIGATE,w),g.unsubscribe(p.navigation.NOTIFICATIONS_CENTER,E),g.unsubscribe(o.apiUIEvents.SWX_TIMELINE_LOADED,b),g.unsubscribe(o.apiUIEvents.SWX_ON_SIGN_OUT,_),e.hideRecents.dispose()}}})),define("text!views/chat/sidebar.html",[],(function(){return'\x3c!-- ko if: isSidebarInAlternativeLayout  --\x3e\r\n    <div class="navigation beforeSearch">\r\n        <div role="menubar" data-bind="foreach: items">\r\n            <swx-menu-item params="viewModel: $data"></swx-menu-item>\r\n        </div>\r\n        \x3c!-- ko if: isNotificationsCenterEnabled --\x3e\r\n        <swx-notifications-menu-item params="isDisabled: itemsDisabled"></swx-notifications-menu-item>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- ko ifnot: isNotificationsCenterActive --\x3e\r\n    <div class="search afterMenuItems" data-bind="css: {active: isSearchActive}">\r\n        <div class="splitter"></div>\r\n        <swx-search-input></swx-search-input>\r\n        <swx-search-results></swx-search-results>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n\r\n\x3c!-- ko ifnot: isSidebarInAlternativeLayout  --\x3e\r\n<div class="search beforeMenuItems" data-bind="css: {active: isSearchActive}">\r\n    <swx-search-input></swx-search-input>\r\n    <div class="splitter"></div>\r\n    <swx-search-results></swx-search-results>\r\n</div>\r\n<div class="navigation afterSearch" data-bind="css: {hide: isSearchActive}">\r\n    <div role="menubar" data-bind="foreach: items, keyboardNavigation: { itemSelector: \'a\' }, css: { navigationMenuIcons: isNavigationMenuIconsEnabled }">\r\n        <swx-menu-item params="viewModel: $data" role="presentation"></swx-menu-item>\r\n    </div>\r\n    \x3c!-- ko if: isNotificationsCenterEnabled --\x3e\r\n    <swx-notifications-menu-item params="isDisabled: itemsDisabled"></swx-notifications-menu-item>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n<swx-recents params="buttonsDisabled: itemsDisabled" class="timeline" data-bind="css: {hide: hideRecents}"></swx-recents>\r\n\x3c!-- ko if: isUserSettingsEnabled() && !isNavigationMenuIconsEnabled --\x3e\r\n<div class="navigation afterTimeline" data-bind="keyboardNavigation: { itemSelector: \'a\' }">\r\n    <swx-menu-item params="viewModel: userSettingsMenuItem"></swx-menu-item>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n\x3c!-- ko if: isNotificationsCenterEnabled && isNotificationsCenterActive() --\x3e\r\n<swx-notifications></swx-notifications>\r\n\x3c!-- /ko --\x3e\r\n\r\n'})),define("ui/components/chat/sidebar",["require","exports","module","ui/viewModels/chat/sidebar","constants/components","text!views/chat/sidebar.html"],(function(e,t){var n=e("ui/viewModels/chat/sidebar")
	t.name=e("constants/components").chat.SIDEBAR,t.template=e("text!views/chat/sidebar.html"),t.viewModel={createViewModel:function(){var e=new n
	return e.init(),e}}})),define("text!views/chat/contactPill.html",[],(function(){return'<span class="tile" data-bind="css: statusClassName">\r\n    <span class="tileName presence square">\r\n        <h4 data-bind="text: displayName"></h4>\r\n    </span>\r\n</span>\r\n'})),define("ui/components/chat/contactPill",["require","exports","module","ui/viewModels/people/contact","ui/viewModels/people/contactBuilder","constants/components","text!views/chat/contactPill.html"],(function(e,t){var n=e("ui/viewModels/people/contact"),i=e("ui/viewModels/people/contactBuilder")
	t.name=e("constants/components").chat.CONTACT_PILL,t.template=e("text!views/chat/contactPill.html"),t.viewModel={createViewModel:function(e){if(e&&"object"==typeof e.person)return e.person instanceof n?e.person:i.build(e.person)
	throw new Error('missing parameter: "person"')}}})),define("ui/viewModels/chat/contactCard",["require","lodash-compat","vendor/knockout","swx-i18n","ui/telemetry/actions/actionSources","utils/common/cafeObservable","swx-enums","swx-constants","utils/common/eventHelper","utils/common/eventMixin","ui/contextMenu/contextMenu","swx-service-locator-instance","ui/contextMenu/items/all","ui/modelHelpers/personHelper","ui/viewModels/people/contactBuilder"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-i18n").localization,r=e("ui/telemetry/actions/actionSources"),o=e("utils/common/cafeObservable"),a=e("swx-enums"),s=e("swx-constants").COMMON,c=e("utils/common/eventHelper"),l=e("utils/common/eventMixin"),u=e("ui/contextMenu/contextMenu"),d=e("swx-service-locator-instance").default,p=e("ui/contextMenu/items/all"),f=e("ui/modelHelpers/personHelper"),m=e("ui/viewModels/people/contactBuilder"),h="guest",v="admin",g="attendee"
	function y(e){var l=e.participant,y=o.newObservableProperty(e.model.participants.remove.enabled),b=m.build(l.person),_=this,E=o.newObservableProperty(l.role),w=d.resolve(s.serviceLocator.FEATURE_FLAGS),S=w.isFeatureOn(s.featureFlags.DISABLE_CONTACT_CARD_MENU),x=w.isFeatureOn(s.featureFlags.HIDE_USER_ROLE),C=n.computed((function(){return E()===a.participantRole.Leader?v:l.isAnonymous()?h:g}))
	t.merge(_,b),_.role=n.computed((function(){var e
	return x||C()===g?"":(e="header_text_"+C(),C()===v&&d.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.USE_BUSINESS_WORDING)&&(e=e+"_4b"),i.fetch({key:e}))})),_.chevronAriaLabel=n.computed((function(){return i.fetch({key:"accessibility_groupProfile_"+C()+"Menu",params:{participantName:_.displayName()}})})),_.isMenuDisabled=n.computed((function(){return!!S||(e.model.selfParticipant.isAnonymous()||l.isAnonymous())&&!y()})),_.dispose=function(){b.dispose(),C.dispose(),_.role.dispose(),_.chevronAriaLabel.dispose(),_.isMenuDisabled.dispose()},_.onMenuHandlerKeydown=function(e,t){var n,i=c.isActivation(t)
	return i&&(n=function(e){var t=document.createEvent("MouseEvents"),n=e.target.getBoundingClientRect()
	return t.initMouseEvent("contextmenu",!0,!1,window,0,0,0,n.right,n.top,!1,!1,!0,!1,2,null),e.target.dispatchEvent(t),c.swallow(e),e.stopPropagation(),t}(t),_.menuHandler(e,n)),!i},_.menuHandler=function(t,n){var i=[],o={source:r.conversation.groupRoster}
	l.isAnonymous()||e.model.selfParticipant.isAnonymous()||(!w.isFeatureOn(s.featureFlags.PSTN_ENABLED)&&f.isPstn(l.person)||i.push(new p.OpenConversationWithPersonMenuItem(l.person)),i.push(new p.ViewPersonProfileMenuItem(l.person,s.telemetry.historyLoadOrigin.ROSTER,o))),y()&&i.push(new p.RemoveParticipantMenuItem(e.model,e.participant)),u.show(i,n)}}return t.assign(y.prototype,l),y})),define("text!views/chat/contactCard.html",[],(function(){return'<swx-avatar params="avatar: avatar, status: statusClassName, displayName: displayNameUnescaped, isPstn: isPstn, size: 40"></swx-avatar>\r\n<div class="text">\r\n    <span class="role fontSize-p smaller" data-bind="text: role"></span>\r\n    <span class="tile swxTileName">\r\n        <span class="tileName">\r\n            <span role="button" class="navigation-item">\r\n                <h4 data-bind="text: displayNameUnescaped"></h4>\r\n                <a role="listitem" class="menu iconfont chevronDown btnOutline" data-bind="event: {keydown: onMenuHandlerKeydown, click: menuHandler }, css: { hide: isMenuDisabled }, attr: {\'aria-label\': chevronAriaLabel}"></a>\r\n            </span>\r\n        </span>\r\n    </span>\r\n    <span class="tile">\r\n        <span class="tileMessage circle">\r\n            <div class="message">\r\n                <p data-bind="html: displayMessage"></p>\r\n            </div>\r\n        </span>\r\n    </span>\r\n</div>\r\n\r\n'})),define("ui/components/chat/contactCard",["require","exports","module","vendor/knockout","ui/viewModels/chat/contactCard","constants/components","text!views/chat/contactCard.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/contactCard")
	t.name=e("constants/components").chat.CONTACT_CARD,t.template=e("text!views/chat/contactCard.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e)
	return r.setContext(n.dataFor(t.element)),r}}}))
	define("text!views/chat/timeline/menuItem.html",[],(function(){return'<a href="#" role="menuitem" class="navItem"\r\n   data-bind="css: {active: isActive, icon: isNavigationMenuIconsEnabled}, visible: !isDisabled(), event: {click: onClick, keydown: onKeyDown}, attr: {\'aria-label\': getTitleText(), id: id }">\r\n        <span class="icon">\r\n            <span class="iconfont" data-bind="css: icon, attr: { title: getTitleText() }"></span>\r\n        </span>\r\n        <span class="text">\r\n            <h4 data-bind="text: text"></h4>\r\n        </span>\r\n</a>\r\n'})),define("ui/components/chat/menuItem",["require","exports","module","text!views/chat/timeline/menuItem.html","constants/components"],(function(e,t){var n=e("text!views/chat/timeline/menuItem.html")
	t.name=e("constants/components").chat.MENU_ITEM,t.viewModel={createViewModel:function(e){return e.viewModel}},t.template=n})),define("ui/telemetry/chat/guestActionsInHeader",["require","exports","module","swx-constants","experience/settings","swx-cafe-application-instance","usertiming","ui/telemetry/telemetryClient","ui/modelHelpers/personHelper"],(function(e,t){var n,i=e("swx-constants").COMMON,r=e("experience/settings"),o=e("swx-cafe-application-instance"),a=e("usertiming"),s=e("ui/telemetry/telemetryClient"),c=e("ui/modelHelpers/personHelper"),l=i.telemetry.guestActionsInHeader,u=i.telemetry.performanceMarks,d=i.telemetry.measurements
	function p(){var e=this
	function t(e){if(c.isGuest(o.get().personsAndGroupsManager.mePerson)){var t={ttp:n(),participantsNumber:e.participantsCount,totalMessagesCount:e.totalMessagesCount,userMessagesCount:e.userMessagesCount,cta:e.cta}
	s.get().sendEvent(r.telemetry.uiTenantToken,"chat_guest_headerActions",t)}}function n(){a.mark(u.CONVERSATION.TTP),a.measure(d.EXPERIENCE.TTL,u.EXPERIENCE.TTL_START,u.CONVERSATION.TTP)
	var e=a.getEntriesByName(d.EXPERIENCE.TTL),t=e&&e.length?e[0].duration:"undefined"
	return a.clearMeasures(d.EXPERIENCE.TTL),a.clearMarks(u.CONVERSATION.TTP),t}return e.onProfileToggled=function(e){e.cta=l.cta.PROFILE_TOGGLED,e.telemetryItem===l.telemetryItem.AVATAR?e.cta=1:e.telemetryItem===l.telemetryItem.TOPIC?e.cta=e.groupProfileExpanded?3:2:e.telemetryItem===l.telemetryItem.CHEVRON_DOWN?e.cta=4:e.telemetryItem===l.telemetryItem.CHEVRON_UP&&(e.cta=5),t(e)},e.onCopyLinkClicked=function(e){e.cta=l.cta.COPY_LINK,e.parent===l.parent.GROUP_PROFILE_VIEW_MODEL?e.cta=6:e.parent===l.parent.HEADER_VIEW_MODEL&&(e.cta=7),t(e)},e.onEmailLinkClicked=function(e){e.cta=l.cta.EMAIL_LINK,e.parent===l.parent.GROUP_PROFILE_VIEW_MODEL?e.cta=8:e.parent===l.parent.HEADER_VIEW_MODEL&&(e.cta=9),t(e)},e.onMediaButtonClicked=function(e){e.cta=10,t(e)},e}t.get=function(){return n||(n=new p),n}})),define("ui/viewModels/chat/conversation/callButtonViewModel",["require","exports","module","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-enums","swx-cafe-application-instance","swx-i18n","swx-constants","swx-constants","ui/modelHelpers/personHelper","swx-service-locator-instance","utils/common/cafeObservable","ui/modelHelpers/conversationHelper","swx-utils-chat","ui/viewModels/calling/helpers/callingFacade","ui/telemetry/actions/actionNames","ui/telemetry/chat/guestActionsInHeader","ui/viewModels/chat/conversationActivity","ui/modelObservers/agentAuthorizationObserver","ui/modelObservers/calling/activeCallObserver"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("utils/common/eventMixin"),o=e("swx-enums"),a=e("swx-cafe-application-instance"),s=e("swx-i18n").localization,c=e("swx-constants").COMMON,l=e("swx-constants").CALLING,u=e("ui/modelHelpers/personHelper"),d=e("swx-service-locator-instance").default,p=e("utils/common/cafeObservable"),f=e("ui/modelHelpers/conversationHelper"),m=e("swx-utils-chat").conversation,h=e("ui/viewModels/calling/helpers/callingFacade"),v=e("ui/telemetry/actions/actionNames"),g=e("ui/telemetry/chat/guestActionsInHeader"),y=e("ui/viewModels/chat/conversationActivity"),b=e("ui/modelObservers/agentAuthorizationObserver"),_=e("ui/modelObservers/calling/activeCallObserver"),E=function(e){var t,n,r,E,w,S=this,x=d.resolve(c.serviceLocator.FEATURE_FLAGS),C=i.observable(f.isPstnOnlyConversation(e)),T=x.isFeatureOn(c.featureFlags.CALLING),I=y.build(e),A=i.observable(!e.videoService.start.enabled()),M=b.build(e),O=_.build(),k=i.observable(0)
	function N(t){(function(){if(!e.isGroupConversation()&&x.isFeatureOn(c.featureFlags.PSTN_ENABLED)){var t=e.participants(0)
	t.audio.endpoint(t.person.id())}})(),a.get().conversationsManager.conversations.add(e),S.dispatchEvent(c.events.actions.callMade,{},S.DIRECTION.PARENT),h.placeCall(e,t,"startCallButton")}function P(){return{participantsCount:S.conversationModel.participants.size(),userMessagesCount:S.conversationModel.historyService.activityItems().filter((function(e){return e.type()===o.activityType.TextMessage&&u.isMePerson(e.sender)})).length,totalMessagesCount:S.conversationModel.historyService.activityItems().length}}function R(){for(var e,t=!1,n=S.conversationModel.participants().length,i=0;i<n&&!t;i++)t=!(e=S.conversationModel.participants()[i].person).isBlocked()&&e.capabilities.audio()
	S.hasAudioCapability(0===n||t)}function L(){for(var e,t=!1,n=S.conversationModel.participants().length,i=0;i<n&&!t;i++)t=!(e=S.conversationModel.participants()[i].person).isBlocked()&&e.capabilities.video()
	S.hasVideoCapability(0===n||t)}function D(){r&&(r.forEach((function(e){e.person.capabilities.audio.changed.off(R),e.subscription.dispose()})),r=void 0)}function U(){E&&(E.forEach((function(e){e.person.capabilities.video.changed.off(L),e.subscription.dispose()})),E=void 0)}function F(){n&&(n.isBlocked.changed.off(R),n.isBlocked.changed.off(L))}function B(){D(),U(),F(),r=[],S.conversationModel.participants().forEach((function(e){var t=e.person,n=t.capabilities.audio.subscribe(),i={person:t,subscription:n}
	t.capabilities.audio.get(),t.capabilities.audio.changed(R),r.push(i)})),E=[],S.conversationModel.participants().forEach((function(e){var t=e.person,n=t.capabilities.video.subscribe(),i={person:t,subscription:n}
	t.capabilities.video.get(),t.capabilities.video.changed(L),E.push(i)})),S.isOneToOneConversation()&&((n=S.participantPerson()).isBlocked.changed(R),n.isBlocked.changed(L)),m.isGuestHostConversation(e.conversationId)&&k(e.participants.size())}function V(){return m.isGuestHostConversation(e.conversationId)&&k()<1}S.conversationModel=e,S.participants=p.newObservableCollection(e.participants),S.isOneToOneConversation=i.computed((function(){return 1===S.participants().length})),S.participantPerson=i.computed((function(){if(S.isOneToOneConversation())return S.participants()[0].person})),S.callingDisabled=i.computed((function(){return!T||I.isCallingDisabled()||M.isConversationWithUnauthorizedAgent()})),S.videoCallingDisabled=i.computed((function(){return!T||I.isVideoCallingDisabled()||M.isConversationWithUnauthorizedAgent()})),S.hasAudioCapability=i.observable(!0),S.hasVideoCapability=i.observable(!0),S.conversationModel.participants.changed(B),S.isAudioDisabled=i.computed((function(){if(O.isCallActive())return!0
	if(S.callingDisabled())return!0
	if(V())return!0
	return!S.hasAudioCapability()})),S.isVideoDisabled=i.computed((function(){if(O.isCallActive())return!0
	if(S.videoCallingDisabled())return!0
	if(V())return!0
	return!S.hasVideoCapability()})),t=e.participants.observe((function(){C(f.isPstnOnlyConversation(e))})),w=e.videoService.start.enabled.changed((function(){A(!e.videoService.start.enabled())})),S.callingDisabledTooltip=i.computed((function(){var e=a.get().personsAndGroupsManager.mePerson.capabilities.audio
	return e()?"":function(){var e=d.resolve(c.serviceLocator.FEATURE_FLAGS)
	return e.isFeatureOn(l.FEATURE_FLAGS.CALLING)}()?e.reason===o.callingNotSupportedReasons.BrowserNotSupported?s.fetch({key:"message_text_callingNotSupportedBrowser"}):e.reason===o.callingNotSupportedReasons.OSNotSupported?s.fetch({key:"message_text_callingNotSupportedOS"}):"":s.fetch({key:"message_text_callingIsDisabled"})})),S.buttonVideoTitle=i.pureComputed((function(){if(!S.hasVideoCapability())return s.fetch({key:"videoCallDisabled_tooltip",params:{agentName:S.getDisabledConversationName()}})
	var e=S.callingDisabledTooltip()
	return""===e&&(e=s.fetch({key:"startVideoCall_tooltip"})),e})),S.buttonVideoAriaLabel=i.pureComputed((function(){var e=S.callingDisabledTooltip()
	return""===e&&(e=s.fetch({key:"accessibility_startVideoCall_ariaLabel"})),e})),S.buttonCallTitle=i.pureComputed((function(){if(!S.hasAudioCapability())return s.fetch({key:"callDisabled_tooltip",params:{agentName:S.getDisabledConversationName()}})
	var e=S.callingDisabledTooltip()
	return""===e&&(e=S.conversationModel.isGroupConversation()?s.fetch({key:"startGroupCall_tooltip"}):s.fetch({key:"startCall_tooltip"})),e})),S.buttonCallAriaLabel=i.pureComputed((function(){var e=S.callingDisabledTooltip()
	return""===e&&(e=S.conversationModel.isGroupConversation()?s.fetch({key:"accessibility_startGroupCall_ariaLabel"}):s.fetch({key:"accessibility_startCall_ariaLabel"})),e})),S.startCallWithAudio=function(){d.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(v.audioVideo.audioCall),g.get().onMediaButtonClicked(P()),N(!1)},S.startCallWithVideo=function(){d.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(v.audioVideo.videoCall),g.get().onMediaButtonClicked(P()),N(!0)},S.joinCall=function(){d.resolve(c.serviceLocator.ACTION_TELEMETRY).recordAction(v.audioVideo.joinCall),g.get().onMediaButtonClicked(P()),N(!1)},S.getDisabledConversationName=function(){var e=S.participantPerson()
	return e?e.displayName():S.conversationModel.topic()},S.dispose=function(){S.participants.dispose(),S.participantPerson.dispose(),S.callingDisabledTooltip.dispose(),S.buttonVideoTitle.dispose(),S.buttonVideoAriaLabel.dispose(),S.buttonCallTitle.dispose(),S.buttonCallAriaLabel.dispose(),S.isOneToOneConversation.dispose(),S.callingDisabled.dispose(),S.videoCallingDisabled.dispose(),I.dispose(),t&&t.dispose(),D(),U(),F(),S.conversationModel.participants.changed.off(B),w.dispose(),M.dispose(),O.dispose()}}
	n.assign(E.prototype,r),t.build=function(e){return new E(e)}})),define("telemetry/chat/profileCards",["require","experience/settings","ui/telemetry/telemetryClient","swx-constants"],(function(e){var t=e("experience/settings"),n=e("ui/telemetry/telemetryClient"),i=e("swx-constants").COMMON.telemetry
	return new function(){this.profileOpened=function(e){(function(e,r){var o={Entry_Point:(r||i.NOT_AVAILABLE).toString()}
	n.get().sendEvent(t.telemetry.chatTenantToken,e,o)})(i.contacts.name.PROFILE_OPENED,e)}}})),define("ui/viewModels/chat/header",["require","exports","module","lodash-compat","vendor/knockout","utils/common/eventMixin","utils/common/outsideClickHandler","swx-i18n","swx-cafe-application-instance","swx-service-locator-instance","swx-constants","ui/modelHelpers/conversationHelper","swx-utils-chat","swx-pubsub-instance","utils/common/cafeObservable","ui/viewModels/chat/conversation/callButtonViewModel","ui/viewModels/calling/startCallButtonViewModel","swx-constants","utils/common/eventHelper","ui/telemetry/actions/actionSources","ui/telemetry/chat/guestActionsInHeader","swx-enums","swx-utils-chat","swx-constants","ui/viewModels/chat/conversationActivity","ui/viewModels/chat/conversationTopic","ui/modelHelpers/personHelper","ui/viewModels/chat/conversationTile","ui/educationBubbles/educationBubble","ui/educationBubbles/educationBubbleInfo","utils/common/styleModeHelper","telemetry/chat/profileCards","utils/common/accessibility","ui/telemetry/actions/actionNames"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("utils/common/eventMixin"),o=e("utils/common/outsideClickHandler"),a=e("swx-i18n").localization,s=e("swx-cafe-application-instance"),c=e("swx-service-locator-instance").default,l=e("swx-constants").COMMON,u=l.events.navigation,d=e("ui/modelHelpers/conversationHelper"),p=e("swx-utils-chat").conversation,f=e("swx-pubsub-instance").default,m=e("utils/common/cafeObservable"),h=e("ui/viewModels/chat/conversation/callButtonViewModel"),v=e("ui/viewModels/calling/startCallButtonViewModel"),g=e("swx-constants").COMMON.events,y=e("utils/common/eventHelper"),b=e("ui/telemetry/actions/actionSources"),_=e("ui/telemetry/chat/guestActionsInHeader"),E=e("swx-enums"),w=e("swx-utils-chat").messageSanitizer,S=e("swx-constants").KEYS,x=e("ui/viewModels/chat/conversationActivity"),C=e("ui/viewModels/chat/conversationTopic"),T=e("ui/modelHelpers/personHelper"),I=e("ui/viewModels/chat/conversationTile"),A=e("ui/educationBubbles/educationBubble"),M=e("ui/educationBubbles/educationBubbleInfo"),O=e("utils/common/styleModeHelper"),k=e("telemetry/chat/profileCards"),N=e("utils/common/accessibility").narrator,P=e("ui/telemetry/actions/actionNames")
	function R(e,t,n){var r,R,L,D,U,F,B,V,G=e.conversationModel,H=this,q=null,W=e.conversationUpdateFlow,j=m.newObservableProperty(G.isJoiningEnabled),z=c.resolve(l.serviceLocator.FEATURE_FLAGS),K=i.observable(!1),Y=x.build(G),Q=C.build(G),X=s.get().translatorService,$=d.isPstnOnlyConversation(G),J=d.isOneToOneConversationWithAgent(G),Z=d.isOneToOneConversationWithEcho(G),ee=i.observable(!1),te=i.observable(!1)
	function ne(e){return!!e&&1===e.participants().length}function ie(e){var t=0
	e.forEach((function(e){!e||e.response&&200===e.response.status||t++})),W.performed(t)}function re(){H.hasNoSelectedParticipants(!q||0===q.selectedContacts().length)}function oe(e){var n=H.editModeActive()||H.profileExpanded()
	H.dispatchEvent(g.roster.EDIT_ROSTER_MODE,{isActive:n,isEditMode:H.editModeActive()},H.DIRECTION.PARENT),e?(o.add("conversationHeader",H.toggleProfile),t.restrict()):(o.remove("conversationHeader"),t.restore())}function ae(){K(!1),q=null,re(),H.toggleEditMode(),f.publish(u.LEAVE_EDIT_MODE)}function se(){K(!K())}function ce(e){e&&le()}function le(){var e=H.editModeActive(),t=H.profileExpanded();(e||t)&&(e?H.canAddParticipants()?H.undoSelectedParticipants():H.toggleEditMode():H.toggleProfile())}function ue(e){H.profileExpanded()||H.toggleProfile(void 0,e),e.editTopic&&!H.topicEditorExpanded()&&H.openTopicEditor()}function de(){H.profileExpanded()&&H.toggleProfile()}function pe(){return!d.isConversationWithWelcomeAgent(H.conversationModel)&&(H.isGroupConversation()&&H.headerControlsEnabled()||!H.isGroupConversation())}function fe(e){var t=he()
	t.parent=e.parent,_.get().onCopyLinkClicked(t)}function me(e){var t=he()
	t.parent=e.parent,_.get().onEmailLinkClicked(t)}function he(){return{participantsCount:H.conversationModel.participants.length,userMessagesCount:H.conversationModel.historyService.activityItems().filter((function(e){return e.type()===E.activityType.TextMessage&&T.isMePerson(e.sender)})).length,totalMessagesCount:H.conversationModel.historyService.activityItems().length}}function ve(e){H.participantCount(e),z.isFeatureOn(l.featureFlags.INCLUDE_SELF_IN_PARTICIPANTS_COUNT)&&H.participantCount(e+1)}function ge(){var e,t=d.isOneToOneConversationWithBlockedPerson(H.conversationModel)
	ee(!t&&(!ne(e=H.conversationModel)||(e.participants(0).person.capabilities.groupAdd?e.participants(0).person.capabilities.groupAdd():!d.isOneToOneConversationWithAgent(e))))}function ye(){be(),_e(),ne(H.conversationModel)&&H.conversationModel.participants()[0].person.capabilities.groupAdd?(F=H.conversationModel.participants()[0].person).capabilities.groupAdd.changed(ge):ge(),ne(H.conversationModel)?(F=H.conversationModel.participants()[0].person).isBlocked.changed(ge):ge()}function be(){F&&F.capabilities.groupAdd&&F.capabilities.groupAdd.changed.off(ge)}function _e(){F&&F.isBlocked.changed.off(ge)}function Ee(e){e.conversationModel.conversationId===H.conversationModel.conversationId&&te(!0)}function we(){te(!1)}function Se(){z.isFeatureOn(l.featureFlags.CALL_EDUCATION_BUBBLE)&&c.resolve(l.serviceLocator.SUBSCRIPTION_PROVIDER).getContacts().then((function(){!H.isCallingDisabled()&&!H.callButtonViewModel.isVideoDisabled()&&G.participants().filter((function(e){return e.person.status()===E.onlineStatus.Online})).length>0&&xe(M.CALL_EDUCATION_BUBBLE)}))}function xe(e){A.build(e.id,e.anchorElementQuery,e.i18nKey,e.iconUrlPath,e.options).show()}H._internal={isModelTopicEditable:i.observable(!1)},H.conversation=I.build(G,{contactOptions:{moodMessageFirst:!0}}),H.callButtonViewModel=h.build(G),H.callButtonViewModel.setContext(this),H.startCallButtonViewModel=v.build({callButtonViewModel:H.callButtonViewModel,historyOrigin:l.telemetry.historyLoadOrigin.CONVERSATION_HEADER_BUTTON,telemetryContext:{source:b.conversation.header.button}}),H.conversationModel=G,H.conversationModel.participants.changed(ye),H.spacesEnabled=z.isFeatureOn(l.featureFlags.SPACES),H.telemetryContext={source:b.invitesShareButtons.header},H.newConversationV2=z.isFeatureOn(l.featureFlags.NEW_CONVERSATION_V2),H.headerControlsEnabled=function(){return!z.isFeatureOn(l.featureFlags.HEADER_CONTROLS_DISABLED)&&!d.isConversationWithWelcomeAgent(H.conversationModel)},H.joinCallAriaLabel=a.fetch({key:"button_text_joinCall"}),H.joinCallTitle=a.fetch({key:"button_text_joinCall"}),H.addParticipantsTitle=a.fetch({key:"button_text_addParticipants"}),H.cancelAddParticipantsTitle=a.fetch({key:"button_text_cancelAddParticipants"}),H.spaceLink=m.newObservableProperty(G.uri),X&&(H.translatorServiceStateObservable=m.newObservableProperty(X.state)),H.role=m.newObservableProperty(G.selfParticipant.role),H.isAdmin=i.computed((function(){return H.role()===E.participantRole.Leader})),H.buttonAddPeopleToConversationTitle=i.pureComputed((function(){var e=""
	return!1===H.addParticipantsBtnDisabled()&&(e=a.fetch({key:"addPeopleToConversation_tooltip"})),e})),H.buttonAddPeopleToConversationAriaLabel=i.pureComputed((function(){var e=""
	return!1===H.addParticipantsBtnDisabled()&&(e=a.fetch({key:"accessibility_addPeopleToConversation_ariaLabel"})),e})),H.editModeActive=i.observable(!1),H.canJoinCall=Y.canJoinCall,H.initializeParticipants=i.observable(!1),H.hasNoSelectedParticipants=i.observable(!0),H.profileExpanded=i.observable(!1).extend({rateLimit:100}),H.isGroupConversation=m.newObservableProperty(G.isGroupConversation),H.canShowContactProfile=i.computed((function(){return!H.isGroupConversation()})),H.canExpandProfile=i.computed(pe),H.tabIndex=i.computed((function(){return pe()?0:-1}))
	H.avatar=m.newObservableProperty(G.avatarUrl),H.topic=Q.topic,H.displayName=Q.displayName,H.canAddParticipants=i.observable(!1),H.contact=null,H.isAgent=H.conversation.isAgent,H.isPstn=H.conversation.isPstn,H.confirmButtonsVisible=i.computed((function(){return H.editModeActive()})),H.addParticipantsBtnClasses=i.computed((function(){var e="secondary circle stroke"
	return H.editModeActive()?e+" active":e})),H.addParticipantsBtnDisabled=i.computed((function(){return!!te()||(!ee()||!H.canAddParticipants())})),H.isGuestHostConversation=p.isGuestHostConversation(G.conversationId),H.isCallingDisabled=Y.isCallingDisabled,H.isVideoCallingDisabled=Y.isVideoCallingDisabled,H.hideAudioButton=i.computed((function(){return!!(!z.isFeatureOn(l.featureFlags.CALLING)||z.isFeatureOn(l.featureFlags.USE_BUSINESS_WORDING)&&H.isCallingDisabled())})),H.hideVideoButton=i.computed((function(){return!!(!z.isFeatureOn(l.featureFlags.CALLING)||z.isFeatureOn(l.featureFlags.USE_BUSINESS_WORDING)&&H.isVideoCallingDisabled())})),H.spaceLink=i.observable(),H.isTooltipVisible=i.observable(!1),V=G.participants.add.enabled.changed((function(e){H.canAddParticipants(e)})),B=G.topic.set.enabled.changed((function(e){H._internal.isModelTopicEditable(e)})),H.spaceTopicEditorEnabled=z.isFeatureOn(l.featureFlags.SPACE_TOPIC_EDITOR),H.isServiceEnabled=m.newObservableProperty(H.conversationModel.chatService.sendMessage.enabled),H.topicEditable=i.computed((function(){return H.isServiceEnabled()&&H.isGroupConversation()&&H._internal.isModelTopicEditable()&&H.spaceTopicEditorEnabled})),H.canEditTopic=i.computed((function(){return H.topicEditable()&&H.profileExpanded()})),H.editTopicTitle=a.fetch({key:"spaces_welcomeRenameBtnTitle"}),H.editTopicConfirmAria=a.fetch({key:"action_button_confirm"}),H.editTopicCancelAria=a.fetch({key:"action_button_cancel"}),H.editTopic=i.observable(""),H.topicEditorExpanded=i.observable(!1),H.topicHasFocus=i.observable(!1),H.participantCount=i.observable(G.participantsCount())
	G.participantsCount.changed(ve),H.isIntegratedProperty=i.observable(O.get().isIntegratedProperty()),H.showMoreActions=function(){return z.isFeatureOn(l.featureFlags.SCHEDULE_CALL_FROM_CONVERSATION)&&!J&&!Z},H.closeTopicEditor=function(){H.topicEditorExpanded(!1),H.editTopic("")},H.openTopicEditor=function(){H.editTopic(w.getSanitizedTopic(G.topic())),H.topicEditorExpanded(!0),H.topicHasFocus(!1),r.onTopicEdit()},H.onTopicEditKeyDown=function(e,t){return t.keyCode===S.ENTER?(H.updateTopic(),H.topicHasFocus(!0),!1):t.keyCode!==S.ESCAPE||(H.closeTopicEditor(),t.stopPropagation(),H.topicHasFocus(!0),!1)},H.updateTopic=function(){var e=w.processOutgoingTextMessage(H.editTopic())
	e.length&&(G.topic(e),H.topicEditorExpanded(!1),H.editTopic(""),N.announce({key:"spaces_conversation_renamed_success",params:{conversationName:e}}))},H.onUpdateTopicKeyDown=function(e,t){var n=y.isActivation(t)
	return n&&H.updateTopic(),!n},H.onCloseTopicEditorKeyDown=function(e,t){var n=y.isActivation(t)
	return n&&H.closeTopicEditor(),!n},H.linkShown=i.pureComputed((function(){return H.spacesEnabled&&(j()||H.isAdmin())})),H.showTranslatorSettings=i.pureComputed((function(){return!(!X||$||J||Z||H.isGroupConversation()||H.profileExpanded()||H.translatorServiceStateObservable()!==l.translatorServiceState.Authenticated)})),H.headerAriaLabel=i.pureComputed((function(){var e
	return e=H.isGroupConversation()?H.profileExpanded()?"accessibility_groupProfile_headingWithOpenedProfile":"accessibility_groupProfile_headingWithClosedProfile":H.profileExpanded()?"accessibility_contactProfile_headingWithOpenedProfile":"accessibility_contactProfile_headingWithClosedProfile",a.fetch({key:e,params:{topic:H.topic()}})})),R=H.editModeActive.subscribe(oe),L=H.profileExpanded.subscribe(oe),H.focusRestrict=function(){H.profileExpanded()&&t.restrict()},H.init=function(e){var t;(r=e).init({toggleProfile:H.toggleProfile,abandonEditMode:le}),D=H.addParticipantsBtnDisabled.subscribe(ce),G.isGroupConversation()&&(H.spaceLink=m.newObservableProperty(G.uri)),H.forwardEvent(g.roster.ROSTER_QUERY_CHANGED),H.forwardEvent(g.roster.ROSTER_QUERY_EXECUTED),H.forwardEvent(g.roster.ROSTER_SELECTION_REMOVED),H.forwardEvent(g.roster.PICKER_CONTACT_SELECTED),H.forwardEvent(g.roster.PICKER_CONTACT_DESELECTED),H.forwardEvent(g.message.ADD_CONTACT,this.DIRECTION.PARENT,null,this.DIRECTION.CHILD),H.forwardEvent(g.actions.callMade,this.DIRECTION.PARENT,null,this.DIRECTION.CHILD),H.registerEvent(g.conversation.JOINING_ENABLED,se),H.registerEvent(g.conversation.OPEN_PROFILE,ue),H.registerEvent(g.conversation.CLOSE_PROFILE,de),H.registerEvent(g.conversation.COPY_LINK,fe),H.registerEvent(g.conversation.EMAIL_LINK,me),H.registerEvent(g.conversation.MESSAGES_LOADED,H.focusRestrict),f.subscribe(l.events.shareControl.SHARE_CONTROL_SHOW,Ee),f.subscribe(l.events.shareControl.SHARE_CONTROL_HIDE,we),Se(),H.showMoreActions()&&z.isFeatureOn(l.featureFlags.SCHEDULE_CALL_EDUCATION_BUBBLE_1)&&(H.isGroupConversation()?t=M.SCHEDULE_CALL_EDUCATION_BUBBLE_1_GROUP:(t=M.SCHEDULE_CALL_EDUCATION_BUBBLE_1).options.i18nParams={name:H.topic()},xe(t))},H.dispose=function(){R.dispose(),L.dispose(),D.dispose(),H.selectedContactsSubscription&&H.selectedContactsSubscription.dispose(),H.confirmButtonsVisible.dispose(),H.addParticipantsBtnDisabled.dispose(),H.addParticipantsBtnClasses.dispose(),H.topicEditable.dispose(),H.canEditTopic.dispose(),H.isAdmin.dispose(),H.canShowContactProfile.dispose(),H.canExpandProfile.dispose(),H.tabIndex.dispose(),r&&r.dispose(),r=null,H.conversation.dispose(),Y.dispose(),Q.dispose(),H.callButtonViewModel.dispose(),H.startCallButtonViewModel.dispose(),B&&B.dispose(),V&&V.dispose(),H.translatorServiceStateObservable&&H.translatorServiceStateObservable.dispose(),H.headerAriaLabel.dispose(),G.participantsCount.changed.off(ve),be(),_e(),H.conversationModel.participants.changed.off(ye),f.unsubscribe(l.events.shareControl.SHARE_CONTROL_SHOW,Ee),f.unsubscribe(l.events.shareControl.SHARE_CONTROL_HIDE,we)
	o.remove("conversationHeader")},H.submitButtonDisabled=i.pureComputed((function(){return H.hasNoSelectedParticipants()&&!K()})),H.toggleProfile=function(e,t){if(pe()){var n=H.profileExpanded()
	if(function(e,t){var n=e?"accessibility_contactProfile_closedProfile":"accessibility_contactProfile_openedProfile"
	N.announce({key:n,params:{topic:t}})}(n,H.topic()),H.profileExpanded(!n),G.isGroupConversation()){var i=he()
	i.telemetryItem=e,i.profileExpanded=n,_.get().onProfileToggled(i),H.initializeParticipants(!0),H.profileExpanded()&&H.editModeActive()&&ae(),H.profileExpanded()||H.closeTopicEditor(),r.onEditModeToggled(H.profileExpanded())}else if(H.profileExpanded()){var o=t&&t.source?t.source:b.conversation.header.button
	k.profileOpened(o)}}},H.setParticipantProvider=function(e){H.selectedContactsSubscription&&H.selectedContactsSubscription.dispose(),q=e,H.selectedContactsSubscription=q.selectedContacts.subscribe(re),re()},H.toggleEditMode=function(){var t=!H.editModeActive()
	H.editModeActive(t),t&&(c.resolve(l.serviceLocator.ACTION_TELEMETRY).recordAction(P.conversation.addParticipantsButton),H.profileExpanded(!1),(W=e.conversationUpdateFlow).start(G.participants().length,G.isGroupConversation())),r.onEditModeToggled(t)},H.showTooltip=function(){U&&window.clearTimeout(U),H.isTooltipVisible(!0)},H.hideTooltip=function(){U=window.setTimeout((function(){H.isTooltipVisible(!1)}),500)},H.undoSelectedParticipants=function(){ae(),W.cancelled(),W=null},H.submitSelectedParticipants=function(){var e=q.selectedContacts,t=e().length
	W.completed(t),G.isGroupConversation()?(K()&&G.isJoiningEnabled.set(!j()),p.addPersonsToConversation(e(),G).then(ie)):function(e){var t,i=s.get().conversationsManager,r=e().slice(0),o=K()?!j():j()
	r.push(G.participants(0).person),(t=p.createConversation(r,i,!0)).isJoiningEnabled.set.enabled.once(!0,(function(){t.isJoiningEnabled.set(o)})),o&&H.spacesEnabled&&t.topic.set.enabled.once(!0,(function(){t.topic(d.createSpaceTopic())})),f.publish(u.OPEN_CONVERSATION,{model:t,origin:l.telemetry.historyLoadOrigin.CONVERSATION_TO_THREAD,contentElementId:n})}(e),ae()},H.onToggleProfileKeyDown=function(e,t){var n=y.isActivation(t)
	return n&&H.toggleProfile(),!n}}n.assign(R.prototype,r),t.build=function(e,t,n){return new R(e,t,n)}})),define("jsviews/chat/header",["require","browser/dom","swx-constants","swx-constants"],(function(e){var t=e("browser/dom"),n=e("swx-constants").KEYS,i=e("swx-constants").COMMON
	return function(e){var r
	function o(e){e.keyCode===n.ESCAPE&&(e.stopPropagation(),r.abandonEditMode())}function a(){e.removeEventListener("keydown",o),document.removeEventListener(i.events.browser.CLICK,s,!0)}function s(e){!t.getParentWithClass(e.target,"conversationHeader")&&t.getParentWithClass(e.target,"swx-container")&&r.abandonEditMode()}this.init=function(e){r=e},this.dispose=function(){a()},this.onEditModeToggled=function(t){t?(e.addEventListener("keydown",o),document.addEventListener(i.events.browser.CLICK,s,!0)):a()},this.onTopicEdit=function(){t.getElement(".editTopic input.edit",e).select()}}})),define("text!views/chat/header.html",[],(function(){return'<div class="headerMain" data-bind="css: { canJoinCall: canJoinCall }">\r\n    <div class="roster">\r\n        <div class="grid" data-bind="css: { group: isGroupConversation, staticHeader: !canExpandProfile() }">\r\n            <swx-avatar role="button" data-bind="click: toggleProfile.bind(this, \'telemetryItemAvatar\', null), css: { hide: profileExpanded }" params="isGroupAvatar: isGroupConversation, avatar: avatar, isAgent: isAgent, status: conversation.statusClassName, isPstn: isPstn, displayName: displayName, useAbsolutePosition: true" class="avatar Avatar--fogTheme"></swx-avatar>\r\n\r\n            <swx-button data-bind="css: { hide: !profileExpanded()}" params="ariaLabelKey: headerAriaLabel, icon: \'chevronUp\', cssClass: \'primary circle\', titleKey: \'header_text_close\', textKey: \'header_text_close\', action: toggleProfile.bind(this, \'telemetryItemChevronUp\', true), tabindex:-1" class="hideProfile"></swx-button>\r\n\r\n            <span class="tile conversationTopic" data-bind="css: conversation.statusClassName">\r\n                <span class="tileText">\r\n                    <span class="tileName square">\r\n                        <h3 data-bind="css: { editable: topicEditable() }">\r\n                            <span role="button" class="iconfont button chevronUp" data-bind="css: { hide: !profileExpanded() }, click: toggleProfile.bind(this, \'telemetryItemChevronUp\'), enterKey: toggleProfile.bind(this, \'telemetryItemChevronUp\')"></span>\r\n                            <span class="hoverWrap" data-bind="css: { \'Header-Title--agent\': conversation.isCertifiedAgent() }">\r\n                                <span data-swx-testId="conversationTopic" data-bind="text: topic, click: toggleProfile.bind(this, \'telemetryItemTopic\'), enterKey: toggleProfile.bind(this, \'telemetryItemChevronUp\'), attr: {\'aria-label\': headerAriaLabel, \'aria-expanded\': profileExpanded, \'tabindex\': tabIndex}, hasFocus: topicHasFocus"></span>\r\n                                \x3c!-- ko if: conversation.isCertifiedAgent() --\x3e\r\n                                <span class="iconfont avatarBotCertified"></span>\r\n                                \x3c!-- /ko --\x3e\r\n                                \x3c!-- ko if: canExpandProfile --\x3e\r\n                                <span role="button" class="iconfont chevronDown" data-bind="css: { hide: profileExpanded }, click: toggleProfile.bind(this, \'telemetryItemChevronDown\')"></span>\r\n                                \x3c!-- /ko --\x3e\r\n                            </span>\r\n                            <button class="iconfont edit" data-bind="css: { hide: !canEditTopic() }, attr: {\'aria-label\': editTopicTitle, \'title\': editTopicTitle}, click: openTopicEditor" type="button"></button>\r\n                        </h3>\r\n                        \x3c!-- ko if: isGroupConversation --\x3e\r\n                        <div class="editTopic" data-bind="css: { hide: !topicEditorExpanded(), integratedProperty : isIntegratedProperty}">\r\n                            <input class="edit" data-bind="textInput: editTopic, event: {keydown: onTopicEditKeyDown }, hasFocus: topicEditorExpanded(), selected: topicEditorExpanded()" maxlength="200" />\r\n                            <a href="#" class="iconfont ok" role="button" data-bind="event: {click: updateTopic, keydown: onUpdateTopicKeyDown}, attr: {\'aria-label\': editTopicConfirmAria}"></a>\r\n                            <a href="#" class="iconfont cancel" role="button" data-bind="event: {click: closeTopicEditor, keydown: onCloseTopicEditorKeyDown}, attr: {\'aria-label\': editTopicCancelAria}"></a>\r\n                        </div>\r\n                        \x3c!-- /ko --\x3e\r\n                    </span>\r\n                    <span class="tileMessage" data-bind="css: { empty: !conversation.displayMessage(), presence: !profileExpanded(), circle: !profileExpanded()}">\r\n                        <div class="message fixSmall">\r\n                            <div class="displayMessage">\r\n                                <span data-bind="html: conversation.displayMessage, attr: {title: conversation.displayMessageTitle}" class="iconfont groupParticipantsLabel fontSize-p"></span>\r\n                                \x3c!--ko if: conversation.displayMessage() && linkShown() --\x3e\r\n                                <span class="fontSize-p divider">|</span>\r\n                                \x3c!-- /ko --\x3e\r\n                                \x3c!-- ko if: linkShown --\x3e\r\n                                <swx-conversation-share-link class="conversation-share-link conversation-share-link-header" params="conversationModel: conversationModel, telemetryContext: telemetryContext"></swx-conversation-share-link>\r\n                                \x3c!-- /ko --\x3e\r\n                            </div>\r\n                        </div>\r\n                    </span>\r\n                </span>\r\n            </span>\r\n\r\n            \x3c!-- ko if: headerControlsEnabled() --\x3e\r\n            <div class="headerControls" data-bind="css: { newConversationV2: newConversationV2, hide: confirmButtonsVisible }">\r\n                <div class="buttonRow">\r\n                    <swx-joincall-button data-bind="css: { hide: isCallingDisabled() || isVideoCallingDisabled() }" params="cssClass: \'primary circle joinCall\', conversationModel: conversationModel, showIcon: true, withVideo: true"></swx-joincall-button>\r\n                    <swx-joincall-button data-bind="css: { hide: isCallingDisabled }" params="cssClass: \'primary circle joinCall\', conversationModel: conversationModel, showIcon: true"></swx-joincall-button>\r\n                    <swx-button data-bind="css: { hide: hideVideoButton}" class="callButtons" params="icon: \'videoOn\', cssClass: \'swx-video-call-btn primary circle\', disabled: callButtonViewModel.isVideoDisabled, textKey: \'button_text_videoCall\', i18nTitle: callButtonViewModel.buttonVideoTitle, action: callButtonViewModel.startCallWithVideo, ariaLabel: callButtonViewModel.buttonVideoAriaLabel"></swx-button>\r\n                    <swx-button data-bind="css: { hide: hideAudioButton}" class="callButtons" params="icon: \'callStart\', cssClass: \'swx-audio-call-btn primary circle\', disabled: callButtonViewModel.isAudioDisabled, textKey: \'button_text_audioCall\', i18nTitle: callButtonViewModel.buttonCallTitle, action: callButtonViewModel.startCallWithAudio, ariaLabel: callButtonViewModel.buttonCallAriaLabel, hasMenuOptions: startCallButtonViewModel.hasMenuOptions, menuOptions: startCallButtonViewModel.getMenuOptions"></swx-button>\r\n\r\n                    \x3c!-- ko if: !showMoreActions() && !isGuestHostConversation --\x3e\r\n                    <swx-button data-swx-testId="addParticipantAction" params="conversation: conversationModel, icon: \'contactAdd\', disabled: addParticipantsBtnDisabled, cssClass: addParticipantsBtnClasses, textKey: \'button_text_addParticipants\', i18nTitle: buttonAddPeopleToConversationTitle, action: toggleEditMode, ariaLabel: buttonAddPeopleToConversationAriaLabel"></swx-button>\r\n                    \x3c!-- /ko --\x3e\r\n                    \x3c!-- ko if: showMoreActions() --\x3e\r\n                    <swx-more-actions-button class="moreActions" params="conversation: conversationModel, cssClass: \'secondary circle stroke\', addParticipantsDisabled: addParticipantsBtnDisabled, addParticipantsAction: toggleEditMode"></swx-more-actions-button>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: showTranslatorSettings --\x3e\r\n                <swx-translator-settings params="conversationModel: conversationModel"></swx-translator-settings>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: initializeParticipants --\x3e\r\n                <swx-group-profile params="conversationModel: conversationModel" data-bind="css: { hide: !profileExpanded() }" class="themeWhite groupProfileContainer"></swx-group-profile>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: canShowContactProfile() && profileExpanded() --\x3e\r\n                <swx-contact-profile params="conversationModel: conversationModel, conversationTile: conversation" class="themeWhite groupProfileContainer"></swx-contact-profile>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n\x3c!-- ko if: editModeActive --\x3e  \x3c!-- TODO: make sure this is not unnecessary disposed --\x3e\r\n<div class="contactPickerWrapper" css="modal" >\r\n    <div class="headerAdd">\r\n        <swx-contact-picker-input params="setParticipantProvider: setParticipantProvider"></swx-contact-picker-input>\r\n    </div>\r\n    <swx-contact-picker params="conversation: conversationModel, className: \'headerPicker\'"></swx-contact-picker>\r\n\r\n    \x3c!-- ko if: !newConversationV2 --\x3e\r\n        \x3c!-- ko if: spacesEnabled --\x3e\r\n            <swx-space-settings params="conversationModel: conversationModel"></swx-space-settings>\r\n        \x3c!-- /ko --\x3e\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: newConversationV2 --\x3e\r\n        <div class="actions">\r\n             <div class="submitConversation">\r\n                <swx-button params="cssClass: \'secondary circle\', textKey: \'button_text_cancelAddParticipants\', i18nTitle: cancelAddParticipantsTitle, ariaLabelKey: cancelAddParticipantsTitle, action: undoSelectedParticipants"></swx-button>\r\n                <swx-button params="cssClass: \'primary circle\', textKey: \'button_text_addParticipants\', i18nTitle: addParticipantsTitle, ariaLabelKey: addParticipantsTitle, action: submitSelectedParticipants"></swx-button>\r\n            </div>\r\n            \x3c!-- ko if: linkShown --\x3e\r\n            <swx-conversation-share-link class="conversation-share-link-actions" params="conversationModel: conversationModel"></swx-conversation-share-link>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n\r\n<div class="headerControls" data-bind="css: { newConversationV2: newConversationV2, hide: !confirmButtonsVisible() }">\r\n    \x3c!-- ko if: !newConversationV2 --\x3e\r\n    <div class="buttonRow">\r\n        <swx-button params="conversation: conversationModel, icon: \'tick\', disabled: submitButtonDisabled, cssClass: \'secondary circle\', textKey: \'button_text_addParticipants\', ariaLabelKey: \'button_text_addParticipants\', titleKey: \'action_button_confirm\', action: submitSelectedParticipants"></swx-button>\r\n        <swx-button params="conversation: conversationModel, icon: \'cross\', cssClass: \'secondary circle\', textKey: \'button_text_cancelAddParticipants\', ariaLabelKey: \'button_text_cancelAddParticipants\', titleKey: \'action_button_cancel\', action: undoSelectedParticipants"></swx-button>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: newConversationV2 --\x3e\r\n    <div class="buttonRow newConversationV2">\r\n        <swx-button data-bind="css: { hide: hideVideoButton}" class="callButtons" params="icon: \'videoOn\', cssClass: \'primary circle\', disabled: \'true\', textKey: \'button_text_videoCall\', i18nTitle: callButtonViewModel.buttonVideoTitle"></swx-button>\r\n        <swx-button data-bind="css: { hide: hideAudioButton}" class="callButtons" params="icon: \'callStart\', cssClass: \'primary circle\', disabled: \'true\', textKey: \'button_text_audioCall\', i18nTitle: callButtonViewModel.buttonCallTitle"></swx-button>\r\n\r\n        \x3c!-- ko if: !showMoreActions() --\x3e\r\n        <swx-button data-swx-testId="addParticipantAction" params="icon: \'contactAdd\', disabled: \'true\', cssClass: addParticipantsBtnClasses, textKey: \'button_text_addParticipants\', i18nTitle: buttonAddPeopleToConversationTitle"></swx-button>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: showMoreActions() --\x3e\r\n        <swx-more-actions-button class="moreActions" params="icon: \'more\', disabled: \'true\', cssClass: \'secondary circle stroke\', textKey: \'button_text_moreActions\'"></swx-more-actions-button>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/header",["require","exports","module","vendor/knockout","swx-constants","ui/viewModels/chat/header","jsviews/chat/header","utils/common/focusRestrictor","browser/dom","constants/components","text!views/chat/header.html"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-constants").COMMON.events,r=e("ui/viewModels/chat/header"),o=e("jsviews/chat/header"),a=e("utils/common/focusRestrictor"),s=e("browser/dom")
	t.name=e("constants/components").chat.HEADER,t.template=e("text!views/chat/header.html"),t.viewModel={createViewModel:function(e,c){var l=c.element,u=function(e){var t=s.getParentWithClass(e,"swxContent")
	return t?t.getAttribute("id"):null}(c.element),d=new o(l),p=a.build(l,[".Me",".toasts",".footer",".notifications","swx-sidebar"]),f=r.build(e,p,u)
	return f.setContext(n.dataFor(l)),f.init(d),f.dispatchEvent(i.navigation.COMPONENT_RENDERED,t.name,f.DIRECTION.PARENT),f}}})),define("ui/viewModels/chat/headerSingleConversation",["require","exports","module","lodash-compat","vendor/knockout","utils/common/cafeObservable","utils/common/eventMixin","swx-i18n","swx-service-locator-instance","swx-utils-common","swx-constants","swx-enums","browser/dom","utils/common/scroll","ui/telemetry/chat/guestActionsInHeader","ui/modelHelpers/personHelper","utils/common/outsideClickHandler"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("utils/common/cafeObservable"),o=e("utils/common/eventMixin"),a=e("swx-i18n").localization,s=e("swx-service-locator-instance").default,c=e("swx-utils-common").async,l=e("swx-constants").COMMON,u=e("swx-enums"),d=e("browser/dom"),p=e("utils/common/scroll"),f=e("ui/telemetry/chat/guestActionsInHeader"),m=e("ui/modelHelpers/personHelper"),h=e("utils/common/outsideClickHandler")
	function v(e,t){var o,v=e.conversationModel,g=this,y=null,b=s.resolve(l.serviceLocator.FEATURE_FLAGS),_=s.resolve(l.serviceLocator.PUBSUB),E=b.isFeatureOn(l.featureFlags.INCLUDE_SELF_IN_PARTICIPANTS_COUNT)
	function w(e){g.participantsCount(e+(E?1:0))}g.initializeParticipants=i.observable(!1),o=g.initializeParticipants.subscribe((function(e){y||!0!==e||c.execute((function(){(y=p.build(d.getElement(".js-SingleConversation-scrollContainer",t))).init()}),0)})),g.profileExpanded=i.observable(!1),g.participantsCount=i.observable(v.participantsCount()),v.participantsCount.changed(w),g.selfParticipant=v.selfParticipant,g.participants=r.newObservableCollection(v.participants),g.topic=i.computed((function(){return a.fetch({key:"conversation_header_topic_people_chatting",count:g.participantsCount()})})),g.dispose=function(){v.participantsCount.changed.off(w),g.topic.dispose(),o.dispose(),h.remove("conversationHeader"),y&&y.dispose()},g.getParticipantName=function(e){return e.person.displayName()},g.onScroll=n.debounce((function(e,t){_.publish(l.events.interaction.SCROLL_START,t)}),1e3,{leading:!0,trailing:!1}),g.toggleProfile=function(e){var t,n=g.profileExpanded()
	g.profileExpanded(!n),g.profileExpanded()?h.add("conversationHeader",g.toggleProfile):h.remove("conversationHeader"),(t={participantsCount:v.participants.length,userMessagesCount:v.historyService.activityItems().filter((function(e){return e.type()===u.activityType.TextMessage&&m.isMePerson(e.sender)})).length,totalMessagesCount:v.historyService.activityItems().length}).telemetryItem=e,t.profileExpanded=n,f.get().onProfileToggled(t),g.initializeParticipants(!0)},g.toggleProfileChevron=function(){g.toggleProfile(l.telemetry.guestActionsInHeader.telemetryItem[g.profileExpanded()?"CHEVRON_UP":"CHEVRON_DOWN"])}}n.assign(v.prototype,o),t.build=function(e,t){return new v(e,t)}})),define("text!views/chat/headerSingleConversation.html",[],(function(){return'<div class="headerWac squeeze">\r\n    <div class="roster squeeze">\r\n        <span class="tileName square">\r\n            <h3>\r\n                <span class="hoverWrap">\r\n                    <a role="button" data-swx-testId="conversationTopic" data-bind="text: topic, click: toggleProfile.bind(this, \'telemetryItemTopic\'), attr: {\'tabindex\': -1,\'title\': topic}"></a>\r\n                    <span class="iconfont" data-bind="css: {chevronUp: profileExpanded, chevronDown: !profileExpanded()}, click: toggleProfileChevron"></span>\r\n        </span>\r\n        </h3>\r\n        </span>\r\n    </div>\r\n    <div class="notificationsBell">\r\n        <swx-notifications-toggle-button></swx-notifications-toggle-button>\r\n    </div>\r\n</div>\r\n\x3c!-- ko if: initializeParticipants --\x3e\r\n<div class="chat-participants" data-bind="css: {show: profileExpanded}">\r\n    <div class="scrollingContainer js-SingleConversation-scrollContainer">\r\n        <div class="participants-list scrollViewport scrollViewportV">\r\n            <ul data-bind="event: {scroll: onScroll}">\r\n                <li>\r\n                    <span data-bind="text: getParticipantName(selfParticipant)">\r\n                </span>\r\n                </li>\r\n                \x3c!-- ko foreach: participants --\x3e\r\n                <li>\r\n                    <span data-bind="text: $parent.getParticipantName($data)">\r\n                </span>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>\r\n\x3c!-- /ko --\x3e'})),define("ui/components/chat/headerSingleConversation",["require","exports","module","vendor/knockout","ui/viewModels/chat/headerSingleConversation","constants/components","text!views/chat/headerSingleConversation.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/headerSingleConversation")
	t.name=e("constants/components").chat.HEADER_SINGLE_CONVERSATION,t.template=e("text!views/chat/headerSingleConversation.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e,t.element)
	return r.setContext(n.dataFor(t.element)),r}}})),define("ui/viewModels/chat/groupProfile",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-constants","swx-i18n","swx-enums","swx-service-locator-instance","swx-constants","ui/contextMenu/contextMenu","utils/common/cafeObservable","swx-utils-chat","ui/contextMenu/menuItem","utils/common/eventHelper","swx-pubsub-instance","utils/common/location","ui/modalDialog/leaveConversationDialog","ui/modalDialog/removeConversationHistoryDialog","ui/modelHelpers/personHelper","swx-cafe-application-instance"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-constants").COMMON.events,o=e("swx-i18n").localization,a=e("swx-enums"),s=e("swx-service-locator-instance").default,c=e("swx-constants").COMMON,l=e("ui/contextMenu/contextMenu"),u=e("utils/common/cafeObservable"),d=e("swx-utils-chat").spaceMail,p=e("ui/contextMenu/menuItem"),f=e("utils/common/eventHelper"),m=e("swx-pubsub-instance").default,h=e("utils/common/location"),v=e("ui/modalDialog/leaveConversationDialog"),g=e("ui/modalDialog/removeConversationHistoryDialog"),y=e("ui/modelHelpers/personHelper"),b=e("swx-cafe-application-instance")
	function _(e,i){var E=e.conversationModel,w=this,S=s.resolve(c.serviceLocator.FEATURE_FLAGS),x=S.isFeatureOn(c.featureFlags.SPACES),C=S.isFeatureOn(c.featureFlags.REMOVE_CONVERSATION_HISTORY),T=!S.isFeatureOn(c.featureFlags.DISABLE_LEAVE_CONVERSATION),I=S.isFeatureOn(c.featureFlags.GROUP_AVATAR_UPDATE_ENABLED)
	function A(e){w.lessParticipants(e<=4),w.participantCount(e),S.isFeatureOn(c.featureFlags.INCLUDE_SELF_IN_PARTICIPANTS_COUNT)&&w.participantCount(e+1)}var M=u.newObservableProperty(E.isJoiningEnabled.set.enabled)
	function O(e){return e+"_4b"}w.model=E,w.closeLabel=o.fetch({key:"header_text_close"}),w.avatar=u.newObservableProperty(E.avatarUrl),w.spaceLink=u.newObservableProperty(E.uri),w.participants=u.newObservableCollection(E.participants),w.canLeaveConversation=T?u.newObservableProperty(E.leave.enabled):n.observable(!1),w.canRemoveConversation=!y.isGuest(b.get().personsAndGroupsManager.mePerson)&&C&&E.historyService.removeAll?u.newObservableProperty(E.historyService.removeAll.enabled):n.observable(!1),w.mailtoLink=n.computed((function(){return d.createMailtoLink(E.topic(),w.spaceLink())})),w.role=u.newObservableProperty(E.selfParticipant.role),w.isAdmin=n.computed((function(){return w.role()===a.participantRole.Leader})),w.groupProfileHeading=n.computed((function(){return w.isAdmin()?o.fetch({key:"header_text_adminSettings"}):o.fetch({key:"header_text_groupSettings"})})),w.spacesLinkAriaLabel=n.computed((function(){return o.fetch({key:"groupProfile_spacesLink_ariaLabel",params:{spacesUrl:w.spaceLink()}})})),w.participantCount=n.observable(E.participantsCount()),w.lessParticipants=n.observable(!0),E.participantsCount.changed(A),w.joiningEnabled=n.observable(E.isJoiningEnabled()),E.isJoiningEnabled.changed(w.joiningEnabled),w.historyDisclosed=n.observable(E.historyService.isHistoryDisclosed()),E.historyService.isHistoryDisclosed.changed(w.historyDisclosed),w.historyToggleAriaLabel=n.computed((function(){var e=w.historyDisclosed()?"accessibility_groupProfile_historyToggle_on":"accessibility_groupProfile_historyToggle_off"
	return o.fetch({key:e})})),w.joiningToggleAriaLabel=n.computed((function(){var e=w.joiningEnabled()?"accessibility_groupProfile_joiningToggle_on":"accessibility_groupProfile_joiningToggle_off"
	return o.fetch({key:e})})),w.joiningEnabledVisible=n.computed((function(){return x&&w.isAdmin()&&M()})),w.spaceLinkVisible=n.computed((function(){return x&&w.joiningEnabled()&&w.spaceLink()})),w.historyDisclosedVisible=n.observable(!1),E.historyService.isHistoryDisclosed.set.enabled.changed(w.historyDisclosedVisible),w.showSettings=n.computed((function(){return Boolean(w.historyDisclosedVisible()&&w.isAdmin()||w.joiningEnabledVisible()||w.spaceLinkVisible())})),w.avatarUpdateEnabled=I,w.dispose=function(){E.isJoiningEnabled.changed.off(w.joiningEnabled),E.historyService.isHistoryDisclosed.changed.off(w.historyDisclosed),E.isJoiningEnabled.set.enabled.changed.off(w.joiningEnabledVisible),E.historyService.isHistoryDisclosed.set.enabled.changed.off(w.historyDisclosedVisible),E.participantsCount.changed.off(A),i.dispose(),w.mailtoLink.dispose(),w.isAdmin.dispose(),w.groupProfileHeading.dispose(),w.spacesLinkAriaLabel.dispose(),w.joiningEnabledVisible.dispose(),w.spaceLinkVisible.dispose(),w.showSettings.dispose(),w.historyToggleAriaLabel.dispose(),w.joiningToggleAriaLabel.dispose()},w.leaveConversation=function(){v.start(w.model,c.telemetry.leaveConversation.cta.PROFILE)},w.handleLeaveConversationKeyUp=function(e,t){f.isActivation(t)&&w.leaveConversation()}
	w.removeConversationText=function(){var e="recentItemMenuItem_text_remove"
	return S.isFeatureOn(c.featureFlags.USE_BUSINESS_WORDING)?o.fetch({key:O(e)}):o.fetch({key:e})},w.removeConversation=function(){g.start(w.model,c.telemetry.removeConversationHistory.cta.PROFILE)},w.handleRemoveConversationKeyUp=function(e,t){f.isActivation(t)&&w.removeConversation()},w.onHistoryDisclosedKeydown=function(e,t){var n=f.isActivation(t)
	return n&&w.historyDisclosedHandler(),!n},w.historyDisclosedHandler=function(){var e=w.historyDisclosed()
	E.historyService.isHistoryDisclosed.set(!e).catch((function(){}))},w.onJoiningEnabledKeydown=function(e,t){var n=f.isActivation(t)
	return n&&w.joiningEnabledHandler(),!n},w.joiningEnabledHandler=function(){var e=w.joiningEnabled()
	E.isJoiningEnabled.set(!e).catch((function(){}))},w.spaceMenuHandler=function(e,t){var n,i,r=[]
	n=new p(_.CopyLinkMenuItemType,o.fetch({key:"header_text_copyLink"})),r.push(n),i=new p(_.SendViaEmailMenuItemType,o.fetch({key:"header_text_inviteViaEmail"}),(function(){h.setHref(w.mailtoLink())})),r.push(i),l.show(r,t)},w.onScroll=t.debounce((function(e,t){m.publish(c.events.interaction.SCROLL_START,t)}),1e3,{leading:!0,trailing:!1}),w.init=function(){i.init(),w.forwardEvent(r.conversation.COPY_LINK,w.DIRECTION.PARENT),w.forwardEvent(r.conversation.EMAIL_LINK,w.DIRECTION.PARENT)}}return t.assign(_.prototype,i),_.CopyLinkMenuItemType="CopyLinkMenuItem",_.SendViaEmailMenuItemType="SendViaEmailMenuItemType",_})),define("text!views/chat/groupProfile.html",[],(function(){return'<div class="groupProfile fixSmall">\r\n    <div class="groupAvatarContainer">\r\n        <swx-avatar params="isGroupAvatar: true, size: 220, avatar: avatar"></swx-avatar>\r\n        \x3c!-- ko if: avatarUpdateEnabled --\x3e\r\n        <swx-avatar-file-picker class="Group-avatarFilePicker" params="conversationModel: model"></swx-avatar-file-picker>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    <div class="settings" data-bind=\'css: { lessParticipants: lessParticipants }\'>\r\n        \x3c!-- ko if: showSettings --\x3e\r\n        <h4 data-bind="text: groupProfileHeading" class="fontSize-p">Manage group</h4>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: canLeaveConversation --\x3e\r\n        <div class="settingItem fontSize-p">\r\n            <span>\r\n                <a href="#" role="button" data-bind="click: leaveConversation, l10n: {key: \'recentItemMenuItem_text_leave\'}"></a>\r\n            </span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: canRemoveConversation --\x3e\r\n        <div class="settingItem fontSize-p">\r\n            <span>\r\n                <a href="#" role="button" data-bind="click: removeConversation, l10n: {key: removeConversationText()}"></a>\r\n            </span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <swx-mute-conversation-setting-item params="conversationModel: model"></swx-mute-conversation-setting-item>\r\n\r\n        \x3c!-- ko if: historyDisclosedVisible() && isAdmin() --\x3e\r\n        <div class="settingItem">\r\n            <span id="makeHistoryAvailable" class="fontSize-h4" data-bind="l10n: {key: \'header_text_makeHistoryAvailable\'}"></span>\r\n            <button role="checkbox" aria-labelledby="makeHistoryAvailable" class="toggler" data-bind="event: { keydown: onHistoryDisclosedKeydown }, click: historyDisclosedHandler, css: { checked: historyDisclosed }, attr: { \'aria-checked\': historyDisclosed() ? \'true\' : \'false\', \'aria-label\': historyToggleAriaLabel }" type="button"><span class="on"></span><span class="off"></span></button>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: joiningEnabledVisible --\x3e\r\n        <div class="settingItem">\r\n            <span id="joinViaLink" class="fontSize-h4" data-bind="l10n: {key: \'header_text_joinViaLink\'}"></span>\r\n            <button role="checkbox" aria-labelledby="joinViaLink" class="toggler" data-bind="event: { keydown: onJoiningEnabledKeydown }, click: joiningEnabledHandler, css: { checked: joiningEnabled }, attr: { \'aria-checked\': joiningEnabled() ? \'true\' : \'false\', \'aria-label\': joiningToggleAriaLabel }" type="button"><span class="on"></span><span class="off"></span></button>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: spaceLinkVisible --\x3e\r\n        <div class="space settingItem">\r\n            <swx-invite-link class="invite-link" params="topic: model.topic, uri: model.uri">\r\n            </swx-invite-link>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: participantCount --\x3e\r\n    <div class="scrollingContainer participants" style="width:auto; overflow: hidden !important;" data-bind="keyboardNavigation: { itemSelector: \'a\' }">\r\n        <div role="list" id="groupParticipantsList" class="scrollViewport scrollViewportV" style="position: relative !important; max-height: 11em;" data-bind="event: { scroll: onScroll }, css: { lessParticipants: lessParticipants }, foreach: participants" tabindex="-1">\r\n            <swx-contact-card params="participant: $data, model: $parent.model" class="participant"></swx-contact-card>\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/groupProfile",["require","exports","module","browser/dom","utils/common/scroll","ui/viewModels/chat/groupProfile","vendor/knockout","constants/components","text!views/chat/groupProfile.html"],(function(e,t){var n=e("browser/dom"),i=e("utils/common/scroll"),r=e("ui/viewModels/chat/groupProfile"),o=e("vendor/knockout")
	t.name=e("constants/components").chat.GROUP_PROFILE,t.template=e("text!views/chat/groupProfile.html"),t.viewModel={createViewModel:function(e,t){var a=n.getElement(".scrollingContainer",t.element),s=i.build(a),c=o.dataFor(t.element),l=new r(e,s)
	return l.setContext(c),l.init(),l}}})),define("ui/viewModels/chat/isTypingIndicator",["require","vendor/knockout","swx-constants","swx-utils-common","lodash-compat","swx-i18n","swx-service-locator-instance","swx-utils-people","utils/common/accessibility"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-utils-common").array,r=e("lodash-compat"),o=n.isTyping,a=e("swx-i18n").localization,s=e("swx-service-locator-instance").default,c=e("swx-utils-people").personPropertyFormatter,l=e("utils/common/accessibility").narrator
	return function(e){var u,d,p=this,f=e.participants,m=[],h=s.resolve(n.serviceLocator.FEATURE_FLAGS)
	function v(){var e,t=[],n=0
	function i(e){return c.truncateDisplayName(e.displayName())}switch(m.forEach((function(e){t.length<o.DETAILED_PARTICIPANTS_MAX_COUNT?t.push(e.person):n++})),e=t.length+n,p.typingParticipantsCount(e),e){case 0:return""
	case 1:var r=a.fetch({key:"typingIndicator_label_oneParticipant",params:{firstParticipantName:i(t[0])}})
	return p.avatar(t[0].avatarUrl()),p.displayName(t[0].displayName()),l.announce(r),r
	case 2:var s=a.fetch({key:"typingIndicator_label_twoParticipants",params:{firstParticipantName:i(t[0]),secondParticipantName:i(t[1])}})
	return p.displayName(null),p.avatar(null),l.announce(s),s
	default:var u=a.fetch({key:"typingIndicator_label_multipleParticipants",params:{firstParticipantName:i(t[0]),secondParticipantName:i(t[1])},count:n})
	return p.displayName(null),p.avatar(null),l.announce(u),u}}function g(e,t){t?m.push(e):m=r.without(m,e),p.isTypingLabel(v())}function y(e){e.__isTypingSubscription&&(e.__isTypingSubscription.dispose(),delete e.__isTypingSubscription)}this.avatar=t.observable(""),this.displayName=t.observable(""),this.typingParticipantsCount=t.observable(0),this.isTypingLabel=t.observable(""),this.isFeatureOn=h.isFeatureOn(n.featureFlags.IS_TYPING_INDICATOR),u=f.added((function(e){e.__isTypingSubscription=e.chat.isTyping.changed(g.bind(null,e))})),d=f.removed((function(e){var t=r.indexOf(m,e)
	t>-1&&(i.removeFrom(m,t),p.isTypingLabel(v())),y(e)})),this.dispose=function(){u.dispose(),d.dispose(),f.each(y)}}})),define("text!views/chat/isTypingIndicator.html",[],(function(){return'<div class="typing" data-bind="css: { active: typingParticipantsCount() > 0 }">\r\n    \x3c!-- ko if: isFeatureOn --\x3e\r\n        <div class="grid margin">\r\n            <div class="indicator">\r\n                <swx-avatar params="avatar: avatar, displayName: displayName, useAbsolutePosition: true"></swx-avatar>\r\n                <span class="text">\r\n                    <p class="small" data-bind="html: isTypingLabel"></p>\r\n                </span>\r\n            </div>\r\n        </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/isTypingIndicator",["require","exports","module","constants/components","ui/viewModels/chat/isTypingIndicator","text!views/chat/isTypingIndicator.html"],(function(e,t){t.name=e("constants/components").chat.TYPING_INDICATOR,t.viewModel=e("ui/viewModels/chat/isTypingIndicator"),t.template=e("text!views/chat/isTypingIndicator.html")})),define("text!views/chat/timeline/currentCall.html",[],(function(){return'<a data-bind="event: { click: model.handleClick, contextmenu: model.showContextMenu }, css: {read: model.isRead(), unread: !model.isRead(), \'active themeBlue\': model.isActive(), group: model.isGroupConversation, joinCall: model.canJoinCall}" class="recent">\r\n\r\n    <swx-avatar params="isGroupAvatar: model.isGroupConversation, avatar: model.avatarUrl, displayName: model.displayName, isPstn: model.isPstn"></swx-avatar>\r\n\r\n    <div class="text">\r\n        <span class="tile">\r\n            <span class="tileName">\r\n                \x3c!-- ANTONMAG: Do not change it to HTML Binding! --\x3e\r\n                <h4 data-bind="text: model.topic"></h4>\r\n            </span>\r\n        </span>\r\n\r\n        <div class="message callduration">\r\n            <p data-bind="text: model.callDuration, css:{\'iconfont callStart\': model.callDuration() === \'\'}">00:00</p>\r\n        </div>\r\n    </div>\r\n\r\n    \x3c!-- ko ifnot: model.isRead --\x3e\r\n    <swx-unread-message-counter params="model:model"></swx-unread-message-counter>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <span class="controls">\r\n        <swx-current-call-actions params="conversationModel:model.conversation"></swx-current-call-actions>\r\n    </span>\r\n</a>\r\n'})),define("ui/components/chat/currentCall",["require","exports","module","constants/components","text!views/chat/timeline/currentCall.html"],(function(e,t){t.name=e("constants/components").chat.CURRENT_CALL,t.template=e("text!views/chat/timeline/currentCall.html")})),define("text!views/chat/unreadMessageCounter.html",[],(function(){return'<span class="counter"  data-bind="css: {complexNotification: model.unreadActivityItemsWithKeywordsCount() && model.unreadActivityItemsCount()}">\r\n    \x3c!-- ko if: model.unreadActivityItemsCount()--\x3e\r\n    <span class="circle" data-bind="css: {lightNotification: !model.notificationEnabled()}">\r\n        <p class="fontSize-h4" data-bind="text: model.unreadActivityItemsCount(), css: {light: !model.notificationEnabled()}">1</p>\r\n    </span>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: model.unreadActivityItemsWithKeywordsCount()--\x3e\r\n    <span class="circle with-keywords">\r\n        <p class="fontSize-h4" data-bind="text: model.unreadActivityItemsWithKeywordsCount">1</p>\r\n    </span>\r\n    \x3c!-- /ko --\x3e\r\n</span>\r\n'})),define("ui/components/chat/unreadMessageCounter",["require","exports","module","constants/components","text!views/chat/unreadMessageCounter.html"],(function(e,t){t.name=e("constants/components").chat.UNREAD_MESSAGE_COUNTER,t.template=e("text!views/chat/unreadMessageCounter.html")})),define("ui/viewModels/chat/currentCallActions",["require","lodash-compat","utils/common/cafeObservable","utils/common/eventMixin","ui/viewModels/chat/conversationActivity"],(function(e){var t=e("lodash-compat"),n=e("utils/common/cafeObservable"),i=e("utils/common/eventMixin"),r=e("ui/viewModels/chat/conversationActivity")
	function o(e){var t,i=this,o=e.conversationModel
	t=r.build(o),i.conversation=o,i.isOnCall=t.isOnCall,i.canJoinCall=t.canJoinCall,i.canJoinWithVideo=n.newObservableProperty(o.videoService.start.enabled),i.dispose=function(){i.canJoinWithVideo.dispose(),t.dispose()}}return t.assign(o.prototype,i),o})),define("text!views/chat/timeline/currentCallActions.html",[],(function(){return"\x3c!-- ko if: canJoinCall --\x3e\r\n    <swx-joincall-button params=\"visible: canJoinWithVideo, cssClass:'btn small primary green circle', conversationModel:conversation, showIcon:true, withVideo: true\"></swx-joincall-button>\r\n    <swx-joincall-button params=\"cssClass:'btn small primary green circle', conversationModel:conversation, showIcon:true\"></swx-joincall-button>\r\n\x3c!-- /ko --\x3e\r\n\r\n\x3c!-- ko if: isOnCall --\x3e\r\n    \x3c!-- ko control: { name: 'muteControl', model: { conversation: conversation, isInCallScreen: false } } --\x3e \x3c!-- /ko --\x3e\r\n    \x3c!-- ko control: { name: 'endCallControl', model: { conversation: conversation, isInCallScreen: false } } --\x3e \x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n"})),define("ui/components/chat/currentCallActions",["require","exports","module","vendor/knockout","ui/viewModels/chat/currentCallActions","constants/components","text!views/chat/timeline/currentCallActions.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/currentCallActions")
	t.name=e("constants/components").chat.CURRENT_CALL_ACTIONS,t.template=e("text!views/chat/timeline/currentCallActions.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e)
	return r.setContext(n.dataFor(t.element)),r}}})),define("text!views/chat/timeline/recentItem.html",[],(function(){return'<a href="#" data-bind="event: { click: model.handleClick, contextmenu: model.showContextMenu }, attr: { \'role\': model.ariaRole }, css: model.cssClass" class="recent unread Avatar-whiteThemeHover" tabindex="-1">\r\n    <span role="log" class="offScreen" data-bind="text:model.ariaLabel"></span>\r\n    <swx-avatar params="isGroupAvatar: model.isGroupConversation, isAgent: model.isAgent, avatar: model.avatarUrl, status: model.statusClassName, isPstn: model.isPstn, displayName: model.displayName, isSelected: model.isActive"\r\n        class="avatar Avatar--whiteTheme"></swx-avatar>\r\n    <div class="text">\r\n        <span class="arrow"></span>\r\n        <span class="tile" aria-hidden="true">\r\n            <span class="tileName">\r\n                <h4>\r\n                    \x3c!-- ANTONMAG: Do not change it to HTML Binding! --\x3e\r\n                    <span class="topic" data-bind="text: model.topic, attr: {title: model.topic}"></span>\r\n                    \x3c!-- ko if: model.isCertifiedAgent --\x3e\r\n                    <span class="iconfont avatarBotCertified"></span>\r\n                    \x3c!-- /ko --\x3e\r\n                </h4>\r\n            </span>\r\n        </span>\r\n\r\n        \x3c!-- ko if: model.isRead --\x3e\r\n        <span class="tile">\r\n            <span class="tileMessage circle">\r\n                \x3c!-- ko if: model.displayMessage() --\x3e\r\n                <div class="message">\r\n                    <p data-bind="html: model.displayMessage" tabindex="-1"></p>\r\n                </div>\r\n                \x3c!-- /ko --\x3e\r\n            </span>\r\n        </span>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: model.displayNotificationsDisabledIndicator() --\x3e\r\n        <div class="notificationsDisabledIndicator" aria-hidden="true">\r\n            <span class="iconfont"></span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: model.displayUnseenHeartsIcon() || !model.isRead() --\x3e\r\n        <div class="unseenNotifications" aria-hidden="true">\r\n            \x3c!-- ko if: model.displayUnseenHeartsIcon --\x3e\r\n            <span class="circleHeart">\r\n                <span class="iconfont heart"></span>\r\n            </span>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko ifnot: model.isRead --\x3e\r\n            <swx-unread-message-counter params="model:model"></swx-unread-message-counter>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko ifnot: model.isRead --\x3e\r\n        <div class="message" aria-hidden="true">\r\n            <p data-bind="html: model.content" class="small" tabindex="-1"></p>\r\n\r\n            \x3c!-- ko if: model.isLiveSession --\x3e\r\n            <div class="callAction">\r\n                <div class="iconfont" data-bind="css: model.callAction"></div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: model.isInfoMessage --\x3e\r\n            <div class="infoMessage">\r\n                <div class="iconfont" data-bind="css: model.infoType"></div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</a>\r\n'})),define("ui/components/chat/recentItem",["require","exports","module","constants/components","text!views/chat/timeline/recentItem.html"],(function(e,t){t.name=e("constants/components").chat.RECENT_ITEM,t.template=e("text!views/chat/timeline/recentItem.html")})),define("utils/common/cancelation",["require","exports","module","lodash-compat"],(function(e,t){var n=e("lodash-compat")
	function i(){}function r(){Error.call(this,"Operation canceled")}r.prototype=Error.prototype,i.prototype.getToken=function(){var e,t=this
	return this.token=this.token||(e=new Promise((function(e,n){t.rejectTokenFn=n})),Object.defineProperty(e,"isCanceled",{get:function(){return t.isCanceled}}),e.throwIfCanceled=function(){if(t.isCanceled)throw new r},t.isCanceled=!1,e),this.token},i.prototype.cancel=function(e){e=e||new r,this.isCanceled=!0,this.rejectTokenFn(e)},t.makeCancelablePromise=function(e,t){return Promise.race([Promise.resolve(e),t])},t.makeCancelable=function(e,i){return i&&e&&n.isObject(e)?n.isFunction(e.makeCancelable)?e.makeCancelable(i):n.isFunction(e.then)?t.makeCancelablePromise(e,i):void 0:Promise.resolve(e)},t.adaptAbortable=function(e){return e&&n.isObject(e)&&n.isFunction(e.abort)?(e.makeCancelable=function(e){var t,n=this
	return e.catch((function(e){t=e,n.abort()})),Promise.resolve(this).catch((function(n){if(e.isCanceled)throw t.innerException=n,t
	throw n}))},e):e},t.cancelableOperation=function(){return new i},t.OperationCanceledError=r})),define("utils/common/interactor",["require","exports","module","lodash-compat"],(function(e,t){var n=e("lodash-compat")
	function i(){this.definition={before:[],after:[],around:[],run:null,rollback:null}}function r(e){this._definition=e}function o(e){return e instanceof r?function(){Function.prototype.apply.call(e.run,e,arguments)}:e}function a(e){return e instanceof r?e:t.defineSimpleInteractor(e)}function s(){}function c(e){if(!e.success)throw new s}function l(e,t){e.rollback&&Function.prototype.apply.call(e.rollback,t,[t.context].concat(t.arguments))}function u(e,t){(function(e,t){n.forEach(e.before,(function(e){Function.prototype.apply.call(e,t,[t.context].concat(t.arguments)),c(t.context)}))})(e,t),function(e,t){(function n(i){c(t.context),i<e.around.length?Function.prototype.apply.call(e.around[i],t,[t.context,n.bind(null,i+1)].concat(t.arguments)):Function.prototype.apply.call(e.run,t,[t.context].concat(t.arguments)),c(t.context)})(0)}(e,t),function(e,t){n.forEachRight(e.after,(function(e){Function.prototype.apply.call(e,t,[t.context].concat(t.arguments)),c(t.context)}))}(e,t)}function d(e){var t=n.map(e,a),i={before:[],after:[],around:[],run:function(){var e=this,n=0
	try{for(;n<t.length;)u(t[n]._definition,e),n++}catch(i){for(i instanceof s||e.context.fail(i),n--;n>=0;)l(t[n]._definition,e),n--
	throw i}},rollback:function(){var e=0
	for(e=t.length-1;e>=0;)l(t[e]._definition,this),e--}}
	r.call(this,i)}function p(e){var t
	e&&(e.run&&this.run(e.run),e.before&&(t=n.isArray(e.before)?e.before:[e.before],n.forEach(t,(function(e){this.before(e)}),this)),e.after&&(t=n.isArray(e.after)?e.after:[e.after],n.forEach(t,(function(e){this.after(e)}),this)),e.onlyIf&&(t=n.isArray(e.onlyIf)?e.onlyIf:[e.onlyIf],n.forEach(t,(function(e){this.onlyIf(e)}),this)),e.around&&(t=n.isArray(e.around)?e.around:[e.around],n.forEach(t,(function(e){this.around(e)}),this)),e.rollback&&this.rollback(e.rollback))}i.prototype={run:function(e){this.definition.run=o(e)},before:function(e){this.definition.before.push(o(e))},after:function(e){this.definition.after.push(o(e))},around:function(e){this.definition.around.push(o(e))},onlyIf:function(e){var t=e
	n.isFunction(e)||(t=function(){return e}),this.around((function(e,n){t()&&n()}))},rollback:function(e){this.definition.rollback=o(e)}},r.prototype.run=function(){var e,t=Array.prototype.slice.call(arguments),n={context:(e=t[0]||{},e.hasOwnProperty("success")||Object.defineProperties(e,{failure:{value:!1,writable:!0,enumerable:!1},success:{value:!0,writable:!0,enumerable:!1},error:{value:null,writable:!0,enumerable:!1},fail:{value:function(e){this.failure=!0,this.success=!1,this.error=e},writable:!0,enumerable:!1}}),e),arguments:t.slice(1)},i=this._definition
	try{u(i,n)}catch(r){!r instanceof s&&n.context.fail(r)}return n.context},d.prototype=Object.create(r.prototype),t.defineInteractor=function(e){var t=new i,o=e
	return n.isFunction(e)||(o=function(){p.call(this,e)}),o.call(t,t.run.bind(t),t.before.bind(t),t.after.bind(t),t.around.bind(t),t.rollback.bind(t)),new r(t.definition)},t.defineSimpleInteractor=function(e){return t.defineInteractor({run:e})},t.defineComposer=function(e){return new d(e)}})),define("services/pes/interactors/bing",["require","exports","module","lodash-compat","swx-i18n","utils/common/interactor","experience/settings","services/pes/constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-i18n").localization,r=e("utils/common/interactor"),o=e("experience/settings"),a=e("services/pes/constants")
	t.computeAspectRatios=r.defineSimpleInteractor((function(e){var t=e.items||[]
	n.forEach(t,(function(e){e.aspectRatio=e.width/e.height}))})),t.computeGridLayoutSizes=r.defineInteractor((function(e){function t(e,t){var n,i,r=[]
	for(n=0;n<e;n+=1){var o=[]
	for(i=0;i<t;i+=1)o.push(0)
	r.push(o)}return r}e((function(e,i,r,o,a){i=i||6,r=r||100,o=o||100,a=a||0
	var s=e.items||[],c=o/i,l=s.reduce((function(e,t){return e+t.aspectRatio*c}),0),u=Math.round(l/r)||1,d=function(e,i){var r,o,a,s,c,l,u,d,p
	if(c=e.length,i<=0)return[]
	if(i>c)return e.map((function(e){return[e]}))
	for(u=t(c,i),l=t(c-1,i-1),o=0;o<c;o+=1)u[o][0]=e[o]+(o?u[o-1][0]:0)
	for(a=0;a<i;a+=1)u[0][a]=e[0]
	for(o=1;o<c;o+=1)for(a=1;a<i;a+=1){for(p=[],d=0;d<o;d+=1)p.push([n.max([u[d][a-1],u[o][0]-u[d][0]]),d])
	s=n.min(p,(function(e){return e[0]})),u[o][a]=s[0],l[o-1][a-1]=s[1]}for(c-=1,i-=2,r=[];i>=0;)r=[function(){var t,n,r,a
	for(a=[],o=t=n=l[c-1][i]+1,r=c+1;n<=r?t<r:t>r;o=n<=r?++t:--t)a.push(e[o])
	return a}()].concat(r),c=l[c-1][i],i-=1
	return[function(){var t,n,i
	for(i=[],o=t=0,n=c+1;0<=n?t<n:t>n;o=0<=n?++t:--t)i.push(e[o])
	return i}()].concat(r)}(s.map((function(e){return 100*e.aspectRatio})),u),p=0
	n.forEach(d,(function(e){var t=[],i=r-a*e.length
	n.forEach(e,(function(){t.push(s[p]),p+=1}))
	var o=t.reduce((function(e,t){return e+t.aspectRatio}),0)
	n.forEach(t,(function(e){e.scaledWidth=parseInt(i/o*e.aspectRatio),e.scaledHeight=parseInt(i/o)}))}))}))})),t.collectItemsToPack=r.defineSimpleInteractor((function(e){var t=e.items||[],n={ariaLabel:i.fetch({key:e.packAriaLabelKey}),title:i.fetch({key:e.packTitleKey}),id:e.packID,isHidden:!1,items:[]}
	n.items=n.items.concat(t),e.pack=n})),t.assignImageItemProperties=r.defineSimpleInteractor((function(e){var t=e.items||[],i=e.sizingUnit||"em"
	n.forEach(t,(function(e){e.thumbnail=e.thumbnail.replace("http:","https:"),e.staticThumbnail=e.thumbnail,e.type="image",e.thumbnailStyle="width: "+e.scaledWidth+i+"; height: "+e.scaledHeight+i+";",["aspectRatio","height","scaledHeight","scaledWidth","width"].forEach((function(t){e.hasOwnProperty(t)&&delete e[t]}))}))})),t.createBingPacks=r.defineSimpleInteractor((function(e){var i,o,s,c,l=r.defineComposer([t.computeAspectRatios,function(e){t.computeGridLayoutSizes.run(e,6,99,200)},t.assignImageItemProperties,t.collectItemsToPack])
	e.packs=[],e.items=[],e.featureGifsFirst?(i=e.gifResults,o=e.memeResults):(i=e.memeResults,o=e.gifResults),e.featureCombine?(s=n.compact(n.flatten(n.flatten(n.zip(i,o)))),(c=l.run(n.assign({items:s,packTitleKey:"expressionPicker_bingPack_title",packAriaLabelKey:"expressionPicker_bingPack_ariaLabel",packID:a.bingSearch.PACK_PREFIX+"items"},n.pick(e,["desiredRows","idealWidth","availableHeight","lossToPadding"])))).pack&&(e.packs.push(c.pack),e.items=e.items.concat(c.items))):((c=l.run(n.assign({items:i,packTitleKey:e.featureGifsFirst?"expressionPicker_bingGifsPack_title":"expressionPicker_bingMemePack_title",packAriaLabelKey:e.featureGifsFirst?"expressionPicker_bingGifsPack_ariaLabel":"expressionPicker_bingMemePack_ariaLabel",packID:a.bingSearch.PACK_PREFIX+(e.featureGifsFirst?"gifs":"memes")},n.pick(e,["desiredRows","idealWidth","availableHeight","lossToPadding"])))).pack&&(e.packs.push(c.pack),e.items=e.items.concat(c.items)),(c=l.run(n.assign({items:o,packTitleKey:e.featureGifsFirst?"expressionPicker_bingMemePack_title":"expressionPicker_bingGifsPack_title",packAriaLabelKey:e.featureGifsFirst?"expressionPicker_bingMemePack_ariaLabel":"expressionPicker_bingGifsPack_ariaLabel",packID:a.bingSearch.PACK_PREFIX+(e.featureGifsFirst?"memes":"gifs")},n.pick(e,["desiredRows","idealWidth","availableHeight","lossToPadding"])))).pack&&(e.packs.push(c.pack),e.items=e.items.concat(c.items)))})),t.putBingTab=r.defineSimpleInteractor((function(e){var t={id:a.bingSearch.TAB_ID,type:a.itemTypes.tab.id,title:i.fetch({key:"expressionPicker_bingTab_title"}),ariaLabel:i.fetch({key:"expressionPicker_bingTab_ariaLabel"}),emptyTabMessageKey:"expressionPicker_bingTab_emptyText",thumbnailUrl:o.appBaseUrl+"/assets/images/components/chat/pes/tab_bing.png",styleOverride:"large-tab",packs:[]}
	n.remove(e.tabs,{id:a.bingSearch.TAB_ID}),e.tabs.push(t)})),t.setBingTabProperties=r.defineSimpleInteractor((function(e){e.selectedTab&&e.selectedTab.id===a.bingSearch.TAB_ID&&(e.pickerMaximized=!0,e.searchCapabilityEnabled=!0)}))}))
	define("services/pes/interactors/giphy",["require","exports","module","lodash-compat","swx-i18n","utils/common/interactor","services/pes/interactors/bing","experience/settings","services/pes/constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-i18n").localization,r=e("utils/common/interactor"),o=e("services/pes/interactors/bing"),a=e("experience/settings"),s=e("services/pes/constants")
	t.putGiphyTab=r.defineSimpleInteractor((function(e){var t={id:s.giphyImageSearch.TAB_ID,type:s.itemTypes.tab.id,title:i.fetch({key:"expressionPicker_giphyImgTab_title"}),ariaLabel:i.fetch({key:"expressionPicker_giphyImgTab_ariaLabel"}),emptyTabMessageKey:"expressionPicker_giphyImgTab_emptyText",thumbnailUrl:a.appBaseUrl+"/assets/images/components/chat/pes/tab_giphy.png",styleOverride:"large-tab",packs:[]}
	n.remove(e.tabs,{id:s.giphyImageSearch.TAB_ID}),e.tabs.push(t)})),t.setGiphyTabProperties=r.defineSimpleInteractor((function(e){e.selectedTab&&e.selectedTab.id===s.giphyImageSearch.TAB_ID&&(e.pickerMaximized=!0,e.searchCapabilityEnabled=!0)})),t.mapGiphyAPIResults=r.defineSimpleInteractor((function(e){e.items=n.map(e.data,(function(e){return{querySource:e.querySource,width:e.images.downsized.width,height:e.images.downsized.height,thumbnail:e.images.downsized.url,id:e.id,url:e.images.original.url}}))})),t.createGiphyPacks=r.defineSimpleInteractor((function(e){var i=r.defineComposer([t.mapGiphyAPIResults,o.computeAspectRatios,function(e){o.computeGridLayoutSizes.run(e,6,99,200)},o.assignImageItemProperties,o.collectItemsToPack])
	e.packs=[],e.items=[]
	var a=i.run(n.assign({data:e.data,packTitleKey:"expressionPicker_giphyImgPack_title",packAriaLabelKey:"expressionPicker_giphyImgPack_ariaLabel",packID:s.giphyImageSearch.PACK_PREFIX+"items"},n.pick(e,["desiredRows","idealWidth","availableHeight","lossToPadding"])))
	a.pack&&(e.packs.push(a.pack),e.items=e.items.concat(a.items))}))})),define("utils/common/url",["require","exports","module","lodash-compat"],(function(e,t){var n=e("lodash-compat")
	t.buildUrl=function(e,t){return e+n.reduce(n.pairs(t||{}),(function(e,t){return e?e+="&":e="?",n.isUndefined(t[1])||null===t[1]?e+=encodeURIComponent(t[0]):e=e+encodeURIComponent(t[0])+"="+encodeURIComponent(t[1]),e}),"")}})),define("utils/chat/pesUtils",["require","lodash-compat","swx-constants","services/pes/constants","swx-service-locator-instance","experience/settings","utils/common/url"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("services/pes/constants"),r=e("swx-service-locator-instance").default,o=e("experience/settings"),a=e("utils/common/url")
	return new function(){var e=this,s={small:"getSmall",large:"getLarge",extraLarge:"getExtraLarge"},c=l
	function l(t){var i=r.resolve(n.serviceLocator.FEATURE_FLAGS)
	return c=i.isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)?function(t){return e.rewriteUrls(t,o.pesCDNAuthentication.rewriteRules)}:function(e){return e},c(t)}this.buildEmoticonUrl=function(e,t,n,r){var o=e+"/"+t.id+"/views/"
	o=c(o)
	var l=s[n]+(r?"Animated":"")
	return a.buildUrl(o+i.profiles.emoticons[l](),{etag:t.etag})},this.rewriteUrls=function(e,n){if("string"!=typeof e)return e
	var i=e
	return t.any(n,(function(e){return-1!==i.search(e.from)&&(i=i.replace(e.from,e.to),!0)})),i},this._resetUrlRewriterSetup=function(){c=l}}})),define("services/pes/interactors/cloud",["require","exports","module","lodash-compat","swx-constants","utils/common/interactor","services/pes/constants","ui/modelHelpers/personHelper","utils/chat/pesUtils","swx-service-locator-instance","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("utils/common/interactor"),o=e("services/pes/constants"),a=e("ui/modelHelpers/personHelper"),s=e("utils/chat/pesUtils"),c=e("swx-service-locator-instance").default,l=e("experience/settings")
	t.pesGetConfig=r.defineSimpleInteractor((function(e){var t=c.resolve(i.serviceLocator.PES_CONFIG_SERVICE)
	n.assign(e,n.cloneDeep(t.getConfiguration()))})),t.pesDecorateTabs=r.defineSimpleInteractor((function(e){var t={emptyTabMessageKey:"expressionPicker_tab_emptyText"}
	e.tabs.forEach((function(e){n.defaults(e,t)}))})),t.pesHideMojis=r.defineSimpleInteractor((function(e){var t=e.conversationModel
	if(t&&t.participants().length){var i=t.participants(0).person,r=a.isAgent(i),s=!!i&&!!i.capabilities._mojiSend&&i.capabilities._mojiSend()
	t.isGroupConversation()||!r||s||n.forEach(e.items,(function(e){e.type===o.itemTypes.moji.id&&(e.visible=!1)}))}})),t.pesRemoveHiddenItems=r.defineSimpleInteractor((function(e){n(e.tabs).map("packs").flatten().forEach((function(e){e.items=n.reject(e.items,{visible:!1})})).value()})),t.pesDecorateEmoticons=r.defineSimpleInteractor((function(e){e.items.forEach((function(e){e.type===o.itemTypes.emoticon.id&&(e.staticHtmlClass=e.id,e.staticExtraLargeHtmlClass=e.staticHtmlClass+" extraLarge",e.animatedExtraLargeHtmlClass=e.staticExtraLargeHtmlClass+" animated",e.shortcut=n.first(e.shortcuts)||"",["etag","facebook","keywords","media","shortcuts","useInSms","visible"].forEach((function(t){e.hasOwnProperty(t)&&delete e[t]})))}))})),t.pesDecorateMojis=r.defineSimpleInteractor((function(e){e.items.forEach((function(t){t.type===o.itemTypes.moji.id&&(t.mojiId=e.itemsRoot+"/"+t.id,t.thumbnailClass="id_"+t.id+" thumbnail",t.keyframeClass="id_"+t.id+" keyframe",t.contentUrl=e.itemsRoot+"/"+t.id+"/views/"+o.profiles.moji.content,e._requiresCDNUrlAuthentication&&(t.contentUrl+="?"+e._cdnToken),["etag","auxiliaryUrl","isSponsored","keywords"].forEach((function(e){t.hasOwnProperty(e)&&delete t[e]})))}))})),t.pesRewriteMojiPaths=r.defineSimpleInteractor((function(e){c.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.PES_CDN_AUTH_ENABLED)&&e.items.forEach((function(e){e.type===o.itemTypes.moji.id&&(e.contentUrl=s.rewriteUrls(e.contentUrl,l.pesCDNAuthentication.rewriteRules))}))})),t.pesConfigPipeline=r.defineComposer([t.pesGetConfig,t.pesHideMojis,t.pesRemoveHiddenItems,t.pesDecorateTabs,t.pesDecorateEmoticons,t.pesDecorateMojis,t.pesRewriteMojiPaths]),t.putPesTabs=r.defineSimpleInteractor((function(e){var n=t.pesConfigPipeline.run({conversationModel:e.conversationModel})
	e.tabs=e.tabs.concat(n.tabs),e._configuredItems=e._configuredItems.concat(n.items)}))})),define("services/pes/interactors/mru",["require","exports","module","lodash-compat","swx-constants","swx-i18n","utils/common/interactor","services/pes/constants","swx-service-locator-instance","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("swx-i18n").localization,o=e("utils/common/interactor"),a=e("services/pes/constants"),s=e("swx-service-locator-instance").default,c=e("experience/settings")
	t.createMRUTab=o.defineInteractor((function(e){function t(e){return a.mru.PACK_PREFIX+e}function o(e){return{ariaLabel:r.fetch({key:a.itemTypes[e].ariaLabelLocKey}),title:r.fetch({key:a.itemTypes[e].titleLocKey}),id:t(e),isHidden:!1,items:[]}}e((function(e){var l=s.resolve(i.serviceLocator.PES_MRU_SERVICE).getMRUItems(),u={id:a.mru.TAB_ID,type:a.itemTypes.tab.id,title:r.fetch({key:a.itemTypes.tab.titleLocKey}),ariaLabel:r.fetch({key:a.itemTypes.tab.ariaLabelLocKey}),emptyTabMessageKey:"expressionPicker_mruTab_emptyText",thumbnailUrl:c.appBaseUrl+"/assets/images/components/chat/pes/tab_mru.png",packs:[]},d=[o(a.itemTypes.emoticon.id),o(a.itemTypes.moji.id)]
	n.forEach(l,(function(i){var r=n.find(d,{id:t(i.type)}),o=n.find(e._configuredItems,{id:i.id})
	o&&r.items.push(o)})),u.packs=n.reject(d,(function(e){return 0===e.items.length})),e.mruTab=u}))})),t.putMRUTab=o.defineSimpleInteractor((function(e){var i=t.createMRUTab.run(n.pick(e,"_configuredItems"))
	n.remove(e.tabs,{id:a.mru.TAB_ID}),e.tabs.unshift(i.mruTab)}))})),define("services/pes/interactors/localSearch",["require","exports","module","lodash-compat","swx-i18n","utils/common/interactor","experience/settings","services/pes/constants"],(function(e,t){var n=e("lodash-compat"),i=e("swx-i18n").localization,r=e("utils/common/interactor"),o=e("experience/settings"),a=e("services/pes/constants")
	t.putLocalSearchTab=r.defineSimpleInteractor((function(e){var t={id:a.localSearch.TAB_ID,type:a.itemTypes.tab.id,title:i.fetch({key:"expressionPicker_localSearchTab_title"}),ariaLabel:i.fetch({key:"expressionPicker_localSearchTab_title"}),emptyTabMessageKey:"expressionPicker_localSearchTab_emptyText",thumbnailUrl:o.appBaseUrl+"/assets/images/components/chat/pes/tab_search.png",styleOverride:"",packs:[]}
	e.tabs=e.tabs||[],n.remove(e.tabs,{id:a.localSearch.TAB_ID}),e.tabs.push(t)})),t.setLocalSearchTabProperties=r.defineSimpleInteractor((function(e){e.selectedTab&&e.selectedTab.id===a.localSearch.TAB_ID&&(e.searchCapabilityEnabled=!0)})),t.groupByType=r.defineSimpleInteractor((function(e){var t=n(["emoticon","flik"]).reduce((function(e,t){return e[t]={ariaLabel:i.fetch({key:a.itemTypes[t].ariaLabelLocKey}),title:i.fetch({key:a.itemTypes[t].titleLocKey}),id:a.localSearch.PACK_PREFIX+a.itemTypes[t].id,items:[]},e}),{})
	n(e.packs).pluck("items").flatten().reduce((function(e,t){return t.type in e&&e[t.type].items.push(t),e}),t),e.packs=n(t).map((function(e){return e})).value(),n.forEach(e.packs,(function(e){0===e.items.length&&e.items.push({id:"",type:a.itemTypes.message.id,htmlClass:"",text:i.fetch({key:"message_text_emptySearchResults"})})}))}))})),define("services/pes/interactors/picker",["require","exports","module","lodash-compat","services/pes/interactors/bing","services/pes/interactors/giphy","services/pes/interactors/cloud","swx-constants","experience/settings","utils/common/interactor","services/pes/interactors/mru","services/pes/interactors/localSearch","services/pes/constants","swx-service-locator-instance"],(function(e,t){var n=e("lodash-compat"),i=e("services/pes/interactors/bing"),r=e("services/pes/interactors/giphy"),o=e("services/pes/interactors/cloud"),a=e("swx-constants").COMMON,s=e("experience/settings"),c=e("utils/common/interactor"),l=e("services/pes/interactors/mru"),u=e("services/pes/interactors/localSearch"),d=e("services/pes/constants"),p=e("swx-service-locator-instance").default
	t.clearContext=c.defineSimpleInteractor((function(e){e.tabs=[],e.selectedTab=null,e.selectedItem=null,e.selectedTabId=null,e.selectedItemId=null,e._configuredItems=[]})),t.fillTabProperties=c.defineSimpleInteractor((function(e){n.forEach(e.tabs,(function(e){var t
	n.defaults(e,{ariaLabel:e.title,htmlClass:(t=e.id,t===d.localSearch.TAB_ID||t===d.giphyImageSearch.TAB_ID||t===d.bingSearch.TAB_ID?"":"multiLineImageItem"),styleOverride:"",emptyTabMessageKey:"expressionPicker_tab_emptyText"})}))})),t.fillPackProperties=c.defineSimpleInteractor((function(e){n(e.tabs).pluck("packs").flatten().forEach((function(e){e.items["@Meta"]=n.assign(e.items["@Meta"]||{},{typeKey:d.itemTypes.typeKeyName})})).value()})),t.hideEmptyTabs=c.defineSimpleInteractor((function(e){e.tabs=n.filter(e.tabs,(function(e){return e.id===d.mru.TAB_ID||e.id===d.bingSearch.TAB_ID||e.id===d.localSearch.TAB_ID||e.id===d.giphyImageSearch.TAB_ID||(n.forEach(e.packs,(function(e){e.items&&e.items.length&&(t=!0)})),t)
	var t}))})),t.paginateTabs=c.defineInteractor((function(e){e((function(e){e.pagedTabs=function(e){if(e.length<7){var t={tabs:[]}
	return t.tabs=n.map(e,(function(e){return n.pick(e,["id","title","ariaLabel","htmlClass","type","thumbnailUrl"])})),[t]}var i=e.reduce((function(e,t,i){var r=e[e.length-1]
	return r.tabs.length>=4&&4!==i&&(r={tabs:[]},e.push(r)),r.tabs.push(n.pick(t,["id","title","ariaLabel","htmlClass","type","thumbnailUrl"])),e}),[{tabs:[]}]),r=i[i.length-1]
	return 1===r.tabs.length&&(i[i.length-2].tabs.push(r.tabs[0]),i.pop()),i}(e.tabs)}))})),t.setSelectedTab=c.defineSimpleInteractor((function(e){e.selectedTab=n.find(e.tabs,{id:e.currentTabId})||n.first(n.dropWhile(e.tabs,{id:d.mru.TAB_ID}))||n.first(e.tabs)})),t.scrollToSelectedTab=c.defineSimpleInteractor((function(e){e.selectedPageIndex=n.findIndex(e.pagedTabs,(function(t){return n.any(t.tabs,{id:e.selectedTab.id})}))})),t.setNormalTabProperties=c.defineSimpleInteractor((function(e){e.pickerMaximized=!1,e.searchCapabilityEnabled=!1})),t.selectItemAction=c.defineSimpleInteractor((function(e){e.selectedItem=n.find(e._configuredItems,{id:e.selectedItemId})||null})),t.setSelectionState=c.defineComposer([t.setSelectedTab,t.setNormalTabProperties,i.setBingTabProperties,r.setGiphyTabProperties,u.setLocalSearchTabProperties,t.fillPackProperties]),t.numberTabs=c.defineSimpleInteractor((function(e){n.forEach(e.tabs,(function(e,t){e._index=t}))})),t.placeTab=c.defineSimpleInteractor((function(e,t,i){var r=n.remove(e.tabs,{id:t})
	r.length&&(-1===i?e.tabs.push(r[0]):e.tabs.splice(i,0,r[0]))})),t.applyTabPlacementOverrides=c.defineSimpleInteractor((function(e){var i=e.pesTabPlacementOverrides||s.pesPicker.tabPlacementOverrides
	n.forOwn(i,(function(n,i){t.placeTab.run(e,i,n)}))})),t.pickerStateConstructor=function(){var e=p.resolve(a.serviceLocator.FEATURE_FLAGS),n=[t.clearContext,o.putPesTabs]
	return e.isFeatureOn(a.featureFlags.PES_BING_IMAGE_SEARCH_ENABLED)&&n.push(i.putBingTab),e.isFeatureOn(a.featureFlags.PES_GIPHY_IMAGE_SEARCH_ENABLED)&&n.push(r.putGiphyTab),e.isFeatureOn(a.featureFlags.PES_LOCAL_SEARCH_ENABLED)&&n.push(u.putLocalSearchTab),n=n.concat([l.putMRUTab,t.fillTabProperties,t.fillPackProperties,t.hideEmptyTabs,t.applyTabPlacementOverrides,t.paginateTabs,t.numberTabs,t.setSelectionState]),c.defineComposer(n)},t.mruStateUpdater=c.defineComposer([l.putMRUTab,t.fillTabProperties,t.fillPackProperties,t.paginateTabs,t.numberTabs,t.setSelectionState])})),define("ui/components/chat/pes/bingTab/bingSearchTab",["require","lodash-compat","swx-cafe-application-instance","utils/common/cancelation","swx-constants","services/pes/constants","swx-service-locator-instance","services/pes/interactors/bing","services/pes/interactors/picker","experience/settings"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("utils/common/cancelation"),r=e("swx-constants").COMMON,o=e("services/pes/constants"),a=e("swx-service-locator-instance").default,s=e("services/pes/interactors/bing"),c=e("services/pes/interactors/picker"),l=e("experience/settings")
	function u(e,t){var n=a.resolve(r.serviceLocator.PES_BING_SEARCH_SERVICE)
	return Promise.all([n.search(e+" meme",{cancelationToken:t}),n.search(e+" gif",{cancelationToken:t})])}function d(e,i,o){return n.get().signInManager._skypeToken?n.get().signInManager._skypeToken().then((function(n){var s=a.resolve(r.serviceLocator.URL_PREVIEW_SERVICE),c=t.map(e,(function(e){if("image/animatedgif"===e.contentType){return s.getPreviewFor(e.url,{cancelationToken:i,skypeToken:n}).then((function(t){o&&o(e,t)})).catch((function(){}))}return Promise.resolve()}))
	return Promise.all(c)})):Promise.resolve([])}function p(e,n,i,r){var a,c=n[0],u=n[1],p="gif"===l.pesSearchServices.bingPickFirst,f=!!l.pesSearchServices.bingMergeItems,m=s.createBingPacks.run({featureGifsFirst:p,featureCombine:f,gifResults:u,memeResults:c}),h=t.throttle((function(){r.isCanceled||i(e)}),400)
	return r.throwIfCanceled(),t.remove(e._configuredItems,(function(e){return e.type===o.itemTypes.image.id&&t.find(m.items,{id:e.id})})),e._configuredItems=e._configuredItems.concat(m.items),a=t.find(e.tabs,{id:o.bingSearch.TAB_ID}),t.every(m.packs,(function(e){return 0===e.items.length}))?a.emptyTabMessageKey="message_text_emptySearchResults":(a.packs=m.packs,a.emptyTabMessageKey="expressionPicker_bingTab_emptyText"),i(e),d(m.items,r,(function(n,i){if(i.thumbnail&&"image/gif"===i.content_type){var r=t.find(e._configuredItems,{id:n.id})
	r&&(r.thumbnail=i.thumbnail,h())}}))}function f(e){var n
	e._currentOperation&&((n=t.find(e.tabs,{id:o.bingSearch.TAB_ID}))&&(n._currentQuery=""),e._currentOperation.cancel())}return{highlightTabOnBingKeywords:function(e,n,i){var r,a=t.map(l.pesSearchServices.bingTriggerWords,(function(e){return e.toLowerCase()})),s=(e||"").toLowerCase().split(/\s/),u=t.remove(s,t.includes.bind(t,a))
	t.any(u)&&(r=t.compact(s).join(" "),t.find(n.tabs,{id:o.bingSearch.TAB_ID})._currentQuery=r,n.currentTabId=o.bingSearch.TAB_ID,i(n=c.setSelectionState.run(n)))},doBingSearch:function(e,n,r){var a,s;(s=t.find(n.tabs,{id:o.bingSearch.TAB_ID}))&&(s.emptyTabMessageKey="expressionPicker_bingTab_loadingText"),f(n),a=i.cancelableOperation(),n._currentOperation=a,s._currentQuery=e,s.packs=[],r(n),u(e,a.getToken()).then((function(e){p(n,e,r,a.getToken())})).catch((function(e){e instanceof i.OperationCanceledError||(t.find(n.tabs,{id:o.bingSearch.TAB_ID}).emptyTabMessageKey="expressionPicker_bingTab_errorText",r(n))}))},cancelBingSearch:f,getResultsFromBing:u,getImagesFromURLPService:d,processResultsFromBing:p}})),define("telemetry/chat/giphyServiceQOS",["require","exports","module","swx-utils-common","experience/settings","swx-constants","ui/telemetry/telemetryClient","swx-telemetry-buckets"],(function(e,t){var n=e("swx-utils-common").stopwatch,i=e("experience/settings"),r=e("swx-constants").COMMON,o=e("ui/telemetry/telemetryClient"),a=e("swx-telemetry-buckets")
	function s(){var e=n.build()
	function t(e){return e||r.telemetry.NOT_AVAILABLE}this.publish=function(n){var r=e.duration(),s={ttc:r,ttcGroup:a.getMessageLifeDurationGroup(r),querySource:n.querySource,success:n.success,giphyCount:t(n.count)+"",responseCode:t(n.responseCode)+""}
	o.get().sendEvent(i.telemetry.chatTenantToken,"giphy_qos",s)}}t.build=function(){return new s}})),define("ui/components/chat/pes/giphyTab/giphySearchTab",["require","lodash-compat","utils/common/cancelation","swx-constants","services/pes/constants","swx-service-locator-instance","experience/settings","services/pes/interactors/giphy","telemetry/chat/giphyServiceQOS"],(function(e){var t=e("lodash-compat"),n=e("utils/common/cancelation"),i=e("swx-constants").COMMON,r=e("services/pes/constants"),o=e("swx-service-locator-instance").default,a=e("experience/settings"),s=e("services/pes/interactors/giphy"),c=e("telemetry/chat/giphyServiceQOS"),l=20,u={trending:!0},d={translate:function(e){if(t.isArray(e.data))return e
	return e.data=[e.data],e},random:function(e){if(t.isArray(e.data))return e
	return e.data.images={downsized:{width:e.data.fixed_height_downsampled_width,height:e.data.fixed_height_downsampled_height,url:e.data.fixed_height_downsampled_url},original:{url:e.data.image_url}},e.data=[e.data],e},search:t.identity,trending:t.identity}
	function p(e,n){var r=function(e,t,n){var r=o.resolve(i.serviceLocator.PES_GIPHY_SEARCH_SERVICE)
	return Promise.all(t.map((function(t){var i,o=r[t]
	return o?(o=t in u?o.bind(r):o.bind(r,e),i=c.build(),o({cancelationToken:n,limit:l}).catch((function(e){throw i.publish({querySource:t,success:!1,responseCode:e.status}),e})).then(d[t]).then((function(e){return i.publish({querySource:t,success:!0,count:e.data.length,responseCode:200}),e})).then((function(e){return e.data.forEach((function(e){e.querySource=t})),e}))):Promise.resolve([{data:[]}])})))}(e,e?a.pesSearchServices.giphy.withQuerySources:a.pesSearchServices.giphy.withoutQuerySources,n)
	return r.then((function(e){var n=t(e).map((function(e){return e.data})).flatten().reduce((function(e,n){return t.find(e,{id:n.id})||e.push(n),e}),[])
	return{data:t.take(n,l)}}))}function f(e,n,i,o){var a,c=s.createGiphyPacks.run(n)
	o.throwIfCanceled(),t.remove(e._configuredItems,(function(e){return e.type===r.itemTypes.image.id&&t.find(c.items,{id:e.id})})),e._configuredItems=e._configuredItems.concat(c.items),a=t.find(e.tabs,{id:r.giphyImageSearch.TAB_ID}),t.every(c.packs,(function(e){return 0===e.items.length}))?a.emptyTabMessageKey="message_text_emptySearchResults":(a.packs=c.packs,a.emptyTabMessageKey="expressionPicker_giphyImgTab_emptyText"),i(e)}function m(e){var n
	e._currentOperation&&((n=t.find(e.tabs,{id:r.giphyImageSearch.TAB_ID}))&&(n._currentQuery=""),e._currentOperation.cancel())}return{doGiphySearch:function(e,i,o){var a,s;(s=t.find(i.tabs,{id:r.giphyImageSearch.TAB_ID}))&&(s.emptyTabMessageKey="expressionPicker_giphyImgTab_loadingText"),m(i),a=n.cancelableOperation(),i._currentOperation=a,s._currentQuery=e,s.packs=[],o(i),p(e,a.getToken()).then((function(e){f(i,e,o,a.getToken())})).catch((function(e){e instanceof n.OperationCanceledError||(t.find(i.tabs,{id:r.giphyImageSearch.TAB_ID}).emptyTabMessageKey="expressionPicker_giphyImgTab_errorText",o(i))}))},cancelGiphySearch:m,getResultsFromGiphy:p,processResultsFromGiphy:f}})),define("ui/components/chat/pes/localSearchTab/localSearchTab",["require","lodash-compat","swx-constants","swx-i18n","services/pes/constants","swx-service-locator-instance","experience/settings","services/pes/interactors/picker","services/pes/interactors/localSearch"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("swx-i18n").localization,r=e("services/pes/constants"),o=e("swx-service-locator-instance").default,a=e("experience/settings"),s=e("services/pes/interactors/picker"),c=e("services/pes/interactors/localSearch")
	function l(e,n){var i=t([e.keywords||[],e.shortcut||[],e.description.split(/\s/),(e.copyright||"").split(/\s/),(e.pickerTitle||"").split(/\s/),(e.transcript||"").split(/\s/)]).flatten().compact().map((function(e){return e.toLowerCase()})).value(),r=t(n.split(/\s/)).compact().map((function(e){return e.toLowerCase()})).value()
	return t.any(r,(function(e){return t.any(i,(function(t){return 0===t.search(e)}))}))}return{doLocalSearch:function(e,u,d){var p=t.find(u.tabs,{id:r.localSearch.TAB_ID}),f=o.resolve(n.serviceLocator.PES_CONFIG_SERVICE).getConfiguration()
	e=(e||"").toLowerCase(),p._currentQuery=e,e?function(e,n,i,r){r.packs=[]
	var o={}
	t.forEach(e.tabs,(function(e){t.forEach(e.packs,(function(e){var a,s=t.filter(e.items,t.bind(l,null,t,n));(s=t.filter(s,(function(e){var t=e.id in o
	return t||(o[e.id]=!0),!t}))).length&&((a=t.cloneDeep(e)).items=t.map(s,(function(e){return t.find(i._configuredItems,{id:e.id})})),r.packs.push(a))}))})),a.pesSearchServices.localSearchGroupByType&&c.groupByType.run(r)}(f,e,u,p):function(e,n){n.packs=[{ariaLabel:i.fetch({key:r.localSearch.ariaLabelLocKey}),title:i.fetch({key:r.localSearch.titleLocKey}),id:r.localSearch.PACK_PREFIX+"categories"}],n.packs[0].items=t(a.pesSearchServices.localSearchCategories).map((function(e){return{id:e,type:r.itemTypes.message.id,htmlClass:"clickable",text:e}})).value()}(0,p),s.setSelectionState.run(u),d(u,["selectedTab","selectedItem"])}}})),define("services/pes/interactors/store",["require","exports","module","lodash-compat","utils/common/interactor","ui/modalDialog/modalDialog","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("lodash-compat"),i=e("utils/common/interactor"),r=e("ui/modalDialog/modalDialog"),o=e("swx-constants").COMMON,a=e("swx-service-locator-instance").default
	t.setStoreTabProperties=i.defineSimpleInteractor((function(e){e.pickerState.storeEnabled||(e.pickerState.storeEnabled=!0,e.storeDialog=r,e.pickerState.purchasedTabs=[],e.pickerState.purchasedTabIds=[],r.build("pes-store",e,'<div id="pes-store" class="swx-hide"><swx-expressionstore-v2-browsepacks id="pes-store-comp" params="pickerState: pickerState, pickerVM: pickerVM, storeModalDialog: storeDialog"></swx-expressionstore-browsepacks></div>'))})),t.disposeStore=i.defineSimpleInteractor((function(){})),t.showStore=i.defineSimpleInteractor((function(e){e.showStore&&e.showStore()})),t.downloadPreviouslyPurchasedTabs=i.defineSimpleInteractor((function(e,t){var n,i,r,s=a.resolve(o.serviceLocator.PES_STORE_SERVICE),c=0
	n=e.purchasedTabs=e.purchasedTabs||{},i=e.purchasedTabIds=e.purchasedTabIds||[],r=e.hiddenTabIds=e.hiddenTabIds||[],s.downloadPurchasedTabsFromEntitlement().then((function(o){s.getHiddenTabs().then((function(a){r.push.apply(r,a),o.forEach((function(r){r.pesConfig.then((function(i){n[r.id]=i.tabs[0],e._configuredItems=e._configuredItems.concat(i.items),++c===o.length&&"function"==typeof t&&t()})),i.push(r.id)}))}))}))})),t.putPurchasedTabs=i.defineSimpleInteractor((function(e){if(e.purchasedTabs){var t=e.purchasedTabIds,i=e.purchasedTabs
	t.forEach((function(t){-1===e.hiddenTabIds.indexOf(t)&&(n.remove(e.tabs,{id:t}),e.tabs.splice(4,0,i[t]))}))}})),t.putNewPurchasedTab=i.defineSimpleInteractor((function(e,t,n){var i=e.purchasedTabIds,r=e.purchasedTabs;-1===i.indexOf(t)&&(i.push(t),r[t]=n.tabs[0]),e._configuredItems=e._configuredItems.concat(n.items),e.tabs.splice(4,0,r[t])})),t.hidePurchasedTabOnPicker=i.defineSimpleInteractor((function(e,t){e.hiddenTabIds.push(t),n.remove(e.tabs,{id:t})}))})),define("ui/components/chat/pes/expressionPickerController",["require","lodash-compat","ui/components/chat/pes/bingTab/bingSearchTab","ui/components/chat/pes/giphyTab/giphySearchTab","ui/components/chat/pes/localSearchTab/localSearchTab","swx-utils-common","swx-constants","utils/common/eventMixin","services/pes/constants","services/pes/interactors/picker","services/pes/interactors/store","swx-pubsub-instance","experience/settings","swx-service-locator-instance","swx-focus-handler","vendor/knockout","browser/dom","utils/common/accessibility","telemetry/chat/pes"],(function(e){var t=e("lodash-compat"),n=e("ui/components/chat/pes/bingTab/bingSearchTab"),i=e("ui/components/chat/pes/giphyTab/giphySearchTab"),r=e("ui/components/chat/pes/localSearchTab/localSearchTab"),o=e("swx-utils-common").builderMixin,a=e("swx-constants").COMMON,s=a.events,c=e("utils/common/eventMixin"),l=e("services/pes/constants"),u=e("services/pes/interactors/picker"),d=e("services/pes/interactors/store"),p=e("swx-pubsub-instance").default,f=e("experience/settings"),m=e("swx-service-locator-instance").default,h=e("swx-focus-handler"),v=e("vendor/knockout"),g=e("browser/dom"),y=e("utils/common/accessibility").narrator,b=e("telemetry/chat/pes")
	function _(){this.model={itemStartPlayRequest:0,_currentOperation:null,_conversationModel:null,_startPlaybackAction:t.debounce(t.bind(this.startPlaybackAction,this),600)},this.subscriptions=[],this.viewModel=null}return _.prototype.init=function(e,o){var c,l=m.resolve(a.serviceLocator.PES_CONFIG_SERVICE),u=m.resolve(a.serviceLocator.PES_MRU_SERVICE),p=m.resolve(a.serviceLocator.FEATURE_FLAGS)
	this.setContext(o),this.viewModel=e,this.model._conversationModel=o.conversationModel,this.subscriptions.push(l.on(s.personalExpression.CONFIG_INITIALIZED,this.emit.bind(this,"handlePesConfig"))),this.subscriptions.push(u.on(s.personalExpression.CONFIG_INITIALIZED,this.emit.bind(this,"handleMruConfig"))),p.isFeatureOn(a.featureFlags.PES_BING_IMAGE_SEARCH_ENABLED)&&(this.subscriptions.push(o.registerEvent(s.textarea.CHANGED,this.emit.bind(this,"handleChatInput"))),this.highlightTabOnBingKeywords=t.debounce(n.highlightTabOnBingKeywords,400),this.doBingSearch=t.debounce(n.doBingSearch,400)),p.isFeatureOn(a.featureFlags.PES_GIPHY_IMAGE_SEARCH_ENABLED)&&(this.doGiphySearch=t.debounce(i.doGiphySearch,400)),p.isFeatureOn(a.featureFlags.PES_LOCAL_SEARCH_ENABLED)&&(this.doLocalSearch=t.debounce(r.doLocalSearch,400)),this.handlePesConfigEvent(),p.isFeatureOn(a.featureFlags.PES_STORE_ENABLED)&&(c=d.setStoreTabProperties.run({pickerState:this.model,pickerVM:this.viewModel}),this.subscriptions.push({dispose:function(){d.disposeStore.run(c)}}),this.viewModel.applyState(this.model),d.downloadPreviouslyPurchasedTabs.run(this.model,this.emit.bind(this,"handleDownloadPurchasedTabs")))},_.prototype.dispose=function(){},_.prototype.done=function(){t.forEach(this.subscriptions,(function(e){e.cancel?e.cancel():e.dispose&&e.dispose()})),this.dispose(),this.model=null,this.viewModel=null},_.prototype.handlePesConfigEvent=function(){var e=v.utils.unwrapObservable(this.viewModel.state.selectedTab)&&v.utils.unwrapObservable(this.viewModel.state.selectedTab).id,n=u.pickerStateConstructor().run({currentTabId:e,conversationModel:this.model._conversationModel})
	delete n.conversationModel,t.assign(this.model,n),this.viewModel.applyState(this.model)},_.prototype.handleMruConfigEvent=function(){this.model=u.mruStateUpdater.run(this.model),this.viewModel.applyState(this.model)},_.prototype.handleChatInputEvent=function(e){this.model._chatInputText=e,e?this.highlightTabOnBingKeywords(e,this.model,this.viewModel.applyState.bind(this.viewModel)):(this.highlightTabOnBingKeywords.cancel(),n.cancelBingSearch(this.model))},_.prototype.handleQueryChangedEvent=function(e,t){switch(this.model.query!==e&&(this.model.query=e,this.viewModel.applyState(this.model)),this.model.selectedTab.id){case l.bingSearch.TAB_ID:this.doBingSearch(e,this.model,this.viewModel.applyState.bind(this.viewModel))
	break
	case l.giphyImageSearch.TAB_ID:this.doGiphySearch(e,this.model,this.viewModel.applyState.bind(this.viewModel))
	break
	case l.localSearch.TAB_ID:t?r.doLocalSearch(e,this.model,this.viewModel.applyState.bind(this.viewModel)):this.doLocalSearch(e,this.model,this.viewModel.applyState.bind(this.viewModel))}},_.prototype.handleResetQueryEvent=function(){this.handleQueryChangedEvent("",!0)},_.prototype.startPlaybackAction=function(){this.model.isOpened&&(this.model.itemStartPlayRequest=this.model.itemStartPlayRequest>=0?this.model.itemStartPlayRequest+1:1,this.viewModel.applyState(this.model))},_.prototype.stopPlaybackAction=function(){this.model.itemStartPlayRequest=this.model.itemStartPlayRequest>0?0:this.model.itemStartPlayRequest-1,this.viewModel.applyState(this.model),this.model._startPlaybackAction.cancel()},_.prototype.handleMouseoverEvent=function(e,t){switch(e){case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:case l.itemTypes.image.id:this.model.selectedItemId=t,this.model=u.selectItemAction.run(this.model),this.stopPlaybackAction(),this.model._startPlaybackAction(),this.viewModel.applyState(this.model)}},_.prototype.handleTouchendEvent=function(e,t,n){switch(e){case l.itemTypes.tab.id:break
	case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:case l.itemTypes.image.id:this.model.selectedItemId!==t&&(this.model.selectedItemId=t,this.model=u.selectItemAction.run(this.model),this.viewModel.applyState(this.model),this.startPlaybackAction(),n.preventDefault())}},_.prototype.handleHighlightEvent=function(e,t){switch(e){case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:case l.itemTypes.image.id:this.model.selectedItemId=t,this.model=u.selectItemAction.run(this.model),this.stopPlaybackAction(),this.model._startPlaybackAction(),this.viewModel.applyState(this.model)}},_.prototype.handleMouseoutEvent=function(e){switch(e){case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:this.stopPlaybackAction()}},_.prototype.activateTab=function(e){e!==this.model.selectedTab.id&&(this.model.currentTabId=e,u.setSelectionState.run(this.model),this.viewModel.applyState(this.model)),this.model.selectedTab.id===l.bingSearch.TAB_ID&&(n.highlightTabOnBingKeywords(this.model._chatInputText,this.model,this.viewModel.applyState.bind(this.viewModel)),function(e){var i=t.find(e.model.tabs,{id:l.bingSearch.TAB_ID})
	i._currentQuery||(i._currentQuery=f.pesSearchServices.bingDefaultSearchTerm||""),i._currentQuery&&e.model.query!==i._currentQuery&&(e.model.query=i._currentQuery,n.doBingSearch(i._currentQuery,e.model,e.viewModel.applyState.bind(e.viewModel))),e.model.hasFocus=!0,e.viewModel.applyState(e.model)}(this)),this.model.selectedTab.id===l.localSearch.TAB_ID&&function(e){var n=t.find(e.model.tabs,{id:l.localSearch.TAB_ID})
	e.model.query=n._currentQuery,r.doLocalSearch(e.model.query,e.model,e.viewModel.applyState.bind(e.viewModel)),e.model.hasFocus=!0,e.viewModel.applyState(e.model,["hasFocus","query"])}(this),this.model.selectedTab.id===l.giphyImageSearch.TAB_ID?(function(e){var n=t.find(e.model.tabs,{id:l.giphyImageSearch.TAB_ID})
	e.model.query||(e.model.query=""),e.model.query!==n._currentQuery&&(e.model.query=n._currentQuery,i.doGiphySearch(n._currentQuery,e.model,e.viewModel.applyState.bind(e.viewModel))),e.model.hasFocus=!0,e.viewModel.applyState(e.model)}(this),this.dispatchEvent(s.textarea.SET_ATTRIBUTION,"giphy")):this.dispatchEvent(s.textarea.SET_ATTRIBUTION,null)},_.prototype.handleClickEvent=function(e,t){switch(e){case l.itemTypes.tab.id:this.activateTab(t)
	break
	case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:case l.itemTypes.image.id:this.model.selectedItemId=t,this.model=u.selectItemAction.run(this.model),p.publish(a.events.expressionPicker.ITEM_SEND_REQUEST,{item:this.model.selectedItem,conversation:this.model._conversationModel,sourceTab:this.model.selectedTab,query:this.model.query}),this.handleCloseBubbleEvent(),(n=g.getElement(".swx .chat .inputField"))&&h.get().addFocusRequestToQueue(n)
	break
	case l.itemTypes.message.id:this.model.selectedTab.id===l.localSearch.TAB_ID&&this.handleQueryChangedEvent(t,!0)}var n},_.prototype.handleKeydownEvent=function(e,t){this.handleMouseoverEvent(e,t),this.handleClickEvent(e,t)},_.prototype.handleActivationEvent=function(e,t){switch(e){case l.itemTypes.moji.id:case l.itemTypes.emoticon.id:case l.itemTypes.image.id:p.publish(a.events.expressionPicker.ITEM_SEND_REQUEST,{item:this.model.selectedItem,conversation:this.model._conversationModel,sourceTab:this.model.selectedTab,query:this.model.query}),this.handleCloseBubbleEvent()
	break
	case l.itemTypes.message.id:this.model.selectedTab.id===l.localSearch.TAB_ID&&this.handleQueryChangedEvent(t,!0)}},_.prototype.handlePlaybackPausedEvent=function(){this.stopPlaybackAction()},_.prototype.handleResetQueryEvent=function(){this.model.query="",this.viewModel.applyState(this.model)},_.prototype.handleOpenBubbleEvent=function(){this.model.isOpened?this.handleCloseBubbleEvent():(this.model.isOpened=!0,this.model.wasOpenedBefore=!0,this.activateTab(this.model.selectedTab.id),b.expressionPickerOpened(),y.announce({key:"accessibility_open_picker"})),this.viewModel.applyState(this.model)},_.prototype.handleCloseBubbleEvent=function(){(this.stopPlaybackAction(),this.model.isOpened=!1,this.model.selectedTab.id===l.bingSearch.TAB_ID)&&(t.find(this.model.tabs,{id:l.bingSearch.TAB_ID})._currentQuery="")
	this.viewModel.applyState(this.model),this.dispatchEvent(s.textarea.SET_ATTRIBUTION,null),y.announce({key:"accessibility_close_picker"})},_.prototype.handleShowStoreEvent=function(){d.showStore.run(this.model)},_.prototype.handleDownloadPurchasedTabsEvent=function(){d.putPurchasedTabs.run(this.model),this.model=u.mruStateUpdater.run(this.model),this.viewModel.applyState(this.model)},_.prototype.emit=function(){var e=Array.prototype.slice.call(arguments),t=this[e[0]+"Event"]
	t?t.apply(this,e.slice(1)):console.log("Unhandled",e)},t.assign(_,o),t.assign(_.prototype,c),_})),define("utils/common/stateMixin",["require","lodash-compat","vendor/knockout","browser/window"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("browser/window")
	function r(){}function o(){this.storage=[],this.lastFreeSlot=-1}o.prototype.get=function(e){var n=t.find(this.storage,{key:e})
	return n&&n.value},o.prototype.set=function(e,n){var i=this.lastFreeSlot;-1!==i||-1!==(i=t.findIndex(this.storage,null))?(this.storage[i]={key:e,value:n},this.lastFreeSlot=-1):this.storage.push({key:e,value:n})},o.prototype.delete=function(e){var n=t.findIndex(this.storage,{key:e});-1!==n&&(this.storage[n]=null,this.lastFreeSlot=n)}
	var a=o
	function s(){}function c(){}function l(){}"function"==typeof WeakMap&&(a=WeakMap),s.prototype.EMPTY_VALUE=null,s.prototype.isBound=function(e,t){return null===t||e&&e.hasOwnProperty(t)},s.prototype.resolve=function(e,t){return null===t?e:e&&e[t]},s.prototype.assign=function(e,t,n){if(null===t)throw new Error("References are immutable")
	e[t]=n},s.prototype.delete=function(e,t){if(null===t)throw new Error("References are immutable")
	e.hasOwnProperty(t)?delete e[t]:e[t]=void 0},c.prototype=Object.create(s.prototype),c.prototype.resolve=function(e,t){return null===t?e&&e():e&&e[t]&&e[t]()},c.prototype.assign=function(e,t,i){null!==t?e[t]?e[t](i):e[t]=n.observable(i):e(i)},c.prototype.delete=function(e){this.assign(e,void 0)},l.prototype=Object.create(c.prototype),l.prototype.assign=function(e,t,i){null!==t?e[t]?e[t](i):e[t]=n.observableArray(i):e(i)},l.prototype.EMPTY_VALUE=[]
	var u=new s,d=new c,p=new l
	function f(e,t){return n.isObservable(e[t])?e[t].push?p:d:u}var m=[NaN]
	function h(e){"string"!=typeof e&&"number"!=typeof e||(e=[e]),this.key=e}h.prototype=Object.create(s.prototype),h.prototype.resolve=function(e){return this.key?"function"==typeof this.key?this.key(e)||m:this.key.map((function(t){return f(e,t).resolve(e,t)})):m}
	var v={undefined:1,boolean:1,number:1,string:1,function:1}
	function g(e){return typeof e in v||null===e||e instanceof Date||t.isElement(e)||Promise&&e instanceof Promise}function y(){}function b(){this.preserveReferences=!1}b.prototype.valueAssign=function(e,t,n){("string"!=typeof t&&"number"!=typeof t||e.hasOwnProperty(t)?f(e,t):"function"==typeof n?u:d).assign(e,t,n)}
	var _=function(e,n,i){return t.isEqual(e.resolve(i),n)}
	function E(e,n,i,r,o){var a,s,c=r.resolve(e),l=o.resolve(e),u=void 0
	return c!==m&&-1!==(s=t.findIndex(i,_.bind(null,r,c)))&&s!==n&&(u=i[s],i[s]=void 0),u||(u=i[n]),u&&l!==m&&((a=o.resolve(u))===m||a!==l&&!t.isEqual(a,l))&&(u=void 0),u}function w(){this._scheduledTaskHandler&&(i.requestAnimationFrame?i.cancelAnimationFrame(this._scheduledTaskHandler):n.tasks.cancel(this._scheduledTaskHandler))}function S(){var e=this._taskQueue
	return this._taskQueue=[],e}function x(e,n){return t.reduce(e,(function(e,i){var r=i.newState
	return t.isFunction(r)?r=r(this.state,this.props):i.limitKeys&&(r=t.pick(r,i.limitKeys)),i.callback&&n.push(i.callback),t.assign(e,r)}),{},this)}function C(e){return this.beforeStateApplied&&(e=this.beforeStateApplied(e)||e),e}function T(e){var t=new b;(new y).execute(this.state,e,t)}function I(e){this.afterStateApplied&&this.afterStateApplied(),t.forEach(e,(function(e){e&&t.isFunction(e)&&e.call(this)}))}function A(e,i){return t.isFunction(i)?i:t.isArray(i)?n.observableArray(i):t.isPlainObject(i)||t.isBoolean(i)||t.isString(i)||t.isNumber(i)||t.isNull(i)||t.isUndefined(i)||t.isDate(i)||t.isElement(i)?n.observable(i):i}return b.prototype.deepArrayAssign=function(e,i,r){var o,a,s
	"string"!=typeof i&&"number"!=typeof i||e.hasOwnProperty(i)||(e[i]=n.observableArray())
	var c,l=f(e,i),u=l.resolve(e,i)||[],d=[]
	for(a=new h(this.typeKeyFor(r)),o=new h(this.keyFor(r)),c=0;c<r.length;++c){var p=f(r,c).resolve(r,c)
	g(p)?f(d,c).assign(d,c,p):t.isArray(p)?this.deepArrayAssign(d,c,p):(s=E(p,c,u,o,a)||{},f(d,c).assign(d,c,s),this.deepObjectAssign(d,c,p))}Array.prototype.splice.apply(u,[0,u.length].concat(d)),l.assign(e,i,u)},b.prototype.deepObjectAssign=function(e,n,i){var r,o,a,s,c=f(e,n),l=new h(this.typeKeyFor(i)),u=!1
	if(i){if(r=this.getFromStack(i))return this.breakCycles&&(r=null),void c.assign(e,n,r)
	this.preserveReferences&&(r=this.getKnownObject(i))?c.assign(e,n,r):(o=null,c.isBound(e,n)&&(o=c.resolve(e,n)),a=l.resolve(i),o&&a!==m&&(u=!0,((s=l.resolve(o))===m||s!==a&&!t.isEqual(s,a))&&(u=!1)),null===o&&(o={}),this.pushContextUpdate(i,o),y.prototype.execute(o,i,this),this.popContext(i),u||c.assign(e,n,o))}else c.assign(e,n,r)},b.prototype.getFromStack=function(e){var t=this.contextStack&&this.contextStack.get(e)
	return t&&t.target},b.prototype.getKnownObject=function(e){return this.knownObjects&&this.knownObjects.get(e)},b.prototype.pushContextUpdate=function(e,t){var n,i=this.contextStack||new a
	this.contextStack=i,this.preserveReferences&&(n=this.knownObjects||new a,this.knownObjects=n,n.set(e,t)),i.set(e,{target:t,breakCycles:this.breakCycles,removeExtra:this.removeExtra}),this.breakCycles=!0,this.removeExtra=!1},b.prototype.popContext=function(e){var t=this.contextStack&&this.contextStack.get(e)
	t&&(this.breakCycles=t.breakCycles,this.removeExtra=t.removeExtra,this.contextStack.delete(e))},b.prototype.ignoreProperty=function(e){return e&&("_"===e[0]||"@"===e[0])},b.prototype.keyFor=function(){return null},b.prototype.typeKeyFor=function(e){return e["@Meta"]&&e["@Meta"].typeKey},y.prototype.execute=function(e,n,i){var r,o,a,s,c=[]
	for(o in i.removeExtra&&t.forOwn(e,(function(t,i){n.hasOwnProperty(i)||f(e,i).delete(e,i)})),n)n.hasOwnProperty(o)&&!i.ignoreProperty(o)&&(s=g(r=f(n,o).resolve(n,o))?1:t.isArray(r)?2:3,c.push({name:o,value:r,semantics:s}))
	switch(c.length){case 4:switch((a=c[3]).semantics){case 1:i.valueAssign(e,a.name,a.value)
	break
	case 2:i.deepArrayAssign(e,a.name,a.value)
	break
	case 3:i.deepObjectAssign(e,a.name,a.value)}case 3:switch((a=c[2]).semantics){case 1:i.valueAssign(e,a.name,a.value)
	break
	case 2:i.deepArrayAssign(e,a.name,a.value)
	break
	case 3:i.deepObjectAssign(e,a.name,a.value)}case 2:switch((a=c[1]).semantics){case 1:i.valueAssign(e,a.name,a.value)
	break
	case 2:i.deepArrayAssign(e,a.name,a.value)
	break
	case 3:i.deepObjectAssign(e,a.name,a.value)}case 1:switch((a=c[0]).semantics){case 1:i.valueAssign(e,a.name,a.value)
	break
	case 2:i.deepArrayAssign(e,a.name,a.value)
	break
	case 3:i.deepObjectAssign(e,a.name,a.value)}case 0:break
	default:t.forEach(c,(function(t){switch(t.semantics){case 1:i.valueAssign(e,t.name,t.value)
	break
	case 2:i.deepArrayAssign(e,t.name,t.value)
	break
	case 3:i.deepObjectAssign(e,t.name,t.value)}}))}},r.prototype.baseApplyState=function(e,n,i){var o=this.scheduleStateMerge||r.prototype.scheduleStateMerge
	this.state=this.state||{},(t.isString(n)||t.isArray(n))&&(i=n,n=null),t.isString(i)&&(i=[i]),this._taskQueue=this._taskQueue||[],this._taskQueue.push({newState:e,callback:n,limitKeys:i}),o.call(this)},r.prototype.applyState=r.prototype.baseApplyState,r.prototype.scheduleStateMerge=function(){var e=this.processTaskQueue||r.prototype.processTaskQueue
	this._scheduledTaskHandler||(i.requestAnimationFrame?this._scheduledTaskHandler=i.requestAnimationFrame(e.bind(this)):this._scheduledTaskHandler=n.tasks.schedule(e.bind(this)))},r.prototype.processTaskQueue=function(){var e,t,n=[],i=this.scheduleStateMerge||r.prototype.scheduleStateMerge
	w.call(this),this._taskQueue&&0!==this._taskQueue.length?(t=S.call(this),e=x.call(this,t,n),e=C.call(this,e),T.call(this,e),this._scheduledTaskHandler=null,this._taskQueue.length&&i.call(this),I.call(this,n)):this._scheduledTaskHandler=null},r.overrideDefaults=function(){var e=Array.prototype.slice.call(arguments)
	return e.push(A),t.assign.apply(t,e),e[0]},t.assign(r,r.prototype),r})),define("ui/viewModels/chat/pes/expressionPicker",["require","lodash-compat","swx-constants","swx-utils-common","browser/document","browser/dom","utils/common/eventHelper","utils/common/interactor","vendor/knockout","experience/settings","utils/common/stateMixin","utils/common/outsideClickHandler","swx-focus-handler","services/pes/constants","swx-constants","utils/common/accessibility","swx-i18n"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").KEYS,i=e("swx-utils-common").builderMixin,r=e("browser/document"),o=e("browser/dom"),a=e("utils/common/eventHelper"),s=e("utils/common/interactor"),c=e("vendor/knockout"),l=e("experience/settings"),u=e("utils/common/stateMixin"),d=e("utils/common/outsideClickHandler"),p=e("swx-focus-handler"),f=e("services/pes/constants"),m="expressionPicker",h=e("swx-constants").COMMON,v=e("utils/common/accessibility").narrator,g=e("swx-i18n").localization,y=s.defineSimpleInteractor((function(e){e.pickerButtonClass("swx-expression-picker-btn transparent circle emoticon-picker-button large"),e.pickerButtonIcon("emoticonStroke")})),b=s.defineInteractor((function(){this.onlyIf((function(){return l.pesPicker.useSelectedTabIconForPicker})),this.run((function(e){var t=e.selectedTab()
	t&&(e.pickerButtonClass("swx-expression-picker-btn transparent tab-icon emoticon-picker-button large"),e.pickerButtonIcon("tab enabled "+t.htmlClass()))}))})),_=s.defineSimpleInteractor((function(e){var t,n=e.pagedTabs().length,i=e.selectedPageIndex(),r="page"+i
	t=n<=1?"singlePage":i===n-1?r+" last":r,e.storeEnabled()&&(t="storeEnabled "+t),e.tabsCss(t)})),E=s.defineComposer([y,b,_])
	function w(e,i){var s,l,y=this
	function b(e){y.applyState({selectedPageIndex:e},null)}function _(){y.params.eventEmitter.emit("handleCloseBubble")}function w(){return o.getElement(".emoticon-picker-button",i)}function S(){var e=o.getElement(".swx .chat .inputField",o.getParentMatching(i,".swx .chat"))
	e&&p.get().addFocusRequestToQueue(e)}function x(){d.remove(m)}y.state=u.overrideDefaults({},y.getInitialState()),y.params=u.overrideDefaults({},y.getDefaultParams(),e),s=y.state.query.subscribe((function(e){y.params.eventEmitter.emit("handleQueryChanged",e)})),l=y.state.isOpened.subscribe((function(e){e?d.add(m,_):x()})),y.afterStateApplied=function(){E.run(this.state)},y.onSearchBoxKeyDown=function(e,t){var i=a.getKeyCode(t)
	return i===n.ESCAPE?y.state.query()?(y.resetQuery(),void t.stopPropagation()):void 0:i!==n.BACKSPACE||y.state.query()?i!==n.ENTER:void a.swallow(t)},y.resetQuery=function(){y.params.eventEmitter.emit("handleResetQuery")},y.nextPage=function(){var e=y.state.selectedPageIndex()+1
	e<y.state.pagedTabs().length&&b(e)},y.prevPage=function(){var e=y.state.selectedPageIndex()-1
	e>=0&&b(e)},y.init=function(){E.run(this.state)},y.openBubble=function(){y.params.eventEmitter.emit("handleOpenBubble")},y.handleEnter=function(e,t){"BUTTON"!==t.target.tagName&&"INPUT"!==t.target.tagName&&t.preventDefault(),y.handleMouseEvent(e,t)},y.handleMouseEvent=function(e,n){var i,r,o,a=c.dataFor(n.target)
	if(a&&a.type&&a.id){var s="handle"+t.capitalize(n.type)
	y.params.eventEmitter.emit(s,a.type(),a.id(),n),a.title&&(i=a.type(),r=n.type,o=a.title(),i!==f.itemTypes.tab.id||r!==h.events.browser.KEYDOWN&&r!==h.events.browser.CLICK||v.announce({key:"expressionPicker_selected_item_title",params:{itemTitle:o||""}}))}return!1},y.selectedTabAriaLabel=function(e){var t=e.ariaLabel&&e.ariaLabel()||""
	return e.type&&e.type()===f.itemTypes.tab.id&&y.state.selectedTab().id()===e.id()?g.fetch({key:"expressionPicker_selected_item_title",params:{itemTitle:t}}):t},y.handleKeyDown=function(e,t){var i,o=a.getKeyCode(t)
	return o===n.ESCAPE&&y.state.isOpened()?(t.stopPropagation(),_(),void((i=w())&&p.get().addFocusRequestToQueue(i))):o!==n.ESCAPE||r.activeElement!==w()||(t.stopPropagation(),void S())},y.dispose=function(){x(),s.dispose(),l.dispose(),y.params.eventEmitter.done()},y.showStore=function(){y.params.eventEmitter.emit("handleShowStore")}}return w.prototype.getInitialState=function(){return{isOpened:!1,wasOpenedBefore:!1,pickerButtonIcon:"",pickerButtonClass:"",pagedTabs:[],tabsCss:"",selectedPageIndex:0,selectedTab:null,selectedItem:null,itemStartPlayRequest:0,pickerMaximized:!1,searchCapabilityEnabled:!1,query:"",storeEnabled:!1}},w.prototype.getDefaultParams=function(){return{isDisabled:!0,eventEmitter:a.emptyEmitter}},t.assign(w.prototype,u),t.assign(w,i),w})),define("text!views/chat/pes/expressionPicker.html",[],(function(){return'<div class="wrapper swx-expression-picker"\r\n     data-bind="event: {\r\n        keydown:        handleKeyDown,\r\n        mouseover:      handleMouseEvent,\r\n        mouseout:       handleMouseEvent,\r\n        touchend:       handleMouseEvent,\r\n        pointerover:    handleMouseEvent,\r\n        click:          handleMouseEvent\r\n        }, enterKey: handleEnter">\r\n    <swx-button params="cssClass: state.pickerButtonClass,\r\n                        icon: state.pickerButtonIcon,\r\n                        disabled: params.isDisabled, titleKey: \'button_title_emoticons\',\r\n                        textKey: \'button_text_emoticons\', action: openBubble,\r\n                        ariaLabelKey: \'emoticonPicker_heading_label\'"></swx-button>\r\n    \x3c!-- ko if: state.wasOpenedBefore --\x3e\r\n    <div class="bubble popup arrow down" data-bind="css: { active:state.isOpened }">\r\n\r\n        \x3c!-- ko ifnot: state.pickerMaximized --\x3e\r\n        <swx-expressionitem-roster params="item: state.selectedItem, itemStartPlayRequest: state.itemStartPlayRequest, eventEmitter: params.eventEmitter"></swx-expressionitem-roster>\r\n        <div class="infoLine"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: state.searchCapabilityEnabled --\x3e\r\n        <div class="searchContainer">\r\n            <input type="text" data-bind="\r\n                hasFocus:       state.hasFocus,\r\n                textInput:      state.query,\r\n                event: {\r\n                    keydown:    onSearchBoxKeyDown\r\n                    },\r\n                l10n_attr: {\r\n                    \'placeholder\':  \'input_placeholder_searchPESItems\',\r\n                    \'aria-label\':   \'input_searchPESItems_ariaLabel\'\r\n                    }"\r\n                value="" name="query" class="inputField fontSize-h4"/>\r\n            <button tabindex="-1" data-bind="visible: state.query, event: { mousedown: resetQuery }, enterKey: resetQuery" type="button" class="btn primary circle small transparent searchReset">\r\n                <span class="iconfont cross"></span>\r\n            </button>\r\n            <div class="offScreen" role="log" aria-live="polite" data-bind="text: state.searchStatus"></div>\r\n        </div>\r\n        <div class="infoLine"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n\r\n        <swx-expressionitems-picker params="tab: state.selectedTab, item: state.selectedItem, isVisible: state.isOpened, eventEmitter: params.eventEmitter"></swx-expressionitems-picker>\r\n\r\n        <div class="infoLine"></div>\r\n\r\n        <div class="navigationTabs">\r\n            <div class="tabs" data-bind="css: state.tabsCss, keyboardNavigation: { itemSelector: \'.tab-item\' }, enterKey: handleMouseEvent">\r\n                <span class="prev" data-bind="event: { click: prevPage },\r\n                                              l10n_attr: {\r\n                                                  \'title\': \'expressionPicker_prevPage\',\r\n                                                  \'aria-label\': \'expressionPicker_prevPage\'\r\n                                              }">\r\n                    <span class="tab"></span>\r\n                </span>\r\n                <span class="tabsWrapper">\r\n                    <span class="container" role="menu"\r\n                          data-bind="template: { name: \'tabs-page-template\', foreach: state.pagedTabs, as: \'page\'  }"></span>\r\n                </span>\r\n                <span class="next" data-bind="event: { click: nextPage },\r\n                                              l10n_attr: {\r\n                                                  \'title\': \'expressionPicker_nextPage\',\r\n                                                  \'aria-label\': \'expressionPicker_nextPage\'\r\n                                              }">\r\n                    <span class="tab"></span>\r\n                </span>\r\n            </div>\r\n\r\n            \x3c!-- ko if: state.storeEnabled --\x3e\r\n            <div class="store iconfont add" data-bind="event: {click: showStore}, enterKey: showStore,\r\n                                          l10n_attr: {\r\n                                              \'title\': \'expressionPicker_storeTab_title\',\r\n                                              \'aria-label\': \'expressionPicker_storeTab_title\'\r\n                                          }" tabindex="0"></div>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n\r\n<script type="text/html" id="tabs-page-template">\r\n    <span class="tabPage"\r\n          data-bind="template: { name: \'tab-template\', foreach: page.tabs, as: \'tab\' }"></span>\r\n<\/script>\r\n\r\n<script type="text/html" id="tab-template">\r\n    <span data-bind="attr: {\r\n            \'data-name\': tab.id,\r\n            \'title\': tab.title,\r\n            \'aria-label\': $parents[1].selectedTabAriaLabel(tab)\r\n            }"\r\n          aria-live="polite" role="menuitem" class="tab-item">\r\n        <span data-bind="css: \'tab \'+tab.htmlClass() + ($parents[1].state.selectedTab().id() === tab.id() ? \' active\' : \'\')">\r\n            <img data-bind="attr: {src: tab.thumbnailUrl()}"/>\r\n        </span>\r\n    </span>\r\n<\/script>\r\n'})),define("ui/components/chat/pes/expressionPicker",["require","exports","module","ui/components/chat/pes/expressionPickerController","ui/viewModels/chat/pes/expressionPicker","swx-service-locator-instance","swx-constants","vendor/knockout","constants/components","text!views/chat/pes/expressionPicker.html"],(function(e,t){var n=e("ui/components/chat/pes/expressionPickerController"),i=e("ui/viewModels/chat/pes/expressionPicker"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("vendor/knockout")
	t.name=e("constants/components").chat.EXPRESSION_PICKER,t.template=e("text!views/chat/pes/expressionPicker.html"),t.viewModel={createViewModel:function(e,t){var s,c=r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.OPTIMIZE_SPACE_FOR_CC),l=n.build(),u=t.element,d=a.dataFor(u)
	return c&&u.classList.add("Mode--conversationControl"),(s=i.build({isDisabled:e.isDisabled,eventEmitter:l},u)).init(),l.init(s,d),s}}})),define("ui/viewModels/chat/pes/itemsPicker",["require","lodash-compat","swx-utils-common","swx-utils-common","vendor/knockout","browser/document","utils/common/eventHelper","utils/common/stateMixin","swx-focus-handler"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").async,i=e("swx-utils-common").builderMixin,r=e("vendor/knockout"),o=e("browser/document"),a=e("utils/common/eventHelper"),s=e("utils/common/stateMixin"),c=e("swx-focus-handler")
	function l(e,t){var i,a,l=this
	function u(){n.execute((function(){t.adjustToRTLLayout()}),null,!0)}l.params=s.overrideDefaults({},l.getDefaultParams(),e),a=l.params.item.subscribe((function(e){var t
	e&&(t=o.activeElement)&&c.get().addFocusRequestToQueue(t)})),l.params.isVisible()?u():i=l.params.isVisible.subscribe((function(e){e&&(i.dispose(),u())})),l.showEmptyTabMessage=r.computed((function(){return 0===l.params.tab().packs().length})),l.tabStyleOverride=r.computed((function(){return l.params.tab().styleOverride?l.params.tab().styleOverride():""})),l.emptyTabMessageKey=r.computed((function(){return r.utils.unwrapObservable(l.params.tab().emptyTabMessageKey)})),l.init=function(){t.init()},l.dispose=function(){i&&i.dispose(),a.dispose(),l.showEmptyTabMessage.dispose(),l.tabStyleOverride.dispose(),l.emptyTabMessageKey.dispose(),t.dispose()}}return l.prototype.getDefaultParams=function(){return{tab:{packs:r.observableArray(),emptyTabMessageKey:"no_key"},item:null,isVisible:!0,eventEmitter:a.emptyEmitter}},t.assign(l.prototype,s),t.assign(l,i),l})),define("text!views/chat/pes/itemsPicker.html",[],(function(){return'<div class="picker"\r\n     data-bind="css: tabStyleOverride, keyboardNavigation: { itemSelector: \'li.picker-item\', persistSelection: false }">\r\n\r\n    \x3c!-- ko if: showEmptyTabMessage --\x3e\r\n    <span class="mrutext"\r\n          data-bind="l10n: {key: params.tab().emptyTabMessageKey() }"></span>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <ul class="picker-list scrollViewport scrollViewportV"\r\n        data-bind="template: {name: \'pack-template\', foreach: params.tab().packs, as: \'pack\'}" tabindex="-1">\r\n    </ul>\r\n</div>\r\n\r\n<script type="text/html" id="pack-template">\r\n    \x3c!-- ko if: pack.title --\x3e\r\n    <span class="tile">\r\n        <span class="tileName"><h4 data-bind="text:pack.title"></h4></span>\r\n    </span>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <li data-bind="attr: { \'data-name\': pack.id, \'aria-label\': pack.ariaLabel }"\r\n        role="listitem" class="picker-pack">\r\n        <ul class="picker-pack-items"\r\n            data-bind="template: { name: \'item-template\', foreach: pack.items, as: \'item\' }"></ul>\r\n    </li>\r\n<\/script>\r\n\r\n<script type="text/html" id="item-template">\r\n    <li data-bind="attr: { \'data-id\': item.id, \'aria-label\': item.description, style: item.thumbnailStyle}, css: item.type() + \' \' + (item.htmlClass && item.htmlClass() || \'\') "\r\n        role="listitem" class="picker-item">\r\n\r\n        \x3c!-- ko template: { name: \'item-template-\'+item.type() } --\x3e\r\n        \x3c!-- /ko --\x3e\r\n<\/script>\r\n\r\n<script type="text/html" id="item-template-emoticon">\r\n    <span\r\n        data-bind="css: item.staticHtmlClass, attr: {\'aria-label\': item.description}"\r\n        class="emoticon">\r\n            <span class="emoSprite"></span>\r\n            <canvas data-bind="attr: { \'data-item-id\': item.id }"></canvas>\r\n    </span>\r\n<\/script>\r\n\r\n<script type="text/html" id="item-template-flik">\r\n    <span data-bind="css: item.thumbnailClass" class="moji">\r\n        <span class="mojimask small"></span><span class="mojiThumbnail"></span>\r\n        <a class="actionButtons iconfont send mojisend"\r\n           data-bind="\r\n            visible: $parents[1].params.item() && (item.id() === $parents[1].params.item().id() )"\r\n           tabindex="-1"></a>\r\n    </span>\r\n<\/script>\r\n\r\n<script type="text/html" id="item-template-image">\r\n    <img data-bind="attr: {src: item.thumbnail}"/>\r\n<\/script>\r\n\r\n<script type="text/html" id="item-template-message">\r\n    <span class="message" data-bind="text: item.text"></span>\r\n<\/script>\r\n'})),define("ui/components/chat/pes/itemsPicker",["require","exports","module","ui/viewModels/chat/pes/itemsPicker","utils/common/scroll","browser/dom","constants/components","text!views/chat/pes/itemsPicker.html"],(function(e,t){var n=e("ui/viewModels/chat/pes/itemsPicker"),i=e("utils/common/scroll"),r=e("browser/dom")
	t.name=e("constants/components").chat.EXPRESSION_ITEMS_PICKER,t.template=e("text!views/chat/pes/itemsPicker.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=i.build(r.getElement(".picker",o)),s=new n(e,a,o)
	return s.init(),s}}})),define("ui/viewModels/chat/pes/itemRoster",["require","lodash-compat","browser/dom","swx-utils-common","utils/common/stateMixin","utils/common/eventHelper","services/pes/constants","vendor/knockout"],(function(e){var t=e("lodash-compat"),n=e("browser/dom"),i=e("swx-utils-common").async,r=e("utils/common/stateMixin"),o=e("utils/common/eventHelper"),a=e("services/pes/constants"),s=e("vendor/knockout")
	function c(e,t){var o,c=this
	c.params=r.overrideDefaults({},c.getDefaultParams(),e),c.playState=s.computed((function(){return c.params.itemStartPlayRequest()>0})),o=c.params.itemStartPlayRequest.subscribe((function(e){i.execute((function(){var i
	e>0?function(){var e=n.getElement("video.moji.preview",t)
	if(!e||c.params.item()&&c.params.item().type()!==a.itemTypes.moji.id)return
	function i(e){c.params.eventEmitter.emit(e)}function r(){e.removeEventListener("ended",r),e.removeEventListener("pause",o),i("handlePlaybackPaused")}function o(){e.removeEventListener("ended",r),e.removeEventListener("pause",o),i("handlePlaybackPaused")}e.play(),e.addEventListener("ended",r,!1),e.addEventListener("pause",o,!1)}():(i=n.getElement("video.moji.preview",t))&&i.pause&&i.pause()}),null,!0)})),c.init=function(){},c.dispose=function(){o.dispose(),c.playState.dispose()}}return c.prototype.getDefaultParams=function(){return{item:{},itemStartPlayRequest:0,eventEmitter:o.emptyEmitter}},t.assign(c.prototype,r),c})),define("text!views/chat/pes/itemRoster.html",[],(function(){return'<div class="wrapper roster">\r\n    \x3c!-- ko if: params.item() && params.item().type() === \'emoticon\' --\x3e\r\n    <div class="largeAllowed large wrapper">\r\n        <span data-bind="css: playState() ? params.item().animatedExtraLargeHtmlClass : params.item().staticExtraLargeHtmlClass" class="emoticon">\r\n            <span class="emoSprite"></span>\r\n            <canvas data-draw-state="transient" data-bind="attr: { \'data-item-id\': params.item().id, \'data-is-animated\': playState() }"></canvas>\r\n        </span>\r\n    </div>\r\n    <div class="info">\r\n        <p data-bind="text: params.item().description" class="smaller name"></p>\r\n\r\n        <p data-bind="text: params.item().shortcut" class="smaller text"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: params.item() && params.item().type() === \'flik\' --\x3e\r\n    <div class="large wrapper">\r\n        <span data-bind="css: params.item().keyframeClass" class="moji preview">\r\n            <span class="keyframe" data-bind="css: {hide: playState}"></span>\r\n            <video class="moji preview" data-bind="css: {hide: !playState()}, attr: { src: params.item().contentUrl }"\r\n                   tabindex="-1"></video>\r\n            <span class="mojimask preview"></span>\r\n        </span>\r\n    </div>\r\n    <div class="info">\r\n        <p data-bind="text: params.item().pickerTitle" class="smaller name"></p>\r\n\r\n        <p data-bind="text: params.item().copyright" class="smaller text"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    \x3c!-- ko if: !(params.item() && params.item().type) || ([\'emoticon\', \'flik\'].indexOf(params.item().type()) === -1) --\x3e\r\n    <div class="large wrapper">\r\n        <p data-bind="l10n: {\'key\': \'emoticonPicker_heading_label\'}" class="smaller name"></p>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n\r\n</div>\r\n'})),define("ui/components/chat/pes/itemRoster",["require","exports","module","ui/viewModels/chat/pes/itemRoster","constants/components","text!views/chat/pes/itemRoster.html"],(function(e,t){var n=e("ui/viewModels/chat/pes/itemRoster")
	t.name=e("constants/components").chat.EXPRESSION_ITEM_ROSTER,t.template=e("text!views/chat/pes/itemRoster.html"),t.viewModel={createViewModel:function(e,t){var i=t.element,r=new n(e,i)
	return r.init(),r}}})),define("ui/viewModels/chat/conversationShareLink",["require","lodash-compat","utils/common/eventMixin","vendor/knockout","swx-constants","swx-service-locator-instance","utils/common/cafeObservable","swx-i18n","ui/telemetry/actions/actionNames","utils/common/outsideClickHandler","swx-utils-chat"],(function(e){var t=e("lodash-compat"),n=e("utils/common/eventMixin"),i=e("vendor/knockout"),r=e("swx-constants").COMMON,o=r.telemetry.conversationOrigin,a=e("swx-service-locator-instance").default,s=e("utils/common/cafeObservable"),c=e("swx-i18n").localization,l=e("ui/telemetry/actions/actionNames"),u=e("utils/common/outsideClickHandler"),d=e("swx-utils-chat").conversation,p=r.events
	function f(e){var t,n=this,f=a.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.SPACES),m=a.resolve(r.serviceLocator.ACTION_TELEMETRY)
	function h(){n.isTooltipOpened(!1),u.remove("conversationShareLink")}n.isTooltipOpened=i.observable(!1),n.conversationModel=e.conversationModel,n.isJoiningEnabled=n.conversationModel.isJoiningEnabled?s.newObservableProperty(n.conversationModel.isJoiningEnabled):i.observable(!0),n.telemetryContext=((t=(t=e.telemetryContext)||{}).conversationOrigin=d.isGuestHostConversation(n.conversationModel.conversationId)?o.GUEST_HOST:o.NORMAL,t.participantsCount=n.conversationModel.participantsCount(),t),n.share=function(){n.isJoiningEnabled()&&!n.conversationModel.uri&&n.dispatchEvent(p.conversation.SHARED,(function(e){n.conversationModel=e,n.isJoiningEnabled(f),n.conversationModel.uri.get()})),n.isTooltipOpened(!0),u.add("conversationShareLink",h),m.recordAction(l.invites.shareButton,e.telemetryContext)},n.joiningDisabledTextStart=function(){return c.fetch({key:"spaces_joining_disabled_message_start"})},n.joiningDisabledAnchorText=function(){return c.fetch({key:"spaces_joining_disabled_anchor_text"})},n.joiningDisabledTextEnd=function(){return c.fetch({key:"spaces_joining_disabled_message_end"})},n.showSettings=function(){n.dispatchEvent(p.conversation.OPEN_PROFILE,{editTopic:!1},n.DIRECTION.PARENT),h()},n.dispose=function(){n.isTooltipOpened()&&h()}}return t.assign(f.prototype,n),f})),define("text!views/chat/conversationShareLink.html",[],(function(){return'<div class="conversationShareLink">\r\n    <swx-button params="cssClass:\'shareButton circle classicShare\', disabled:false, action: share, textKey: \'action_button_share_conversation\', icon: \'share\'"></swx-button>\r\n\r\n    <swx-button params="cssClass:\'shareButton circle narrowShare\', disabled:false, action: share, textKey: \'share_on_skype_share_button\', icon: \'share\'"></swx-button>\r\n    \x3c!-- ko if: isTooltipOpened --\x3e\r\n    <div class="tooltip popup arrow down">\r\n        \x3c!-- <span class="arrow"></span> --\x3e\r\n        \x3c!-- ko if: isJoiningEnabled --\x3e\r\n        <span class="tooltipLabel fontSize-p" data-bind="l10n: { key: \'spaces_tooltip_text\'}"></span>\r\n        <swx-invite-link class="invite-link invite-link-narrow" params="topic: conversationModel.topic, uri: conversationModel.uri, telemetryContext: telemetryContext"></swx-invite-link>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko ifnot: isJoiningEnabled --\x3e\r\n        <div class="tooltipLabel fontSize-p">\r\n            <span data-bind="html:joiningDisabledTextStart()">\r\n            </span>\r\n\r\n            <a href="#" data-bind="click:showSettings, text:joiningDisabledAnchorText()"></a>\r\n\r\n            <span data-bind="html:joiningDisabledTextEnd()">\r\n            </span>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/conversationShareLink",["require","exports","module","vendor/knockout","ui/viewModels/chat/conversationShareLink","constants/components","text!views/chat/conversationShareLink.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/conversationShareLink")
	t.name=e("constants/components").chat.CONVERSATION_SHARE_LINK,t.template=e("text!views/chat/conversationShareLink.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e)
	return r.setContext(n.dataFor(t.element)),r}}})),define("ui/viewModels/chat/selectedParticipantsConversation",["require","vendor/knockout","swx-cafe-application-instance","swx-pubsub-instance","swx-constants","ui/telemetry/telemetryClient","experience/settings","swx-constants"],(function(e){var t=e("vendor/knockout"),n=e("swx-cafe-application-instance"),i=e("swx-pubsub-instance").default,r=e("swx-constants").COMMON,o=e("ui/telemetry/telemetryClient"),a=e("experience/settings"),s=e("swx-constants").COMMON.events
	return function(){var e,c,l=this
	function u(t){if(e)try{e.cancel("Another search triggered")}catch(u){o.get().sendEvent(a.telemetry.uiTenantToken,r.telemetry.promiseInvalidStateException.TYPE,{feature:r.telemetry.promiseInvalidStateException.feature.GROUP_SEARCH,exception:_stringify(u)})}var i,s,c;(l.matchingConversations([]),0!==t.length)&&(1===t.length?(i=t[0],s=i.getPerson(),c=n.get().conversationsManager.getConversation(s),l.matchingConversations([c])):function(t){var i,r,o
	function a(e){return e.id()}function s(e,t){i.supportedKeywords().indexOf(e)<0||(i.keywords[e]=t)}function c(){e===o&&(e=null,l.matchingConversations(i.results().map((function(e){return e.result}))))}r=t.map(a).join(" "),i=n.get().conversationsManager.createSearchQuery(),s("participantsByIds",r),o=i.getMore().then(c),e=o}(t))}l.init=function(e){c=e.contacts.subscribe(u),l.matchingConversations=t.observableArray(),l.hasMatchingConversations=t.computed((function(){return l.matchingConversations().length>0}))},l.dispose=function(){l.hasMatchingConversations.dispose(),c.dispose()},l.navigateToConversation=function(e){i.publish(s.navigation.OPEN_CONVERSATION,{model:e})}}})),define("text!views/chat/selectedParticipantsConversation.html",[],(function(){return'<div class="jumpToConversation" data-bind="css:{hide:!hasMatchingConversations()}">\r\n    <div class="topic">\r\n        <p data-bind="l10n: {key: \'label_jumpToConversation\'}">Jump to conversation</p>\r\n    </div>\r\n    <div data-bind="foreach: matchingConversations">\r\n        <swx-conversation-card params="conversationModel:$data, action:$parent.navigateToConversation"></swx-conversation-card>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/selectedParticipantsConversation",["require","exports","module","ui/viewModels/chat/selectedParticipantsConversation","constants/components","text!views/chat/selectedParticipantsConversation.html"],(function(e,t){var n=e("ui/viewModels/chat/selectedParticipantsConversation")
	t.name=e("constants/components").chat.SELECTED_PARTICIPANTS_CONVERSATION,t.template=e("text!views/chat/selectedParticipantsConversation.html"),t.viewModel={createViewModel:function(e){var t=new n
	return t.init(e),t}}})),define("ui/viewModels/chat/conversationCard",["require","utils/common/cafeObservable"],(function(e){var t=e("utils/common/cafeObservable")
	return function(e){var n=this,i=e.conversationModel
	n.topic=t.newObservableProperty(i.topic),n.isGroupConversation=t.newObservableProperty(i.isGroupConversation),n.avatarUrl=t.newObservableProperty(i.avatarUrl),n.statusClassName=null,n.action=function(){e.action&&e.action(i)}}}))
	define("text!views/chat/conversationCard.html",[],(function(){return'<div class="participant" role="button" data-bind="click: action">\r\n    <swx-avatar-deprecated params="isGroupAvatar: isGroupConversation, avatar: avatarUrl, status: statusClassName, displayName: topic" class="avatar"></swx-avatar-deprecated>\r\n    <div class="text">\r\n        <span class="tile">\r\n            <span class="tileName">\r\n                <h4 data-bind="text: topic"></h4>\r\n            </span>\r\n        </span>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/conversationCard",["require","exports","module","ui/viewModels/chat/conversationCard","constants/components","text!views/chat/conversationCard.html"],(function(e,t){var n=e("ui/viewModels/chat/conversationCard")
	t.name=e("constants/components").chat.CONVERSATION_CARD,t.template=e("text!views/chat/conversationCard.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),define("telemetry/chat/mediaPickerTelemetry",["require","exports","module","swx-constants","swx-service-locator-instance","experience/settings","utils/common/styleModeHelper","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("experience/settings"),o=e("utils/common/styleModeHelper"),a=n.telemetry.mediaBarEvent,s=e("ui/telemetry/telemetryClient")
	function c(){var e=this,t=n.telemetry.NOT_AVAILABLE,c=i.resolve(n.serviceLocator.FEATURE_FLAGS)
	function l(){e.data={paperclipButtonClicked:t,filePickerClicked:t}}e.publish=function(){e.data.mediaBarV2Enabled=c.isFeatureOn(n.featureFlags.MEDIA_BAR_V2_ENABLED),e.data.styleMode=o.get().currentMode()
	var t=a.TYPE,i=function(e){for(var t in e)e.hasOwnProperty(t)&&!("string"==typeof e[t]||e[t]instanceof String)&&(e[t]=e[t]+"")
	return e}(e.data)
	s.get().sendEvent(r.telemetry.chatTenantToken,t,i),l()},l()}t.build=function(){return new c}})),define("ui/viewModels/chat/filePicker",["require","vendor/knockout","swx-i18n","swx-constants","browser/dom","swx-service-locator-instance","telemetry/chat/mediaPickerTelemetry","utils/common/eventMixin","lodash-compat","swx-browser-detect","swx-focus-handler"],(function(e){var t=e("vendor/knockout"),n=e("swx-i18n").localization,i=e("swx-constants").COMMON,r=e("browser/dom"),o=e("swx-service-locator-instance").default,a=e("telemetry/chat/mediaPickerTelemetry"),s=e("utils/common/eventMixin"),c=e("lodash-compat"),l=e("swx-browser-detect").default,u=e("swx-focus-handler")
	function d(e,s,d){var p=this,f=o.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.FILE_TRANSFER_ENABLED),m=c.isFunction(e.text)?e.text():e.text
	function h(){var e=r.getElement(".fileInput",s.element)
	l.getBrowserInfo().browserName===l.BROWSERS.FIREFOX?u.get().addFocusRequestToQueue(e):e.click()}function v(){var e=r.getElement(".swx .chat .inputField",r.getParentMatching(d,".swx .chat"))
	e&&u.get().addFocusRequestToQueue(e)}p.conversationModel=e.conversationModel,m&&(p.text=n.fetch({key:m})),p.isDisabled=e.isDisabled,p.iconCssClass=t.computed((function(){var t={},n=c.isFunction(e.icon)?e.icon():e.icon
	n&&(t.iconfont=!0,t[n]=!0)
	return t}),this),p.isFocused=t.observable(!1),p.supportedFileTypes=f?"":i.fileTransfer.SUPPORTED_PICTURE_TYPES,p.mediaPickerTelemetryEvent=e.mediaPickerTelemetryEvent||a.build(),p.init=function(){p.registerEvent(i.events.mediaPicker.FILE_PICKER_SELECTED,h)},p.onOpenDialog=function(){return p.mediaPickerTelemetryEvent.data.filePickerClicked=!0,p.mediaPickerTelemetryEvent.publish(),p.dispatchEvent(i.events.mediaPicker.CLOSE_PICKER,p.DIRECTION.PARENT),p.isFocused(!1),!0},p.processFiles=function(e,t){p.conversationModel.fileTransferService.send(t.target.files),t.target.value=null,v()},p.dispose=function(){p.iconCssClass.dispose()}}return c.assign(d.prototype,s),{build:function(e,t){return new d(e,t)}}})),define("text!views/chat/filePicker.html",[],(function(){return'<div class="swx-file-picker-btn filePicker" data-bind="css: {disabled: isDisabled, focused: isFocused}">\r\n    <label data-bind="attr: {\'title\': text}" aria-relevant="all">\r\n        <span class="icon" data-bind="css: iconCssClass"></span>\r\n        <span id="filePickerLabel" class="text" data-bind="l10n: {key: text}, attr: {\'aria-label\': text}"></span>\r\n        <input type="file" class="fileInput" multiple="multiple" role="button" aria-labelledby="filePickerLabel"\r\n               data-bind="event: {change: processFiles},\r\n                attr: {\'title\': text, accept:supportedFileTypes},\r\n                hasFocus: isFocused,\r\n                click: onOpenDialog,\r\n                disable: isDisabled"/>\r\n    </label>\r\n</div>\r\n'})),define("ui/components/chat/filePicker",["require","exports","module","ui/viewModels/chat/filePicker","vendor/knockout","constants/components","text!views/chat/filePicker.html"],(function(e,t){var n=e("ui/viewModels/chat/filePicker"),i=e("vendor/knockout")
	t.name=e("constants/components").chat.FILE_PICKER,t.template=e("text!views/chat/filePicker.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e,t)
	return r.setContext(i.dataFor(t.element)),r.init(),r}}})),define("ui/viewModels/chat/notificationsCenter",[],(function(){return function(){}})),define("text!views/chat/notificationsCenter.html",[],(function(){return"<div>\r\n    List of Notifications\r\n</div>\r\n"})),define("ui/components/chat/notificationsCenter",["require","exports","module","ui/viewModels/chat/notificationsCenter","constants/components","text!views/chat/notificationsCenter.html"],(function(e,t){var n=e("ui/viewModels/chat/notificationsCenter")
	t.name=e("constants/components").chat.NOTIFICATIONS_CENTER,t.template=e("text!views/chat/notificationsCenter.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),define("ui/viewModels/chat/notificationsMenuItem",["require","swx-pubsub-instance","swx-constants","swx-i18n"],(function(e){var t=e("swx-pubsub-instance").default,n=e("swx-constants").COMMON.events,i=e("swx-i18n").localization
	return function(e){var r=this,o=!1
	r.id="menuItem-notifications",r.text=i.fetch({key:"notificationsPage_text_menuLink"}),r.isDisabled=!!e.isDisabled&&e.isDisabled,r.onClick=function(){o=!o,t.publish(n.navigation.NOTIFICATIONS_CENTER,o)}}})),define("text!views/chat/notificationsMenuItem.html",[],(function(){return'<a role="button" class="navItem"\r\n   data-bind="event: {mousedown: onClick}, attr: { id: id }, visible: !isDisabled()">\r\n        <span class="icon">\r\n            <span class="iconfont messageUnread"></span>\r\n        </span>\r\n        <span class="text">\r\n            <h4 data-bind="text: text"></h4>\r\n        </span>\r\n</a>\r\n'})),define("ui/components/chat/notificationsMenuItem",["require","exports","module","ui/viewModels/chat/notificationsMenuItem","constants/components","text!views/chat/notificationsMenuItem.html"],(function(e,t){var n=e("ui/viewModels/chat/notificationsMenuItem")
	t.name=e("constants/components").chat.NOTIFICATIONS_MENU_ITEM,t.template=e("text!views/chat/notificationsMenuItem.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),define("ui/viewModels/chat/notificationsToggleButton",["require","exports","module","vendor/knockout","notifications/settings","swx-constants","ui/telemetry/actions/actionNames","swx-service-locator-instance","swx-i18n"],(function(e,t){var n=e("vendor/knockout"),i=e("notifications/settings"),r=e("swx-constants").COMMON,o=e("ui/telemetry/actions/actionNames"),a=e("swx-service-locator-instance").default,s=e("swx-i18n").localization
	function c(e){var t=this
	function c(e,t){a.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(e,t)}t.notificationsMuted=i.chatNotificationsMuted,t.toggleNotificationsTitle=n.computed((function(){return s.fetch({key:t.notificationsMuted()?"turnOnChatNotifications_tooltip":"turnOffChatNotifications_tooltip"})})),t.isDisabled=e.isDisabled?e.isDisabled:n.observable(!1),t.toggleNotifications=function(){i.chatNotificationsMuted()?c(o.chat.notificationsEnabled):c(o.chat.notificationsDisabled),i.chatNotificationsMuted(!i.chatNotificationsMuted())},t.dispose=function(){t.toggleNotificationsTitle.dispose()}}t.build=function(e){return new c(e)}})),define("text!views/chat/notificationsToggleButton.html",[],(function(){return'<button data-bind="visible: !isDisabled(), click: toggleNotifications, attr: { title: toggleNotificationsTitle }" class="NotificationsSwitcher btn primary circle" type="button" data-preventdefault="false">\r\n    <span class="iconfont" data-bind="css: { notificationsMuted: notificationsMuted }, text: toggleNotificationsTitle"></span>\r\n</button>\r\n'})),define("ui/components/chat/notificationsToggleButton",["require","exports","module","ui/viewModels/chat/notificationsToggleButton","constants/components","text!views/chat/notificationsToggleButton.html"],(function(e,t){var n=e("ui/viewModels/chat/notificationsToggleButton")
	t.name=e("constants/components").chat.NOTIFICATIONS_TOGGLE_BUTTON,t.template=e("text!views/chat/notificationsToggleButton.html"),t.viewModel={createViewModel:function(e){return n.build(e)}}})),define("ui/viewModels/chat/uploadManager",["require","vendor/knockout","utils/common/cafeObservable"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/cafeObservable")
	return function(e){var i=this
	i.conversation=e.conversationModel,i.files=n.newObservableCollection(i.conversation.fileTransferService.files),i.isUploading=t.computed((function(){return i.files().length>0})),i.statusText=t.computed((function(){return i.files().length>1?"Sending "+i.files().length+" files":1===i.files().length?"Sending "+i.files()[0].name():""})),i.dispose=function(){i.isUploading.dispose(),i.statusText.dispose()}}})),define("text!views/chat/uploadManager.html",[],(function(){return'<div data-bind="visible: isUploading">\r\n    <p class="status-text" data-bind="text: statusText"></p>\r\n</div>'})),define("ui/components/chat/uploadManager",["require","exports","module","ui/viewModels/chat/uploadManager","constants/components","text!views/chat/uploadManager.html"],(function(e,t){var n=e("ui/viewModels/chat/uploadManager")
	t.name=e("constants/components").chat.UPLOAD_MANAGER,t.template=e("text!views/chat/uploadManager.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-flags-service-api/lib/flagsService",["require","exports","lodash-compat","reqwest","swx-browser-globals"],e)}((function(e,t){var n=e("lodash-compat"),i=e("reqwest"),r=e("swx-browser-globals"),o=function(){function e(e){this.$unit={_resetGlobalState:this._resetGlobalState.bind(this)},this.apiUrl=e,this._resetGlobalState()}return e.prototype.read=function(e,t){return this.getAllFlags(t).then((function(t){return n.includes(t,e)}))},e.prototype.update=function(e,t,n){return a(t?"PUT":"DELETE",n,r.getWindow().encodeURIComponent(e.toString()),this.apiUrl).catch((function(e){if(!e||!e.status||404!==e.status)throw e}))},e.prototype._resetGlobalState=function(){var e=this
	this.getAllFlags=n.throttle((function(t){return a("GET",t,"",e.apiUrl)}),1e3,{trailing:!1})},e}()
	function a(e,t,n,o){return Promise.resolve(i.compat(function(e,t,n,i){var o=r.getWindow()
	return{dataType:"json",method:e,url:i.replace(/\/$/,"")+"/"+n,crossOrigin:!0,headers:{"X-Skypetoken":o.encodeURIComponent(t)}}}(e,t,n,o)))}t.FlagsService=o,t.build=function(e){return new o(e)}})),define("swx-flags-service-api",["swx-flags-service-api/lib/flagsService"],(function(e){return e})),define("text!views/chat/downloadFileConfirmationDialog.html",[],(function(){return'<div class="downloadFileConfirmationDialogContent">\r\n    <p class="description" data-bind="text:text"></p>\r\n    \x3c!-- ko if:isSafetype --\x3e\r\n    <p class="donotshowagain">\r\n        <input type="checkbox" data-bind="checked:stopShowingAgain"/>\r\n        <span data-bind="l10n:{key:\'file_transfer_download_dialog_do_not_ask_checkbox\'}"></span>\r\n    </p>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/modalDialog/downloadFileConfirmationDialog",["require","exports","module","vendor/knockout","swx-constants","experience/settings","swx-i18n","ui/modalDialog/confirmationDialog","text!views/chat/downloadFileConfirmationDialog.html","swx-flags-service-api","swx-cafe-application-instance"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-constants").COMMON,r=e("experience/settings"),o=e("swx-i18n").localization,a=e("ui/modalDialog/confirmationDialog"),s=e("text!views/chat/downloadFileConfirmationDialog.html"),c=e("swx-flags-service-api"),l=e("swx-cafe-application-instance")
	function u(e,t,i){var r=i?"file_transfer_download_safe_file_dialog_text":"file_transfer_download_unsafe_file_dialog_text"
	this.isSafetype=i,this.text=o.fetch({key:r,params:{filename:e,author:t}}),this.stopShowingAgain=n.observable(!1)}t.start=function(e,t,n,d){var p=new u(e,t,d),f=d?"file_transfer_download_safe_file_dialog_title":"file_transfer_download_unsafe_file_dialog_title"
	function m(e){c.build(r.flagsApiUrl).update(i.fileTransfer.FILE_DOWNLOAD_WARNING_FLAG_API_ID,!0,e)}a.build({title:o.fetch({key:f}),content:s,contentViewModel:p,onConfirm:function(){n&&n()
	if(p.stopShowingAgain())return l.get().signInManager._skypeToken().then(m)},confirmButtonTitle:o.fetch({key:"file_transfer_download_dialog_confirm_button_title"})}).show()}})),define("ui/viewModels/chat/fileTransferActivityActions",["require","exports","module","lodash-compat","swx-enums","swx-constants","swx-i18n","vendor/knockout","experience/settings","browser/dom","swx-cafe-application-instance","swx-flags-service-api","swx-browser-detect","ui/modalDialog/downloadFileConfirmationDialog"],(function(e,t){var n=e("lodash-compat"),i=e("swx-enums"),r=e("swx-constants").COMMON,o=e("swx-i18n").localization,a=e("vendor/knockout"),s=e("experience/settings"),c=e("browser/dom"),l=e("swx-cafe-application-instance"),u=e("swx-flags-service-api"),d=e("swx-browser-detect").default,p=e("ui/modalDialog/downloadFileConfirmationDialog")
	function f(e){if(!e.message)throw new Error("Message is not provided")
	if(!e.onabort)throw new Error("Abort handler is not provided")
	var t=this,f=e.message,m=e.onabort
	t.fileUri=f.fileUri,t.fileName=f.fileName,t.isPending=a.computed((function(){return f.status()===i.activityStatus.Pending})),t.errorMessage=a.observable(),t.isFailed=a.computed((function(){var e=f.status()===i.activityStatus.Failed,n=f.shouldAbort()
	return t.errorMessage(o.fetch({key:"file_transfer_upload_failed"})),f.model.fileSize>r.fileTransfer.MAX_FILE_SIZE&&t.errorMessage(o.fetch({key:"file_transfer_upload_too_large_warning"})),e&&!n})),t.downloadButtonTitle=o.fetch({key:"file_transfer_download_button_title",params:{filename:f.model.fileName}}),t.abort=function(){m()},t.downloadFile=function(){var e=s.cloudFileSharing.unsafeFileTypes.split(","),i=!n.any(e,(function(e){return(e=e.trim().toLowerCase())===f.fileType||e==="."+f.fileType}))
	return l.get().signInManager._skypeToken().then((function(e){u.build(s.flagsApiUrl).read(r.fileTransfer.FILE_DOWNLOAD_WARNING_FLAG_API_ID,e).then(o)}))
	function o(e){e&&i?m():p.start(f.fileName,f.author.displayName(),a,i)}function a(){m()}function m(){var e=c.createElement("a")
	if(e.download=t.fileName,e.href=t.fileUri(),!d.getBrowserInfo().isIeEngine){var n=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})
	return e.dispatchEvent(n)}e.click()}},t.progressIndicatorBG=a.computed((function(){var e=f.progress(),t="#FFF"
	return"linear-gradient("+(e<=50?-90:90)+"deg, transparent "+(0===e?0:50)+"%, "+(e<=50?"#333":t)+" 50%),linear-gradient("+(Math.floor(3.6*e)+90)+"deg, "+t+" 50%, transparent 50%)"})),t.dispose=function(){t.progressIndicatorBG.dispose(),t.isPending.dispose(),t.isFailed.dispose()}}t.build=function(e){return new f(e)}})),define("text!views/chat/fileTransferActivityActions.html",[],(function(){return'\x3c!-- ko if: isPending --\x3e\r\n    <span class="progressIndicator" data-bind="style:{backgroundImage:progressIndicatorBG}"></span>\r\n    <a data-bind="click:abort, l10n_attr:{\'aria-label\':\'file_transfer_upload_cancel\', \'title\':\'file_transfer_upload_cancel\'}" role="button" tabindex="-2">\r\n        <span class="abort iconfont cancel" ></span>\r\n    </a>\r\n\x3c!-- /ko --\x3e\r\n\x3c!-- ko ifnot: isPending --\x3e\r\n    \x3c!-- ko ifnot:isFailed --\x3e\r\n    <a data-bind="click:downloadFile, attr:{title: downloadButtonTitle, \'aria-label\': downloadButtonTitle}" role="button" tabindex="-2">\r\n        <span class="download iconfont down"></span>\r\n    </a>\r\n    \x3c!-- /ko --\x3e\r\n    \x3c!-- ko if: isFailed --\x3e\r\n    <span class="failedIcon iconfont errorSad" data-bind="l10n_attr:{\'title\':\'file_transfer_upload_failed\'}"></span>\r\n    <span class="errorMessage" data-bind="html:errorMessage, attr:{\'title\':errorMessage}"></span>\r\n    \x3c!-- /ko --\x3e\r\n\x3c!-- /ko --\x3e\r\n'})),define("ui/components/chat/fileTransferActivityActions",["require","exports","module","ui/viewModels/chat/fileTransferActivityActions","constants/components","text!views/chat/fileTransferActivityActions.html"],(function(e,t){var n=e("ui/viewModels/chat/fileTransferActivityActions")
	t.name=e("constants/components").chat.FILE_TRANSFER_ACTIVITY_ACTIONS,t.template=e("text!views/chat/fileTransferActivityActions.html"),t.viewModel={createViewModel:function(e){return n.build(e)}}})),define("ui/viewModels/chat/chatInputActionPicker",["require","lodash-compat","swx-cafe-application-instance","ui/modelHelpers/personHelper","utils/common/eventMixin","vendor/knockout","swx-service-locator-instance","swx-constants","telemetry/chat/mediaPickerTelemetry","utils/common/styleModeHelper","swx-constants","utils/common/eventHelper","utils/common/outsideClickHandler","ui/modelHelpers/conversationHelper","utils/common/accessibility"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("ui/modelHelpers/personHelper"),r=e("utils/common/eventMixin"),o=e("vendor/knockout"),a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("telemetry/chat/mediaPickerTelemetry"),l=e("utils/common/styleModeHelper"),u=s.styleMode,d=e("swx-constants").KEYS,p=e("utils/common/eventHelper"),f=e("utils/common/outsideClickHandler"),m=e("ui/modelHelpers/conversationHelper"),h=e("utils/common/accessibility").narrator
	function v(e){var r,v,g,y,b=this,_=a.resolve(s.serviceLocator.FEATURE_FLAGS),E=a.resolve(s.serviceLocator.PUBSUB),w=_.isFeatureOn(s.featureFlags.SEND_CONTACT_CARD_ENABLED),S=_.isFeatureOn(s.featureFlags.PHOTO_SHARING_ENABLED),x=_.isFeatureOn(s.featureFlags.FILE_TRANSFER_ENABLED),C=!1,T="chatInputActionPicker"
	function I(){r&&t.isFunction(r.capabilities._contactSend)&&r.capabilities._contactSend.changed.off(D)}function A(){r&&t.isFunction(r.capabilities._photoSend)&&r.capabilities._photoSend.changed.off(U)}function M(){r&&t.isFunction(r.capabilities._fileSend)&&r.capabilities._fileSend.changed.off(F)}function O(){f.remove(T)}function k(){b.isActionPickerOpened(!1)}function N(e){b.isActionPickerCollapsed(!!e),b.isActionPickerCollapsed()&&k()}function P(){C||(E.subscribe(s.events.textarea.HAS_INPUT,N),C=!C)}function R(){C&&(E.unsubscribe(s.events.textarea.HAS_INPUT,N),C=!C)}function L(){var e
	if(I(),A(),M(),e=m.isOneToOneConversationWithAgent(b.conversationModel),b.isOneToOneConversationWithAgent(e),!e)return b.agentHasSendContactsCapability(!1),b.agentHasSendPhotosCapability(!1),void b.agentHasSendFilesCapability(!1);(r=b.conversationModel.participants()[0].person)&&(t.isFunction(r.capabilities._contactSend)&&r.capabilities._contactSend.changed(D),t.isFunction(r.capabilities._photoSend)&&r.capabilities._photoSend.changed(U),t.isFunction(r.capabilities._fileSend)&&r.capabilities._fileSend.changed(F))}function D(){r&&t.isFunction(r.capabilities._contactSend)&&b.agentHasSendContactsCapability(r.capabilities._contactSend())}function U(){r&&t.isFunction(r.capabilities._photoSend)&&b.agentHasSendPhotosCapability(r.capabilities._photoSend())}function F(){r&&t.isFunction(r.capabilities._fileSend)&&b.agentHasSendFilesCapability(r.capabilities._fileSend())}b.__internal={isGuestUser:i.isGuest.bind(null,n.get().personsAndGroupsManager.mePerson)},b.isActionPickerOpened=o.observable(!1).extend({rateLimit:100}),b.isActionPickerCollapsed=o.observable(!1),b.conversationModel=e.conversationModel,b.isDisabled=e.isDisabled,b.isCollapsible=e.isCollapsible,b.mediaPickerTelemetryEvent=c.build(),b.isPollsFeatureEnabled=o.observable(!1),b.isOneToOneConversationWithAgent=o.observable(!1),b.agentHasSendContactsCapability=o.observable(!1),b.canSendContactCard=o.computed((function(){return w&&!b.__internal.isGuestUser()&&(!b.isOneToOneConversationWithAgent()||b.isOneToOneConversationWithAgent()&&b.agentHasSendContactsCapability())})),b.agentHasSendPhotosCapability=o.observable(!1),b.canSendPhotos=o.computed((function(){return S&&(!b.isOneToOneConversationWithAgent()||b.isOneToOneConversationWithAgent()&&b.agentHasSendPhotosCapability())})),b.agentHasSendFilesCapability=o.observable(!1),b.canTransferFiles=o.computed((function(){return x&&(!b.isOneToOneConversationWithAgent()||b.isOneToOneConversationWithAgent()&&b.agentHasSendFilesCapability())})),b.isPhotoSharingOrFileTransferEnabled=o.computed((function(){return b.canSendPhotos()||b.canTransferFiles()})),b.filePickerIcon=o.computed((function(){if(b.canSendPhotos()&&b.canTransferFiles())return"media"
	if(b.canSendPhotos())return"picture"
	if(b.canTransferFiles())return"file"})),b.filePickerText=o.computed((function(){if(b.canSendPhotos()&&b.canTransferFiles())return"file_transfer_send_photos_and_files"
	if(b.canSendPhotos())return"button_text_filePicker"
	if(b.canTransferFiles())return"file_transfer_share_file"})),b.init=function(){b.registerEvent(s.events.mediaPicker.CLOSE_PICKER,k),b.forwardEvent(s.events.mediaPicker.POLL_BUTTON_SELECTED,b.DIRECTION.CHILD),l.get().currentMode()===u.WIDE&&P(),v=l.get().currentMode.subscribe((function(e){e===u.WIDE?P():R()})),y=b.isActionPickerOpened.subscribe((function(e){l.get().currentMode()!==u.WIDE&&(e?f.add(T,k):O())})),b.conversationModel.participants.changed(L),b.conversationModel.sendPollMessage&&(g=b.conversationModel.sendPollMessage.enabled.changed((function(e){b.isPollsFeatureEnabled(e)})))},b.triggerActionMenu=function(){var e=b.isActionPickerOpened();(function(e){e?h.announce({key:"accessibility_close_picker"}):h.announce({key:"accessibility_open_picker"})})(e),b.isActionPickerOpened(!e),b.isActionPickerOpened()&&(b.isActionPickerCollapsed(!1),b.mediaPickerTelemetryEvent.data.paperclipButtonClicked=!0)},b.handleKeyDown=function(e,t){return p.getKeyCode(t)!==d.ESCAPE||!b.isActionPickerOpened()||(t.stopPropagation(),void k())},b.dispose=function(){O(),R(),v.dispose(),y.dispose(),g&&g.dispose(),I(),A(),M(),b.conversationModel.participants.changed.off(L),r=null,b.canSendContactCard.dispose(),b.canSendPhotos.dispose(),b.canTransferFiles.dispose(),b.isPhotoSharingOrFileTransferEnabled.dispose(),b.filePickerIcon.dispose(),b.filePickerText.dispose()}}return t.assign(v.prototype,r),{build:function(e){return new v(e)}}})),define("text!views/chat/chatInputActionPicker.html",[],(function(){return"<div class=\"chatInputActionPicker\" data-bind=\"css: {collapsed: isActionPickerCollapsed(), collapsible: isCollapsible}, event: { keydown: handleKeyDown}\">\r\n    <swx-button params=\"icon: 'paperclip', cssClass: 'transparent circle actionButton',\r\n                textKey: 'button_text_chatInputActionPicker', titleKey: 'button_text_chatInputActionPicker', ariaLabelKey: 'button_text_chatInputActionPicker', ariaHasPopup: 'true', action: triggerActionMenu,\r\n                disabled: isDisabled\"></swx-button>\r\n\r\n    \x3c!-- ko if: isPollsFeatureEnabled --\x3e\r\n    <swx-poll-designer class=\"chatInputPollButton\" params=\"isDisabled: isDisabled\"></swx-poll-designer>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class=\"wrapper\">\r\n        <div class=\"menuContainer\" data-bind=\"css: {inline: !isActionPickerOpened()}\">\r\n            <ul class=\"menu fontSize-p\">\r\n                \x3c!-- ko if: isPhotoSharingOrFileTransferEnabled --\x3e\r\n                <li class=\"action btnOutline\" data-bind=\"attr: {'media-item': 'file-picker', 'data-preventdefault': 'false'}\">\r\n                    <swx-file-picker params=\"isDisabled: isDisabled, conversationModel: conversationModel, icon: filePickerIcon(), text: filePickerText(), mediaPickerTelemetryEvent: mediaPickerTelemetryEvent\"></swx-file-picker>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: canSendContactCard --\x3e\r\n                <li class=\"action btnOutline\" data-bind=\"attr:{'media-item':'send-contactCard', 'data-preventdefault': 'false'}\">\r\n                    <swx-chat-input-send-contact-card params=\"isDisabled: isDisabled, conversationModel: conversationModel, mediaPickerTelemetryEvent: mediaPickerTelemetryEvent\"></swx-chat-input-send-contact-card>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko if: isPollsFeatureEnabled --\x3e\r\n                <li class=\"action btnOutline\" data-bind=\"attr:{'media-item':'poll-button', 'data-preventdefault': 'false'}\">\r\n                    <swx-chat-input-poll-button params=\"isDisabled: isDisabled, conversationModel: conversationModel\"></swx-chat-input-poll-button>\r\n                </li>\r\n                \x3c!-- /ko --\x3e\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</div>\r\n"})),define("ui/components/chat/chatInputActionPicker",["require","exports","module","vendor/knockout","ui/viewModels/chat/chatInputActionPicker","constants/components","text!views/chat/chatInputActionPicker.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/chatInputActionPicker")
	t.name=e("constants/components").chat.CHAT_INPUT_ACTION_PICKER,t.template=e("text!views/chat/chatInputActionPicker.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e)
	return r.setContext(n.dataFor(t.element)),r.init(),r}}})),define("telemetry/chat/sendContactsTelemetry",["require","exports","module","swx-constants","ui/telemetry/telemetryClient","telemetry/utils/telemetryUtils","experience/settings","swx-utils-chat","swx-service-locator-instance","utils/common/styleModeHelper"],(function(e,t){var n=e("swx-constants").COMMON,i=n.telemetry.sendContacts,r=e("ui/telemetry/telemetryClient"),o=e("telemetry/utils/telemetryUtils"),a=e("experience/settings"),s=e("swx-utils-chat").dateTime,c=e("swx-service-locator-instance").default,l=e("utils/common/styleModeHelper")
	function u(e){var t=this,u=s.getDate(),d=n.telemetry.NOT_AVAILABLE,p=i.cta.MEDIABAR,f=c.resolve(n.serviceLocator.FEATURE_FLAGS)
	function m(){t.data={cta:p||d,action:d,participantsCount:e.participantsCount()||d,statusCodestatusCode:d,timeBeforeActionTaken:d,numberOfContacts:d}}function h(){t.data.timeBeforeActionTaken=function(e,t){return t-e}(u,s.getDate()),t.data.mediaBarV2Enabled=f.isFeatureOn(n.featureFlags.MEDIA_BAR_V2_ENABLED),t.data.styleMode=l.get().currentMode()
	var e=o.stringify(t.data)
	r.get().sendEvent(a.telemetry.chatTenantToken,i.TYPE,e),m()}t.canceled=function(){t.data.action=i.action.CANCELED,h()},t.confirmed=function(){t.data.action=i.action.CONFIRMED,h()},m()}t.build=function(e){return new u(e)}})),define("ui/viewModels/chat/chatInputSendContactCard",["require","exports","module","swx-constants","utils/common/eventMixin","lodash-compat","swx-i18n","swx-pubsub-instance","telemetry/chat/sendContactsTelemetry","utils/common/accessibility","swx-focus-handler","browser/dom"],(function(e,t){var n=e("swx-constants").COMMON,i=e("utils/common/eventMixin"),r=e("lodash-compat"),o=e("swx-i18n").localization,a=e("swx-pubsub-instance").default,s=e("telemetry/chat/sendContactsTelemetry"),c=e("utils/common/accessibility").narrator,l=e("swx-focus-handler"),u=e("browser/dom")
	function d(e){var t=this
	t.conversationModel=e.conversationModel,t.isDisabled=e.isDisabled,t.openShareControl=function(){var e=s.build(t.conversationModel),i={conversationModel:t.conversationModel,title:o.fetch({key:"send_contacts_action_title"}),description:o.fetch({key:"send_contacts_action_text"}),confirmButtonTitleKey:"action_button_send",onConfirm:function(n){var i
	n.length>0&&(t.conversationModel.sendContactInfo(n),(i=u.getElement(".swx .chat .inputField"))&&l.get().addFocusRequestToQueue(i),e.numberOfContacts=n.length,e.confirmed(),c.announce({key:"accessibility_contact_sent"}))},onCancel:function(){e.canceled()}}
	t.dispatchEvent(n.events.mediaPicker.CLOSE_PICKER,t.DIRECTION.PARENT),a.publish(n.events.shareControl.SHARE_CONTROL_SHOW,i)},t.registerEvent(n.events.mediaPicker.SEND_CONTACTS_SELECTED,t.openShareControl)}t.build=function(e){return new d(e)},r.assign(d.prototype,i)}))
	define("text!views/chat/chatInputSendContactCard.html",[],(function(){return"<button class=\"sendContactCard\" data-bind=\"click:openShareControl, l10n_attr:{'title':'contactPicker_sendContacts_title', 'aria-label':'contactPicker_sendContacts_title'}, css:{disabled: isDisabled}, attr:{disabled : isDisabled}\">\r\n    <span class=\"icon iconfont contactCard\"></span>\r\n    <span class=\"text\" data-bind=\"l10n:{'key':'contactPicker_sendContacts_title'}\"></span>\r\n</button>\r\n"})),define("ui/components/chat/chatInputSendContactCard",["require","exports","module","vendor/knockout","ui/viewModels/chat/chatInputSendContactCard","constants/components","text!views/chat/chatInputSendContactCard.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/chatInputSendContactCard")
	t.name=e("constants/components").chat.CHAT_INPUT_SEND_CONTACT_CARD,t.template=e("text!views/chat/chatInputSendContactCard.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e,t),o=n.dataFor(t.element)
	return r.setContext(o),r}}})),define("ui/viewModels/chat/shareControl",["require","exports","module","vendor/knockout","utils/common/eventMixin","swx-constants","lodash-compat","swx-constants","swx-service-locator-instance","utils/common/eventHelper"],(function(e,t){var n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-constants").COMMON,o=r.events,a=e("lodash-compat"),s=e("swx-constants").KEYS,c=e("swx-service-locator-instance").default,l=e("utils/common/eventHelper")
	function u(e){if(!e.conversationModel)throw new Error("Conversation is not provided")
	var t=this,i=null,a=e.onConfirm,u=e.onCancel,d=c.resolve(r.serviceLocator.PUBSUB)
	function p(){var e=i?i.selectedContacts().length:0
	t.isSendButtonDisabled(0===e)}t.conversationModel=e.conversationModel,t.title=e.title,t.description=e.description,t.confirmButtonTitleKey=e.confirmButtonTitleKey,t.isSendButtonDisabled=n.observable(!0),t.setParticipantProvider=function(e){t.selectedContactsSubscription&&t.selectedContactsSubscription.dispose(),i=e,t.selectedContactsSubscription=i.selectedContacts.subscribe(p),p()},t.cancel=function(){u&&u(),d.publish(o.shareControl.SHARE_CONTROL_HIDE)},t.confirm=function(){var e=[]
	i&&null!==i&&(e=i.selectedContacts()),a&&a(e),d.publish(o.shareControl.SHARE_CONTROL_HIDE)},t.handleKeyDown=function(e,t){return l.getKeyCode(t)===s.ESCAPE&&(e.cancel(),t.stopPropagation()),!0},t.forwardEvent(o.roster.PICKER_CONTACT_SELECTED),t.forwardEvent(o.roster.PICKER_CONTACT_DESELECTED),t.forwardEvent(o.roster.ROSTER_QUERY_CHANGED),t.forwardEvent(o.roster.ROSTER_QUERY_EXECUTED),t.forwardEvent(o.roster.ROSTER_SELECTION_REMOVED)}t.build=function(e){return new u(e)},a.assign(u.prototype,i)})),define("text!views/chat/shareControl.html",[],(function(){return'<div class="shareControlWrapper" data-bind="event: { keydown: handleKeyDown }">\r\n    <div class="title" data-bind="text:title"></div>\r\n\r\n    <div class="description" data-bind="text:description"></div>\r\n\r\n    <div class="headerAdd">\r\n        <swx-contact-picker-input params="setParticipantProvider: setParticipantProvider"></swx-contact-picker-input>\r\n    </div>\r\n\r\n    <swx-contact-picker params="conversation: conversationModel, className: \'headerPicker\', showJumpToConversation: false"></swx-contact-picker>\r\n\r\n    <div class="actions">\r\n       <div class="conversationButtons">\r\n            <swx-button params="cssClass: \'secondary circle\', disabled: false, textKey: \'action_button_cancel\', titleKey: \'action_button_cancel\', ariaLabelKey: \'action_button_cancel\', action: cancel"></swx-button>\r\n            <swx-button params="cssClass: \'primary circle\', disabled: isSendButtonDisabled, textKey: confirmButtonTitleKey, titleKey: confirmButtonTitleKey, ariaLabelKey: confirmButtonTitleKey, action: confirm"></swx-button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/shareControl",["require","exports","module","vendor/knockout","ui/viewModels/chat/shareControl","constants/components","text!views/chat/shareControl.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/shareControl")
	t.name=e("constants/components").chat.SHARE_CONTROL,t.template=e("text!views/chat/shareControl.html"),t.viewModel={createViewModel:function(e,t){var r=e.payload()||{},o=i.build(r),a=n.dataFor(t.element)
	return o.setContext(a),o}}})),define("ui/viewModels/chat/chatInputPollButton",["require","exports","module","swx-constants","lodash-compat","utils/common/eventMixin","swx-constants","utils/common/eventHelper"],(function(e,t){var n=e("swx-constants").COMMON,i=e("lodash-compat"),r=e("utils/common/eventMixin"),o=e("swx-constants").KEYS,a=e("utils/common/eventHelper")
	function s(e){var t=this
	t.isDisabled=e.isDisabled,t.conversationModel=e.conversationModel,t.openPollDesigner=function(e){a.getKeyCode(e)===o.ENTER&&e.preventDefault(),t.dispatchEvent(n.events.mediaPicker.POLL_BUTTON_SELECTED,null,t.DIRECTION.PARENT),t.dispatchEvent(n.events.mediaPicker.CLOSE_PICKER,null,t.DIRECTION.PARENT)}}t.build=function(e){return new s(e)},i.assign(s.prototype,r)})),define("text!views/chat/chatInputPollButton.html",[],(function(){return'<div class="chatInputPollButton">\r\n    <button class="pollButton" data-bind="click:openPollDesigner, l10n_attr:{\'title\':\'button_text_poll\'}, css:{disabled: isDisabled}, attr:{disabled : isDisabled}">\r\n        <span class="icon iconfont poll"></span>\r\n        <span class="text" data-bind="l10n:{\'key\':\'button_text_poll\'}"></span>\r\n    </button>\r\n    <swx-poll-designer params="isDisabled: isDisabled"></swx-poll-designer>\r\n</div>\r\n'})),define("ui/components/chat/chatInputPollButton",["require","exports","module","vendor/knockout","ui/viewModels/chat/chatInputPollButton","constants/components","text!views/chat/chatInputPollButton.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/chatInputPollButton")
	t.name=e("constants/components").chat.CHAT_INPUT_POLL_BUTTON,t.template=e("text!views/chat/chatInputPollButton.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e,t),o=n.dataFor(t.element)
	return r.setContext(o),r}}})),define("ui/viewModels/chat/pollDesigner",["require","lodash-compat","vendor/knockout","swx-utils-common","utils/common/eventMixin","utils/common/eventHelper","swx-utils-common","telemetry/chat/poll","swx-constants","swx-constants","browser/document","utils/common/outsideClickHandler","swx-focus-handler"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-utils-common").async,r=e("utils/common/eventMixin"),o=e("utils/common/eventHelper"),a=e("swx-utils-common").stringUtils,s=e("telemetry/chat/poll"),c=e("swx-constants").KEYS,l=e("swx-constants").COMMON,u=e("browser/document"),d=e("utils/common/outsideClickHandler"),p=e("swx-focus-handler")
	function f(e,r,f){var m,h,v=this,g=u.querySelector(".swx .chat .inputField")
	function y(){d.remove("chatInputPollButton")}function b(){i.execute((function(){v.isOpened(!1)})),y()}function _(){v.isOpened()?(v.isOpened(!1),y()):(s.pollDesignerOpened(r.conversationId),d.add("chatInputPollButton",b),v.isOpened(!0),f.focusPollQuestion())}v.isDisabled=e,v.isOpened=n.observable(!1),v.questionText=n.observable(""),v.answers=n.observableArray(),v.isMultipleChoice=n.observable(!1),v.isSendButtonEnabled=n.computed((function(){var e=!0,n=v.answers()
	return m=t.filter(n,(function(e){return t.trim(e.value()).length>0})),0===(h=t.trim(v.questionText())).length&&(e=!1),m.length<2&&(e=!1),e})),v.init=function(){v.initPollBubble(),v.registerEvent(l.events.mediaPicker.POLL_BUTTON_SELECTED,_)},v.initPollBubble=function(){v.questionText(""),f.initPollQuestion(),v.isMultipleChoice(!1),v.answers.removeAll(),v.addNewAnswer("",!0,!1),v.addNewAnswer("",!1,!1)},v.removeCurrentAnswer=function(e){var t=v.answers(),n=t.indexOf(e)
	v.answers.remove(e),2===t.length&&(t[0].allowRemove(!1),t[1].allowRemove(!1)),t[n>=1?n-1:0].focused(!0)},v.addNewAnswer=function(e,t,i){var r={value:n.observable(""),focused:n.observable(t),allowRemove:n.observable(i)}
	v.answers.push(r)},v.onPaste=function(e,t,n){var i=t.clipboardData||window.clipboardData
	t.originalEvent&&(i=i||t.originalEvent.clipboardData)
	var r=i.getData("Text"),o=!0,s="",c=function(e){return e.value}(t.target),l=function(e){return e.selectionStart}(t.target),u=function(e){return e.selectionEnd}(t.target)
	function d(e){o?function(e){return!a.isCarriageReturn(e)&&!a.isNewLine(e)&&!a.isWhiteSpace(e)}(e)&&(s+=e,o=!1):(s+=e,a.isNewLine(e)&&(o=!0))}for(var p=0;p<r.length;p++)d(r[p])
	n(a.inject(c,s,l,u))},v.onPasteQuestion=function(e,t){v.onPaste(e,t,(function(e){v.questionText(e)})),v.questionChanged(e,t)},v.onPasteAnswer=function(e,t){v.onPaste(e,t,(function(t){var n=v.answers().indexOf(e)
	v.answers()[n].value(t)})),v.onAnswerKeypress(e,t)},v.submitPoll=function(){if(v.isSendButtonEnabled()){var e={}
	e.question=h,e.answers=t.map(m,(function(e){return e.value()})),e.multipleChoice=v.isMultipleChoice(),r.sendPollMessage(_stringify(e)),v.initPollBubble(),b()}},v.removeAnswer=function(e){v.removeCurrentAnswer(e)},v.onAnswerKeydown=function(e,n){var i=v.answers()
	return o.getKeyCode(n)!==c.BACKSPACE||(e.value().length>0||(e===t.last(i)?(e.focused(!1),i[i.length-2].focused(!0),!1):!e.allowRemove()||(v.removeCurrentAnswer(e),!1)))},v.onAnswerKeypress=function(e,n){var i=v.answers(),r=i.indexOf(e),a=o.getKeyCode(n)
	return a!==c.TAB&&e===t.last(i)&&(v.addNewAnswer("",!1,!1),e.allowRemove(!0)),r>=1&&i[0].allowRemove(!0),a===c.ENTER&&i[r+1].focused(!0),f.scrollToBottom(),!0},v.questionChanged=function(){return f.updatePollQuestion(),!0},v.handleKeyDown=function(e,t){return o.getKeyCode(t)!==c.ESCAPE||!v.isOpened()||(t.stopPropagation(),b(),void(g&&p.get().addFocusRequestToQueue(g)))},v.dispose=function(){v.isSendButtonEnabled.dispose(),y()}}return t.assign(f.prototype,r),f})),define("jsviews/chat/pollDesigner",["require","browser/dom","swx-focus-handler"],(function(e){var t=e("browser/dom"),n=e("swx-focus-handler")
	return function(e){var i=t.getElement(".poll-designer-content",e),r=t.getElement("textarea",e)
	this.scrollToBottom=function(){i.scrollTop=i.scrollHeight-i.clientHeight},this.focusPollQuestion=function(){n.get().addFocusRequestToQueue(r)},this.initPollQuestion=function(){r.style.height="19px"},this.updatePollQuestion=function(){var e
	r.style.height="auto",e=Math.max(19,Math.min(r.scrollHeight,150)),r.style.height=e+"px"}}})),define("text!views/chat/pollDesigner.html",[],(function(){return'<div class="bubble popup arrow down" data-bind="css: { active: isOpened }, event: { keydown: handleKeyDown }">\r\n\r\n    <textarea rows="1" data-bind="l10n_attr: { \'placeholder\': \'poll_designer_question_placeholder\' }, textInput: questionText, event: { input: questionChanged, paste: onPasteQuestion }"></textarea>\r\n\r\n    <fieldset class="poll-designer-content" data-bind="template: { name: \'answer-template\', foreach: answers, as: \'a\' }"></fieldset>\r\n\r\n    <div class="send-poll-button">\r\n        <swx-button params="icon: \'send\', cssClass: \'circle send-button large\', disabled: !isSendButtonEnabled(),\r\n            titleKey: \'action_button_send\', textKey: \'action_button_send\', action: submitPoll,\r\n            ariaLabelKey: \'action_button_send\'"></swx-button>\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="answer-template">\r\n    <div class="answer-box">\r\n        <input type="text" data-bind="l10n_attr: { \'placeholder\': \'poll_designer_answer_placeholder\' }, textInput: a.value, event: { keypress: $parent.onAnswerKeypress, keydown: $parent.onAnswerKeydown, paste: $parent.onPasteAnswer}, hasfocus: a.focused" />\r\n        <button tabindex="-1" data-bind="visible: a.allowRemove, event: { click: $parent.removeAnswer }" type="button" class="btn primary circle small transparent delete-answer">\r\n            <span class="iconfont cross" tabindex="0"></span>\r\n        </button>\r\n    </div>\r\n<\/script>\r\n'})),define("ui/components/chat/pollDesigner",["require","exports","module","vendor/knockout","ui/viewModels/chat/pollDesigner","jsviews/chat/pollDesigner","constants/components","text!views/chat/pollDesigner.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/pollDesigner"),r=e("jsviews/chat/pollDesigner")
	t.name=e("constants/components").chat.POLL_DESIGNER,t.template=e("text!views/chat/pollDesigner.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=n.dataFor(o),s=new r(o),c=new i(e.isDisabled,a.conversationModel,s)
	return c.setContext(a),c.init(),c}}})),define("ui/viewModels/chat/stickyMessage",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-constants","swx-enums","telemetry/chat/poll","swx-i18n"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-constants").COMMON,o=e("swx-enums"),a=e("telemetry/chat/poll"),s=e("swx-i18n").localization,c=function(e){var n=e.meCheckedAnswerPositions(),i=t.isEmpty(n)?-1:n[0],r=e.pollAnswers()
	return(r&&i>=0&&i<r.length?s.fetch({key:"poll_sticky_message_me_voted",params:{answerText:r[i].answerText}}):s.fetch({key:"poll_sticky_message_me_not_voted"}))+" · "+s.fetch({key:"poll_message_people_voted",params:{count:e.peopleVotedNum()}})},l=function(e){if(!e)return!1
	var n=1800
	return t.isEmpty(e.meCheckedAnswerPositions())&&(n=86400),t.now()-e.timestamp().getTime()<1e3*n}
	function u(e,i){var u,d,p,f,m=this,h=i.conversationModel,v=[],g=function(){var e=function(e){var n=t.filter(e,(function(e){return l(e)}))
	return 0===n.length?null:n.sort((function(e,t){return t.timestamp()-e.timestamp()}))[0]}(v)
	m.latestPoll()!==e&&(m.latestPoll(e),m.latestPoll()?m.showStickyMessageData({isActive:!0,isVisible:!0}):m.showStickyMessageData(null))}
	m.latestPoll=n.observable(null),m.pollQuestion=n.observable(),m.pollAuthor=n.observable(),m.statsMessageText=n.observable(),m.ongoingPoll=n.pureComputed((function(){return s.fetch({key:"poll_sticky_message_new_poll",params:{author:m.pollAuthor()}})})),m.showStickyMessageData=n.observable({isVisible:!1,isActive:!1}),m.showStickyMessage=n.observable(!1),m.showStickyMessageData.subscribe((function(e){m.showStickyMessage(null!==e&&e.isActive&&!e.isVisible)})),p=m.latestPoll.subscribe((function(e){e&&(f&&f.dispose(),m.pollQuestion(e.pollQuestion()),m.pollAuthor(e.sender.firstName()),m.statsMessageText(c(e)),f=e.poll.changed((function(){m.statsMessageText(c(e))})))})),u=h.historyService.activityItems.added((function(e){e.type()===o.activityType.PollMessage&&(v.push(e),g())})),d=h.historyService.activityItems.removed((function(e){e.type()===o.activityType.PollMessage&&(v=t.reject(v,(function(t){return t.key()===e.key()})),g())})),m.scrollToPoll=function(){a.stickyMessageClicked(m.latestPoll()),e.scrollToLastPollElement()},m.dispose=function(){p.dispose(),u.dispose(),d.dispose(),m.ongoingPoll.dispose(),f&&f.dispose()},m.init=function(){m.registerEvent(r.events.conversation.VIEWPORT_CHANGED,(function(t){var n,i
	m.latestPoll()&&(n=l(m.latestPoll()),i=e.checkPollIsVisible(m.latestPoll(),t),m.showStickyMessageData({isActive:n,isVisible:i}))}))}}return t.assign(u.prototype,i),u})),define("jsviews/chat/stickyMessage",["require","browser/dom","lodash-compat","vendor/knockout","browser/window","browser/document"],(function(e){var t=e("browser/dom"),n=e("lodash-compat"),i=e("vendor/knockout"),r=e("browser/window"),o=e("browser/document")
	return function(e){var a=this
	function s(e,t,n,i){if(!(n<=0)){var r=t-e.scrollTop,o=r<0,a=r/n*10
	setTimeout((function(){e.scrollTop=e.scrollTop+a,o&&e.scrollTop<=t||!o&&e.scrollTop>=t?i():s(e,t,n-10,i)}),10)}}a.lastPollElement=i.observable(null),a.scrollToLastPollElement=function(){var n=a.lastPollElement(),i=t.getElement(".conversation.scrollable",e.parentElement),r=Math.min(n.offsetTop-25,i.scrollHeight-i.offsetHeight)
	t.removeClass(n,"highlight"),s(i,r,200,(function(){t.addClass(n,"highlight")}))},a.checkPollIsVisible=function(e,t){var i=!1,s=e.key()
	return n.some(t,(function(e){if(e.getAttribute("data-id")===s)return a.lastPollElement(e),t=e.getBoundingClientRect(),i=t.top>=0&&t.left>=0&&t.bottom<=(r.innerHeight||o.documentElement.clientHeight)&&t.right<=(r.innerWidth||o.documentElement.clientWidth),!0
	var t})),i}}})),define("text!views/chat/stickyMessage.html",[],(function(){return'<div class="stickyMessage" data-bind="event: { click: scrollToPoll }">\r\n    <div class="stickyMessageWrapper" data-bind="css: { \'visible\': showStickyMessage }">\r\n        <div class="stickyMessageContent">\r\n            <span class="stickyMessageAuthor" data-bind="\'text\': ongoingPoll()"></span>\r\n            <span class="stickyMessageQuestion" data-bind="text: pollQuestion()"></span>\r\n        </div>\r\n        <span class="stickyMessageStats" data-bind="text: statsMessageText()"></span>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/stickyMessage",["require","exports","module","vendor/knockout","ui/viewModels/chat/stickyMessage","jsviews/chat/stickyMessage","constants/components","text!views/chat/stickyMessage.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/stickyMessage"),r=e("jsviews/chat/stickyMessage")
	t.name=e("constants/components").chat.STICKY_MESSAGE,t.template=e("text!views/chat/stickyMessage.html"),t.viewModel={createViewModel:function(e,t){var o=t.element,a=new r(o),s=new i(a,e,t),c=n.dataFor(o)
	return s.setContext(c),s.init(),s}}})),define("ui/viewModels/chat/startConversationOverlay",["require","lodash-compat","vendor/knockout","swx-constants","utils/common/eventMixin","ui/viewModels/people/contactBuilder","ui/viewModels/chat/conversation/callButtonViewModel"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-constants").COMMON,r=e("utils/common/eventMixin"),o=e("ui/viewModels/people/contactBuilder"),a=e("ui/viewModels/chat/conversation/callButtonViewModel")
	function s(e){var t=this,r=e.conversationModel,s=r.participants()[0].person,c=o.build(s),l=a.build(r)
	t.avatar=c.avatar,t.statusClassName=c.statusClassName,t.displayName=c.displayName,t.displayMessage=n.computed((function(){if(c.displayMessage()===c.locationText())return""
	return c.displayMessage()})),t.locationText=c.locationText,t.isAudioDisabled=l.isAudioDisabled,t.isVideoDisabled=l.isVideoDisabled,t.buttonVideoTitle=l.buttonVideoTitle,t.buttonVideoAriaLabel=l.buttonVideoAriaLabel,t.buttonCallTitle=l.buttonCallTitle,t.buttonCallAriaLabel=l.buttonCallAriaLabel,t.forwardEvent(i.events.conversation.OVERLAY_CLOSED),t.startCallWithAudio=function(){l.startCallWithAudio(),t.dispatchEvent(i.events.conversation.OVERLAY_CLOSED,t.DIRECTION.PARENT)},t.startCallWithVideo=function(){l.startCallWithVideo(),t.dispatchEvent(i.events.conversation.OVERLAY_CLOSED,t.DIRECTION.PARENT)},t.startChat=function(){t.dispatchEvent(i.events.conversation.OVERLAY_CLOSED,t.DIRECTION.PARENT)},t.dispose=function(){c.dispose(),l.dispose()}}return t.assign(s.prototype,r),{build:function(e){return new s(e)}}})),define("text!views/chat/startConversationOverlay.html",[],(function(){return'<div class="StartConversationOverlay-container themeWhite">\r\n    <div class="StartConversationOverlay-content">\r\n        <div class="StartConversationOverlay-col1">\r\n            <swx-avatar params="isGroupAvatar: false, avatar: avatar, status: statusClassName"></swx-avatar>\r\n        </div>\r\n        <div class="StartConversationOverlay-col2">\r\n            <div class="StartConversationOverlay-greeting" data-bind="l10n: { key: \'invite_free_overlay_greeting\' }"></div>\r\n\r\n            <swx-avatar params="isGroupAvatar: false, avatar: avatar, status: statusClassName"></swx-avatar>\r\n\r\n            <div data-bind="text: displayName, attr: {title: displayName}" class="StartConversationOverlay-displayName"></div>\r\n            \x3c!-- ko if: displayMessage --\x3e\r\n            <div data-bind="text: displayMessage, attr: {title: displayMessage}" class="StartConversationOverlay-statusMessage"></div>\r\n            \x3c!--  /ko --\x3e\r\n            \x3c!-- ko if: locationText --\x3e\r\n            <div class="StartConversationOverlay-location">\r\n                <span class="iconfont location"></span>\r\n                <span data-bind="text: locationText, attr: {title: locationText}" class="StartConversationOverlay-locationText"></span>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            <div class="StartConversationOverlay-buttonContainer">\r\n                <label class="StartConversationOverlay-button">\r\n                    <swx-button params="icon: \'videoOn\', cssClass: \'primary circle\', disabled: isVideoDisabled, textKey: \'button_text_videoCall\', i18nTitle: buttonVideoTitle, action: startCallWithVideo, ariaLabel: buttonVideoAriaLabel"></swx-button>\r\n                    <span class="StartConversationOverlay-buttonText" data-bind="l10n: { key: \'label_text_call_skype_video\' }"></span>\r\n                </label>\r\n                <label class="StartConversationOverlay-button">\r\n                    <swx-button params="icon: \'callStart\', cssClass: \'primary circle\', disabled: isAudioDisabled, textKey: \'button_text_audioCall\', i18nTitle: buttonCallTitle, action: startCallWithAudio, ariaLabel: buttonCallAriaLabel"></swx-button>\r\n                    <span class="StartConversationOverlay-buttonText" data-bind="l10n: { key: \'label_text_call\' }"></span>\r\n                </label>\r\n                <label class="StartConversationOverlay-button">\r\n                    <swx-button params="icon: \'message\', cssClass: \'primary circle\', textKey: \'label_text_send_message\', titleKey: \'label_text_send_message\', action: startChat,  ariaLabelKey: \'label_text_send_message\'"></swx-button>\r\n                    <span class="StartConversationOverlay-buttonText" data-bind="l10n: { key: \'label_text_send_message\' }"></span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/startConversationOverlay",["require","exports","module","vendor/knockout","ui/viewModels/chat/startConversationOverlay","constants/components","text!views/chat/startConversationOverlay.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/startConversationOverlay")
	t.name=e("constants/components").chat.START_CONVERSATION_OVERLAY,t.template=e("text!views/chat/startConversationOverlay.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e)
	return r.setContext(n.dataFor(t.element)),r}}})),define("ui/components/chat/suggestions/simpleWordSuggestion",["require","swx-utils-common"],(function(e){var t=e("swx-utils-common").stringUtils
	function n(){}return n.prototype.applySuggestion=function(e){var n=this.textarea.viewModel.messageBody(),i=t.wordBoundariesAt(n,this.searchPosition),r=this.getReplacer(e),o=n.slice(i.end)
	""===o&&(r+=" "),n=n.slice(0,i.start)+r+o,this.textarea.viewModel.messageBody(n),this.textarea.view.setCursorAt(i.start+r.length),e.data.criteriaLength=i.end-i.start,e.data.suggestionType=this.suggestionType},n})),define("ui/components/chat/suggestions/emoticonSuggestion",["require","lodash-compat","ui/components/chat/suggestions/simpleWordSuggestion"],(function(e){var t=e("lodash-compat"),n=e("ui/components/chat/suggestions/simpleWordSuggestion")
	function i(e,t,n,i,r){this.emoticon=i,this.textarea={view:t,viewModel:e},this.searchPosition=n,this.shortcut=r}return i.prototype.templateId="swx-suggestion-emoticon",i.prototype.suggestionType="EMOTICONS",i.prototype.getReplacer=function(){return this.shortcut},i.build=function(e,t,n,r,o){return new i(e,t,n,r,o)},t.assign(i.prototype,n.prototype),i})),define("ui/components/chat/suggestions/emoticonSuggestionEngine",["require","lodash-compat","swx-constants","ui/components/chat/suggestions/emoticonSuggestion","services/pes/constants","swx-service-locator-instance","swx-cafe-application-instance","swx-utils-common"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("ui/components/chat/suggestions/emoticonSuggestion"),r=e("services/pes/constants"),o=e("swx-service-locator-instance").default,a=e("swx-cafe-application-instance"),s=e("swx-utils-common").stringUtils
	function c(){var e=o.resolve(n.serviceLocator.FEATURE_FLAGS)
	this.isEnabled=e.isFeatureOn(n.featureFlags.EMOTICON_SUGGESTION_ENABLED),this.isImplicitEnabled=!e.isFeatureOn(n.featureFlags.EMOTICON_IMPLICIT_SUGGESTION_DISABLED),this.suggestHidden=e.isFeatureOn(n.featureFlags.SUGGEST_HIDDEN_EMOTICONS),this.canBeDisabledInSettings=e.isFeatureOn(n.featureFlags.SHOW_EMOTICON_SUGGESTIONS_SETTINGS)}return c.prototype.priority=2,c.prototype.filterEmoticons=function(e){var i=o.resolve(n.serviceLocator.PES_CONFIG_SERVICE).getConfiguration().items,a=this.suggestHidden
	return i.reduce((function(n,i){if(i.type!==r.itemTypes.emoticon.id||!i.visible&&!a)return n
	if(t.any(i.keywords.concat(i.description),(function(t){return s.anyWordStartsWith(t,e)})))return n.push({emoticon:i,shortcut:i.shortcuts[0]}),n
	var o=t.find(i.shortcuts,(function(t){return s.anyWordStartsWith(t,e)}))
	return o&&n.push({emoticon:i,shortcut:o}),n}),[])},c.prototype.getSuggestions=function(e,r){if(!this.isEnabled)return{isExplicit:!1,suggestions:[]}
	if(this.canBeDisabledInSettings&&!a.get().personsAndGroupsManager.mePerson.preferences(n.userSettings.preferences.EMOTICON_SUGGESTIONS).value())return{isExplicit:!1,suggestions:[]}
	var o=e.getSelectionStart(),c=s.wordAt(e.messageBody(),o),l=0===c.indexOf("(")
	if(l&&(c=c.substring(1)),!l&&(c.length<4||!this.isImplicitEnabled))return{isExplicit:l,suggestions:[]}
	var u=this.filterEmoticons(c)
	return 1===u.length&&l&&function(e,n){return t.any(n.shortcuts,(function(t){return t===e}))}("("+c,u[0].emoticon)&&(u=[]),{isExplicit:l,suggestions:u.map((function(t){return i.build(e,r,o,t.emoticon,t.shortcut)}))}},c})),define("telemetry/chat/suggestionSelectedEvent",["require","swx-constants","experience/settings","swx-constants","ui/telemetry/telemetryClient"],(function(e){var t=e("swx-constants").COMMON,n=e("experience/settings"),i=e("swx-constants").KEYS,r=e("ui/telemetry/telemetryClient")
	return function(){var e=this
	e.enums={TRIGGER:{EXPLICIT:"explicit",IMPLICIT:"implicit",QUOTE:"quote"},RESOLUTION:{ENTER:"enter",TAB:"tab",ESC:"escape",CLICKIN:"click-in",CLICKOUT:"click-out",MISSMATCH:"missmatch"},getResolution:function(n){switch(n){case i.TAB:return e.enums.RESOLUTION.TAB
	case i.ENTER:return e.enums.RESOLUTION.ENTER
	case i.ESC:return e.enums.RESOLUTION.ESC
	default:return t.telemetry.NOT_AVAILABLE}}},e.data={},e.publish=function(){e.data.selectedIndex!==t.telemetry.NOT_AVAILABLE&&r.get().sendEvent(n.telemetry.chatTenantToken,"message_suggestion_action",e.data),e.reset()},e.reset=function(){e.data={criteriaLength:t.telemetry.NOT_AVAILABLE,resolution:t.telemetry.NOT_AVAILABLE,selectedIndex:t.telemetry.NOT_AVAILABLE,suggestionType:t.telemetry.NOT_AVAILABLE,totalMatchCount:t.telemetry.NOT_AVAILABLE,trigger:t.telemetry.NOT_AVAILABLE,visibleMatchCount:t.telemetry.NOT_AVAILABLE}},e.reset()}})),define("ui/components/chat/suggestions/mentionSuggestion",["require","lodash-compat","ui/components/chat/suggestions/simpleWordSuggestion"],(function(e){var t=e("lodash-compat"),n=e("ui/components/chat/suggestions/simpleWordSuggestion")
	function i(e,t,n,i){this.participant=i,this.textarea={view:t,viewModel:e},this.searchPosition=n}return i.prototype.templateId="swx-suggestion-mention",i.prototype.suggestionType="MENTIONS",i.prototype.getReplacer=function(e){e.data.participantsCount=this.textarea.viewModel.conversationModel.participants().length
	var t=this.participant.person
	return"@"+(t.isAgent()?"("+t.displayName().replace(/(\(|\))/g,"")+")":t.id())},i.build=function(e,t,n,r){return new i(e,t,n,r)},t.assign(i.prototype,n.prototype),i})),define("ui/components/chat/suggestions/mentionSuggestionEngine",["require","lodash-compat","swx-constants","ui/components/chat/suggestions/mentionSuggestion","ui/modelHelpers/personHelper","swx-service-locator-instance","swx-utils-common"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("ui/components/chat/suggestions/mentionSuggestion"),r=e("ui/modelHelpers/personHelper"),o=e("swx-service-locator-instance").default,a=e("swx-utils-common").stringUtils
	function s(){var e=o.resolve(n.serviceLocator.FEATURE_FLAGS)
	this.isEnabled=e.isFeatureOn(n.featureFlags.MENTIONS_ENABLED),this.isEnabledForPeople=e.isFeatureOn(n.featureFlags.MENTIONS_PEOPLE_ENABLED),this.matchImplicitByContains=e.isFeatureOn(n.featureFlags.AGGRESSIVE_IMPLICT_MENTIONS_MATCHING)}function c(e,n){if(!e)return!1
	var i=new RegExp(t.escapeRegExp(n),"i")
	return-1!==a.normalize(e).search(i)}return s.prototype.priority=1,s.prototype.filterParticipants=function(e,t,n){var i,o=t||this.matchImplicitByContains?function(e){return!r.isPstn(e.person)&&(c(e.person.displayName(),n)||c(e.person.id(),n))}:function(e){return!r.isPstn(e.person)&&(a.anyWordStartsWith(e.person.displayName(),n)||a.anyWordStartsWith(e.person.id(),n))}
	return i=e.filter(o),this.isEnabledForPeople||(i=i.filter((function(e){return r.isAgent(e.person)}))),i.length>1&&i.sort((function(e,t){return e.person.displayName().toLowerCase().localeCompare(t.person.displayName().toLowerCase())})),i},s.prototype.getSuggestions=function(e,t){if(!e.conversationModel.isGroupConversation()||!this.isEnabled)return{isExplicit:!1,suggestions:[]}
	var n=e.getSelectionStart(),r=e.conversationModel.participants(),o=a.wordAt(e.messageBody(),n),s="@"===o[0]
	if(s&&(o=o.substring(1)),!s&&o.length<4)return{isExplicit:s,suggestions:[]}
	var c=this.filterParticipants(r,s,o)
	return 1===c.length&&s&&o===c[0].person.id()&&(c=[]),{isExplicit:s,suggestions:c.map((function(r){return i.build(e,t,n,r)}))}},s})),define("ui/viewModels/chat/suggestions/suggestionList",["require","exports","module","lodash-compat","swx-constants","ui/components/chat/suggestions/emoticonSuggestionEngine","utils/common/eventMixin","swx-constants","vendor/knockout","telemetry/chat/suggestionSelectedEvent","ui/components/chat/suggestions/mentionSuggestionEngine","utils/common/outsideClickHandler"],(function(e,t){var n=e("lodash-compat"),i=e("swx-constants").COMMON,r=e("ui/components/chat/suggestions/emoticonSuggestionEngine"),o=e("utils/common/eventMixin"),a=i.events,s=e("swx-constants").KEYS,c=e("vendor/knockout"),l=e("telemetry/chat/suggestionSelectedEvent"),u=e("ui/components/chat/suggestions/mentionSuggestionEngine"),d=e("utils/common/outsideClickHandler")
	function p(){var e,t,i,o=this
	function p(){o.isVisible()&&(e.data.resolution=e.enums.RESOLUTION.CLICKOUT,e.data.selectedIndex=o.selectedIndex(),e.publish(),o.isVisible(!1))}function f(r){i=r.viewModel
	var a=t.map((function(e){return e.getSuggestions(r.viewModel,r.view)})),s=n.some(a,(function(e){return e.isExplicit}))
	e.data.trigger=s?e.enums.TRIGGER.EXPLICIT:e.enums.TRIGGER.IMPLICIT,a=a.reduce((function(e,t){return t.isExplicit===s?e.concat(t.suggestions):e}),[]),e.data.totalMatchCount=a.length,a=n.take(a,8),e.data.visibleMatchCount=a.length
	var c=o.isVisible()
	o.suggestions(a),o.isVisible(0!==a.length),o.selectedIndex()>=a.length?o.selectedIndex(a.length-1):c&&-1!==o.selectedIndex()||o.selectedIndex(s?0:-1),c&&!o.isVisible()&&(e.data.resolution=e.enums.RESOLUTION.MISSMATCH,e.data.selectedIndex=o.selectedIndex(),e.publish())}function m(t){var n=t.event.keyCode||t.event.which
	if(o.isVisible()){var i,r,c=!0
	switch(n){case s.ESCAPE:e.data.resolution=e.enums.RESOLUTION.ESC,e.data.selectedIndex=o.selectedIndex(),e.publish(),o.isVisible(!1)
	break
	case s.UP:case s.DOWN:i=n===s.UP?-1:1,r=o.selectedIndex()+i,-1===o.selectedIndex()&&(r=-1===i?o.suggestions().length-1:0),0<=r&&r<o.suggestions().length&&o.selectedIndex(r),o.dispatchEvent(a.suggestionList.ITEM_SELECTED,o.selectedIndex())
	break
	case s.ENTER:case s.TAB:-1!==o.selectedIndex()?function(t,n){o.suggestions()[o.selectedIndex()].applySuggestion(e),e.data.selectedIndex=o.selectedIndex(),e.data.resolution=e.enums.getResolution(t),e.publish(),o.isVisible(!1),n.setBlurAndFocus()}(n,t.viewModel):c=!1
	break
	default:c=!1}c&&t.event.stopImmediatePropagation()}}o.isVisible=c.observable(!1),o.selectedIndex=c.observable(0),o.suggestions=c.observableArray([]),o.dispose=function(){d.remove("suggestionList")},o.init=function(i){e=i.suggestionSelectedTelemetryEvent||new l,0===(t=i.suggestionEngines||[]).length&&(t.push(new u),t.push(new r)),t=n.sortBy(t,"priority"),o.registerEvent(a.textarea.KEY_DOWN,m),o.registerEvent(a.textarea.INPUT,f),o.isVisible.subscribe((function(e){e?(d.add("suggestionList",p),o.dispatchEvent(a.suggestionList.SHOWN)):(d.remove("suggestionList"),o.dispatchEvent(a.suggestionList.HIDDEN))}))},o.onSuggestionClick=function(t){t.applySuggestion(e)
	var n=o.suggestions().indexOf(t)
	e.data.selectedIndex=n,e.data.resolution=e.enums.RESOLUTION.CLICKIN,e.publish(),o.selectedIndex(n),o.isVisible(!1),i&&i.setBlurAndFocus()},o.onSuggestionMouseOver=function(e){var t=o.suggestions().indexOf(e)
	o.selectedIndex(t)}}n.assign(p.prototype,o),t.build=function(){return new p}})),define("text!views/chat/suggestions/suggestionList.html",[],(function(){return'<div class="suggestionList" data-bind="visible: isVisible" >\r\n    <ul class="list" data-bind="attr: {\'aria-expanded\': isVisible}, foreach: { data: suggestions, as: \'suggestion\' }" id="suggestionList" role="listbox">\r\n        <li class="item" tabindex="-1" role="option" data-bind="event: { mouseover: $parent.onSuggestionMouseOver, click: $parent.onSuggestionClick },\r\n                                    css: { selected: $index() === $parent.selectedIndex() },\r\n                                    attr: { id: \'suggestionList-item-\'+$index() },\r\n                                    template: { name: suggestion.templateId, data: { isSelected: $index() === $parent.selectedIndex(), data: suggestion } }"></li>\r\n    </ul>\r\n</div>\r\n\r\n<script type="text/html" id="swx-suggestion-mention">\r\n    <span class="mention" data-type="mention">\r\n        <swx-avatar params="avatar: data.participant.person.avatarUrl(), displayName: data.participant.person.displayName(), size:36"></swx-avatar>\r\n        <span class="participantName" data-bind="html: \'@\' + data.participant.person.displayName()"></span>\r\n    </span>\r\n<\/script>\r\n\r\n<script type="text/html" id="swx-suggestion-emoticon">\r\n    <span class="emoticonSuggestion largeAllowed" data-type="emoticon" data-bind="attr: { \'aria-label\': data.emoticon.description }" >\r\n        <span class="emoticon large" data-bind="css: data.emoticon.id + (isSelected ? \' animated\' : \'\')"><span class="emoSprite" data-bind="text: data.emoticon.shortcuts[0]"></span><canvas data-bind="attr: { \'data-item-id\': data.emoticon.id, \'data-is-animated\': isSelected }"></canvas></span>\r\n        <span class="description" data-bind="html: data.emoticon.description"></span>\r\n    </span>\r\n<\/script>\r\n'})),define("ui/components/chat/suggestions/suggestionList",["require","vendor/knockout","constants/components","ui/viewModels/chat/suggestions/suggestionList","text!views/chat/suggestions/suggestionList.html"],(function(e){var t=e("vendor/knockout"),n=e("constants/components").chat.SUGGESTION_LIST,i=e("ui/viewModels/chat/suggestions/suggestionList")
	return{name:n,template:e("text!views/chat/suggestions/suggestionList.html"),viewModel:{createViewModel:function(e,n){var r=i.build()
	return r.init(e),r.setContext(t.dataFor(n.element)),r}}}})),define("ui/viewModels/chat/videoPlayer",["require","exports","module","lodash-compat","browser/dom","browser/document","utils/common/eventMixin","swx-constants","vendor/knockout","swx-i18n","telemetry/chat/videoMessagePlayback","ui/players/mediaPlayerController"],(function(e,t){var n=e("lodash-compat"),i=e("browser/dom"),r=e("browser/document"),o=e("utils/common/eventMixin"),a=e("swx-constants").COMMON,s=e("vendor/knockout"),c=e("swx-i18n").localization,l=e("telemetry/chat/videoMessagePlayback"),u=e("ui/players/mediaPlayerController")
	function d(e,t){var n,o,d,p=this,f=i.getElement(".VideoPlayer",e),m=i.getElement(".VideoPlayer-player",e),h=i.getElement(".VideoPlayer-timeline",e),v=!1,g=!1,y=!1,b=s.observable(0),_=s.observable(0),E=c.fetch({key:"swift_videocard_control_button_mute"}),w=c.fetch({key:"swift_videocard_control_button_unmute"}),S=!1,x=!1
	function C(e){var t=Math.round(e),n=0
	function i(e){return 1===e.toString().length?"0"+e:e}return t>=60&&(t-=60*(n=parseInt(t/60))),i(n)+":"+i(t)}function T(e){p.currentProgress("width: "+e+"%")}function I(e){if(e&&e.pageX){var t=h.offsetWidth,n=h.getBoundingClientRect().left,i=e.pageX-n
	m.currentTime=m.duration*(i/t),T(i/t*100)}}function A(){g||(g=!0,l.sendSeekAction())}p.media=t.media,p.autoloop=t.autoloop||!1,p.autoplay=t.autoplay||!1,p.id=t.messageId,p.conversationId=t.conversationId,p.title=t.title||!1,p.subtitle=t.subtitle||!1,p.showLoadingInfo=t.showLoadingInfo||!1,p.mediaType=a.chat.messageType.VIDEO,p.displayCurrentTime=t.displayCurrentTime,p.displayTotalTime=t.displayTotalTime,p.displayMuteButton=t.displayMuteButton,m&&(m.muted=t.muted),p.isPlaying=s.observable(!1),p.isInFullscreen=s.observable(!1),p.isMuted=s.observable(t.muted),p.thumbnail=s.observable(""),t.thumbnail&&(o=t.thumbnail,(d=new Image).onload=function(){p.thumbnail(o)},d.src=o),p.isFullscreenSupported=f.requestFullscreen||f.mozRequestFullScreen||f.webkitRequestFullScreen||f.msRequestFullScreen,p.currentProgress=s.observable("0"),p.canPlay=s.observable(!1),p.isLoading=s.observable(!0),p.failed=s.observable(!1),p.currentTime=s.pureComputed((function(){return C(b())})),p.totalTime=s.pureComputed((function(){return C(_())})),p.playButtonText=s.pureComputed((function(){return p.isPlaying()?c.fetch({key:"mediaPlayer_pause"}):c.fetch({key:"mediaPlayer_play"})})),p.mute=function(e){m&&(m.muted=e,p.isMuted(e))},p.toggleMute=function(e){e&&e.touched&&(x=!0),p.isMuted()?p.mute(!1):p.mute(!0)},p.toggleMuteText=function(){return p.isMuted()?w:E},p.fullscreenButtonText=s.pureComputed((function(){return p.isInFullscreen()?c.fetch({key:"videoPlayer_exitFullscreen"}):c.fetch({key:"videoPlayer_fullscreen"})}))
	p.onError=function(){p.canPlay(!1),p.isLoading(!1),p.failed(!0)},p.onReady=function(){p.canPlay(!0),p.isLoading(!1)},p.onMetadataLoaded=function(){v=!0,n&&n(),b(m.currentTime),_(m.duration),l.sendLoadedEvent()},p.onTimeUpdated=function(){b(m.currentTime),T(b()/_()*100)},p.onVideoEnded=function(){x=!1,p.isPlaying(!1)},p.play=function(){S=!v,v?(m.play(),p.isPlaying(!0),n=null):n=p.play.bind(p)},p.pause=function(){S=!1,x=!1,v?(m.pause(),p.isPlaying(!1),n=null):n=p.pause.bind(p)},p.togglePlay=function(e){m.ended&&l.sendReplayAction(),m.paused||m.ended?(u.pauseAllInConversation(p.conversationId),p.play(),p.mute(!1),e&&e.touched&&(x=!0)):p.pause()},p.toggleFullscreen=function(e){e&&e.touched&&(x=p.isPlaying()),p.isInFullscreen()?(r.exitFullscreen?r.exitFullscreen():r.mozCancelFullScreen?r.mozCancelFullScreen():r.webkitExitFullscreen?r.webkitExitFullscreen():r.msExitFullscreen&&r.msExitFullscreen(),p.dispatchEvent(a.events.videoPlayer.FULLSCREEN_OFF,null,p.DIRECTION.PARENT)):(f.requestFullscreen?f.requestFullscreen():f.mozRequestFullScreen?f.mozRequestFullScreen():f.webkitRequestFullScreen?f.webkitRequestFullScreen():f.msRequestFullScreen&&f.msRequestFullScreen(),u.onEnteringFullscreen(p.id),p.dispatchEvent(a.events.videoPlayer.FULLSCREEN_ON,null,p.DIRECTION.PARENT),y||(y=!0,l.sendFullscreenAction()))},p.onTimelineClick=function(e,t){x=p.isPlaying(),I(t),A()},p.onHandleStartDrag=function(e,t){I(t),r.addEventListener("mousemove",I),r.addEventListener("mouseup",(function e(){r.removeEventListener("mousemove",I),r.removeEventListener("mouseup",e)})),A()},p.isQueuedForPlaying=function(){return S},p.triggeredByUser=function(){return x},p.init=function(){u.registerPlayer(p)},p.dispose=function(){p.currentTime.dispose(),p.totalTime.dispose(),p.playButtonText.dispose(),p.fullscreenButtonText.dispose(),u.removePlayer(p.id)}}t.build=function(e,t){return new d(e,t)},n.assign(d.prototype,o)})),define("text!views/chat/videoPlayer.html",[],(function(){return'<div class="VideoPlayer">\r\n\r\n    <div class="VideoPlayer-fullsreenInfo" data-bind="visible: isInFullscreen">\r\n        \x3c!-- ko if: title --\x3e\r\n        <h1 data-bind="text: title, attr: { title: title }"></h1>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: subtitle --\x3e\r\n        <h2 data-bind="text: subtitle, attr: { title: subtitle }"></h2>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="VideoPlayer-loadingIndicator" data-bind="visible: isLoading()">\r\n        <swx-loading-animation class="spinner fog"></swx-loading-animation>\r\n    </div>\r\n    <div class="VideoPlayer-error" data-bind="visible: failed()">\r\n        <span class="iconfont warning"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="VideoPlayer-controlsOverlay" data-bind="click: togglePlay.bind(this, {touched: true})"></div>\r\n\r\n    <video class="VideoPlayer-player" data-bind="attr: { src: media, poster: thumbnail, loop: autoloop}, click: togglePlay,\r\n            event: {canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onVideoEnded}">\r\n    </video>\r\n\r\n    <div class="VideoPlayer-controls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay.bind(this, {touched: true}), attr: {title: playButtonText }"\r\n                class="VideoPlayer-button VideoPlayer-togglePlay btn circle" type="button">\r\n            <span class="iconfont play" data-bind="css: { pause: isPlaying() }, text: playButtonText"></span>\r\n        </button>\r\n\r\n        \x3c!-- ko if: displayCurrentTime --\x3e\r\n        <div class="VideoPlayer-currentTime" data-bind="text: currentTime"></div>\r\n        \x3c!-- /ko  --\x3e\r\n\r\n        <div class="VideoPlayer-timeline" data-bind="click: onTimelineClick.bind(this, {touched: true})">\r\n            <div class="VideoPlayer-totalProgress"></div>\r\n            <div class="VideoPlayer-progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="VideoPlayer-handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n        </div>\r\n\r\n        \x3c!-- ko if: displayTotalTime --\x3e\r\n        <div class="VideoPlayer-totalTime" data-bind="text: totalTime"></div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: displayMuteButton --\x3e\r\n        <button data-bind="click: toggleMute.bind(this, {touched: true}), attr: {title: toggleMuteText() }"\r\n                class="VideoPlayer-button VideoPlayer-toggleFullscreen btn circle" type="button">\r\n            <span class="iconfont volume" data-bind="text: toggleMuteText(), css: { volumeOff: isMuted(), volumeMax: !isMuted() }"></span>\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: isFullscreenSupported --\x3e\r\n        <button data-bind="click: toggleFullscreen.bind(this, {touched: true}), attr: {title: fullscreenButtonText }"\r\n                class="VideoPlayer-button VideoPlayer-toggleFullscreen btn circle" type="button">\r\n            <span class="iconfont fullscreen" data-bind="css: { fullscreenOff: isInFullscreen() }, text: fullscreenButtonText"></span>\r\n        </button>\r\n        \x3c!-- /ko --\x3e\r\n\r\n    </div>\r\n</div>\r\n'}))
	define("ui/components/chat/videoPlayer",["require","exports","module","vendor/knockout","ui/viewModels/chat/videoPlayer","constants/components","text!views/chat/videoPlayer.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/videoPlayer")
	t.name=e("constants/components").chat.VIDEO_PLAYER,t.template=e("text!views/chat/videoPlayer.html"),t.viewModel={createViewModel:function(e,t){var r=t.element,o=i.build(r,e),a=n.dataFor(r)
	return o.init(),o.setContext(a),o}}})),define("ui/viewModels/chat/audioPlayer",["require","exports","module","lodash-compat","browser/dom","browser/document","utils/common/eventMixin","vendor/knockout","swx-i18n","swx-constants","ui/players/mediaPlayerController","telemetry/chat/audioMessagePlayback"],(function(e,t){var n=e("lodash-compat"),i=e("browser/dom"),r=e("browser/document"),o=e("utils/common/eventMixin"),a=e("vendor/knockout"),s=e("swx-i18n").localization,c=e("swx-constants").COMMON,l=e("ui/players/mediaPlayerController"),u=e("telemetry/chat/audioMessagePlayback")
	function d(e,t){var n,o,d=this,p=i.getElement(".AudioPlayer-player",e),f=i.getElement(".AudioPlayer-timeline",e),m=!1,h=a.observable(0),v=a.observable(0)
	function g(e){var t=Math.round(e),n=0
	function i(e){return 1===e.toString().length?"0"+e:e}return t>=60&&(t-=60*(n=parseInt(t/60))),i(n)+":"+i(t)}function y(e){d.currentProgress("width: "+e+"%")}function b(e){var t=f.offsetWidth,n=f.getBoundingClientRect().left,i=e.pageX-n
	p.currentTime=p.duration*(i/t),y(i/t*100)}d.media=t.media,d.thumbnail=t.thumbnail,d.id=t.messageId,d.conversationId=t.conversationId,d.mediaType=c.chat.messageType.AUDIO,d.showLoadingInfo=t.showLoadingInfo||!1,d.isPlaying=a.observable(!1),d.currentProgress=a.observable("0"),d.canPlay=a.observable(!1),d.isLoading=a.observable(!0),d.failed=a.observable(!1),d.currentTime=a.pureComputed((function(){return g(h())})),d.totalTime=a.pureComputed((function(){return g(v())})),d.playButtonText=a.pureComputed((function(){return d.isPlaying()?s.fetch({key:"mediaPlayer_pause"}):s.fetch({key:"mediaPlayer_play"})})),d.onError=function(){d.canPlay(!1),d.isLoading(!1),d.failed(!0)},d.onReady=function(){d.canPlay(!0),d.isLoading(!1)},d.onMetadataLoaded=function(){m=!0,n&&n(),h(p.currentTime),v(p.duration)},d.onTimeUpdated=function(){h(p.currentTime),y(h()/v()*100)},d.onAudioEnded=function(){d.isPlaying(!1)},d.play=function(){o=!m,m?(p.play(),d.isPlaying(!0),n=null):n=d.play.bind(d)},d.pause=function(){o=!1,m?(p.pause(),d.isPlaying(!1),n=null):n=d.pause.bind(d)},d.togglePlay=function(){p.ended&&u.sendReplayAction(),p.paused||p.ended?(l.pauseAllInConversation(d.conversationId),d.play()):d.pause()},d.onTimelineClick=function(e,t){b(t)},d.onHandleStartDrag=function(e,t){b(t),r.addEventListener("mousemove",b),r.addEventListener("mouseup",(function e(){r.removeEventListener("mousemove",b),r.removeEventListener("mouseup",e)}))},d.isQueuedForPlaying=function(){return o},d.init=function(){l.registerPlayer(d)},d.dispose=function(){d.currentTime.dispose(),d.totalTime.dispose(),d.playButtonText.dispose()}}t.build=function(e,t){return new d(e,t)},n.assign(d.prototype,o)})),define("text!views/chat/audioPlayer.html",[],(function(){return'<div class="AudioPlayer">\r\n\r\n    \x3c!-- ko if: showLoadingInfo --\x3e\r\n    <div class="AudioPlayer-loadingIndicator" data-bind="visible: isLoading()">\r\n        <swx-loading-animation class="spinner fog"></swx-loading-animation>\r\n    </div>\r\n    <div class="AudioPlayer-error" data-bind="visible: failed()">\r\n        <span class="iconfont warning"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="AudioPlayer-controlsOverlay" data-bind="click: togglePlay"></div>\r\n\r\n    <audio class="AudioPlayer-player" data-bind="attr: { src: media, poster: thumbnail }, click: togglePlay,\r\n            event: {canplay: onReady, error: onError, loadedmetadata: onMetadataLoaded, timeupdate: onTimeUpdated, ended: onAudioEnded}"></audio>\r\n\r\n    <div class="AudioPlayer-controls" data-bind="visible: canPlay">\r\n\r\n        <button data-bind="click: togglePlay, attr: {title: playButtonText }"\r\n                class="AudioPlayer-button AudioPlayer-togglePlay btn circle" type="button">\r\n            <span class="iconfont play" data-bind="css: { pause: isPlaying() }, text: playButtonText"></span>\r\n        </button>\r\n\r\n        <div class="AudioPlayer-timeline" data-bind="click: onTimelineClick">\r\n            <div class="AudioPlayer-timers">\r\n                <div class="AudioPlayer-currentTime" data-bind="text: currentTime"></div>\r\n                <div class="AudioPlayer-totalTime" data-bind="text: totalTime"></div>\r\n            </div>\r\n            <div class="AudioPlayer-totalProgress"></div>\r\n\r\n            <div class="AudioPlayer-progress" data-bind="attr: {style: currentProgress}">\r\n                <div class="AudioPlayer-handle" data-bind="event: {mousedown: onHandleStartDrag}"></div>\r\n            </div>\r\n\r\n        </div>\r\n\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/audioPlayer",["require","exports","module","vendor/knockout","ui/viewModels/chat/audioPlayer","constants/components","text!views/chat/audioPlayer.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/audioPlayer")
	t.name=e("constants/components").chat.AUDIO_PLAYER,t.template=e("text!views/chat/audioPlayer.html"),t.viewModel={createViewModel:function(e,t){var r=t.element,o=i.build(r,e),a=n.dataFor(r)
	return o.init(),o.setContext(a),o}}})),define("ui/viewModels/chat/gifPlayer",["require","exports","module","lodash-compat","utils/common/eventMixin","vendor/knockout"],(function(e,t){var n=e("lodash-compat"),i=e("utils/common/eventMixin"),r=e("vendor/knockout")
	function o(e){var t=this
	if(t.media=e.media&&e.media.url?e.media:null,t.canPlay=r.observable(!1),t.isLoading=r.observable(!0),t.failed=r.observable(!1),t.media){var n=new Image
	n.onload=function(){t.canPlay(!0),t.isLoading(!1)},n.onerror=function(){t.canPlay(!1),t.isLoading(!1),t.failed(!0)},n.src=t.media.url}}t.build=function(e,t){return new o(e,t)},n.assign(o.prototype,i)})),define("text!views/chat/gifPlayer.html",[],(function(){return'<div class="GifPlayer">\r\n    <div class="loadingIndicator" data-bind="visible: isLoading()">\r\n        <swx-loading-animation class="spinner fog"></swx-loading-animation>\r\n    </div>\r\n    <div class="error" data-bind="visible: failed()">\r\n        <span class="iconfont warning"></span>\r\n    </div>\r\n\r\n    \x3c!-- ko if: media --\x3e\r\n    <img data-bind="visible: canPlay(),\r\n            attr: { src: media.url,\r\n                alt: media.alt,\r\n                width: media.uiSize().width,\r\n                height: media.uiSize().height\r\n            }, style: { left: media.leftAlignment(),\r\n                bottom: media.bottomAlignment(),\r\n                right: media.rightAlignment()\r\n            }" />\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/gifPlayer",["require","exports","module","ui/viewModels/chat/gifPlayer","constants/components","text!views/chat/gifPlayer.html"],(function(e,t){var n=e("ui/viewModels/chat/gifPlayer")
	t.name=e("constants/components").chat.GIFPLAYER,t.template=e("text!views/chat/gifPlayer.html"),t.viewModel={createViewModel:function(e){return n.build(e)}}})),define("ui/viewModels/chat/userListPopup",["require","exports","module","utils/common/eventMixin","swx-constants","swx-utils-common","browser/document","browser/dom","vendor/knockout","lodash-compat","utils/common/scroll","utils/common/outsideClickHandler"],(function(e,t){var n=e("utils/common/eventMixin"),i=e("swx-constants").COMMON,r=e("swx-utils-common").async,o=e("browser/document"),a=e("browser/dom"),s=e("vendor/knockout"),c=e("lodash-compat"),l=e("utils/common/scroll"),u=e("utils/common/outsideClickHandler")
	function d(e,t){var n,c,d=this,p=e.isSelfPopup()||function(){return!0},f=a.getElement(".UserListPopup-scrollingContainer",t)
	function m(e){d.hidden()&&p(e)&&(e.eventPageY/o.body.clientHeight>.5?c(!0):c(!1),d.hidden(!1),r.execute((function(){u.add("UserListPopup",h)})))}function h(){d.hidden(!0),u.remove("UserListPopup")}d.title=e.title,d.users=e.users,d.hidden=s.observable(!0),c=s.observable(),d.userListPopupCss=s.computed((function(){return{UserListPopup:!0,popup:!0,arrow:!0,down:c(),up:!c(),"fontSize-p":!0}})),d.init=function(){t.addEventListener("contextmenu",(function(e){e.stopPropagation()})),d.registerEvent(i.events.userListPopup.POPUP_TOGGLE,m),(n=l.build(f)).init()},d.dispose=function(){n.dispose(),d.userListPopupCss.dispose()}}t.build=function(e,t){return new d(e,t)},c.assign(d.prototype,n)})),define("text!views/chat/userListPopup.html",[],(function(){return'<div data-bind="css: userListPopupCss, visible: !hidden()">\r\n    <h3 class="UserListPopup-title" data-bind="text: title"></h3>\r\n    <div class="UserListPopup-scrollingContainer">\r\n        <ul class="UserListPopup-usersContainer scrollViewport scrollViewportV" data-bind="foreach: users" tabindex="-1">\r\n            <li class="UserListPopup-user list-selectable">\r\n                \x3c!-- ko if: person --\x3e\r\n                <swx-avatar params="avatar: person.avatarUrl(), status: contact.statusClassName, displayName: displayName"></swx-avatar>\r\n                \x3c!-- /ko --\x3e\r\n                \x3c!-- ko ifnot: person --\x3e\r\n                <swx-avatar params="isGroupAvatar: false"></swx-avatar>\r\n                \x3c!-- /ko --\x3e\r\n                <div class="UserListPopup-info">\r\n                    <span class="UserListPopup-displayName" data-bind="text: displayName"></span>\r\n                    \x3c!-- ko if: (person && contact.displayMessage) --\x3e\r\n                    <span class="UserListPopup-status" data-bind="text: contact.displayMessage"></span>\r\n                    \x3c!-- /ko --\x3e\r\n                    \x3c!-- ko ifnot: (person && contact.displayMessage) --\x3e\r\n                    <span class="UserListPopup-status" data-bind="l10n: { key: \'message_text_presenceUnknown\' }"></span>\r\n                    \x3c!-- /ko --\x3e\r\n                </div>\r\n            </li>\r\n        </ul>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/userListPopup",["require","exports","module","ui/viewModels/chat/userListPopup","constants/components","text!views/chat/userListPopup.html"],(function(e,t){var n=e("ui/viewModels/chat/userListPopup")
	t.name=e("constants/components").chat.USER_LIST_POPUP,t.template=e("text!views/chat/userListPopup.html"),t.viewModel={createViewModel:function(e,t){var i=n.build(e,t.element)
	return i.setContext(e.eventContext),i.init(),i}}})),define("ui/viewModels/chat/translator/translatorSettings",["require","exports","module","swx-cafe-application-instance","browser/dom","browser/document","swx-i18n","vendor/knockout","utils/common/eventHelper","utils/common/cafeObservable","experience/settings","swx-constants","telemetry/translator/translatorTelemetry","utils/common/outsideClickHandler"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("browser/dom"),r=e("browser/document"),o=e("swx-i18n").localization,a=e("vendor/knockout"),s=e("utils/common/eventHelper"),c=e("utils/common/cafeObservable"),l=e("experience/settings"),u=e("swx-constants").COMMON.telemetry.translator,d=e("telemetry/translator/translatorTelemetry"),p=e("utils/common/outsideClickHandler")
	function f(e){var t,f,m,h,v,g=this,y=e.conversationModel,b=n.get().personsAndGroupsManager.mePerson,_=o.fetch({key:"label_translator_translatorOn"}),E=o.fetch({key:"label_translator_translatorOff"}),w={name:"English",code:"en"},S="TranslatorSettings",x=d.build()
	function C(){g.dialogOpened(!1),p.remove(S),r.body.removeEventListener("focus",T,!0),r.body.removeEventListener("keydown",I,!0)}function T(e){!!i.getParentWithClass(e.target,S)||!!i.getParentWithClass(e.relatedTarget,S)||!!i.getParentWithClass(e.explicitOriginalTarget,S)||C()}function I(e){s.isDeactivation(e)&&(C(),x.send(u.eventType.SETTINGS_HIDE,{initiator:u.initiator.ESCAPE_KEY}))}function A(e){g.translatorEnabled(!0),y._translatorSettings.meLanguage=e,x.send(u.eventType.ME_LANGUAGE_CHANGED,{language:e.code,settingsInitParamsLocale:l.initParams.locale})}function M(e){g.translatorEnabled(!0),y._translatorSettings.participantLanguage=e,x.send(u.eventType.PARTICIPANT_LANGUAGE_CHANGED,{selectedLanguage:e.code})}function O(e){y._translatorSettings&&(y._translatorSettings.isEnabled=e,e?(y._translatorSettings.meLanguage=g.meLanguage(),y._translatorSettings.participantLanguage=g.participantLanguage()):(y._translatorSettings.meLanguage=null,y._translatorSettings.participantLanguage=null))}g.init=function(){g.availableLanguages=a.observableArray(),t=l.initParams.locale.replace(/-\w+/,"").toLowerCase(),n.get().translatorService.supportedLanguages().forEach((function(e){var n={name:e.name(),code:e.code()}
	n.code===t&&(f=n),"en"===n.code&&(w=n),g.availableLanguages.push(n)})),g.translatorEnabled=a.observable(!1),g.participantAvatar=c.newObservableProperty(y.participants()[0].person.avatarUrl),g.participantDisplayName=c.newObservableProperty(y.participants()[0].person.displayName),g.participantLanguage=a.observable(y._translatorSettings&&y._translatorSettings.participantLanguage||w),g.meAvatar=c.newObservableProperty(b.avatarUrl),g.meDisplayName=c.newObservableProperty(b.displayName),g.meLanguage=a.observable(y._translatorSettings&&y._translatorSettings.meLanguage||f||w),g.dialogOpened=a.observable(!1),g.settingsButtonLabel=o.fetch({key:"button_translator_translatorSettings"}),g.settingsButtonAriaLabel=a.computed((function(){return g.translatorEnabled()?g.settingsButtonLabel+". "+o.fetch({key:"button_translator_translatorSettingsOn"}):g.settingsButtonLabel+". "+o.fetch({key:"button_translator_translatorSettingsOff"})})),g.settingsDialogLabel=o.fetch({key:"label_translator_translatorSettings"}),g.meLanguagePickerLabel=a.computed((function(){return o.fetch({key:"label_translator_selected_myLanguage",params:{language:g.meLanguage().name}})})),g.theirLanguagePickerLabel=a.computed((function(){return o.fetch({key:"label_translator_selected_theirLanguage",params:{name:g.participantDisplayName(),language:g.participantLanguage().name}})})),m=g.translatorEnabled.subscribe(O),h=g.participantLanguage.subscribe(M),v=g.meLanguage.subscribe(A),g.translatorToggleText=a.computed((function(){return g.translatorEnabled()?_:E})),g.translatorEnabledHandler=function(){var e=g.translatorEnabled()
	g.translatorEnabled(!g.translatorEnabled()),e||x.send(u.eventType.SETTINGS_BUTTON_ENABLED,{meLanguage:g.meLanguage().code,participantLanguage:g.participantLanguage().code})},g.onTranslatorEnabledKeyDown=function(e,t){var n=s.isActivation(t)
	return n&&g.translatorEnabledHandler(),!n},g.settingsButtonHandler=function(){g.dialogOpened()?(C(),x.send(u.eventType.SETTINGS_HIDE,{initiator:u.initiator.CLICK_GLOBE_BUTTON})):(g.dialogOpened(!0),p.add(S,C),r.body.addEventListener("focus",T,!0),r.body.addEventListener("keydown",I,!0),x.send(u.eventType.SETTINGS_SHOW))},y._translatorSettings?g.translatorEnabled(y._translatorSettings.isEnabled):y._translatorSettings={meLanguage:g.meLanguage(),participantLanguage:g.participantLanguage(),isEnabled:g.translatorEnabled()}},g.dispose=function(){g.dialogOpened()&&C(),g.participantAvatar.dispose(),g.participantDisplayName.dispose(),g.meAvatar.dispose(),g.meDisplayName.dispose(),g.translatorToggleText.dispose(),g.meLanguagePickerLabel.dispose(),g.theirLanguagePickerLabel.dispose(),g.settingsButtonAriaLabel.dispose(),h.dispose(),v.dispose(),m.dispose()}}t.build=function(e){return new f(e)}})),define("text!views/chat/translator/translatorSettings.html",[],(function(){return'<div class="TranslatorSettings">\r\n    <button class="settingsButton btn transparent circle" data-bind="click: settingsButtonHandler, attr: {\'aria-label\': settingsButtonAriaLabel, title: settingsButtonLabel}, css: {off: !translatorEnabled()}" type="button">\r\n        <span id="settingsButtonLabelId" class="iconfont globe" data-bind="text: settingsButtonLabel"></span>\r\n    </button>\r\n    \x3c!-- ko if: dialogOpened --\x3e\r\n    <div class="SettingsDialog popup arrow up">\r\n        <h4 class="header" data-bind="text: settingsDialogLabel"></h4>\r\n\r\n        <div class="Splitter"></div>\r\n\r\n        <div class="SettingsDialog-toggle">\r\n            <span id="enableTranslator" class="fontSize-p" data-bind="text: translatorToggleText"></span>\r\n            <button aria-labelledby="settingsButtonLabelId" class="toggler" type="button" role="checkbox" aria-relevant="all"\r\n                    data-bind="click: translatorEnabledHandler, event: { keydown: onTranslatorEnabledKeyDown }, css: { checked: translatorEnabled }, attr: { \'aria-checked\': translatorEnabled() ? \'true\' : \'false\', \'aria-label\': settingsButtonLabel}">\r\n                <span class="on"></span>\r\n                <span class="off"></span>\r\n            </button>\r\n        </div>\r\n\r\n        <div class="Splitter"></div>\r\n\r\n        <div class="SettingsDialog-lang">\r\n            <swx-avatar params="avatar: meAvatar, displayName: meDisplayName, useAbsolutePosition: true"></swx-avatar>\r\n            <div class="text" >\r\n                <p data-bind="text: meDisplayName" class="displayName"></p>\r\n                <swx-translator-language-picker params="language: meLanguage, supportedLanguages: availableLanguages, class: \'LanguagePicker-mine\', ariaLabel: meLanguagePickerLabel"></swx-translator-language-picker>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="SettingsDialog-icons">\r\n            <div class="Splitter lang"></div>\r\n            <div class="iconsGroup">\r\n                <div class="chat"><span class="iconfont message"></span></div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class="SettingsDialog-lang bottom">\r\n            <swx-avatar params="avatar: participantAvatar, displayName: participantDisplayName, useAbsolutePosition: true"></swx-avatar>\r\n            <div class="text">\r\n                <p data-bind="text: participantDisplayName" class="displayName"></p>\r\n                <swx-translator-language-picker params="language: participantLanguage, supportedLanguages: availableLanguages, class: \'LanguagePicker-their\', ariaLabel: theirLanguagePickerLabel"></swx-translator-language-picker>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/translatorSettings",["require","exports","module","ui/viewModels/chat/translator/translatorSettings","constants/components","text!views/chat/translator/translatorSettings.html"],(function(e,t){var n=e("ui/viewModels/chat/translator/translatorSettings")
	t.name=e("constants/components").chat.TRANSLATOR_SETTINGS,t.template=e("text!views/chat/translator/translatorSettings.html"),t.viewModel={createViewModel:function(e){var t=n.build(e)
	return t.init(),t}}})),define("ui/viewModels/chat/translator/translatorLanguagePicker",["require","exports","module","browser/dom","vendor/knockout","utils/common/eventHelper","utils/common/scroll","utils/common/outsideClickHandler","swx-focus-handler"],(function(e,t){var n=e("browser/dom"),i=e("vendor/knockout"),r=e("utils/common/eventHelper"),o=e("utils/common/scroll"),a=e("utils/common/outsideClickHandler"),s=e("swx-focus-handler")
	function c(e,t){var c,l=this,u=e.language,d=e.supportedLanguages.sort((function(e,t){return e.name.localeCompare(t.name)})),p=e.class
	function f(){var e
	l.menuOpened(!0),a.add(p,m),(e=n.getElement(".LanguagePicker-item.selected",t))&&e.scrollIntoView()}function m(){var e
	l.menuOpened(!1),a.remove(p),(e=n.getElement(".LanguagePicker-button",t))&&s.get().addFocusRequestToQueue(e)}l.init=function(){l.language=u,l.menuOpened=i.observable(!1),l.supportedLanguages=d,(c=o.build(n.getElement("div.LanguagePicker-content",t))).init(),l.pickerClass={},l.pickerClass[e.class]=!0,l.languageButtonLabel=e.ariaLabel,l.languageButtonHandler=function(){l.menuOpened()?m():f()},l.onLanguageButtonKeyDown=function(e,t){var n=r.isActivation(t)
	return n&&l.languageButtonHandler(),!n},l.languageSelectionHandler=function(e){u(e),m()}},l.dispose=function(){l.menuOpened()&&m(),c.dispose()}}t.build=function(e,t){return new c(e,t)}})),define("text!views/chat/translator/translatorLanguagePicker.html",[],(function(){return'<div class="LanguagePicker" data-bind="css:pickerClass">\r\n    <div class="fontSize-p">\r\n        <a href="#" role="button" class="LanguagePicker-button" data-bind="text: language().name, click: languageButtonHandler, event: { keydown: onLanguageButtonKeyDown }, attr:{\'aria-label\' : languageButtonLabel}"></a>\r\n        <span class="iconfont chevronDown" data-bind="click: languageButtonHandler"></span>\r\n    </div>\r\n\r\n    <div class="LanguagePicker-menu popup arrow up" data-bind="css: {hide: !menuOpened()}">\r\n        <div class="LanguagePicker-content" data-bind="keyboardNavigation: { itemSelector: \'.LanguagePicker-item\' }">\r\n            <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n                <ul role="menu">\r\n                    <li><div class="icons"><span class="iconfont message"></span></div></li>\r\n                    \x3c!-- ko foreach: { data: supportedLanguages, as: \'item\' } --\x3e\r\n                    <li role="menuitem"><span class="LanguagePicker-item fontSize-p" data-bind="text: item.name, click: $parent.languageSelectionHandler, enterKey: $parent.languageSelectionHandler, css:{selected: $parent.language().name === item.name}, attr:{\'aria-label\' : item.name}"></span></li>\r\n                    \x3c!-- /ko --\x3e\r\n                </ul>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/translatorLanguagePicker",["require","exports","module","ui/viewModels/chat/translator/translatorLanguagePicker","constants/components","text!views/chat/translator/translatorLanguagePicker.html"],(function(e,t){var n=e("ui/viewModels/chat/translator/translatorLanguagePicker")
	t.name=e("constants/components").chat.TRANSLATOR_LANGUAGE_PICKER,t.template=e("text!views/chat/translator/translatorLanguagePicker.html"),t.viewModel={createViewModel:function(e,t){var i=t.element,r=n.build(e,i)
	return r.init(),r}}})),define("ui/viewModels/chat/moreActionsButton",["require","exports","module","lodash-compat","vendor/knockout","swx-constants","utils/common/eventMixin","swx-i18n","ui/contextMenu/items/all","swx-service-locator-instance","ui/telemetry/actions/actionNames"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("swx-constants").COMMON,o=e("utils/common/eventMixin"),a=e("swx-i18n").localization,s=e("ui/contextMenu/items/all"),c=e("swx-service-locator-instance").default,l=e("ui/telemetry/actions/actionNames")
	function u(e){var t=this
	t.cssClass=e.cssClass,t.tabIndex=e.tabIndex,t.title=a.fetch({key:"button_text_moreActions"}),t.showMenuOptions=i.observable(!1),t.hasMenuOptions=function(){return!0},t.getMenuOptions=function(){var t=[]
	return c.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(l.conversation.moreActionsButton),t.push(s.AddParticipantsMenuItem.build(e.addParticipantsDisabled,e.addParticipantsAction)),t.push(s.ScheduleCallMenuItem.build(e.conversation)),t}}n.assign(u.prototype,o),t.build=function(e){return new u(e)}})),define("text!views/chat/moreActionsButton.html",[],(function(){return"<swx-button params=\"icon: 'more',\r\n    cssClass: cssClass,\r\n    titleKey: 'button_text_moreActions',\r\n    textKey: 'button_text_moreActions',\r\n    i18nTitle: title,\r\n    ariaLabelKey: 'button_text_moreActions',\r\n    showMenuOptions: showMenuOptions,\r\n    hasMenuOptions: hasMenuOptions,\r\n    menuOptions: getMenuOptions\"></swx-button>\r\n"})),define("ui/components/chat/moreActionsButton",["require","exports","module","vendor/knockout","ui/viewModels/chat/moreActionsButton","constants/components","text!views/chat/moreActionsButton.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/moreActionsButton")
	t.name=e("constants/components").chat.MORE_ACTIONS_BUTTON,t.template=e("text!views/chat/moreActionsButton.html"),t.viewModel={createViewModel:function(e,t){var r=i.build(e),o=n.dataFor(t.element)
	return r.setContext(o),r}}})),define("ui/viewModels/chat/heart",["require","exports","module","vendor/knockout","swx-i18n"],(function(e,t){var n=e("vendor/knockout"),i=e("swx-i18n").localization
	function r(e,t){var r,o=this,a=e.heartsVM,s=["webkitAnimationEnd","animationend","oanimationend"]
	function c(){s.forEach((function(e){t.element.removeEventListener(e,u,!1)}))}function l(){r.dispose(),d(!0),s.forEach((function(e){t.element.addEventListener(e,u,!1)}))}function u(){d(!1),r=o.heartsCount.subscribe(l),c()}function d(e){var t={hasLikes:!!o.heartsCount(),hasMyLike:o.isHeartedByMe(),anim:!!e}
	o.heartCss(t)}o.onClickHandler=a.heartMessage,o.heartsCount=a.heartsCount,o.isHeartedByMe=a.isHeartedByMe,o.heartCss=n.observable({}),o.heartButtonLabel=n.computed((function(){return o.isHeartedByMe()?i.fetch({key:"hearts_accessibility_unlike"}):i.fetch({key:"hearts_accessibility_like"})})),o.dispose=function(){o.heartButtonLabel.dispose(),c(),r.dispose()},d(!1),r=a.heartsCount.subscribe(l)}t.build=function(e,t){return new r(e,t)}})),define("text!views/chat/heart.html",[],(function(){return'<div class="Heart" data-bind="css: heartCss">\r\n    <span class="iconfont clickable" data-bind="click: onClickHandler, attr: {\'aria-label\': heartButtonLabel}" role="button"></span>\r\n    \x3c!-- ko if: (heartsCount && heartsCount() > 1) --\x3e\r\n    <span class="counter" data-bind="text: heartsCount"></span>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/heart",["require","exports","module","ui/viewModels/chat/heart","constants/components","text!views/chat/heart.html"],(function(e,t){var n=e("ui/viewModels/chat/heart")
	t.name=e("constants/components").chat.HEART,t.template=e("text!views/chat/heart.html"),t.viewModel={createViewModel:function(e,t){return n.build(e,t)}}})),define("ui/viewModels/chat/narrator",["require","lodash-compat","utils/common/accessibility","swx-constants","swx-i18n","swx-utils-common","swx-utils-common","swx-utils-chat","utils/common/disposableMixin","swx-utils-chat"],(function(e){var t=e("lodash-compat"),n=e("utils/common/accessibility").narrator,i=e("swx-constants").COMMON,r=e("swx-i18n").localization,o=e("swx-utils-common").builderMixin,a=e("swx-utils-common").async,s=e("swx-utils-chat").messageSanitizer,c=e("utils/common/disposableMixin"),l=e("swx-utils-chat").dateTime
	function u(){var e=this
	function o(n,i){var o,a
	if(!i||(c=i.key,!t.any(e.narrationLog(),(function(e){return null!=e.key&&e.key===c})))){var c
	switch(e.narrationLog().length>=5&&e.narrationLog.splice(0,e.narrationLog().length-4),e.narrationLog().forEach((function(e){e.visible(!1)})),!0){case t.isFunction(n):o=n()
	break
	case t.isObject(n)&&n.hasOwnProperty("key"):o=r.fetch(n)
	break
	default:o=n.toString()}a=s.stripHTML(o),e.narrationLog.push({message:a,timestamp:l.getDate(),visible:e.observable(!0),key:i&&i.key})}}this.narrationLog=this.observableArray().extend({deferred:!0}),this.dispose=function(){},this.registerDisposable(n.on(i.events.browser.NARRATOR_ANNOUNCE,(function(e,n){a.execute(t.partial(o,e,n),null,!1)})))}return t.extend(u.prototype,c),t.extend(u,o),u})),define("text!views/chat/narrator.html",[],(function(){return'<div aria-live="assertive" role="log" class="offScreen">\r\n    \x3c!-- ko foreach: narrationLog --\x3e\r\n    <div>\r\n        <span data-bind="html: message, visible: visible"></span>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n'})),define("ui/components/chat/narrator",["require","exports","module","ui/viewModels/chat/narrator","constants/components","text!views/chat/narrator.html"],(function(e,t){var n=e("ui/viewModels/chat/narrator")
	t.name=e("constants/components").chat.NARRATOR,t.template=e("text!views/chat/narrator.html"),t.viewModel={createViewModel:function(){return n.build()}}})),define("text!views/chat/pes/store/browseTabs.html",[],(function(){return'<div class="overlayControls">\r\n    <h1  class="storeTitle" data-bind="l10n: { \'key\': \'expressionPicker_store_title\' }"></h1>\r\n    <input type="text" data-bind="\r\n        textInput: searchQuery,\r\n        event: {keydown: onSearchBoxKeyDown},\r\n        l10n_attr: {\r\n            \'placeholder\':  \'input_placeholder_searchPESStore\',\r\n            \'aria-label\':   \'input_placeholder_searchPESStore\'\r\n            }" value="" name="query" class="inputField fontSize-h4 store-search" placeholder="Search for items..." aria-label="Search items. Type keyword" data-focusmanager="3" style="">\r\n    <div class="storeSearchIcon"></div>\r\n    <div class="right">\r\n        <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n            <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'pluginInstall_main_text_close\' }"></span>\r\n        </button>\r\n    </div>\r\n</div>\r\n<div class="wrapper swx-pes-store">\r\n    <swx-loading-animation data-bind="visible: showSpinner()" class="spinner blue loading-data"></swx-loading-animation>\r\n    <p class="error" data-bind="visible: showErrorText()">Error Loading Tabs</p>\r\n    <div data-bind="visible: showTabList()" class="tabs-list">\r\n        <ul data-bind="template: { name: \'tab-item-template\', foreach: tabs, as: \'tab\'  }" class="scrollViewport scrollViewportV" tabindex="-1"></ul>\r\n    </div>\r\n    <div  class="tabs-details-wrapper" data-bind="visible: showTabDetails()">\r\n        <div  data-bind="template: { name: \'tab-details-template\', if: selectedTab(), data: selectedTab  }" class="scrollViewport scrollViewportV">\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<script type="text/html" id="tab-item-template">\r\n    <li class="store-tab-item" data-bind="attr: { \'data-name\': tab.id, \'title\': tab.name}, event: {click: $parent.tabSelected}, css: tab.isSelectedCSS, visible: tab.showInList()"\r\n        aria-live="polite" role="listitem">\r\n        <div class="tab-thumbnail" data-bind="style: {backgroundImage:\'url(\'+tab.thumbnail+\')\'}"></div>\r\n        <div class="buy-or-download" data-bind="template: { name: \'buy-download-tab-template\', data: tab }, event: {click: $parent.buyOrDownloadTab}"></div>\r\n        <p class="title"><span class="tab-name" data-bind="text: tab.name"></span></p>\r\n    </li>\r\n<\/script>\r\n\r\n<script type="text/html" id="tab-details-template">\r\n    <div class="store-tab-item-details">\r\n        <div class="buy-or-download" data-bind="template: { name: \'buy-download-tab-detailSection-template\'}, event: {click: $parent.buyOrDownloadTab}"></div>\r\n        <div class="tab-desc">\r\n            <div class="tab-title">\r\n                <h2 class="title" data-bind="text:name"></h2>\r\n                <p class="description" data-bind="text:description"></p>\r\n                <p class="description" data-bind="text:copyright"></p>\r\n            </div>\r\n        </div>\r\n        <div class="pack-items-list">\r\n           <div class="content" data-bind="template: { name: \'pack-items-listing-template\', data: {packs: configData().tabs[0].packs, token: cdnToken()}}"></div>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="pack-items-listing-template">\r\n    <ul data-bind="foreach: { data: packs, as: \'pack\' }">\r\n        <li aria-live="polite" role="listitem">\r\n            <h4 class="pack-title" data-bind="text: pack.title"></h4>\r\n            <div class="pack-items" data-bind="visible: pack.items && pack.items.length, css: \'pack-\'+pack.id">\r\n                <ul data-bind="foreach: { data: pack.items, as: \'item\' }">\r\n                    <li class="item" data-bind="attr: {\'title\': item.pickerTitle}">\r\n                        \x3c!-- ko if: item.type === \'emoticon\' --\x3e\r\n                            <img class="item-thumbnail" data-bind="attr: {src: item.thumbnail}">\r\n                        \x3c!-- /ko --\x3e\r\n                        \x3c!-- ko if: item.type === \'flik\' --\x3e\r\n                            <div  class="moji-item" data-bind="template: { name: \'moji-item-template\', data:{item: item, token: $parents[1].token}}"></div>\r\n                        \x3c!-- /ko --\x3e\r\n                            <p class="item-title" data-bind="text: (item.pickerTitle) ? item.pickerTitle : item.title"></p>\r\n                    </li>\r\n                </ul>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="buy-download-tab-template">\r\n   <div class="buy-download-text" data-bind="visible: !showDownloadSpinner(), style: {cursor: isDownloaded() ? \'default\':\'pointer\'}">\r\n        <span data-bind="css: { tick: isDownloaded(), arrowDown: !isDownloaded() }, style: {backgroundColor: isDownloaded() ? \'#7FBA00\':\'#0078CA\'}" class="iconfont">\r\n        </span>\r\n    </div>\r\n    <div class="download-spinner" data-bind="visible: showDownloadSpinner()">\r\n        <swx-loading-animation class="spinner blue"></swx-loading-animation>\r\n    </div>\r\n    <p data-bind="visible: !isDownloaded(), l10n: { key: \'expressionPicker_store_free\' }"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="buy-download-tab-detailSection-template">\r\n   <div class="buy-download-text" data-bind="visible: !showDownloadSpinner()">\r\n        <span data-bind="css: { cross: isDownloaded(), arrowDown: !isDownloaded() }" class="iconfont">\r\n            <span data-bind="visible: !isDownloaded(), l10n: { key: \'expressionPicker_store_free\' }"></span>\r\n            <span data-bind="visible: isDownloaded(), l10n: { key: \'expressionPicker_store_removeTab\' }"></span>\r\n        </span>\r\n    </div>\r\n    <div class="download-spinner-wrapper" data-bind="visible: showDownloadSpinner()">\r\n        <div class="download-spinner">\r\n            <swx-loading-animation class="spinner white"></swx-loading-animation>\r\n        </div>\r\n        <p data-bind="l10n: { key: \'expressionPicker_store_Downloading\'}"></p>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="moji-item-template">\r\n    <img class="moji-item-thumbnail" data-bind="attr: {src: (token)?item.thumbnail+\'?\'+token : item.thumbnail}">\r\n    <span class="mojimask"></span>\r\n<\/script>\r\n'})),define("services/pes/emoticons/styleKeyFrameFactory",[],(function(){function e(e,n,i,r,o){var a="@"+(r||"")+"keyframes "+e+" { "
	return a+=function(e,n,i,r){r=r||t
	var o=""
	return o+="from { ",o+=r(e),o+="} ",o+="to { ",o+=r(n),o+="} ",o}(n,i,0,o),a+="} \n"}function t(e){return" top: "+e+"; "}function n(e){return" transform: translateY("+e+"); "}function i(t,n,i){var r=-n+"px"
	return e(t,"0",r,"",i)+e(t,"0",r,"-moz-",i)+e(t,"0",r,"-webkit-",i)}function r(){}return r.prototype.create=function(e){var r=i(e.id,e.styleDef.smallHeight,n)
	return r+=i(e.id+"_large",e.styleDef.largeHeight,n),r+=i(e.id+"_extraLarge",e.styleDef.extraLargeHeight,t)},new r})),define("services/pes/emoticons/styleDefinitionFactory",["require","services/pes/constants"],(function(e){var t=e("services/pes/constants")
	return new function(){function e(e){return" top: "+e+";\n -webkit-transform: initial;\ntransform: initial;\n transform: translateZ(0);"}function n(e){return" -webkit-transform: translateY("+e+");\n transform: translateY("+e+");"}function i(e,t,i,r,o,a,s){var c=e.id,l=e.id,u=e.styleDef.duration,d=e.styleDef.frameCount
	a&&(l+="_"+a)
	var p="\n .swx .largeAllowed span.emoticon."+c+".animated"
	return a&&(p+="."+a),p+=" span.emoSprite \n",p+="{ \n",p+=" -ms-high-contrast-adjust: none;\n",p+=" background-image: url('"+t+"');\n",p+=" background-size: "+i+"px "+r+"px; \n",p+=" height: "+r+"px; \n",p+=(s=s||n)(o)+"\n",p+=" -moz-animation: "+l+" "+u+" steps("+d+") infinite; \n",p+=" -webkit-animation: "+l+" "+u+" steps("+d+") infinite; \n",p+=" animation: "+l+" "+u+" steps("+d+") infinite; \n",p+="} "}function r(e,t,i,r,o,a){var s="\n.swx span.emoticon."+e.id+t+" span.emoSprite \n"
	return s+="{\n",s+=" -ms-high-contrast-adjust: none;\n",s+=" background-image: url('"+i+"'); \n",s+=" background-size: "+r+"px "+o+"px; \n",s+=" height: "+o+"px; \n",s+=n(a),s+=" -moz-animation: none; \n",s+=" -webkit-animation: none; \n",s+=" animation: none \n",s+="}"}this.create=function(o){var a=function(e){return r(e,"",e.smallStaticUrl,t.frameHeights.emoticons.SMALL,t.frameHeights.emoticons.SMALL,0)+r(e,".large",e.largeStaticUrl,t.frameHeights.emoticons.LARGE,t.frameHeights.emoticons.LARGE,0)+r(e,".extraLarge",e.extraLargeStaticUrl,t.frameHeights.emoticons.EXTRA_LARGE,t.frameHeights.emoticons.EXTRA_LARGE,0)}(o)
	return a+=function(e){var i=e.id,r=e.styleDef.duration,o=e.styleDef.frameCount,a=e.smallUrl,s=t.frameHeights.emoticons.SMALL,c=e.styleDef.smallOffset,l=e.styleDef.smallHeight,u="\n.swx span.emoticon."+e.id+".animated span.emoSprite, \n"
	return u+=".swx span.emoticon."+e.id+".large.animated span.emoSprite, \n",u+=".swx span.emoticon."+e.id+".extraLarge.animated span.emoSprite, \n",u+=".swx .largeAllowed span.emoticon."+e.id+".animated span.emoSprite",u+="{ \n",u+=" -ms-high-contrast-adjust: none;\n",u+=" background-image: url('"+a+"'); \n",u+=" background-size: "+s+"px "+l+"px; \n",u+=" height: "+l+"px; \n",u+=n(c),u+=" -webkit-animation: "+i+" "+r+" steps("+o+") infinite; \n",u+=" -moz-animation: "+i+" "+r+" steps("+o+") infinite; \n",u+=" animation: "+i+" "+r+" steps("+o+") infinite; \n",u+="} "}(o),a+=function(e){var n=e.largeUrl,r=t.frameHeights.emoticons.LARGE,o=e.styleDef.largeHeight,a=e.styleDef.largeOffset
	return i(e,n,r,o,a,"large")}(o),a+=function(n){var r=n.extraLargeUrl,o=t.frameHeights.emoticons.EXTRA_LARGE,a=n.styleDef.extraLargeHeight,s=n.styleDef.extraLargeOffset
	return i(n,r,o,a,s,"extraLarge",e)}(o),a}}})),define("services/pes/emoticons/stylesFactory",["require","services/pes/constants","services/pes/emoticons/styleKeyFrameFactory","services/pes/emoticons/styleDefinitionFactory"],(function(e){var t=e("services/pes/constants"),n=e("services/pes/emoticons/styleKeyFrameFactory"),i=e("services/pes/emoticons/styleDefinitionFactory")
	return new function(){this.create=function(e){return function(e){var n=e.media.default,i=(n.firstFrame<n.framesCount?n.firstFrame:n.framesCount-1)||0
	e.styleDef={frameCount:n.framesCount,firstFrame:i,duration:n.framesCount/24+"s",smallHeight:t.frameHeights.emoticons.SMALL*n.framesCount,smallOffset:-i*t.frameHeights.emoticons.SMALL,largeHeight:t.frameHeights.emoticons.LARGE*n.framesCount,largeOffset:-i*t.frameHeights.emoticons.LARGE,extraLargeHeight:t.frameHeights.emoticons.EXTRA_LARGE*n.framesCount,extraLargeOffset:-i*t.frameHeights.emoticons.EXTRA_LARGE},0!==e.styleDef.smallOffset&&(e.styleDef.smallOffset+="px")
	0!==e.styleDef.largeOffset&&(e.styleDef.largeOffset+="px")
	0!==e.styleDef.extraLargeOffset&&(e.styleDef.extraLargeOffset+="px")}(e),n.create(e)+i.create(e)}}})),define("services/pes/emoticons/fetcher",["require","lodash-compat","swx-constants","services/pes/constants","utils/chat/pesUtils","swx-service-locator-instance","experience/settings","services/pes/emoticons/stylesFactory","utils/common/url"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("services/pes/constants"),r=e("utils/chat/pesUtils"),o=e("swx-service-locator-instance").default,a=e("experience/settings"),s=e("services/pes/emoticons/stylesFactory"),c=e("utils/common/url")
	return new function(){function e(e,t){return c.buildUrl(e,{etag:t})}this.process=function(){return null},this.getResources=function(c,l){var u,d,p,f=[],m=o.resolve(n.serviceLocator.FEATURE_FLAGS)
	return c.type!==i.itemTypes.emoticon.id?null:(d=[],p=l.emoticonsRoot+"/"+c.id+"/views/",c.shortcuts.forEach((function(e){d.push({shortcut:e,id:c.id,type:i.itemTypes.emoticon.id})})),u=function(t,s){var c=o.resolve(n.serviceLocator.FEATURE_FLAGS)
	c.isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)&&(t=r.rewriteUrls(t,a.pesCDNAuthentication.rewriteRules))
	return{smallStaticUrl:e(t+i.profiles.emoticons.getSmall(),s),largeStaticUrl:e(t+i.profiles.emoticons.getLarge(),s),extraLargeStaticUrl:e(t+i.profiles.emoticons.getExtraLarge(),s),smallUrl:e(t+i.profiles.emoticons.getSmallAnimated(),s),largeUrl:e(t+i.profiles.emoticons.getLargeAnimated(),s),extraLargeUrl:e(t+i.profiles.emoticons.getExtraLargeAnimated(),s)}}(p,c.etag),t.extend(c,u),m.isFeatureOn(n.featureFlags.PES_FETCH_SMALL_ASSETS_ON_DEMAND)||(f.push(c.smallUrl),f.push(c.smallStaticUrl)),m.isFeatureOn(n.featureFlags.PES_FETCH_MEDIUM_ASSETS_ON_DEMAND)||(f.push(c.largeUrl),f.push(c.largeStaticUrl)),m.isFeatureOn(n.featureFlags.PES_FETCH_LARGE_ASSETS_ON_DEMAND)||(f.push(c.extraLargeUrl),f.push(c.extraLargeStaticUrl)),{styleDef:m.isFeatureOn(n.featureFlags.CANVAS_EMOTICONS_ENABLED)?"":s.create(c),prefetchUrls:f,encoderMaps:d})}}}))
	define("services/pes/emoticons/renderLoop",["require","lodash-compat","swx-constants","services/pes/constants","browser/window","utils/chat/pesUtils","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("services/pes/constants"),r=e("browser/window"),o=e("utils/chat/pesUtils"),a=e("swx-service-locator-instance").default,s={firstFrame:0,framesCount:1,fps:1},c={INVALID:"invalid",TRANSIENT:"transient"}
	function l(e,t,n){return e.dataset?e.dataset[t]:e.getAttribute("data-"+n)}function u(e,t,n,i){e.dataset?e.dataset[t]=i:e.setAttribute("data-"+n,i)}function d(e,t){this.url=e,this.mediaInfo=t}function p(e,t){var n,i=e.getContext("2d"),r=c.INVALID,o=this.image.naturalWidth
	i.clearRect(0,0,e.width,e.width),n=1===this.mediaInfo.framesCount?0:Math.floor(t*this.mediaInfo.fps)%this.mediaInfo.framesCount,l(e,"drawState","draw-state")!==c.TRANSIENT&&u(e,"drawState","draw-state",r),i.drawImage(this.image,0,o*n,o,o,0,0,e.width,e.width)}function f(e,t){this.smallAnimated=new d(o.buildEmoticonUrl(e,t,"small",!0),t.media.default),this.largeAnimated=new d(o.buildEmoticonUrl(e,t,"large",!0),t.media.default),this.extraLargeAnimated=new d(o.buildEmoticonUrl(e,t,"extraLarge",!0),t.media.default),this.smallStatic=new d(o.buildEmoticonUrl(e,t,"small",!1),s),this.largeStatic=new d(o.buildEmoticonUrl(e,t,"large",!1),s),this.extraLargeStatic=new d(o.buildEmoticonUrl(e,t,"extraLarge",!1),s)}return d.prototype.draw=function(e,t){var n=this,i=r.Image
	this.image=new i,this.image.onload=function(){n.draw=p,n.draw(e,t)},this.draw=function(){},this.image.src=this.url},new function(){var e=this,o=!1,s=-1313,p=0,m=1
	function h(n){if(n-s>=p){s=n
	var a=document.querySelectorAll(".swx span.emoticon canvas")
	t.forEach(a,(function(t){var o=t.getBoundingClientRect()
	if(!(o.width<=2)&&function(e){return e.bottom>0&&e.right>0&&e.top<r.innerHeight&&e.left<r.innerWidth}(o)){(function(e,t){var n=t.width*m
	if(e.width===n&&e.height===n)return
	e.width=n,e.height=n,l(e,"drawState","draw-state")!==c.TRANSIENT&&u(e,"drawState","draw-state",c.INVALID)})(t,o)
	var a=l(t,"itemId","item-id"),s=e._imageCache[a],d="true"===l(t,"isAnimated","is-animated")
	try{s&&function(e,t,n,r,o){var a
	a=n<=i.frameHeights.emoticons.SMALL?"small":n<=i.frameHeights.emoticons.LARGE?"large":"extraLarge"
	t[a+(r?"Animated":"Static")].draw(e,o)}(t,s,o.width,d,n/1e3)}catch(p){}}}))}o&&r.requestAnimationFrame(h)}this._imageCache={},this.isRunning=function(){return o},this.start=function(){"devicePixelRatio"in r&&(m=r.devicePixelRatio),o=!0,s=-1313,r.requestAnimationFrame(h)},this.stop=function(){o=!1},this.updateCache=function(){var r=a.resolve(n.serviceLocator.PES_CONFIG_SERVICE).getConfiguration(),o=0
	t.forEach(r.items,(function(t){e._imageCache[t.id]||t.type!==i.itemTypes.emoticon.id||(e._imageCache[t.id]=new f(r.emoticonsRoot,t),t.media&&t.media.default&&t.media.default.fps>o&&(o=t.media.default.fps))})),0!==o&&(p=Math.floor(1e3/o))},this._CacheItem=f,this._DrawStateMachine=d}})),define("services/pes/mojis/stylesFactory",["require","services/pes/constants"],(function(e){var t=e("services/pes/constants")
	return new function(){this.create=function(e){var n=function(e){var n=e.thumbnailUrl,i=t.frameHeights.moji.THUMBNAIL,r="\n.swx span.moji.id_"+e.id+" span.mojiThumbnail \n"
	return r+="{\n",r+=" -ms-high-contrast-adjust: none;\n",r+=" background-image: url('"+n+"'); \n",r+=" height: "+i+"px; \n",r+=" background-size: 100%; \n",r+="}"}(e)
	return n+=function(e){var t=e.thumbnailUrl,n="\n.swx span.moji.id_"+e.id+" span.keyframe \n"
	return n+="{\n",n+=" -ms-high-contrast-adjust: none;\n",n+=" background-image: url('"+t+"'); \n",n+=" height: 100%; \n",n+=" background-size: 100%; \n",n+=" border-radius: 8px; \n",n+=" display: block; \n",n+="}"}(e),n}}})),define("services/pes/mojis/fetcher",["require","services/pes/constants","services/pes/mojis/stylesFactory","utils/chat/pesUtils","swx-service-locator-instance","swx-constants","experience/settings"],(function(e){var t=e("services/pes/constants"),n=e("services/pes/mojis/stylesFactory"),i=e("utils/chat/pesUtils"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("experience/settings")
	return new function(){this.process=function(){return null},this.getResources=function(e,s){var c=[]
	if(e.type!==t.itemTypes.moji.id)return null
	var l=s.itemsRoot+"/"+e.id+"/views/",u=r.resolve(o.serviceLocator.FEATURE_FLAGS)
	return u.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&(l=i.rewriteUrls(l,a.pesCDNAuthentication.rewriteRules)),e.thumbnailUrl=l+t.profiles.moji.thumbnail,s._requiresCDNUrlAuthentication&&(e.thumbnailUrl=e.thumbnailUrl+"?"+s._cdnToken),u.isFeatureOn(o.featureFlags.PES_FETCH_MOJI_ASSETS_ON_DEMAND)||c.push(e.thumbnailUrl),{styleDef:n.create(e),prefetchUrls:c,encoderMaps:[]}}}})),define("utils/common/prefetcher",["require","ui/controls/calling/sounds"],(function(e){var t=e("ui/controls/calling/sounds"),n=["m4a","ogg"],i=[t.KEYS.CALL_ANSWER,t.KEYS.CALL_DIALING,t.KEYS.CALL_OUTGOING_P1,t.KEYS.CALL_OUTGOING_P2,t.KEYS.CALL_INCOMING,t.KEYS.MESSAGE_RECEIVED_1]
	return{prefetchAssets:function(){var e=document.createDocumentFragment();(function(e){i.forEach((function(i){n.forEach((function(n){var r=t.buildSoundAssetUrl(i,n);(function(e,t){var n=function(e){var t=document.createElement("link")
	return t.rel="prefetch",t.href=e,t}(t)
	e.appendChild(n)})(e,r)}))}))})(e),document.head.appendChild(e)},prefetchImages:function(e){for(var t=[],n=e.length,i=0;i<n;i++){var r=new Image
	r.src=e[i],t[i]=r}}}})),define("services/pes/tabs/stylesFactory",[],(function(){return new function(){this.create=function(e){return function(e){var t="\n.swx .tab_id_"+e.id+"\n"
	return t+="{\n",t+=" -ms-high-contrast-adjust: none;\n",t+=" background-image: url('"+e.thumbnailUrl+"'); \n",t+="} \n"}(e)}}})),define("services/pes/tabs/fetcher",["require","services/pes/tabs/stylesFactory","services/pes/constants"],(function(e){var t=e("services/pes/tabs/stylesFactory"),n=e("services/pes/constants")
	return new function(){this.process=function(){return null},this.getResources=function(e){return e.type!==n.itemTypes.tab.id?null:{styleDef:t.create(e),prefetchUrls:[e.thumbnailUrl],encoderMaps:[]}}}})),define("services/pes/configProcessor",["require","lodash-compat","swx-constants","swx-emoticon-map-instance","services/pes/emoticons/fetcher","services/pes/emoticons/renderLoop","services/pes/mojis/fetcher","services/pes/constants","utils/common/prefetcher","swx-service-locator-instance","services/pes/tabs/fetcher"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=e("swx-emoticon-map-instance"),r=e("services/pes/emoticons/fetcher"),o=e("services/pes/emoticons/renderLoop"),a=e("services/pes/mojis/fetcher"),s=e("services/pes/constants"),c=e("utils/common/prefetcher"),l=e("swx-service-locator-instance").default,u=e("services/pes/tabs/fetcher")
	return new function(){var e=this
	e.process=function(t){t.tabs.forEach((function(n,i){u.process(n,i),n.packs.forEach((function(n){n.items.forEach((function(n){e._processItem(n,t,"process")}))}))}))},e._processItem=function(e,t,n){if(n=n||"process",!e)throw new Error("Ad hoc fetching is not implemented, yet!")
	switch(e.type){case s.itemTypes.emoticon.id:return r[n](e,t)
	case s.itemTypes.moji.id:return a[n](e,t)
	case s.itemTypes.sticker.id:throw new Error("Stickers are not implemented, yet!")
	default:throw new Error(e.type+" is not supported, yet!")}},e.prefetch=function(i){var r=[],a=[],s=[],c=t.cloneDeep(i,(function(e){return e&&t.isFunction(e.then)?{}:void 0})),d=l.resolve(n.serviceLocator.FEATURE_FLAGS)
	return c.tabs.forEach((function(t){var n=u.getResources(t)
	r.push(n.styleDef),a.splice(0,0,n.prefetchUrls[0]),t.packs.forEach((function(t){t.items.forEach((function(t){var n=e._processItem(t,i,"getResources")
	r.push(n.styleDef),n.encoderMaps.forEach((function(e){s.push(e)})),n.prefetchUrls.forEach((function(e){a.push(e)}))}))}))})),d.isFeatureOn(n.featureFlags.CANVAS_EMOTICONS_ENABLED)&&(o.isRunning()||o.start(),o.updateCache()),{pesStyles:r,prefetchUrls:a,encodingMaps:s}},e.register=function(e){var t=""
	i.map={},e.encodingMaps.forEach((function(e){switch(e.type){case s.itemTypes.emoticon.id:i.map[e.shortcut]=e.id
	break
	case s.itemTypes.tab.id:case s.itemTypes.moji.id:case s.itemTypes.sticker.id:throw new Error("mapping.type not implemented yet:"+e.type)
	default:throw new Error("mapping.type not supported yet:"+e.type)}})),e.pesStyles.forEach((function(e){t+=e})),function(e){var t,n,i;(i=document.getElementById("pesStyles"))||(n=document.head,(i=document.createElement("style")).id="pesStyles",i.type="text/css")
	i.styleSheet?i.styleSheet.cssText=e:(t=document.createTextNode(e),i.firstChild&&i.removeChild(i.firstChild),i.appendChild(t))
	n&&n.appendChild(i)}(t)},e.prefetchImages=function(e){c.prefetchImages(e.prefetchUrls||[])}}})),define("services/i18n/cultureInfo",[],(function(){return new function(){var e,t=this,n=[{language:"am",defaultLocale:"am-et"},{language:"ar",defaultLocale:"ar-sa"},{language:"bg",defaultLocale:"bg-bg"},{language:"bn",defaultLocale:"bn-in"},{language:"ca",defaultLocale:"ca-es"},{language:"cs",defaultLocale:"cs-cz"},{language:"cy",defaultLocale:"cy-gb"},{language:"da",defaultLocale:"da-dk"},{language:"de",defaultLocale:"de-de"},{language:"el",defaultLocale:"el-gr"},{language:"en",defaultLocale:"en-us"},{language:"es",defaultLocale:"es-es"},{language:"et",defaultLocale:"et-ee"},{language:"eu",defaultLocale:"eu-es"},{language:"fa",defaultLocale:"fa-ir"},{language:"fi",defaultLocale:"fi-fl"},{language:"fil",defaultLocale:"fil-ph"},{language:"fr",defaultLocale:"fr-fr"},{language:"gl",defaultLocale:"gl-es"},{language:"gu",defaultLocale:"gu-in"},{language:"he",defaultLocale:"he-il"},{language:"hi",defaultLocale:"hi-in"},{language:"hr",defaultLocale:"hr-hr"},{language:"hu",defaultLocale:"hu-hu"},{language:"id",defaultLocale:"id-id"},{language:"is",defaultLocale:"is-is"},{language:"it",defaultLocale:"it-it"},{language:"ja",defaultLocale:"ja-jp"},{language:"kk",defaultLocale:"kk-kz"},{language:"kn",defaultLocale:"kn-in"},{language:"ko",defaultLocale:"ko-kr"},{language:"ku",defaultLocale:"ku-arab-iq"},{language:"lt",defaultLocale:"lt-lt"},{language:"lv",defaultLocale:"lv-lv"},{language:"ml",defaultLocale:"ml-in"},{language:"mr",defaultLocale:"mr-in"},{language:"ms",defaultLocale:"ms-my"},{language:"nb",defaultLocale:"nb-no"},{language:"nl",defaultLocale:"nl-nl"},{language:"nn",defaultLocale:"nn-no"},{language:"or",defaultLocale:"or-in"},{language:"pl",defaultLocale:"pl-pl"},{language:"pt",defaultLocale:"pt-PT"},{language:"pt-pt",defaultLocale:"pt-PT"},{language:"pt-br",defaultLocale:"pt-BR"},{language:"ro",defaultLocale:"ro-ro"},{language:"ru",defaultLocale:"ru-ru"},{language:"sk",defaultLocale:"sk-sk"},{language:"sl",defaultLocale:"sl-si"},{language:"sr",defaultLocale:"sr-cyrl-rs"},{language:"sr-cyrl",defaultLocale:"sr-cyrl-rs"},{language:"sr-latn",defaultLocale:"sr-latn-rs"},{language:"sv",defaultLocale:"sv-se"},{language:"sw",defaultLocale:"sw-ke"},{language:"ta",defaultLocale:"ta-in"},{language:"te",defaultLocale:"te-in"},{language:"th",defaultLocale:"th-th"},{language:"tr",defaultLocale:"tr-tr"},{language:"uk",defaultLocale:"uk-ua"},{language:"ur",defaultLocale:"ur-pk"},{language:"vi",defaultLocale:"vi-vn"},{language:"zh",defaultLocale:"zh-cn"},{language:"zh-hant",defaultLocale:"zh-tw"},{language:"zh-cht",defaultLocale:"zh-tw"},{language:"zh-hk",defaultLocale:"zh-tw"},{language:"zh-mo",defaultLocale:"zh-tw"}],i=[{locale:"am-et",pesLocale:"am"},{locale:"ar-sa",pesLocale:"ar"},{locale:"az-latn-az",pesLocale:"az"},{locale:"be-by",pesLocale:"be-BY"},{locale:"bg-bg",pesLocale:"bg"},{locale:"bn-bd",pesLocale:"bn"},{locale:"bn-in",pesLocale:"bn"},{locale:"bs-latn-ba",pesLocale:"bs-Latn-BA"},{locale:"ca-es",pesLocale:"ca"},{locale:"ca-es-valencia",pesLocale:"ca"},{locale:"cs-cz",pesLocale:"cs"},{locale:"cy-gb",pesLocale:"cy-GB"},{locale:"da-dk",pesLocale:"da"},{locale:"de-de",pesLocale:"de"},{locale:"el-gr",pesLocale:"el"},{locale:"en-gb",pesLocale:"en"},{locale:"en-us",pesLocale:"en"},{locale:"es-es",pesLocale:"es"},{locale:"et-ee",pesLocale:"et"},{locale:"eu-es",pesLocale:"eu"},{locale:"fa-ir",pesLocale:"fa"},{locale:"fi-fl",pesLocale:"fi"},{locale:"fil-ph",pesLocale:"fil_PH"},{locale:"fr-fr",pesLocale:"fr"},{locale:"gd-gb",pesLocale:"gd-GB"},{locale:"gl-es",pesLocale:"gl"},{locale:"gu-in",pesLocale:"gu-IN"},{locale:"he-il",pesLocale:"he"},{locale:"hi-in",pesLocale:"hi"},{locale:"hr-hr",pesLocale:"hr"},{locale:"hu-hu",pesLocale:"hu"},{locale:"id-id",pesLocale:"id"},{locale:"is-is",pesLocale:"is"},{locale:"it-it",pesLocale:"it"},{locale:"ja-jp",pesLocale:"ja"},{locale:"ka-ge",pesLocale:"ka-GE"},{locale:"kk-kz",pesLocale:"kk"},{locale:"kn-in",pesLocale:"kn"},{locale:"ko-kr",pesLocale:"ko"},{locale:"ku-arab-iq",pesLocale:"ku-Arab-IQ"},{locale:"lb-lu",pesLocale:"lb-LU"},{locale:"lt-lt",pesLocale:"lt"},{locale:"lv-lv",pesLocale:"lv"},{locale:"mk-mk",pesLocale:"mk"},{locale:"ml-in",pesLocale:"ml"},{locale:"mr-in",pesLocale:"mr-IN"},{locale:"ms-my",pesLocale:"ms"},{locale:"nb-no",pesLocale:"no"},{locale:"nl-nl",pesLocale:"nl"},{locale:"nn-no",pesLocale:"no"},{locale:"or-in",pesLocale:"or-IN"},{locale:"pl-pl",pesLocale:"pl"},{locale:"pt-pt",pesLocale:"pt-PT"},{locale:"pt-br",pesLocale:"pt-BR"},{locale:"ro-ro",pesLocale:"ro"},{locale:"ru-ru",pesLocale:"ru"},{locale:"sk-sk",pesLocale:"sk"},{locale:"sl-sl",pesLocale:"sl"},{locale:"sq-al",pesLocale:"sq"},{locale:"sr-cyrl-ba",pesLocale:"sr"},{locale:"sr-cyrl-rs",pesLocale:"sr"},{locale:"sr-latn-rs",pesLocale:"sr"},{locale:"sv-se",pesLocale:"sv"},{locale:"sw-ke",pesLocale:"sw"},{locale:"ta-in",pesLocale:"ta"},{locale:"te-in",pesLocale:"te"},{locale:"th-th",pesLocale:"th"},{locale:"tr-tr",pesLocale:"tr"},{locale:"uk-ua",pesLocale:"uk"},{locale:"ur-pk",pesLocale:"ur-PK"},{locale:"uz-latn-uz",pesLocale:"uz"},{locale:"vi-vn",pesLocale:"vi"},{locale:"zh-cn",pesLocale:"zh_Hans"},{locale:"zh-tw",pesLocale:"zh_Hant"}]
	function r(t){for(e=0;e<i.length;e++)if(i[e].locale.toLowerCase()===t.toLowerCase())return i[e]}t.getPesLocale=function(e){var n,i
	return e&&((n=r(e))&&n.pesLocale||(i=t.getLocale(e))!==e&&(n=r(i)))?n.pesLocale:"default"},t.getLocale=function(i){var r,o=function(t){for(e=0;e<n.length;e++)if(n[e].language.toLowerCase()===t.toLowerCase())return n[e]}(i)
	return o?o.defaultLocale:(r=i.lastIndexOf("-"))>-1?t.getLocale(i.substring(0,r)):i}}})),define("services/pes/configSync",["require","lodash-compat","swx-cafe-application-instance","services/ecs/configLoader","services/pes/configProcessor","swx-constants","services/i18n/cultureInfo","swx-enums","services/pes/constants","utils/chat/pesUtils","swx-pubsub-instance","reqwest","swx-service-locator-instance","experience/settings","browser/window"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("services/ecs/configLoader"),r=e("services/pes/configProcessor"),o=e("swx-constants").COMMON,a=e("services/i18n/cultureInfo"),s=e("swx-enums"),c=e("services/pes/constants"),l=e("utils/chat/pesUtils"),u=e("swx-pubsub-instance").default,d=e("reqwest"),p=e("swx-service-locator-instance").default,f=e("experience/settings"),m=e("browser/window")
	return new function(){var e,h=this,v=0
	function g(){function t(){return new Promise((function(e){v=m.setTimeout(e,f.pesCDNAuthentication.cdnTokenTtlMs)})).then((function(){return n.get().signInManager._skypeToken()})).then(y).then(b).then(t)}e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&f.pesCDNAuthentication.cdnTokenTtlMs>0&&(t().catch((function(e){console.error(e)})).then(t),n.get().signInManager.state.when(s.loginState.SignedOut,(function(){h.dispose()})))}function y(e){var t={headers:{Authorization:"skype_token "+e},url:"https://"+f.pesCDNAuthentication.skypeServiceHost+f.pesCDNAuthentication.tokenSourceEndpoint,dataType:"json",crossOrigin:!0}
	return Promise.resolve(d.compat(t)).catch((function(){return{token:"dummy_token"}})).then((function(e){var t=p.resolve(o.serviceLocator.PES_CONFIG_SERVICE)
	return h.latestToken=e.token,t.cdnTokenUpdated(e.token),u.publish(o.events.personalExpression.CDN_TOKEN_UPDATED,e.token),e.token}))}function b(e){var t=function(e){return{url:"https://"+f.pesCDNAuthentication.cdnServiceHost+f.pesCDNAuthentication.cookieSourceEndpoint+"?vdms_skype_token="+e,dataType:"json",crossOrigin:!0,withCredentials:!0}}(e)
	return Promise.resolve(d.compat(t)).catch((function(){return!0}))}h.latestToken="",h.init=function(){var u
	function m(n){if(e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_URL_FALLBACK_ENABLED)){var i,a,s=t.find(n.items,(function(e){return e.type===c.itemTypes.moji.id}))
	if(s)return a=n.itemsRoot+"/"+s.id+"/views/meta.default",i={dataType:"json",withCredentials:!0,url:l.rewriteUrls(a,f.pesCDNAuthentication.rewriteRules),crossOrigin:!0},Promise.resolve(d.compat(i)).then((function(){u.init(n)
	var e=r.prefetch(u.getConfiguration())
	r.register(e)})).catch((function(){h._requiresCDNUrlAuthentication=!0,n._requiresCDNUrlAuthentication=!0,n._cdnToken=h.latestToken,u.init(n)
	var e=r.prefetch(u.getConfiguration())
	r.register(e)}))}else{u.init(n)
	var p=r.prefetch(u.getConfiguration())
	r.register(p)}}function v(e){throw console.error(e),e}return e=p.resolve(o.serviceLocator.FEATURE_FLAGS),f.locale=f.locale||{},f.initParams=f.initParams||{},f.locale.pes=a.getPesLocale(f.initParams.locale),u=p.resolve(o.serviceLocator.PES_CONFIG_SERVICE),(f.pesConfigUrl?Promise.resolve({pes_config:f.pesConfigUrl}):n.get().personsAndGroupsManager.mePerson.id.get().then((function(e){return i.loadConfig(s.ecsClientNames.Skype,f.ecsPesKey,e)}))).then((function(e){return{configurationLoaded:new Promise((function(e){n.get().signInManager.state.once(s.loginState.SignedIn,e)})).then(h.fetchConfiguration.bind(null,e.pes_config)).then(m).then(g).catch(v)}})).catch(v)},h.fetchConfiguration=function(i){function r(n,i){var r,a=t.extend(i||{},{dataType:"json",crossOrigin:!0})
	return e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&(n=l.rewriteUrls(n,f.pesCDNAuthentication.rewriteRules),a.withCredentials=!0),a.url=n,r=Promise.resolve(d.compat(a)),e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&(r=r.catch((function(){var e=t.extend(i||{},{dataType:"json",crossOrigin:!0})
	return e.url=n+"?"+h.latestToken,Promise.resolve(d.compat(e))}))),r}return(s=Promise.resolve(),e.isFeatureOn(o.featureFlags.PES_CDN_AUTH_ENABLED)&&(a=n.get().signInManager._skypeToken(),s=Promise.resolve(a).then(y).then(b)),s).then((function(){return r(i.replace("/default","/"+f.locale.pes))})).catch((function(){return r(i)})).catch((function(){throw new Error("no pes configuration service endpoint")}))
	var a,s},h.dispose=function(){v&&m.clearTimeout(v)}}})),define("services/store/pes/catalogItemProcessor",["require","exports","module","lodash-compat","services/pes/constants","services/pes/tabs/stylesFactory","services/pes/mojis/stylesFactory","services/pes/emoticons/stylesFactory","utils/chat/pesUtils","services/pes/configProcessor","experience/settings"],(function(e,t){var n=e("lodash-compat"),i=e("services/pes/constants"),r=e("services/pes/tabs/stylesFactory"),o=e("services/pes/mojis/stylesFactory"),a=e("services/pes/emoticons/stylesFactory"),s=e("utils/chat/pesUtils"),c=e("services/pes/configProcessor"),l=e("experience/settings")
	function u(e,t){var n,i,r=t.packs
	for(n=0;n<r.length;n++)if((i=r[n]).id===e)return i.itemIds=i.items,i.isHidden=!1,i.items=[],d(i,t),i}function d(e,t){var n,r,o=t.items
	for(n=0;n<o.length;n++)r=o[n],e.itemIds.indexOf(r.id)>-1&&(r.thumbnail=r.type===i.itemTypes.moji.id?t.itemsRoot+"/"+r.id+"/views/thumbnail":t.emoticonsRoot+"/"+r.id+"/views/default_40",e.items.push(r))}function p(e,t,r,s,c){return n.forEach(t,(function(t){t.type===i.itemTypes.moji.id?(t.thumbnailUrl=s?t.thumbnail+"?"+r:t.thumbnail,e+=o.create(t),t.thumbnailClass="id_"+t.id+" thumbnail",t.keyframeClass="id_"+t.id+" keyframe",t.contentUrl=c.itemsRoot+"/"+t.id+"/views/"+i.profiles.moji.content,s&&(t.contentUrl+="?"+r)):e+=a.create(t)})),e}t.processTabConfig=function(e){var t,n,r,o,a=e.tabs
	for(e.itemsRoot=s.rewriteUrls(e.itemsRoot,l.pesCDNAuthentication.rewriteRules),t=0;t<a.length;t++)for((r=a[t]).packs=[],r.type||(r.type=i.itemTypes.tab.id),r.thumbnailUrl||(r.thumbnailUrl=e.tabsRoot+"/"+r.id+"/views/thumbnail"),n=0;r.sections&&n<r.sections.length;n++)(o=u(r.sections[n].pack,e)).parentTab=r,r.packs.push(o)
	c.process(e)},t.processSKUs=function(e){e.forEach((function(e){var t=e.attributes
	t&&(e.bgColor="#"+t.glyphBgColor.substring(0,6),e.opacity=parseInt(t.glyphBgColor.substring(6,8),16)/255,e.items=t.items.__metadata.links.self,e.copyright=t.copyright,e.expiry=t.expiry)}))},t.loadStyles=function(e,t,n){(function(e,t,n){if(e){var i,o,a,s=r.create(e.tabs[0]),c=e.tabs[0].packs
	for(a=0;a<c.length;a++)s=p(s,c[a].items,t,n,e),i=document.createElement("style"),o=document.createTextNode(s),i.appendChild(o),document.head.appendChild(i)}})(e,t,n)}})),define("ui/viewModels/chat/pes/store/browseTabs",["require","lodash-compat","vendor/knockout","swx-constants","browser/dom","utils/common/scroll","swx-service-locator-instance","swx-constants","utils/common/eventHelper","services/pes/interactors/store","services/pes/interactors/picker","services/pes/configSync","services/store/pes/catalogItemProcessor","utils/common/outsideClickHandler"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-constants").KEYS,r=e("browser/dom"),o=e("utils/common/scroll"),a=e("swx-service-locator-instance").default,s=e("swx-constants").COMMON,c=e("utils/common/eventHelper"),l=e("services/pes/interactors/store"),u=e("services/pes/interactors/picker"),d=e("services/pes/configSync"),p=e("services/store/pes/catalogItemProcessor"),f=e("utils/common/outsideClickHandler")
	function m(e,m){var h=this,v=[],g=o.build(r.getElement(".tabs-list",e)),y=o.build(r.getElement(".tabs-details-wrapper",e)),b=a.resolve(s.serviceLocator.PES_STORE_SERVICE),_=a.resolve(s.serviceLocator.FEATURE_FLAGS),E=[],w=[]
	function S(){h.showSpinner(!1),h.showErrorText(!1),h.showTabList(!0),h.showTabDetails(!0)}function x(t){h.showSpinner(!1),h.showErrorText(!1),h.showTabDetails(!0),h.showTabList(!0),h.selectedTab(t),y.scrollToElement(r.getElement(".store-tab-item-details",e))}function C(e){e.isDownloaded=n.observable(!1),e.showDownloadSpinner=n.observable(!1),e.thumbnailUrl=e.thumbnail,e.configData=n.observable(!1),e.showInList=n.observable(!0),e.cdnToken=n.observable(!1),e.isSelectedCSS=n.pureComputed((function(){return this.selectedTab().id===e.id?"selected":""}),h),-1!==E.indexOf(e.id)&&-1===w.indexOf(e.id)&&e.isDownloaded(!0)}function T(){h.tabs().length||(h.showSpinner(!0),h.showErrorText(!1),h.showTabDetails(!1),h.showTabList(!1)),E=h.pickerState&&h.pickerState.purchasedTabIds?h.pickerState.purchasedTabIds:[],w=h.pickerState&&h.pickerState.hiddenTabIds?h.pickerState.hiddenTabIds:[],b.loadCatalog().then((function(e){var t,n
	for(S(),t=0;e&&t<e.length;t++)n=e[t],-1===v.indexOf(n.id)&&(C(n),h.tabs.push(n),v.push(n.id))
	!h.selectedTab()&&h.tabs()[0]&&h.tabSelected(h.tabs()[0])}),(function(){h.showSpinner(!1),h.tabs().length||h.showErrorText(!0)}))}function I(e){return Promise.resolve(b.getItems(e.items)).then((function(t){return e.configData(t),t})).catch((function(){return[]}))}function A(e){return e.itemsLoaded?Promise.resolve(e.configData()):I(e)}function M(e){var t=e.configData()
	p.loadStyles(t,d.latestToken,d._requiresCDNUrlAuthentication),l.putNewPurchasedTab.run(h.pickerState,e.id,t),u.mruStateUpdater.run(h.pickerState),h.pickerVM.applyState(h.pickerState),e.showDownloadSpinner(!1),e.isDownloaded(!0)}g.init(),y.init(),h.showSpinner=n.observable(!1),h.showErrorText=n.observable(!1),h.showTabList=n.observable(!1),h.showTabDetails=n.observable(!1),h.tabs=n.observableArray(),h.selectedTab=n.observable(!1),h.searchQuery=n.observable(""),m&&(h.modalDialog=m.storeModalDialog||!1,h.pickerVM=m.pickerVM||!1,h.pickerState=m.pickerState||!1),h.showStore=function(){h.modalDialog&&(f.add("overlaySlideContent",h.close),h.modalDialog.show("pes-store-comp"),g.adjustToRTLLayout(),y.adjustToRTLLayout(),T())},h.pickerState&&(h.pickerState.showStore=h.showStore),h.tabSelected=function(e){e.id!==h.selectedTab().id&&(_.isFeatureOn(s.featureFlags.PES_CDN_AUTH_ENABLED)&&_.isFeatureOn(s.featureFlags.PES_CDN_AUTH_URL_FALLBACK_ENABLED)&&e.cdnToken(d.latestToken),e.itemsLoaded?x(e):I(e).then((function(){x(e),e.itemsLoaded=!0})).catch((function(){h.showErrorText(!0),h.showTabDetails(!1),h.selectedTab(e)})))},h.goToTabList=function(){h.selectedTab(!1),S()},h.buyOrDownloadTab=function(e){return e.isDownloaded()?(e.isDownloaded(!1),function(e){l.hidePurchasedTabOnPicker.run(h.pickerState,e.id),u.mruStateUpdater.run(h.pickerState)}(e),!1):(e.showDownloadSpinner(!0),-1!==E.indexOf(e.id)?(e.isDownloaded(!0),t.remove(h.pickerState.hiddenTabIds,(function(t){return t===e.id})),A(e).then((function(){M(e)})),!1):void b.buyTab(e).then((function(){A(e).then((function(){M(e)}))})))},h.doLocalSearch=t.debounce((function(){h.tabs().length&&h.tabs().forEach((function(e){h.searchQuery()?e.showInList(function(e,t){var n,i=[e.name,e.description].concat(e.keywords)
	for(n=0;n<i.length;n++)if(i[n]&&i[n].toLowerCase().indexOf(t.toLowerCase())>-1)return!0
	return!1}(e,h.searchQuery())):e.showInList(!0)}))}),400),h.onSearchBoxKeyDown=function(e,t){var n=c.getKeyCode(t)
	return n===i.ESCAPE?(h.searchQuery()&&h.resetSearchBox(),void t.stopPropagation()):n!==i.BACKSPACE||h.searchQuery()?n!==i.ENTER&&(h.doLocalSearch(),!0):void c.swallow(t)},h.close=function(){h.modalDialog.hide("pes-store-comp"),h.pickerState&&h.pickerState.hiddenTabIds&&b.postHiddenTabs(h.pickerState.hiddenTabIds),f.remove("overlaySlideContent")},h.resetSearchBox=function(){h.searchQuery("")},h.dispose=function(){g.dispose(),y.dispose()}}return m.build=function(e,t){return new m(e,t)},m})),define("ui/components/chat/pes/store/browseTabs",["require","text!views/chat/pes/store/browseTabs.html","ui/viewModels/chat/pes/store/browseTabs","constants/components"],(function(e){var t=e("text!views/chat/pes/store/browseTabs.html"),n=e("ui/viewModels/chat/pes/store/browseTabs")
	return new function(){return{viewModel:{createViewModel:function(e,t){var i=t.element
	return n.build(i,e)}},template:t,name:e("constants/components").chat.EXPRESSION_STORE_V2_BROWSE_PACKS}}})),define("ui/viewModels/chat/muteConversationSettingItem",["require","lodash-compat","vendor/knockout","utils/common/eventMixin","swx-i18n","swx-service-locator-instance","swx-constants","utils/common/eventHelper","ui/telemetry/actions/actionNames"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("utils/common/eventMixin"),r=e("swx-i18n").localization,o=e("swx-service-locator-instance").default,a=e("swx-constants").COMMON,s=e("utils/common/eventHelper"),c=e("ui/telemetry/actions/actionNames")
	function l(e){var t=e.conversationModel,i=this,l=o.resolve(a.serviceLocator.FEATURE_FLAGS)
	i.muteConversationEnabled=n.observable(l.isFeatureOn(a.featureFlags.MUTE_SPECIFIC_CONVERSATIONS_ENABLED)),i.muteConversationEnabled()&&(i.conversationMuted=n.observable(!t._notificationsEnabled()),t._notificationsEnabled.changed(i.conversationMuted),i.isContactProfile=n.observable(!!e.contactProfile),i.muteConversationToggleAriaLabel=n.computed((function(){var e=i.conversationMuted()?"header_narrator_notifications_on":"header_narrator_notifications_off"
	return r.fetch({key:e})})),i.muteConversationKeydown=function(e,t){var n=s.isActivation(t)
	return n&&i.muteConversationHandler(),!n},i.muteConversationHandler=function(){if(t.chatService._updateNotificationSettings){var e=!i.conversationMuted()
	o.resolve(a.serviceLocator.ACTION_TELEMETRY).recordAction(c.conversation.mute,{status:e}),t.chatService._updateNotificationSettings(e)}},i.dispose=function(){t._notificationsEnabled.changed.off(i.conversationMuted),i.muteConversationToggleAriaLabel.dispose()})}return t.assign(l.prototype,i),l})),define("text!views/chat/muteConversationSettingItem.html",[],(function(){return'\x3c!-- ko if: muteConversationEnabled --\x3e\r\n    <div class="muteConversationSettingItem" data-bind="css: { border: isContactProfile }">\r\n        <div class="muteConversation-flex" data-bind="css: {\'fontSize-p\' : isContactProfile }">\r\n            <span id="muteConversation" class="label" data-bind="css: {\'fontSize-h2\' : isContactProfile, \'fontSize-h4\': !isContactProfile() }, l10n: {key: \'header_text_muteConversation\'}"></span>\r\n            \x3c!-- ko ifnot: isContactProfile --\x3e\r\n                <button role="checkbox" aria-labelledby="muteConversation" class="toggler" data-bind="event: { keydown: muteConversationKeydown }, click: muteConversationHandler, css: { checked: conversationMuted }, attr: { \'aria-checked\': conversationMuted() ? \'true\' : \'false\', \'aria-label\': muteConversationToggleAriaLabel }" type="button"><span class="on"></span><span class="off"></span></button>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <span id="muteConversation" data-bind="css: {\'fontSize-p label\' : isContactProfile, \'secondaryText\': !isContactProfile() }, l10n: {key: \'header_secondary_text_muteConversation\'}"></span>\r\n        \x3c!-- ko if: isContactProfile --\x3e\r\n        <div class="muteConversation-flex">\r\n            <span id="muteStatus" class="label fontSize-p" data-bind="l10n: {key: conversationMuted() ? \'setting_on\' : \'setting_off\'}"></span>\r\n            <button role="checkbox" aria-labelledby="muteConversation" class="toggler" data-bind="event: { keydown: muteConversationKeydown }, click: muteConversationHandler, css: { checked: conversationMuted }, attr: { \'aria-checked\': conversationMuted() ? \'true\' : \'false\', \'aria-label\': muteConversationToggleAriaLabel }" type="button"><span class="on"></span><span class="off"></span></button>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n\x3c!-- /ko --\x3e'})),define("ui/components/chat/muteConversationSettingItem",["require","exports","module","vendor/knockout","ui/viewModels/chat/muteConversationSettingItem","constants/components","text!views/chat/muteConversationSettingItem.html"],(function(e,t){var n=e("vendor/knockout"),i=e("ui/viewModels/chat/muteConversationSettingItem")
	t.name=e("constants/components").chat.MUTE_CONVERSATION_SETTING_ITEM,t.template=e("text!views/chat/muteConversationSettingItem.html"),t.viewModel={createViewModel:function(e,t){var r=new i(e),o=n.dataFor(t.element)
	return r.setContext(o),r}}})),define("ui/viewModels/chat/messageDestinationPicker",["require","vendor/knockout","swx-constants","swx-i18n","swx-constants","utils/common/outsideClickHandler","experience/settings","telemetry/calling/pstn/pstn","swx-constants","swx-cafe-application-instance","swx-log-tracer","swx-service-locator-instance"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-i18n").localization,r=e("swx-constants").KEYS,o=e("utils/common/outsideClickHandler"),a=e("experience/settings"),s=e("telemetry/calling/pstn/pstn"),c=e("swx-constants").COMMON.telemetry.chat,l=e("swx-cafe-application-instance"),u=e("swx-log-tracer").getLogger(),d=e("swx-service-locator-instance").default
	return function(e){var p,f,m=this,h=d.resolve(n.serviceLocator.PUBSUB),v="+",g="newDestinationContainer",y="destinationSelectorContainer",b="buySkypeCreditContainer",_=!1
	function E(){o.remove(y),m.hideDestinationSelector(!0)}function w(){m.hideNewDestinationContainer(!0),o.remove(g)}function S(){h.publish(n.events.textarea.UPDATE_TEXTAREA_ENABLE,f._balance>0)}function x(e){return/^[\+]{1}[\d]+$/gm.test(T(e))}function C(e){return e.replace(/[\s|\+|\(|\)]+/gm,"")}function T(e){var t=C(e)
	return t.substring(0,1)!==v&&(t=v+t),t}function I(){m.newDestination(v),m.skypeOutInput("")}function A(e,t){u.error("[messageDestinationPicker] action = "+e),u.error(t)}m.conversation=e.conversation,m.destination=e&&e.destination?e.destination:t.observable(n.messageDestination.SKYPE_NETWORK),m.skypeEnabled=!0,m.destinations=t.observableArray(),m.newDestination=t.observable(v),m.hideDestinationSelector=t.observable(!0),m.hideNewDestinationContainer=t.observable(!0),m.hideSkypeCreditContainer=t.observable(!0),m.selectedCountry=t.observable(),m.skypeOutInput=t.observable(""),m.newDestinationInputHasFocus=t.observable(!1),m.purchaseCreditUrl=a.commerce.purchaseCreditUrl,p=m.selectedCountry.subscribe((function(e){if(!e)return void I()
	var t=e.value,n=m.skypeOutInput().trim(),i=T(m.newDestination())
	0===i.indexOf(n)?i=i.substring(n.length):0===i.indexOf(t)&&(i=i.substring(t.length))
	m.newDestination(function(e,t){return v+" ("+C(e)+") "+C(t)}(t,i)),m.newDestinationInputHasFocus(!0)})),m.isPstnSmsOnly=e.isPstnSmsOnly||!1,m.hideSkypeNetworkSelector=t.pureComputed((function(){return m.destination()===n.messageDestination.SKYPE_NETWORK})),m.destinationDisplay=t.pureComputed((function(){var e,t=m.destination()
	return t!==n.messageDestination.SKYPE_NETWORK&&(e=l.get().personsAndGroupsManager.mePerson,(f=e.account).entitlements.get().then((function(){f._balance()<=0&&(m.openSkypeCreditContainerWindow(),m.isPstnSmsOnly&&(_||(_=!0,f._balance.changed(S)),h.publish(n.events.textarea.UPDATE_TEXTAREA_ENABLE,!1)))}))),t===n.messageDestination.SKYPE_NETWORK?i.fetch({key:"sms_message_destination_skype"}):i.fetch({key:"sms_message_destination_sms",params:{phone:t}})})),m.isNewDestinationAvailable=t.pureComputed((function(){return x(m.newDestination())})),m.init=function(){var e,t
	m.destinations((e=m.conversation.participants().map((function(e){return e.person.phoneNumbers()})),t=[],e.forEach((function(e){Array.isArray(e)&&e.forEach((function(e){t.push({phone:e.telUri(),persistent:e.fromProfile()})}))})),t)),m.destination()===n.messageDestination.SMS_NETWORK&&m.destinations()&&m.destinations()[0]&&(m.destination(m.destinations()[0].phone),m.skypeEnabled=!1)},m.openDestinationsList=function(){m.hideDestinationSelector(!1),o.add(y,m.cancel)},m.openNewDestinationWindow=function(){E(),m.hideNewDestinationContainer(!1),o.add(g,m.cancel),m.newDestinationInputHasFocus(!0)},m.openSkypeCreditContainerWindow=function(){m.hideSkypeCreditContainer(!1),o.add(b,m.cancel)},m.addCreditTelemetryFromSms=function(){return s.addingCredit(c.SMS_ADD_CREDIT),!0},m.confirm=function(){var e=T(m.newDestination())
	x(e)&&(m.destination(e),w(),I(),m.conversation.participants()[0].person.addPhoneNumber(e).then((function(){m.destinations.push({phone:e,persistent:!1})}),A.bind(this,"adding_number")))},m.cancel=function(){w(),E(),I(),m.hideSkypeCreditContainer()||(m.hideSkypeCreditContainer(!0),o.remove(b),m.isPstnSmsOnly||m.setDestinationToSkype())},m.setDestinationToSkype=function(){m.destination(n.messageDestination.SKYPE_NETWORK),E()},m.selectDestination=function(e){m.destination(e.phone),E()},m.removeDestination=function(e){m.conversation.participants()[0].person.removePhoneNumber(e.phone).then((function(){m.destinations.remove(e),0===m.destinations().length&&m.setDestinationToSkype()}),A.bind(this,"removing_number"))},m.dispose=function(){p.dispose(),o.remove(y),o.remove(g),_&&f._balance.changed.off(S)},m.onKeyUp=function(e,t){if(t.keyCode===r.ENTER)m.confirm()},m.init()}})),define("text!views/chat/messageDestinationPicker.html",[],(function(){return'<div class="destination-picker">\r\n    <span class=\'viaText\' data-bind="l10n: {key: \'sms_via_text\'};"></span>\r\n    <a href="#" class=\'destinationPickerText\' data-bind="text:destinationDisplay, event: {click: openDestinationsList}" title="Switch to sms" aria-label="Switch to sms"></a>\r\n\r\n    \x3c!-- ko ifnot: hideDestinationSelector --\x3e\r\n    <div role="list" class="destinationSelectorContainer popup arrow down" data-bind=" keyboardNavigation: { itemSelector: \'.number\' }">\r\n       \x3c!-- ko if: skypeEnabled --\x3e\r\n        <a class="turnOffSMS" data-bind="click:setDestinationToSkype, css:{hide: hideSkypeNetworkSelector}">\r\n            <button class="turnOffSMSButton" data-bind="l10n: {key: \'sms_turn_off_sms_sending\'};"></button>\r\n        </a>\r\n        \x3c!-- /ko --\x3e\r\n        <div class="title" data-bind="l10n: { key: \'sms_send_sms_to_section_title\'};"></div>\r\n        <ul class="destinationsList"  data-bind="foreach:destinations">\r\n            <li>\r\n                <div class="number" role="listitem" data-bind="enterKey:$parent.selectDestination, click:$parent.selectDestination, text:$data.phone, attr: {title: $data.phone}"></div>\r\n                \x3c!-- ko if: !$data.persistent --\x3e\r\n                <button class="iconfont delete" data-bind="click:$parent.removeDestination" title="Delete number" aria-label="Delete number"></button>\r\n                \x3c!-- /ko --\x3e\r\n            </li>\r\n        </ul>\r\n        <a class="addNumber" data-bind="click:openNewDestinationWindow">\r\n            <button class="addNumberButton" data-bind="l10n: { key: \'sms_add_phone_number\'};"></button>\r\n        </a>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="newDestinationContainer popup arrow down" data-bind="css:{hide:hideNewDestinationContainer}">\r\n        <div class="title" data-bind="l10n: { key: \'sms_add_phone_number_dialog_text\', params: { accountDisplayName: conversation.topic }};"></div>\r\n\r\n        <swx-countrypicker params="selectedCountry: selectedCountry, skypeOutInput: skypeOutInput"></swx-countrypicker>\r\n\r\n        <input type="text" data-bind="textInput: newDestination, event:{keyup: onKeyUp}, hasFocus:newDestinationInputHasFocus" />\r\n\r\n        <div class="confirmButtonsContainer">\r\n            <swx-button params="cssClass: \'secondary\', textKey: \'action_button_cancel\', titleKey: \'action_button_cancel\', ariaLabelKey: \'action_button_cancel\', action: cancel"></swx-button>\r\n\r\n            <swx-button params="cssClass: \'primary\', disabled: !isNewDestinationAvailable(), textKey: \'action_button_confirm\', titleKey: \'action_button_confirm\', ariaLabelKey: \'action_button_confirm\', action: confirm"></swx-button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="buySkypeCreditContainer popup arrow down" data-bind="css:{hide:hideSkypeCreditContainer}">\r\n        <div class=\'title\' data-bind="l10n: {key: \'sms_insufficient_balance\'}"></div>\r\n        <a data-bind="attr: {href: purchaseCreditUrl}, l10n: {key: \'credit_purchase_link_text\'}, click: addCreditTelemetryFromSms" target=\'_blank\'></a>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/chat/messageDestinationPicker",["require","exports","module","ui/viewModels/chat/messageDestinationPicker","constants/components","text!views/chat/messageDestinationPicker.html"],(function(e,t){var n=e("ui/viewModels/chat/messageDestinationPicker")
	t.name=e("constants/components").chat.MESSAGE_DESTINATION_PICKER,t.template=e("text!views/chat/messageDestinationPicker.html"),t.viewModel={createViewModel:function(e){return new n(e)}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-jskype-internal-application-instance/lib/instance",["require","exports"],e)}((function(e,t){var n
	t.set=function(e){n=e},t.get=function(){if(!n)throw new Error("Instance does not exist yet!")
	return n}})),define("swx-jskype-internal-application-instance",["swx-jskype-internal-application-instance/lib/instance"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-xhr-dispatcher/lib/uriBuilder",["require","exports","lodash-compat","swx-log-tracer"],e)}((function(e,t){var n=e("lodash-compat"),i=e("swx-log-tracer")
	t.build=function(){var e=i.getLogger("[xhrDispatcher]"),t={fqdn:"",resource:"",queryParams:null}
	return{getUri:function(){var e,i,r=t.fqdn+t.resource
	return r+=null!==t.queryParams?(e=t.queryParams,(i=n.reduce(n.keys(e),(function(t,i){var r=function(e){var t=/^ *$/
	if(!n.isUndefined(e)&&null!==e)return e.toString().replace(t,"")}(e[i])
	return r?t.concat(i+"="+r):t}),[]).join("&")).length?"?"+i:""):""},setDomain:function(e){if(!("string"==typeof e)||""===e)throw new TypeError("domain must be a string")
	t.fqdn=e},setResource:function(n){null===t.fqdn&&e.error("FQDN was not set yet!",n),"skype:"===t.fqdn.substring(0,6)?t.resource=n:t.resource=function(e,t){var n="/",i=t[0]===n
	if(e[e.length-1]===n)return i?t.substring(1):t
	return i?t:n+t}(t.fqdn,n)},setQueryParams:function(e){if(!n.isPlainObject(e)&&!n.isUndefined(e))throw new Error("queryParams must be an object")
	t.queryParams=e||{}}}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-xhr-dispatcher/lib/xhrDecorator",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	t.decorate=function(e,t){var i=e,r=n.isArray(t.decorations)?n.slice(t.decorations):[]
	return n.forEach(r,(function(e){i=e.build(i,function(e,t){if(n.isString(e)&&n.isPlainObject(t[e]))return t[e]
	return{}}(e.name,t))})),i}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-xhr-dispatcher/lib/decorations/retry",["require","exports","lodash-compat"],e)}((function(e,t){var n=e("lodash-compat")
	t.name="retry",t.STRATEGIES={INCREMENTAL:"incremental",EXPONENTIAL:"exponential",FIXED:"fixed"}
	var i={enabled:!0,limit:3,delay:3e3,strategy:t.STRATEGIES.EXPONENTIAL,isSuccessCheck:r,isTransientCheck:r}
	function r(){return!1}t.build=function(e,r){var o=n.assign({},i,r)
	return function(i){var r,a=!1,s=new Promise((function(s,c){var l,u=n.now()
	function d(e,t){return t>1&&(e.retry={count:t,ttc:n.now()-u}),e}(l=i.timeout)&&"function"==typeof l.then&&i.timeout.then((function(){a=!0})),function l(u){r=e(i),a&&r.abort()
	r.then((function(e){s(d(e,u))})).catch((function(e){o.isSuccessCheck(e)?s(d({request:e},u)):!a&&function(e,t){return t.enabled&&e<t.limit}(u,o)&&o.isTransientCheck(e)?function(e,i,r){function o(){e(++i)}n.delay(o,function(e,n){if(n.strategy===t.STRATEGIES.INCREMENTAL)return n.delay*e
	if(n.strategy===t.STRATEGIES.EXPONENTIAL)return Math.pow(3,e-1)*n.delay
	return n.delay}(i,r))}(l,u,o):c(d(e,u))}))}(1)}))
	return s.abort=function(){a=!0,r&&r.abort()},s}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-xhr-dispatcher/lib/xhrDispatcher",["require","exports","lodash-compat","reqwest","./uriBuilder","./xhrDecorator","./decorations/retry"],e)}((function(e,t){var n=e("lodash-compat"),i=e("reqwest"),r=e("./uriBuilder"),o=e("./xhrDecorator"),a=e("./decorations/retry")
	t.contentTypes={FORM_URL_ENCODED:"application/x-www-form-urlencoded",JSON:"application/json",JSON_V1_0:"application/json; ver=1.0",JSON_V2_0:"application/json; ver=2.0",JSON_V3_0:"application/json; ver=3.0"}
	var s=function(e){return e&&"function"==typeof e.then}
	function c(e,t){return function(n,i){return t.setResource(n),t.setQueryParams(i.params),e(t.getUri(),i)}}function l(e,t){return function(n,i){return i.decorations=t.decorations,e(n,i)}}function u(e,t){return n.isUndefined(e)?t:e}function d(e,i,r){return o.decorate(p,r)(function(e,i,r){var o={url:i,type:e,headers:r.headers||{},timeout:r.timeout||45e3,dataType:r.dataType||"json",data:r.payload||"",crossOrigin:u(r.crossOrigin,!0),withCredentials:u(r.withCredentials,!1)}
	return(n.isUndefined(r.addContentType)||!0===r.addContentType)&&(o.contentType=r.contentType||t.contentTypes.JSON),(r.jsonp||"jsonp"===r.dataType)&&(o.jsonp=r.jsonp||"callback"),n.isBoolean(r.processData)&&(o.processData=r.processData),o}(e,i,r))}function p(e){var r,o=Date.now()
	s(e.timeout)&&(r=e.timeout,delete e.timeout)
	var a=i.compat(n.cloneDeep(e)),c=new Promise((function(e,t){a.then((function(t){e({response:t,request:a.request,duration:Date.now()-o})})).catch((function(){t(a.request)}))}))
	return c.abort=function(e){return function(){e.request.readyState!==t.REQUEST_DONE_READY_STATE&&e.abort()}}(a),r&&r.then((function(){c.abort()})),c}t.REQUEST_DONE_READY_STATE=4,t.build=function(e){var t=r.build()
	t.setDomain(e.host)
	var i=n.cloneDeep(e)
	i.decorations=i.decorations||[],i.decorations.unshift(a)
	var o=c(n.partial(d,"GET"),t),s=c(n.partial(d,"POST"),t),u=c(n.partial(d,"PUT"),t),p=c(n.partial(d,"DELETE"),t)
	return{get:l(o,i),post:l(s,i),put:l(u,i),remove:l(p,i),uriBuilder:t}}
	var f={retry:{limit:3,delay:1e3,strategy:a.STRATEGIES.FIXED}},m=function(){function e(e){this.REQUEST_DONE_READY_STATE=t.REQUEST_DONE_READY_STATE,this.decorations=e.slice()}return e.prototype.get=function(e,t){return d("GET",e,this.makeOptions(t))},e.prototype.post=function(e,t){return d("POST",e,this.makeOptions(t))},e.prototype.put=function(e,t){return d("PUT",e,this.makeOptions(t))},e.prototype.remove=function(e,t){return d("DELETE",e,this.makeOptions(t))},e.prototype.makeOptions=function(e){return(e=n.assign(n.cloneDeep(f),e)).decorations||(e.decorations=this.decorations),e},e}()
	t.buildDispatcherWithFixedRetry=function(e){return new m(e)}})),define("swx-xhr-dispatcher",["swx-xhr-dispatcher/lib/xhrDispatcher"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-sms-price-web-service/lib/smsPriceWebService",["require","exports","swx-xhr-dispatcher"],e)}((function(e,t){var n=e("swx-xhr-dispatcher")
	t.build=function(e,t){var i=n.build(t)
	return{getSmsPrice:function(t,n){return e().then((function(e){var r={headers:{"X-Skypetoken":e},params:{number:n,organizationId:"skype",flowId:"skype.client.sms.1way"},reporting:{serviceName:"smsPrice"}},o="/skypesms/v1/user/"+t+"/price"
	return i.get(o,r)}))}}}})),define("swx-sms-price-web-service",["swx-sms-price-web-service/lib/smsPriceWebService"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-jskype-main/lib/services/smsPrice/instance",["require","exports","swx-jskype-internal-application-instance","jskype-settings-instance","swx-sms-price-web-service"],e)}((function(e,t){var n,i=e("swx-jskype-internal-application-instance"),r=e("jskype-settings-instance"),o=e("swx-sms-price-web-service")
	t.get=function(){var e
	return n||(e=i.get().signInManager._skypeToken,n=o.build(e,{host:r.settings.smsPriceWebService.host})),n}})),define("ui/viewModels/chat/smsPrice",["require","vendor/knockout","swx-constants","swx-i18n","lodash-compat","experience/settings","swx-jskype-main/lib/services/smsPrice/instance","utils/common/eventMixin","swx-jskype-main/lib/utils/chat/smsMessageBuilder"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-i18n").localization,r=e("lodash-compat"),o=e("experience/settings"),a=e("swx-jskype-main/lib/services/smsPrice/instance"),s=e("utils/common/eventMixin"),c=e("swx-jskype-main/lib/utils/chat/smsMessageBuilder")
	return function e(l){var u=this,d={FAILURE_REQUEST:0,BAD_RESPONSE:1,ACCOUNT_PROBLEM:2,BAD_NUMBER:3}
	function p(e,t){return e||t?new Number(e).toLocaleString(o.locale.i18n,{style:"currency",currency:t}):""}function f(e){var t
	switch(e){case d.BAD_RESPONSE:case d.FAILURE_REQUEST:t=i.fetch({key:"sms_price_info_failed"})
	break
	case d.ACCOUNT_PROBLEM:t=i.fetch({key:"sms_price_info_bad_number_account"})
	break
	case d.BAD_NUMBER:t=i.fetch({key:"sms_price_info_bad_number"})}u.formattedFetchedPrice(""),u.errorMessage(t)}u.fetchedPrice="",u.fetchedCurrency="",u.user=l.conversation.mePerson.id(),u.formattedFetchedPrice=t.observable(""),u.numberOfMessages=t.observable(""),u.errorMessage=t.observable(""),u.destination=l.destination&&l.destination(),u.init=function(){u.destination&&u.updateSmsPrice({destination:u.destination,inputText:""}),u.registerEvent(n.events.textarea.UPDATE_SMS_DESTINATION,u.updateSmsPrice),u.registerEvent(n.events.textarea.UPDATE_SMS_FRAGMENTS,u.updateSmsFragments)},u.updateSmsPrice=function(e){var t=e.destination,i=e.inputText;(u.fetchedPrice=void 0,u.numberOfMessages(""),u.formattedFetchedPrice(""),u.errorMessage(""),t!==n.messageDestination.SKYPE_NETWORK)&&function(e,t){var n=new Promise((function(n){var i=t.replace("+","")
	a.get().getSmsPrice(e,i).then((function(e){(function(e,t){if(!e||!e.response)return void f(d.BAD_RESPONSE)
	var n=e.response
	if(200!==n.code||!n.prices||n.prices.length<=0||!n.currency)return void f(d.BAD_RESPONSE)
	u.fetchedCurrency=n.currency
	var i=!1
	n.prices.forEach((function(e){if(e.number===t){if(i=!0,isNaN(e.price))return void f(d.ACCOUNT_PROBLEM)
	u.fetchedPrice=e.price,u.formattedFetchedPrice(p(u.fetchedPrice,u.fetchedCurrency))}}),this),i||0!==u.formattedFetchedPrice().length||f(d.BAD_RESPONSE)})(e,i),n()}),(function(e){var t=d.FAILURE_REQUEST
	e&&400===e.status&&(t=d.BAD_NUMBER),f(t),n()}))}))
	return n}(u.user,t).then((function(){u.updateSmsFragments(i)}))},u.updateSmsFragments=function(e){var t
	if(-1!==(t=""===e?0:c.calculateSmsFragments(e))&&(u.numberOfMessages(t),!isNaN(u.fetchedPrice)&&u.fetchedCurrency)){var n=0===t?u.fetchedPrice:t*u.fetchedPrice
	u.formattedFetchedPrice(p(n,u.fetchedCurrency))}},r.assign(e.prototype,s)}})),define("text!views/chat/smsPrice.html",[],(function(){return"<div class='smsPriceContainer'>\r\n\r\n    \x3c!-- ko if: numberOfMessages()!=='' --\x3e\r\n    <span class='smsNumberCircle' data-bind='text:numberOfMessages'></span>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <span class='formatPrice' data-bind='text:formattedFetchedPrice'></span>\r\n\r\n    \x3c!-- ko if: errorMessage().length > 0 --\x3e\r\n    <span class='iconfont warning' data-bind=' attr: {title: errorMessage}'></span>\r\n    \x3c!-- /ko --\x3e\r\n</div>\r\n"}))
	define("ui/components/chat/smsPrice",["require","exports","module","ui/viewModels/chat/smsPrice","vendor/knockout","constants/components","text!views/chat/smsPrice.html"],(function(e,t){var n=e("ui/viewModels/chat/smsPrice"),i=e("vendor/knockout")
	t.name=e("constants/components").chat.SMS_PRICE,t.template=e("text!views/chat/smsPrice.html"),t.viewModel={createViewModel:function(e,t){var r=t.element,o=new n(e),a=i.dataFor(r)
	return o.setContext(a),o.init(),o}}})),define("ui/components/chat/index",["require","ui/components/chat/chatLog","ui/components/chat/chatInput","ui/components/chat/conversation","ui/components/chat/groupSearch","ui/components/chat/messagesSearch","ui/components/chat/inviteLink","ui/components/chat/headerNewConversation","ui/components/chat/message","ui/components/chat/navigation","ui/components/chat/newConversation","ui/components/chat/contactPickerInput","ui/components/chat/spaceSettings","ui/components/chat/recents","ui/components/chat/textarea","ui/components/chat/sidebar","ui/components/chat/contactPill","ui/components/chat/contactCard","ui/components/chat/menuItem","ui/components/chat/header","ui/components/chat/headerSingleConversation","ui/components/chat/groupProfile","ui/components/chat/isTypingIndicator","ui/components/chat/currentCall","ui/components/chat/unreadMessageCounter","ui/components/chat/currentCallActions","ui/components/chat/recentItem","ui/components/chat/pes/expressionPicker","ui/components/chat/pes/itemsPicker","ui/components/chat/pes/itemRoster","ui/components/chat/conversationShareLink","ui/components/chat/selectedParticipantsConversation","ui/components/chat/conversationCard","ui/components/chat/filePicker","ui/components/chat/notificationsCenter","ui/components/chat/notificationsMenuItem","ui/components/chat/notificationsToggleButton","ui/components/chat/uploadManager","ui/components/chat/fileTransferActivityActions","ui/components/chat/chatInputActionPicker","ui/components/chat/chatInputSendContactCard","ui/components/chat/shareControl","ui/components/chat/chatInputPollButton","ui/components/chat/pollDesigner","ui/components/chat/stickyMessage","ui/components/chat/startConversationOverlay","ui/components/chat/suggestions/suggestionList","ui/components/chat/videoPlayer","ui/components/chat/audioPlayer","ui/components/chat/gifPlayer","ui/components/chat/userListPopup","ui/components/chat/translatorSettings","ui/components/chat/translatorLanguagePicker","ui/components/chat/moreActionsButton","ui/components/chat/heart","ui/components/chat/narrator","ui/components/chat/pes/store/browseTabs","ui/components/chat/muteConversationSettingItem","ui/components/chat/messageDestinationPicker","ui/components/chat/smsPrice"],(function(e){return[e("ui/components/chat/chatLog"),e("ui/components/chat/chatInput"),e("ui/components/chat/conversation"),e("ui/components/chat/groupSearch"),e("ui/components/chat/messagesSearch"),e("ui/components/chat/inviteLink"),e("ui/components/chat/headerNewConversation"),e("ui/components/chat/message"),e("ui/components/chat/navigation"),e("ui/components/chat/newConversation"),e("ui/components/chat/contactPickerInput"),e("ui/components/chat/spaceSettings"),e("ui/components/chat/recents"),e("ui/components/chat/textarea"),e("ui/components/chat/sidebar"),e("ui/components/chat/contactPill"),e("ui/components/chat/contactCard"),e("ui/components/chat/menuItem"),e("ui/components/chat/header"),e("ui/components/chat/headerSingleConversation"),e("ui/components/chat/groupProfile"),e("ui/components/chat/isTypingIndicator"),e("ui/components/chat/currentCall"),e("ui/components/chat/unreadMessageCounter"),e("ui/components/chat/currentCallActions"),e("ui/components/chat/recentItem"),e("ui/components/chat/pes/expressionPicker"),e("ui/components/chat/pes/itemsPicker"),e("ui/components/chat/pes/itemRoster"),e("ui/components/chat/conversationShareLink"),e("ui/components/chat/selectedParticipantsConversation"),e("ui/components/chat/conversationCard"),e("ui/components/chat/filePicker"),e("ui/components/chat/notificationsCenter"),e("ui/components/chat/notificationsMenuItem"),e("ui/components/chat/notificationsToggleButton"),e("ui/components/chat/uploadManager"),e("ui/components/chat/fileTransferActivityActions"),e("ui/components/chat/chatInputActionPicker"),e("ui/components/chat/chatInputSendContactCard"),e("ui/components/chat/shareControl"),e("ui/components/chat/chatInputPollButton"),e("ui/components/chat/pollDesigner"),e("ui/components/chat/stickyMessage"),e("ui/components/chat/startConversationOverlay"),e("ui/components/chat/suggestions/suggestionList"),e("ui/components/chat/videoPlayer"),e("ui/components/chat/audioPlayer"),e("ui/components/chat/gifPlayer"),e("ui/components/chat/userListPopup"),e("ui/components/chat/translatorSettings"),e("ui/components/chat/translatorLanguagePicker"),e("ui/components/chat/moreActionsButton"),e("ui/components/chat/heart"),e("ui/components/chat/narrator"),e("ui/components/chat/pes/store/browseTabs"),e("ui/components/chat/muteConversationSettingItem"),e("ui/components/chat/messageDestinationPicker"),e("ui/components/chat/smsPrice")]})),define("experience/components/chat",["require","exports","module","experience/settings","swx-constants","swx-service-locator-instance","swx-utils-common","swx-utils-chat","swx-utils-chat","ui/components/chat/index","ui/components/registrar"],(function(e,t){var n=e("experience/settings"),i=e("swx-constants").COMMON,r=e("swx-service-locator-instance").default,o=e("swx-utils-common").loader,a=e("swx-utils-chat").urlParser,s=e("swx-utils-chat").dateTime,c=e("ui/components/chat/index"),l=e("ui/components/registrar")
	t.init=function(e){r.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.LOCATION_MESSAGE_SUPPORT)&&o.loadScript(n.mapsApiUrl+(a.isHttps(location.href)?"&s=1":"")),s.notifyOnDayChange(),l.register(c),e()}})),define("ui/viewModels/commerce/creditBalance",["require","exports","module","utils/common/cafeObservable","swx-cafe-application-instance","experience/settings","telemetry/calling/pstn/pstn","swx-constants"],(function(e,t){var n=e("utils/common/cafeObservable"),i=e("swx-cafe-application-instance"),r=e("experience/settings"),o=e("telemetry/calling/pstn/pstn"),a=e("swx-constants").COMMON.telemetry.pstn
	function s(){var e=this,t=i.get().personsAndGroupsManager.mePerson.account
	e.displayBalance=n.newObservableProperty(t.displayBalance,{keepAlive:!0}),e.purchaseCreditUrl=r.commerce.purchaseCreditUrl,e.addCreditTelemetry=function(){return o.addingCredit(a.entryPoint.SKYPE_OUT_PAGE),!0}}s.prototype.dispose=function(){this.displayBalance.dispose()},t.classFunction=s,t.build=function(){return new s}})),define("text!views/commerce/creditBalance.html",[],(function(){return'<p class="SkypeOutOffer-title fontSize-h4" data-bind="l10n: { key: \'credit_balance_text\' }"></p>\r\n<div class="SkypeOutOffer-body" data-swx-testId="skypeOut-credit">\r\n    <span class="iconfont skypeCreditFill SkypeOutOffer-icon SkypeOutOffer-icon--skypeCreditFill"></span>\r\n    <div class="SkypeOutOffer-content">\r\n        <p class="SkypeOutOffer-message" data-bind="html: displayBalance"></p>\r\n        <p class="SkypeOutOffer-buyCredit">\r\n            <a data-bind="attr: {href: purchaseCreditUrl}, l10n: {key: \'credit_purchase_link_text\'}, click: addCreditTelemetry" target="_blank"></a>\r\n        </p>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/commerce/creditBalance",["require","exports","module","ui/viewModels/commerce/creditBalance","constants/components","text!views/commerce/creditBalance.html"],(function(e,t){var n=e("ui/viewModels/commerce/creditBalance")
	t.name=e("constants/components").commerce.CREDIT_BALANCE,t.template=e("text!views/commerce/creditBalance.html"),t.viewModel={createViewModel:function(){return n.build()}}})),define("ui/viewModels/commerce/subscriptionEntitlement",["require","exports","module","lodash-compat","vendor/knockout","swx-i18n","swx-enums","experience/settings","swx-cafe-application-instance","telemetry/calling/pstn/pstn","utils/common/cafeObservable","swx-constants"],(function(e,t){var n=e("lodash-compat"),i=e("vendor/knockout"),r=e("swx-i18n").localization,o=e("swx-enums"),a=e("experience/settings"),s=e("swx-cafe-application-instance"),c=e("telemetry/calling/pstn/pstn"),l=e("utils/common/cafeObservable"),u=e("swx-constants").COMMON.telemetry.pstn
	function d(){var e=this,t=s.get().personsAndGroupsManager.mePerson.account,d=l.newObservableCollection(t.entitlements)
	function p(e){return e.active()&&(e.type()===o.subscriptionType.Package||e.type()===o.subscriptionType.Plan)}e.showSubscriptionsText=i.observable(!1),e.subscriptionsText=i.computed((function(){var e,t=n.filter(d(),p).length,i={count:t}
	switch(t){case 0:e="no_subscriptions_text"
	break
	case 1:e="subscriptions_text_one"
	break
	default:e="subscriptions_text_many"}return r.fetch({key:e,params:i})})),e.purchaseSubscriptionUrl=a.commerce.purchaseSubscriptionUrl,t.entitlements.get().then((function(){e.showSubscriptionsText(!0)})),e.addSubscriptionTelemetry=function(){return c.addingSubscription(u.entryPoint.SKYPE_OUT_PAGE),!0}}d.prototype.dispose=function(){this.subscriptionsText.dispose()},t.classFunction=d,t.build=function(){return new d}})),define("text!views/commerce/subscriptionEntitlement.html",[],(function(){return'<p class="SkypeOutOffer-title fontSize-h4" data-bind="l10n: { key: \'subscription_entitlement_text\' }"></p>\r\n<div class="SkypeOutOffer-body" data-swx-testId="skypeOutPage-subscrptions">\r\n    <span class="iconfont calendarDay SkypeOutOffer-icon SkypeOutOffer-icon--skypeSubscriptionFill"></span>\r\n    <div class="SkypeOutOffer-content">\r\n\r\n        <p class="SkypeOutOffer-message">\r\n            \x3c!-- ko if: showSubscriptionsText --\x3e\r\n            <span data-bind="text: subscriptionsText"></span>\r\n            \x3c!-- /ko --\x3e\r\n        </p>\r\n        <p class="SkypeOutOffer-buySubscription">\r\n            <a data-bind="attr: {href: purchaseSubscriptionUrl}, l10n: {key: \'subscription_purchase_link_text\'}, click: addSubscriptionTelemetry" target="_blank"></a>\r\n        </p>\r\n    </div>\r\n</div>\r\n'})),define("ui/components/commerce/subscriptionEntitlement",["require","exports","module","ui/viewModels/commerce/subscriptionEntitlement","constants/components","text!views/commerce/subscriptionEntitlement.html"],(function(e,t){var n=e("ui/viewModels/commerce/subscriptionEntitlement")
	t.name=e("constants/components").commerce.SUBSCRIPTION_ENTITLEMENT,t.template=e("text!views/commerce/subscriptionEntitlement.html"),t.viewModel={createViewModel:function(){return n.build()}}})),define("ui/components/commerce/index",["require","ui/components/commerce/creditBalance","ui/components/commerce/subscriptionEntitlement"],(function(e){return[e("ui/components/commerce/creditBalance"),e("ui/components/commerce/subscriptionEntitlement")]})),define("experience/components/commerce",["require","exports","module","swx-constants","swx-service-locator-instance","ui/components/commerce/index","ui/components/registrar"],(function(e,t){var n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default,r=e("ui/components/commerce/index"),o=e("ui/components/registrar")
	t.init=function(e){i.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.PSTN_ENABLED)&&o.register(r),e()}})),define("ui/viewModels/userSettings/preferenceMapping",["require","exports","module","swx-constants","swx-browser-detect"],(function(e,t){var n=e("swx-constants").COMMON.userSettings,i=e("swx-browser-detect").default.BROWSERS
	t.groups={CONTACTS:{id:n.categories.CONTACTS,titleI18NKey:"settings_contacts_category_title"},IM_SETTINGS:{id:n.categories.IM_SETTINGS,titleI18NKey:"settings_im_settings_category_title"},IM_APPEARANCE:{id:n.categories.IM_APPEARANCE,titleI18NKey:"settings_im_appearance_category_title"},PRIVACY:{id:n.categories.PRIVACY,titleI18NKey:"settings_privacy_category_title"},UNLISTED:{id:n.categories.UNLISTED,titleI18NKey:"settings_unlisted_category_title"},NOTIFICATIONS:{id:n.categories.NOTIFICATIONS,titleI18NKey:"settings_notifications_category_title"},PERSONALIZATION:{id:n.categories.PERSONALIZATION,titleI18NKey:"settings_personalization_category_title"}},t.templates={TOGGLE:"pref-template-boolean",SELECT:"pref-template-select",AUTO_BUDDY:"pref-template-autoBuddy",AUTO_BUDDY_DISCOVERY:"pref-template-autoBuddyDiscovery",NOTIFICATIONS:"pref-template-boolean",RINGING_DEFERRER:"pref-template-ringingDeferrer"},t.mapping={},t.mapping[n.preferences.DYNAMIC_DISCOVERY]={category:t.groups.CONTACTS.id},t.mapping[n.preferences.MENTIONS]={category:t.groups.IM_SETTINGS.id,titleKey:"settings_mentionsEnabled_title",altTextKey:"settings_mentionsEnabled_alt_text"},t.mapping[n.preferences.FILE_PASTE]={category:t.groups.IM_SETTINGS.id,titleKey:"settings_filePaste_title",altTextKey:"settings_filePaste_alt_text",supportedBrowsers:[i.CHROME,i.EDGE,i.ELECTRON]},t.mapping[n.preferences.TYPING_INDICATOR]={category:t.groups.IM_SETTINGS.id,titleKey:"settings_typingIndicator_title",altTextKey:"settings_typingIndicator_alt_text"},t.mapping[n.preferences.SKYPE_CALL_POLICY_SUPPORT]={category:t.groups.PRIVACY.id,titleKey:"settings_skypeCallPolicy_title",altTextKey:""},t.mapping[n.preferences.SKYPE_VIDEO_CALLING_POLICY_SUPPORT]={category:t.groups.PRIVACY.id,titleKey:"settings_skypeVideoPolicy_title",altTextKey:""},t.mapping[n.preferences.READ_RECEIPT]={category:t.groups.PRIVACY.id,titleKey:"settings_sendReadReceipts_title",altTextKey:"settings_sendReadReceipts_alt_text"},t.mapping[n.preferences.URL_PREVIEWS]={category:t.groups.IM_APPEARANCE.id,titleKey:"settings_urlPreview_title",altTextKey:"settings_urlPreview_alt_text"},t.mapping[n.preferences.YOUTUBE_PLAYER]={category:t.groups.IM_SETTINGS.id,titleKey:"settings_youtube_player_title",altTextKey:"settings_youtube_player_alt_text"},t.mapping[n.preferences.AUTO_BUDDY]={category:t.groups.CONTACTS.id,titleKey:"settings_short_circuit_title",template:t.templates.AUTO_BUDDY},t.mapping[n.preferences.AUTO_BUDDY_DISCOVERY]={category:t.groups.CONTACTS.id,template:t.templates.AUTO_BUDDY_DISCOVERY},t.mapping[n.preferences.NOTIFICATIONS]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_notifications_title",altTextKey:"settings_notifications_alt_text"},t.mapping[n.preferences.NOTIFICATIONS_SOUND]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_notifications_sound_title",altTextKey:"settings_notifications_sound_alt_text"},t.mapping[n.preferences.DEFER_RINGING_SOUND]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_ringing_deferrer_title",altTextKey:"settings_ringing_deferrer_alt_text",template:t.templates.RINGING_DEFERRER},t.mapping[n.preferences.CHAT_NOTIFICATIONS_SOUND]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_chat_notifications_sound_title",altTextKey:"settings_chat_notifications_sound_alt_text"},t.mapping[n.preferences.CALL_NOTIFICATIONS]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_call_notifications_title",altTextKey:"settings_call_notifications_alt_text"},t.mapping[n.preferences.CALL_NOTIFICATIONS_SOUND]={category:t.groups.NOTIFICATIONS.id,titleKey:"settings_call_notifications_sound_title",altTextKey:"settings_call_notifications_sound_alt_text"},t.mapping[n.preferences.EMOTICON_SUGGESTIONS]={category:t.groups.IM_SETTINGS.id,titleKey:"settings_emoticonSuggestions_title",altTextKey:"settings_emoticonSuggestions_alt_text"},t.mapping[n.preferences.SHOW_EMOTICONS]={category:t.groups.IM_APPEARANCE.id,titleKey:"settings_showEmoticons_title",altTextKey:"settings_showEmoticons_alt_text"},t.mapping[n.preferences.SHOW_ANIMATED_EMOTICONS]={category:t.groups.IM_APPEARANCE.id,titleKey:"settings_showAnimatedEmoticons_title",altTextKey:"settings_showAnimatedEmoticons_alt_text"},t.mapping[n.preferences.SHOW_LARGE_EMOTICONS]={category:t.groups.IM_APPEARANCE.id,titleKey:"settings_showLargeEmoticons_title",altTextKey:"settings_showLargeEmoticons_alt_text"},t.mapping[n.preferences.DARK_THEME]={category:t.groups.PERSONALIZATION.id,titleKey:"settings_dark_theme",altTextKey:"settings_dark_theme_alt_text"},t.mapping[n.preferences.VIDEO_AUTOPLAY]={category:t.groups.PERSONALIZATION.id,titleKey:"settings_video_autoplay",altTextKey:"settings_video_autoplay_alt_text"}})),define("ui/viewModels/userSettings/utils",["require","exports","module","lodash-compat","swx-enums","swx-constants","swx-i18n","swx-browser-detect","ui/viewModels/userSettings/preferenceMapping"],(function(e,t){var n=e("lodash-compat"),i=e("swx-enums"),r=e("swx-constants").COMMON,o=e("swx-i18n").localization,a=e("swx-browser-detect").default,s=e("ui/viewModels/userSettings/preferenceMapping").templates,c=r.userSettings.preferences
	t.getPrefCategory=function(e,t,i){var r=i
	return e in t?r=t[e].category:(n.keys(t).some((function(n){if(e.match(n))return r=t[n].category,!0})),r)},t.getPrefTemplate=function(e,t){var n=t[e.id]
	if(n&&n.template)return n.template
	switch(e.type){case i.preferenceType.Boolean:case i.preferenceType.Notifications:return s.TOGGLE
	case i.preferenceType.CallPolicy:case i.preferenceType.VideoPolicy:return s.SELECT
	default:return null}},t.getPrefTitle=function(e,t){var n=t[e]
	return n&&n.titleKey?o.fetch({key:n.titleKey}):e.match(c.DYNAMIC_DISCOVERY)?e.replace(c.DYNAMIC_DISCOVERY+"-",""):o.fetch({key:"settings_unknownOption_title",params:{id:e}})},t.getPrefSecondaryText=function(e,t){var n=t[e]
	return n&&void 0!==n.altTextKey?""===n.altTextKey?null:o.fetch({key:n.altTextKey}):o.fetch({key:"settings_unknownOption_alt_text",params:{id:e}})},t.isPrefSupported=function(e,t){return!(!t[e]||t[e].hasOwnProperty("supportedBrowsers")&&-1===n.indexOf(t[e].supportedBrowsers,a.getBrowserInfo().browserName))},t.isUnlistedCategory=function(e,t,n,i){return-1!==n.indexOf(t)||-1!==i.indexOf(e)},t.getCategory=function(e){var t={id:e.id,title:o.fetch({key:e.titleI18NKey}),"@Meta":{typeKey:"id"},preferenceItems:[]}
	return t.preferenceItems["@Meta"]={typeKey:"template"},t}})),define("telemetry/settings/settingsPageTelemetry",["require","lodash-compat","swx-utils-common","swx-constants","experience/settings","ui/telemetry/telemetryClient"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("swx-constants").COMMON,r=e("experience/settings"),o=e("ui/telemetry/telemetryClient")
	function a(){}function s(e){var t={}
	return t[i.telemetry.userSettings.property.ITEM_NAME]=(e||i.telemetry.userSettings.UNKNOWN).toString(),t[i.telemetry.userSettings.property.ITEM_VALUE]=i.telemetry.userSettings.UNKNOWN,t[i.telemetry.userSettings.property.OPERATION_OUTCOME]=i.telemetry.userSettings.outcomeNames.SUCCESS,t}return a.prototype.sendShowPanelEvent=function(e){var t=s(e)
	o.get().sendEvent(r.telemetry.uiTenantToken,i.telemetry.userSettings.eventName.PANEL_SHOWN,t)},a.prototype.sendDismissPageEvent=function(e){var t=s("")
	t[i.telemetry.userSettings.property.OPERATION_DURATION]=isNaN(parseInt(e))?i.telemetry.userSettings.UNKNOWN:parseInt(e),o.get().sendEvent(r.telemetry.uiTenantToken,i.telemetry.userSettings.eventName.PAGE_DISMISSED,t)},t.assign(a,n),a})),define("ui/viewModels/userSettings/preferenceViewModel",["require","exports","module","lodash-compat","swx-enums","swx-constants","swx-i18n","swx-g11n","vendor/knockout","swx-log-tracer","browser/dom","ui/viewModels/userSettings/utils","ui/shortCircuit/shortCircuit","swx-service-locator-instance","ui/telemetry/actions/actionNames","ui/viewModels/userSettings/preferenceMapping","swx-focus-handler","notifications/ringingDeferrer/ringingDeferrerUtil"],(function(e,t){var n=e("lodash-compat"),i=e("swx-enums"),r=e("swx-constants").COMMON,o=e("swx-i18n").localization,a=e("swx-g11n").globalization,s=e("vendor/knockout"),c=e("swx-log-tracer").getLogger(),l=e("browser/dom"),u=e("ui/viewModels/userSettings/utils"),d=e("ui/shortCircuit/shortCircuit"),p=e("swx-service-locator-instance").default,f=e("ui/telemetry/actions/actionNames"),m=e("ui/viewModels/userSettings/preferenceMapping").mapping,h=e("swx-focus-handler"),v=e("notifications/ringingDeferrer/ringingDeferrerUtil")
	function g(e,t,m){var g=this,y=e.description.type
	switch(g.id=e.description.id,g.uiState=i.preferenceValueState.Unknown,g.value=null,g.ariaId="userSettings-"+g.id,g.disabled=s.observable(!1),g.template=u.getPrefTemplate(e.description,t),g.title=u.getPrefTitle(g.id,t),g.secondaryText=u.getPrefSecondaryText(g.id,t),y){case i.preferenceType.Boolean:_()
	break
	case i.preferenceType.CallPolicy:g.uiOptions=[i.privacyPolicyValues.Anyone,i.privacyPolicyValues.ContactsOnly],E()
	break
	case i.preferenceType.VideoPolicy:g.uiOptions=[i.privacyPolicyValues.Anyone,i.privacyPolicyValues.ContactsOnly,i.privacyPolicyValues.NoOne],E()
	break
	case i.preferenceType.AutoBuddy:g.launchShortCircuit=w(r.shortCircuit.scenarios.MANAGE_ADDRESSBOOKS),_(b.bind(g,f.shortCircuit.toggleAutoBuddy))
	break
	case i.preferenceType.AutoBuddyDiscovery:g.launchPNV=w(r.shortCircuit.scenarios.ADD_VERIFIED_PHONE)
	break
	case i.preferenceType.AutoBuddyDiscoveryEmail:g.showToggle=!1,g.showRemoveLink=!1
	break
	case i.preferenceType.AutoBuddyDiscoveryPhone:g.showToggle=!0,g.showRemoveLink=!0,g.ariaLabel=g.title.toString().replace(/\B(?=(\d{1})+(?!\d))/g,","),g.removeAriaLabel=o.fetch({key:"settings_short_circuit_remove_accessible_text",params:{proof:g.ariaLabel}}),g.remove=function(){p.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(f.shortCircuit.deleteNumber),e.value.set(null).then((function(){m.value.get()}))},_(b.bind(g,f.shortCircuit.togglePhoneProof))
	break
	case i.preferenceType.Notifications:_(function(){var t=p.resolve(r.serviceLocator.ACTION_TELEMETRY)
	g.id===r.userSettings.preferences.NOTIFICATIONS?t.recordAction(f.notificationsSettings.toggleNotifications,{enabled:!e.value()}):g.id===r.userSettings.preferences.NOTIFICATIONS_SOUND&&t.recordAction(f.notificationsSettings.toggleSound,{enabled:!e.value()})}.bind(g))
	break
	case i.preferenceType.RingingDeferrer:(function(){function e(){function e(e,t){e.push({id:t,text:s.observable(o.fetch({key:"settings_ringing_deferrer_defer_for",count:t}))})}var t=[]
	return e(t,i.ringingDeferrerOptions.Defer4Hours),e(t,i.ringingDeferrerOptions.Defer8Hours),e(t,i.ringingDeferrerOptions.Defer24Hours),t}function t(){var e=g.uiSelectOptions(),t=v.getCurrentSetting()
	if(!t)return null
	for(var n=0;n<e.length;n++)if(e[n].id===t.option)return e[n].id
	return null}g.uiToggled=s.observable(!1),g.uiToggleClicked=function(){var e
	e=v.areRingingSoundsDeferred()?i.ringingDeferrerOptions.Unset:i.ringingDeferrerOptions.Defer4Hours,v.applyOption(e)},g.uiSelectOptions=s.observableArray(e()),g.uiSelectedOption=s.observable(t()),g.uiSelectedOptionChanged=function(e){var t=e.uiSelectedOption()
	t!==v.getCurrentSetting().option&&v.applyOption(t)},g.uiUpdateSelectOptionsTexts=function(){var e=v.getCurrentSetting()
	if(e)for(var t=0;t<g.uiSelectOptions().length;t++){var n=g.uiSelectOptions()[t]
	n.text(i(n.id))}function i(t){var n=o.fetch({key:"settings_ringing_deferrer_defer_for",count:t})
	return t===e.option&&(n+=" ("+a.formatDate(new Date(e.untilTimestamp),r.globalizationFormatKeys.time.SHORT)+")"),n}},g.activate=function(e){var t=".pref-select-element > select",n=l.getElement(t,e.target)
	n&&h.get().addFocusRequestToQueue(n)},g.preventPropagation=function(e,t){return t.stopPropagation(),!0}})()
	break
	default:c.log("UNKNOWN PREFERENCE TYPE!",g.id)}function b(e){p.resolve(r.serviceLocator.ACTION_TELEMETRY).recordAction(e)}function _(t){t=t||n.noop,g.toggleValue=function(){e.value.set(!e.value()),t()},g.activate=function(){g.toggleValue()}}function E(){var t=["settings_privacy_opt_1_title","settings_privacy_opt_2_title","settings_privacy_opt_3_title"]
	g.uiValue=function(e){return(e=s.unwrap(e))>=0&&e<t.length?o.fetch({key:t[e]}):null},g.activate=function(e){var t=l.getElement(".pref-select-element > select",e.target)
	t&&h.get().addFocusRequestToQueue(t)},g.optionChanged=function(t){e.value.set(t.value())},g.preventPropagation=function(e,t){return t.stopPropagation(),!0}}function w(t){return function(){var n=p.resolve(r.serviceLocator.ACTION_TELEMETRY)
	switch(t){case r.shortCircuit.scenarios.MANAGE_ADDRESSBOOKS:n.recordAction(f.shortCircuit.manageAddressBooks)
	break
	case r.shortCircuit.scenarios.ADD_VERIFIED_PHONE:n.recordAction(f.shortCircuit.addNewNumber)}d.build().open(t).then((function(){e.value.get()}))}}}t.Preference=g,t.build=function(e,t){return new g(e,m,t)}})),define("ui/viewModels/userSettings/userSettingsPageViewModel",["require","lodash-compat","swx-cafe-application-instance","swx-utils-common","swx-utils-common","swx-util-calling-stack","swx-i18n","swx-constants","browser/dom","swx-utils-common","swx-enums","utils/common/eventHelper","utils/common/eventMixin","vendor/knockout","utils/common/scroll","swx-service-locator-instance","utils/common/disposableMixin","utils/common/stateMixin","ui/viewModels/userSettings/utils","telemetry/settings/settingsPageTelemetry","experience/settings","ui/viewModels/userSettings/preferenceMapping","ui/viewModels/userSettings/preferenceMapping","ui/viewModels/userSettings/preferenceViewModel","notifications/settings","utils/common/styleModeHelper","notifications/ringingDeferrer/ringingDeferrerUtil"],(function(e){var t=e("lodash-compat"),n=e("swx-cafe-application-instance"),i=e("swx-utils-common").async,r=e("swx-utils-common").builderMixin,o=e("swx-util-calling-stack"),a=e("swx-i18n").localization,s=e("swx-constants").COMMON,c=e("browser/dom"),l=e("swx-utils-common").stopwatch,u=e("swx-enums"),d=e("utils/common/eventHelper"),p=e("utils/common/eventMixin"),f=e("vendor/knockout"),m=e("utils/common/scroll"),h=e("swx-service-locator-instance").default,v=e("utils/common/disposableMixin"),g=e("utils/common/stateMixin"),y=e("ui/viewModels/userSettings/utils"),b=e("telemetry/settings/settingsPageTelemetry"),_=e("experience/settings"),E=_.userSettings.hiddenCategories,w=_.userSettings.hiddenPreferences,S=e("ui/viewModels/userSettings/preferenceMapping").mapping,x=e("ui/viewModels/userSettings/preferenceMapping").groups,C=e("ui/viewModels/userSettings/preferenceViewModel"),T=e("notifications/settings"),I=e("utils/common/styleModeHelper"),A=e("notifications/ringingDeferrer/ringingDeferrerUtil"),M=u.preferenceType
	function O(e){var n=t(this.model.categories).pluck("preferenceItems").flatten().find({id:e})
	if(!n&&e.match(s.userSettings.preferences.DYNAMIC_DISCOVERY)){var i=t.find(this.model.categories,{id:"contacts"})
	n=t(t.map(i.preferenceItems,"value").filter(t.isArray)[0]).find({id:e})}return n}function k(e,n){var i,r,o=e.description.id,a=e.description.type,c=O.call(this,o),l=s.userSettings.preferences
	if(a===M.AutoBuddyDiscovery&&t.isArray(n))return i=t.map(n,(function(t){return C.build(t,e)})),c.value=i,P.call(this,n),void this.applyState(this.model)
	o===l.NOTIFICATIONS&&T.chatNotificationsMuted(!n),o===l.NOTIFICATIONS&&this.isNotificationSoundsSettingEnabled&&(r=O.call(this,l.NOTIFICATIONS_SOUND),!1===n&&!0===r.value&&r.toggleValue(),r.disabled=f.observable(!n)),o===l.NOTIFICATIONS&&!this.isNotificationSoundsSettingEnabled&&A.isFeatureEnabled()&&((r=O.call(this,l.DEFER_RINGING_SOUND)).disabled=f.observable(!n),n||A.applyOption(u.ringingDeferrerOptions.Unset)),o===l.NOTIFICATIONS_SOUND&&T.notificationsSoundMuted(!n),o===l.NOTIFICATIONS_SOUND&&A.isFeatureEnabled()&&((r=O.call(this,l.DEFER_RINGING_SOUND)).disabled=f.observable(!n),n||A.applyOption(u.ringingDeferrerOptions.Unset)),o===l.DEFER_RINGING_SOUND&&(A.areRingingSoundsDeferred()?(c.uiToggled(!0),c.uiUpdateSelectOptionsTexts(),c.uiSelectedOption(n.option)):c.uiToggled(!1)),o===l.CHAT_NOTIFICATIONS_SOUND&&T.chatNotificationsSoundMuted(!n),o===l.NOTIFICATIONS&&this.isChatNotificationSoundsSettingEnabled&&(r=O.call(this,l.CHAT_NOTIFICATIONS_SOUND),!1===n&&!0===r.value&&r.toggleValue(),r.disabled=f.observable(!n)),o===l.CALL_NOTIFICATIONS&&T.callNotificationsMuted(!n),o===l.CALL_NOTIFICATIONS&&this.isCallNotificationSoundSettingEnabled&&(r=O.call(this,l.CALL_NOTIFICATIONS_SOUND),!1===n&&!0===r.value&&r.toggleValue(),r.disabled=f.observable(!n)),o!==s.userSettings.preferences.DARK_THEME||I.get().isIntegratedProperty()||(n?document.body.classList.add("dark"):document.body.classList.remove("dark")),c.value=n,this.applyState(this.model)}function N(e,t){var n=O.call(this,e)
	switch(n.uiState===u.preferenceValueState.Unknown&&(n.uiState=t),t){case u.preferenceValueState.Saving:case u.preferenceValueState.Defined:n.uiState=t}this.applyState(this.model)}function P(e){t.forEach(e,(function(e){this.registerDisposable(e.value.changed(k.bind(this,e))),this.registerDisposable(e.value.state.changed(N.bind(this,e.description.id))),!e.value.get.enabled()&&e.value.get.enabled._set&&e.value.get.enabled._set(!0),e.value.get()}),this)}function R(){this.fragmentVisibility?h.resolve(s.serviceLocator.PUBSUB).publish(s.events.navigation.NAVIGATE_TO_PREVIOUS_PAGE):(this.fragmentVisibility=!0,this.pageOpenTimeMark=l.build())}function L(){var e
	this.fragmentVisibility=!1,e=this.pageOpenTimeMark,b.build().sendDismissPageEvent(e&&e.durationInSeconds()),this.pageOpenTimeMark=null,this.pageOpenTimeMark=null}function D(e){b.build().sendShowPanelEvent(e)}function U(e){this.scrollbar&&this.unregisterDisposable(this.scrollbar),this.scrollbar=m.build(c.getElement(e,this.parentElement)),this.registerDisposable(this.scrollbar),this.scrollbar.init()}function F(e){var t=c.getElement(".UserSettingsPage-list",e)
	t&&t.focus&&t.focus()}function B(){var e=this,t=_.assetsBaseUrl?_.assetsBaseUrl.match(/\d+.\d+.\d+/):null
	this.appVersion(_.version),this.assetsVersion(t?t[0]:""),this.faqLink(_.faqPageUrl),this.isPluginSupported(!o.get().isPluginlessCallingSupported()),n.get().devicesManager.mediaCapabilities.installedVersion.get().then((function(t){e.pluginVersion(t),e.isPluginVersionFetched(!0)}),(function(){e.pluginVersion(a.fetch({key:"about_plugin_not_available"})),e.isPluginVersionFetched(!0)}))}function V(e,n){var r,o,a,c,l=h.resolve(s.serviceLocator.FEATURE_FLAGS),u=this
	this.pageOpenTimeMark=null,this.state=g.overrideDefaults({},this.getInitialState()),this.params=g.overrideDefaults({},this.getDefaultParams(),e),this.parentElement=n.element,this.scrollbar=null,this.isAboutPageEnabled=l.isFeatureOn(s.featureFlags.ABOUT_PAGE_ENABLED),this.isAboutPageVisible=f.observable(!1),this.isNotificationSoundsSettingEnabled=l.isFeatureOn(s.featureFlags.NOTIFICATIONS_SOUNDS_SETTING_ENABLED),this.isChatNotificationSoundsSettingEnabled=l.isFeatureOn(s.featureFlags.CHAT_NOTIFICATIONS_SOUND_SETTINGS_ENABLED),this.isCallNotificationSettingEnabled=l.isFeatureOn(s.featureFlags.CALL_NOTIFICATIONS_SETTINGS_ENABLED),this.isCallNotificationSoundSettingEnabled=l.isFeatureOn(s.featureFlags.CALL_NOTIFICATIONS_SOUND_SETTINGS_ENABLED),this.registerDisposable(this.state.selectedCategory.subscribe((function(){i.execute((function(){U.call(this,".UserSettingsPage-scroll-area")}),u,!0)}))),this.model={categories:(o=this.params.preferences(),a=[y.getCategory(x.NOTIFICATIONS),y.getCategory(x.CONTACTS),y.getCategory(x.IM_SETTINGS),y.getCategory(x.IM_APPEARANCE),y.getCategory(x.PRIVACY),y.getCategory(x.UNLISTED),y.getCategory(x.PERSONALIZATION)],t.filter(o,(function(e){return y.isPrefSupported(e.description.id,S)})).forEach((function(e){var n=e.description.id,i=y.getPrefCategory(n,S,x.UNLISTED.id),r=t.find(a,{id:i})
	y.isUnlistedCategory(n,i,E,w)&&(r=t.find(a,{id:x.UNLISTED.id})),r&&r.preferenceItems.push(C.build(e))})),a)},this.appVersion=f.observable(),this.assetsVersion=f.observable(),this.pluginVersion=f.observable(),this.faqLink=f.observable(),this.isPluginSupported=f.observable(),this.isPluginVersionFetched=f.observable(!1),(c=this.model).categories=t.reject(c.categories,(function(e){return 0===e.preferenceItems.length})),l.isFeatureOn(s.featureFlags.SHOW_UNLISTED_SETTINGS)||function(e){e.categories=t.reject(e.categories,(function(e){return e.id===x.UNLISTED.id}))}(this.model),function(e){e.selectedCategory=t.head(e.categories)||{},D(e.selectedCategory.id)}(this.model),r=t(this.model.categories).map((function(e){return e.preferenceItems})).flatten().map((function(e){return e.id})).sort().value(),P.call(this,t.filter(this.params.preferences(),(function(e){return t.indexOf(r,e.description.id)>=0}))),this.applyState(this.model),R.call(this),this.setContext(f.dataFor(n.element)),this.registerEvent(s.events.navigation.FRAGMENT_SHOW,R,p.DIRECTION.ANY,this),this.registerEvent(s.events.navigation.FRAGMENT_HIDE,L,p.DIRECTION.ANY,this),h.resolve(s.serviceLocator.PUBSUB).publish(s.events.navigation.FRAGMENT_REMOVE_ALL_HIDDEN),i.execute(F.bind(null,n.element),null,!1),this.isAboutPageEnabled&&B.call(this)}return V.prototype.switchCategory=function(e,n){var i,r,o,a=f.dataFor(n.target)
	a&&a.id?(i=this.model,r=a.id(),o=i.selectedCategory.id,i.selectedCategory=t.find(i.categories,{id:r})||{},o!==i.selectedCategory.id&&D(i.selectedCategory.id),this.isAboutPageVisible(!1),this.applyState(this.model)):(U.call(this,".UserSettingsPage-about-scroll"),this.state.selectedCategory().id("about"),this.isAboutPageVisible(!0))},V.prototype.getInitialState=function(){return{categories:[],selectedCategory:null}},V.prototype.getDefaultParams=function(){var e=n.get().personsAndGroupsManager.mePerson
	return{preferences:e.preferences&&e.preferences()||[],eventEmitter:d.emptyEmitter}},t.assign(V.prototype,v),t.assign(V.prototype,g),t.assign(V.prototype,p),t.assign(V,r),V})),define("text!views/userSettings/userSettingsPage.html",[],(function(){return'<section class="UserSettingsPage themeWhite" role="region">\r\n    <div class="UserSettingsPage-master">\r\n        <h1 class="UserSettingsPage-heading" data-bind="l10n: { key: \'settings_page_text_header\' }"></h1>\r\n        <ul class="UserSettingsPage-list" role="listbox" tabindex="-1"\r\n            data-bind="click: switchCategory, keyboardNavigation: { itemSelector: \'.UserSettingsPage-category\' }, l10n_attr:{\'aria-label\':\'settings_pane_opened\'}, focusHandler: { priority: 1 }">\r\n            \x3c!-- ko foreach: { data: state.categories, as: \'category\' } --\x3e\r\n            <li role="option">\r\n                <a href="#"  class="UserSettingsPage-category"\r\n                   data-bind="css: { active: $parent.state.selectedCategory() && $parent.state.selectedCategory().id() === category.id() }">\r\n                    <h2 class="UserSettingsPage-label" data-bind="css: category.id, text: category.title, aria-label: category.title"></h2>\r\n                </a>\r\n            </li>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: isAboutPageEnabled --\x3e\r\n            <li role="option">\r\n                <a href="#" class="UserSettingsPage-category" data-bind="css: {active: isAboutPageVisible}">\r\n                    <h2 class="UserSettingsPage-label about" data-bind="l10n: { key: \'settings_about_category_title\' }"></h2>\r\n                </a>\r\n            </li>\r\n            \x3c!-- /ko --\x3e\r\n        </ul>\r\n    </div>\r\n\r\n    <div class="UserSettingsPage-detail UserSettingsPage-detail--white">\r\n        \x3c!-- ko if: !isAboutPageVisible() --\x3e\r\n            \x3c!-- ko with: state.selectedCategory --\x3e\r\n            <h1 class="UserSettingsPage-heading" data-bind="text: title"></h1>\r\n            <div class="UserSettingsPage-scroll-area">\r\n                <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n                    <ul class="UserSettingsPage-list" data-bind="foreach: { data: preferenceItems, as: \'param\' }">\r\n                        <li class="UserSettingsPage-option"\r\n                            data-bind="css: param.template, template: { name: param.template, data: param, as: param }">\r\n                        </li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n        \x3c!-- /ko --\x3e\r\n\r\n        <div class="UserSettingsPage-about-scroll" data-bind="visible: isAboutPageVisible">\r\n            <div class="scrollViewport scrollViewportV" tabindex="-1">\r\n                <div class="UserSettingsPage-skypeLogo"></div>\r\n                <div class="UserSettingsPage-option">\r\n                    <p class="pref-heading UserSettingsPage-featureLabel">\r\n                        <strong data-bind="l10n: { key: \'about_app_version\' }"></strong>: <span data-bind="text: appVersion"></span>\r\n                    </p>\r\n                    <p class="pref-heading UserSettingsPage-featureLabel">\r\n                        <strong data-bind="l10n: { key: \'about_assets_version\' }"></strong>: <span data-bind="text: assetsVersion"></span>\r\n                    </p>\r\n                    \x3c!-- ko if: isPluginSupported --\x3e\r\n                    <p class="pref-heading UserSettingsPage-featureLabel">\r\n                        <strong data-bind="l10n: { key: \'about_plugin_version\' }"></strong>:\r\n\r\n                        \x3c!-- ko ifnot: isPluginVersionFetched --\x3e\r\n                        <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n                        \x3c!-- /ko --\x3e\r\n\r\n                        \x3c!-- ko if: isPluginVersionFetched --\x3e\r\n                        <span data-bind="text: pluginVersion"></span>\r\n                        \x3c!-- /ko --\x3e\r\n                    </p>\r\n                    \x3c!-- /ko --\x3e\r\n\r\n                    <p class="pref-heading UserSettingsPage-featureLabel">\r\n                        <a target="_blank" data-bind="attr: {href: faqLink}, l10n: { key: \'about_faq\' }"></a>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</section>\r\n\r\n<script type="text/html" id="pref-template-boolean">\r\n    <div class="pref-template-boolean-inner">\r\n        <div class="pref-template-boolean-buttonWrap" data-bind="css: { \'pref-toggle--saving\': param.uiState() === \'Saving\', \'pref-toggle--disabled\': param.disabled }">\r\n            \x3c!-- ko if: param.uiState() !== \'Unknown\' --\x3e\r\n            <swx-toggle-button class="pref-toggle-btn"\r\n                               params="checked: param.value, disabled: param.disabled, click: param.toggleValue, ariaLabel: title, labelledById: param.ariaId"></swx-toggle-button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: param.uiState() === \'Unknown\' --\x3e\r\n            <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <div class="pref-toggle-col">\r\n            <h2 class="pref-toggle-heading UserSettingsPage-featureLabel" data-bind="html: param.title, attr: {id: param.ariaId}"></h2>\r\n        </div>\r\n    </div>\r\n    <p class="pref-toggle-sec-text UserSettingsPage-secondaryText" data-bind="html: param.secondaryText"></p>\r\n<\/script>\r\n\r\n\r\n<script type="text/html" id="pref-template-select">\r\n    <h2 class="pref-heading UserSettingsPage-featureLabel" data-bind="html: param.title"></h2>\r\n    <div>\r\n        \x3c!-- ko if: param.uiState() !== \'Unknown\' --\x3e\r\n        <div class=\'pref-select-element\'>\r\n            <select data-bind=" options: param.uiOptions,\r\n                            optionsText: param.uiValue,\r\n                            value: param.value,\r\n                            event: {\r\n                                mousedown: param.preventPropagation,\r\n                                keydown: param.preventPropagation,\r\n                                change: param.optionChanged } "></select>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: param.uiState() === \'Unknown\' --\x3e\r\n        <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    <p class="pref-toggle-sec-text UserSettingsPage-secondaryText" data-bind="html: param.secondaryText"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="pref-template-ringingDeferrer">\r\n    <div class=\'pref-template-boolean-inner\'>\r\n        <div class="pref-template-boolean-buttonWrap" data-bind="css: { \'pref-toggle--saving\': param.uiState() === \'Saving\', \'pref-toggle--disabled\': param.disabled }">\r\n            \x3c!-- ko if: param.uiState() !== \'Unknown\' --\x3e\r\n            <swx-toggle-button class="pref-toggle-btn"\r\n                               params="checked: param.uiToggled,\r\n                                disabled: param.disabled || param.uiState() === \'Saving\',\r\n                                click: param.uiToggleClicked,\r\n                                ariaLabel: title,\r\n                                labelledById: param.ariaId"></swx-toggle-button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: param.uiState() === \'Unknown\' --\x3e\r\n            <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <div class="pref-toggle-col">\r\n            <h2 class="pref-toggle-heading UserSettingsPage-featureLabel" data-bind="html: param.title, attr: {id: param.ariaId}"></h2>\r\n        </div>\r\n    </div>\r\n\r\n    \x3c!-- ko if: param.uiToggled() && param.uiState() !== \'Unknown\' --\x3e\r\n    <div class=\'pref-select-element pref-ringingDeferrer-select-element\'\r\n         data-bind="css: { \'pref-select-element--saving\': param.uiState() === \'Saving\' }">\r\n        <select class="pref-select-element-selectbox"\r\n                data-bind=" options: param.uiSelectOptions,\r\n                        optionsText: \'text\',\r\n                        optionsValue: \'id\',\r\n                        value: param.uiSelectedOption,\r\n                        disabled: param.disabled || param.uiState() === \'Saving\',\r\n                        event: {\r\n                            mousedown: param.preventPropagation,\r\n                            keydown: param.preventPropagation,\r\n                            change: param.uiSelectedOptionChanged } "></select>\r\n    </div>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <p class="pref-ringingDeferrer-sec-text UserSettingsPage-secondaryText" data-bind="html: param.secondaryText"></p>\r\n<\/script>\r\n\r\n<script type="text/html" id="pref-template-autoBuddy">\r\n    <div class="pref-template-boolean-inner">\r\n        <div class="pref-template-boolean-buttonWrap" data-bind="css: { \'pref-toggle--saving\': param.uiState() === \'Saving\'}">\r\n            \x3c!-- ko if: param.uiState() !== \'Unknown\' --\x3e\r\n            <swx-toggle-button class="pref-toggle-btn"\r\n                               params="checked: param.value, click: param.toggleValue, ariaLabel: title, labelledById: param.ariaId"></swx-toggle-button>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            \x3c!-- ko if: param.uiState() === \'Unknown\' --\x3e\r\n            <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        <div class="pref-toggle-col">\r\n            <h2 class="pref-toggle-heading UserSettingsPage-featureLabel" data-bind="l10n: { key: \'settings_short_circuit_title\' }, attr: {id: param.ariaId}"></h2>\r\n        </div>\r\n    </div>\r\n    <p class="pref-toggle-sec-text UserSettingsPage-secondaryText" data-bind="l10n: { key: \'settings_short_circuit_description\' }"></p>\r\n    <div class="pref-toggle-sec-text">\r\n        <a href="#" class="UserSettingsPage-actionSecondary clickable" data-actionItem="true" data-bind="click: param.launchShortCircuit, l10n: { key: \'settings_short_circuit_manage_contacts\' }"></a>\r\n        <div class="UserSettingsPage-images">\r\n            <span class="UserSettingsPage-image UserSettingsPage-googleImage"></span>\r\n            <span class="UserSettingsPage-image UserSettingsPage-linkedInImage"></span>\r\n            <span class="UserSettingsPage-image UserSettingsPage-yahooImage"></span>\r\n        </div>\r\n    </div>\r\n<\/script>\r\n\r\n<script type="text/html" id="pref-template-autoBuddyDiscovery">\r\n    <div>\r\n        \x3c!-- ko if: param.uiState() === \'Unknown\' --\x3e\r\n        <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    <div>\r\n        <h2 class="pref-heading UserSettingsPage-featureLabel" data-bind="l10n: { key: \'settings_short_circuit_auto_buddy_discovery_title\' }, attr: {id: param.ariaId}"></h2>\r\n        <p class="pref-toggle-sec-text UserSettingsPage-secondaryText" data-bind="l10n: { key: \'settings_short_circuit_auto_buddy_discovery_description\' }"></p>\r\n    </div>\r\n\r\n    <ul class="UserSettingsPage-list" data-bind="l10n_attr: {\'aria-label\': \'settings_short_circuit_auto_buddy_discovery_title\'}">\r\n        \x3c!-- ko foreach: { data: param.value, as: \'proof\' }--\x3e\r\n        <li class="UserSettingsPage-option pref-template-autoBuddyProof pref-template-boolean">\r\n            \x3c!-- ko if: proof.showToggle --\x3e\r\n            <div data-bind="css: { \'pref-toggle--saving\': proof.uiState() === \'Saving\'}">\r\n                \x3c!-- ko if: proof.uiState() !== \'Unknown\' --\x3e\r\n                <swx-toggle-button class="pref-toggle-btn"\r\n                                   params="checked: proof.value, click: proof.toggleValue, ariaLabel: ariaLabel"></swx-toggle-button>\r\n                \x3c!-- /ko --\x3e\r\n\r\n                \x3c!-- ko if: proof.uiState() === \'Unknown\' --\x3e\r\n                <swx-loading-animation class="spinner small blue"></swx-loading-animation>\r\n                \x3c!-- /ko --\x3e\r\n            </div>\r\n            \x3c!-- /ko --\x3e\r\n            <div class="pref-toggle-col" data-bind="css: { \'pref--indented\': !proof.showToggle() }">\r\n                <h2 class="pref-heading UserSettingsPage-featureLabel UserSettingsPage-featureLabel--marginless" data-bind="text: proof.title, attr: {id: param.ariaId}"></h2>\r\n                <a href="#" class="UserSettingsPage-actionSecondary clickable" data-actionItem="true" data-bind="click: proof.remove, l10n: { key: \'settings_short_circuit_remove\' }, attr: { \'aria-label\': proof.removeAriaLabel }, visible: proof.showRemoveLink"></a>\r\n            </div>\r\n        </li>\r\n        \x3c!-- /ko --\x3e\r\n        <li class="UserSettingsPage-option pref-template-autoBuddyProof pref-template-boolean">\r\n            <div class="pref-toggle-col pref--indented">\r\n                <a href="#" class="UserSettingsPage-actionPrimary clickable" data-actionItem="true" data-bind="click: param.launchPNV, l10n: { key: \'settings_short_circuit_add_number\' }"></a>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n<\/script>\r\n'})),define("ui/components/userSettings/userSettingsPage",["require","exports","module","ui/viewModels/userSettings/userSettingsPageViewModel","constants/components","text!views/userSettings/userSettingsPage.html"],(function(e,t){var n=e("ui/viewModels/userSettings/userSettingsPageViewModel")
	t.name=e("constants/components").userSettings.USER_SETTINGS_PAGE,t.template=e("text!views/userSettings/userSettingsPage.html"),t.viewModel={createViewModel:n.build.bind(n)}})),define("ui/viewModels/userSettings/audioVideoSettingsPaneViewModel",["require","lodash-compat","ui/telemetry/actions/actionNames","swx-cafe-application-instance","swx-utils-common","swx-util-calling-stack","utils/common/cafeObservable","swx-constants","swx-constants","utils/common/disposableMixin","swx-enums","utils/common/eventMixin","swx-i18n","swx-service-locator-instance","vendor/knockout","ui/calling/callingCapabilityHelper"],(function(e){var t=e("lodash-compat"),n=e("ui/telemetry/actions/actionNames"),i=e("swx-cafe-application-instance"),r=e("swx-utils-common").builderMixin,o=e("swx-util-calling-stack"),a=e("utils/common/cafeObservable"),s=e("swx-constants").COMMON,c=e("swx-constants").CALLING,l=e("utils/common/disposableMixin"),u=e("swx-enums"),d=e("utils/common/eventMixin"),p=e("swx-i18n").localization,f=e("swx-service-locator-instance").default,m=e("vendor/knockout"),h=e("ui/calling/callingCapabilityHelper")
	function v(e){var r,l,d,v=this,g=i.get().devicesManager,y=a.newObservableProperty(g.selectedCamera.set.enabled),b=a.newObservableProperty(g.selectedMicrophone.set.enabled),_=a.newObservableProperty(g.selectedSpeaker.set.enabled),E=h.getVideoCapabilityObservable(e),w=m.observable(!1),S=m.observable(!1),x=m.observable(!1)
	function C(e){f.resolve(s.serviceLocator.ACTION_TELEMETRY).recordAction(e)}function T(e){var t,i,r,o,a
	switch(e){case c.DEVICE_TYPE.CAMERA:t=g.cameras,i=g.selectedCamera,a=v.selectedDevice.selectedCamera()
	break
	case c.DEVICE_TYPE.MICROPHONE:t=g.microphones,i=g.selectedMicrophone,a=v.selectedDevice.selectedMicrophone()
	break
	case c.DEVICE_TYPE.SPEAKER:t=g.speakers,i=g.selectedSpeaker,a=v.selectedDevice.selectedSpeaker()}if(o=i(),a&&(!o||o.id()!==a.value)){if(function(e){switch(e){case c.DEVICE_TYPE.CAMERA:C(n.deviceSelection.cameraSelected)
	break
	case c.DEVICE_TYPE.MICROPHONE:C(n.deviceSelection.microphoneSelected)
	break
	case c.DEVICE_TYPE.SPEAKER:C(n.deviceSelection.speakerSelected)}}(e),t().forEach((function(e){e.id()===a.value&&(r=e)})),!r)return!1
	i.set(r,c.DEVICE_SELECTION_REASON.USER)}}function I(e){return e===s.deviceSelection.DEFAULT_ID||"default_audio_device"===e||"default_video_device"===e}function A(e,t){return I(e.id())?p.fetch({key:"settings_default_device_name"}):t}function M(e,n){var i=e.added((function(e){var i={value:e.id(),name:m.observable(A(e,name)),description:""}
	n.push(i),e.name.get().then((function(t){(function(e){I(e.id())||(e.type()===u.deviceType.Camera?w(!0):e.type()===u.deviceType.Microphone?S(!0):e.type()===u.deviceType.Speaker&&x(!0))})(e),i.name(A(e,t))})).catch(t.noop)})),r=e.removed((function(e){n.remove((function(t){return t.value===e.id()}))}))
	v.registerDisposable(i),v.registerDisposable(r)}function O(e,t,n){var i=e.changed((function(e){if(e){var i=m.utils.arrayFirst(n(),(function(t){return t.value===e.id()}))
	i&&i!==t()&&t(i)}}))
	v.registerDisposable(i)}return v.DIALOG_NAME=c.CALL_SCREEN_DIALOG.NAME.AV_SETTINGS,v.allowSpeakerSelection=m.observable(!o.get().isPluginlessCallingSupported()),v.allowCameraSelection=E,v.closeTitle=p.fetch({key:"settings_close_title"}),v.closeButtonHasFocus=m.observable(!1),v.availableDevices={cameras:m.observableArray(),speakers:m.observableArray(),microphones:m.observableArray()},v.selectedDevice={selectedCamera:m.observable(),selectedMicrophone:m.observable(),selectedSpeaker:m.observable()},v.cameraSelectionDisabled=m.pureComputed((function(){return!y()||0===v.availableDevices.cameras().length||!w()})),v.microphoneSelectionDisabled=m.pureComputed((function(){return!b()||0===v.availableDevices.microphones().length||!S()})),v.speakerSelectionDisabled=m.pureComputed((function(){return!_()||0===v.availableDevices.speakers().length||!x()})),v.cameraTitle=m.pureComputed((function(){return v.cameraSelectionDisabled()?"settings_no_camera_title":"settings_camera_title"})),v.microphoneTitle=m.pureComputed((function(){return v.microphoneSelectionDisabled()?"settings_no_microphone_title":"settings_microphone_title"})),v.speakerTitle=m.pureComputed((function(){return v.speakerSelectionDisabled()?"settings_no_speaker_title":"settings_speaker_title"})),v.closeSettings=function(){v.dispatchEvent(s.events.callScreen.TOGGLE_MODAL_DIALOG,v.DIALOG_NAME,v.DIRECTION.PARENT)},v.init=function(){v.forwardEvent(s.events.callScreen.TOGGLE_MODAL_DIALOG,v.DIRECTION.PARENT),M(g.cameras,v.availableDevices.cameras),O(g.selectedCamera,v.selectedDevice.selectedCamera,v.availableDevices.cameras),M(g.microphones,v.availableDevices.microphones),O(g.selectedMicrophone,v.selectedDevice.selectedMicrophone,v.availableDevices.microphones),M(g.speakers,v.availableDevices.speakers),O(g.selectedSpeaker,v.selectedDevice.selectedSpeaker,v.availableDevices.speakers),r=v.selectedDevice.selectedCamera.subscribe(T.bind(v,c.DEVICE_TYPE.CAMERA)),l=v.selectedDevice.selectedMicrophone.subscribe(T.bind(v,c.DEVICE_TYPE.MICROPHONE)),d=v.selectedDevice.selectedSpeaker.subscribe(T.bind(v,c.DEVICE_TYPE.SPEAKER)),v.registerDisposable(r),v.registerDisposable(l),v.registerDisposable(d),v.registerDisposable(E),C(n.deviceSelection.callScreenPaneOpened),setTimeout((function(){v.closeButtonHasFocus(!0)}),0)},v}return t.assign(v.prototype,l),t.assign(v,r),t.assign(v.prototype,d),v})),define("text!views/userSettings/audioVideoSettingsPane.html",[],(function(){return'<script type="text/html" id="device-list-template">\r\n    <div class=\'pref-select-element\' data-bind="css: { \'pref-select-element--disabled\': selectionDisabled }">\r\n        <swx-select-box params="autoFocusAfterSelection: true,\r\n                                selectOptions: availableDevices,\r\n                                selectedOption: selectedDevice,\r\n                                disabled: selectionDisabled,\r\n                                placeholderKey: placeholderKey" class="SelectBox"></swx-select-box>\r\n    </div>\r\n<\/script>\r\n\r\n<swx-call-screen-modal params="name: DIALOG_NAME">\r\n    <div id="device-settings" class="avSettings" role="dialog" data-bind="l10n_attr: {\'aria-label\': \'callscreen_text_showAVSettings\' }">\r\n        <ul class="avSettings-detail">\r\n\r\n            \x3c!-- ko if: allowCameraSelection() --\x3e\r\n            <li class="avSettings-option">\r\n                <h2 class="avSettings-featureLabel" data-bind="l10n: { key: \'settings_camera_title\' }"></h2>\r\n                <div data-bind="template: { name: \'device-list-template\', data: {\r\n                        selectionDisabled: cameraSelectionDisabled,\r\n                        availableDevices: availableDevices.cameras,\r\n                        selectedDevice: selectedDevice.selectedCamera,\r\n                        placeholderKey: cameraTitle}}"></div>\r\n            </li>\r\n            \x3c!-- /ko --\x3e\r\n\r\n            <li class="avSettings-option">\r\n                <h2 class="avSettings-featureLabel" data-bind="l10n: { key: \'settings_microphone_title\' }"></h2>\r\n                <div data-bind="template: { name: \'device-list-template\', data: {\r\n                        selectionDisabled: microphoneSelectionDisabled,\r\n                        availableDevices: availableDevices.microphones,\r\n                        selectedDevice: selectedDevice.selectedMicrophone,\r\n                        placeholderKey: microphoneTitle}}"></div>\r\n            </li>\r\n\r\n            \x3c!-- ko if: allowSpeakerSelection() --\x3e\r\n            <li class="avSettings-option">\r\n                <h2 class="avSettings-featureLabel" data-bind="l10n: { key: \'settings_speaker_title\' }"></h2>\r\n                <div data-bind="template: { name: \'device-list-template\', data: {\r\n                        selectionDisabled: speakerSelectionDisabled,\r\n                        availableDevices: availableDevices.speakers,\r\n                        selectedDevice: selectedDevice.selectedSpeaker,\r\n                        placeholderKey: speakerTitle}}"></div>\r\n            </li>\r\n            \x3c!-- /ko --\x3e\r\n        </ul>\r\n\r\n        <div class="actions">\r\n            <swx-button params="cssClass: \'secondary circle\', textKey: \'button_text_closeSettings\', i18nTitle: closeTitle, action: closeSettings, hasFocus: closeButtonHasFocus"></swx-button>\r\n        </div>\r\n    </div>\r\n</swx-call-screen-modal>'})),define("ui/components/userSettings/audioVideoSettingsPane",["require","exports","module","ui/viewModels/userSettings/audioVideoSettingsPaneViewModel","vendor/knockout","constants/components","text!views/userSettings/audioVideoSettingsPane.html"],(function(e,t){var n=e("ui/viewModels/userSettings/audioVideoSettingsPaneViewModel"),i=e("vendor/knockout")
	t.name=e("constants/components").userSettings.AUDIO_VIDEO_SETTINGS_PANE,t.template=e("text!views/userSettings/audioVideoSettingsPane.html"),t.viewModel={createViewModel:function(e,t){var r=n.build(e.conversation,t.element)
	return r.setContext(i.dataFor(t.element)),r.init(),r}}})),define("ui/components/userSettings/index",["require","ui/components/userSettings/userSettingsPage","ui/components/userSettings/audioVideoSettingsPane"],(function(e){return[e("ui/components/userSettings/userSettingsPage"),e("ui/components/userSettings/audioVideoSettingsPane")]})),define("experience/components/userSettings",["require","exports","module","ui/components/userSettings/index","ui/components/registrar"],(function(e,t){var n=e("ui/components/userSettings/index"),i=e("ui/components/registrar")
	t.init=function(e){i.register(n),e()}})),define("text!views/notifications/allowBrowserNotifications.html",[],(function(){return'<div id="overlayAllowBrowserNotifications" class="swx-overlayModal swx-hide">\r\n    <div class="overlayMain" data-bind="css: { darkTheme: darkTheme, rtl: browserIsRtl}">\r\n        \x3c!-- ko ifnot: darkTheme --\x3e\r\n        <div class="title">\r\n            <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="l10n: { \'key\': \'allow_browser_notifications_header\' }"></h1>\r\n        </div>\r\n        <div class="illustration">\r\n            <img class="circle" data-bind="attr: { src: skypeImageUrl }" alt="" role="presentation" aria-hidden="true"/>\r\n        </div>\r\n        <div class="subtitle">\r\n            <p class="fontSize-h2 fontSizeNarrow-h4" data-bind="l10n: { \'key\': \'allow_browser_notifications_text\' }"></p>\r\n        </div>\r\n        <div class="buttonRow">\r\n            <button class="btn green narrow large" data-bind="click: close" type="button">\r\n                <span class="iconfont after cross pull2" data-bind="l10n: { \'key\': \'button_text_closeSettings\' }"></span>\r\n            </button>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n\r\n        \x3c!-- ko if: darkTheme --\x3e\r\n        <div class="table">\r\n            <div class="tableCell">\r\n                <div class="arrow">\r\n                    <span class="iconfont arrowUp"></span>\r\n                </div>\r\n                <div class="title">\r\n                    <h1 class="fontSize-h0" data-bind="l10n: { \'key\': \'allow_browser_notifications_header\' }"></h1>\r\n                </div>\r\n                <div class="subtitle">\r\n                    <p class="fontSize-h2" data-bind="l10n: { \'key\': \'allow_browser_notifications_text\' }"></p>\r\n                </div>\r\n                <div class="logo">\r\n                    <span class="iconfont logoSkypeMedium"></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n</div>\r\n'})),define("ui/viewModels/notifications/allowBrowserNotificationModalDialog",["require","exports","module","vendor/knockout","lodash-compat","swx-service-locator-instance","swx-constants","experience/settings","services/i18n/cultureInfo","notifications/settings","swx-cafe-application-instance","swx-log-tracer","ui/modalDialog/modalDialog","text!views/notifications/allowBrowserNotifications.html","swx-browser-globals","ui/telemetry/actions/actionNames"],(function(e,t){var n=e("vendor/knockout"),i=e("lodash-compat"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("experience/settings"),s=e("services/i18n/cultureInfo"),c=e("notifications/settings"),l=e("swx-cafe-application-instance"),u=e("swx-log-tracer"),d=e("ui/modalDialog/modalDialog"),p=e("text!views/notifications/allowBrowserNotifications.html"),f=e("swx-browser-globals"),m=e("ui/telemetry/actions/actionNames"),h="/images/components/notifications/",v="allowNativeBrowserNotifications.png",g=o.modalDialog.ALLOW_BROWSER_NOTIFICATIONS_CONTAINER_ID
	function y(){var e=r.resolve(o.serviceLocator.FEATURE_FLAGS),t=r.resolve(o.serviceLocator.ACTION_TELEMETRY),c=f.getWindow().navigator.language
	this.browserIsRtl=n.observable(i.includes(o.rtlLanguages,c)||i.includes(o.rtlLanguages,s.getLocale(c))),this.darkTheme=n.observable(e.isFeatureOn(o.featureFlags.USE_DARK_THEME_FOR_BROWSER_NOTIFICATIONS_OPT_IN_FLOW)),this.skypeImageUrl=n.observable([a.assetsBaseUrl,h,v].join("")),this.close=function(){d.dispose(g)},t.recordAction(m.allowBrowserNotificationsModalDialog.shown)}t.show=function(){var e=f.getWindow()
	if(e.Notification&&e.Notification.permission===o.permission.DEFAULT){var t=r.resolve(o.serviceLocator.ACTION_TELEMETRY),n=r.resolve(o.serviceLocator.FEATURE_FLAGS)
	e.Notification.requestPermission((function(e){c.chatNotificationsMuted.extend({notify:"always"}),e===o.permission.DENIED?(c.chatNotificationsMuted(!0),l.get().personsAndGroupsManager.mePerson.preferences(o.userSettings.preferences.NOTIFICATIONS).value.set(!1)):e===o.permission.GRANTED&&(c.chatNotificationsMuted(!1),l.get().personsAndGroupsManager.mePerson.preferences(o.userSettings.preferences.NOTIFICATIONS).value.set(!0))
	t.recordAction(m.notificationBox.permissionResponse,{permissionStatus:e}),f.getDocument().getElementById(g)&&d.dispose(g)})),d.build(g,new y,p),n.isFeatureOn(o.featureFlags.USE_DARK_THEME_FOR_BROWSER_NOTIFICATIONS_OPT_IN_FLOW)?d.show(g,null,null,!0):d.show(g)}else u.getLogger().error("Tried to show 'allow browser notification' modal dialog when notification permissions were not in default state")}})),define("ui/viewModels/notifications/notificationBox",["require","vendor/knockout","ui/viewModels/notifications/allowBrowserNotificationModalDialog","swx-browser-detect","swx-service-locator-instance","swx-constants","notifications/settings","swx-cafe-application-instance","ui/telemetry/actions/actionNames","swx-browser-globals"],(function(e){var t=e("vendor/knockout"),n=e("ui/viewModels/notifications/allowBrowserNotificationModalDialog"),i=e("swx-browser-detect").default,r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("notifications/settings"),s=e("swx-cafe-application-instance"),c=e("ui/telemetry/actions/actionNames"),l=e("swx-browser-globals").getWindow()
	return function(){var e=this,u=r.resolve(o.serviceLocator.FEATURE_FLAGS),d=r.resolve(o.serviceLocator.ACTION_TELEMETRY)
	function p(){return"Chrome"===i.getBrowserInfo().browserName&&"Windows"===i.getSystemInfo().osName&&void 0!==l.Notification&&u.isFeatureOn(o.featureFlags.BROWSER_NATIVE_NOTIFICATIONS_ENABLED)&&s.get().personsAndGroupsManager.all.persons().length>0&&!a.chatNotificationsMuted()&&l.Notification.permission===o.permission.DEFAULT}e.isVisible=t.observable(p()),e.requestPermission=function(){d.recordAction(c.notificationBox.requestPermission),n.show()},e.setNotificationBoxVisibility=function(){var t=p()
	e.isVisible()!==t&&e.isVisible(t)},e.isVisible()&&d.recordAction(c.notificationBox.shown),s.get().personsAndGroupsManager.all.persons.changed(e.setNotificationBoxVisibility),a.chatNotificationsMuted.subscribe(e.setNotificationBoxVisibility)}})),define("text!views/notifications/notificationBox.html",[],(function(){return"\x3c!-- ko if: isVisible --\x3e\r\n<div class=\"bannerNotification info\">\r\n    <span class=\"iconfont bell\"></span>\r\n    <a href='#' data-bind=\"click: requestPermission, l10n: { 'key': 'enable_browser_notifications_link_text' }\"></a>\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n"})),define("ui/components/notifications/notificationBox",["require","exports","module","ui/viewModels/notifications/notificationBox","constants/components","text!views/notifications/notificationBox.html"],(function(e,t){var n=e("ui/viewModels/notifications/notificationBox")
	t.name=e("constants/components").notifications.NOTIFICATION_BOX,t.template=e("text!views/notifications/notificationBox.html"),t.viewModel={createViewModel:function(){return new n}}})),define("ui/components/notifications/index",["require","ui/components/notifications/notificationBox"],(function(e){return[e("ui/components/notifications/notificationBox")]})),define("experience/components/notifications",["require","exports","module","ui/components/notifications/index","ui/components/registrar"],(function(e,t){var n=e("ui/components/notifications/index"),i=e("ui/components/registrar")
	t.init=function(e){i.register(n),e()}}))
	define("componentsToLoad",["experience/components/experience","experience/components/people","experience/components/calling","experience/components/chat","experience/components/commerce","experience/components/userSettings","experience/components/notifications"],(function(){return Array.prototype.slice.apply(arguments)})),define("experience/componentsLoader",["require","experience/componentsInitializer","componentsToLoad"],(function(e){var t=e("experience/componentsInitializer"),n=e("componentsToLoad")
	return{init:function(){return new Promise((function(e,i){t.init(n,e,i)}))}}})),define("services/telemetry/experience.instrumentation",["require","swx-constants","swx-utils-common"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-utils-common").sessionStorage,i={}
	function r(e,t){if("webapi-requestEndpointCreation"===e&&403===t)return n.get("chat-4171")}return i[t.events.errors.SERVICE_FAILURE]=function(e){return{type:"ServiceFault",data:{serviceName:e.serviceName,faultCode:e.faultCode,faultContext:r(e.serviceName,e.faultCode)||t.telemetry.NOT_AVAILABLE,errorCode:e.errorCode||t.telemetry.NOT_AVAILABLE,errorMessage:e.errorMessage||t.telemetry.NOT_AVAILABLE,verb:e.verb||t.telemetry.NOT_AVAILABLE,host:e.host||t.telemetry.NOT_AVAILABLE,contextId:e.contextId||t.telemetry.NOT_AVAILABLE}}},i[t.events.system.EXPERIENCE_INITIALIZED]=function(e){return{type:"session",data:{subType:"init",configLoadDuration:e.configLoadDuration,packageLoadDuration:e.packageLoadDuration,experienceInitializeDuration:e.experienceInitializeDuration}}},i})),define("bindings/ko.keyboardNavigation",["require","lodash-compat","vendor/knockout","swx-focus-handler","swx-constants","browser/window","browser/document","utils/common/eventHelper","swx-constants"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-focus-handler"),r=e("swx-constants").KEYS,o=e("browser/window"),a=e("browser/document"),s=e("utils/common/eventHelper"),c=e("swx-constants").COMMON
	return{register:function(){var e="tabindex"
	n.bindingHandlers.keyboardNavigation={init:function(l,u){var d,p=t.defaults(u(),{persistSelection:!0,selectLastItem:!1})
	function f(){m().forEach(_)}function m(){var e,t=l.querySelectorAll(p.itemSelector)
	return e=t,Array.prototype.slice.call(e)}function h(e){var t
	E(e.target)&&(t=m()).length&&(_(l),f(),-1!==t.indexOf(d)?y(d):p.selectLastItem?y(t[t.length-1]):t.length&&y(t[0]))}function v(e){var t=e.target
	o.setTimeout((function(){var e=m()
	E(t)||-1!==e.indexOf(a.activeElement)||b(l)}),1)}function g(e){var t,n=s.getKeyCode(e)
	if(function(e){var t=s.getKeyCode(e)
	return e.shiftKey&&t===r.F10}(e))(function(e){var t=a.createEvent("MouseEvents"),n=e.target.getBoundingClientRect()
	e.preventDefault(),e.stopPropagation(),t.initMouseEvent("contextmenu",!0,!1,window,0,0,0,n.right,n.top,!1,!1,!0,!1,2,null),e.target.dispatchEvent(t)})(e)
	else if(function(e){return[r.LEFT,r.UP,r.RIGHT,r.DOWN,r.HOME,r.END].indexOf(e)>-1}(n))return t=m(),e.preventDefault(),e.stopPropagation(),n===r.LEFT||n===r.UP?i(-1):n===r.RIGHT||n===r.DOWN?i(1):n===r.HOME?y(t[0]):n===r.END&&y(t[t.length-1]),!1
	function i(n){var i=t[t.indexOf(e.target)]
	do{if(!(i=t[t.indexOf(i)+n]))break
	y(i)}while(a.activeElement!==i)}}function y(e){i.get().addFocusRequestToQueue(e,i.Priorities.Immediate),p.persistSelection&&(d=e)}function b(t){t.setAttribute(e,0)}function _(t){t.setAttribute(e,-1)}function E(e){return e===l}b(l),f(),l.addEventListener(c.events.browser.FOCUS,h,!0),l.addEventListener(c.events.browser.BLUR,v,!0),l.addEventListener(c.events.browser.KEYDOWN,g),n.utils.domNodeDisposal.addDisposeCallback(l,(function(){l.removeEventListener(c.events.browser.FOCUS,h,!0),l.removeEventListener(c.events.browser.BLUR,v,!0),l.removeEventListener(c.events.browser.KEYDOWN,g)}))}}}}})),define("bindings/ko.enterKey",["require","vendor/knockout","utils/common/eventHelper","swx-constants","swx-constants"],(function(e){var t=e("vendor/knockout"),n=e("utils/common/eventHelper"),i=e("swx-constants").COMMON,r=e("swx-constants").KEYS
	return{register:function(){t.bindingHandlers.enterKey={init:function(e,o,a,s){function c(t){var i=n.getKeyCode(t)
	i!==r.ENTER&&(i!==r.SPACE||"input"===e.tagName.toLowerCase()&&"text"===e.type.toLowerCase())||(o().call(s,s,t),t.stopPropagation())}e.addEventListener(i.events.browser.KEYDOWN,c),t.utils.domNodeDisposal.addDisposeCallback(e,(function(){e.removeEventListener(i.events.browser.KEYDOWN,c)}))}}}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-focus-handler/lib/knockoutBinding",["require","exports","./focusHandler"],e)}((function(e,t){var n=e("./focusHandler")
	t.register=function(e){var t=n.get()
	e.bindingHandlers.focusHandler={init:function(e,n){var i=n()
	t.addFocusRequestToQueue(e,i.priority).then((function(e){i.callback&&i.callback((function(){t.addFocusRequestToQueue(e,i.priority)}))}))}}}})),define("bindings/ko.getElement",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout")
	return{register:function(){t.bindingHandlers.getElement={init:function(e,t,n,i){t().call(i,e)}}}}})),define("bindings/ko.overflowClass",["require","vendor/knockout","browser/dom","browser/window"],(function(e){var t=e("vendor/knockout"),n=e("browser/dom"),i=e("browser/window")
	function r(e){var t=function(e,t){var n=e.offsetLeft
	for(;t!==e.offsetParent;)n-=t.offsetLeft,t=t.offsetParent
	return n}(e,e.parentElement)
	return{isOverflowingToLeft:t<e.parentElement.scrollLeft,isOverflowingToRight:t+e.clientWidth>e.parentElement.clientWidth+e.parentElement.scrollLeft}}function o(e,t,i){i&&(t?n.addClass(e,i):n.removeClass(e,i))}return{register:function(){t.bindingHandlers.overflowClass={init:function(e,n){var a=n()
	function s(){var t,n,i,s=e.children
	for(i=0;i<s.length;++i)o(t=s[i],(n=r(t)).isOverflowingToLeft,a.left),o(t,n.isOverflowingToRight,a.right)}t.utils.domNodeDisposal.addDisposeCallback(e,(function(){i.removeEventListener("resize",s),e.removeEventListener("scroll",s),e.removeEventListener("DOMSubtreeModified",s)})),e.addEventListener("DOMSubtreeModified",s),e.addEventListener("scroll",s),i.addEventListener("resize",s),s()}}}}})),define("bindings/ko.getVisibility",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout")
	return{register:function(){t.bindingHandlers.getVisibility={init:function(e,n,i,r){var o,a=window.setInterval((function(){var t=e.offsetHeight>0&&e.offsetWidth>0
	o!==t&&(o=t,s.call(r,t))}),50),s=n()
	t.utils.domNodeDisposal.addDisposeCallback(e,(function(){window.clearInterval(a)}))}}}}})),define("utils/common/cache/instance",["require","exports","module"],(function(e,t){var n
	t.get=function(){return n},t.set=function(e){n=e}})),define("utils/people/avatar/cache",["require","lodash-compat","experience/settings","swx-utils-chat","utils/common/cache/instance","swx-utils-people"],(function(e){var t=e("lodash-compat"),n=e("experience/settings"),i=e("swx-utils-chat").dateTime,r=e("utils/common/cache/instance"),o=new(0,e("swx-utils-people").avatarCache.default)(r,n,i)
	return t.bindAll(o),o})),define("utils/people/avatar/helper",["require","lodash-compat","browser/window","swx-utils-people"],(function(e){var t=e("lodash-compat"),n=e("browser/window"),i=new(0,e("swx-utils-people").avatarHelper.default)(n.document)
	return t.bindAll(i),i})),define("bindings/ko.fallBackOnDefaultAvatarOnError",["require","vendor/knockout","lodash-compat","browser/window","swx-constants","swx-service-locator-instance","utils/people/avatar/cache","utils/people/avatar/helper","experience/settings"],(function(e){var t=e("vendor/knockout"),n=e("lodash-compat"),i=e("browser/window"),r=e("swx-constants").COMMON,o=r.featureFlags,a=e("swx-service-locator-instance").default,s=e("utils/people/avatar/cache"),c=e("utils/people/avatar/helper"),l=e("experience/settings"),u="imageLoaded",d="initialsTimer",p=100
	function f(e,n,r){var a,s,l=r.get("displayName"),f=r.get("isPstn"),h=r.get("isGroupAvatar"),v=e.parentNode
	m(o.USE_AVATAR_INITIALS)&&t.isObservable(l)&&!f()&&!h()&&(a=l.subscribe((function(){t.utils.domData.get(e,u)||c.showColoredInitials(v,l())})),s=i.setTimeout((function(){c.showColoredInitials(v,l())}),p),t.utils.domData.set(e,d,s),t.utils.domNodeDisposal.addDisposeCallback(e,(function(){a.dispose()})))}function m(e){return a.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(e)}function h(e,n,i){var r=t.unwrap(n())
	return s.isCached(r).then((function(t){t||!r?b(e,i):(e.src=r,e.onload=y.bind(null,e),e.onerror=g.bind(null,e,i,s.add.bind(null,e.src)))}))}function v(e,n,i){var r=t.unwrap(n())
	return r?(e.src=r,e.onload=y.bind(null,e),e.onerror=g.bind(null,e,i)):b(e,i),Promise.resolve()}function g(e,t,i){var r=n.isFunction(i)?i:n.noop
	e.onload=n.noop,b(e,t),r()}function y(e){var n=t.utils.domData.get(e,d)
	i.clearTimeout(n),c.resetInitials(e.parentNode),t.utils.domData.set(e,u,!0)}function b(e,t){var i=n.isFunction(t.get("displayName"))?t.get("displayName")():null,r=t.get("isPstn"),a=t.get("isGroupAvatar"),s=t.get("useDefaultAvatar")||n.noop
	e.src=function(e){var t=e.get("isPstn"),n=e.get("isGroupAvatar")
	if(t&&t())return l.appBaseUrl+l.images.relativeToAppBase.defaultPstnAvatarSvg
	if(n&&n())return l.appBaseUrl+l.images.relativeToAppBase.defaultGroupAvatarSvg
	return l.appBaseUrl+l.images.relativeToAppBase.defaultProfileAvatarSvg}(t),e.onload=n.noop,e.onerror=n.noop,s(!0),!m(o.USE_AVATAR_INITIALS)||!c.isValidDisplayName(i)||r()||a()?c.resetInitials(e.parentNode):c.showColoredInitials(e.parentNode,i)}return{register:function(){var e=v
	m(o.USE_AVATAR_CACHE)&&(e=h),t.bindingHandlers.fallBackOnDefaultAvatarOnError={init:f,update:e}}}})),define("bindings/ko.transitionEnd",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout")
	return{register:function(){t.bindingHandlers.transitionEnd={init:function(e,n){var i,r,o=n(),a=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"]
	function s(e){r&&clearTimeout(r),r=setTimeout((function(){o(e),r=null}),0)}o&&"function"!=typeof o&&(i=o.moreElementsToWatch,o=o.callback),i=(i||[]).map((function(e){return document.querySelector(e)})).filter((function(e){return!!e})),a.forEach((function(t){e.addEventListener(t,s),i.forEach((function(e){e.addEventListener(t,s)}))})),t.utils.domNodeDisposal.addDisposeCallback(e,(function(){a.forEach((function(t){e.removeEventListener(t,s),i.forEach((function(e){e.removeEventListener(t,s)}))}))}))}}}}})),define("experience/koBindingsRegistrar",["require","exports","module","vendor/knockout","bindings/ko.keyboardNavigation","bindings/ko.enterKey","swx-focus-handler/lib/knockoutBinding","bindings/ko.getElement","bindings/ko.overflowClass","bindings/ko.getVisibility","bindings/ko.fallBackOnDefaultAvatarOnError","bindings/ko.transitionEnd"],(function(e,t){var n=e("vendor/knockout"),i=e("bindings/ko.keyboardNavigation"),r=e("bindings/ko.enterKey"),o=e("swx-focus-handler/lib/knockoutBinding"),a=e("bindings/ko.getElement"),s=e("bindings/ko.overflowClass"),c=e("bindings/ko.getVisibility"),l=e("bindings/ko.fallBackOnDefaultAvatarOnError"),u=e("bindings/ko.transitionEnd")
	t.registerBindings=function(){i.register(),r.register(),o.register(n),c.register(),a.register(),s.register(),l.register(),u.register()}})),define("notifications/init",["require","exports","module","swx-browser-globals","ui/viewModels/notifications/allowBrowserNotificationModalDialog","ui/telemetry/actions/actionNames","swx-cafe-application-instance","swx-constants","swx-enums","swx-i18n","swx-service-locator-instance","notifications/factory","notifications/common/notificationHub","utils/common/localStorage","notifications/settings"],(function(e,t){var n=e("swx-browser-globals"),i=e("ui/viewModels/notifications/allowBrowserNotificationModalDialog"),r=e("ui/telemetry/actions/actionNames"),o=e("swx-cafe-application-instance"),a=e("swx-constants").COMMON,s=e("swx-enums"),c=e("swx-i18n").localization,l=e("swx-service-locator-instance").default,u=e("notifications/factory"),d=e("notifications/common/notificationHub"),p=e("utils/common/localStorage"),f=e("notifications/settings")
	t.isInitialized=!1,t.init=function(){if(!0!==t.isInitialized){t.isInitialized=!0
	var e=l.resolve(a.serviceLocator.MODEL_UI_OBSERVER)
	f.init(),o.get().signInManager.state.once(s.loginState.SignedIn,(function(){e.observe(o.get())}))}},t.update=function(){var e=l.resolve(a.serviceLocator.FEATURE_FLAGS),t="swx|browserNotificationsToastLastFired"
	function s(){if(!f.chatNotificationsMuted()&&e.isFeatureOn(a.featureFlags.BROWSER_NOTIFICATIONS_EDUCATIONAL_TOAST_ENABLED)&&d.areBrowserNotificationsSupported()&&n.getWindow().Notification.permission===a.permission.DEFAULT&&!((o=p.get(t))&&Date.now()-o<6048e5)){var o,s=l.resolve(a.serviceLocator.ACTION_TELEMETRY),m=u.build(a.notifications.UNREAD_MESSAGE,{educationalMessage:c.fetch({key:"enable_browser_notifications_toast"}),showAction:function(){p.set(t,Date.now()),s.recordAction(r.browserNotificationsOptInToast.shown)},clickAction:i.show})
	d.notify(m)}}f.init(),e.isFeatureOn(a.featureFlags.UNREAD_MESSAGE_REMINDER_TOAST)?o.get().conversationsManager._unreadCounversationsCounters().then((function(e){var t=e[0]>0&&!function(){var e=a.telemetry.browserToast.ignore,t=p.get(e.TIMEOUT_KEY)
	if(!t)return!1
	if(parseInt(t,10)>=Date.now())return!0
	return p.remove(e.TIMEOUT_KEY),!1}(),n=o.get().conversationsManager._unreadConversations()
	if(t&&!f.chatNotificationsMuted())if(function(){var e,t,n,i=a.telemetry.idleUsersAnalytics.localKeys.signInData
	try{return!(e=p.get(i))||((t=JSON.parse(e)).length<2||(n=new Date(Date.now()).setHours(0,0,0,0),new Date(t[t.length-2]).getTime()<n))}catch(r){return!0}}()){if(n&&n.length){var i=u.build(a.notifications.UNREAD_MESSAGE,{isReminderToast:!0,unreadConversations:n})
	d.notify(i),setTimeout((function(){s()}),3e3)}}else s()
	else s()})):s()}})),define("services/calling/autoCalling",["require","exports","module","swx-cafe-application-instance","ui/viewModels/calling/helpers/callingFacade","swx-constants","swx-log-tracer","swx-service-locator-instance","swx-utils-common","experience/api/helpers/conversationsSynchronizer"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("ui/viewModels/calling/helpers/callingFacade"),r=e("swx-constants").COMMON,o=e("swx-log-tracer").getLogger(),a=e("swx-service-locator-instance").default,s=e("swx-utils-common").sessionStorage,c=e("experience/api/helpers/conversationsSynchronizer")
	function l(e){var t=n.get().conversationsManager,l=a.resolve(r.serviceLocator.FEATURE_FLAGS)
	l.isFeatureOn(r.featureFlags.CALLING)&&l.isFeatureOn(r.featureFlags.AUTO_CALLING)&&(s.set(r.autoCallingThreadId,e),n.get().personsAndGroupsManager.mePerson.id.get().then((function(){c.sync().then((function(){var n=t.getConversationByUri(e)
	n&&n.autoCall?n.autoCall.once(!0,(function(){i.placeCall(n,!0,"autoCalling")})):o.warn("Unable to find conversation with thread id = ",e)}))})))}t.init=function(){var e=s.get("userSession")
	if(e)try{var t=JSON.parse(e).threadId
	t?new l(t):(s.remove(r.autoCallingThreadId),o.warn("Thread ID doesnt exist in user session"))}catch(n){s.remove(r.autoCallingThreadId),o.error("Unable to setup auto calling",n)}else s.remove(r.autoCallingThreadId)}})),define("services/g11n/default",[],(function(){return{calendar:{days:{names:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],namesAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},months:{names:["January","February","March","April","May","June","July","August","September","October","November","December"],namesAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},firstDay:0},time:{AM:"am",PM:"pm",separator:":",format:{duration:"mm:ss",short:"h:mm tt",long:"h:mm:ss tt"}},date:{separator:"/",format:{dayMonth:"M/d",dayMonthYear:"M/d/yy",dayAbbr:"dAbbr",dayName:"dName",dateAbbr:"mAbbr d yyyy",shortDateAbbr:"mAbbr d"}},dir:"ltr"}})),define("services/g11n/init",["require","swx-utils-common","swx-constants","swx-g11n","services/g11n/default","services/i18n/cultureInfo"],(function(e){var t=e("swx-utils-common").loader,n=e("swx-constants").COMMON,i=e("swx-g11n").globalization,r=e("services/g11n/default"),o=e("services/i18n/cultureInfo")
	function a(e,t){e.locale=e.locale||{},e.locale.g11n=t}return i.init(r),{init:function(e){var r=e.initParams.locale
	if(r!==n.i18n.EMBEDDED_LOCALE)return function(e,r,s){var c=0,l=o.getLocale(r),u=[{lang:r,url:e+"/"+r+"/settings.js"}]
	return l!==r&&u.push({lang:l,url:e+"/"+l+"/settings.js"}),u.push({lang:n.i18n.EMBEDDED_LOCALE,url:e+"/en-us/settings.js"}),Skype.WebExperience=Skype.WebExperience||{},Skype.WebExperience.setGlobalization=function(e){i.init(e)},function e(){var i=u[c]
	if(i.lang!==n.i18n.EMBEDDED_LOCALE)return new Promise((function(e,n){t.loadScript(i.url,e,n)})).then((function(){a(s,i.lang)})).catch((function(){if(++c>=u.length)throw new Error("All attempts failed to load g11n settings for:"+r)
	return e()}))
	a(s,i.lang)}()}(e.appBaseUrl+"/resources/g11n",r,e)
	a(e,r)}}})),define("services/i18n/swx/default",[],(function(){return{splashScreen_text_logo_4b:"Skype for Business",splashScreen_text_loading:"Loading...",splashScreen_text_signingIn:"Signing in...",splashScreen_text_signingIn_wac:"Joining the chat...",splashScreen_text_loading_skype:"Loading Skype",splashScreen_text_loading_skype_4b:"Loading Skype for Business",splashScreen_text_signing_into_skype:"Signing in to Skype",splashScreen_text_signing_into_skype_4b:"Signing in to Skype for Business",splashScreen_signedOut_title:"Please sign in to get started.",splashScreen_signedOut_title_wac:"Please join the chat to get started.",splashScreen_signedOut_reauth_needed_title:"You have been signed out",splashScreen_signedOut_reauth_needed_description:"Sign in using your Microsoft account to continue using Skype.",splashScreen_disconnected_title:"You have been disconnected.",splashScreen_disconnected_description:"Please try to sign in again or refresh the page.",splashScreen_disconnected_description_wac:"Please try to join the chat again or refresh the page.",splashScreen_signInFailed_title:"We couldn't sign you in.",splashScreen_signInFailed_title_wac:"We couldn't join you to the chat.",splashScreen_signInFailed_title_security_validation:"Make video and voice calls with Skype for Web.",splashScreen_signInFailed_description:"Please try to sign in again or refresh the page.",splashScreen_signInFailed_description_wac:"Please try to join the chat again or refresh the page.",splashScreen_signInFailed_description_exceeded_endpoints:"Skype has exceeded number of endpoints allowed.",splashScreen_signInFailed_description_age_restriction:"Sorry, you can't use Skype due to age restrictions.",splashScreen_signInFailed_aad_description:"Please try to sign in again or refresh the page.",splashScreen_learn_more:"Learn more",splashScreen_signIn_button:"Sign in",splashScreen_signIn_button_wac:"Join the chat",splashScreen_signInExternal_button:"Sign in with a Microsoft account",splashScreen_eduCarousel_conversation_header:"Conversations",splashScreen_eduCarousel_conversation_text:"Chat with friends and family by sending them an instant message, Moji or photo.",splashScreen_eduCarousel_find_friends_header:"Find Friends",splashScreen_eduCarousel_find_friends_text:"Search for people you know on Skype using their Skype Name, email, mobile or full name.",splashScreen_signInExternal_title:"Attempting to sign in.",splashScreen_signInExternal_description:"Please enter your account and password when prompted.",unsupportedBrowser_title:"Please update your browser to start using Skype.",skypeUnavailable_title:"We're currently experiencing server issues. Skype is working on the issues and will be available again shortly.",aggressiveLinking_intro_title:"Say hello on Outlook",aggressiveLinking_intro_description:"You can now call and chat with Outlook contacts right from your inbox and best of all, it's free.",aggressiveLinking_intro_continue:"Continue",aggressiveLinking_intro_signin:"Already using Skype? {link_start}Sign in{link_end}",aggressiveLinking_intro_legal:"By continuing, you agree to {link_tou_start}Skype's Terms of Use{link_tou_end} and {link_privacy_start}Privacy Policy{link_privacy_end}.",one_account_link:"Already using Skype? {link_start}Learn more{link_end}",input_placeholder_searchSkype:"Search Skype",input_searchSkype_ariaLabel:"Search conversation. Type contact or group name.",input_searchSkype_ariaLabel_4b:"Search conversation. Type contact name.",input_searchSkypeDirectory_ariaLabel:"Search Skype Directory",clear_search_input_label:"Clear search",button_text_newChat:"New Chat",button_text_new:"New",button_text_dialpad:"Call phones",input_text_skypeOut:"Enter name or number",input_text_skypeOut_short:"Enter number",clear_phonenumber_input_label:"Clear phone number",select_placeholder_skypeOut:"Choose country/region",label_text_participant:"{count} participant",label_text_participant_few:"{count} participants",label_text_participant_many:"{count} participants",area_text_insertText:"Type a message here",area_text_insertTextWithCommands:"Type a message here or {helpCommand} for the list of commands",area_text_agent_insertText:"Sorry, you can't reply right now",area_text_insertTextNonMember:"You have left this group.",label_text_insertText_oneToOne:"Chat input, conversation with {displayName}. {quotedText}",label_text_insertText_group:"Chat input, conversation with {displayName}, {participantsText}. {quotedText}",label_text_conversationsLoading:"Loading recent conversations...",label_text_conversationsLoadNone:"No recent conversations",label_text_currentCallHeading:"Current call",label_text_openConversation:"Open conversation with {displayName}",label_text_from:"From: ",label_text_clearedText:"Text area cleared",label_text_clearedQuotes:"Quoted Message cleared",label_quoted_message:"Quoted Message {quotesContent} from {senderName} at {time}",today:"today",yesterday:"yesterday",olderThanAWeek:"older than a week",duration_days:"{count} day",duration_days_few:"{count} days",duration_days_many:"{count} days",duration_hours:"{count} hour",duration_hours_few:"{count} hours",duration_hours_many:"{count} hours",duration_minutes:"{count} minute",duration_minutes_few:"{count} minutes",duration_minutes_many:"{count} minutes",duration_moment:"moment",content_search_conversation_title_days:"{count} day ago in <b>{conversationTitle}</b>",content_search_conversation_title_days_few:"{count} days ago in <b>{conversationTitle}</b>",content_search_conversation_title_days_many:"{count} days ago in <b>{conversationTitle}</b>",content_search_conversation_title_hours:"{count} hour ago in <b>{conversationTitle}</b>",content_search_conversation_title_hours_few:"{count} hours ago in <b>{conversationTitle}</b>",content_search_conversation_title_hours_many:"{count} hours ago in <b>{conversationTitle}</b>",content_search_conversation_title_minutes:"{count} minute ago in <b>{conversationTitle}</b>",content_search_conversation_title_minutes_few:"{count} minutes ago in <b>{conversationTitle}</b>",content_search_conversation_title_minutes_many:"{count} minutes ago in <b>{conversationTitle}</b>",content_search_conversation_title_moment:"moment ago in <b>{conversationTitle}</b>",content_search_header:"Messages",content_search_aria:"Conversation with {topic}.",content_search_additional_results:"Show more messages",contact_isSelected:"Selected",label_text_headerMenuRemoveGroup:"Remove from the group",label_text_headerMenuChat:"Chat",label_text_headerMenuInstantMessage:"Instant message",button_text_discover_agents:"Discover Bots",label_text_discover_agents_page_header:"Bots",label_text_discover_agents_page_hint:"Hint: Interact with Bots by tapping on them and adding them to your contacts.",label_text_discover_agents_page_zero_results_text_part_1:"It looks like you've already connected with all of the Bots. You can interact with them from the Contacts page or by searching for them.",label_text_discover_agents_page_zero_results_text_part_2:"We're always adding new Bots, so check back here soon.",label_text_contact_profile_details:"Contact Details",label_text_contact_profile_skype_name:"Skype",label_text_contact_profile_skype_for_business_name:"Skype for Business",label_text_contact_profile_information:"Information",label_text_contact_profile_location:"Location",label_text_contact_profile_birthday:"Birthday",label_text_contact_profile_gender:"Gender",label_text_contact_profile_language:"Language",label_text_contact_profile_agent_description:"Description",label_text_contact_profile_agent_author:"Author",label_text_contact_profile_agent_certification:"Certification",label_text_contact_profile_agent_rating:"Average Rating",label_text_view_profile_menu_item:"View Profile",label_text_agent_profile_label_agentid:"Bot",label_text_agent_profile_label_skype_certified:"Skype Certified",label_text_agent_profile_label_author:"Created by",label_text_agent_profile_label_description:"About",label_text_agent_profile_label_website:"Website",label_text_agent_profile_label_privacy:"Privacy",label_text_agent_profile_value_privacy:"This bot will have access to your display name, country/region and language and any messages or content that you or other participants share with the bot.",label_text_agent_profile_value_privacy_autoplay:"It may also autoplay media content from third parties",label_text_agent_profile_link_text_terms_of_service:"Terms of Service",label_text_agent_profile_link_text_privacy_statement:"Privacy Statement",label_text_agent_profile_label_rating:"Rating",label_text_agent_profile_label_capabilities:"Here's what you can do with this bot",label_text_agent_profile_label_extra_info:"More info",label_text_agent_profile_capabilities_none:"read updates from this bot",label_text_agent_profile_capabilities_join_char:", ",label_text_agent_profile_capabilities_audio_send:"make voice calls",label_text_agent_profile_capabilities_video_send:"make video calls",label_text_agent_profile_capabilities_im_send:"send instant messages",label_text_agent_profile_capabilities_screen_sharing:"share your screen",label_text_agent_profile_capabilities_gvc:"make group video calls",label_text_agent_profile_capabilities_group_chat:"add bot to group chats",label_text_agent_profile_capabilities_group_chat_mention_only_mode:"(this bot receives messages sent to it using <i>@{botName}</i>)",label_text_agent_profile_capabilities_group_chat_all_messages_mode:"(this bot receives all messages and content sent in the group)",label_text_agent_profile_capabilities_file_send:"send files",label_text_agent_profile_capabilities_contact_send:"send contacts",label_text_agent_profile_capabilities_videomessage_send:"send video messages",label_text_agent_profile_capabilities_audiomessage_send:"send audio messages",label_text_agent_profile_capabilities_mediamessage_send:"send media messages",label_text_agent_profile_capabilities_photo_send:"send photos",label_text_agent_profile_capabilities_moji_send:"send Mojis",label_text_agent_profile_capabilities_location_send:"share location",label_text_agent_profile_capabilities_media_autoplay:"autoplay media content",label_text_blockContact:"Block contact",label_text_block_agent:"Block bot",label_text_blockContact_with_name:"Block {name}",label_text_unblockContact:"Unblock contact",label_text_unblock_agent:"Unblock bot",label_text_unblockContact_with_name:"Unblock {name}",label_text_deleteContact:"Delete contact",label_text_delete_agent:"Delete bot",label_text_call_skype_audio:"Skype call",label_text_call_skype_video:"Video call",label_text_send_message:"Send a message",label_text_call:"Call",label_text_call_phone_number:"Call ({phoneNumber})",label_text_call_phone_number_home:"Call Home ({phoneNumber})",label_text_call_phone_number_work:"Call Office ({phoneNumber})",label_text_call_phone_number_cell:"Call Mobile ({phoneNumber})",label_text_call_phone_number_type:"Call {phoneNumberType} ({phoneNumber})",label_text_phone_number_type_home:"Home",label_text_phone_number_type_work:"Office",label_text_phone_number_type_cell:"Mobile",label_text_phone_number_type_other:"Other",modal_blockContact_text_aria_label:"Block Contact",modal_block_agent_text_aria_label:"Block bot",modal_blockContact_text_title:"Are you sure you want to block {displayName}?",modal_blockContact_text_message:"They won't be able to contact you and won't appear in your Contact List.",modal_block_contact_text_learn_more_link:"Learn more",modal_blockContact_text_reportAbuse:"Report abuse from this person",modal_block_agent_text_reportAbuse:"Report abuse from this bot",select_placeholder_report_abuse_reason:"Select a reason...",report_abuse_reason_option_spam:"Spam",report_abuse_reason_option_pornography:"Contains nudity or pornography",report_abuse_reason_option_child_exploitation:"Child exploitation",report_abuse_reason_option_harassment:"Harassment or threats",modal_deleteContact_text_aria_label:"Delete Contact",modal_delete_agent_text_aria_label:"Delete bot",modal_deleteContact_text_title:"Are you sure you want to delete {displayName}?",modal_deleteContact_text_message:"{displayName} will be removed from your contact list.",modal_device_disabled_chrome_title:"To make Skype calls, please allow Google Chrome access to your camera and microphone.",modal_device_disabled_chrome_text:"Click the {image} icon in the address bar to allow camera and microphone access.",modal_device_disabled_edge_title:"To make Skype calls, please allow Microsoft Edge access to your camera and microphone.",modal_device_disabled_edge_text:'Simply reload this page and try to make another call. Then select "Yes" when prompted to allow access.',header_text_close:"Close",header_text_participantsOthersCanJoin:"{count} participant, others can join",header_text_participantsOthersCanJoin_few:"{count} participants, others can join",header_text_participantsOthersCanJoin_many:"{count} participants, others can join",header_text_shareThisGroup:"Share this group",header_text_groupSettings:"Group Settings",header_text_copyLink:"Copy link",header_text_copied:"Copied",header_text_inviteViaEmail:"Invite via email",header_text_adminSettings:"Manage group",header_text_makeHistoryAvailable:"Make chat history available to new joiners",header_text_joinViaLink:"Make a link for anyone to join",header_text_allowOthersToJoin:"Allow others to join with a link",header_text_othersCanJoin:"Others can join with a link",header_text_muteConversation:"Conversation notifications",header_secondary_text_muteConversation:"Notify me when something new happens",header_narrator_notifications_on:"Notifications on",header_narrator_notifications_off:"Notifications off",header_text_admin:"Admin",header_text_admin_4b:"Presenter",header_text_guest:"Guest",spaces_default_name:"Untitled conversation",spaces_tooltip_text:"Invite other people by sending them this link, even if they're not on Skype.",spaces_email_subject:"I'm ready to chat on Skype",spaces_joining_disabled_message_start:'Turn on <i>"Make a link for anyone to join"</i> from the ',spaces_joining_disabled_anchor_text:"profile ",spaces_joining_disabled_message_end:"to get a link you can share.",spaces_email_greeting:"Hello,",spaces_email_joinMe:"I've made a group on Skype for us to chat, share and collaborate.",spaces_email_link:"Join by click the link",spaces_welcomeTitle:"Your conversation is all set up",spaces_welcomeMessage:"Share photos, messages and much more with everyone here or invite even more people by sharing this link with them",spaces_welcomeMessageWithoutLink:"Share photos, messages and much more with everyone here",spaces_welcomeRenameBtnTitle:"Rename conversation",spaces_welcomeRenameBtnMessage:"Make your conversation unique",spaces_welcomeSettingsBtnTitle:"Settings",spaces_welcomeSettingsBtnMessage:"Manage your conversation",spaces_anyoneElse:"Anyone else? Send them a link",spaces_conversation_renamed_success:"Renamed conversation to {conversationName}.",input_placeholder_addAnotherContact:"Add another contact",input_placeholder_typeContactName:"Type contact name",message_text_hasLeftConversation:"{participant} has left this conversation",message_text_wasRemovedFromConversation:"{participant} has removed {removedParticipant} from this conversation",message_text_youWereRemovedFromConversation:"You have been removed from this conversation",message_text_joinedConversation:"{participant} joined this conversation",message_text_joinConversationFailed:"{participant} could not join this conversation",message_text_meJoinedConversation_one:"{participant} is already chatting",message_text_meJoinedConversation_more:"{participants} and {participant} are already chatting",message_text_wasAddedToConversation:"{participant} added {contact} to this conversation.",message_text_botWasAddedToConversation:"To chat, start your message with <i>@{botName}</i>. All other messages in the group are hidden from the bot.",message_text_joiningConversationWithBots:"<b>{botName} is participating in this group.</b></br>To chat, start your message with <i>@{botName}</i>. All other messages in the group are hidden from the bot.",message_text_joiningConversationWithBotsV2:"<b>{botName} is participating in this group.</b></br>",message_text_addedBotGroupConversation_privateMode:"<b>{botName} receives messages sent directly to it using <i>@{botName}</i>.",message_text_addedBotGroupConversation_allMessagesMode:"<b>{botName} receives all messages and content sent in this chat.",message_text_roleUpdated:"{who} updated {whom}'s role to {role}",message_text_topicUpdated:"{participant} has changed the conversation topic to '{topic}'",message_text_threadPictureUpdated:"{participant} has changed the conversation picture",message_text_historyClosed:"Conversation history was closed by {participant}",message_text_historyDisclosed:"Conversation history was disclosed by {participant}",message_text_sentContacts:"Contacts sent to the conversation",message_text_receivedContacts:"Contacts received from {from}",message_text_contactItem:"<li>{fullName} ({name})</li>",message_text_joiningEnabled:"{participant} enabled joining this conversation",message_text_joiningDisabled:"{participant} disabled joining this conversation",message_text_legacyMemberAdded:"{participant} needs to update Skype to participate in this conversation. Help by sending them to http://www.skype.com/en/download-skype/skype-for-computer/",message_text_legacyMemberUpgraded:"{participant} can now participate in this conversation.",message_text_emptyConversation:"No history available for this conversation",message_text_startedCall:"Call",message_text_startedGroupCall:"Group call",message_text_endedCall:"Call ended",message_text_endedGroupCall:"Group call ended",message_text_outgoingCallNoAnswer:"Call, no answer",message_text_outgoingGroupCallNoAnswer:"Group call, no answer",message_text_missedCall:"Missed call",message_text_missedGroupCall:"Missed group call",message_text_unknownMessageType:"Unknown message type '{mesageType}'",message_text_fileTransferNotSupported:"Receiving files over P2P network is not supported on Skype for Web",message_text_parsing_error:"There was error during message parsing !",message_text_unsupportedVideoMessageYet:"Receiving video messages is not supported on Skype for Web",message_text_unsupportedAudioMessageYet:"Receiving audio messages is not supported on Skype for Web",message_text_guestRemovedBySystem:"The guest account for {participant} has expired",message_text_pollsFeatureDisabled:"Sorry, Polls are not available at this moment. Please try again later. ",message_text_ngcUpgradeMessage_one:"<strong>{participant}</strong> was unable to join this call. They may need to come online, update Skype, or they're using an unsupported device. Find out more at {link}",message_text_ngcUpgradeMessage_many:"<strong>{participantList}</strong> and <strong>{lastParticipant}</strong> were unable to join this call. They may need to come online, update Skype, or they're using an unsupported device. Find out more at {link}",message_text_swift_card:"Card",message_text_swift_cards:"Cards",message_text_swift_receipt:"Receipt",message_text_swift_signIn:"Sign in",message_text_swift_defaultTitle:"Sent you a message",message_text_swift_defaultGroupTitle:"{displayName} sent a message",message_text_swift_vat:"VAT",message_text_swift_tax:"Tax",message_text_swift_totalPrice:"Total",message_text_swift_unsupported:"Get the latest version of Skype to view this card.",message_text_swift_unsupported_button:"Learn more",message_text_swift_showImageTitle:"Enlarge image",message_text_swift_signInTitle:"Connect",message_text_swift_prevCard:"Show previous",message_text_swift_nextCard:"Show next",message_text_swift_showAll:"Show all",message_text_swift_showLess:"Show less",swift_videocard_control_button_mute:"Mute",swift_videocard_control_button_unmute:"Unmute",accessibility_swift_openUrl:"Click to open website in your browser",accessibility_swift_imBack:"Click to send response to bot",accessibility_swift_call:"Click to make a call",accessibility_swift_showImage:"Click to enlarge image",accessibility_swift_action_prefix:"Click to {swiftAction}",message_text_pluginFree_screenSharingFallback_line1:"Screen sharing will be available shortly.",message_text_pluginFree_screenSharingFallback_line2:"Alternatively, switch to the Skype app for your device to receive screen sharing {upgrade_link}.",message_text_pluginFree_microphoneAccess_edge:"No microphone detected. Connect a microphone or check your microphone privacy settings in Settings -> Privacy -> Microphone.",message_text_pluginFree_microphoneAccess_others:"No microphone detected. Connect a microphone or check your microphone privacy settings for your device and browser.",message_text_pluginFree_noVideoCapability:"Sorry, video support is not yet available for this platform.",message_text_suggestedContactGreeting:"<strong>{displayName}</strong> is an address book contact, but needs you to connect first before chatting",message_text_suggestedContactConnectAction:"Connect on Skype",message_text_contactBlockedMessage:"You have blocked <strong>{displayName}</strong>",message_text_contactAccepted:"Contact accepted",message_text_addingContactRequest:"<strong>{id}</strong> wants to add you as a contact",message_text_isNowAContact:"<strong>{id}</strong> is now a contact",message_text_contactRequestGreeting:"Hi, {displayName}, I'd like to add you as a contact.",message_text_contactRequestIsNowContact:"<strong>{displayName}</strong> is now a contact",message_text_contactRequestOutgoingMessage:"<strong>{displayName}</strong> is not in your contacts",message_text_contactRequestOutgoingResendMessage:"Contact request sent",message_text_contactRequestOutgoingResendAction:"Resend contact request",message_text_contactRequestIncomingMessage:"<strong>{displayName}</strong> wants to add you as a contact",message_text_contactRequestSendAction:"Add to Contacts",message_text_contactRequestAcceptAction:"accept",message_text_contactRequestDeclineAction:"decline",message_text_unblockContact:"unblock",message_text_timeStampMessage:"Sent on: ",message_text_longTimeStamp:"{date} at {time}",message_text_removed:"Removed on {date} at {time}",message_text_presenceAvailable:"Available",message_text_presenceOnline:"Online",message_text_presenceNotAvailable:"Not Available",message_text_presenceOffline:"Offline",message_text_presenceHidden:"Invisible",message_text_contactTitleLocal:"People",message_text_contactTitleDirectory:"Directory",message_text_contactBlocked:"Blocked",button_translations_see_original_message:"See original",button_translations_see_translated_message:"See translation",button_translator_translatorSettings:"Skype Translator",label_translator_translatorSettings:"Translator preview",button_translator_translatorSettingsOn:"Switched on",button_translator_translatorSettingsOff:"Switched off",label_translator_translatorOn:"On",label_translator_translatorOff:"Off",label_translator_selected_theirLanguage:"Selected {language} for {name}",label_translator_selected_myLanguage:"Selected {language} for yourself",button_text_searchDirectory:"Search Skype Directory",message_text_emptySearchResults:"No results found",message_text_groupSearchResultsTitle:"Groups",message_title_allContacts:"All contacts",message_bucketName_other:"#",message_not_delivered_text:"This message has not been delivered",message_edited_text:"This message was edited",message_more_search_results_available:"Too many results; try refining your search",label_text_newConv:"New",newbee_text_header:"Get the conversation started",newbee_text_cta:"Find your friends by entering their name or email in the Search Skype field.",newbee_text_cta_4b:"Find your co-workers by entering their name in the Search field.",contactPage_text_menuLink:"Contacts",contactPage_text_header:"Contacts",contactPage_text_tab_allContacts:"All contacts",contactPage_text_tab_available:"Online",contactPage_text_tab_work:"Work",contactPage_text_tab_agents:"Bots",contactPage_text_hint_search:"Hint: you can add new contacts by searching",contactPage_text_manage_contacts_button:"Manage Contacts",contactPage_text_informational_message:"Get the Skype for Business app for video calls and online meetings.",settings_page_text_header:"Settings",settings_pane_opened:"Settings pane opened",settings_im_settings_category_title:"IM settings",settings_privacy_category_title:"Privacy",settings_unlisted_category_title:"Unlisted",settings_contacts_category_title:"Contacts",settings_about_category_title:"About",settings_personalization_category_title:"Personalization",settings_im_appearance_category_title:"IM appearance",settings_notifications_category_title:"Notifications",settings_unknownOption_title:"Unknown option: {id}",settings_unknownOption_alt_text:"Unknown option: {id}",settings_mentionsEnabled_title:"@mention notifications",settings_mentionsEnabled_alt_text:"Always notify me when someone mentions me on Skype. (@&lt;username&gt;)",settings_youtube_player_title:"YouTube player",settings_youtube_player_alt_text:"Use YouTube player directly to preview videos I send or receive.",settings_urlPreview_title:"Web link previews",settings_urlPreview_alt_text:"Show me a preview of websites I send or receive on Skype.",settings_filePaste_title:"Enable image paste",settings_filePaste_alt_text:"Enable pasting of images from clipboard directly into the chat",settings_skypeCallPolicy_title:"Allow calls from:",settings_skypeVideoPolicy_title:"Allow video and screen sharing from:",settings_camera_title:"Camera",settings_microphone_title:"Microphone",settings_speaker_title:"Speaker",settings_no_camera_title:"No camera available",settings_no_microphone_title:"No microphone available",settings_no_speaker_title:"No speaker available",settings_close_title:"Close",settings_default_device_name:"Automatically selected",settings_typingIndicator_title:"Typing indicator",settings_typingIndicator_alt_text:"Show when I am typing",settings_pinRecentFavorites_title:"Show favorites above recent conversations",settings_pinRecentFavorites_alt_text:"Pin your favorite contacts and conversations at the top of the recent message list",settings_emoticonSuggestions_title:"Emoticon suggestions",settings_emoticonSuggestions_alt_text:"Show emoticon suggestions as I type chat messages.",settings_showEmoticons_title:"Show emoticons",settings_showEmoticons_alt_text:"Show Skype emoticons in chat.",settings_showAnimatedEmoticons_title:"Show animated emoticons",settings_showAnimatedEmoticons_alt_text:"Animate Skype emoticons in chat.",settings_showLargeEmoticons_title:"Show large emoticons",settings_showLargeEmoticons_alt_text:"Make single emoticons larger in chat.",settings_translator_title:"Translator",settings_translator_title_alt_text:"Enable Skype Translator",settings_sendReadReceipts_title:"Send read receipts",settings_sendReadReceipts_alt_text:"Show when other people have read your messages. When turned off, you also won't see their read receipts either.",settings_privacy_opt_1_title:"Anyone",settings_privacy_opt_2_title:"Contacts only",settings_privacy_opt_3_title:"Nobody",settings_short_circuit_my_contact_list:"My contact list",settings_short_circuit_title:"Automatically add friends",settings_short_circuit_description:"Skype will check your address books and automatically add people you know to your Skype Contact list.",settings_short_circuit_deny:"Don't automatically add friends",settings_short_circuit_deny_title:"You'll need to manually find and add new contacts.",settings_short_circuit_manage_contacts:"Manage address books",settings_short_circuit_auto_buddy_discovery_title:"How people find me:",settings_short_circuit_auto_buddy_discovery_description:"These contact details can be used to find you on Skype",settings_short_circuit_remove:"Remove",settings_short_circuit_remove_accessible_text:"Remove {proof}",settings_short_circuit_add_number:"Add new number",settings_notifications_title:"Chat notifications",settings_notifications_alt_text:"Receive notifications for new chat messages",settings_notifications_sound_title:"Sound",settings_notifications_sound_alt_text:"Turn notification sounds on or off",settings_chat_notifications_sound_title:"Chat notification sounds",settings_chat_notifications_sound_alt_text:"Play notification sounds for new chat messages",settings_call_notifications_title:"Incoming call notification",settings_call_notifications_alt_text:"Receive notifications for incoming calls",settings_call_notifications_sound_title:"Incoming call notification sounds",settings_call_notifications_sound_alt_text:"Play notification sounds for incoming calls",settings_ringing_deferrer_title:"Mute ringing",settings_ringing_deferrer_alt_text:"Mute ringing sounds of incoming calls for a certain period of time",settings_ringing_deferrer_defer_for:"For {count} hour",settings_ringing_deferrer_defer_for_few:"For {count} hours",settings_ringing_deferrer_defer_for_many:"For {count} hours",settings_dark_theme:"Dark theme",settings_dark_theme_alt_text:"Change the colors of this app.",settings_video_autoplay:"Automatic video playback",settings_video_autoplay_alt_text:"Choose when to auto-play videos.",setting_on:"On",setting_off:"Off",search_skype_for_friends_and_family_header:"Find friends on Skype",search_skype_for_friends_and_family_message:"Enter their Skype Name, email or number.",search_skype_for_friends_and_family_tip:"Tip: Narrow your search by including their city, country or region.",search_skype_for_friends_and_family_text:"It's a cool and easy way to stay in touch.",search_skype_for_friends_and_family_link:"Learn more here.",search_skype_for_friends_and_family_searchDirectory:"Search Directory",short_circuit_contacts_page_message:"Quickly add people from your address book",short_circuit_contacts_page_message_v2:"Automatically add friends from your address book",short_circuit_contacts_page_cta:"Add friends",about_app_version:"App version",about_assets_version:"Assets version",about_plugin_version:"Plugin version",about_plugin_not_available:"Not available",about_faq:"Frequently asked questions",message_text_callingNotSupportedBrowser:"Audio and video calls are not supported on your browser",message_text_callingNotSupportedOS:"Audio and video calls are not supported on your OS",message_text_callingIsDisabled:"Calling is currently disabled.",chatLogmenuItem_text_copy:"Copy as Quote",chatLogmenuItem_text_quote:"Quote Message",chatLogmenuItem_text_edit:"Edit Message",chatLogmenuItem_text_remove:"Remove Message",chatLogmenuItem_text_like:"Like Message",chatLogmenuItem_text_save:"Save",chatLogmenuItem_copy_link:"Copy link",chatLogmenuItem_open_link:"Open",chatLogmenuItem_text_copySelection:"Copy as Quote",chatLogmenuItem_text_copyText:"Copy Text",chatLogIntroText_text:"Chat with people editing this file in Office Online. | This chat won't be saved when you close the file.",recentItemMenuItem_text_leave:"Leave conversation",recentItemMenuItem_text_remove:"Delete conversation",recentItemMenuItem_text_remove_4b:"Close conversation",recentItemMenuItem_text_markRead:"Mark as read",recentItemMenuItem_text_markAllConversationsRead:"Mark all as read",recentItemMenuItem_text_muteConversation:"Turn notifications off",recentItemMenuItem_text_unmuteConversation:"Turn notifications on",actionsMenuItem_text_addParticipants:"Add participants",actionsMenuItem_text_scheduleCall:"Schedule a call",typingIndicator_label_oneParticipant:"{firstParticipantName} is typing...",typingIndicator_label_twoParticipants:"{firstParticipantName} and {secondParticipantName} are typing...",typingIndicator_label_multipleParticipants:"{firstParticipantName}, {secondParticipantName} and {count} other are typing...",typingIndicator_label_multipleParticipants_few:"{firstParticipantName}, {secondParticipantName} and {count} others are typing...",typingIndicator_label_multipleParticipants_many:"{firstParticipantName}, {secondParticipantName} and {count} others are typing...",button_text_emoticons:"Emoticons",button_title_emoticons:"Emoticons",button_text_videoCall:"Video Call",button_text_audioCall:"Audio Call",button_text_joinCall:"Join Call",button_text_joinCallWithVideo:"Join Call with video",button_text_addParticipants:"Add",button_text_cancelAddParticipants:"Cancel",button_text_createConversation:"Create",button_text_filePicker:"Share a photo",button_text_chatInputActionPicker:"Send Files and Media",button_text_poll:"Send a poll",button_text_moreActions:"More actions",button_text_closeSettings:"Close",callScreen_text_terminationPrompt:"You're currently in a call, are you sure you want to hang up and close Skype?",callscreen_text_terminationMessage:"Call ended",callscreen_text_autoCallConnectingMessage:"Waiting for others to join...",callscreen_text_autoCallTimeoutMessage:"Looks like you're the only one here, try joining the call again later",callscreen_text_autoCallFailedMessage:"Unable to set up call, please try again later",callscreen_text_statusMessageConnecting:"Connecting...",callscreen_text_statusMessageScreenReaderConnecting:"Connecting to {contactName}",callscreen_text_statusMessageScreenReaderEnding_less_than_minute:"Call has ended, duration less than a minute",callscreen_text_statusMessageScreenReaderEnding_minutes:"Call has ended, duration {count} minute",callscreen_text_statusMessageScreenReaderEnding_minutes_few:"Call has ended, duration {count} minutes",callscreen_text_statusMessageScreenReaderEnding_minutes_many:"Call has ended, duration {count} minutes",callscreen_text_participant_joined_notification:"{name} joined",callscreen_text_participant_left_notification:"{name} left",callscreen_text_participant_screen_shared_notification:"{name} has started sharing their screen",callscreen_text_participant_screen_unshared_notification:"{name} has stopped sharing their screen",callscreen_text_statusMessageCalling:"Calling...",callscreen_text_enterFullscreen:"Enter fullscreen mode",callscreen_text_exitFullscreen:"Exit fullscreen mode",callscreen_text_enterGvcGrid:"Grid mode",callscreen_text_videoOn:"Turn video on",callscreen_text_videoOff:"Turn video off",callscreen_text_plusButton:"Add participants, share screens and more",callscreen_text_shareScreens:"Share screens...",callscreen_text_shareScreen:"Share screen",callscreen_text_stopSharingScreen:"Stop sharing",callscreen_text_addParticipants:"Add people to this call",callscreen_text_microphoneOn:"Turn microphone on",callscreen_text_microphoneOff:"Turn microphone off",callscreen_text_endCall:"End call",callscreen_text_participants:"{count} in the call",callscreen_text_showChat:"Show IM",callscreen_text_showContacts:"Show contacts",callscreen_text_hangUp:"Hang up",callscreen_text_addParticipantsToCall:"Add people to this call",callScreen_text_andMore:"and more",callscreen_text_dialpadOn:"Turn dialpad on",callscreen_text_dialpadOff:"Turn dialpad off",callscreen_title_zoom:"Double-click to zoom",callscreen_text_showAVSettings:"Audio and video settings",callscreen_text_transferCall:"Transfer call",callscreen_text_showSidebar:"Show sidebar",callscreen_text_hideSidebar:"Hide sidebar",callscreen_participantMenu_pin:"Pin",callscreen_participantMenu_unpin:"Unpin",callscreen_participantMenu_zoomIn:"Zoom In",callscreen_participantMenu_zoomOut:"Zoom Out",callscreen_participantMenu_chat:"Chat",toast_incoming_text_title:"Incoming call",toast_incoming_text_acceptWithVideo:"Accept with video",toast_incoming_text_acceptWithAudio:"Accept with audio",toast_incoming_text_reject:"Reject call",toast_install_text_title:"is trying to call you",toast_install_text_installButton:"Install plugin",toast_install_text_message:"You'll need a plugin to make Skype calls",pluginInstall_main_close_screen_title:"Are you sure you want to leave?",pluginInstall_main_close_screen_subtitle:"You're almost done setting up Skype calling.",pluginInstall_main_close_screen_finish_text:"Finish setup",pluginInstall_main_close_screen_leave_text:"Leave",pluginInstall_extension_main_text_title:"Enable Skype calls in a few simple steps...",pluginInstall_extension_main_text_subtitle:"Start by adding Skype Calling extension to Chrome",pluginInstall_extension_main_text_add_extension:"Add extension",pluginInstall_extension_main_installed_text_title:"Great!",pluginInstall_extension_main_installed_text_subtitle:"Now install Skype for Web plugin and you're all set",pluginInstall_extension_main_installed_get_plugin_text:"Get plugin",pluginInstall_extension_main_install_failed_text_title:"Oops, something went wrong",pluginInstall_extension_main_install_failed_text_subtitle:"Let's try again...",pluginInstall_extension_main_install_failed_go_to_chrome_webstore_text:"Go to the Chrome web store",pluginInstall_main_text_close:"Close",pluginInstall_main_text_title:"Want to make a call?",pluginInstall_main_text_subtitle:"You need to install the plugin to make Skype calls",pluginInstall_main_text_install:"Install plugin",pluginInstall_steps_text_restart:"Restart",pluginInstall_steps_text_title:"Let's install the plugin.",pluginInstall_steps_text_subtitle:"Simply follow these three steps to set up Skype calls",pluginInstall_steps_text_termsAndPrivacy:"By installing the Skype Plugin, you agree that you have read and accepted Skype's {terms_link} and {privacy_link}.",pluginInstall_steps_text_termsLink:"Terms of Use",pluginInstall_steps_text_privacyLink:"Skype's privacy policy",pluginInstall_mac_chrome_text_download:"Click on the plugin file.",pluginInstall_mac_chrome_text_install:"Follow the instructions.",pluginInstall_mac_chrome_text_enjoy:"Enjoy free Skype calls.",pluginInstall_mac_chrome_text_enjoy_4b:"Make Skype calls.",pluginInstall_mac_safari_text_download:"Go to downloads, then double-click on the plugin file.",pluginInstall_mac_safari_text_install:"Follow the instructions to install the plugin.",pluginInstall_mac_safari_text_enjoy:"Enjoy making free Skype calls from the web.",pluginInstall_mac_safari_text_enjoy_4b:"Make Skype calls.",pluginInstall_mac_firefox_text_download:"Open the plugin file.",pluginInstall_mac_firefox_text_install:"Follow the instructions.",pluginInstall_mac_firefox_text_enjoy:"Enjoy free Skype calls.",pluginInstall_mac_firefox_text_enjoy_4b:"Make Skype calls.",pluginInstall_mac_unknown_download:"Go to downloads, then double-click on the plugin file.",pluginInstall_mac_unknown_install:"Follow the instructions to install the plugin.",pluginInstall_mac_unknown_enjoy:"Enjoy making free Skype calls from the web.",pluginInstall_windows_chrome_text_download:"Click on the plugin file.",pluginInstall_windows_chrome_text_install:"Wait for the plugin to install.",pluginInstall_windows_chrome_text_enjoy:"Enjoy free Skype calls.",pluginInstall_windows_chrome_text_enjoy_4b:"Make Skype calls.",pluginInstall_windows_msie_text_download:'Click on "Run" to get started.',pluginInstall_windows_msie_text_install:"Wait for the plugin to install.",pluginInstall_windows_msie_text_enjoy:"Enjoy free Skype calls.",pluginInstall_windows_msie_text_enjoy_4b:"Make Skype calls.",pluginInstall_windows_firefox_text_download:'Click "Save File" to get started.',pluginInstall_windows_firefox_text_install:"Click on the plugin file.",pluginInstall_windows_firefox_text_enjoy:"Enjoy free Skype calls.",pluginInstall_windows_firefox_text_enjoy_4b:"Make Skype calls.",pluginInstall_windows_unknown_text_download:'Click on "Run" to get started.',pluginInstall_windows_unknown_text_install:"Wait for the plugin to install.",pluginInstall_windows_unknown_text_enjoy:"Enjoy free Skype calls.",pluginInstall_windows_unknown_text_enjoy_4b:"Make Skype calls.",pluginInstall_unblock_text_title:"Enable Skype Plugin",pluginInstall_unblock_text_chrome_subtitle:'Please click on the plugin icon in the address bar and select "Always allow plug-ins on web.skype.com" to continue with this call.',pluginInstall_unblock_text_firefox_subtitle:'Please click on the plugin icon in the address bar and select "Allow and Remember" to continue with this call.',pluginInstall_callback_text_title:"Call {displayName}",pluginInstall_callback_text_subtitle:"Your plugin is now installed, so you're good to start calling now",pluginInstall_callback_text_call:"Call",pluginInstall_callback_text_accept:"Accept call",pluginInstall_callback_text_notNow:"Not now",pluginInstall_label_text_start:"Plugin Install - Start",pluginInstall_label_text_download:"Plugin Install - Download",pluginInstall_label_text_unblock:"Plugin Install - Unblock Skype Plugin",pluginInstall_label_text_continue:"Plugin Install - Continue Call",pluginInstall_label_text_autoUpdateDisclaimer:"This plugin will automatically update to give you the best experience. If you don't want the updates, please do not install the plugin.",pluginInstall_firefox_unable_to_call_text_title:"Skype calls are temporarily unavailable in Firefox",pluginInstall_firefox_unable_to_call_text_subtitle:"Your current version of Firefox doesn't support making or receiving calls on Skype for Web. In the meantime, please use a different browser such as Microsoft Edge or Google Chrome.",notification_text_osNotSupported:"Missed call from {callerName}. Audio and video calls are not supported on this operating system.",notification_text_browserNotSupported:"Missed call from {callerName}. You are currently using an unsupported browser.",notification_text_learnMore:"Learn more",notification_text_hardware_camera:"Camera not found",notification_text_hardware_mic:"Microphone not found",notification_text_hardware_speaker:"Speaker not found",notification_text_group_conversation_from:"Group conversation from",notification_text_avatar_not_supported_image_type:"The image type you tried to upload is not supported",notification_text_avatar_too_large:"The image you selected is too big, please use an image with a smaller file size.",notification_text_avatar_upload_error:"Unable to change your profile picture, please try again.",enable_browser_notifications_toast:"Turn on desktop notifications to be notified of new messages.",enable_browser_notifications_link_text:"Turn on desktop notifications",allow_browser_notifications_header:"Never miss a message",allow_browser_notifications_text:'Click "Allow" to be notified of new messages.',media_clicktoplay:"Click to play",media_picturesharing_one:"shared a photo",media_picturesharing_group:"{senderName} shared a photo",media_picturesharing_label:"Open photo in a new window",media_voice_message:"Voice Message",media_audiosharing_one:"shared an audio message",media_audiosharing_group:"{senderName} shared an audio message",media_videosharing_one:"shared a video",media_videosharing_group:"{senderName} shared a video",media_videomessage_expired:"Video message has expired",media_audiomessage_expired:"Audio message has expired",mediaPlayer_play:"Play",mediaPlayer_pause:"Pause",videoPlayer_fullscreen:"Fullscreen",videoPlayer_exitFullscreen:"Exit fullscreen",action_button_confirm:"Confirm",action_button_cancel:"Cancel",action_button_save:"Save",action_button_block:"Block",action_button_delete:"Delete",action_button_delete_4b:"Close",action_button_send:"Send",action_button_share_conversation:"Share conversation",action_button_leave:"Leave",media_mojisharing_one:"shared a Moji",media_mojisharing_group:"{senderName} shared a Moji",emoticonPicker_heading_label:"Choose an emoticon",accessibility_recentItem_conversation_muted:"Conversation muted.",accessibility_recentItem_oneToOne:"Conversation with {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_oneToOne_many:"Conversation with {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_oneToOne_unread:"Conversation with {topic}, {count} unread message. {muted} Press Shift + F ten for more options.",accessibility_recentItem_oneToOne_unread_many:"Conversation with {topic}, {count} unread messages. {muted} Press Shift + F ten for more options.",accessibility_recentItem_group_unread:"Group conversation with {count} unread message {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_group_unread_many:"Group conversation with {count} unread messages {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_group:"Group conversation {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_group_many:"Group conversation {topic}. {muted} Press Shift + F ten for more options.",accessibility_recentItem_recent_group:"Recent conversations",accessibility_chatLog_newMessage:"New message from {author}, {content}",accessibility_chatLog_newMessage_withoutAuthor:"New message, {content}",accessibility_searching:"Searching",accessibility_searchItem_oneToOne:"{contactName}, {id}, {status}, {index} of {totalResults} in People.",accessibility_searchItem_group:"Group {groupName}, {index} of {totalResults} in Groups.",accessibility_searchItem_group_displayMessage:"Group {groupName}, {displayMessage}, {index} of {totalResults} in Groups.",accessibility_searchItem_directoryList:"{contactName}, {id}, {status}, {index} of {totalResults} in the Skype Directory.",accessibility_localSearchUpdated:"Search updated and {totalSearchResults} result found in your contacts and groups. {peopleSearchResults} in people and {groupsSearchResults} in Groups.",accessibility_localSearchUpdated_few:"Search updated and {totalSearchResults} results found in your contacts and groups. {peopleSearchResults} in people and {groupsSearchResults} in Groups.",accessibility_localSearchUpdated_many:"Search updated and {totalSearchResults} results found in your contacts and groups. {peopleSearchResults} in people and {groupsSearchResults} in Groups.",accessibility_localSearchUpdated_4b:"Search updated and {totalSearchResults} result found in your contacts.",accessibility_localSearchUpdated_4b_few:"Search updated and {totalSearchResults} results found in your contacts.",accessibility_localSearchUpdated_4b_many:"Search updated and {totalSearchResults} results found in your contacts.",accessibility_localSearchNoResults:"Search updated and no results found in your contacts and groups.",accessibility_localSearchNoResults_4b:"Search updated and no results found in your contacts.",accessibility_searchSkypeDirectory:"Press enter to search the Skype Directory.",accessibility_clearSearchField_ariaLabel:"Clear search input field.",accessibility_skypeDirectorySearchUpdated:"Search updated and {totalSearchResults} result found in the Skype Directory.",accessibility_skypeDirectorySearchUpdated_few:"Search updated and {totalSearchResults} results found in the Skype Directory.",accessibility_skypeDirectorySearchUpdated_many:"Search updated and {totalSearchResults} results found in the Skype Directory.",accessibility_totalSearchUpdated:"Search updated and {totalSearchResults} result found. {peopleSearchResults} in people, {groupsSearchResults} in groups and {SkypeDirectorySearchResults} in the Skype Directory.",accessibility_totalSearchUpdated_few:"Search updated and {totalSearchResults} results found. {peopleSearchResults} in people, {groupsSearchResults} in groups and {SkypeDirectorySearchResults} in the Skype Directory.",accessibility_totalSearchUpdated_many:"Search updated and {totalSearchResults} results found. {peopleSearchResults} in people, {groupsSearchResults} in groups and {SkypeDirectorySearchResults} in the Skype Directory.",accessibility_totalSearchNoResults:"Search updated and no results found in your contacts, groups and the Skype Directory.",accessibility_contactProfile_headingWithClosedProfile:"Open {topic}'s profile.",accessibility_contactProfile_openedProfile:"Opened {topic}'s profile.",accessibility_contactProfile_closedProfile:"Closed {topic}'s profile.",accessibility_contactProfile_headingWithOpenedProfile:"Close {topic}'s profile.",accessibility_groupProfile_headingWithClosedProfile:"Open group profile.",accessibility_groupProfile_headingWithOpenedProfile:"Close group profile.",accessibility_groupProfile_attendeeMenu:"{participantName}. More options.",accessibility_groupProfile_adminMenu:"{participantName}, admin. More options.",accessibility_groupProfile_guestMenu:"{participantName}, guest. More options.",accessibility_groupProfile_historyToggle_on:"Make chat history available to new joiner. On.",accessibility_groupProfile_historyToggle_off:"Make chat history available to new joiner. Off.",accessibility_groupProfile_joiningToggle_on:"Allow people to join this group via link. On.",accessibility_groupProfile_joiningToggle_off:"Allow people to join this group via link. Off.",accessibility_me_expandProfile:"Expand profile",accessibility_me_collapseProfile:"Collapse profile",accessibility_me_availabilityOnAriaLabel:"Online status set to online (notifications on)",accessibility_me_availabilityOffAriaLabel:"Online status set to invisible (notifications off)",accessibility_contactPickerUpdated:"Search updated and {totalSearchResults} result found in your contacts.",accessibility_contactPickerUpdated_few:"Search updated and {totalSearchResults} results found in your contacts.",accessibility_contactPickerUpdated_many:"Search updated and {totalSearchResults} results found in your contacts.",accessibility_contactPickerNoResults:"Search updated and no results found in your contacts.",accessibility_contactPickerResultRemoved:"Removed {displayName} from new conversation participant list",accessibility_contact_blocked_success:"Contact blocked",accessibility_contact_blocked_failure:"Blocking contact failed",accessibility_contact_unblocked_success:"Contact unblocked",accessibility_contact_unblocked_failure:"Unblocking contact failed",accessibility_contact_request_sent_success:"Contact request sent",accessibility_contact_request_sent_failure:"Sending contact request failed",accessibility_contact_request_accepted_success:"Contact request accepted",accessibility_contact_request_accepted_failure:"Accepting contact request failed",accessibility_contact_request_declined_success:"Contact request declined",accessibility_contact_request_declined_failure:"Declining contact request failed",accessibility_contact_sent:"Contact sent",accessibility_contact_deleted_success:"Contact deleted",accessibility_contact_deleted_failure:"Deleting contact failed",accessibility_contact_add_favorite_success:"Added contact to favorites",accessibility_contact_add_favorite_failure:"Adding contact to favorites failed",accessibility_contact_remove_favorite_success:"Removed contact from favorites",accessibility_contact_remove_favorite_failure:"Removing contact from favorites failed",accessibility_selectBox_expanded:"Combo box expanded",accessibility_selectBox_collapsed:"Combo box collapsed",accessibility_addPeopleToConversation_ariaLabel:"Add people to this conversation",addPeopleToConversation_tooltip:"Add people",accessibility_startVideoCall_ariaLabel:"Video call",startVideoCall_tooltip:"Video call",accessibility_startCall_ariaLabel:"Call",videoCallDisabled_tooltip:"You can't make video calls to {agentName}",startCall_tooltip:"Call",accessibility_startGroupCall_ariaLabel:"Call group",callDisabled_tooltip:"You can't make calls to {agentName}",startGroupCall_tooltip:"Call group",turnOffChatNotifications_tooltip:"Turn off chat notifications",turnOnChatNotifications_tooltip:"Turn on chat notifications",giveFeedback_tooltip:"Give feedback",giveFeedback_subject:"Feedback for Skype on the web",giveFeedback_body:"If you're experiencing a problem or have feedback to share with the Skype team, please let us know below.",giveFeedback_button_label:"Feedback",conversationHeader_heading_ariaLabel:"Conversation with {topic}.",groupProfile_spacesLink_ariaLabel:"Link to this group chat: {spacesUrl}",conversation_header_topic_default:"Untitled",conversation_header_topic_untitled_conversation:"Untitled conversation",conversation_header_topic_people_chatting:"{count} person is available",conversation_header_topic_people_chatting_few:"{count} people are available",conversation_header_topic_people_chatting_many:"{count} people are available",message_text_presenceActive:"Active",message_text_presenceMobile:"On mobile",message_text_presenceAway:"Away",message_text_presenceBusy:"Busy",message_text_presenceDoNotDisturb:"Do not disturb",message_text_presenceUnknown:"Status unknown",message_text_activity_inAMeeting:"In a meeting",message_text_activity_urgentInterruptionsOnly:"Urgent interruptions only",message_text_activity_onThePhone:"On the phone",message_text_activity_inAConference:"In a conference",message_text_activity_offWork:"Off work",message_text_activity_outOfOffice:"Out of office",message_text_activity_presenting:"Presenting",expressionPicker_prevPage:"Previous tabs",expressionPicker_nextPage:"Next tabs",expressionPicker_selected_item_title:"{itemTitle} selected.",expressionPicker_mruTab_title:"Most Recently Used",expressionPicker_mruTab_ariaLabel:"Most Recently Used",expressionPicker_mruTab_emptyText:"Recently used items will appear here.",expressionPicker_tab_emptyText:"This tab is empty",expressionPicker_bingTab_title:"Bing",expressionPicker_bingTab_ariaLabel:"Search with Bing for images",expressionPicker_bingTab_emptyText:"Bing results appear here",expressionPicker_bingTab_loadingText:"Loading...",expressionPicker_bingTab_errorText:"An error has occurred! Please try again later",expressionPicker_bingPack_title:"Bing search results",expressionPicker_bingPack_ariaLabel:"Bing search results",expressionPicker_bingGifsPack_title:"Popular Gifs from Bing",expressionPicker_bingMemePack_title:"Popular Memes from Bing",expressionPicker_bingGifsPack_ariaLabel:"Popular Gifs from Bing",expressionPicker_bingMemePack_ariaLabel:"Popular Memes from Bing",expressionPicker_giphyImgTab_title:"Search Giphy",expressionPicker_giphyImgTab_ariaLabel:"Search for animated GIFs. Powered by Giphy",expressionPicker_giphyImgTab_emptyText:"Giphy results appear here",expressionPicker_giphyImgTab_loadingText:"Loading...",expressionPicker_giphyImgTab_errorText:"An error has occurred! Please try again later",expressionPicker_giphyImgTab_terms:"Terms of use",expressionPicker_giphyImgPack_title:"Giphy search results",expressionPicker_giphyImgPack_ariaLabel:"Giphy search results",input_placeholder_searchPESItems:"Search for items...",input_searchPESItems_ariaLabel:"Search items. Type keyword",expressionPicker_localSearchTab_title:"Search",expressionPicker_localSearchTab_emptyText:"Find emoticons and Mojis",expressionPicker_localSearchPack_title:"Quick suggestions",expressionPicker_localSearchPack_ariaLabel:"Quick suggestions",expressionPicker_mruEmoticonPack_title:"Emoticons",expressionPicker_mruEmoticonPack_ariaLabel:"Emoticons",expressionPicker_mruMojiPack_title:"Mojis",expressionPicker_mruMojiPack_ariaLabel:"Mojis",expressionPicker_store_title:"Skype Expression Store",expressionPicker_store_free:"Free",expressionPicker_storeTab_title:"Store",expressionPicker_store_Downloaded:"Downloaded",expressionPicker_store_Downloading:"Downloading...",expressionPicker_store_removeTab:"Remove",input_placeholder_searchPESStore:"Search",accessibility_open_picker:"Menu expanded",accessibility_close_picker:"Menu collapsed",pes_moji_error_text:"The Moji failed to load! Please try again later",poll_designer_question_placeholder:"Ask a question...",poll_designer_answer_placeholder:"Add option...",poll_message_question_header:"Poll: {pollQuestion}",poll_message_goto_text:"Go to {fallbackLink} to vote.",poll_message_people_voted:"{count} people voted",poll_sticky_message_new_poll:"Ongoing poll by {author}: ",poll_sticky_message_me_voted:"My vote: {answerText}",poll_sticky_message_me_not_voted:"Click to vote",poll_fallback_link_text:"Skype for Web",poll_list_title:"Voted by ({count})",presence_lastseen_moments:"Last seen moments ago",presence_lastseen_minutes:"Last seen {number}m ago",presence_lastseen_hours:"Last seen {number}h ago",presence_lastseen_days:"Last seen {number}d ago",presence_lastseen_date_short:"Last seen {shortdate}",presence_lastseen_date_full:"Last seen {fulldate}",guest_user_displayname:"{displayName} (Guest)",pes_featured_title:"Featured",pes_moji_playbutton_label:"Click to play",label_jumpToConversation:"Jump to conversation",share_on_skype_dialog_title:"Share on Skype",share_on_skype_share_button:"Share",share_on_skype_alt_text_button:"Share on Skype",share_on_skype_message_prompt:"Include a message about this...",share_on_skype_picker_prompt:"Search or select...",share_on_skype_status_sending:"Sending...",share_on_skype_status_sent:"Sent",share_on_skype_signed_in_as:"Signed in as {displayName}",share_on_skype_my_account:"My Account",share_on_skype_sign_out:"Sign out",file_transfer_file_shared:"shared a file",file_transfer_share_file:"Share a File",file_transfer_send_photos_and_files:"Send Photos and Files",file_transfer_download_button_title:"Download file {filename}",file_transfer_download_dialog_confirm_button_title:"Accept",file_transfer_download_unsafe_file_dialog_title:"Warning - this file may be unsafe for your computer/device.",file_transfer_download_unsafe_file_dialog_text:"Do you want to accept the file {filename} from {author}?",file_transfer_download_safe_file_dialog_title:"Only accept files from people you trust.",file_transfer_download_safe_file_dialog_text:"Do you want to accept the file {filename} from {author}?",file_transfer_download_dialog_do_not_ask_checkbox:"Do not ask me again",file_transfer_upload_state:"{uploaded} of {size}",file_transfer_upload_completed:"File {filename} has been uploaded",file_transfer_upload_failed:"Cannot upload file",file_transfer_upload_canceled:"Upload canceled",file_transfer_upload_cancel:"Cancel uploading",file_transfer_upload_too_large_warning:"Not sent - File is larger than 100MB. <a href='http://go.skype.com/Cloud.File.Upload' target='_blank'>Learn more</a>",file_transfer_upload_starting:"Starting upload",file_transfer_upload_not_supported:"Sharing files is not supported on Skype for Web",notificationsPage_text_menuLink:"Notifications",remove_conversation_confirmation_text:"All the messages in this conversation will be deleted and it will be removed from both the sidebar and your history.",remove_conversation_confirmation_text_4b:"You will be leaving this conversation and it will be removed from the sidebar.",remove_conversation_confirmation_title:"Are you sure you want to delete this conversation?",remove_conversation_confirmation_title_4b:"Are you sure you want to close this conversation?",accessibility_remove_conversation_confirmation:"Conversation deleted",leave_conversation_confirmation_text:"This action cannot be undone.",leave_conversation_confirmation_text_4b:"You won't receive any more notifications from this conversation. You can later rejoin by sending a new message.",leave_conversation_confirmation_title:'Are you sure you want to leave "{topic}"?',leave_conversation_confirmation_title_4b:"Are you sure you want to leave the conversation?",contact_information_already_contact:"Already a contact",contact_information_add_to_contacts:"Add to contacts",mediaBar_sendContacts_label:"Send contacts...",contactPicker_sendContacts_title:"Send contacts",contactPicker_sendContacts_OKBUtton:"Send",chat_contactSent_label:"Contact sent",chat_contactSent_iconLabel:"Sent",mention_notification_title:"{participant} mentioned you in {chat}",contextMenu_picture_viewAction:"View",contextMenu_picture_commentAction:"Comment",contextMenu_picture_downloadAction:"Download",contextMenu_text_discussAction:"Discuss",send_contacts_action_title:"Send Contacts",send_contacts_action_text:"Add contacts you would like to send",invite_free_overlay_greeting:"Say hello to",invite_free_bubble_contact:"Type a message here",invite_free_bubble_non_contact:"Type a message here, then wait for a reply.",invite_free_textarea_waiting_for_reply:"Waiting for a reply...",invite_free_message_received:"<strong>{displayName}</strong> sent you a message",invite_free_message_received_location:"<strong>{displayName}</strong> sent you a message from {location}",invite_free_block_person:"Block this person",invite_free_respond_request:"Type any message to accept this contact",me_pluginLinkText:"Download Skype plugin",me_accountLinkText:"Manage account",me_accountSignOutLinkText:"Sign out",me_pendingPresence:"Getting status...",me_help:"Help",me_skypeCommunity:"Skype Community",me_sendFeedback:"Send feedback",me_mood:"Mood",me_status:"Status",me_accountInfo:"Account info",me_notifications:"Notifications",me_mobileNumber:"Mobile number",me_avatar_uploadProfilePictureText:"Upload a profile picture",group_avatar_uploadProfilePictureText:"Upload a group chat picture",me_avatar_uploadProfilePictureAriaLabel:"Upload avatar",me_edit_activity_message:"Edit activity message",me_activity_message_title:"Current activity",me_input_text_activity_message_placeholder:"Change activity message",me_edit_activity_message_confirm:"Save changes",me_edit_activity_message_cancel:"Cancel changes",accessibility_me_changePresenceStatusAriaLabel:"Change your online status (currently {currentStatus})",message_sent_status:"Sent",message_sending_status:"Sending",message_delivered_status:"Delivered",message_read_status:"Read",message_failed_status:"Failed",message_edited_success:"Message edited",message_removed_success:"Message removed",credit_balance_text:"Your Skype Credit",credit_purchase_link_text:"Add Skype Credit",subscription_entitlement_text:"Subscriptions",subscription_purchase_link_text:"Get a subscription",no_subscriptions_text:"You have no subscriptions",subscriptions_text_one:"You have {count} subscription",subscriptions_text_many:"You have {count} subscriptions",pstn_emergency_notice_text:"Skype for Web (Beta) is not a replacement for your telephone and can't be used for emergency calling.",pstn_insufficient_funds:"Call failed - you need {credit} or {subscription} to call landlines and mobiles from Skype.",pstn_insufficient_funds_credit:"Skype Credit",pstn_insufficient_funds_subscription:"a subscription",pstn_invalid_number:"The number you have dialed is invalid.",pstn_invalid_number_return_link:"Return to Call phones and try again.",pstn_forbidden_number:"The number you have dialed cannot be reached using Skype.",pstn_insufficient_funds_group:"A participant {phoneNumber} was unable to join the call - you need {credit} or {subscription} to add them to the call.",pstn_insufficient_funds_group_name:"A participant {displayName} ({phoneNumber}) was unable to join the call - you need {credit} or {subscription} to add them to the call.",pstn_invalid_number_group:"A participant {phoneNumber} was unable to join the call - the number is invalid.",pstn_invalid_number_group_name:"A participant {displayName} ({phoneNumber}) was unable to join the call - the number is invalid.",pstn_forbidden_number_group:"A participant {phoneNumber} was unable to join the call - the number cannot be reached using Skype.",pstn_forbidden_number_group_name:"A participant {displayName} ({phoneNumber}) was unable to join the call - the number cannot be reached using Skype.",hearts_bubble_title:"Who liked this",hearts_bubble_meliked:"You",hearts_loved_by:"{list}",hearts_loved_by_count:"Loved by {count}",hearts_loved_by_others:"Loved by {list} and <span>{count}&nbsp;others</span>",hearts_list_title:"Liked by ({count})",hearts_me_text:"You",hearts_like_byMeOnly:"You like this",hearts_like_byOne:"{participantName} likes this",hearts_like_byFew:"{participantFirst}{list} and {participantLast} like this",hearts_like_byMany:"{participantlist} and <span>{count}&nbsp;others</span> like this",hearts_notification_messageGroup:"{participantName} likes your message {messageText}",hearts_notification_messageConv:"likes your message {messageText}",hearts_notification_photoGroup:"{participantName} likes your photo",hearts_notification_photoConv:"likes your photo",hearts_notification_fileGroup:"{participantName} likes your file",hearts_notification_fileConv:"likes your file",hearts_notification_documentGroup:"{participantName} likes your document",hearts_notification_documentConv:"likes your document",hearts_notification_videoMessageGroup:"{participantName} likes your video message",hearts_notification_videoMessageConv:"likes your video message",hearts_notification_urlGroup:"{participantName} likes your url",hearts_notification_urlConv:"likes your url",hearts_notification_youTubeGroup:"{participantName} likes your YouTube video",hearts_notification_youTubeConv:"likes your YouTube video",hearts_accessibility_like:"Like message",hearts_accessibility_unlike:"Unlike message",hearts_toast_message:"new",hearts_toast_title:"click to navigate to the liked message",me_notificationsOn:"Notifications on",me_notificationsOff:"Notifications off",education_bubble_search:"Find people to call or chat with - search by email or Skype Name.",education_bubble_search_4b:"Click this button to find people to chat with.",education_bubble_search_title_4b:"Find a contact",education_bubble_call:"Select the camera button to start a video call.",education_bubble_chat:"Choose a contact to start a chat or call.",education_bubble_chat_4b:"Click on a contact to send them a message.",education_bubble_chat_title_4b:"Send an IM",education_bubble_gotit_button_4b:"Got it",education_bubble_schedule_call_1:"Schedule your next call with {name} here.",education_bubble_schedule_call_1_group:"Stay in touch, schedule your next call here.",schedule_call_new_conversation_topic:"Skype call",schedule_call_subject_text:"Skype call with {topic}",welcomeDialog_header:"Welcome to Skype for Web (Beta)",welcomeDialog_getInTouch:"Get in touch with your friends and family directly from your browser",welcomeDialog_sendIM:"Send instant messages",welcomeDialog_makeCalls:"Make Skype calls",welcomeDialog_makeVideoCalls:"Make video calls",welcomeDialog_getStarted_button:"Get started",welcomeDialog_notForEmergencyCalls:"Skype for Web (Beta) is not a replacement for your telephone and can't be used for emergency calling.",welcomeDialog_cookiesConsent:"By using this site you agree to the use of cookies for analytics, personalised content and ads.",welcomeDialog_readMore:"Read more about cookies",modal_scheduleCall_getting_ready_label:"Getting your call ready...",modal_scheduleCall_ready_label:"Your call is ready to be scheduled.",modal_scheduleCall_create_event_button:"Create event",modal_scheduleCall_close_button:"Close",cqf_title:"How would you rate the quality of this call?",cqf_audio_title:"Tell us about any audio issues you experienced. We'll use the feedback to improve Skype.",cqf_video_title:"Tell us about any audio or video issues you experienced. We'll use the feedback to improve Skype.",cqf_audio_tokens_title:"Audio",cqf_video_tokens_title:"Video",cqf_audio_nolocal:"I could not hear any sound",cqf_audio_noremote:"The other side could not hear any sound",cqf_audio_quality_echo:"I heard echo in the call",cqf_audio_quality_noise:"I heard noise in the call",cqf_audio_quality_volume:"Volume was low",cqf_audio_dropped:"The call ended unexpectedly",cqf_audio_quality_distorted:"Speech was not natural or sounded distorted",cqf_audio_quality_delay:"We kept interrupting each other",cqf_audio_other:"Other, please specify",cqf_audio_quality_dialpad:"Dial pad tones did not work",cqf_video_nolocal:"I could not see any video",cqf_video_noremote:"The other side could not see my video",cqf_video_quality_poor:"Image quality was poor",cqf_video_quality_freezing:"Video kept freezing",cqf_video_dropped:"Video stopped unexpectedly",cqf_video_quality_dark:"The other side was too dark",cqf_video_quality_sync:"Video was ahead or behind audio",cqf_video_other:"Other, please specify",cqf_thanks_title:"Thanks for your feedback!",cqf_accessibility_cancel_btn:"Cancel",cqf_accessibility_submit_btn:"Send feedback",cqf_accessibility_oneStar_ariaLabel:"Very bad",cqf_accessibility_twoStars_ariaLabel:"Poor",cqf_accessibility_threeStars_ariaLabel:"Fair",cqf_accessibility_fourStars_ariaLabel:"Good",cqf_accessibility_fiveStars_ariaLabel:"Excellent",unanswered_call_title_busy:"Busy",unanswered_call_accessibility_title_busy:"Callee is busy.",unanswered_call_title_noanswer:"No answer",unanswered_call_accessibility_title_noanswer:"Callee did not answer.",unanswered_call_title_unavailable:"Unavailable",unanswered_call_accessibility_title_unavailable:"Call unavailable.",unanswered_call_button_chat:"Chat message",unanswered_call_accessibility_button_chat:"Chat message",unanswered_call_button_retry:"Retry",unanswered_call_accessibility_button_retry:"Retry",unanswered_call_button_close:"Close",unanswered_call_accessibility_button_close:"Close",unanswered_call_button_showchat:"Show chat",unanswered_call_accessibility_button_showchat:"Show chat",unanswered_call_chatinput_placeholder:"Call me back (call)",unanswered_call_dial_number:"Dial Number",favorites_recents_category_name:"Favorites",favorites_add_to_favorite:"Add to Favorites",favorites_remove_from_favorite:"Remove from Favorites",welcome_im_display_name:"Send IMs in Outlook",welcome_im_toast_message:"Now you can send IMs from Outlook.\r\n\r\n",welcome_im_first_message:"Type a message below, and hit Enter to try it out.\r\n\r\nFor fun, add some :) B-) :D",welcome_im_reply_message:"(clap) Awesome! Now go forth and message.",sms_input_text_message:"Type an SMS here",sms_via_text:"via",sms_message_destination_skype:"Skype",sms_message_destination_sms:"SMS {phone}",sms_add_phone_number:"Add Phone Number...",sms_country_all_recent_codes_group_title:"Recent Countries and Regions",sms_country_all_country_codes_group_title:"All Countries and Regions",sms_add_phone_number_dialog_text:"Add a number for {accountDisplayName}",sms_send_sms_to_section_title:"Send SMS to:",sms_settings_identification_section_title:"When I send an SMS message, identify me by:",sms_settings_identification_section_option1:"My Skype Name ({skypeid}). Recipients can't send SMS replies.",sms_settings_identification_section_option2:"My mobile phone number. Recipients can send SMS replies.",sms_settings_destination_and_rates_link_text:"SMS destinations and rates",sms_settings_learnmore_link_text:"Learn more about SMS",sms_turn_off_sms_sending:"Send via Skype",sms_status_sending:"Sending SMS...",sms_status_delivered:"SMS delivered",sms_status_deliveringError:"SMS delivering failed",sms_insufficient_balance:"You need Skype Credit to send SMS",sms_price_info_failed:"Something went wrong in getting SMS prices.",sms_price_info_bad_number:"Number to send SMS is invalid",sms_price_info_bad_number_account:"Could not get price information for given number",unreadConversationsReminder:"You have {count} unread conversation",unreadConversationsReminder_few:"You have {count} unread conversations",unreadConversationsReminder_many:"You have {count} unread conversations",unreadMessageFromPersonAndOthersReminder:"You have unread messages from {name} and {count} other",unreadMessageFromPersonAndOthersReminder_few:"You have unread messages from {name} and {count} others",unreadMessageFromPersonAndOthersReminder_many:"You have unread messages from {name} and {count} others",unreadMessageFromPersonReminder:"You have unread messages from {name}",unreadMessageInGroupAndOthersReminder:"You have unread messages in {topic} and {count} other",unreadMessageInGroupAndOthersReminder_few:"You have unread messages in {topic} and {count} others",unreadMessageInGroupAndOthersReminder_many:"You have unread messages in {topic} and {count} others",unreadMessageInGroupReminder:"You have unread messages in {topic}",unreadMessageReminder:"{name} sent you a message.",unreadMessageFromTwoChatsReminder:"{name} and {secondName} sent you a message.",unreadMessageFromChatAndOthersReminder:"{name} and {count} others sent you a message.",unreadMessageFromChatAndOthersReminder_few:"{name} and {count} others sent you a message.",unreadMessageFromChatAndOthersReminder_many:"{name} and {count} others sent you a message.",newSummaryOwaToast:"Unread chats: {name}",newChatsSessionOwaToast:"You have {count} new chat.",newChatsSessionOwaToast_few:"You have {count} new chats.",newChatsSessionOwaToast_many:"You have {count} new chats.",owa_deprecation_notification_message:"Skype for Business is upgrading to Microsoft Teams.",owa_deprecation_notification_action:"Try it now",owa_deprecation_header:"Skype for Business is now Microsoft Teams!",owa_deprecation_body:"Everything's updated and ready for you.",owa_deprecation_action:"Start using Teams",owa_default_chat_client_message:"Your IMs are being sent to Teams!",owa_default_calling_client_message:"Your calls are being sent to Teams!",owa_default_chat_and_calling_client_message:"Your IMs and calls are being sent to Teams!",owa_default_client_notification_action:"Go to Teams"}})),define("bindings/ko.businessAwareL10n",["require","vendor/knockout","swx-constants","swx-service-locator-instance"],(function(e){var t=e("vendor/knockout"),n=e("swx-constants").COMMON,i=e("swx-service-locator-instance").default
	return{register:function(){t.bindingHandlers.businessAwareL10n={update:function(e,r,o,a,s){var c=t.utils.unwrapObservable(r())
	if(i.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.USE_BUSINESS_WORDING)){var l=c.key
	c.key=l+"_4b"}t.bindingHandlers.l10n.update(e,(function(){return c}),o,a,s)}}}}})),define("services/i18n/pluralizer",["require","swx-i18n","bindings/ko.businessAwareL10n","swx-i18n","vendor/knockout"],(function(e){var t=e("swx-i18n").knockoutBindingExtensions,n=e("bindings/ko.businessAwareL10n"),i=e("swx-i18n").plurals,r=e("vendor/knockout")
	return new function(){this.init=function(e){var o,a=e.replace("-","_").toLowerCase(),s=i.pluralizationLocale[a]
	if(s)a=s
	else{if(1===(o=a.split("_")).length)throw new Error("Unsupported language:"+e)
	a=o[0]}i.setLocale(a),t.init(r),n.register()}}})),define("services/i18n/loader",["require","swx-utils-common","experience/settings","swx-i18n","services/i18n/pluralizer","services/i18n/cultureInfo","swx-constants","services/i18n/swx/default"],(function(e){var t=e("swx-utils-common").loader,n=e("experience/settings"),i=e("swx-i18n").resources,r=e("services/i18n/pluralizer"),o=e("services/i18n/cultureInfo"),a=e("swx-constants").COMMON,s=e("services/i18n/swx/default")
	return new function(){var e="/",c="Strings.js"
	function l(e){n.locale=n.locale||{},n.locale.i18n=e}this.load=function(u,d,p){var f=u+e+d+e+p+e+c
	function m(e){return new Promise((function(n,i){t.loadScript(e,n,i)}))}return Skype.WebExperience=Skype.WebExperience||{},Skype.WebExperience.setTranslations=function(e){i.merge(e)},r.init(p),m(f).then((function(){return n.applicationLanguage=p,p})).catch((function(){return m(u+e+d+e+p+e+"strings.js").then((function(){return p}))})).catch((function(){var t=o.getLocale(p),i=u+e+d+e+t+e+c
	return n.applicationLanguage=t,m(i).then((function(){return p}))})).catch((function(){return i.set(s),n.applicationLanguage="en-us",a.i18n.EMBEDDED_LOCALE})).then(l.bind(null))}}})),define("services/i18n/init",["require","swx-i18n","services/i18n/swx/default","services/i18n/pluralizer","swx-constants","services/i18n/loader"],(function(e){var t=e("swx-i18n").resources,n=e("services/i18n/swx/default"),i=e("services/i18n/pluralizer"),r=e("swx-constants").COMMON,o=e("services/i18n/loader"),a=r.i18n.EMBEDDED_LOCALE
	return new function(){this.init=function(e,t){var n,i=e.initParams.locale,r=e.initParams.variant
	return t.lang||(t.lang=i),i===a&&"swx"===r?(e.locale=e.locale||{},e.locale.i18n=i,Promise.resolve()):(n=e.appBaseUrl+"/resources/i18n",o.load(n,r,i))},t.set(n),i.init(a)}})),define("experience/featureFlags/api",[],(function(){return function(e){var t=e.featureFlags?e.featureFlags:{}
	this.isFeatureOn=function(e){return Boolean(t[e])}}})),define("services/controls/controlsBuilder",["require","vendor/knockout","experience/settings","browser/dom","swx-service-locator-instance","swx-constants","utils/common/accessibility","utils/common/applicationFocusManager","swx-g11n"],(function(e){var t=e("vendor/knockout"),n=e("experience/settings"),i=e("browser/dom"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("utils/common/accessibility"),s=e("utils/common/applicationFocusManager"),c=e("swx-g11n").globalization,l="data-control",u="model"
	return function(){var e=this,d={},p=[]
	function f(e){if(!(t=e).name||!t.render||"function"!=typeof t.render)throw'Invalid control. Make sure "name" and "render" attributes are present.'
	var t
	if(d[e.name])throw"The control you are trying to register (name: "+e.name+") has already been registered"
	d[e.name]=e}function m(e,n,i){d[e].render(i,(function(e){(function(e){var n
	if(!e||!e.childNodes)return
	for(var i=(n=e.childNodes).length-1;i>=0;i--)h(n[i])||t.removeNode(n[i])})(n),function(e,t){t.appendChild(e)}(e,n)
	for(var i=e.querySelectorAll("["+l+"]"),r=i.length-1;r>=0;r--){var o=i[r]
	m(o.getAttribute(l),o,v(o)||{})}}))}function h(e){for(var t=0;t<p.length;t++)if(p[t](e))return!0
	return!1}function v(e){var t
	if(e.dataset)t=e.dataset[u]
	else if(e.attributes){var n=e.attributes["data-"+u]
	n&&(t=n.value)}if(!t)return{}
	try{return JSON.parse(t)}catch(i){return{}}}t.virtualElements.allowedBindings.control=!0,t.bindingHandlers.control={init:function(e,n){var i,r=n()
	r=t.unwrap(r),(i=d[r.name]).render(r.model,(function(n){var r=e.parentNode,o=e.nextSibling
	r.insertBefore(n,e),r.removeChild(e),r.removeChild(o),i.onDispose&&t.utils.domNodeDisposal.addDisposeCallback(n,i.onDispose.bind(i))}))}},this.registeredElements=[],this.build=function(t,l,u){var d=i.getElement(l),p=r.resolve(o.serviceLocator.FEATURE_FLAGS).isFeatureOn(o.featureFlags.SHOW_SPLASH_SCREEN)
	e.registeredElements.push({name:t,element:l}),t===n.controls.content.toLowerCase()&&p&&r.resolve(o.serviceLocator.SPLASH_SCREEN).init(d.parentNode),u=u||{},d.addClass(o.experience.RENDERER_CLASS),c.initLocaleDirection(d),a.initFocusRing(d),s.registerContainer(d),n.mode&&(u.mode=n.mode,d.addClass(n.mode)),m(t,d,u)},this.register=function(e){e instanceof Array?e.forEach((function(e){f(e)})):f(e)},this.get=function(e){if(!d[e])throw"Control not found"
	return d[e]},this.available=function(){return Object.keys(d)},this.registerNodePersistenceInspector=function(e){p.push(e)}}})),define("services/navigation/navigationContext",["require","vendor/knockout"],(function(e){var t=e("vendor/knockout")
	return function(){this.currentPlaceName=t.observable(""),this.currentPlaceModel=t.observable(null),this.reset=function(){this.currentPlaceName(""),this.currentPlaceModel(null)}}})),define("notifications/modelObservers/incomingCallObserver",["require","notifications/factory","swx-enums","swx-constants","notifications/common/notificationHub","swx-browser-detect","ui/telemetry/telemetryClient","experience/settings","swx-service-locator-instance","notifications/settings"],(function(e){var t=e("notifications/factory"),n=e("swx-enums"),i=e("swx-constants").COMMON,r=e("notifications/common/notificationHub"),o=e("swx-browser-detect").default,a=e("ui/telemetry/telemetryClient"),s=e("experience/settings"),c=e("swx-service-locator-instance").default,l=e("notifications/settings")
	function u(){var e,u,d=[],p=a.get(),f=c.resolve(i.serviceLocator.FEATURE_FLAGS),m=this
	function h(t){y(t).audioStateChangeSubscription=t.selfParticipant.audio.state.changed((function(a,s,d){(function(t,a,s,d){var p={newValue:a,oldValue:d}
	if(o.getBrowserInfo().isShellApp)return
	if(b(a)&&!function(){if(l.callNotificationsMuted())return!1
	var t=e.mePerson.status()
	return f.isFeatureOn(i.featureFlags.USE_BUSINESS_WORDING)?t!==n.onlineStatus.DoNotDisturb:t===n.onlineStatus.Online||t===n.onlineStatus.Away}())return void v({name:"LocalUserOffline"})
	if(b(a)&&function(){var e=c.resolve(i.serviceLocator.FEATURE_FLAGS).isFeatureOn(i.featureFlags.DISABLE_CONCURRENT_ACTIVE_CALLS),t=c.resolve(i.serviceLocator.MODEL_UI_OBSERVER).conversationsCallStateObserver
	if(e&&t.activeCalls().length>0)return!0
	return!1}())return void v({name:"CallInProgress"})
	b(a)&&function(e){(function(e){var t=y(e)
	if(t.notification&&t.notification.active())return Promise.resolve(t.notification)
	return function(e){var t,i=u.mediaCapabilities,r=n.callingNotSupportedReasons.PluginNotInstalled
	return new Promise((function(n){if(i.isPluginInstalled)i.isBrowserMediaSupported()||i.isPluginInstalled()?(t=_(e,!0,r),n(t)):i.isPluginInstalled.get().finally((function(){i.isPluginInstalled()?(t=_(e,!0,r),n(t)):(t=_(e,!1,r),n(t))}))
	else{var o=e.audioService.accept.enabled()
	r=e.audioService.accept.enabled.reason,t=_(e,o,r),n(t)}}))}(e).then((function(e){return t.notification=e,t.notification}))})(e).then((function(e){(function(e){return e&&e.active()})(e)||function(e){var t,n
	n=e.active.subscribe((function(e){e||n.dispose()})),e.type===i.notifications.AUDIO?e.sender.uri()?r.notify(e):t=e.sender.uri.subscribe((function(n){n&&(r.notify(e),t.dispose())})):r.notify(e)}(e)})).catch((function(){g(e)}))}(t);(function(e){return void 0!==e.oldValue&&e.newValue===n.callConnectionState.Disconnected})(p)&&g(t)})(t,a,0,d)}))}function v(e){p.sendEvent(s.telemetry.uiTenantToken,i.telemetry.calling.MASTER_EVENT,e)}function g(e){var t=y(e),n=t.notification
	n&&!n._keepActive&&(n.active(!1),t.notification=null),m.onNotificationCanceled&&m.onNotificationCanceled()}function y(e){for(var t,n=0;n<d.length;n++)if((t=d[n]).conversation===e)return t
	return t={conversation:e},d.push(t),t}function b(e){return e===n.callConnectionState.Notified}function _(e,r,o){var a,s=i.notifications.INCOMING_CALL,c=!1
	if(!r)switch(o){case n.callingNotSupportedReasons.PluginNotInstalled:case n.callingNotSupportedReasons.PluginBlocked:s=i.notifications.INCOMING_CALL_WITH_NO_PLUGIN
	break
	case n.callingNotSupportedReasons.BrowserNotSupported:s=i.notifications.INCOMING_CALL_BROWSER_NOT_SUPPORTED,c=!0
	break
	case n.callingNotSupportedReasons.OSNotSupported:s=i.notifications.INCOMING_CALL_OS_NOT_SUPPORTED,c=!0
	break
	default:console.warn("[Incoming Call Notification] Audio service disabled but reason is not handled. Reason: "+o),s=i.notifications.INCOMING_CALL_OS_NOT_SUPPORTED}return(a=t.build(s,{conversation:e}))._keepActive=c,a}this.observe=function(t){t.conversationsManager.conversations.added(h),u=t.devicesManager,e=t.personsAndGroupsManager},this.onNotificationCanceled=null}return{build:function(){return new u}}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-mri/lib/mriMaps",["require","exports","lodash-compat"],e)}((function(e,t){var n,i,r=e("lodash-compat");(function(e){e.agent="28",e.lync="2",e.msn="1",e.skype="8",e.pstn="4"})(n=t.contactMriTypes||(t.contactMriTypes={})),function(e){e.agent="agent",e.lync="lync",e.msn="msn",e.skype="skype",e.pstn="pstn"}(i=t.contactTypeNames||(t.contactTypeNames={})),t.contactTypes={},t.contactTypes[i.agent]=n.agent,t.contactTypes[i.lync]=n.lync,t.contactTypes[i.msn]=n.msn,t.contactTypes[i.skype]=n.skype,t.contactTypes[i.pstn]=n.pstn,t.contactTypesByCode=r.invert(t.contactTypes)})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-mri/lib/mri",["require","exports","lodash-compat","./mriMaps"],e)}((function(e,t){var n=e("lodash-compat"),i=e("./mriMaps"),r=/^(?:(\d+):)+/,o=/^(\+)?\d+$/,a=/^guest:/
	function s(e){return o.test(e)}function c(e,t){return t+":"+e}t.getId=function(e){if(n.isString(e))return e.replace(r,"")},t.getTypeFromKey=function(e){var t=r.exec(e)
	if(t)return t[1]},t.getKey=function(e,t){return function(e){return e.match(r)}(e)?e:function(e,t){if(s(e))return c(e,i.contactMriTypes.pstn)
	if(n(i.contactMriTypes).values().contains(t))return c(e,t)
	return c(e,i.contactMriTypes.skype)}(e,t)},t.isPstnId=s,t.isGuestId=function(e){return a.test(e)}}))
	define("swx-mri",["swx-mri/lib/mri"],(function(e){return e})),define("telemetry/usage/inAppActivityTracker",["require","exports","module","swx-enums","swx-constants","browser/document","experience/settings","utils/common/localStorage","ui/telemetry/telemetryClient","swx-cafe-application-instance","telemetry/chat/sidebarReopenedEvent","browser/window","swx-mri"],(function(e,t){var n,i,r,o,a,s=e("swx-enums"),c=e("swx-constants").COMMON,l=e("browser/document"),u=e("experience/settings"),d=e("utils/common/localStorage"),p=e("ui/telemetry/telemetryClient"),f=e("swx-cafe-application-instance"),m=e("telemetry/chat/sidebarReopenedEvent"),h=e("browser/window"),v=e("swx-mri"),g={APP_FOCUSED_TIME_KEY:"swx|AppFocusedTimeMs",APP_CLOSED_TIME_KEY:"swx|appClosedTimeMs",SIGNED_IN_TIME_KEY:"swx|SingedInTimeMs",APP_ENTRY_POINT_REASON:{APP_OPENED:"Opened",APP_FOREGROUNDED:"Foregrounded"},APP_EXIT_POINT_REASON:{APP_CLOSED:"Closed",APP_BACKGROUNDED:"Backgrounded"},TIMEOUT_1_SECOND:1e3,INTERVAL_30_SECONDS:3e4,ENDPOINT_ACTIVATION_TIMEOUT:11e3}
	function y(){for(var e=l.getElementsByClassName(c.experience.RENDERER_CLASS),t=e.length-1;t>=0;--t)if(0!==e[t].getBoundingClientRect().width)return!0
	return!1}function b(e,t,n,i){var r=(t-e)/1e3,o=c.telemetry.inappActivity.KPI_INAPP_ACTIVITY_END,a={Entry_Point:i,Exit_Point:n,Foreground_Start_Time:e.toString(),Foregrounded_Duration:r.toString()}
	r<=0||p.get().sendEvent(u.telemetry.uiTenantToken,o,a)}function _(e,t){var n=f.get().personsAndGroupsManager.mePerson,i=c.telemetry.inappActivity.KPI_INAPP_ACTIVITY_START,r={Entry_Point:t,Foreground_Start_Time:e.toString(),GuestFlow:v.isGuestId(n.id())}
	p.get().sendEvent(u.telemetry.uiTenantToken,i,r)}function E(){d.set(g.APP_CLOSED_TIME_KEY,(new Date).getTime())}function w(){i||(i=setInterval(E,g.INTERVAL_30_SECONDS))}function S(){i&&(i=clearInterval(i))}function x(){y()?n||C():(d.remove(g.APP_FOCUSED_TIME_KEY),S())}function C(){if(a){M(!0)
	var e=(new Date).getTime()
	d.set(g.APP_FOCUSED_TIME_KEY,e),_(e,g.APP_ENTRY_POINT_REASON.APP_FOREGROUNDED),w(),O(),n=!0}}function T(){if(a){y()||(M(!1),m.build().publishCloseTimeout(!0))
	var e=d.get(g.APP_FOCUSED_TIME_KEY),t=d.get(g.SIGNED_IN_TIME_KEY),i=(new Date).getTime()
	t?(b(parseInt(t,10),i,g.APP_EXIT_POINT_REASON.APP_BACKGROUNDED,g.APP_ENTRY_POINT_REASON.APP_OPENED),d.remove(g.SIGNED_IN_TIME_KEY)):e&&(b(parseInt(e,10),i,g.APP_EXIT_POINT_REASON.APP_BACKGROUNDED,g.APP_ENTRY_POINT_REASON.APP_FOREGROUNDED),d.remove(g.APP_FOCUSED_TIME_KEY)),S(),k(),n=!1}}function I(){o||(o=setTimeout((function(){var e=y()&&l.hasFocus()
	e&&!n?C():!e&&n&&T(),o=null}),g.TIMEOUT_1_SECOND))}function A(e){if(e===s.loginState.SignedIn&&(a=!0,y()&&l.hasFocus())){var t=(new Date).getTime()
	d.set(g.SIGNED_IN_TIME_KEY,t),_(t,g.APP_ENTRY_POINT_REASON.APP_OPENED),w(),O(),n=!0}}function M(e){var t,n,i=c.telemetry.idleUsersAnalytics.localKeys.sidebarActivity,r=new Date
	try{(n=(t=d.get(i))?JSON.parse(t):{sidebar:{numberOfSignIns:1}}).sidebar.timestamp=r,n.sidebar.state=e?"opened":"closed",e&&(n.sidebar.lastTimeOpened=r,n.sidebar.numberOfSignIns=0),d.set(i,_stringify(n))}catch(o){console.log("Unable to store sidebar activity.")}}function O(){r||(r=setInterval(N,g.ENDPOINT_ACTIVATION_TIMEOUT))}function k(){r&&(r=clearInterval(r))}function N(){l.hasFocus()&&y()?f.get().isEndpointActive&&f.get().isEndpointActive.set(!0):k()}t.init=function(e){var t,i,r
	a=!1,n=!1,t=d.get(g.APP_FOCUSED_TIME_KEY),i=d.get(g.APP_CLOSED_TIME_KEY),(r=d.get(g.SIGNED_IN_TIME_KEY))&&i?b(parseInt(r,10),parseInt(i,10),g.APP_EXIT_POINT_REASON.APP_CLOSED,g.APP_ENTRY_POINT_REASON.APP_OPENED):t&&i&&b(parseInt(t,10),parseInt(i,10),g.APP_EXIT_POINT_REASON.APP_CLOSED,g.APP_ENTRY_POINT_REASON.APP_FOREGROUNDED),d.remove(g.APP_FOCUSED_TIME_KEY),d.remove(g.APP_CLOSED_TIME_KEY),d.remove(g.SIGNED_IN_TIME_KEY),e.state.changed(A),h.addEventListener(c.events.browser.FOCUS,x),h.addEventListener(c.events.browser.BLUR,T),h.addEventListener(c.events.browser.CLICK,I),h.addEventListener(c.events.browser.BEFOREUNLOAD,(function(){d.set(g.APP_CLOSED_TIME_KEY,(new Date).getTime())}))},t.inappActivityConstants=g,t.isClientVisible=y})),define("notifications/modelObservers/unreadMessageObserver",["require","swx-cafe-application-instance","experience/settings","swx-constants","swx-service-locator-instance","swx-enums","notifications/factory","notifications/common/notificationHub","notifications/settings","ui/telemetry/telemetryClient","notifications/telemetry/browserToastTelemetry","telemetry/usage/inAppActivityTracker","utils/common/styleModeHelper"],(function(e){var t=e("swx-cafe-application-instance"),n=e("experience/settings"),i=e("swx-constants").COMMON,r=e("swx-service-locator-instance").default,o=e("swx-enums"),a=e("notifications/factory"),s=e("notifications/common/notificationHub"),c=e("notifications/settings"),l=e("ui/telemetry/telemetryClient"),u=e("notifications/telemetry/browserToastTelemetry"),d=e("telemetry/usage/inAppActivityTracker"),p=e("utils/common/styleModeHelper")
	function f(){var e=r.resolve(i.serviceLocator.FEATURE_FLAGS),f=e.isFeatureOn(i.featureFlags.NOTIFY_HOST_EVEN_WHEN_ME_NOTAVAILABLE),m=e.isFeatureOn(i.featureFlags.ENABLE_AGGRESSIVE_MENTIONS_TOAST),h=e.isFeatureOn(i.featureFlags.UNREAD_MESSAGE_TOAST_FOR_ACTIVE_ENDPOINT),v=u.build(i.telemetry.browserToast.EVENTS.SHOWN),g=e.isFeatureOn(i.featureFlags.CHAT_MESSAGE_TYPE_NOTIFICATION_ENABLED),y={},b=[],_=t.get().conversationsManager,E=!0
	function w(e,t,n){Array.isArray(e)&&(E?e.forEach((function(e){y[e.id]=y[e.id]||3})):n.length>e.length&&n.filter((function(t){return e.indexOf(t)<0})).forEach((function(e){y[e.id]=void 0
	var t=-1
	b.find((function(n,i){n.conversationId===e.id&&(t=i)})),t>-1&&b.splice(t,1)})))}function S(e,n){return new Promise((function(r){if(n.type()!==o.activityType.TextMessage)return r(!1)
	var a=!p.get().isConsumerIntegrated()||!d.isClientVisible()
	return!(n.sender.id()===t.get().personsAndGroupsManager.mePerson.id())&&!n.sender.isBlocked()&&!n.isDeleted()&&(!e.chatService.shouldNotify||e.chatService.shouldNotify(n.text())||!!m&&i.mentions.meIdentifier.test(n.html()))&&function(){if(f)return!0
	var e=t.get().personsAndGroupsManager.mePerson
	return!!/^sip:.+@anonymous\.invalid$/.test(e.id())||e.status()===o.onlineStatus.Online}()&&(!g||(y[e.conversationId]||(y[e.conversationId]=0),y[e.conversationId]<3))&&a?function(e){return t.get()._context&&t.get()._context.isMyEndpointActive?h?t.get()._context.isTheOnlyActiveEndpoint().then(e):e(t.get()._context.isMyEndpointActive()):e(!0)}(r):r(!1)}))}function x(e){e.historyService.activityItems.added((function(t){return function(e,t){return S(e,t).then((function(r){if(r){var o={muted:c.chatNotificationsMuted().toString(),isClientVisible:d.isClientVisible().toString()}
	e.state&&"function"==typeof e.state&&(o.conversationState=e.state()),l.get().sendEvent(n.telemetry.uiTenantToken,i.telemetry.chat.MESSAGE_NOTIFICATION,o),c.chatNotificationsMuted()||t.isRead.once(!1,(function(){(function(e,t){g&&(y[e.conversationId]++,3===y[e.conversationId]&&b.push(e))
	var n,r,o,c={conversation:e,message:t,summary:C(e)}
	function l(){n.active(!1),o.dispose()}function u(t){v.publish(e,t)}(n=a.build(i.notifications.UNREAD_MESSAGE,c)).publishUnreadMessageTelemetry=u,n.displayType=function(e){if(!e||!e.show)return i.telemetry.browserToast.displayType.NORMAL
	return i.telemetry.browserToast.displayType.SUMMARY}(c.summary),n.isUnreadMessage=!0,r=t.timestamp()||new Date,function(e,t,n){var i
	function r(){i.dispose()}e.conversation=t,e.activityOccurence=n,e.sender.uri()?s.notify(e):i=e.sender.uri.subscribe((function(t){t&&(s.notify(e),r())}))}(n,e,r),o=t.html.changed((function(){c.summary&&c.summary.show||n.description(t.text())})),t.isDeleted.once(!0,l),t.isRead.once(!0,l)})(e,t)}))}}))}(e,t)}))}function C(e){if(g)return{show:3===y[e.conversationId],unreadConversations:b}}g&&_._unreadConversations&&_._unreadCounversationsCounters().then((function(){_._unreadConversations.subscribe(),_._unreadConversations.changed(w),E=!1})),this.observe=function(e){e.conversationsManager.conversations.added(x)}}return{build:function(){return new f}}})),define("notifications/modelObservers/contactRequestObserver",["require","swx-constants","swx-enums","notifications/factory","notifications/common/notificationHub"],(function(e){var t=e("swx-constants").COMMON,n=e("swx-enums"),i=e("notifications/factory"),r=e("notifications/common/notificationHub")
	function o(){function e(e){e.historyService.activityItems.added((function(o){(function(e,o){o.type()===n.activityType.ContactRequestIncoming&&o.isRead.once(!1,(function(){(function(e,n){var o,a={conversation:e,activityItem:n};(function(e){var t
	function n(){t.dispose()}e.sender.uri()?r.notify(e):t=e.sender.uri.subscribe((function(t){t&&(r.notify(e),n())}))})(o=i.build(t.notifications.CONTACT_REQUEST,a)),n.isRead.once(!0,(function(){o.active(!1)}))})(e,o)}))})(e,o)}))}this.observe=function(t){t.conversationsManager.conversations.added(e)}}return{build:function(){return new o}}})),define("notifications/modelObservers/chatRequestObserver",["require","notifications/factory","swx-enums","swx-constants","ui/modelHelpers/conversationHelper","notifications/settings","notifications/common/notificationHub","experience/settings","browser/window","swx-utils-common"],(function(e){var t=e("notifications/factory"),n=e("swx-enums"),i=e("swx-constants").COMMON,r=e("ui/modelHelpers/conversationHelper"),o=e("notifications/settings"),a=e("notifications/common/notificationHub"),s=e("experience/settings"),c=e("browser/window"),l=e("swx-utils-common").async
	function u(){function e(e){e.selfParticipant.chat.state.changed((function(u){(function(e,u){o.chatNotificationsMuted()||u!==n.callConnectionState.Notified||l.execute((function(){e.selfParticipant.audio.state()!==n.callConnectionState.Notified&&function(e){var n,o=t.build(i.notifications.CHAT,{conversation:e})
	function l(){n&&n.dispose()}function u(){e.isGroupConversation()&&"Disconnected"===e.meeting.state()?o.decline():o.active(!1)}o.sender.uri()?a.notify(o):n=o.sender.uri.subscribe((function(e){e&&(a.notify(o),l())}))
	e.chatService.accept.enabled.once(!1,(function(){function t(n){var i,a,l,d=!1
	if(!o.active())return e.chatService.acceptType.changed.off(t),void u()
	switch(n){case"AutoAccepted":if(e.chatService.acceptType.changed.off(t),!s.businessNotificationPersistence.persistWhenAutoAccepted.enabled){u()
	break}d=!0,i=s.businessNotificationPersistence.persistWhenAutoAccepted.timeout,r.isConversationWithWelcomeAgent(e)&&(i=s.welcomeExperience.toastPersistenceTimeout)
	break
	case"ConnectedElsewhere":if(e.chatService.acceptType.changed.off(t),!s.businessNotificationPersistence.persistWhenConnectedElsewhere.enabled){u()
	break}d=!0,i=s.businessNotificationPersistence.persistWhenConnectedElsewhere.timeout
	break
	case"UserAccepted":case"Other":e.chatService.acceptType.changed.off(t),u()
	break
	default:return}d&&(a=c.setTimeout((function(){u(),a=null}),i),l=o.active.subscribe((function(e){!1===e&&(l.dispose(),a&&(c.clearTimeout(a),a=null))})))}e.chatService.acceptType&&o.active()&&(s.businessNotificationPersistence.persistWhenConnectedElsewhere.enabled||s.businessNotificationPersistence.persistWhenAutoAccepted.enabled)?e.chatService.acceptType.changed(t):u()}))}(e)}),0)})(e,u)}))}this.observe=function(t){t.conversationsManager.conversations.added(e)}}return{build:function(){return new u}}})),define("notifications/notificationObserversFactory",["require","exports","module","notifications/modelObservers/incomingCallObserver","notifications/modelObservers/unreadMessageObserver","notifications/modelObservers/contactRequestObserver","notifications/modelObservers/chatRequestObserver","swx-constants","swx-service-locator-instance"],(function(e,t){var n=e("notifications/modelObservers/incomingCallObserver"),i=e("notifications/modelObservers/unreadMessageObserver"),r=e("notifications/modelObservers/contactRequestObserver"),o=e("notifications/modelObservers/chatRequestObserver"),a=e("swx-constants").COMMON,s=e("swx-service-locator-instance").default
	t.getObservers=function(){var e=[],t=s.resolve(a.serviceLocator.FEATURE_FLAGS)
	return t.isFeatureOn(a.featureFlags.INCOMING_CALL_TOAST_NOTIFICATIONS)&&e.push(n.build()),t.isFeatureOn(a.featureFlags.UNREAD_MESSAGE_TOAST_NOTIFICATIONS)&&e.push(i.build()),t.isFeatureOn(a.featureFlags.CONTACT_REQUEST_TOAST_NOTIFICATIONS)&&e.push(r.build()),t.isFeatureOn(a.featureFlags.CHAT_REQUEST_TOAST_NOTIFICATIONS)&&e.push(o.build()),e}})),define("ui/calling/telemetry/callSession",["require","exports","module","swx-util-calling-stack","swx-log-tracer","swx-constants","ui/modelHelpers/conversationHelper","swx-enums","swx-utils-common","swx-utils-common","experience/settings","ui/telemetry/telemetryClient"],(function(e,t){var n=e("swx-util-calling-stack"),i=e("swx-log-tracer").getLogger(),r=e("swx-constants").COMMON,o=e("ui/modelHelpers/conversationHelper"),a=e("swx-enums"),s=e("swx-utils-common").guid,c=e("swx-utils-common").stopwatch,l=e("experience/settings"),u=e("ui/telemetry/telemetryClient")
	function d(e,t){var n,d,p,f={callStarted:c.build(),callDuration:null,outboundVideo:null,outboundScreenshare:null,inboundVideoCollection:[],inboundScreenshareCollection:[]},m=0,h=1,v=2,g=3,y=4,b=!1,_=0,E=[],w=u.get(),S=s.create(),x=m,C=a.mediaConnectionType.Unknown
	function T(e){var t=c.build()
	function n(e){return e===a.mediaStreamState.Active}return t.pause(),E.push(e.state.when(n,t.resume.bind(t))),E.push(e.state.when((function(e){return!n(e)}),t.pause.bind(t))),t}function I(e){if(0===e.length)return"0"
	var t=e.map((function(e){return e.durationInSeconds()}))
	return Math.max.apply(null,t).toString()}function A(e){return e?e.durationInSeconds().toString():"0"}function M(n){var i=r.telemetry.calling.NA
	e.isGroupConversation()&&e.conversationId&&(i=e.conversationId)
	var o={name:n,mediaConnectionType:C,callSessionId:S,isGroupCall:e.isGroupConversation(),conversation_id:i,call_leg_direction:t?r.telemetry.calling.direction.INCOMING:r.telemetry.calling.direction.OUTGOING,call_type:N(),conversation_members:e.participantsCount()+1,wasEscalated:b}
	return _>0&&(o.connected_pstn_participants_upper_bound=_),o}function O(e){i.log("[CallSession] event",e.name,"data",e),w.sendEvent(l.telemetry.uiTenantToken,r.telemetry.calling.MASTER_EVENT,e)}function k(e){return e&&e.audio.state.reason||a.callDisconnectionReason.Terminated}function N(){return e.isGroupConversation()?r.telemetry.calling.callType.S2S:o.isConversationWithPstn(e)?t?r.telemetry.calling.callType.SkypeIn:r.telemetry.calling.callType.SkypeOut:r.telemetry.calling.callType.S2S}function P(e){e!==a.mediaConnectionType.Unknown&&(C=e)}function R(){e.selfParticipant.audio.state.reason===a.callDisconnectionReason.CallEscalated&&(b=!0)
	var t=0
	e.participants.each((function(e){e.audio.state()===a.callConnectionState.Connected&&o.isPstnParticipant(e)&&++t})),_<t&&(_=t)}function L(){E.forEach((function(e){e.dispose&&e.dispose()}))}this.isChildOf=function(t){return e===t},this.start=function(){if(x>=h)i.log("Call session has already started. You are trying to start it twice")
	else{i.log("Call session started:",S),p=(new Date).getTime(),x=h,e.mediaConnectionType&&E.push(e.mediaConnectionType.changed(P)),R()
	var t=M(r.telemetry.calling.START_CALL)
	t.audioAvailability=e.audioService.start.enabled.reason||r.telemetry.calling.AVAILABLE,O(t)}},this.setRinging=function(){if(x!==v)if(x!==g){x=v
	var e=M(r.telemetry.calling.RINGING_CALL)
	d=A(f.callStarted),O(e)}else i.log("Call is already connected, skip ringing state")
	else i.log("Call is already ringing for another participant, skip ringing state")},this.setConnected=function(){var t
	x!==g?x!==m?x!==y?(function(){e.selfParticipant.video.channels(0)&&(f.outboundVideo=T(e.selfParticipant.video.channels(0).stream))
	f.outboundScreenshare=T(e.selfParticipant.screenSharing.stream)}(),t=e.participants.added((function(e){var t=T(e.video.channels(0).stream)
	f.inboundVideoCollection.push(t)
	var n=T(e.screenSharing.stream)
	f.inboundScreenshareCollection.push(n)})),E.push(t),x=g,f.callDuration=c.build(),n=A(f.callStarted),O(M(r.telemetry.calling.CONNECTED_CALL))):i.log("You are trying to set a call session as connected that has ended"):i.log("You are trying to set a call session as connected that has not started"):i.log("You are trying to set a call session as connected but it is already in this state")},this.onParticipantStatusChanged=function(){R()},this.end=function(){var s,c,l,u=r.telemetry.calling.UNAVAILABLE
	return x===m?(i.log("You are trying to end a call session that was not started"),void L()):x===y?(i.log("You are trying to end a call session that has already ended"),void L()):(e.audioService.callId&&e.audioService.callId()&&(u=e.audioService.callId()),c=(s=x===g)||x===v,x=y,(l=M(r.telemetry.calling.END_CALL)).wasConnected=s,l.timeToCancelCall=s?"0":A(f.callStarted),l.timeToConnect=s?n:"0",l.wasAtLeastOnceParticipantOnline=o.isAtLeastOnceParticipantOnline(e),l.timeToRing=d||"0",l.call_id=u,l.call_end_reason=function(n){if(t)return n?a.callDisconnectionReason.Terminated:k(e.selfParticipant)
	var i=!e.isGroupConversation()
	return n?a.callDisconnectionReason.Terminated:k(i?e.participants(0):e.selfParticipant)}(s),l.start_timestamp=p||"undefined",l.end_timestamp=(new Date).getTime(),l.call_leg_duration_sec=A(f.callDuration),l.call_leg_successful=c,l.inbound_video_duration_sec=I(f.inboundVideoCollection),l.outbound_video_duration_sec=A(f.outboundVideo),l.screenshare_duration_sec=A(f.outboundScreenshare),l.screenshare_inbound_duration_sec=I(f.inboundScreenshareCollection),l.screenshare_monitor_count=(e.screenSharingService.shareableResources&&e.screenSharingService.shareableResources.size()||0)+"",O(l),void L())}}function p(){var e=function(){}
	this.start=e,this.setRinging=e,this.setConnected=e,this.onParticipantStatusChanged=e,this.end=e,this.escalate=e}function f(e,t,i){return n.get().isInBrowserCallingSupported()?new d(e,t,i):new p}t.buildOutgoingCallSession=function(e){return f(e,!1)},t.buildIncomingCallSession=function(e){return f(e,!0)}})),define("telemetry/calling/pstn/creditBalanceTracker",["require","exports","module","swx-cafe-application-instance","ui/modelHelpers/conversationHelper","telemetry/calling/pstn/pstn","swx-browser-detect"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("ui/modelHelpers/conversationHelper"),r=e("telemetry/calling/pstn/pstn"),o=e("swx-browser-detect").default
	function a(){var e,t,a=this
	function s(){var e=(new Date).getTime()
	if(t){var n=e-t
	r.updatingCreditBalance(n/1e3),t=null}}a.init=function(){var e=n.get().personsAndGroupsManager.mePerson.account
	e&&e.displayBalance&&e.displayBalance.changed(s)},a.callConnected=function(t){!o.getBrowserInfo().isShellApp&&i.isConversationWithPstn(t)&&(e=!0)},a.callEnded=function(n){!0===e&&i.isConversationWithPstn(n)&&(t=(new Date).getTime(),e=!1)}}t.build=function(){return new a}})),define("ui/viewModels/calling/deviceDisabledViewModel",["require","exports","module","swx-browser-detect","swx-i18n"],(function(e,t){var n=e("swx-browser-detect").default,i=e("swx-i18n").localization
	function r(e){var t=this
	t.title="",t.text="",n.getBrowserInfo().browserName===n.BROWSERS.CHROME&&(t.title=i.fetch({key:"modal_device_disabled_chrome_title"}),t.text=i.fetch({key:"modal_device_disabled_chrome_text",params:{image:'<span class="iconDeviceDisabledChrome"></span>'}})),n.getBrowserInfo().isEdge&&(t.title=i.fetch({key:"modal_device_disabled_edge_title"}),t.text=i.fetch({key:"modal_device_disabled_edge_text"})),t.close=function(){e()}}t.ELEMENT_ID="swx-overlayDeviceDisabled",t.build=function(e){return new r(e)}})),define("text!views/calling/deviceDisabled.html",[],(function(){return'<div id="swx-overlayDeviceDisabled" class="swx-overlayModal swx-overlayDeviceDisabled">\r\n\r\n    <div class="buttonRow">\r\n        <button class="btn narrow transparent" data-bind="click: close" type="button">\r\n            <span class="iconfont after cross pull3" data-bind="l10n: { \'key\': \'header_text_close\' }"></span>\r\n        </button>\r\n    </div>\r\n\r\n    <div class="title">\r\n        <h1 class="fontSize-h0 fontSizeNarrow-h1" data-bind="text: title"></h1>\r\n    </div>\r\n\r\n    <div class="subtitle">\r\n        <p class="fontSize-h4 fontSizeNarrow-h4" data-bind="html: text"></p>\r\n    </div>\r\n</div>'})),define("ui/modalDialog/deviceDisabledDialog",["require","exports","module","swx-cafe-application-instance","swx-browser-detect","swx-constants","ui/viewModels/calling/deviceDisabledViewModel","text!views/calling/deviceDisabled.html","swx-i18n","ui/modalDialog/modalDialog","swx-service-locator-instance"],(function(e,t){var n=e("swx-cafe-application-instance"),i=e("swx-browser-detect").default,r=e("swx-constants").COMMON,o=e("ui/viewModels/calling/deviceDisabledViewModel"),a=e("text!views/calling/deviceDisabled.html"),s=e("swx-i18n").localization,c=e("ui/modalDialog/modalDialog"),l=e("swx-service-locator-instance").default
	function u(){c.dispose(o.ELEMENT_ID)}t.init=function(){if(l.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.DEVICE_DISABLED_DIALOG_ENABLED)){var e=n.get().devicesManager.mediaCapabilities.isMicrophoneEnabled(),t=n.get().devicesManager.mediaCapabilities.isCameraEnabled()
	e&&t||function(){var e,t=o.build(u)
	i.getBrowserInfo().browserName===i.BROWSERS.CHROME&&(e=s.fetch({key:"modal_device_disabled_chrome_title"}))
	i.getBrowserInfo().isEdge&&(e=s.fetch({key:"modal_device_disabled_edge_title"}))
	c.build(o.ELEMENT_ID,t,a),c.show(o.ELEMENT_ID,e)}()}}})),define("ui/viewModels/calling/callScreenViewModel/sounds",["require","swx-browser-detect","ui/controls/calling/sounds"],(function(e){var t=e("swx-browser-detect").default,n=e("ui/controls/calling/sounds")
	return{playEndCall:function(){t.getBrowserInfo().isShellApp||n.playOnce(n.KEYS.CALL_END_CALL)},playRingingOut:function(){t.getBrowserInfo().isShellApp||n.playOnce(n.KEYS.CALL_OUTGOING_P1,(function(){n.playLoop(n.KEYS.CALL_OUTGOING_P2)}))},stopAll:function(){t.getBrowserInfo().isShellApp||(n.stop(n.KEYS.CALL_OUTGOING_P1),n.stop(n.KEYS.CALL_OUTGOING_P2),n.stop(n.KEYS.CALL_DIALING),n.stop(n.KEYS.CALL_CONNECTING))}}})),define("ui/modelObservers/calling/callStateObserver",["require","exports","module","ui/calling/telemetry/callSession","swx-util-calling-stack","swx-constants","telemetry/calling/pstn/creditBalanceTracker","services/cqf/CQFHandler","ui/modalDialog/deviceDisabledDialog","swx-enums","vendor/knockout","notifications/factory","notifications/common/notificationHub","swx-pubsub-instance","ui/viewModels/calling/callScreenViewModel/sounds","ui/calling/unansweredCallHandler"],(function(e,t){var n=e("ui/calling/telemetry/callSession"),i=e("swx-util-calling-stack"),r=e("swx-constants").COMMON,o=e("telemetry/calling/pstn/creditBalanceTracker"),a=e("services/cqf/CQFHandler"),s=e("ui/modalDialog/deviceDisabledDialog"),c=e("swx-enums"),l=e("vendor/knockout"),u=e("notifications/factory"),d=e("notifications/common/notificationHub"),p=e("swx-pubsub-instance").default,f=e("ui/viewModels/calling/callScreenViewModel/sounds"),m=e("ui/calling/unansweredCallHandler")
	function h(){var e,t=this,h=[],v=o.build()
	function g(e){var n=S(e)
	n.participantsSubs=[],n.audioHandler=function(n,i,o){o&&(function(e,t,n){var i=S(e),r=i.getCallSession(t)
	switch(t){case c.callConnectionState.Notified:r.start(),r.setRinging()
	break
	case c.callConnectionState.Connecting:r.start(),a.observe(e),m.observe(e)
	break
	case c.callConnectionState.Connected:r.setConnected(),v.callConnected(e)
	break
	case c.callConnectionState.Disconnecting:a.updateCallData(e)
	break
	case c.callConnectionState.Disconnected:r.end(),i.clearCallSession(),v.callEnded(e),m.callEnded(),n!==c.callConnectionState.Disconnected&&s.init()}}(e,n,o),b(e),_(e,n)),n===c.callConnectionState.Disconnecting&&(i===c.callDisconnectionReason.MissingSpeaker?d.notify(u.build(r.notifications.DEVICE_MISSING_SPEAKER)):i===c.callDisconnectionReason.MissingMicrophone&&d.notify(u.build(r.notifications.DEVICE_MISSING_MICROPHONE))),n===c.callConnectionState.Disconnected&&t.activeCalls.remove(e)},n.videoHandler=function(t){_(e,t)},n.onParticipantAudioStateChanged=function(t){n.callSession&&(n.callSession.onParticipantStatusChanged(),t===c.callConnectionState.Ringing&&n.callSession.setRinging()),t!==c.callConnectionState.Ringing&&t!==c.callConnectionState.EarlyMedia||b(e)},n.participantAddedHandler=function(t){var i=t.audio.state.changed(n.onParticipantAudioStateChanged),r=t.screenSharing.state.when(c.callConnectionState.Notified,E.bind(null,e,t))
	i.participant=t,r.participant=t,n.participantsSubs.push(i,r)},n.participantRemovedHandler=function(e){n.participantsSubs=n.participantsSubs.filter((function(t){return t.participant!==e||(t.dispose(),!1)}))},n.getCallSession=function(t){return n.callSession||(t===c.callConnectionState.Notified||e.activeModalities.audio()?n.callSession=y(e,!0):n.callSession=y(e,!1)),n.callSession},n.clearCallSession=function(){delete n.callSession},n.spawnedConversationStateChanged=function(e){e&&p.publish(r.events.navigation.OPEN_CONVERSATION,{model:e,origin:r.telemetry.historyLoadOrigin.CALLING})},e.participants.added(n.participantAddedHandler),e.participants.removed(n.participantRemovedHandler),e.selfParticipant.audio.state.changed(n.audioHandler),e.selfParticipant.video.state.changed(n.videoHandler),e.spawnedConversation&&e.spawnedConversation.changed(n.spawnedConversationStateChanged)}function y(e,t){return t?n.buildIncomingCallSession(e):n.buildOutgoingCallSession(e)}function b(e){var t=e.selfParticipant.audio.state(),n=e.selfParticipant.audio.state.reason
	t===c.callConnectionState.Connected?f.stopAll():t===c.callConnectionState.Disconnected?(f.stopAll(),n!==c.callDisconnectionReason.Busy&&n!==c.callDisconnectionReason.Missed&&n!==c.callDisconnectionReason.Canceled&&n!==c.callDisconnectionReason.NotificationTimeout&&n!==c.callDisconnectionReason.CallEscalated&&f.playEndCall()):e.participants().some((function(e){return e.audio.state()===c.callConnectionState.EarlyMedia}))?f.stopAll():e.participants().some((function(e){return e.audio.state()===c.callConnectionState.Ringing}))&&(f.stopAll(),f.playRingingOut())}function _(e,n){n===c.callConnectionState.Connecting&&(i.get().isInBrowserCallingSupported()&&p.publish(r.events.navigation.OPEN_CONVERSATION,{model:e,origin:r.telemetry.historyLoadOrigin.CALLING}),-1===t.activeCalls.indexOf(e)&&t.activeCalls.push(e))}function E(e,t){e.screenSharingService.sharer(t),e.screenSharingService.accept.enabled()&&e.screenSharingService.accept()}function w(e){var n=S(e)
	n&&(n.conversation.selfParticipant.audio.state.changed.off(n.audioHandler),n.conversation.selfParticipant.video.state.changed.off(n.videoHandler),n.conversation.participants.added.off(n.participantAddedHandler),n.conversation.participants.removed.off(n.participantRemovedHandler),n.participantsSubs.forEach((function(e){e.dispose()})),n.participantsSubs.length=0,t.activeCalls.remove(e))}function S(e){for(var t,n=0;n<h.length;n++)if((t=h[n]).conversation===e)return t
	return t={conversation:e},h.push(t),t}t.activeCalls=l.observableArray(),t.observe=function(t){(e=t.conversationsManager.conversations).added(g),e.removed(w),v.init(),m.init()}}t.build=function(){return new h}})),define("ui/modelObservers/modelObserver",["require","exports","module","notifications/notificationObserversFactory","ui/modelObservers/calling/callStateObserver"],(function(e,t){var n=e("notifications/notificationObserversFactory"),i=e("ui/modelObservers/calling/callStateObserver")
	function r(){var e=this
	e.conversationsCallStateObserver=i.build(),e.observe=function(t){var i;(i=[],n.getObservers().forEach((function(e){i.push(e)})),i.push(e.conversationsCallStateObserver),i).forEach((function(e){e.observe(t)}))}}t.build=function(){return new r}})),define("services/pes/mruService",["require","lodash-compat","swx-constants","utils/common/cache/instance","swx-utils-common","services/pes/constants"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON.events,i=e("utils/common/cache/instance"),r=e("swx-utils-common").builderMixin,o=e("services/pes/constants"),a="pes2"
	function s(e,t){return e===t}function c(e,n){t.forEach(e,(function(e){var i,r=e.id,a=e.type
	n.configuration[a]=n.configuration[a]||[],(i=t.findIndex(n.configuration[a],t.partial(s,r)))>=0&&n.configuration[a].splice(i,1),n.configuration[a].unshift(r),n.configuration[a]=function(e,n){var i=5
	return o.itemTypes[n]&&t.isNumber(o.itemTypes[n].mruLimit)&&(i=o.itemTypes[n].mruLimit),t.take(e,i)}(n.configuration[a],a)}))}function l(e){t.forEach(e.registeredEvents[n.personalExpression.CONFIG_INITIALIZED],t.partial(t.attempt,t,e.getMRUItems()))}function u(){return i.get().getItem(a).then((function(e){return e&&e.mruItems&&t.isObject(e.mruItems)&&!t.isArray(e.mruItems)&&e.version===o.SAVED_DATA_VERSION?e.mruItems:{}}))}function d(){var e=this
	this.configuration={},this.registeredEvents={},u().then((function(t){var n=e.getMRUItems()
	e.configuration=t,c(n,e),l(e)}))}return d.prototype.addItemsToMru=function(e){var n
	return e?(t.isArray(e)||(e=[e]),0===e.length?Promise.resolve():(c(e,this),l(this),n=this.configuration,i.get().setItem(a,{mruItems:n,version:o.SAVED_DATA_VERSION},0))):Promise.resolve()},d.prototype.getMRUItems=function(){return t(this.configuration).map((function(e,n){return t.map(e,(function(e){return{id:e,type:n}}))})).flatten().value()},d.prototype.on=function(e,n){if(e&&n)return this.registeredEvents.hasOwnProperty(e)||(this.registeredEvents[e]=[]),t.any(this.registeredEvents[e],t.partial(s,n))||this.registeredEvents[e].push(n),{cancel:this.off.bind(this,e,n)}},d.prototype.off=function(e,n){return this.registeredEvents.hasOwnProperty(e)?t.first(t.remove(this.registeredEvents[e],t.partial(s,n))):null},t.extend(d,r),d})),define("services/pes/bingSearch/bingSearchService",["require","lodash-compat","swx-utils-common","reqwest","utils/common/cancelation","utils/common/url","experience/settings"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("reqwest"),r=e("utils/common/cancelation"),o=e("utils/common/url"),a=e("experience/settings")
	function s(e,t,n){this.apiKey=e,this.authMethod=t,this.serviceUrl=n}return s.prototype.search=function(e,n){var s,c
	return n=t.defaults({},n,{authMethod:this.authMethod,apiKey:this.apiKey,serviceUrl:this.serviceUrl},{authMethod:a.pesSearchServices.bingAuthMethod,apiKey:a.pesSearchServices.bingApiKey,serviceUrl:a.pesSearchServices.bingServiceURL},{fetch:20}),e?(s={headers:{Authorization:n.authMethod+" "+n.apiKey},url:o.buildUrl(n.serviceUrl,{Query:"'"+e+"'",$top:n.fetch}),dataType:"json",crossOrigin:!0},c=r.adaptAbortable(i.compat(s)),r.makeCancelable(c,n.cancelationToken).then((function(e){return e.d.results.map((function(e){return{id:e.ID,url:e.MediaUrl,contentType:e.ContentType,thumbnail:e.Thumbnail.MediaUrl,title:e.Title,width:e.Width,height:e.Height}}))}))):Promise.resolve()},t.extend(s,n),s})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-giphy-service/lib/giphy",["require","exports","lodash-compat","swx-utils-common","reqwest"],e)}((function(e,t){var n=e("lodash-compat"),i=e("swx-utils-common"),r=e("reqwest"),o={endpoint:"v1/gifs/search",rating:"g",limit:20,offset:0},a={endpoint:"v1/gifs/translate",rating:"g"},s={endpoint:"v1/gifs/random",rating:"g"},c={endpoint:"v1/gifs/trending",rating:"g",limit:20}
	function l(e,t){var n=i.cancelation.adaptAbortable(r.compat(e))
	return i.cancelation.makeCancelable(n,t)}var u=function(){function e(e){this.options=e}return e.prototype.search=function(e,t){return e?(t=n.defaults({},t,this.options,o),l({url:i.url.buildUrl(t.serviceUrl,t.endpoint,{api_key:t.apiKey,rating:t.rating,limit:t.limit,offset:t.offset,q:e}),method:"get",dataType:"json",crossOrigin:!0},t.cancelationToken)):Promise.resolve()},e.prototype.translate=function(e,t){return e?(t=n.defaults({},t,this.options,a),l({url:i.url.buildUrl(t.serviceUrl,t.endpoint,{api_key:t.apiKey,rating:t.rating,s:e}),method:"get",dataType:"json",crossOrigin:!0},t.cancelationToken)):Promise.resolve()},e.prototype.random=function(e,t){return t=n.defaults({},t,this.options,s),l({url:i.url.buildUrl(t.serviceUrl,t.endpoint,e?{api_key:t.apiKey,rating:t.rating,tag:e}:{api_key:t.apiKey,rating:t.rating}),method:"get",dataType:"json",crossOrigin:!0},t.cancelationToken)},e.prototype.trending=function(e){return e=n.defaults({},e,this.options,c),l({url:i.url.buildUrl(e.serviceUrl,e.endpoint,{api_key:e.apiKey,rating:e.rating,limit:e.limit}),method:"get",dataType:"json",crossOrigin:!0},e.cancelationToken)},e}()
	t.build=function(e){return new u(e)}})),define("swx-giphy-service",["swx-giphy-service/lib/giphy"],(function(e){return e})),define("services/pes/config",["require","lodash-compat","swx-constants","swx-i18n","services/pes/constants","utils/chat/pesUtils","swx-service-locator-instance","swx-utils-common","swx-utils-common","swx-utils-chat","experience/settings","reqwest"],(function(e){var t=e("lodash-compat"),n=e("swx-constants").COMMON,i=n.events,r=e("swx-i18n").localization,o=e("services/pes/constants"),a=e("utils/chat/pesUtils"),s=e("swx-service-locator-instance").default,c=e("swx-utils-common").builderMixin,l=e("swx-utils-common").settablePromise,u=e("swx-utils-chat").urlValidator,d=e("experience/settings"),p=e("reqwest")
	function f(){var e,c=l.build(),f={}
	function m(e){f.hasOwnProperty(i.personalExpression.CONFIG_INITIALIZED)&&t.forEach(f[i.personalExpression.CONFIG_INITIALIZED],(function(t){t(e)}))}function h(e,t){var i=(t||"#")+"/"+e.id+"/views/thumbnail"
	return s.resolve(n.serviceLocator.FEATURE_FLAGS).isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)&&(i=a.rewriteUrls(i,d.pesCDNAuthentication.rewriteRules)),{id:e.id,type:o.itemTypes.tab.id,title:e.title,thumbnailUrl:i,packs:[e]}}function v(e,n){return t.find(e,{id:n})}function g(e){return 0===(e.title||"").indexOf(o.FEATURED_IN_PREFIX)}function y(t){var i=s.resolve(n.serviceLocator.FEATURE_FLAGS)
	return t.type!==o.itemTypes.moji.id||(t.auxiliaryUrl=t.auxiliaryUrl||"",u.validate(t.auxiliaryUrl)||(t.auxiliaryUrl=""),t.description=t.description||"",t.auxiliaryText=t.auxiliaryText||t.auxiliaryUrl,t.copyright=t.copyright||"",t._mojiURL=e.itemsRoot+"/"+t.id+"/views/default",t._thumbnailURL=e.itemsRoot+"/"+t.id+"/views/thumbnail",i.isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)&&(t._mojiURL=a.rewriteUrls(t._mojiURL,d.pesCDNAuthentication.rewriteRules),t._thumbnailURL=a.rewriteUrls(t._thumbnailURL,d.pesCDNAuthentication.rewriteRules),e._requiresCDNUrlAuthentication&&(t._mojiURL=t._mojiURL+"?"+e._cdnToken,t._thumbnailURL=t._thumbnailURL+"?"+e._cdnToken))),t}this.getConfiguration=function(){return e},this.init=function(n){var i,a,s
	return e={itemsRoot:"",emoticonsRoot:"",packsRoot:"",items:[],packs:[],tabs:[]},t.assign(e,n),function(e){e.packs.forEach((function(t){var n=[]
	t.items.forEach((function(t){n.push(v(e.items,t))})),t.items=n}))}(e),n.tabs?function(e){e.tabs.forEach((function(t){var n=[]
	t.sections.forEach((function(t){var i=v(e.packs,t.pack)
	i&&i.items&&i.items.length&&n.push(i)})),t.packs=n,t.type=o.itemTypes.tab.id,t.thumbnailUrl=h(t,e.tabsRoot).thumbnailUrl}))}(e):e.tabs=(i=e.packs,a=e.packsRoot,s=[],i&&(i.forEach((function(e){if(!g(e)){var t=h(e,a)
	s.push(t)}})),i.forEach((function(e){if(g(e)){var n=e.title.replace(o.FEATURED_IN_PREFIX,""),i=t.find(s,{title:n})
	i?(e.title=r.fetch({key:"pes_featured_title"}),e.isHidden=!1,i.packs.splice(0,0,e)):!1===e.isHidden&&(e.title=n,i=h(e,a),s.push(i))}}))),s),m(e),c.resolve(),e},this.cdnTokenUpdated=function(t){e._cdnToken!==t&&(e._cdnToken=t,e._requiresCDNUrlAuthentication&&m(e))},this.fetchMetadata=function(i){return c.then((function(){var r,c,l,f="default",h=s.resolve(n.serviceLocator.FEATURE_FLAGS)
	return u.validate(i)?(d.locale&&d.locale.pes&&(f=d.locale.pes),c=i.replace(/\/views\/[^]+$/,"/views/meta."+f),l=t.find(e.items,(function(t){return function(t){var n="default"
	return d.locale&&d.locale.pes&&(n=d.locale.pes),t.type===o.itemTypes.emoticon.id?e.emoticonsRoot+"/"+t.id+"/views/meta."+n:t.type===o.itemTypes.moji.id?e.itemsRoot+"/"+t.id+"/views/meta."+n:null}(t)===c})),l?Promise.resolve(y(l)):(h.isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)&&(c=a.rewriteUrls(c,d.pesCDNAuthentication.rewriteRules),e._requiresCDNUrlAuthentication&&(c=c+"?"+e._cdnToken)),r={url:c,dataType:"json",crossOrigin:!0},h.isFeatureOn(n.featureFlags.PES_CDN_AUTH_ENABLED)&&(r.withCredentials=!0),Promise.resolve(p.compat(r)).then((function(n){var r=i.match(/\/([^\/]+)\/views\/[^\/]+$/)
	return r?(n.id=r[1],t.any(e.items,{id:n.id})||(e.items.push(n),m(e)),y(n)):Promise.reject(new Error("Moji ID not found"))})))):Promise.reject(new Error("URL is not valid"))}))},this.on=function(e,n){if(e&&n)return f.hasOwnProperty(e)||(f[e]=[]),t.any(f[e],(function(e){return e===n}))||f[e].push(n),{cancel:this.off.bind(this,e,n)}},this.off=function(e,n){return f.hasOwnProperty(e)?t.first(t.remove(f[e],(function(e){return e===n}))):null},e={itemsRoot:"",emoticonsRoot:"",packsRoot:"",items:[],packs:[],tabs:[]}}return t.assign(f,c),f})),define("text!views/experience/splashScreen.html",[],(function(){return'\x3c!-- ko if: isVisible --\x3e\r\n<div class="swx shellSplashScreen" id="swxSplashScreen" data-bind="css: theme">\r\n    \x3c!-- ko ifnot: teamsDeprecation  --\x3e\r\n    <div class="shellSplashLogoContainer" data-bind="if: showLogo">\r\n        <div class="shellSplashLogo shellSplashLogoSkype" data-bind="if: !useBusinessWording">\r\n            <span class="iconfont logoSkypeMedium"></span>\r\n        </div>\r\n        <div class="shellSplashLogo shellSplashLogoSkypeForBusiness" data-bind="if: useBusinessWording">\r\n            <span class="iconfont iconSkypeForBusinessLarge"></span>\r\n            <p class="logoText" data-bind="l10n: { \'key\': \'splashScreen_text_logo_4b\' }"></p>\r\n        </div>\r\n    </div>\r\n\r\n    \x3c!-- ko if: showEducationCarousel --\x3e\r\n    <swx-edu-carousel class="EduCarousel"></swx-edu-carousel>\r\n    \x3c!-- /ko --\x3e\r\n\r\n    <div class="shellSplashPage">\r\n        \x3c!-- ko if: showLoader --\x3e\r\n        <div class="shellSpinnerContainer">\r\n            <swx-loading-animation class="swx-spinner" data-bind="css: spinnerColor"></swx-loading-animation>\r\n        </div>\r\n        <div class="fontSize-h4" aria-live="polite" data-bind="html: loadingText"></div>\r\n        <span class="offScreen" aria-live="assertive" data-bind = "html: narratorText"></span>\r\n        \x3c!-- /ko --\x3e\r\n        \x3c!-- ko if: showSignIn --\x3e\r\n        <div class="shellSplashContent">\r\n            <h1 class="fontSize-h2" aria-live="polite" data-bind="html: signInTitle"></h1>\r\n            <p class="fontSize-h4" aria-live="polite" data-bind="html: signInDescription"></p>\r\n            <a class="btn" href="#" data-bind="click: signIn, visible: isSignInEnabled">\r\n                <span data-bind="l10n: { \'key\': \'splashScreen_signIn_button\' }"></span>\r\n            </a>\r\n            \x3c!-- ko if: isSignInExternalEnabled() --\x3e\r\n            <a class="btn" href="#" data-bind="click: signInExternal">\r\n                <span data-bind="l10n: { \'key\': \'splashScreen_signInExternal_button\' }"></span>\r\n            </a>\r\n            \x3c!-- /ko --\x3e\r\n            \x3c!-- ko if: isSignInNotificationEnabled() --\x3e\r\n            <a class="btn" href="#" data-bind="click: notifySignIn">\r\n                <span data-bind="text: getSignInButtonText()"></span>\r\n            </a>\r\n            \x3c!-- /ko --\x3e\r\n            <a class="fontSize-h4" target="_blank" data-bind="attr: {href: learnMoreUrl}, text: signInLearnMoreText, visible: isLearnMoreLinkVisible"></a>\r\n            \x3c!-- ko if: isFeedbackEnabled() --\x3e\r\n            <a class="btn" data-bind="attr: { href: feedbackPageUrl(), target: feedbackPageTarget()}">\r\n                <span data-bind="l10n: { \'key\': \'giveFeedback_button_label\' }"></span>\r\n            </a>\r\n            \x3c!-- /ko --\x3e\r\n        </div>\r\n        \x3c!-- /ko --\x3e\r\n    </div>\r\n    \x3c!-- /ko  --\x3e\r\n    \x3c!-- ko if: teamsDeprecation  --\x3e\r\n        <swx-teams-migrated class="TeamsMigrated"></swx-teams-migrated>\r\n    \x3c!-- /ko  --\x3e\r\n</div>\r\n\x3c!-- /ko --\x3e\r\n'})),define("telemetry/chat/splashScreenEvent",["require","exports","module","usertiming","experience/settings","swx-constants","swx-telemetry-buckets","ui/telemetry/telemetryClient","swx-utils-chat"],(function(e,t){var n=e("usertiming"),i=e("experience/settings"),r=e("swx-constants").COMMON,o=e("swx-telemetry-buckets"),a=e("ui/telemetry/telemetryClient"),s=e("swx-utils-chat").dateTime,c=r.telemetry.performanceMarks,l=r.telemetry.measurements,u=r.telemetry.NOT_AVAILABLE
	function d(){var e,t=r.telemetry.splashScreenEvent.TYPE,d={isSignInEnabled:u,isLearnMoreLinkVisible:u,timeToSplash:u,timeToSplashGroup:u}
	this.startSplashScreenMeasure=function(t,n){e=s.getDate(),d.isSignInEnabled=void 0===t?u:t,d.isLearnMoreLinkVisible=void 0===n?u:n},this.publish=function(){e&&(d.timeToSplash=s.getDate()-e,d.timeToSplashGroup=o.getSecondsDurationGroupFromMs(d.timeToSplash)),d.timeToContent=function(){var e=u,t=l.EXPERIENCE.SPLASH_TIME
	if(n.getEntriesByName(c.EXPERIENCE.CONTENT_INIT).length>0){n.measure(t,c.EXPERIENCE.CONTENT_INIT,c.TIMELINE.SYNC_END_OK)
	var i=n.getEntriesByName(t)
	i&&i.length>0&&(e=i[0].duration)}else{n.measure(t,c.EXPERIENCE.CONTENT_INIT,c.TIMELINE.SYNC_END_ERROR)
	var r=n.getEntriesByName(t)
	r&&r.length>0&&(e=r[0].duration)}return e}(),d.timeToContentGroup=o.getSecondsDurationGroupFromMs(d.timeToContent),d.timelineTTL=function(){var e=u,t=n.getEntriesByName(l.TIMELINE.TTL),i=n.getEntriesByName(l.TIMELINE.TTL)
	t&&t.length>0?e=t[0].duration:i&&i.length>0&&(e=i[0].duration)
	return e}(),d.timelineTTLGroup=o.getSecondsDurationGroupFromMs(d.timelineTTL),a.get().sendEvent(i.telemetry.chatTenantToken,t,d)}}t.build=function(){return new d}})),define("utils/common/signInNotificationHandler",["require","exports","module","swx-constants","experience/settings","lodash-compat","ui/telemetry/actions/actionNames","browser/window","browser/document","notifications/common/notification","swx-service-locator-instance","notifications/common/notificationHub","swx-utils-common"],(function(e,t){var n=e("swx-constants").COMMON,i=e("experience/settings"),r=e("lodash-compat"),o=e("ui/telemetry/actions/actionNames"),a=e("browser/window"),s=e("browser/document"),c=e("notifications/common/notification"),l=e("swx-service-locator-instance").default,u=e("notifications/common/notificationHub"),d=e("swx-utils-common").sessionStorage
	function p(e,t,n){var r,c,l=this,u=null,d=null
	l.url=e||(r=i.loginPopup,c=r.redirectUrl+"?origin="+s.location.origin,r.loginUrl+"?response_type=token&client_id="+a.encodeURIComponent(r.clientId)+"&redirect_uri="+a.encodeURIComponent(c)+"&resource="+a.encodeURIComponent(r.resourceUrl)),l.name=t||"O365_ExternalSignInWindow",l.props=n||function(e,t){e=e||i.loginPopup.defaultWidth,t=t||i.loginPopup.defaultHeight
	var n=void 0!==a.screenLeft?a.screenLeft:screen.left,r=void 0!==a.screenTop?a.screenTop:screen.top,o=a.innerWidth?a.innerWidth:s.documentElement.clientWidth?s.documentElement.clientWidth:screen.width,c=a.innerHeight?a.innerHeight:s.documentElement.clientHeight?s.documentElement.clientHeight:screen.height
	return"scrollbars=1,status=0,menubar=0,toolbar=0,resizable=1,width="+e+",height="+t+",left="+(o/2-e/2+n)+",top="+(c/2-t/2+r)}(),l.open=function(e){if(!e)throw new Error('"callback" parameter is required')
	if(null===d||d.closed||!d.focus)try{d=function(){var e=a.open(l.url,l.name,l.props)
	if(!(e||(console.warn("External sign in popup was blocked. Trying to open a new tab"),e=a.open(l.url,l.name))))throw new Error("Creating external sign in page has failed")
	return e}()}catch(t){return void console.error(t)}else d.focus()
	m(o.externalSignIn.openSignInWindow),u&&a.clearInterval(u),u=a.setInterval((function(){d.closed&&(e(),a.clearInterval(u),u=null)}),100)}}function f(){var e=this,t=i.splashScreen.signInNotificationEnabled,a=new c(n.notifications.SIGN_IN_REQUEST),s=new p,l=!1
	e.isEnabled=function(){return t&&i.initParams&&!!i.initParams.resigninAllowed},e.isSignInPopupEnabled=function(){return l},e.setSignInPopup=function(e){l=e},e.notify=function(t){function i(e){r.isFunction(t)&&t(),m(e),u.notify(a)}if(e.isEnabled())if(l)try{s.open((function(){i(o.externalSignIn.signInRequestAfterTokenRefresh),d.set(n.storageKeys.AAD_TOKEN_EXPIRED,!0)}))}catch(c){console.error(c)}else i(o.externalSignIn.signInRequest)}}function m(e){l.resolve(n.serviceLocator.ACTION_TELEMETRY).recordAction(e)}t.build=function(){return new f}})),define("ui/viewModels/experience/splashScreen",["require","vendor/knockout","swx-cafe-application-instance","utils/common/accessibility","swx-service-locator-instance","swx-constants","swx-enums","ui/telemetry/actions/actionNames","text!views/experience/splashScreen.html","experience/api/authentication","experience/authContext","experience/settings","swx-browser-detect","browser/window","browser/document","lodash-compat","swx-i18n","telemetry/chat/splashScreenEvent","utils/common/feedback","utils/common/signInNotificationHandler","utils/common/styleModeHelper","ui/telemetry/telemetryClient"],(function(e){var t=e("vendor/knockout"),n=e("swx-cafe-application-instance"),i=e("utils/common/accessibility"),r=e("swx-service-locator-instance").default,o=e("swx-constants").COMMON,a=e("swx-enums"),s=e("ui/telemetry/actions/actionNames"),c=e("text!views/experience/splashScreen.html"),l=e("experience/api/authentication"),u=e("experience/authContext"),d=e("experience/settings"),p=e("swx-browser-detect").default,f=e("browser/window"),m=e("browser/document"),h=e("lodash-compat"),v=e("swx-i18n").localization,g=e("telemetry/chat/splashScreenEvent"),y=e("utils/common/feedback"),b=e("utils/common/signInNotificationHandler"),_=e("utils/common/styleModeHelper"),E=e("ui/telemetry/telemetryClient"),w=o.telemetry.splashScreenSignInEvent,S=o.telemetry.eduCarouselEvents
	return function(){var e,x=this,C=r.resolve(o.serviceLocator.FEATURE_FLAGS),T=r.resolve(o.serviceLocator.PUBSUB),I=!1,A=C.isFeatureOn(o.featureFlags.SINGLE_CONVERSATION_MODE),M=g.build(),O=b.build(),k=C.isFeatureOn(o.featureFlags.SPLASH_SCREEN_WHITE_THEME),N=C.isFeatureOn(o.featureFlags.SHOW_EDU_CAROUSEL)
	function P(e){return H(x.useBusinessWording?e+"_4b":e)}function R(e){var t=e||"n/a"
	x.showLoader(!1),x.showSignIn(!1),x.showEducationCarousel(!1),M.publish(),N&&T.publish(S.action.HIDE,t)}function L(e){var t=h.assign({text:v.fetch({key:"splashScreen_text_loading"})},e)
	if(N)return x.showLoader(!1),x.showSignIn(!1),void x.showEducationCarousel(!0)
	x.showSignIn(!1),x.showLoader(!0),i.updateAriaLiveHtml(x.loadingText,t.text)}function D(e,t){var n=u.get().implicitSignIn||u.get().implicitSignOut,r=h.assign({title:n?"":H("splashScreen_signedOut_title"),description:"",showButton:!1,isSignInExternalEnabled:!1,isSignInPopupEnabled:!1,showLearnMore:!1,isFeedbackEnabled:!1},e)
	x.showEducationCarousel()&&T.publish(S.action.HIDE),x.showLoader(!1),x.showEducationCarousel(!1),x.showSignIn(!0),x.signInTitle(""),x.signInDescription(""),r.title&&i.updateAriaLiveHtml(x.signInTitle,r.title),r.description&&i.updateAriaLiveHtml(x.signInDescription,r.description),x.isSignInEnabled(r.showButton),x.isSignInExternalEnabled(r.isSignInExternalEnabled),x.isLearnMoreLinkVisible(r.showLearnMore),x.isFeedbackEnabled(r.isFeedbackEnabled),O.setSignInPopup(r.isSignInPopupEnabled),x.isSignInNotificationEnabled(O.isEnabled()),E.get().sendEvent(d.telemetry.uiTenantToken,w.TYPE,{isSignInEnabled:x.isSignInEnabled(),isSignInExternalEnabled:x.isSignInExternalEnabled(),isLearnMoreLinkVisible:x.isLearnMoreLinkVisible(),isFeedbackEnabled:x.isFeedbackEnabled(),isSignInPopupEnabled:r.isSignInPopupEnabled,isSignInNotificationEnabled:x.isSignInNotificationEnabled(),hasTitle:e&&!!e.title,hasDescription:!!r.description,state:t||o.telemetry.NOT_AVAILABLE,isSideBarOpened:_.get().appIsVisible()})}function U(){D(null,w.STATE.APP_READY),M.startSplashScreenMeasure(x.showSignIn(),x.isLearnMoreLinkVisible())
	var e=n.get().signInManager.state
	e.when(a.loginState.SigningIn,(function(){L({text:H("splashScreen_text_signingIn")})})),e.when(a.loginState.SigningOut,V),e.when(a.loginState.SignedOut,G)}function F(e){var t,n={title:H("splashScreen_signInFailed_title"),description:H("splashScreen_signInFailed_description"),isFeedbackEnabled:C.isFeatureOn(o.featureFlags.HAS_FEEDBACK_LINK_ON_ERROR)};(function(e){try{return e.message===o.api.auth.errorTypes.SIGN_IN_CANCELED_ERROR&&JSON.parse(e.details.reason).code===o.api.auth.errorTypes.SIGNED_OUT_ERROR}catch(t){}})(e)||(function(e){var t=new RegExp(o.api.auth.errorTypes.AGE_RESTRICTION_ERROR+"$"),n="error_description"
	if(e&&e[n])return t.test(e[n])}(e)&&(n.title=v.fetch({key:"splashScreen_signInFailed_description_age_restriction"}),n.description="",n.isFeedbackEnabled=!1),I&&(n.description=v.fetch({key:"skypeUnavailable_title"}),n.isFeedbackEnabled=!1),function(e){return e&&e.name===o.api.auth.errorTypes.TOO_MANY_CONNECTIONS_ERROR}(e)&&(n.description=v.fetch({key:"splashScreen_signInFailed_description_exceeded_endpoints"}),n.isFeedbackEnabled=!1),function(e){return e&&e.message===o.silentLogin.errorMessages.INVALID_GRANT}(e)&&(n.title=v.fetch({key:"splashScreen_signInFailed_title_security_validation"}),n.description="",n.isSignInExternalEnabled=!0,n.isFeedbackEnabled=!1),function(e){var t
	if(e&&e.message===o.api.auth.errorTypes.LOGIN_REQUIRED_ERROR)return!0
	try{return(t=JSON.parse(e.details.reason)).code===o.api.auth.errorTypes.OAUTH_FAILED_ERROR&&t.error===o.api.auth.errorTypes.LOGIN_REQUIRED_ERROR}catch(n){}}(e)&&(n.description=v.fetch({key:"splashScreen_signInFailed_aad_description"}),n.isFeedbackEnabled=!1,n.isSignInPopupEnabled=!0),function(e){return e&&e.message===o.api.auth.errorTypes.TIMEOUT}(e)&&!I&&(n.showButton=C.isFeatureOn(o.featureFlags.SHOW_SIGN_IN_BUTTON_ON_TIMEOUT)),n.showLearnMore=!!(d.splashScreen.learnMoreUrl&&(t=p.getBrowserInfo(),t.isIeEngine||t.isEdge)),D(n,w.STATE.SIGN_IN_FAILED))}function B(e,t){I=!1,D(e,t),T.publish(o.apiUIEvents.SWX_ON_SIGN_OUT)}function V(){n.get().signInManager.getSignOutContext&&n.get().signInManager.getSignOutContext()&&n.get().signInManager.getSignOutContext().reason===o.api.auth.errorTypes.REAUTH_NEEDED?B({isSignInExternalEnabled:!0,title:v.fetch({key:"splashScreen_signedOut_reauth_needed_title"}),description:v.fetch({key:"splashScreen_signedOut_reauth_needed_description"})},w.STATE.REAUTH_NEEDED):C.isFeatureOn(o.featureFlags.SHOW_SIGN_IN_BUTTON_ON_SIGNOUT)?B({isSignInExternalEnabled:!0},w.STATE.SIGNING_OUT):B({showButton:!1},w.STATE.SIGNING_OUT)}function G(e,t){t&&t===a.loginState.SignedIn&&B({title:v.fetch({key:"splashScreen_disconnected_title"}),description:H("splashScreen_disconnected_description")},w.STATE.SIGNED_OUT)}function H(e){return v.fetch({key:A?e+"_wac":e})}this.showLoader=t.observable(!1),this.showSignIn=t.observable(!1),this.showEducationCarousel=t.observable(!1),this.teamsDeprecation=t.observable(!1),this.isVisible=t.computed((function(){return x.showLoader()||x.showSignIn()||x.showEducationCarousel()||x.teamsDeprecation()})),this.isSignInEnabled=t.observable(!1),this.isSignInExternalEnabled=t.observable(!1),this.isSignInNotificationEnabled=t.observable(!1),this.isLearnMoreLinkVisible=t.observable(!1),this.isFeedbackEnabled=t.observable(!1),this.useBusinessWording=C.isFeatureOn(o.featureFlags.USE_BUSINESS_WORDING),this.showLogo=!A,this.narratorText=t.observable("").extend({rateLimit:200}),this.loadingText=t.observable(""),this.signInTitle=t.observable(""),this.signInDescription=t.observable(""),this.signInLearnMoreText=v.fetch({key:"splashScreen_learn_more"}),this.learnMoreUrl=d.splashScreen.learnMoreUrl,this.theme=t.computed((function(){return k||x.teamsDeprecation()?o.classes.WHITE_THEME:o.classes.BLUE_THEME})),this.spinnerColor=t.computed((function(){return k?"":o.classes.WHITE_COLOR})),this.signIn=function(e){l.signIn(R.bind(null,"signIn"),F,e),I=!0},this.signInExternal=function(){var e,t,n,i,a,c,l,u=(n=d.webLoginClientId,i=d.uiVersion,a=d.appBaseUrl+"/assets/externalSignInHandler.html?origin="+m.location.origin,c="999",d.webLoginUrl+"?client_id="+f.encodeURIComponent(n)+"&clientVersion="+f.encodeURIComponent(i)+"&redirect_uri="+f.encodeURIComponent(a)+"&partner="+f.encodeURIComponent(c))
	l=s.externalSignIn.signIn,r.resolve(o.serviceLocator.ACTION_TELEMETRY).recordAction(l),e=f.open(u),t=f.setInterval((function(){e.closed&&(x.signIn({isExternalSignIn:!0}),f.clearInterval(t))}),100)},this.notifySignIn=function(){O.isSignInPopupEnabled()&&D({title:v.fetch({key:"splashScreen_signInExternal_title"}),description:v.fetch({key:"splashScreen_signInExternal_description"}),isSignInPopupEnabled:!0}),O.notify(L.bind(null,{text:v.fetch({key:"splashScreen_text_signingIn"})}))},this.getSignInButtonText=H.bind(null,"splashScreen_signIn_button"),this.feedbackPageUrl=t.pureComputed((function(){return y.getFeedbackPageUrl()})),this.feedbackPageTarget=function(){return y.getFeedbackPageTarget()},this.init=function(i){if(i){(e=i).classList.add("swx-container")
	var r,s,l,u,d=document.getElementById("splashScreenElement")
	d&&t.removeNode(d),(r=document.createElement("div")).id="splashScreenElement",r.innerHTML=c,t.applyBindings(x,r),e&&e.appendChild(r),x.showLoader()||x.showSignIn()||x.showEducationCarousel()||L(),x.showLoader()&&(x.loadingText().indexOf(H("splashScreen_text_signingIn"))>-1?x.narratorText(P("splashScreen_text_signing_into_skype")):x.narratorText(P("splashScreen_text_loading_skype"))),I=!1,T.publish(o.apiUIEvents.SWX_SPLASHSCREEN_LOADED),s=n.get(),l=!!s.personsAndGroupsManager.mePerson._clientUpdatePolicy,u=s.signInManager.state,l&&u.when(a.loginState.SignedIn,(function(){function e(e){return e===o.teamsMigration.REDIRECT_CLIENT||e===o.teamsMigration.UPDATE_CLIENT}s.personsAndGroupsManager.mePerson._clientUpdatePolicy.changed((function(t){x.teamsDeprecation(e(t))}))}))}},T.subscribe(o.events.system.EXPERIENCE_READY,U),T.subscribe(o.events.auth.SIGNIN_FAILED,F),A?T.subscribe(o.apiUIEvents.SWX_SINGLE_CONVERSATION,(function(e){if(!e)return x.showLoader(!1),x.showSignIn(!1),void x.showEducationCarousel(!1)
	D({title:H("splashScreen_signInFailed_title"),description:H("splashScreen_signInFailed_description")},w.STATE.SIGN_IN_FAILED)})):T.subscribe(o.apiUIEvents.SWX_TIMELINE_LOADED,R.bind(null,"timelineLoaded"))}})),define("services/subscriptions/subscriptionProvider",["require","lodash-compat","vendor/knockout","swx-enums","swx-cafe-application-instance"],(function(e){var t=e("lodash-compat"),n=e("vendor/knockout"),i=e("swx-enums"),r=e("swx-cafe-application-instance")
	return function(){var e,o={persons:{observable:n.observableArray([]),initialize:t.once((function(){var e=o.persons.observable,t=r.get().personsAndGroupsManager.all
	t&&c(e,t)}))},favorites:{observable:n.observableArray([]),initialize:t.once((function(){var e=o.favorites.observable,n=(a=i.groupType.Favorites,s="type",l=r.get().personsAndGroupsManager.all.groups(),u=t.find(l,(function(e){return e[s]()===a})),u)
	var a,s,l,u
	n&&c(e,n)}))}},a=[]
	function s(){return e||(e=r.get().personsAndGroupsManager.all.persons.get())}function c(e,t){function n(){var i=t.persons().filter((function(e){return!!e.displayName()||(l(n,e),!1)}))
	e(i)}e.extend({rateLimit:{timeout:50,method:"notifyWhenChangesStop"}}),s(),t.persons().forEach(l.bind(null,n)),t.persons.subscribe(),t.persons.changed(n)}function l(e,n){n.displayName()||t.contains(a,n)||(a.push(n),n.displayName.get().then((function(){t.contains(a,n)&&(t.remove(a,n),e())}),(function(){t.contains(a,n)&&t.remove(a,n)})))}this.getPersonsObservable=function(){return o.persons.initialize(),o.persons.observable},this.getFavoritesObservable=function(){return o.favorites.initialize(),o.favorites.observable},this.getContacts=s}})),define("services/pes/bingSearch/urlPreviewService",["require","lodash-compat","swx-utils-common","reqwest","swx-cafe-application-instance","experience/settings","utils/common/url","swx-constants","utils/common/cancelation","swx-service-locator-instance"],(function(e){var t=e("lodash-compat"),n=e("swx-utils-common").builderMixin,i=e("reqwest"),r=e("swx-cafe-application-instance"),o=e("experience/settings"),a=e("utils/common/url"),s=e("swx-constants").COMMON,c=e("utils/common/cancelation"),l=e("swx-service-locator-instance").default
	function u(e,t,n){this.defaultServiceHost=e,this.defaultServceEndpoint=t,this.defaultTokenProvider=n}function d(e,t,n){var r
	if(!e||!n)return Promise.resolve()
	r={url:a.buildUrl(t.serviceHost+t.serviceEndpoint,{url:e}),method:"GET",crossOrigin:!0,dataType:"json",headers:{Authorization:"skype_token "+n}}
	var o=c.adaptAbortable(i.compat(r))
	return c.makeCancelable(o,t.cancelationToken)}return u.prototype.getPreviewFor=function(e,n){var i=l.resolve(s.serviceLocator.FEATURE_FLAGS).isFeatureOn(s.featureFlags.NEW_URLP_DOMAIN_ENABLED)?o.urlPServiceHost:o.amdServiceHost
	return(n=t.defaults({},n,{serviceHost:this.defaultServiceHost,tokenProvider:this.defaultTokenProvider,serviceEndpoint:this.defaultServceEndpoint},{tokenProvider:function(){return r.get().signInManager._skypeToken&&r.get().signInManager._skypeToken()},serviceHost:i,serviceEndpoint:"/v1/url/info"})).skypeToken?d(e,n,n.skypeToken):Promise.resolve(n.tokenProvider()).then(d.bind(null,e,n))},t.extend(u,n),u})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-client-info/lib/index",["require","exports","jskype-settings-instance","swx-browser-detect","swx-constants","swx-service-locator-instance"],e)}((function(e,t){var n=e("jskype-settings-instance"),i=e("swx-browser-detect"),r=e("swx-constants"),o=e("swx-service-locator-instance")
	t.getBIAppName=function(){return n.settings.biAppName},t.getBIVersion=function(){return n.settings.uiVersion},t.getCountryCode=function(){return n.settings.countryCode},t.getClientInfo=function(){var e=i.default.getSystemInfo(),t=n.settings.lcid||"en-us",a=n.settings.countryCode||"n/a",s="os="+e.osName+"; osVer="+e.osVersion+"; proc="+e.platform+"; lcid="+t+"; deviceType="+e.deviceType+"; country="+a+"; clientName="+n.settings.biAppName+"; clientVer="+n.settings.uiVersion
	return o.default.resolve(r.COMMON.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.COMMON.featureFlags.TIMEZONE_IN_CHATSERVICE_REQUEST)&&n.settings.utcOffset&&(s+="; utcOffset="+n.settings.utcOffset),s}})),define("swx-client-info",["swx-client-info/lib/index"],(function(e){return e})),define("services/store/pes/storeService",["require","lodash-compat","services/store/pes/catalogItemProcessor","experience/settings","swx-cafe-application-instance","swx-utils-common","services/pes/configSync","reqwest","swx-utils-common","swx-client-info"],(function(e){var t=e("lodash-compat"),n=e("services/store/pes/catalogItemProcessor"),i=e("experience/settings"),r=i.pesStoreServices,o=i.entitlementService,a=e("swx-cafe-application-instance"),s=e("swx-utils-common").builderMixin,c=e("services/pes/configSync"),l=e("reqwest"),u=e("swx-utils-common").guid,d=e("swx-client-info")
	function p(e){var n={dataType:"json",crossOrigin:!0}
	return e&&t.extend(n,e),n}function f(){return a.get().signInManager._skypeToken()}function m(){}var h=u.create(),v="ui.hidden-expression-tabs"
	return m.prototype.loadCatalog=function(){var e=p({url:"https://"+r.catalogApiHost+r.catalogServiceEndpoint.replace("${lang}",i.locale.pes),headers:{Accept:"application/json; ver="+r.catalogServiceVersion}})
	return r.catalogDogfoodContentEnabled&&(e.headers["X-Skype-Config-Namespace"]="showNonDiscoverable"),Promise.resolve(l.compat(e)).then((function(e){var t=e.skus
	return n.processSKUs(t),t})).catch((function(){return[]}))},m.prototype.getItems=function(e){var t
	return e?(t=p({url:e}),Promise.resolve(l.compat(t)).then((function(e){return n.processTabConfig(e),n.loadStyles(e,c.latestToken,c._requiresCDNUrlAuthentication),e})).catch((function(){return null}))):Promise.reject("No valid config url Specified")},m.prototype.getItemsForTabs=function(e){var t=this
	return Promise.resolve(t.loadCatalog()).then((function(n){return e.forEach((function(e){var i,r
	for(i=0;i<n.length;i++)if((r=n[i]).id===e.id){e.pesConfig=t.getItems(r.items)
	break}})),e}))},m.prototype.getHiddenTabs=function(){var e
	return e=p({url:i.userOptionsService.host+i.userOptionsService.optionsEndpoint.replace("${userId}","self").replace("${optionName}",v)}),Promise.resolve(f()).catch((function(){return null})).then((function(t){return t?(e.headers={"X-Skypetoken":t,Accept:"application/json, text/javascript","X-Skype-Caller":d.getBIAppName(),"X-Microsoft-Skype-Chain-ID":h,"X-Microsoft-Skype-Message-ID":u.create()},l.compat(e)):Promise.reject("Invalid Skype token")})).catch((function(){})).then((function(e){var t=[]
	return e&&e.optionStr&&(t=JSON.parse(e.optionStr)),t}))},m.prototype.postHiddenTabs=function(e){var t
	return t=p({url:i.userOptionsService.host+i.userOptionsService.optionsEndpoint.replace("${userId}","self").replace("${optionName}",v),type:"put",data:_stringify({value:e})}),Promise.resolve(f()).catch((function(){return null})).then((function(e){return e?(t.headers={"X-Skypetoken":e,"X-Skype-Caller":d.getBIAppName(),Accept:"application/json, text/javascript","X-Microsoft-Skype-Chain-ID":h,"X-Microsoft-Skype-Message-ID":u.create(),"Content-Type":"application/json; charset=utf-8"},l.compat(t)):Promise.reject("Invalid Skype token")})).catch((function(){})).then((function(){return"success"}))},m.prototype.getTabsFromEntitlement=function(){var e,t=a.get().personsAndGroupsManager.mePerson
	return e=p({url:o.host+o.listingEndpoint.substring(1).replace("${username}",t.id())}),Promise.resolve(f()).catch((function(){return null})).then((function(t){return t?(e.headers={"X-Skypetoken":t,Accept:"application/json; ver=3.0"},l.compat(e)):Promise.reject("Invalid Skype token")})).catch((function(){})).then((function(e){var t=[]
	return e&&(t=e.reduce((function(e,t){var n,i
	return"sticker"===t.service&&t.attributes&&t.attributes.pack&&(n=t.attributes.pack,i=new Date(t.start).getTime(),e.push({id:n,purchaseDateTime:i})),e.sort((function(e,t){return e.purchaseDateTime-t.purchaseDateTime}))}),t)),t}))},m.prototype.downloadPurchasedTabsFromEntitlement=function(){var e=this
	return Promise.resolve(e.getTabsFromEntitlement()).then((function(t){return e.getItemsForTabs(t)})).then((function(e){var t=[]
	return e.forEach((function(e){e.pesConfig&&t.push(e)})),t}))},m.prototype.buyTab=function(e){var t,n
	return e?(n=e.__metadata.links.apiPurchase,t=p({url:n.hrefFull,type:"post",data:n.data}),Promise.resolve(f()).catch((function(){return null})).then((function(e){return e?(t.headers={"X-Skypetoken":e,Accept:"application/json; ver="+r.catalogPurchaseApiVersion},l.compat(t)):Promise.reject("Invalid Skype token")})).catch((function(){return null})).then((function(e){return e?"success":Promise.reject("error purchasing tab")}))):Promise.reject("Not a valid tab")},t.extend(m,s),m})),define("ui/telemetry/identityTelemetry",["require","exports","module","browser/window","swx-enums","swx-cafe-application-instance"],(function(e,t){var n,i=e("browser/window"),r=e("swx-enums"),o=e("swx-cafe-application-instance")
	function a(){var e="ANONYMOUS"
	if(o.get().signInManager.state()===r.loginState.SignedIn)try{e=o.get().personsAndGroupsManager.mePerson.id()}catch(t){}return e}function s(){var e=0
	try{e=o.get().signInManager.state()===r.loginState.SignedIn?1:0}catch(t){}return e}t.addIdentityToAllEvents=function(e){n=n||i.skypeTelemetryManager.PIIType,function(e){e.setCommonProperty("user_id",a,n.Identity),e.setCommonProperty("signed_in",s)}(e)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-local-storage/lib/constants",["require","exports"],e)}((function(e,t){(function(e){e.VERSION="1.13",e.PREFIX_KEYWORD="swx",function(e){e.VERSION="version",e.ENCRYPTION_KEY="encryptionKey",e.KEYS_MAP="keysMap"}(e.INTERNAL_KEYS||(e.INTERNAL_KEYS={})),e.DEFAULT_BUFFER_TIMEOUT=300})(t.CACHE||(t.CACHE={})),function(e){e.DEACTIVATE_CACHE="deactivateCache"}(t.featureFlags||(t.featureFlags={}))}));(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-util-encryption/lib/msCryptoAdapter",["require","exports","global-portable","msr-crypto"],e)})((function(e,t){var n=e("global-portable")
	void 0===n.default.window&&(n.default.window={addEventListener:function(){}}),void 0===n.default.XMLHttpRequest&&(n.default.XMLHttpRequest=function(){})
	var i=e("msr-crypto")
	function r(e){return new Promise((function(t,n){e.oncomplete=function(e){t(e.target.result)},e.onerror=n}))}i.aes.subtle.forceSync=!0,t.getRandomValues=i.aes.getRandomValues,function(e){e.generateKey=function(e,t,n){return r(i.aes.subtle.generateKey(e,t,n))},e.exportKey=function(e,t){return r(i.aes.subtle.exportKey(e,t))},e.importKey=function(e,t,n,o,a){return r(i.aes.subtle.importKey(e,t,n,o,a))},e.encrypt=function(e,t,n){return r(i.aes.subtle.encrypt(e,t,n))},e.decrypt=function(e,t,n){return r(i.aes.subtle.decrypt(e,t,n))}}(t.subtle||(t.subtle={}))})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-util-encryption/lib/encryption",["require","exports","./msCryptoAdapter","swx-browser-globals"],e)}((function(e,t){var n,i=e("./msCryptoAdapter"),r=e("swx-browser-globals").getWindow(),o="Aes-cbc",a=["encrypt","decrypt"]
	function s(e){var t=6e4,n=[],i=[]
	if(e.length<=t)return Array.apply(null,e)
	for(var r=0,o=e.length;r<o;r+=t)n.push(e.subarray(r,r+t))
	return n.forEach((function(e){i=i.concat(Array.apply(null,e))})),i}function c(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n)
	return t}function l(e){var t=6e4,n=[],i=new Uint8Array(e),r=""
	if(i.length<=t)return String.fromCharCode.apply(null,i)
	for(var o=0,a=i.length;o<a;o+=t)n.push(i.subarray(o,o+t))
	return n.forEach((function(e){r=r.concat(String.fromCharCode.apply(null,e))})),r}n=r&&r.crypto?r.crypto.webkitSubtle?{crypto:{getRandomValues:r.crypto.getRandomValues.bind(r.crypto),subtle:r.crypto.webkitSubtle},importedKeyProcessor:c,exportedKeyProcessor:l}:{crypto:r.crypto,importedKeyProcessor:JSON.parse,exportedKeyProcessor:_stringify}:{crypto:i,importedKeyProcessor:c,exportedKeyProcessor:l},t.generateEncryptionKey=function(){return n.crypto.subtle.generateKey({name:o,length:256},!0,a)},t.exportEncryptionKey=function(e){return n.crypto.subtle.exportKey("jwk",e).then(n.exportedKeyProcessor)},t.importEncryptionKey=function(e){return n.crypto.subtle.importKey("jwk",n.importedKeyProcessor(e),{name:o},!0,a)},t.encrypt=function(e,t){var i={name:o}
	try{var r=c(encodeURI(_stringify(t)))
	return i.iv=n.crypto.getRandomValues(new Uint8Array(16)),n.crypto.subtle.encrypt(i,e,r).then((function(e){return t=i.iv,{data:l(e),iv:s(t)}
	var t})).catch((function(){}))}catch(a){return Promise.reject(a)}},t.decrypt=function(e,t){if(!t||!t.data||!t.iv)return Promise.reject("Invalid encrypted data")
	try{var i={name:o,iv:new Uint8Array(t.iv)}
	return n.crypto.subtle.decrypt(i,e,c(t.data)).then((function(e){var t=l(e)
	return t?JSON.parse(decodeURI(t)):{}})).catch((function(){}))}catch(r){return Promise.reject(r)}}})),define("swx-util-encryption",["swx-util-encryption/lib/encryption"],(function(e){return e})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-local-storage/lib/keyHasher",["require","exports","./constants","lodash-compat"],e)}((function(e,t){var n=e("./constants"),i=e("lodash-compat")
	function r(e,t){return t.key===e}function o(e,t){return t.hash===e}var a=function(){function e(e,t){this.keysMap={cursor:0,map:[]},this.options={},i.merge(this.options,t),this.onHashMapChanged=e}return e.prototype.fillMap=function(e){e&&(this.keysMap=e)},e.prototype.getHashByKey=function(e){if(e===n.CACHE.INTERNAL_KEYS.KEYS_MAP)return e
	var t=i.find(this.keysMap.map,r.bind(null,e))
	if(t&&t.hash)return t.hash
	var o="key-"+this.keysMap.cursor
	return this.options.debug&&(o+="-"+e),this.keysMap.cursor++,this.keysMap.map.push({key:e,hash:o}),this.onHashMapChanged(n.CACHE.INTERNAL_KEYS.KEYS_MAP,this.keysMap),o},e.prototype.getKeyByHash=function(e){var t=i.find(this.keysMap.map,o.bind(null,e))
	return t&&t.key?t.key:e},e.prototype.removeKeyFromMap=function(e){i.remove(this.keysMap.map,r.bind(null,e)).length&&this.onHashMapChanged(n.CACHE.INTERNAL_KEYS.KEYS_MAP,this.keysMap)},e}()
	t.build=function(e,t){return new a(e,t)}})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-local-storage/lib/base-driver",["require","exports","./constants"],e)}((function(e,t){var n=e("./constants")
	t.STORAGE_PREFIX_REGEX=new RegExp("^"+n.CACHE.PREFIX_KEYWORD+"\\|")
	var i=n.CACHE.PREFIX_KEYWORD+"|",r=function(){function e(){}return e.prototype.genKey=function(e){return i+e},e}()
	t.BaseDriver=r}))
	var __extends=this&&this.__extends||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])
	function i(){this.constructor=e}e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)};(function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-local-storage/lib/local-storage-driver",["require","exports","swx-browser-globals","./constants","./base-driver"],e)})((function(e,t){var n=e("swx-browser-globals"),i=e("./constants"),r=e("./base-driver"),o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getItemFromStorage=function(e){var t=this
	return new Promise((function(i){return i(n.getWindow().localStorage.getItem(t.genKey(e)))}))},t.prototype.getAllKeys=function(){return this.getAllKeysRaw().then((function(e){return e.map((function(e){return e.replace(r.STORAGE_PREFIX_REGEX,"")}))}))},t.prototype.removeItemFromStorage=function(e){var t=this
	return new Promise((function(i){var r=t.genKey(e)
	n.getWindow().localStorage[r]&&n.getWindow().localStorage.removeItem(r),i()}))},t.prototype.invalidateCache=function(e){var t=this
	return void 0===e&&(e=!1),this.getAllKeysRaw().then((function(r){for(var o=r.length,a=0;a<o;a++){var s=r[a];(e||s!==t.genKey(i.CACHE.INTERNAL_KEYS.VERSION))&&n.getWindow().localStorage.removeItem(s)}}))},t.prototype.setItemInStorage=function(e,t){var i=this
	return new Promise((function(r){var o=i.genKey(e)
	n.getWindow().localStorage.setItem(o,t),r()}))},t.prototype.getAllKeysRaw=function(){return new Promise((function(e){return e(Object.keys(n.getWindow().localStorage).filter((function(e){return r.STORAGE_PREFIX_REGEX.test(e)})))}))},t}(r.BaseDriver)
	t.LocalStorageDriver=o})),function(e){if("object"==typeof module&&"object"==typeof module.exports){var t=e(require,exports)
	void 0!==t&&(module.exports=t)}else"function"==typeof define&&define.amd&&define("swx-local-storage/lib/provider",["require","exports","./constants","swx-util-encryption","./keyHasher","./local-storage-driver","swx-browser-globals","lodash-compat","swx-utils-common"],e)}((function(e,t){var n=e("./constants"),i=e("swx-util-encryption"),r=e("./keyHasher"),o=e("./local-storage-driver"),a=e("swx-browser-globals"),s=e("lodash-compat"),c=e("swx-utils-common"),l="[CacheProvider]",u=n.CACHE,d=function(){function e(e){var t=this
	this.options=e,this.chainingPromise=c.settablePromise.build(),this.debugSettings={log:!1,showKeys:!1,plainData:!1},this.setSensitiveItemBuffer={},this.internalCache={},this.VERSION=u.VERSION,this.resolveChainingPromise=function(){t.chainingPromise.resolve()},this._onVersionReceived=function(e){var n=t.printDebug.bind(t,"[_onVersionReceived]")
	return s.forEach(t.debugSettings,(function(e,n){"log"!==n&&e&&(t.VERSION+="|"+n)})),e!==t.VERSION?(n(e?"Version changed from "+e+" to "+t.VERSION:"Version not found"),t.storageDriver.invalidateCache(!0).then((function(){return t.storageDriver.setItemInStorage(u.INTERNAL_KEYS.VERSION,t.VERSION)}))):Promise.resolve()},this._initializeEncryption=function(e){var n=t.printDebug.bind(t,"[_initializeEncryption]")
	if(t.isDeactivated())return n("Cache is deactivated -> initialization completed"),Promise.resolve()
	var r=function(e){return i.importEncryptionKey(e.response).then((function(e){t.encryptionKey=e,n("Key decrypted -> initialization completed")}),l)},o=function(){return n("Starting with fresh cache"),t.storageDriver.invalidateCache(!1).then(a)},a=function(){return i.generateEncryptionKey().then(s,l)},s=function(n){return t.encryptionKey=n,i.exportEncryptionKey(n).then((function(t){return e.encrypt(t).then(c)}))},c=function(e){return n("New key generated -> initialization completed"),t.storageDriver.setItemInStorage(u.INTERNAL_KEYS.ENCRYPTION_KEY,e.response)},l=function(){throw n("Encryption key manipulation failed"),new Error("Encryption key manipulation failed")}
	return t.storageDriver.getItemFromStorage(u.INTERNAL_KEYS.ENCRYPTION_KEY).then((function(t){return t?(n("Getting key from KES",t),e.decrypt(t).then(r,o)):o()}))},this._prepareKeysMap=function(){return t.getSensitiveItem(u.INTERNAL_KEYS.KEYS_MAP).then((function(e){t.keyHasher.fillMap(e)}))},this.setItem=function(e,n){var i=t.printDebug.bind(t,"[SetItem: "+e+"]")
	return t.chainingPromise.then((function(){if(t.internalCache[e]=n,t.isDeactivated())return i("Cache deactivated, resolving"),Promise.resolve()
	var r=t.keyHasher.getHashByKey(e)
	return t.storageDriver.setItemInStorage(r,_stringify(n)).then((function(){return i("stored")}),(function(e){return i("storage failed",e)}))}))},this._deactivateCache=function(e){t.printDebug("[_deactivateCache]",e),t.isCacheDeactivated=!0},this._encrypt=function(e){return t.debugSettings.plainData?Promise.resolve(_stringify(e)):i.encrypt(t.encryptionKey,e).then((function(e){return _stringify(e)}))},this._decrypt=function(e){return t.debugSettings.plainData?Promise.resolve(JSON.parse(e)):i.decrypt(t.encryptionKey,JSON.parse(e))},this._getAllSwxKeys=function(e,n){return t.storageDriver.getAllKeys().then((function(i){var r=s(i).map((function(e){return t.keyHasher.getKeyByHash(e)}))
	return n||(r=r.without(u.INTERNAL_KEYS.VERSION)),e&&(r=r.filter((function(t){return e.test(t)}))),r.value()}))},this.isCacheDeactivated=e.serviceLocator.featureFlagApi.isFeatureOn(n.featureFlags.DEACTIVATE_CACHE),s.merge(this.debugSettings,e.debugSettings)}return e.prototype.init=function(e){var t=this
	return this.initializePromise?this.initializePromise:this.isCacheDeactivated?(this.initializePromise=this.chainingPromise,this.resolveChainingPromise(),this.initializePromise):(this.storageDriver=new o.LocalStorageDriver,this.keyHasher=r.build((function(e,n){return t.setSensitiveItem(e,n)}),this.debugSettings.showKeys),this.initializePromise=this.storageDriver.getItemFromStorage(u.INTERNAL_KEYS.VERSION).then(this._onVersionReceived).then((function(){return t._initializeEncryption(e)})).then(this._prepareKeysMap).catch(this._deactivateCache).then(this.resolveChainingPromise,this.resolveChainingPromise),this.initializePromise)},e.prototype.isDeactivated=function(){return this.isCacheDeactivated},e.prototype.destroy=function(e){void 0===e&&(e=!1)
	var t=Promise.resolve()
	return!this.isDeactivated()&&e&&this.initializePromise&&(t=this.storageDriver.invalidateCache(!1)),this.initializePromise=null,this.setSensitiveItemBuffer={},this.internalCache={},t},e.prototype.getAllKeys=function(e){var t=this
	return this.isDeactivated()?Promise.resolve([]):this.chainingPromise.then((function(){return t._getAllSwxKeys(e)}))},e.prototype.setSensitiveItem=function(e,t,i){var r=this,o=this.setSensitiveItemBuffer[e]||{},s=this.printDebug.bind(this,"[SetSensitiveItem: "+e+"]")
	isNaN(i)&&(i=n.CACHE.DEFAULT_BUFFER_TIMEOUT)
	var c=function(){s("encrypting",r.internalCache[e]),r._encrypt(r.internalCache[e]).then((function(t){var n=r.keyHasher.getHashByKey(e)
	r.storageDriver.setItemInStorage(n,t).then((function(){s("encrypted"),o.resolvePromise(),delete r.setSensitiveItemBuffer[e]}),o.rejectPromise)}),(function(e){s("Encryption failed"),o.rejectPromise(e)}))}
	return this.internalCache[e]=t,this.isDeactivated()?this.chainingPromise.then((function(){s("Cache deactivated, resolving")})):(o.promise?(s("Resetting writing operation timeout"),a.getWindow().clearTimeout(o.timeout),o.timeout=a.getWindow().setTimeout((function(){return r.chainingPromise.then(c)}),i)):(s("Starting new writing operation with delay of "+i+"ms"),o.promise=new Promise((function(e,t){o.resolvePromise=e,o.rejectPromise=t,i?o.timeout=a.getWindow().setTimeout((function(){return r.chainingPromise.then(c)}),i):(o.timeout=0,r.chainingPromise.then(c))})),r.setSensitiveItemBuffer[e]=o),o.promise)},e.prototype.getSensitiveItem=function(e){var t=this,n=this.printDebug.bind(this,"[GetSensitiveItem: "+e+"]")
	return(e===u.INTERNAL_KEYS.KEYS_MAP?Promise.resolve():this.chainingPromise).then((function(){if(n("Getting"),t.isDeactivated())return n("Cache deactivated, returning internal value",t.internalCache[e]),t.internalCache[e]||null
	if(void 0!==t.internalCache[e])return n("Retrieved value already before, returning it",t.internalCache[e]),t.internalCache[e]
	var i=t.keyHasher.getHashByKey(e)
	return t.storageDriver.getItemFromStorage(i).then((function(i){return i?t._decrypt(i).then((function(i){return t.internalCache[e]=i,n("Decrypted",i),i}),(function(e){throw n("Decryption failed",e),e})):(n("No data found in storage"),null)}))}))},e.prototype.getSensitiveItems=function(e){var t=this
	return this.getAllKeys(e).then((function(e){return Promise.all(e.map((function(e){return t.getSensitiveItem(e)})))}))},e.prototype.getItem=function(e){var t=this,n=this.printDebug.bind(this,"[GetItem: "+e+"]")
	return this.chainingPromise.then((function(){if(n("Getting"),t.isDeactivated())return n("Cache deactivated, returning internal value",t.internalCache[e]),t.internalCache[e]||null
	if(void 0!==t.internalCache[e])return n("Retrieved value already before, returning it",t.internalCache[e]),t.internalCache[e]
	var i=t.keyHasher.getHashByKey(e)
	return t.storageDriver.getItemFromStorage(i).then((function(i){return i?(n("Found",i),t.internalCache[e]=JSON.parse(i),t.internalCache[e]):(n("No data found in storage"),null)}))}))},e.prototype.removeItem=function(e){var t=this,n=this.printDebug.bind(this,"[RemoveItem: "+e+"]")
	return this.chainingPromise.then((function(){return delete t.internalCache[e],t.isDeactivated()?(n("Removed"),Promise.resolve()):t.storageDriver.removeItemFromStorage(t.keyHasher.getHashByKey(e)).then((function(){t.keyHasher.removeKeyFromMap(e),void 0!==t.setSensitiveItemBuffer[e]&&(n("Item is removed prior encryption timeout finished. Cancelling encryption."),a.getWindow().clearTimeout(t.setSensitiveItemBuffer[e].timeout),t.setSensitiveItemBuffer[e].rejectPromise(),delete t.setSensitiveItemBuffer[e]),n("Removed")}))}))},e.prototype.printDebug=function(e,t,n){this.debugSettings.log&&(n?console.log(l+e,t,n):console.log(l+e,t))},e}()
	t.build=function(e){return new d(e)}})),define("swx-local-storage",["swx-local-storage/lib/provider"],(function(e){return e})),define("experience/serviceLocatorInitializer",["require","exports","module","swx-service-locator","swx-constants","experience/featureFlags/api","services/controls/controlsBuilder","services/navigation/navigationContext","ui/modelObservers/modelObserver","services/pes/mruService","services/pes/bingSearch/bingSearchService","utils/common/cache/instance","swx-giphy-service","services/pes/config","swx-pubsub-instance","swx-service-locator-instance","ui/viewModels/experience/splashScreen","services/subscriptions/subscriptionProvider","swx-utils-people","services/pes/bingSearch/urlPreviewService","ui/telemetry/actions/actionTelemetryApi","services/store/pes/storeService","ui/telemetry/telemetryClient","ui/telemetry/identityTelemetry","swx-local-storage","browser/window"],(function(e,t){var n=e("swx-service-locator"),i=e("swx-constants").COMMON,r=e("experience/featureFlags/api"),o=e("services/controls/controlsBuilder"),a=e("services/navigation/navigationContext"),s=e("ui/modelObservers/modelObserver"),c=e("services/pes/mruService"),l=e("services/pes/bingSearch/bingSearchService"),u=e("utils/common/cache/instance"),d=e("swx-giphy-service"),p=e("services/pes/config"),f=e("swx-pubsub-instance").default,m=e("swx-service-locator-instance").default,h=e("ui/viewModels/experience/splashScreen"),v=e("services/subscriptions/subscriptionProvider"),g=e("swx-utils-people").progressiveTimeout.default,y=e("services/pes/bingSearch/urlPreviewService"),b=e("ui/telemetry/actions/actionTelemetryApi"),_=e("services/store/pes/storeService"),E=e("ui/telemetry/telemetryClient"),w=e("ui/telemetry/identityTelemetry"),S=e("swx-local-storage"),x=e("browser/window"),C=i.serviceLocator
	function T(e){return n.serviceLocatorBuilder().withServiceInstance(e,{name:C.SETTINGS}).withService({name:C.PUBSUB,build:function(){return f}}).withService({name:C.FEATURE_FLAGS,build:function(){return new r(e)}}).buildSync(m)}function I(e,t){var i,r=E.get(),o=!0
	t&&t.initParams&&!0===t.initParams.disableTelemetry&&(o=!1),r.enabled(o),w.addIdentityToAllEvents(r),i=S.build({serviceLocator:e}),n.serviceLocatorBuilder().withServiceInstance(r,{name:C.TELEMETRY_MANAGER}).withServiceInstance(i,{name:C.LOCAL_STORAGE}).buildSync(m),u.set(i)}function A(e){return n.serviceLocatorBuilder().withService({name:C.CONTROLS_BUILDER,build:function(){return new o}}).withService({name:C.NAVIGATION_CONTEXT,build:function(){return new a}}).withService({name:C.MODEL_UI_OBSERVER,build:function(){return s.build()}}).withService({name:C.SUBSCRIPTION_PROVIDER,build:function(){return new v}}).withService({name:C.ACTION_TELEMETRY,build:function(){return b.build()}}).withService({name:C.PROGRESSIVE_TIMEOUT,build:function(){return new g(x)}}).withService({name:C.PES_BING_SEARCH_SERVICE,build:function(){return l.build()}}).withService({name:C.PES_GIPHY_SEARCH_SERVICE,build:function(){return d.build(e.pesSearchServices.giphy)}}).withService({name:C.URL_PREVIEW_SERVICE,build:function(){return y.build()}}).buildSync(m),n.serviceLocatorBuilder().withService({name:C.PES_MRU_SERVICE,build:function(){return c.build()}}).withService({name:C.PES_CONFIG_SERVICE,build:function(){return p.build()}}).withService({name:C.PES_STORE_SERVICE,build:function(){return _.build()}}).buildSync(m),n.serviceLocatorBuilder().withService({name:C.SPLASH_SCREEN,build:function(){return new h}}).buildSync(m),m}t._registerAll=function(e){return T(e),I(m,e),A(e)},t.registerDependencies=A,t.registerSharedServices=I,t.registerCoreServices=T})),define("utils/common/applicationReactivationManager",["require","exports","module","swx-cafe-application-instance","swx-constants","browser/document","browser/window","browser/dom"],(function(e,t){var n,i=e("swx-cafe-application-instance"),r=e("swx-constants").COMMON,o=e("browser/document"),a=e("browser/window"),s=e("browser/dom"),c=3e3
	function l(){i.get().suspended(!1),n=null}function u(){a.addEventListener(r.events.browser.FOCUS,p),a.addEventListener(r.events.browser.BLUR,f),o.addEventListener(r.events.browser.VISIBILITYCHANGE,p)}function d(){a.removeEventListener(r.events.browser.FOCUS,p),a.removeEventListener(r.events.browser.BLUR,f),o.removeEventListener(r.events.browser.VISIBILITYCHANGE,p)}function p(){!s.isDocumentHidden()&&i.get().suspended()?n||(n=a.setTimeout(l,c)):f()}function f(){n&&(a.clearTimeout(n),n=null)}t.init=function(){i.get().suspended.when(!0,u),i.get().suspended.when(!1,d)}})),define("utils/common/activityReportManager",["require","exports","module","swx-cafe-application-instance","swx-constants","browser/document","browser/window","browser/dom"],(function(e,t){var n,i,r=e("swx-cafe-application-instance"),o=e("swx-constants").COMMON,a=e("browser/document"),s=e("browser/window"),c=e("browser/dom"),l=3e3
	function u(){r.get().personsAndGroupsManager.mePerson.active(!0),n=null}function d(){r.get().personsAndGroupsManager.mePerson.active(!1),i=null}function p(){return r.get().personsAndGroupsManager.mePerson.active()}function f(){c.isDocumentHidden()||p()?m():n||(n=s.setTimeout(u,l))}function m(){n&&(s.clearTimeout(n),n=null)}function h(){c.isDocumentHidden()&&p()?i||(i=s.setTimeout(d,l)):g()}function v(){p()&&(i||(i=s.setTimeout(d,l)))}function g(){i&&(s.clearTimeout(i),i=null)}function y(){s.addEventListener(o.events.browser.FOCUS,f),s.addEventListener(o.events.browser.BLUR,m),a.addEventListener(o.events.browser.VISIBILITYCHANGE,f),s.removeEventListener(o.events.browser.FOCUS,g),s.removeEventListener(o.events.browser.BLUR,v),a.removeEventListener(o.events.browser.VISIBILITYCHANGE,h)}function b(){s.removeEventListener(o.events.browser.FOCUS,f),s.removeEventListener(o.events.browser.BLUR,m),a.removeEventListener(o.events.browser.VISIBILITYCHANGE,f),s.addEventListener(o.events.browser.FOCUS,g),s.addEventListener(o.events.browser.BLUR,v),a.addEventListener(o.events.browser.VISIBILITYCHANGE,h)}t.init=function(){var e=r.get().personsAndGroupsManager.mePerson.active
	c.isDocumentHidden()&&e(!1),e.when(!0,b),e.when(!1,y)}})),define("telemetry/errors/runtimeErrorsHandler",["require","exports","module","browser/window","vendor/knockout","swx-constants","experience/settings","swx-service-locator-instance","ui/telemetry/telemetryClient"],(function(e,t){var n=e("browser/window"),i=e("vendor/knockout"),r=e("swx-constants").COMMON,o=e("experience/settings"),a=e("swx-service-locator-instance").default,s=e("ui/telemetry/telemetryClient")
	function c(e){(function(e){var n=e.stack||e.error&&e.error.stack
	return(l(e.filename)||l(n))&&(i=e.message,!(i&&i.indexOf(t.DEFAULT_SCRIPT_ERROR_MESSAGE)>=0))
	var i})(e)&&function(e){var t=r.telemetry.runtimeErrors.TYPE,n={message:null==e.message?r.NOT_AVAILABLE:e.message,fileName:e.filename||r.NOT_AVAILABLE,lineNumber:e.lineno||e.error&&e.error.lineNumber||r.NOT_AVAILABLE,columnNumber:e.colno||e.error&&e.error.columnNumber||r.NOT_AVAILABLE,stack:e.stack||e.error&&e.error.stack||r.NOT_AVAILABLE}
	s.get().sendEvent(o.telemetry.uiTenantToken,t,n)}(e)}function l(e){return e&&e.indexOf(o.packageUrl)>=0}t.DEFAULT_SCRIPT_ERROR_MESSAGE="Script error",t.init=function(){a.resolve(r.serviceLocator.FEATURE_FLAGS).isFeatureOn(r.featureFlags.TELEMETRY_RUNTIME_ERRORS_ENABLED)&&(n.addEventListener("error",c),i.onError=c)}})),define("experience/welcomeExperience",["require","exports","module","experience/settings","browser/window","swx-cafe-application-instance","swx-i18n"],(function(e,t){var n=e("experience/settings"),i=e("browser/window"),r=e("swx-cafe-application-instance"),o=e("swx-i18n").localization
	function a(){r.get().personsAndGroupsManager.mePerson.id.get().then((function(e){var t,a
	n.welcomeExperience.whitelist.some((function(t){return new RegExp(t).test(e)}))&&i.setTimeout((function(){r.get().replayMessage(o.fetch({key:"welcome_im_display_name"}),o.fetch({key:"welcome_im_first_message"}),o.fetch({key:"welcome_im_reply_message"}),o.fetch({key:"welcome_im_toast_message"}))}),(t=n.welcomeExperience.minDelayBeforeFirstMessage,a=n.welcomeExperience.maxDelayBeforeFirstMessage,Math.floor(Math.random()*(a-t+1))+t))}))}t.init=function(){n.welcomeExperience.enabled&&r.get().replayMessage.enabled.once(!0,a)}})),define("experience/experience",["require","exports","module","swx-polyfill-initializer","lodash-compat","usertiming","swx-browser-detect","browser/window","swx-constants","swx-enums","swx-cafe-application-instance","jCafe","experience/api/builder","experience/componentsLoader","experience/settings","services/telemetry/common/telemetry","services/telemetry/experience.instrumentation","experience/koBindingsRegistrar","notifications/init","swx-util-calling-stack","services/calling/autoCalling","services/g11n/init","services/i18n/init","services/pes/configSync","swx-service-locator-instance","experience/serviceLocatorInitializer","utils/common/appVisibilityProvider","utils/common/applicationFocusManager","utils/common/applicationReactivationManager","utils/common/activityReportManager","utils/common/elementQueryHelper","swx-utils-common","swx-utils-common","utils/common/prefetcher","swx-utils-common","telemetry/usage/inAppActivityTracker","telemetry/errors/runtimeErrorsHandler","ui/modalDialog/welcomeDialog","utils/common/styleModeHelper","experience/welcomeExperience","ui/viewModels/chat/messageParsers/swift/utils"],(function(e,t){e("swx-polyfill-initializer")
	var n=e("lodash-compat"),i=e("usertiming"),r=e("swx-browser-detect").default,o=e("browser/window"),a=e("swx-constants").COMMON,s=e("swx-enums"),c=e("swx-cafe-application-instance"),l=e("jCafe"),u=e("experience/api/builder"),d=e("experience/componentsLoader"),p=e("experience/settings"),f=e("services/telemetry/common/telemetry"),m=e("services/telemetry/experience.instrumentation"),h=e("experience/koBindingsRegistrar"),v=e("notifications/init"),g=e("swx-util-calling-stack"),y=e("services/calling/autoCalling"),b=e("services/g11n/init"),_=e("services/i18n/init"),E=e("services/pes/configSync"),w=e("swx-service-locator-instance").default,S=e("experience/serviceLocatorInitializer"),x=e("utils/common/appVisibilityProvider"),C=e("utils/common/applicationFocusManager"),T=e("utils/common/applicationReactivationManager"),I=e("utils/common/activityReportManager"),A=e("utils/common/elementQueryHelper"),M=e("swx-utils-common").guid,O=e("swx-utils-common").loader,k=e("utils/common/prefetcher"),N=e("swx-utils-common").stopwatch,P=e("telemetry/usage/inAppActivityTracker"),R=e("telemetry/errors/runtimeErrorsHandler"),L=e("ui/modalDialog/welcomeDialog"),D=e("utils/common/styleModeHelper"),U=e("experience/welcomeExperience"),F=e("ui/viewModels/chat/messageParsers/swift/utils"),B=a.telemetry.performanceMarks
	function V(){var e=w.resolve(a.serviceLocator.FEATURE_FLAGS);(e.isFeatureOn(a.featureFlags.YOUTUBE_PLAYER_ENABLED)||e.isFeatureOn(a.featureFlags.URL_PREVIEW_LOAD_YOUTUBE_PLAYER))&&O.loadScript(p.youtubeApiUrl)}function G(){C.focusTrackingEnabled=!0,c.get()._standbyMode&&c.get()._standbyMode(!1)}o._perfRefForUserTimingPolyfill=o.performance,t.init=function(e,t,o){var C,H,q,W,j,z=N.build()
	return function(e){n.merge(p,e.config),n.merge(p.initParams,e.initParams),["locale","variant"].forEach((function(e){p.initParams[e]=p.initParams[e].toLowerCase()})),p.sessionId=M.create(),function(){var e=r.getBrowserInfo(),t=r.getSystemInfo()
	e.isShellApp&&(p.mode=void 0,p.featureFlags.showSplashScreen=!1,p.isPollingEnabled=!1)
	!p.featureFlags.pluginlessPSTNCalling&&e.browserName===r.BROWSERS.EDGE&&e.browserMajorVersion>13&&(p.featureFlags.PSTN=!1)
	e.browserName===r.BROWSERS.EDGE&&e.browserMajorVersion>13&&(p.featureFlags.outgoingScreenSharing=!1)
	p.featureFlags.pluginlessPSTNCalling||t.osName!==r.OPERATING_SYSTEMS.LINUX||(p.featureFlags.PSTN=!1)
	t.osName===r.OPERATING_SYSTEMS.LINUX&&(p.featureFlags.outgoingScreenSharing=!1)
	t.osName===r.OPERATING_SYSTEMS.MACOSX&&e.browserName===r.BROWSERS.CHROME&&(p.featureFlags.copySelectionAsQuoteKeyboard=!1)
	e.browserName===r.BROWSERS.MSIE&&p.featureFlags.disableCallingOnIE&&n()
	e.browserName===r.BROWSERS.EDGE&&p.featureFlags.disableCallingOnEdge&&n()
	e.browserName===r.BROWSERS.CHROME&&p.featureFlags.disableCallingOnChrome&&n()
	e.browserName===r.BROWSERS.FIREFOX&&p.featureFlags.disableCallingOnFirefox&&n()
	e.browserName===r.BROWSERS.SAFARI&&p.featureFlags.disableCallingOnSafari&&n()
	function n(){p.featureFlags.calling=!1,p.featureFlags.PSTN=!1,p.supportsAudio=!1,p.supportsVideo=!1}}(),function(){function e(e){return e<10?"0"+e:e}var t=(new Date).getTimezoneOffset()
	p.utcOffset=t<0?"-":"+",t*=t<0?-1:1,p.utcOffset+=e(Math.floor(t/60)),p.utcOffset+=":",p.utcOffset+=e(t%60)}()}(e),H=p.platformId,q=function(){try{var e=p.version.split(".")
	return e.length<4?e[0]+"."+e[1]+".0."+e[2]:p.version}catch(t){return"0.0.0.0"}}(),W=p.biAppName,p.uiVersion=H+"/"+q+"//"+W,p.displayAppVersion&&!D.get().isIntegratedProperty()&&(document.title="Skype "+q),C=function(){var e={}
	return e.coreServices=S.registerCoreServices(p),e.sharedServices=S.registerSharedServices(w,p),e.initApplication=function(){var e=n.pick(w,a.serviceLocator.SETTINGS,a.serviceLocator.TELEMETRY_MANAGER,a.serviceLocator.LOCAL_STORAGE),t=l.Application.create(e)
	c.set(t)}(),e.overrideSettings=function(){var e=r.getBrowserInfo()
	if(w.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.URL_OVERRIDE_ENABLED)){var t=e.getUrlParams()
	t.locale&&(p.initParams.locale=t.locale.toLowerCase()),t.variant&&(p.initParams.variant=t.variant.toLowerCase())}}(),e.registeredServices=S.registerDependencies(p),e.runtimeErrorsHandler=R.init(),e.instrumentTelemetryEvents=function(){f.instrumentAllEvents(m)}(),e.loadCss=function(){p.assetsBaseUrl
	var e=p.appBaseUrl
	O.loadStyle("/a/assets/css/sfb-common.css"),O.loadStyle(e+"/css/swx.css")}(),e.initCallingStack=function(){g.init(p)}(),e.initAutoCalling=function(){y.init()}(),e.prefetcher=k.prefetchAssets(),e.appVisibilityProvider=x.init(),e.inAppActivityTracker=P.init(c.get().signInManager),e.appReactivationManager=T.init(),e.activityReportManager=I.init(),e.elementQueryHelper=A.initialiseSelectors(),e.notifications=v.init(),e.welcomeDialog=L.init(),e.subscribeVisibilityProvider=function(){w.resolve(a.serviceLocator.PUBSUB).subscribe(a.apiUIEvents.SWX_TIMELINE_LOADED,G)}(),e.initTranslatorService=function(){var e=c.get().translatorService
	if(!e)return Promise.resolve()
	return new Promise((function(e){c.get().signInManager.state.once(s.loginState.SignedIn,e)})).then((function(){return e.supportedLanguages.get()}))}(),e.initUserPreferences=function(){return w.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.INIT_PREFERENCES_AFTER_SIGNIN)?new Promise((function(e){c.get().signInManager.state.once(s.loginState.SignedIn,e)})).then((function(){function e(){r.unsubscribe(a.apiUIEvents.SWX_TIMELINE_LOADED,e),V()}var t=c.get().personsAndGroupsManager.mePerson.preferences(),i=n.map(t,(function(e){return e.value.get.enabled()?e.value.get():Promise.resolve()})),r=w.resolve(a.serviceLocator.PUBSUB)
	return r.subscribe(a.apiUIEvents.SWX_TIMELINE_LOADED,e),Promise.all(i).then((function(){v.update()}))})):(e=new Promise((function(e){function t(){n.unsubscribe(a.apiUIEvents.SWX_TIMELINE_LOADED,t),V(),e()}var n=w.resolve(a.serviceLocator.PUBSUB)
	n.subscribe(a.apiUIEvents.SWX_TIMELINE_LOADED,t)})),t=new Promise((function(e){c.get().signInManager.state.once(s.loginState.SignedIn,e)})),Promise.all([e,t]).then((function(){var e=c.get().personsAndGroupsManager.mePerson.preferences(),t=n.map(e,(function(e){return e.value.get.enabled()?e.value.get():Promise.resolve()}))
	return Promise.all(t).then((function(){v.update()}))})))
	var e,t}(),e.initWelcomeExperience=U.init(),F.setSupportedSwiftCardTypes(),e}(),j=r.getBrowserInfo(),w.resolve(a.serviceLocator.FEATURE_FLAGS).isFeatureOn(a.featureFlags.FAIL_INITIALIZATION_FOR_IE_AND_EDGE)&&(j.isEdge||j.isIeEngine)?(o("Failing initialize for IE and Edge enabled"),C.everything=Promise.reject(),C):(C.i18nInit=Promise.all([b.init(p),_.init(p,document.documentElement)]),C.componentsLoaderInit=C.i18nInit.then((function(){return Promise.all([d.init()])})),C.componentsReady=C.componentsLoaderInit.then((function(){(function(e,t){w.resolve(a.serviceLocator.PUBSUB).publish(a.events.system.EXPERIENCE_INITIALIZED,{configLoadDuration:e.configLoadDuration,packageLoadDuration:e.packageLoadDuration,experienceInitializeDuration:t.duration()}),i.mark(B.EXPERIENCE.TTL_START)})(e,z)})),C.apiReady=C.componentsReady.then((function(){t(u.get())})),C.experienceReady=C.apiReady.then((function(){var e=w.resolve(a.serviceLocator.PUBSUB),t=w.resolve(a.serviceLocator.FEATURE_FLAGS)
	e.publish(a.events.system.EXPERIENCE_READY),c.get().signInManager.state.once(s.loginState.SignedIn,(function(){var e
	E.init(),t.isFeatureOn(a.featureFlags.HIGH_PRIORITY_SCRIPT_ENABLED)&&((e=document.createElement("script")).src="https://s7.addthis.com/js/300/addthis_widget.js#provider=skype",document.body.appendChild(e))}))})),C.everything=C.experienceReady.catch((function(e){return o(e),Promise.reject(e)})),h.registerBindings(),C)}})),define("experience/entryPoints/fullExperience",["require","experience/experience","browser/window"],(function(e){var t,n=e("experience/experience"),i=e("browser/window")
	t={init:function(e,t,i){n.init(e,t,i)}},i.Skype&&i.Skype.onExperienceLoaded&&i.Skype.onExperienceLoaded(t)})),define("skype-web-sdk",(function(){})),require(["experience/entryPoints/fullExperience"])})()
